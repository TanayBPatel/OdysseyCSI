/*! For license information please see main.92a4203c.js.LICENSE.txt */
(()=>{var e={240:e=>{"use strict";var t=Object.prototype.hasOwnProperty,n=Object.prototype.toString,i=Object.defineProperty,r=Object.getOwnPropertyDescriptor,s=function(e){return"function"===typeof Array.isArray?Array.isArray(e):"[object Array]"===n.call(e)},a=function(e){if(!e||"[object Object]"!==n.call(e))return!1;var i,r=t.call(e,"constructor"),s=e.constructor&&e.constructor.prototype&&t.call(e.constructor.prototype,"isPrototypeOf");if(e.constructor&&!r&&!s)return!1;for(i in e);return"undefined"===typeof i||t.call(e,i)},o=function(e,t){i&&"__proto__"===t.name?i(e,t.name,{enumerable:!0,configurable:!0,value:t.newValue,writable:!0}):e[t.name]=t.newValue},l=function(e,n){if("__proto__"===n){if(!t.call(e,n))return;if(r)return r(e,n).value}return e[n]};e.exports=function e(){var t,n,i,r,u,c,h=arguments[0],d=1,p=arguments.length,f=!1;for("boolean"===typeof h&&(f=h,h=arguments[1]||{},d=2),(null==h||"object"!==typeof h&&"function"!==typeof h)&&(h={});d<p;++d)if(null!=(t=arguments[d]))for(n in t)i=l(h,n),h!==(r=l(t,n))&&(f&&r&&(a(r)||(u=s(r)))?(u?(u=!1,c=i&&s(i)?i:[]):c=i&&a(i)?i:{},o(h,{name:n,newValue:e(f,c,r)})):"undefined"!==typeof r&&o(h,{name:n,newValue:r}));return h}},403:e=>{var t=/\/\*[^*]*\*+([^/*][^*]*\*+)*\//g,n=/\n/g,i=/^\s*/,r=/^(\*?[-#/*\\\w]+(\[[0-9a-z_-]+\])?)\s*/,s=/^:\s*/,a=/^((?:'(?:\\'|.)*?'|"(?:\\"|.)*?"|\([^)]*?\)|[^};])+)/,o=/^[;\s]*/,l=/^\s+|\s+$/g,u="";function c(e){return e?e.replace(l,u):u}e.exports=function(e,l){if("string"!==typeof e)throw new TypeError("First argument must be a string");if(!e)return[];l=l||{};var h=1,d=1;function p(e){var t=e.match(n);t&&(h+=t.length);var i=e.lastIndexOf("\n");d=~i?e.length-i:d+e.length}function f(){var e={line:h,column:d};return function(t){return t.position=new m(e),x(),t}}function m(e){this.start=e,this.end={line:h,column:d},this.source=l.source}m.prototype.content=e;var g=[];function v(t){var n=new Error(l.source+":"+h+":"+d+": "+t);if(n.reason=t,n.filename=l.source,n.line=h,n.column=d,n.source=e,!l.silent)throw n;g.push(n)}function y(t){var n=t.exec(e);if(n){var i=n[0];return p(i),e=e.slice(i.length),n}}function x(){y(i)}function b(e){var t;for(e=e||[];t=w();)!1!==t&&e.push(t);return e}function w(){var t=f();if("/"==e.charAt(0)&&"*"==e.charAt(1)){for(var n=2;u!=e.charAt(n)&&("*"!=e.charAt(n)||"/"!=e.charAt(n+1));)++n;if(n+=2,u===e.charAt(n-1))return v("End of comment missing");var i=e.slice(2,n-2);return d+=2,p(i),e=e.slice(n),d+=2,t({type:"comment",comment:i})}}function D(){var e=f(),n=y(r);if(n){if(w(),!y(s))return v("property missing ':'");var i=y(a),l=e({type:"declaration",property:c(n[0].replace(t,u)),value:i?c(i[0].replace(t,u)):u});return y(o),l}}return x(),function(){var e,t=[];for(b(t);e=D();)!1!==e&&(t.push(e),b(t));return t}()}},446:(e,t,n)=>{var i=/^\s+|\s+$/g,r=/^[-+]0x[0-9a-f]+$/i,s=/^0b[01]+$/i,a=/^0o[0-7]+$/i,o=parseInt,l="object"==typeof n.g&&n.g&&n.g.Object===Object&&n.g,u="object"==typeof self&&self&&self.Object===Object&&self,c=l||u||Function("return this")(),h=Object.prototype.toString,d=Math.max,p=Math.min,f=function(){return c.Date.now()};function m(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function g(e){if("number"==typeof e)return e;if(function(e){return"symbol"==typeof e||function(e){return!!e&&"object"==typeof e}(e)&&"[object Symbol]"==h.call(e)}(e))return NaN;if(m(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=m(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(i,"");var n=s.test(e);return n||a.test(e)?o(e.slice(2),n?2:8):r.test(e)?NaN:+e}e.exports=function(e,t,n){var i,r,s,a,o,l,u=0,c=!1,h=!1,v=!0;if("function"!=typeof e)throw new TypeError("Expected a function");function y(t){var n=i,s=r;return i=r=void 0,u=t,a=e.apply(s,n)}function x(e){var n=e-l;return void 0===l||n>=t||n<0||h&&e-u>=s}function b(){var e=f();if(x(e))return w(e);o=setTimeout(b,function(e){var n=t-(e-l);return h?p(n,s-(e-u)):n}(e))}function w(e){return o=void 0,v&&i?y(e):(i=r=void 0,a)}function D(){var e=f(),n=x(e);if(i=arguments,r=this,l=e,n){if(void 0===o)return function(e){return u=e,o=setTimeout(b,t),c?y(e):a}(l);if(h)return o=setTimeout(b,t),y(l)}return void 0===o&&(o=setTimeout(b,t)),a}return t=g(t)||0,m(n)&&(c=!!n.leading,s=(h="maxWait"in n)?d(g(n.maxWait)||0,t):s,v="trailing"in n?!!n.trailing:v),D.cancel=function(){void 0!==o&&clearTimeout(o),u=0,i=l=r=o=void 0},D.flush=function(){return void 0===o?a:w(f())},D}},730:(e,t,n)=>{"use strict";var i=n(43),r=n(67);function s(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var a=new Set,o={};function l(e,t){u(e,t),u(e+"Capture",t)}function u(e,t){for(o[e]=t,e=0;e<t.length;e++)a.add(t[e])}var c=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),h=Object.prototype.hasOwnProperty,d=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,p={},f={};function m(e,t,n,i,r,s,a){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=i,this.attributeNamespace=r,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=s,this.removeEmptyString=a}var g={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(e){g[e]=new m(e,0,!1,e,null,!1,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(e){var t=e[0];g[t]=new m(t,1,!1,e[1],null,!1,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(e){g[e]=new m(e,2,!1,e.toLowerCase(),null,!1,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(e){g[e]=new m(e,2,!1,e,null,!1,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(e){g[e]=new m(e,3,!1,e.toLowerCase(),null,!1,!1)})),["checked","multiple","muted","selected"].forEach((function(e){g[e]=new m(e,3,!0,e,null,!1,!1)})),["capture","download"].forEach((function(e){g[e]=new m(e,4,!1,e,null,!1,!1)})),["cols","rows","size","span"].forEach((function(e){g[e]=new m(e,6,!1,e,null,!1,!1)})),["rowSpan","start"].forEach((function(e){g[e]=new m(e,5,!1,e.toLowerCase(),null,!1,!1)}));var v=/[\-:]([a-z])/g;function y(e){return e[1].toUpperCase()}function x(e,t,n,i){var r=g.hasOwnProperty(t)?g[t]:null;(null!==r?0!==r.type:i||!(2<t.length)||"o"!==t[0]&&"O"!==t[0]||"n"!==t[1]&&"N"!==t[1])&&(function(e,t,n,i){if(null===t||"undefined"===typeof t||function(e,t,n,i){if(null!==n&&0===n.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!i&&(null!==n?!n.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,n,i))return!0;if(i)return!1;if(null!==n)switch(n.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,n,r,i)&&(n=null),i||null===r?function(e){return!!h.call(f,e)||!h.call(p,e)&&(d.test(e)?f[e]=!0:(p[e]=!0,!1))}(t)&&(null===n?e.removeAttribute(t):e.setAttribute(t,""+n)):r.mustUseProperty?e[r.propertyName]=null===n?3!==r.type&&"":n:(t=r.attributeName,i=r.attributeNamespace,null===n?e.removeAttribute(t):(n=3===(r=r.type)||4===r&&!0===n?"":""+n,i?e.setAttributeNS(i,t,n):e.setAttribute(t,n))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(e){var t=e.replace(v,y);g[t]=new m(t,1,!1,e,null,!1,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(e){var t=e.replace(v,y);g[t]=new m(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)})),["xml:base","xml:lang","xml:space"].forEach((function(e){var t=e.replace(v,y);g[t]=new m(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)})),["tabIndex","crossOrigin"].forEach((function(e){g[e]=new m(e,1,!1,e.toLowerCase(),null,!1,!1)})),g.xlinkHref=new m("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach((function(e){g[e]=new m(e,1,!1,e.toLowerCase(),null,!0,!0)}));var b=i.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,w=Symbol.for("react.element"),D=Symbol.for("react.portal"),_=Symbol.for("react.fragment"),S=Symbol.for("react.strict_mode"),E=Symbol.for("react.profiler"),C=Symbol.for("react.provider"),A=Symbol.for("react.context"),M=Symbol.for("react.forward_ref"),T=Symbol.for("react.suspense"),P=Symbol.for("react.suspense_list"),F=Symbol.for("react.memo"),O=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var I=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var k=Symbol.iterator;function B(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=k&&e[k]||e["@@iterator"])?e:null}var R,L=Object.assign;function z(e){if(void 0===R)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);R=t&&t[1]||""}return"\n"+R+e}var N=!1;function j(e,t){if(!e||N)return"";N=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(u){var i=u}Reflect.construct(e,[],t)}else{try{t.call()}catch(u){i=u}e.call(t.prototype)}else{try{throw Error()}catch(u){i=u}e()}}catch(u){if(u&&i&&"string"===typeof u.stack){for(var r=u.stack.split("\n"),s=i.stack.split("\n"),a=r.length-1,o=s.length-1;1<=a&&0<=o&&r[a]!==s[o];)o--;for(;1<=a&&0<=o;a--,o--)if(r[a]!==s[o]){if(1!==a||1!==o)do{if(a--,0>--o||r[a]!==s[o]){var l="\n"+r[a].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}}while(1<=a&&0<=o);break}}}finally{N=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?z(e):""}function U(e){switch(e.tag){case 5:return z(e.type);case 16:return z("Lazy");case 13:return z("Suspense");case 19:return z("SuspenseList");case 0:case 2:case 15:return e=j(e.type,!1);case 11:return e=j(e.type.render,!1);case 1:return e=j(e.type,!0);default:return""}}function V(e){if(null==e)return null;if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case _:return"Fragment";case D:return"Portal";case E:return"Profiler";case S:return"StrictMode";case T:return"Suspense";case P:return"SuspenseList"}if("object"===typeof e)switch(e.$$typeof){case A:return(e.displayName||"Context")+".Consumer";case C:return(e._context.displayName||"Context")+".Provider";case M:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case F:return null!==(t=e.displayName||null)?t:V(e.type)||"Memo";case O:t=e._payload,e=e._init;try{return V(e(t))}catch(n){}}return null}function H(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return V(t);case 8:return t===S?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"===typeof t)return t.displayName||t.name||null;if("string"===typeof t)return t}return null}function W(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function G(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function q(e){e._valueTracker||(e._valueTracker=function(e){var t=G(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),i=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof n&&"function"===typeof n.get&&"function"===typeof n.set){var r=n.get,s=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return r.call(this)},set:function(e){i=""+e,s.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return i},setValue:function(e){i=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function Y(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),i="";return e&&(i=G(e)?e.checked?"true":"false":e.value),(e=i)!==n&&(t.setValue(e),!0)}function X(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function Q(e,t){var n=t.checked;return L({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:e._wrapperState.initialChecked})}function K(e,t){var n=null==t.defaultValue?"":t.defaultValue,i=null!=t.checked?t.checked:t.defaultChecked;n=W(null!=t.value?t.value:n),e._wrapperState={initialChecked:i,initialValue:n,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function Z(e,t){null!=(t=t.checked)&&x(e,"checked",t,!1)}function J(e,t){Z(e,t);var n=W(t.value),i=t.type;if(null!=n)"number"===i?(0===n&&""===e.value||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if("submit"===i||"reset"===i)return void e.removeAttribute("value");t.hasOwnProperty("value")?ee(e,t.type,n):t.hasOwnProperty("defaultValue")&&ee(e,t.type,W(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function $(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var i=t.type;if(!("submit"!==i&&"reset"!==i||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}""!==(n=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==n&&(e.name=n)}function ee(e,t,n){"number"===t&&X(e.ownerDocument)===e||(null==n?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var te=Array.isArray;function ne(e,t,n,i){if(e=e.options,t){t={};for(var r=0;r<n.length;r++)t["$"+n[r]]=!0;for(n=0;n<e.length;n++)r=t.hasOwnProperty("$"+e[n].value),e[n].selected!==r&&(e[n].selected=r),r&&i&&(e[n].defaultSelected=!0)}else{for(n=""+W(n),t=null,r=0;r<e.length;r++){if(e[r].value===n)return e[r].selected=!0,void(i&&(e[r].defaultSelected=!0));null!==t||e[r].disabled||(t=e[r])}null!==t&&(t.selected=!0)}}function ie(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(s(91));return L({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function re(e,t){var n=t.value;if(null==n){if(n=t.children,t=t.defaultValue,null!=n){if(null!=t)throw Error(s(92));if(te(n)){if(1<n.length)throw Error(s(93));n=n[0]}t=n}null==t&&(t=""),n=t}e._wrapperState={initialValue:W(n)}}function se(e,t){var n=W(t.value),i=W(t.defaultValue);null!=n&&((n=""+n)!==e.value&&(e.value=n),null==t.defaultValue&&e.defaultValue!==n&&(e.defaultValue=n)),null!=i&&(e.defaultValue=""+i)}function ae(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}function oe(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function le(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?oe(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var ue,ce,he=(ce=function(e,t){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=t;else{for((ue=ue||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ue.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,n,i){MSApp.execUnsafeLocalFunction((function(){return ce(e,t)}))}:ce);function de(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var pe={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},fe=["Webkit","ms","Moz","O"];function me(e,t,n){return null==t||"boolean"===typeof t||""===t?"":n||"number"!==typeof t||0===t||pe.hasOwnProperty(e)&&pe[e]?(""+t).trim():t+"px"}function ge(e,t){for(var n in e=e.style,t)if(t.hasOwnProperty(n)){var i=0===n.indexOf("--"),r=me(n,t[n],i);"float"===n&&(n="cssFloat"),i?e.setProperty(n,r):e[n]=r}}Object.keys(pe).forEach((function(e){fe.forEach((function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),pe[t]=pe[e]}))}));var ve=L({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ye(e,t){if(t){if(ve[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(s(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(s(60));if("object"!==typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(s(61))}if(null!=t.style&&"object"!==typeof t.style)throw Error(s(62))}}function xe(e,t){if(-1===e.indexOf("-"))return"string"===typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var be=null;function we(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var De=null,_e=null,Se=null;function Ee(e){if(e=xr(e)){if("function"!==typeof De)throw Error(s(280));var t=e.stateNode;t&&(t=wr(t),De(e.stateNode,e.type,t))}}function Ce(e){_e?Se?Se.push(e):Se=[e]:_e=e}function Ae(){if(_e){var e=_e,t=Se;if(Se=_e=null,Ee(e),t)for(e=0;e<t.length;e++)Ee(t[e])}}function Me(e,t){return e(t)}function Te(){}var Pe=!1;function Fe(e,t,n){if(Pe)return e(t,n);Pe=!0;try{return Me(e,t,n)}finally{Pe=!1,(null!==_e||null!==Se)&&(Te(),Ae())}}function Oe(e,t){var n=e.stateNode;if(null===n)return null;var i=wr(n);if(null===i)return null;n=i[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(i=!i.disabled)||(i=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!i;break e;default:e=!1}if(e)return null;if(n&&"function"!==typeof n)throw Error(s(231,t,typeof n));return n}var Ie=!1;if(c)try{var ke={};Object.defineProperty(ke,"passive",{get:function(){Ie=!0}}),window.addEventListener("test",ke,ke),window.removeEventListener("test",ke,ke)}catch(ce){Ie=!1}function Be(e,t,n,i,r,s,a,o,l){var u=Array.prototype.slice.call(arguments,3);try{t.apply(n,u)}catch(c){this.onError(c)}}var Re=!1,Le=null,ze=!1,Ne=null,je={onError:function(e){Re=!0,Le=e}};function Ue(e,t,n,i,r,s,a,o,l){Re=!1,Le=null,Be.apply(je,arguments)}function Ve(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function He(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function We(e){if(Ve(e)!==e)throw Error(s(188))}function Ge(e){return null!==(e=function(e){var t=e.alternate;if(!t){if(null===(t=Ve(e)))throw Error(s(188));return t!==e?null:e}for(var n=e,i=t;;){var r=n.return;if(null===r)break;var a=r.alternate;if(null===a){if(null!==(i=r.return)){n=i;continue}break}if(r.child===a.child){for(a=r.child;a;){if(a===n)return We(r),e;if(a===i)return We(r),t;a=a.sibling}throw Error(s(188))}if(n.return!==i.return)n=r,i=a;else{for(var o=!1,l=r.child;l;){if(l===n){o=!0,n=r,i=a;break}if(l===i){o=!0,i=r,n=a;break}l=l.sibling}if(!o){for(l=a.child;l;){if(l===n){o=!0,n=a,i=r;break}if(l===i){o=!0,i=a,n=r;break}l=l.sibling}if(!o)throw Error(s(189))}}if(n.alternate!==i)throw Error(s(190))}if(3!==n.tag)throw Error(s(188));return n.stateNode.current===n?e:t}(e))?qe(e):null}function qe(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=qe(e);if(null!==t)return t;e=e.sibling}return null}var Ye=r.unstable_scheduleCallback,Xe=r.unstable_cancelCallback,Qe=r.unstable_shouldYield,Ke=r.unstable_requestPaint,Ze=r.unstable_now,Je=r.unstable_getCurrentPriorityLevel,$e=r.unstable_ImmediatePriority,et=r.unstable_UserBlockingPriority,tt=r.unstable_NormalPriority,nt=r.unstable_LowPriority,it=r.unstable_IdlePriority,rt=null,st=null;var at=Math.clz32?Math.clz32:function(e){return e>>>=0,0===e?32:31-(ot(e)/lt|0)|0},ot=Math.log,lt=Math.LN2;var ut=64,ct=4194304;function ht(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function dt(e,t){var n=e.pendingLanes;if(0===n)return 0;var i=0,r=e.suspendedLanes,s=e.pingedLanes,a=268435455&n;if(0!==a){var o=a&~r;0!==o?i=ht(o):0!==(s&=a)&&(i=ht(s))}else 0!==(a=n&~r)?i=ht(a):0!==s&&(i=ht(s));if(0===i)return 0;if(0!==t&&t!==i&&0===(t&r)&&((r=i&-i)>=(s=t&-t)||16===r&&0!==(4194240&s)))return t;if(0!==(4&i)&&(i|=16&n),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=i;0<t;)r=1<<(n=31-at(t)),i|=e[n],t&=~r;return i}function pt(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function ft(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function mt(){var e=ut;return 0===(4194240&(ut<<=1))&&(ut=64),e}function gt(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function vt(e,t,n){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-at(t)]=n}function yt(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var i=31-at(n),r=1<<i;r&t|e[i]&t&&(e[i]|=t),n&=~r}}var xt=0;function bt(e){return 1<(e&=-e)?4<e?0!==(268435455&e)?16:536870912:4:1}var wt,Dt,_t,St,Et,Ct=!1,At=[],Mt=null,Tt=null,Pt=null,Ft=new Map,Ot=new Map,It=[],kt="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Bt(e,t){switch(e){case"focusin":case"focusout":Mt=null;break;case"dragenter":case"dragleave":Tt=null;break;case"mouseover":case"mouseout":Pt=null;break;case"pointerover":case"pointerout":Ft.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ot.delete(t.pointerId)}}function Rt(e,t,n,i,r,s){return null===e||e.nativeEvent!==s?(e={blockedOn:t,domEventName:n,eventSystemFlags:i,nativeEvent:s,targetContainers:[r]},null!==t&&(null!==(t=xr(t))&&Dt(t)),e):(e.eventSystemFlags|=i,t=e.targetContainers,null!==r&&-1===t.indexOf(r)&&t.push(r),e)}function Lt(e){var t=yr(e.target);if(null!==t){var n=Ve(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=He(n)))return e.blockedOn=t,void Et(e.priority,(function(){_t(n)}))}else if(3===t&&n.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function zt(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=Qt(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==n)return null!==(t=xr(n))&&Dt(t),e.blockedOn=n,!1;var i=new(n=e.nativeEvent).constructor(n.type,n);be=i,n.target.dispatchEvent(i),be=null,t.shift()}return!0}function Nt(e,t,n){zt(e)&&n.delete(t)}function jt(){Ct=!1,null!==Mt&&zt(Mt)&&(Mt=null),null!==Tt&&zt(Tt)&&(Tt=null),null!==Pt&&zt(Pt)&&(Pt=null),Ft.forEach(Nt),Ot.forEach(Nt)}function Ut(e,t){e.blockedOn===t&&(e.blockedOn=null,Ct||(Ct=!0,r.unstable_scheduleCallback(r.unstable_NormalPriority,jt)))}function Vt(e){function t(t){return Ut(t,e)}if(0<At.length){Ut(At[0],e);for(var n=1;n<At.length;n++){var i=At[n];i.blockedOn===e&&(i.blockedOn=null)}}for(null!==Mt&&Ut(Mt,e),null!==Tt&&Ut(Tt,e),null!==Pt&&Ut(Pt,e),Ft.forEach(t),Ot.forEach(t),n=0;n<It.length;n++)(i=It[n]).blockedOn===e&&(i.blockedOn=null);for(;0<It.length&&null===(n=It[0]).blockedOn;)Lt(n),null===n.blockedOn&&It.shift()}var Ht=b.ReactCurrentBatchConfig,Wt=!0;function Gt(e,t,n,i){var r=xt,s=Ht.transition;Ht.transition=null;try{xt=1,Yt(e,t,n,i)}finally{xt=r,Ht.transition=s}}function qt(e,t,n,i){var r=xt,s=Ht.transition;Ht.transition=null;try{xt=4,Yt(e,t,n,i)}finally{xt=r,Ht.transition=s}}function Yt(e,t,n,i){if(Wt){var r=Qt(e,t,n,i);if(null===r)Wi(e,t,i,Xt,n),Bt(e,i);else if(function(e,t,n,i,r){switch(t){case"focusin":return Mt=Rt(Mt,e,t,n,i,r),!0;case"dragenter":return Tt=Rt(Tt,e,t,n,i,r),!0;case"mouseover":return Pt=Rt(Pt,e,t,n,i,r),!0;case"pointerover":var s=r.pointerId;return Ft.set(s,Rt(Ft.get(s)||null,e,t,n,i,r)),!0;case"gotpointercapture":return s=r.pointerId,Ot.set(s,Rt(Ot.get(s)||null,e,t,n,i,r)),!0}return!1}(r,e,t,n,i))i.stopPropagation();else if(Bt(e,i),4&t&&-1<kt.indexOf(e)){for(;null!==r;){var s=xr(r);if(null!==s&&wt(s),null===(s=Qt(e,t,n,i))&&Wi(e,t,i,Xt,n),s===r)break;r=s}null!==r&&i.stopPropagation()}else Wi(e,t,i,null,n)}}var Xt=null;function Qt(e,t,n,i){if(Xt=null,null!==(e=yr(e=we(i))))if(null===(t=Ve(e)))e=null;else if(13===(n=t.tag)){if(null!==(e=He(t)))return e;e=null}else if(3===n){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Xt=e,null}function Kt(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Je()){case $e:return 1;case et:return 4;case tt:case nt:return 16;case it:return 536870912;default:return 16}default:return 16}}var Zt=null,Jt=null,$t=null;function en(){if($t)return $t;var e,t,n=Jt,i=n.length,r="value"in Zt?Zt.value:Zt.textContent,s=r.length;for(e=0;e<i&&n[e]===r[e];e++);var a=i-e;for(t=1;t<=a&&n[i-t]===r[s-t];t++);return $t=r.slice(e,1<t?1-t:void 0)}function tn(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function nn(){return!0}function rn(){return!1}function sn(e){function t(t,n,i,r,s){for(var a in this._reactName=t,this._targetInst=i,this.type=n,this.nativeEvent=r,this.target=s,this.currentTarget=null,e)e.hasOwnProperty(a)&&(t=e[a],this[a]=t?t(r):r[a]);return this.isDefaultPrevented=(null!=r.defaultPrevented?r.defaultPrevented:!1===r.returnValue)?nn:rn,this.isPropagationStopped=rn,this}return L(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=nn)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=nn)},persist:function(){},isPersistent:nn}),t}var an,on,ln,un={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},cn=sn(un),hn=L({},un,{view:0,detail:0}),dn=sn(hn),pn=L({},hn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:En,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==ln&&(ln&&"mousemove"===e.type?(an=e.screenX-ln.screenX,on=e.screenY-ln.screenY):on=an=0,ln=e),an)},movementY:function(e){return"movementY"in e?e.movementY:on}}),fn=sn(pn),mn=sn(L({},pn,{dataTransfer:0})),gn=sn(L({},hn,{relatedTarget:0})),vn=sn(L({},un,{animationName:0,elapsedTime:0,pseudoElement:0})),yn=L({},un,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),xn=sn(yn),bn=sn(L({},un,{data:0})),wn={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Dn={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},_n={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Sn(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=_n[e])&&!!t[e]}function En(){return Sn}var Cn=L({},hn,{key:function(e){if(e.key){var t=wn[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=tn(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?Dn[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:En,charCode:function(e){return"keypress"===e.type?tn(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?tn(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),An=sn(Cn),Mn=sn(L({},pn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),Tn=sn(L({},hn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:En})),Pn=sn(L({},un,{propertyName:0,elapsedTime:0,pseudoElement:0})),Fn=L({},pn,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),On=sn(Fn),In=[9,13,27,32],kn=c&&"CompositionEvent"in window,Bn=null;c&&"documentMode"in document&&(Bn=document.documentMode);var Rn=c&&"TextEvent"in window&&!Bn,Ln=c&&(!kn||Bn&&8<Bn&&11>=Bn),zn=String.fromCharCode(32),Nn=!1;function jn(e,t){switch(e){case"keyup":return-1!==In.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Un(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var Vn=!1;var Hn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Wn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!Hn[e.type]:"textarea"===t}function Gn(e,t,n,i){Ce(i),0<(t=qi(t,"onChange")).length&&(n=new cn("onChange","change",null,n,i),e.push({event:n,listeners:t}))}var qn=null,Yn=null;function Xn(e){zi(e,0)}function Qn(e){if(Y(br(e)))return e}function Kn(e,t){if("change"===e)return t}var Zn=!1;if(c){var Jn;if(c){var $n="oninput"in document;if(!$n){var ei=document.createElement("div");ei.setAttribute("oninput","return;"),$n="function"===typeof ei.oninput}Jn=$n}else Jn=!1;Zn=Jn&&(!document.documentMode||9<document.documentMode)}function ti(){qn&&(qn.detachEvent("onpropertychange",ni),Yn=qn=null)}function ni(e){if("value"===e.propertyName&&Qn(Yn)){var t=[];Gn(t,Yn,e,we(e)),Fe(Xn,t)}}function ii(e,t,n){"focusin"===e?(ti(),Yn=n,(qn=t).attachEvent("onpropertychange",ni)):"focusout"===e&&ti()}function ri(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Qn(Yn)}function si(e,t){if("click"===e)return Qn(t)}function ai(e,t){if("input"===e||"change"===e)return Qn(t)}var oi="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function li(e,t){if(oi(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var n=Object.keys(e),i=Object.keys(t);if(n.length!==i.length)return!1;for(i=0;i<n.length;i++){var r=n[i];if(!h.call(t,r)||!oi(e[r],t[r]))return!1}return!0}function ui(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function ci(e,t){var n,i=ui(e);for(e=0;i;){if(3===i.nodeType){if(n=e+i.textContent.length,e<=t&&n>=t)return{node:i,offset:t-e};e=n}e:{for(;i;){if(i.nextSibling){i=i.nextSibling;break e}i=i.parentNode}i=void 0}i=ui(i)}}function hi(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?hi(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function di(){for(var e=window,t=X();t instanceof e.HTMLIFrameElement;){try{var n="string"===typeof t.contentWindow.location.href}catch(i){n=!1}if(!n)break;t=X((e=t.contentWindow).document)}return t}function pi(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function fi(e){var t=di(),n=e.focusedElem,i=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&hi(n.ownerDocument.documentElement,n)){if(null!==i&&pi(n))if(t=i.start,void 0===(e=i.end)&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if((e=(t=n.ownerDocument||document)&&t.defaultView||window).getSelection){e=e.getSelection();var r=n.textContent.length,s=Math.min(i.start,r);i=void 0===i.end?s:Math.min(i.end,r),!e.extend&&s>i&&(r=i,i=s,s=r),r=ci(n,s);var a=ci(n,i);r&&a&&(1!==e.rangeCount||e.anchorNode!==r.node||e.anchorOffset!==r.offset||e.focusNode!==a.node||e.focusOffset!==a.offset)&&((t=t.createRange()).setStart(r.node,r.offset),e.removeAllRanges(),s>i?(e.addRange(t),e.extend(a.node,a.offset)):(t.setEnd(a.node,a.offset),e.addRange(t)))}for(t=[],e=n;e=e.parentNode;)1===e.nodeType&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for("function"===typeof n.focus&&n.focus(),n=0;n<t.length;n++)(e=t[n]).element.scrollLeft=e.left,e.element.scrollTop=e.top}}var mi=c&&"documentMode"in document&&11>=document.documentMode,gi=null,vi=null,yi=null,xi=!1;function bi(e,t,n){var i=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;xi||null==gi||gi!==X(i)||("selectionStart"in(i=gi)&&pi(i)?i={start:i.selectionStart,end:i.selectionEnd}:i={anchorNode:(i=(i.ownerDocument&&i.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:i.anchorOffset,focusNode:i.focusNode,focusOffset:i.focusOffset},yi&&li(yi,i)||(yi=i,0<(i=qi(vi,"onSelect")).length&&(t=new cn("onSelect","select",null,t,n),e.push({event:t,listeners:i}),t.target=gi)))}function wi(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var Di={animationend:wi("Animation","AnimationEnd"),animationiteration:wi("Animation","AnimationIteration"),animationstart:wi("Animation","AnimationStart"),transitionend:wi("Transition","TransitionEnd")},_i={},Si={};function Ei(e){if(_i[e])return _i[e];if(!Di[e])return e;var t,n=Di[e];for(t in n)if(n.hasOwnProperty(t)&&t in Si)return _i[e]=n[t];return e}c&&(Si=document.createElement("div").style,"AnimationEvent"in window||(delete Di.animationend.animation,delete Di.animationiteration.animation,delete Di.animationstart.animation),"TransitionEvent"in window||delete Di.transitionend.transition);var Ci=Ei("animationend"),Ai=Ei("animationiteration"),Mi=Ei("animationstart"),Ti=Ei("transitionend"),Pi=new Map,Fi="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Oi(e,t){Pi.set(e,t),l(t,[e])}for(var Ii=0;Ii<Fi.length;Ii++){var ki=Fi[Ii];Oi(ki.toLowerCase(),"on"+(ki[0].toUpperCase()+ki.slice(1)))}Oi(Ci,"onAnimationEnd"),Oi(Ai,"onAnimationIteration"),Oi(Mi,"onAnimationStart"),Oi("dblclick","onDoubleClick"),Oi("focusin","onFocus"),Oi("focusout","onBlur"),Oi(Ti,"onTransitionEnd"),u("onMouseEnter",["mouseout","mouseover"]),u("onMouseLeave",["mouseout","mouseover"]),u("onPointerEnter",["pointerout","pointerover"]),u("onPointerLeave",["pointerout","pointerover"]),l("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),l("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),l("onBeforeInput",["compositionend","keypress","textInput","paste"]),l("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Bi="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Ri=new Set("cancel close invalid load scroll toggle".split(" ").concat(Bi));function Li(e,t,n){var i=e.type||"unknown-event";e.currentTarget=n,function(e,t,n,i,r,a,o,l,u){if(Ue.apply(this,arguments),Re){if(!Re)throw Error(s(198));var c=Le;Re=!1,Le=null,ze||(ze=!0,Ne=c)}}(i,t,void 0,e),e.currentTarget=null}function zi(e,t){t=0!==(4&t);for(var n=0;n<e.length;n++){var i=e[n],r=i.event;i=i.listeners;e:{var s=void 0;if(t)for(var a=i.length-1;0<=a;a--){var o=i[a],l=o.instance,u=o.currentTarget;if(o=o.listener,l!==s&&r.isPropagationStopped())break e;Li(r,o,u),s=l}else for(a=0;a<i.length;a++){if(l=(o=i[a]).instance,u=o.currentTarget,o=o.listener,l!==s&&r.isPropagationStopped())break e;Li(r,o,u),s=l}}}if(ze)throw e=Ne,ze=!1,Ne=null,e}function Ni(e,t){var n=t[mr];void 0===n&&(n=t[mr]=new Set);var i=e+"__bubble";n.has(i)||(Hi(t,e,2,!1),n.add(i))}function ji(e,t,n){var i=0;t&&(i|=4),Hi(n,e,i,t)}var Ui="_reactListening"+Math.random().toString(36).slice(2);function Vi(e){if(!e[Ui]){e[Ui]=!0,a.forEach((function(t){"selectionchange"!==t&&(Ri.has(t)||ji(t,!1,e),ji(t,!0,e))}));var t=9===e.nodeType?e:e.ownerDocument;null===t||t[Ui]||(t[Ui]=!0,ji("selectionchange",!1,t))}}function Hi(e,t,n,i){switch(Kt(t)){case 1:var r=Gt;break;case 4:r=qt;break;default:r=Yt}n=r.bind(null,t,n,e),r=void 0,!Ie||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(r=!0),i?void 0!==r?e.addEventListener(t,n,{capture:!0,passive:r}):e.addEventListener(t,n,!0):void 0!==r?e.addEventListener(t,n,{passive:r}):e.addEventListener(t,n,!1)}function Wi(e,t,n,i,r){var s=i;if(0===(1&t)&&0===(2&t)&&null!==i)e:for(;;){if(null===i)return;var a=i.tag;if(3===a||4===a){var o=i.stateNode.containerInfo;if(o===r||8===o.nodeType&&o.parentNode===r)break;if(4===a)for(a=i.return;null!==a;){var l=a.tag;if((3===l||4===l)&&((l=a.stateNode.containerInfo)===r||8===l.nodeType&&l.parentNode===r))return;a=a.return}for(;null!==o;){if(null===(a=yr(o)))return;if(5===(l=a.tag)||6===l){i=s=a;continue e}o=o.parentNode}}i=i.return}Fe((function(){var i=s,r=we(n),a=[];e:{var o=Pi.get(e);if(void 0!==o){var l=cn,u=e;switch(e){case"keypress":if(0===tn(n))break e;case"keydown":case"keyup":l=An;break;case"focusin":u="focus",l=gn;break;case"focusout":u="blur",l=gn;break;case"beforeblur":case"afterblur":l=gn;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":l=fn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":l=mn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":l=Tn;break;case Ci:case Ai:case Mi:l=vn;break;case Ti:l=Pn;break;case"scroll":l=dn;break;case"wheel":l=On;break;case"copy":case"cut":case"paste":l=xn;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":l=Mn}var c=0!==(4&t),h=!c&&"scroll"===e,d=c?null!==o?o+"Capture":null:o;c=[];for(var p,f=i;null!==f;){var m=(p=f).stateNode;if(5===p.tag&&null!==m&&(p=m,null!==d&&(null!=(m=Oe(f,d))&&c.push(Gi(f,m,p)))),h)break;f=f.return}0<c.length&&(o=new l(o,u,null,n,r),a.push({event:o,listeners:c}))}}if(0===(7&t)){if(l="mouseout"===e||"pointerout"===e,(!(o="mouseover"===e||"pointerover"===e)||n===be||!(u=n.relatedTarget||n.fromElement)||!yr(u)&&!u[fr])&&(l||o)&&(o=r.window===r?r:(o=r.ownerDocument)?o.defaultView||o.parentWindow:window,l?(l=i,null!==(u=(u=n.relatedTarget||n.toElement)?yr(u):null)&&(u!==(h=Ve(u))||5!==u.tag&&6!==u.tag)&&(u=null)):(l=null,u=i),l!==u)){if(c=fn,m="onMouseLeave",d="onMouseEnter",f="mouse","pointerout"!==e&&"pointerover"!==e||(c=Mn,m="onPointerLeave",d="onPointerEnter",f="pointer"),h=null==l?o:br(l),p=null==u?o:br(u),(o=new c(m,f+"leave",l,n,r)).target=h,o.relatedTarget=p,m=null,yr(r)===i&&((c=new c(d,f+"enter",u,n,r)).target=p,c.relatedTarget=h,m=c),h=m,l&&u)e:{for(d=u,f=0,p=c=l;p;p=Yi(p))f++;for(p=0,m=d;m;m=Yi(m))p++;for(;0<f-p;)c=Yi(c),f--;for(;0<p-f;)d=Yi(d),p--;for(;f--;){if(c===d||null!==d&&c===d.alternate)break e;c=Yi(c),d=Yi(d)}c=null}else c=null;null!==l&&Xi(a,o,l,c,!1),null!==u&&null!==h&&Xi(a,h,u,c,!0)}if("select"===(l=(o=i?br(i):window).nodeName&&o.nodeName.toLowerCase())||"input"===l&&"file"===o.type)var g=Kn;else if(Wn(o))if(Zn)g=ai;else{g=ri;var v=ii}else(l=o.nodeName)&&"input"===l.toLowerCase()&&("checkbox"===o.type||"radio"===o.type)&&(g=si);switch(g&&(g=g(e,i))?Gn(a,g,n,r):(v&&v(e,o,i),"focusout"===e&&(v=o._wrapperState)&&v.controlled&&"number"===o.type&&ee(o,"number",o.value)),v=i?br(i):window,e){case"focusin":(Wn(v)||"true"===v.contentEditable)&&(gi=v,vi=i,yi=null);break;case"focusout":yi=vi=gi=null;break;case"mousedown":xi=!0;break;case"contextmenu":case"mouseup":case"dragend":xi=!1,bi(a,n,r);break;case"selectionchange":if(mi)break;case"keydown":case"keyup":bi(a,n,r)}var y;if(kn)e:{switch(e){case"compositionstart":var x="onCompositionStart";break e;case"compositionend":x="onCompositionEnd";break e;case"compositionupdate":x="onCompositionUpdate";break e}x=void 0}else Vn?jn(e,n)&&(x="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(x="onCompositionStart");x&&(Ln&&"ko"!==n.locale&&(Vn||"onCompositionStart"!==x?"onCompositionEnd"===x&&Vn&&(y=en()):(Jt="value"in(Zt=r)?Zt.value:Zt.textContent,Vn=!0)),0<(v=qi(i,x)).length&&(x=new bn(x,e,null,n,r),a.push({event:x,listeners:v}),y?x.data=y:null!==(y=Un(n))&&(x.data=y))),(y=Rn?function(e,t){switch(e){case"compositionend":return Un(t);case"keypress":return 32!==t.which?null:(Nn=!0,zn);case"textInput":return(e=t.data)===zn&&Nn?null:e;default:return null}}(e,n):function(e,t){if(Vn)return"compositionend"===e||!kn&&jn(e,t)?(e=en(),$t=Jt=Zt=null,Vn=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Ln&&"ko"!==t.locale?null:t.data}}(e,n))&&(0<(i=qi(i,"onBeforeInput")).length&&(r=new bn("onBeforeInput","beforeinput",null,n,r),a.push({event:r,listeners:i}),r.data=y))}zi(a,t)}))}function Gi(e,t,n){return{instance:e,listener:t,currentTarget:n}}function qi(e,t){for(var n=t+"Capture",i=[];null!==e;){var r=e,s=r.stateNode;5===r.tag&&null!==s&&(r=s,null!=(s=Oe(e,n))&&i.unshift(Gi(e,s,r)),null!=(s=Oe(e,t))&&i.push(Gi(e,s,r))),e=e.return}return i}function Yi(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function Xi(e,t,n,i,r){for(var s=t._reactName,a=[];null!==n&&n!==i;){var o=n,l=o.alternate,u=o.stateNode;if(null!==l&&l===i)break;5===o.tag&&null!==u&&(o=u,r?null!=(l=Oe(n,s))&&a.unshift(Gi(n,l,o)):r||null!=(l=Oe(n,s))&&a.push(Gi(n,l,o))),n=n.return}0!==a.length&&e.push({event:t,listeners:a})}var Qi=/\r\n?/g,Ki=/\u0000|\uFFFD/g;function Zi(e){return("string"===typeof e?e:""+e).replace(Qi,"\n").replace(Ki,"")}function Ji(e,t,n){if(t=Zi(t),Zi(e)!==t&&n)throw Error(s(425))}function $i(){}var er=null,tr=null;function nr(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var ir="function"===typeof setTimeout?setTimeout:void 0,rr="function"===typeof clearTimeout?clearTimeout:void 0,sr="function"===typeof Promise?Promise:void 0,ar="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof sr?function(e){return sr.resolve(null).then(e).catch(or)}:ir;function or(e){setTimeout((function(){throw e}))}function lr(e,t){var n=t,i=0;do{var r=n.nextSibling;if(e.removeChild(n),r&&8===r.nodeType)if("/$"===(n=r.data)){if(0===i)return e.removeChild(r),void Vt(t);i--}else"$"!==n&&"$?"!==n&&"$!"!==n||i++;n=r}while(n);Vt(t)}function ur(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t)break;if("/$"===t)return null}}return e}function cr(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n){if(0===t)return e;t--}else"/$"===n&&t++}e=e.previousSibling}return null}var hr=Math.random().toString(36).slice(2),dr="__reactFiber$"+hr,pr="__reactProps$"+hr,fr="__reactContainer$"+hr,mr="__reactEvents$"+hr,gr="__reactListeners$"+hr,vr="__reactHandles$"+hr;function yr(e){var t=e[dr];if(t)return t;for(var n=e.parentNode;n;){if(t=n[fr]||n[dr]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=cr(e);null!==e;){if(n=e[dr])return n;e=cr(e)}return t}n=(e=n).parentNode}return null}function xr(e){return!(e=e[dr]||e[fr])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function br(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(s(33))}function wr(e){return e[pr]||null}var Dr=[],_r=-1;function Sr(e){return{current:e}}function Er(e){0>_r||(e.current=Dr[_r],Dr[_r]=null,_r--)}function Cr(e,t){_r++,Dr[_r]=e.current,e.current=t}var Ar={},Mr=Sr(Ar),Tr=Sr(!1),Pr=Ar;function Fr(e,t){var n=e.type.contextTypes;if(!n)return Ar;var i=e.stateNode;if(i&&i.__reactInternalMemoizedUnmaskedChildContext===t)return i.__reactInternalMemoizedMaskedChildContext;var r,s={};for(r in n)s[r]=t[r];return i&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=s),s}function Or(e){return null!==(e=e.childContextTypes)&&void 0!==e}function Ir(){Er(Tr),Er(Mr)}function kr(e,t,n){if(Mr.current!==Ar)throw Error(s(168));Cr(Mr,t),Cr(Tr,n)}function Br(e,t,n){var i=e.stateNode;if(t=t.childContextTypes,"function"!==typeof i.getChildContext)return n;for(var r in i=i.getChildContext())if(!(r in t))throw Error(s(108,H(e)||"Unknown",r));return L({},n,i)}function Rr(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Ar,Pr=Mr.current,Cr(Mr,e),Cr(Tr,Tr.current),!0}function Lr(e,t,n){var i=e.stateNode;if(!i)throw Error(s(169));n?(e=Br(e,t,Pr),i.__reactInternalMemoizedMergedChildContext=e,Er(Tr),Er(Mr),Cr(Mr,e)):Er(Tr),Cr(Tr,n)}var zr=null,Nr=!1,jr=!1;function Ur(e){null===zr?zr=[e]:zr.push(e)}function Vr(){if(!jr&&null!==zr){jr=!0;var e=0,t=xt;try{var n=zr;for(xt=1;e<n.length;e++){var i=n[e];do{i=i(!0)}while(null!==i)}zr=null,Nr=!1}catch(r){throw null!==zr&&(zr=zr.slice(e+1)),Ye($e,Vr),r}finally{xt=t,jr=!1}}return null}var Hr=[],Wr=0,Gr=null,qr=0,Yr=[],Xr=0,Qr=null,Kr=1,Zr="";function Jr(e,t){Hr[Wr++]=qr,Hr[Wr++]=Gr,Gr=e,qr=t}function $r(e,t,n){Yr[Xr++]=Kr,Yr[Xr++]=Zr,Yr[Xr++]=Qr,Qr=e;var i=Kr;e=Zr;var r=32-at(i)-1;i&=~(1<<r),n+=1;var s=32-at(t)+r;if(30<s){var a=r-r%5;s=(i&(1<<a)-1).toString(32),i>>=a,r-=a,Kr=1<<32-at(t)+r|n<<r|i,Zr=s+e}else Kr=1<<s|n<<r|i,Zr=e}function es(e){null!==e.return&&(Jr(e,1),$r(e,1,0))}function ts(e){for(;e===Gr;)Gr=Hr[--Wr],Hr[Wr]=null,qr=Hr[--Wr],Hr[Wr]=null;for(;e===Qr;)Qr=Yr[--Xr],Yr[Xr]=null,Zr=Yr[--Xr],Yr[Xr]=null,Kr=Yr[--Xr],Yr[Xr]=null}var ns=null,is=null,rs=!1,ss=null;function as(e,t){var n=Fu(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,null===(t=e.deletions)?(e.deletions=[n],e.flags|=16):t.push(n)}function os(e,t){switch(e.tag){case 5:var n=e.type;return null!==(t=1!==t.nodeType||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,ns=e,is=ur(t.firstChild),!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,ns=e,is=null,!0);case 13:return null!==(t=8!==t.nodeType?null:t)&&(n=null!==Qr?{id:Kr,overflow:Zr}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},(n=Fu(18,null,null,0)).stateNode=t,n.return=e,e.child=n,ns=e,is=null,!0);default:return!1}}function ls(e){return 0!==(1&e.mode)&&0===(128&e.flags)}function us(e){if(rs){var t=is;if(t){var n=t;if(!os(e,t)){if(ls(e))throw Error(s(418));t=ur(n.nextSibling);var i=ns;t&&os(e,t)?as(i,n):(e.flags=-4097&e.flags|2,rs=!1,ns=e)}}else{if(ls(e))throw Error(s(418));e.flags=-4097&e.flags|2,rs=!1,ns=e}}}function cs(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;ns=e}function hs(e){if(e!==ns)return!1;if(!rs)return cs(e),rs=!0,!1;var t;if((t=3!==e.tag)&&!(t=5!==e.tag)&&(t="head"!==(t=e.type)&&"body"!==t&&!nr(e.type,e.memoizedProps)),t&&(t=is)){if(ls(e))throw ds(),Error(s(418));for(;t;)as(e,t),t=ur(t.nextSibling)}if(cs(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(s(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var n=e.data;if("/$"===n){if(0===t){is=ur(e.nextSibling);break e}t--}else"$"!==n&&"$!"!==n&&"$?"!==n||t++}e=e.nextSibling}is=null}}else is=ns?ur(e.stateNode.nextSibling):null;return!0}function ds(){for(var e=is;e;)e=ur(e.nextSibling)}function ps(){is=ns=null,rs=!1}function fs(e){null===ss?ss=[e]:ss.push(e)}var ms=b.ReactCurrentBatchConfig;function gs(e,t,n){if(null!==(e=n.ref)&&"function"!==typeof e&&"object"!==typeof e){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(s(309));var i=n.stateNode}if(!i)throw Error(s(147,e));var r=i,a=""+e;return null!==t&&null!==t.ref&&"function"===typeof t.ref&&t.ref._stringRef===a?t.ref:(t=function(e){var t=r.refs;null===e?delete t[a]:t[a]=e},t._stringRef=a,t)}if("string"!==typeof e)throw Error(s(284));if(!n._owner)throw Error(s(290,e))}return e}function vs(e,t){throw e=Object.prototype.toString.call(t),Error(s(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function ys(e){return(0,e._init)(e._payload)}function xs(e){function t(t,n){if(e){var i=t.deletions;null===i?(t.deletions=[n],t.flags|=16):i.push(n)}}function n(n,i){if(!e)return null;for(;null!==i;)t(n,i),i=i.sibling;return null}function i(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function r(e,t){return(e=Iu(e,t)).index=0,e.sibling=null,e}function a(t,n,i){return t.index=i,e?null!==(i=t.alternate)?(i=i.index)<n?(t.flags|=2,n):i:(t.flags|=2,n):(t.flags|=1048576,n)}function o(t){return e&&null===t.alternate&&(t.flags|=2),t}function l(e,t,n,i){return null===t||6!==t.tag?((t=Lu(n,e.mode,i)).return=e,t):((t=r(t,n)).return=e,t)}function u(e,t,n,i){var s=n.type;return s===_?h(e,t,n.props.children,i,n.key):null!==t&&(t.elementType===s||"object"===typeof s&&null!==s&&s.$$typeof===O&&ys(s)===t.type)?((i=r(t,n.props)).ref=gs(e,t,n),i.return=e,i):((i=ku(n.type,n.key,n.props,null,e.mode,i)).ref=gs(e,t,n),i.return=e,i)}function c(e,t,n,i){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=zu(n,e.mode,i)).return=e,t):((t=r(t,n.children||[])).return=e,t)}function h(e,t,n,i,s){return null===t||7!==t.tag?((t=Bu(n,e.mode,i,s)).return=e,t):((t=r(t,n)).return=e,t)}function d(e,t,n){if("string"===typeof t&&""!==t||"number"===typeof t)return(t=Lu(""+t,e.mode,n)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case w:return(n=ku(t.type,t.key,t.props,null,e.mode,n)).ref=gs(e,null,t),n.return=e,n;case D:return(t=zu(t,e.mode,n)).return=e,t;case O:return d(e,(0,t._init)(t._payload),n)}if(te(t)||B(t))return(t=Bu(t,e.mode,n,null)).return=e,t;vs(e,t)}return null}function p(e,t,n,i){var r=null!==t?t.key:null;if("string"===typeof n&&""!==n||"number"===typeof n)return null!==r?null:l(e,t,""+n,i);if("object"===typeof n&&null!==n){switch(n.$$typeof){case w:return n.key===r?u(e,t,n,i):null;case D:return n.key===r?c(e,t,n,i):null;case O:return p(e,t,(r=n._init)(n._payload),i)}if(te(n)||B(n))return null!==r?null:h(e,t,n,i,null);vs(e,n)}return null}function f(e,t,n,i,r){if("string"===typeof i&&""!==i||"number"===typeof i)return l(t,e=e.get(n)||null,""+i,r);if("object"===typeof i&&null!==i){switch(i.$$typeof){case w:return u(t,e=e.get(null===i.key?n:i.key)||null,i,r);case D:return c(t,e=e.get(null===i.key?n:i.key)||null,i,r);case O:return f(e,t,n,(0,i._init)(i._payload),r)}if(te(i)||B(i))return h(t,e=e.get(n)||null,i,r,null);vs(t,i)}return null}function m(r,s,o,l){for(var u=null,c=null,h=s,m=s=0,g=null;null!==h&&m<o.length;m++){h.index>m?(g=h,h=null):g=h.sibling;var v=p(r,h,o[m],l);if(null===v){null===h&&(h=g);break}e&&h&&null===v.alternate&&t(r,h),s=a(v,s,m),null===c?u=v:c.sibling=v,c=v,h=g}if(m===o.length)return n(r,h),rs&&Jr(r,m),u;if(null===h){for(;m<o.length;m++)null!==(h=d(r,o[m],l))&&(s=a(h,s,m),null===c?u=h:c.sibling=h,c=h);return rs&&Jr(r,m),u}for(h=i(r,h);m<o.length;m++)null!==(g=f(h,r,m,o[m],l))&&(e&&null!==g.alternate&&h.delete(null===g.key?m:g.key),s=a(g,s,m),null===c?u=g:c.sibling=g,c=g);return e&&h.forEach((function(e){return t(r,e)})),rs&&Jr(r,m),u}function g(r,o,l,u){var c=B(l);if("function"!==typeof c)throw Error(s(150));if(null==(l=c.call(l)))throw Error(s(151));for(var h=c=null,m=o,g=o=0,v=null,y=l.next();null!==m&&!y.done;g++,y=l.next()){m.index>g?(v=m,m=null):v=m.sibling;var x=p(r,m,y.value,u);if(null===x){null===m&&(m=v);break}e&&m&&null===x.alternate&&t(r,m),o=a(x,o,g),null===h?c=x:h.sibling=x,h=x,m=v}if(y.done)return n(r,m),rs&&Jr(r,g),c;if(null===m){for(;!y.done;g++,y=l.next())null!==(y=d(r,y.value,u))&&(o=a(y,o,g),null===h?c=y:h.sibling=y,h=y);return rs&&Jr(r,g),c}for(m=i(r,m);!y.done;g++,y=l.next())null!==(y=f(m,r,g,y.value,u))&&(e&&null!==y.alternate&&m.delete(null===y.key?g:y.key),o=a(y,o,g),null===h?c=y:h.sibling=y,h=y);return e&&m.forEach((function(e){return t(r,e)})),rs&&Jr(r,g),c}return function e(i,s,a,l){if("object"===typeof a&&null!==a&&a.type===_&&null===a.key&&(a=a.props.children),"object"===typeof a&&null!==a){switch(a.$$typeof){case w:e:{for(var u=a.key,c=s;null!==c;){if(c.key===u){if((u=a.type)===_){if(7===c.tag){n(i,c.sibling),(s=r(c,a.props.children)).return=i,i=s;break e}}else if(c.elementType===u||"object"===typeof u&&null!==u&&u.$$typeof===O&&ys(u)===c.type){n(i,c.sibling),(s=r(c,a.props)).ref=gs(i,c,a),s.return=i,i=s;break e}n(i,c);break}t(i,c),c=c.sibling}a.type===_?((s=Bu(a.props.children,i.mode,l,a.key)).return=i,i=s):((l=ku(a.type,a.key,a.props,null,i.mode,l)).ref=gs(i,s,a),l.return=i,i=l)}return o(i);case D:e:{for(c=a.key;null!==s;){if(s.key===c){if(4===s.tag&&s.stateNode.containerInfo===a.containerInfo&&s.stateNode.implementation===a.implementation){n(i,s.sibling),(s=r(s,a.children||[])).return=i,i=s;break e}n(i,s);break}t(i,s),s=s.sibling}(s=zu(a,i.mode,l)).return=i,i=s}return o(i);case O:return e(i,s,(c=a._init)(a._payload),l)}if(te(a))return m(i,s,a,l);if(B(a))return g(i,s,a,l);vs(i,a)}return"string"===typeof a&&""!==a||"number"===typeof a?(a=""+a,null!==s&&6===s.tag?(n(i,s.sibling),(s=r(s,a)).return=i,i=s):(n(i,s),(s=Lu(a,i.mode,l)).return=i,i=s),o(i)):n(i,s)}}var bs=xs(!0),ws=xs(!1),Ds=Sr(null),_s=null,Ss=null,Es=null;function Cs(){Es=Ss=_s=null}function As(e){var t=Ds.current;Er(Ds),e._currentValue=t}function Ms(e,t,n){for(;null!==e;){var i=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==i&&(i.childLanes|=t)):null!==i&&(i.childLanes&t)!==t&&(i.childLanes|=t),e===n)break;e=e.return}}function Ts(e,t){_s=e,Es=Ss=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!==(e.lanes&t)&&(xo=!0),e.firstContext=null)}function Ps(e){var t=e._currentValue;if(Es!==e)if(e={context:e,memoizedValue:t,next:null},null===Ss){if(null===_s)throw Error(s(308));Ss=e,_s.dependencies={lanes:0,firstContext:e}}else Ss=Ss.next=e;return t}var Fs=null;function Os(e){null===Fs?Fs=[e]:Fs.push(e)}function Is(e,t,n,i){var r=t.interleaved;return null===r?(n.next=n,Os(t)):(n.next=r.next,r.next=n),t.interleaved=n,ks(e,i)}function ks(e,t){e.lanes|=t;var n=e.alternate;for(null!==n&&(n.lanes|=t),n=e,e=e.return;null!==e;)e.childLanes|=t,null!==(n=e.alternate)&&(n.childLanes|=t),n=e,e=e.return;return 3===n.tag?n.stateNode:null}var Bs=!1;function Rs(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Ls(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function zs(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Ns(e,t,n){var i=e.updateQueue;if(null===i)return null;if(i=i.shared,0!==(2&Ml)){var r=i.pending;return null===r?t.next=t:(t.next=r.next,r.next=t),i.pending=t,ks(e,n)}return null===(r=i.interleaved)?(t.next=t,Os(i)):(t.next=r.next,r.next=t),i.interleaved=t,ks(e,n)}function js(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194240&n))){var i=t.lanes;n|=i&=e.pendingLanes,t.lanes=n,yt(e,n)}}function Us(e,t){var n=e.updateQueue,i=e.alternate;if(null!==i&&n===(i=i.updateQueue)){var r=null,s=null;if(null!==(n=n.firstBaseUpdate)){do{var a={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===s?r=s=a:s=s.next=a,n=n.next}while(null!==n);null===s?r=s=t:s=s.next=t}else r=s=t;return n={baseState:i.baseState,firstBaseUpdate:r,lastBaseUpdate:s,shared:i.shared,effects:i.effects},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function Vs(e,t,n,i){var r=e.updateQueue;Bs=!1;var s=r.firstBaseUpdate,a=r.lastBaseUpdate,o=r.shared.pending;if(null!==o){r.shared.pending=null;var l=o,u=l.next;l.next=null,null===a?s=u:a.next=u,a=l;var c=e.alternate;null!==c&&((o=(c=c.updateQueue).lastBaseUpdate)!==a&&(null===o?c.firstBaseUpdate=u:o.next=u,c.lastBaseUpdate=l))}if(null!==s){var h=r.baseState;for(a=0,c=u=l=null,o=s;;){var d=o.lane,p=o.eventTime;if((i&d)===d){null!==c&&(c=c.next={eventTime:p,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var f=e,m=o;switch(d=t,p=n,m.tag){case 1:if("function"===typeof(f=m.payload)){h=f.call(p,h,d);break e}h=f;break e;case 3:f.flags=-65537&f.flags|128;case 0:if(null===(d="function"===typeof(f=m.payload)?f.call(p,h,d):f)||void 0===d)break e;h=L({},h,d);break e;case 2:Bs=!0}}null!==o.callback&&0!==o.lane&&(e.flags|=64,null===(d=r.effects)?r.effects=[o]:d.push(o))}else p={eventTime:p,lane:d,tag:o.tag,payload:o.payload,callback:o.callback,next:null},null===c?(u=c=p,l=h):c=c.next=p,a|=d;if(null===(o=o.next)){if(null===(o=r.shared.pending))break;o=(d=o).next,d.next=null,r.lastBaseUpdate=d,r.shared.pending=null}}if(null===c&&(l=h),r.baseState=l,r.firstBaseUpdate=u,r.lastBaseUpdate=c,null!==(t=r.shared.interleaved)){r=t;do{a|=r.lane,r=r.next}while(r!==t)}else null===s&&(r.shared.lanes=0);Rl|=a,e.lanes=a,e.memoizedState=h}}function Hs(e,t,n){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var i=e[t],r=i.callback;if(null!==r){if(i.callback=null,i=n,"function"!==typeof r)throw Error(s(191,r));r.call(i)}}}var Ws={},Gs=Sr(Ws),qs=Sr(Ws),Ys=Sr(Ws);function Xs(e){if(e===Ws)throw Error(s(174));return e}function Qs(e,t){switch(Cr(Ys,t),Cr(qs,e),Cr(Gs,Ws),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:le(null,"");break;default:t=le(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}Er(Gs),Cr(Gs,t)}function Ks(){Er(Gs),Er(qs),Er(Ys)}function Zs(e){Xs(Ys.current);var t=Xs(Gs.current),n=le(t,e.type);t!==n&&(Cr(qs,e),Cr(Gs,n))}function Js(e){qs.current===e&&(Er(Gs),Er(qs))}var $s=Sr(0);function ea(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||"$!"===n.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var ta=[];function na(){for(var e=0;e<ta.length;e++)ta[e]._workInProgressVersionPrimary=null;ta.length=0}var ia=b.ReactCurrentDispatcher,ra=b.ReactCurrentBatchConfig,sa=0,aa=null,oa=null,la=null,ua=!1,ca=!1,ha=0,da=0;function pa(){throw Error(s(321))}function fa(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!oi(e[n],t[n]))return!1;return!0}function ma(e,t,n,i,r,a){if(sa=a,aa=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,ia.current=null===e||null===e.memoizedState?Ja:$a,e=n(i,r),ca){a=0;do{if(ca=!1,ha=0,25<=a)throw Error(s(301));a+=1,la=oa=null,t.updateQueue=null,ia.current=eo,e=n(i,r)}while(ca)}if(ia.current=Za,t=null!==oa&&null!==oa.next,sa=0,la=oa=aa=null,ua=!1,t)throw Error(s(300));return e}function ga(){var e=0!==ha;return ha=0,e}function va(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===la?aa.memoizedState=la=e:la=la.next=e,la}function ya(){if(null===oa){var e=aa.alternate;e=null!==e?e.memoizedState:null}else e=oa.next;var t=null===la?aa.memoizedState:la.next;if(null!==t)la=t,oa=e;else{if(null===e)throw Error(s(310));e={memoizedState:(oa=e).memoizedState,baseState:oa.baseState,baseQueue:oa.baseQueue,queue:oa.queue,next:null},null===la?aa.memoizedState=la=e:la=la.next=e}return la}function xa(e,t){return"function"===typeof t?t(e):t}function ba(e){var t=ya(),n=t.queue;if(null===n)throw Error(s(311));n.lastRenderedReducer=e;var i=oa,r=i.baseQueue,a=n.pending;if(null!==a){if(null!==r){var o=r.next;r.next=a.next,a.next=o}i.baseQueue=r=a,n.pending=null}if(null!==r){a=r.next,i=i.baseState;var l=o=null,u=null,c=a;do{var h=c.lane;if((sa&h)===h)null!==u&&(u=u.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),i=c.hasEagerState?c.eagerState:e(i,c.action);else{var d={lane:h,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};null===u?(l=u=d,o=i):u=u.next=d,aa.lanes|=h,Rl|=h}c=c.next}while(null!==c&&c!==a);null===u?o=i:u.next=l,oi(i,t.memoizedState)||(xo=!0),t.memoizedState=i,t.baseState=o,t.baseQueue=u,n.lastRenderedState=i}if(null!==(e=n.interleaved)){r=e;do{a=r.lane,aa.lanes|=a,Rl|=a,r=r.next}while(r!==e)}else null===r&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function wa(e){var t=ya(),n=t.queue;if(null===n)throw Error(s(311));n.lastRenderedReducer=e;var i=n.dispatch,r=n.pending,a=t.memoizedState;if(null!==r){n.pending=null;var o=r=r.next;do{a=e(a,o.action),o=o.next}while(o!==r);oi(a,t.memoizedState)||(xo=!0),t.memoizedState=a,null===t.baseQueue&&(t.baseState=a),n.lastRenderedState=a}return[a,i]}function Da(){}function _a(e,t){var n=aa,i=ya(),r=t(),a=!oi(i.memoizedState,r);if(a&&(i.memoizedState=r,xo=!0),i=i.queue,Ba(Ca.bind(null,n,i,e),[e]),i.getSnapshot!==t||a||null!==la&&1&la.memoizedState.tag){if(n.flags|=2048,Pa(9,Ea.bind(null,n,i,r,t),void 0,null),null===Tl)throw Error(s(349));0!==(30&sa)||Sa(n,t,r)}return r}function Sa(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=aa.updateQueue)?(t={lastEffect:null,stores:null},aa.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function Ea(e,t,n,i){t.value=n,t.getSnapshot=i,Aa(t)&&Ma(e)}function Ca(e,t,n){return n((function(){Aa(t)&&Ma(e)}))}function Aa(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!oi(e,n)}catch(i){return!0}}function Ma(e){var t=ks(e,1);null!==t&&nu(t,e,1,-1)}function Ta(e){var t=va();return"function"===typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:xa,lastRenderedState:e},t.queue=e,e=e.dispatch=Ya.bind(null,aa,e),[t.memoizedState,e]}function Pa(e,t,n,i){return e={tag:e,create:t,destroy:n,deps:i,next:null},null===(t=aa.updateQueue)?(t={lastEffect:null,stores:null},aa.updateQueue=t,t.lastEffect=e.next=e):null===(n=t.lastEffect)?t.lastEffect=e.next=e:(i=n.next,n.next=e,e.next=i,t.lastEffect=e),e}function Fa(){return ya().memoizedState}function Oa(e,t,n,i){var r=va();aa.flags|=e,r.memoizedState=Pa(1|t,n,void 0,void 0===i?null:i)}function Ia(e,t,n,i){var r=ya();i=void 0===i?null:i;var s=void 0;if(null!==oa){var a=oa.memoizedState;if(s=a.destroy,null!==i&&fa(i,a.deps))return void(r.memoizedState=Pa(t,n,s,i))}aa.flags|=e,r.memoizedState=Pa(1|t,n,s,i)}function ka(e,t){return Oa(8390656,8,e,t)}function Ba(e,t){return Ia(2048,8,e,t)}function Ra(e,t){return Ia(4,2,e,t)}function La(e,t){return Ia(4,4,e,t)}function za(e,t){return"function"===typeof t?(e=e(),t(e),function(){t(null)}):null!==t&&void 0!==t?(e=e(),t.current=e,function(){t.current=null}):void 0}function Na(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Ia(4,4,za.bind(null,t,e),n)}function ja(){}function Ua(e,t){var n=ya();t=void 0===t?null:t;var i=n.memoizedState;return null!==i&&null!==t&&fa(t,i[1])?i[0]:(n.memoizedState=[e,t],e)}function Va(e,t){var n=ya();t=void 0===t?null:t;var i=n.memoizedState;return null!==i&&null!==t&&fa(t,i[1])?i[0]:(e=e(),n.memoizedState=[e,t],e)}function Ha(e,t,n){return 0===(21&sa)?(e.baseState&&(e.baseState=!1,xo=!0),e.memoizedState=n):(oi(n,t)||(n=mt(),aa.lanes|=n,Rl|=n,e.baseState=!0),t)}function Wa(e,t){var n=xt;xt=0!==n&&4>n?n:4,e(!0);var i=ra.transition;ra.transition={};try{e(!1),t()}finally{xt=n,ra.transition=i}}function Ga(){return ya().memoizedState}function qa(e,t,n){var i=tu(e);if(n={lane:i,action:n,hasEagerState:!1,eagerState:null,next:null},Xa(e))Qa(t,n);else if(null!==(n=Is(e,t,n,i))){nu(n,e,i,eu()),Ka(n,t,i)}}function Ya(e,t,n){var i=tu(e),r={lane:i,action:n,hasEagerState:!1,eagerState:null,next:null};if(Xa(e))Qa(t,r);else{var s=e.alternate;if(0===e.lanes&&(null===s||0===s.lanes)&&null!==(s=t.lastRenderedReducer))try{var a=t.lastRenderedState,o=s(a,n);if(r.hasEagerState=!0,r.eagerState=o,oi(o,a)){var l=t.interleaved;return null===l?(r.next=r,Os(t)):(r.next=l.next,l.next=r),void(t.interleaved=r)}}catch(u){}null!==(n=Is(e,t,r,i))&&(nu(n,e,i,r=eu()),Ka(n,t,i))}}function Xa(e){var t=e.alternate;return e===aa||null!==t&&t===aa}function Qa(e,t){ca=ua=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function Ka(e,t,n){if(0!==(4194240&n)){var i=t.lanes;n|=i&=e.pendingLanes,t.lanes=n,yt(e,n)}}var Za={readContext:Ps,useCallback:pa,useContext:pa,useEffect:pa,useImperativeHandle:pa,useInsertionEffect:pa,useLayoutEffect:pa,useMemo:pa,useReducer:pa,useRef:pa,useState:pa,useDebugValue:pa,useDeferredValue:pa,useTransition:pa,useMutableSource:pa,useSyncExternalStore:pa,useId:pa,unstable_isNewReconciler:!1},Ja={readContext:Ps,useCallback:function(e,t){return va().memoizedState=[e,void 0===t?null:t],e},useContext:Ps,useEffect:ka,useImperativeHandle:function(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Oa(4194308,4,za.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Oa(4194308,4,e,t)},useInsertionEffect:function(e,t){return Oa(4,2,e,t)},useMemo:function(e,t){var n=va();return t=void 0===t?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var i=va();return t=void 0!==n?n(t):t,i.memoizedState=i.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},i.queue=e,e=e.dispatch=qa.bind(null,aa,e),[i.memoizedState,e]},useRef:function(e){return e={current:e},va().memoizedState=e},useState:Ta,useDebugValue:ja,useDeferredValue:function(e){return va().memoizedState=e},useTransition:function(){var e=Ta(!1),t=e[0];return e=Wa.bind(null,e[1]),va().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var i=aa,r=va();if(rs){if(void 0===n)throw Error(s(407));n=n()}else{if(n=t(),null===Tl)throw Error(s(349));0!==(30&sa)||Sa(i,t,n)}r.memoizedState=n;var a={value:n,getSnapshot:t};return r.queue=a,ka(Ca.bind(null,i,a,e),[e]),i.flags|=2048,Pa(9,Ea.bind(null,i,a,n,t),void 0,null),n},useId:function(){var e=va(),t=Tl.identifierPrefix;if(rs){var n=Zr;t=":"+t+"R"+(n=(Kr&~(1<<32-at(Kr)-1)).toString(32)+n),0<(n=ha++)&&(t+="H"+n.toString(32)),t+=":"}else t=":"+t+"r"+(n=da++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},$a={readContext:Ps,useCallback:Ua,useContext:Ps,useEffect:Ba,useImperativeHandle:Na,useInsertionEffect:Ra,useLayoutEffect:La,useMemo:Va,useReducer:ba,useRef:Fa,useState:function(){return ba(xa)},useDebugValue:ja,useDeferredValue:function(e){return Ha(ya(),oa.memoizedState,e)},useTransition:function(){return[ba(xa)[0],ya().memoizedState]},useMutableSource:Da,useSyncExternalStore:_a,useId:Ga,unstable_isNewReconciler:!1},eo={readContext:Ps,useCallback:Ua,useContext:Ps,useEffect:Ba,useImperativeHandle:Na,useInsertionEffect:Ra,useLayoutEffect:La,useMemo:Va,useReducer:wa,useRef:Fa,useState:function(){return wa(xa)},useDebugValue:ja,useDeferredValue:function(e){var t=ya();return null===oa?t.memoizedState=e:Ha(t,oa.memoizedState,e)},useTransition:function(){return[wa(xa)[0],ya().memoizedState]},useMutableSource:Da,useSyncExternalStore:_a,useId:Ga,unstable_isNewReconciler:!1};function to(e,t){if(e&&e.defaultProps){for(var n in t=L({},t),e=e.defaultProps)void 0===t[n]&&(t[n]=e[n]);return t}return t}function no(e,t,n,i){n=null===(n=n(i,t=e.memoizedState))||void 0===n?t:L({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}var io={isMounted:function(e){return!!(e=e._reactInternals)&&Ve(e)===e},enqueueSetState:function(e,t,n){e=e._reactInternals;var i=eu(),r=tu(e),s=zs(i,r);s.payload=t,void 0!==n&&null!==n&&(s.callback=n),null!==(t=Ns(e,s,r))&&(nu(t,e,r,i),js(t,e,r))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var i=eu(),r=tu(e),s=zs(i,r);s.tag=1,s.payload=t,void 0!==n&&null!==n&&(s.callback=n),null!==(t=Ns(e,s,r))&&(nu(t,e,r,i),js(t,e,r))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=eu(),i=tu(e),r=zs(n,i);r.tag=2,void 0!==t&&null!==t&&(r.callback=t),null!==(t=Ns(e,r,i))&&(nu(t,e,i,n),js(t,e,i))}};function ro(e,t,n,i,r,s,a){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(i,s,a):!t.prototype||!t.prototype.isPureReactComponent||(!li(n,i)||!li(r,s))}function so(e,t,n){var i=!1,r=Ar,s=t.contextType;return"object"===typeof s&&null!==s?s=Ps(s):(r=Or(t)?Pr:Mr.current,s=(i=null!==(i=t.contextTypes)&&void 0!==i)?Fr(e,r):Ar),t=new t(n,s),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=io,e.stateNode=t,t._reactInternals=e,i&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=r,e.__reactInternalMemoizedMaskedChildContext=s),t}function ao(e,t,n,i){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,i),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,i),t.state!==e&&io.enqueueReplaceState(t,t.state,null)}function oo(e,t,n,i){var r=e.stateNode;r.props=n,r.state=e.memoizedState,r.refs={},Rs(e);var s=t.contextType;"object"===typeof s&&null!==s?r.context=Ps(s):(s=Or(t)?Pr:Mr.current,r.context=Fr(e,s)),r.state=e.memoizedState,"function"===typeof(s=t.getDerivedStateFromProps)&&(no(e,t,s,n),r.state=e.memoizedState),"function"===typeof t.getDerivedStateFromProps||"function"===typeof r.getSnapshotBeforeUpdate||"function"!==typeof r.UNSAFE_componentWillMount&&"function"!==typeof r.componentWillMount||(t=r.state,"function"===typeof r.componentWillMount&&r.componentWillMount(),"function"===typeof r.UNSAFE_componentWillMount&&r.UNSAFE_componentWillMount(),t!==r.state&&io.enqueueReplaceState(r,r.state,null),Vs(e,n,r,i),r.state=e.memoizedState),"function"===typeof r.componentDidMount&&(e.flags|=4194308)}function lo(e,t){try{var n="",i=t;do{n+=U(i),i=i.return}while(i);var r=n}catch(s){r="\nError generating stack: "+s.message+"\n"+s.stack}return{value:e,source:t,stack:r,digest:null}}function uo(e,t,n){return{value:e,source:null,stack:null!=n?n:null,digest:null!=t?t:null}}function co(e,t){try{console.error(t.value)}catch(n){setTimeout((function(){throw n}))}}var ho="function"===typeof WeakMap?WeakMap:Map;function po(e,t,n){(n=zs(-1,n)).tag=3,n.payload={element:null};var i=t.value;return n.callback=function(){Wl||(Wl=!0,Gl=i),co(0,t)},n}function fo(e,t,n){(n=zs(-1,n)).tag=3;var i=e.type.getDerivedStateFromError;if("function"===typeof i){var r=t.value;n.payload=function(){return i(r)},n.callback=function(){co(0,t)}}var s=e.stateNode;return null!==s&&"function"===typeof s.componentDidCatch&&(n.callback=function(){co(0,t),"function"!==typeof i&&(null===ql?ql=new Set([this]):ql.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),n}function mo(e,t,n){var i=e.pingCache;if(null===i){i=e.pingCache=new ho;var r=new Set;i.set(t,r)}else void 0===(r=i.get(t))&&(r=new Set,i.set(t,r));r.has(n)||(r.add(n),e=Eu.bind(null,e,t,n),t.then(e,e))}function go(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function vo(e,t,n,i,r){return 0===(1&e.mode)?(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,1===n.tag&&(null===n.alternate?n.tag=17:((t=zs(-1,1)).tag=2,Ns(n,t,1))),n.lanes|=1),e):(e.flags|=65536,e.lanes=r,e)}var yo=b.ReactCurrentOwner,xo=!1;function bo(e,t,n,i){t.child=null===e?ws(t,null,n,i):bs(t,e.child,n,i)}function wo(e,t,n,i,r){n=n.render;var s=t.ref;return Ts(t,r),i=ma(e,t,n,i,s,r),n=ga(),null===e||xo?(rs&&n&&es(t),t.flags|=1,bo(e,t,i,r),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~r,Wo(e,t,r))}function Do(e,t,n,i,r){if(null===e){var s=n.type;return"function"!==typeof s||Ou(s)||void 0!==s.defaultProps||null!==n.compare||void 0!==n.defaultProps?((e=ku(n.type,null,i,t,t.mode,r)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=s,_o(e,t,s,i,r))}if(s=e.child,0===(e.lanes&r)){var a=s.memoizedProps;if((n=null!==(n=n.compare)?n:li)(a,i)&&e.ref===t.ref)return Wo(e,t,r)}return t.flags|=1,(e=Iu(s,i)).ref=t.ref,e.return=t,t.child=e}function _o(e,t,n,i,r){if(null!==e){var s=e.memoizedProps;if(li(s,i)&&e.ref===t.ref){if(xo=!1,t.pendingProps=i=s,0===(e.lanes&r))return t.lanes=e.lanes,Wo(e,t,r);0!==(131072&e.flags)&&(xo=!0)}}return Co(e,t,n,i,r)}function So(e,t,n){var i=t.pendingProps,r=i.children,s=null!==e?e.memoizedState:null;if("hidden"===i.mode)if(0===(1&t.mode))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Cr(Il,Ol),Ol|=n;else{if(0===(1073741824&n))return e=null!==s?s.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Cr(Il,Ol),Ol|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},i=null!==s?s.baseLanes:n,Cr(Il,Ol),Ol|=i}else null!==s?(i=s.baseLanes|n,t.memoizedState=null):i=n,Cr(Il,Ol),Ol|=i;return bo(e,t,r,n),t.child}function Eo(e,t){var n=t.ref;(null===e&&null!==n||null!==e&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function Co(e,t,n,i,r){var s=Or(n)?Pr:Mr.current;return s=Fr(t,s),Ts(t,r),n=ma(e,t,n,i,s,r),i=ga(),null===e||xo?(rs&&i&&es(t),t.flags|=1,bo(e,t,n,r),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~r,Wo(e,t,r))}function Ao(e,t,n,i,r){if(Or(n)){var s=!0;Rr(t)}else s=!1;if(Ts(t,r),null===t.stateNode)Ho(e,t),so(t,n,i),oo(t,n,i,r),i=!0;else if(null===e){var a=t.stateNode,o=t.memoizedProps;a.props=o;var l=a.context,u=n.contextType;"object"===typeof u&&null!==u?u=Ps(u):u=Fr(t,u=Or(n)?Pr:Mr.current);var c=n.getDerivedStateFromProps,h="function"===typeof c||"function"===typeof a.getSnapshotBeforeUpdate;h||"function"!==typeof a.UNSAFE_componentWillReceiveProps&&"function"!==typeof a.componentWillReceiveProps||(o!==i||l!==u)&&ao(t,a,i,u),Bs=!1;var d=t.memoizedState;a.state=d,Vs(t,i,a,r),l=t.memoizedState,o!==i||d!==l||Tr.current||Bs?("function"===typeof c&&(no(t,n,c,i),l=t.memoizedState),(o=Bs||ro(t,n,o,i,d,l,u))?(h||"function"!==typeof a.UNSAFE_componentWillMount&&"function"!==typeof a.componentWillMount||("function"===typeof a.componentWillMount&&a.componentWillMount(),"function"===typeof a.UNSAFE_componentWillMount&&a.UNSAFE_componentWillMount()),"function"===typeof a.componentDidMount&&(t.flags|=4194308)):("function"===typeof a.componentDidMount&&(t.flags|=4194308),t.memoizedProps=i,t.memoizedState=l),a.props=i,a.state=l,a.context=u,i=o):("function"===typeof a.componentDidMount&&(t.flags|=4194308),i=!1)}else{a=t.stateNode,Ls(e,t),o=t.memoizedProps,u=t.type===t.elementType?o:to(t.type,o),a.props=u,h=t.pendingProps,d=a.context,"object"===typeof(l=n.contextType)&&null!==l?l=Ps(l):l=Fr(t,l=Or(n)?Pr:Mr.current);var p=n.getDerivedStateFromProps;(c="function"===typeof p||"function"===typeof a.getSnapshotBeforeUpdate)||"function"!==typeof a.UNSAFE_componentWillReceiveProps&&"function"!==typeof a.componentWillReceiveProps||(o!==h||d!==l)&&ao(t,a,i,l),Bs=!1,d=t.memoizedState,a.state=d,Vs(t,i,a,r);var f=t.memoizedState;o!==h||d!==f||Tr.current||Bs?("function"===typeof p&&(no(t,n,p,i),f=t.memoizedState),(u=Bs||ro(t,n,u,i,d,f,l)||!1)?(c||"function"!==typeof a.UNSAFE_componentWillUpdate&&"function"!==typeof a.componentWillUpdate||("function"===typeof a.componentWillUpdate&&a.componentWillUpdate(i,f,l),"function"===typeof a.UNSAFE_componentWillUpdate&&a.UNSAFE_componentWillUpdate(i,f,l)),"function"===typeof a.componentDidUpdate&&(t.flags|=4),"function"===typeof a.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof a.componentDidUpdate||o===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),"function"!==typeof a.getSnapshotBeforeUpdate||o===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),t.memoizedProps=i,t.memoizedState=f),a.props=i,a.state=f,a.context=l,i=u):("function"!==typeof a.componentDidUpdate||o===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),"function"!==typeof a.getSnapshotBeforeUpdate||o===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),i=!1)}return Mo(e,t,n,i,s,r)}function Mo(e,t,n,i,r,s){Eo(e,t);var a=0!==(128&t.flags);if(!i&&!a)return r&&Lr(t,n,!1),Wo(e,t,s);i=t.stateNode,yo.current=t;var o=a&&"function"!==typeof n.getDerivedStateFromError?null:i.render();return t.flags|=1,null!==e&&a?(t.child=bs(t,e.child,null,s),t.child=bs(t,null,o,s)):bo(e,t,o,s),t.memoizedState=i.state,r&&Lr(t,n,!0),t.child}function To(e){var t=e.stateNode;t.pendingContext?kr(0,t.pendingContext,t.pendingContext!==t.context):t.context&&kr(0,t.context,!1),Qs(e,t.containerInfo)}function Po(e,t,n,i,r){return ps(),fs(r),t.flags|=256,bo(e,t,n,i),t.child}var Fo,Oo,Io,ko,Bo={dehydrated:null,treeContext:null,retryLane:0};function Ro(e){return{baseLanes:e,cachePool:null,transitions:null}}function Lo(e,t,n){var i,r=t.pendingProps,a=$s.current,o=!1,l=0!==(128&t.flags);if((i=l)||(i=(null===e||null!==e.memoizedState)&&0!==(2&a)),i?(o=!0,t.flags&=-129):null!==e&&null===e.memoizedState||(a|=1),Cr($s,1&a),null===e)return us(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(0===(1&t.mode)?t.lanes=1:"$!"===e.data?t.lanes=8:t.lanes=1073741824,null):(l=r.children,e=r.fallback,o?(r=t.mode,o=t.child,l={mode:"hidden",children:l},0===(1&r)&&null!==o?(o.childLanes=0,o.pendingProps=l):o=Ru(l,r,0,null),e=Bu(e,r,n,null),o.return=t,e.return=t,o.sibling=e,t.child=o,t.child.memoizedState=Ro(n),t.memoizedState=Bo,e):zo(t,l));if(null!==(a=e.memoizedState)&&null!==(i=a.dehydrated))return function(e,t,n,i,r,a,o){if(n)return 256&t.flags?(t.flags&=-257,No(e,t,o,i=uo(Error(s(422))))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(a=i.fallback,r=t.mode,i=Ru({mode:"visible",children:i.children},r,0,null),(a=Bu(a,r,o,null)).flags|=2,i.return=t,a.return=t,i.sibling=a,t.child=i,0!==(1&t.mode)&&bs(t,e.child,null,o),t.child.memoizedState=Ro(o),t.memoizedState=Bo,a);if(0===(1&t.mode))return No(e,t,o,null);if("$!"===r.data){if(i=r.nextSibling&&r.nextSibling.dataset)var l=i.dgst;return i=l,No(e,t,o,i=uo(a=Error(s(419)),i,void 0))}if(l=0!==(o&e.childLanes),xo||l){if(null!==(i=Tl)){switch(o&-o){case 4:r=2;break;case 16:r=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:r=32;break;case 536870912:r=268435456;break;default:r=0}0!==(r=0!==(r&(i.suspendedLanes|o))?0:r)&&r!==a.retryLane&&(a.retryLane=r,ks(e,r),nu(i,e,r,-1))}return mu(),No(e,t,o,i=uo(Error(s(421))))}return"$?"===r.data?(t.flags|=128,t.child=e.child,t=Au.bind(null,e),r._reactRetry=t,null):(e=a.treeContext,is=ur(r.nextSibling),ns=t,rs=!0,ss=null,null!==e&&(Yr[Xr++]=Kr,Yr[Xr++]=Zr,Yr[Xr++]=Qr,Kr=e.id,Zr=e.overflow,Qr=t),t=zo(t,i.children),t.flags|=4096,t)}(e,t,l,r,i,a,n);if(o){o=r.fallback,l=t.mode,i=(a=e.child).sibling;var u={mode:"hidden",children:r.children};return 0===(1&l)&&t.child!==a?((r=t.child).childLanes=0,r.pendingProps=u,t.deletions=null):(r=Iu(a,u)).subtreeFlags=14680064&a.subtreeFlags,null!==i?o=Iu(i,o):(o=Bu(o,l,n,null)).flags|=2,o.return=t,r.return=t,r.sibling=o,t.child=r,r=o,o=t.child,l=null===(l=e.child.memoizedState)?Ro(n):{baseLanes:l.baseLanes|n,cachePool:null,transitions:l.transitions},o.memoizedState=l,o.childLanes=e.childLanes&~n,t.memoizedState=Bo,r}return e=(o=e.child).sibling,r=Iu(o,{mode:"visible",children:r.children}),0===(1&t.mode)&&(r.lanes=n),r.return=t,r.sibling=null,null!==e&&(null===(n=t.deletions)?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=r,t.memoizedState=null,r}function zo(e,t){return(t=Ru({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function No(e,t,n,i){return null!==i&&fs(i),bs(t,e.child,null,n),(e=zo(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function jo(e,t,n){e.lanes|=t;var i=e.alternate;null!==i&&(i.lanes|=t),Ms(e.return,t,n)}function Uo(e,t,n,i,r){var s=e.memoizedState;null===s?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:i,tail:n,tailMode:r}:(s.isBackwards=t,s.rendering=null,s.renderingStartTime=0,s.last=i,s.tail=n,s.tailMode=r)}function Vo(e,t,n){var i=t.pendingProps,r=i.revealOrder,s=i.tail;if(bo(e,t,i.children,n),0!==(2&(i=$s.current)))i=1&i|2,t.flags|=128;else{if(null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&jo(e,n,t);else if(19===e.tag)jo(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}i&=1}if(Cr($s,i),0===(1&t.mode))t.memoizedState=null;else switch(r){case"forwards":for(n=t.child,r=null;null!==n;)null!==(e=n.alternate)&&null===ea(e)&&(r=n),n=n.sibling;null===(n=r)?(r=t.child,t.child=null):(r=n.sibling,n.sibling=null),Uo(t,!1,r,n,s);break;case"backwards":for(n=null,r=t.child,t.child=null;null!==r;){if(null!==(e=r.alternate)&&null===ea(e)){t.child=r;break}e=r.sibling,r.sibling=n,n=r,r=e}Uo(t,!0,n,null,s);break;case"together":Uo(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Ho(e,t){0===(1&t.mode)&&null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Wo(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),Rl|=t.lanes,0===(n&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(s(153));if(null!==t.child){for(n=Iu(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=Iu(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function Go(e,t){if(!rs)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var i=null;null!==n;)null!==n.alternate&&(i=n),n=n.sibling;null===i?t||null===e.tail?e.tail=null:e.tail.sibling=null:i.sibling=null}}function qo(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,i=0;if(t)for(var r=e.child;null!==r;)n|=r.lanes|r.childLanes,i|=14680064&r.subtreeFlags,i|=14680064&r.flags,r.return=e,r=r.sibling;else for(r=e.child;null!==r;)n|=r.lanes|r.childLanes,i|=r.subtreeFlags,i|=r.flags,r.return=e,r=r.sibling;return e.subtreeFlags|=i,e.childLanes=n,t}function Yo(e,t,n){var i=t.pendingProps;switch(ts(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return qo(t),null;case 1:case 17:return Or(t.type)&&Ir(),qo(t),null;case 3:return i=t.stateNode,Ks(),Er(Tr),Er(Mr),na(),i.pendingContext&&(i.context=i.pendingContext,i.pendingContext=null),null!==e&&null!==e.child||(hs(t)?t.flags|=4:null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,null!==ss&&(au(ss),ss=null))),Oo(e,t),qo(t),null;case 5:Js(t);var r=Xs(Ys.current);if(n=t.type,null!==e&&null!=t.stateNode)Io(e,t,n,i,r),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!i){if(null===t.stateNode)throw Error(s(166));return qo(t),null}if(e=Xs(Gs.current),hs(t)){i=t.stateNode,n=t.type;var a=t.memoizedProps;switch(i[dr]=t,i[pr]=a,e=0!==(1&t.mode),n){case"dialog":Ni("cancel",i),Ni("close",i);break;case"iframe":case"object":case"embed":Ni("load",i);break;case"video":case"audio":for(r=0;r<Bi.length;r++)Ni(Bi[r],i);break;case"source":Ni("error",i);break;case"img":case"image":case"link":Ni("error",i),Ni("load",i);break;case"details":Ni("toggle",i);break;case"input":K(i,a),Ni("invalid",i);break;case"select":i._wrapperState={wasMultiple:!!a.multiple},Ni("invalid",i);break;case"textarea":re(i,a),Ni("invalid",i)}for(var l in ye(n,a),r=null,a)if(a.hasOwnProperty(l)){var u=a[l];"children"===l?"string"===typeof u?i.textContent!==u&&(!0!==a.suppressHydrationWarning&&Ji(i.textContent,u,e),r=["children",u]):"number"===typeof u&&i.textContent!==""+u&&(!0!==a.suppressHydrationWarning&&Ji(i.textContent,u,e),r=["children",""+u]):o.hasOwnProperty(l)&&null!=u&&"onScroll"===l&&Ni("scroll",i)}switch(n){case"input":q(i),$(i,a,!0);break;case"textarea":q(i),ae(i);break;case"select":case"option":break;default:"function"===typeof a.onClick&&(i.onclick=$i)}i=r,t.updateQueue=i,null!==i&&(t.flags|=4)}else{l=9===r.nodeType?r:r.ownerDocument,"http://www.w3.org/1999/xhtml"===e&&(e=oe(n)),"http://www.w3.org/1999/xhtml"===e?"script"===n?((e=l.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"===typeof i.is?e=l.createElement(n,{is:i.is}):(e=l.createElement(n),"select"===n&&(l=e,i.multiple?l.multiple=!0:i.size&&(l.size=i.size))):e=l.createElementNS(e,n),e[dr]=t,e[pr]=i,Fo(e,t,!1,!1),t.stateNode=e;e:{switch(l=xe(n,i),n){case"dialog":Ni("cancel",e),Ni("close",e),r=i;break;case"iframe":case"object":case"embed":Ni("load",e),r=i;break;case"video":case"audio":for(r=0;r<Bi.length;r++)Ni(Bi[r],e);r=i;break;case"source":Ni("error",e),r=i;break;case"img":case"image":case"link":Ni("error",e),Ni("load",e),r=i;break;case"details":Ni("toggle",e),r=i;break;case"input":K(e,i),r=Q(e,i),Ni("invalid",e);break;case"option":default:r=i;break;case"select":e._wrapperState={wasMultiple:!!i.multiple},r=L({},i,{value:void 0}),Ni("invalid",e);break;case"textarea":re(e,i),r=ie(e,i),Ni("invalid",e)}for(a in ye(n,r),u=r)if(u.hasOwnProperty(a)){var c=u[a];"style"===a?ge(e,c):"dangerouslySetInnerHTML"===a?null!=(c=c?c.__html:void 0)&&he(e,c):"children"===a?"string"===typeof c?("textarea"!==n||""!==c)&&de(e,c):"number"===typeof c&&de(e,""+c):"suppressContentEditableWarning"!==a&&"suppressHydrationWarning"!==a&&"autoFocus"!==a&&(o.hasOwnProperty(a)?null!=c&&"onScroll"===a&&Ni("scroll",e):null!=c&&x(e,a,c,l))}switch(n){case"input":q(e),$(e,i,!1);break;case"textarea":q(e),ae(e);break;case"option":null!=i.value&&e.setAttribute("value",""+W(i.value));break;case"select":e.multiple=!!i.multiple,null!=(a=i.value)?ne(e,!!i.multiple,a,!1):null!=i.defaultValue&&ne(e,!!i.multiple,i.defaultValue,!0);break;default:"function"===typeof r.onClick&&(e.onclick=$i)}switch(n){case"button":case"input":case"select":case"textarea":i=!!i.autoFocus;break e;case"img":i=!0;break e;default:i=!1}}i&&(t.flags|=4)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return qo(t),null;case 6:if(e&&null!=t.stateNode)ko(e,t,e.memoizedProps,i);else{if("string"!==typeof i&&null===t.stateNode)throw Error(s(166));if(n=Xs(Ys.current),Xs(Gs.current),hs(t)){if(i=t.stateNode,n=t.memoizedProps,i[dr]=t,(a=i.nodeValue!==n)&&null!==(e=ns))switch(e.tag){case 3:Ji(i.nodeValue,n,0!==(1&e.mode));break;case 5:!0!==e.memoizedProps.suppressHydrationWarning&&Ji(i.nodeValue,n,0!==(1&e.mode))}a&&(t.flags|=4)}else(i=(9===n.nodeType?n:n.ownerDocument).createTextNode(i))[dr]=t,t.stateNode=i}return qo(t),null;case 13:if(Er($s),i=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(rs&&null!==is&&0!==(1&t.mode)&&0===(128&t.flags))ds(),ps(),t.flags|=98560,a=!1;else if(a=hs(t),null!==i&&null!==i.dehydrated){if(null===e){if(!a)throw Error(s(318));if(!(a=null!==(a=t.memoizedState)?a.dehydrated:null))throw Error(s(317));a[dr]=t}else ps(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;qo(t),a=!1}else null!==ss&&(au(ss),ss=null),a=!0;if(!a)return 65536&t.flags?t:null}return 0!==(128&t.flags)?(t.lanes=n,t):((i=null!==i)!==(null!==e&&null!==e.memoizedState)&&i&&(t.child.flags|=8192,0!==(1&t.mode)&&(null===e||0!==(1&$s.current)?0===kl&&(kl=3):mu())),null!==t.updateQueue&&(t.flags|=4),qo(t),null);case 4:return Ks(),Oo(e,t),null===e&&Vi(t.stateNode.containerInfo),qo(t),null;case 10:return As(t.type._context),qo(t),null;case 19:if(Er($s),null===(a=t.memoizedState))return qo(t),null;if(i=0!==(128&t.flags),null===(l=a.rendering))if(i)Go(a,!1);else{if(0!==kl||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(l=ea(e))){for(t.flags|=128,Go(a,!1),null!==(i=l.updateQueue)&&(t.updateQueue=i,t.flags|=4),t.subtreeFlags=0,i=n,n=t.child;null!==n;)e=i,(a=n).flags&=14680066,null===(l=a.alternate)?(a.childLanes=0,a.lanes=e,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=l.childLanes,a.lanes=l.lanes,a.child=l.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=l.memoizedProps,a.memoizedState=l.memoizedState,a.updateQueue=l.updateQueue,a.type=l.type,e=l.dependencies,a.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Cr($s,1&$s.current|2),t.child}e=e.sibling}null!==a.tail&&Ze()>Vl&&(t.flags|=128,i=!0,Go(a,!1),t.lanes=4194304)}else{if(!i)if(null!==(e=ea(l))){if(t.flags|=128,i=!0,null!==(n=e.updateQueue)&&(t.updateQueue=n,t.flags|=4),Go(a,!0),null===a.tail&&"hidden"===a.tailMode&&!l.alternate&&!rs)return qo(t),null}else 2*Ze()-a.renderingStartTime>Vl&&1073741824!==n&&(t.flags|=128,i=!0,Go(a,!1),t.lanes=4194304);a.isBackwards?(l.sibling=t.child,t.child=l):(null!==(n=a.last)?n.sibling=l:t.child=l,a.last=l)}return null!==a.tail?(t=a.tail,a.rendering=t,a.tail=t.sibling,a.renderingStartTime=Ze(),t.sibling=null,n=$s.current,Cr($s,i?1&n|2:1&n),t):(qo(t),null);case 22:case 23:return hu(),i=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==i&&(t.flags|=8192),i&&0!==(1&t.mode)?0!==(1073741824&Ol)&&(qo(t),6&t.subtreeFlags&&(t.flags|=8192)):qo(t),null;case 24:case 25:return null}throw Error(s(156,t.tag))}function Xo(e,t){switch(ts(t),t.tag){case 1:return Or(t.type)&&Ir(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return Ks(),Er(Tr),Er(Mr),na(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 5:return Js(t),null;case 13:if(Er($s),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(s(340));ps()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return Er($s),null;case 4:return Ks(),null;case 10:return As(t.type._context),null;case 22:case 23:return hu(),null;default:return null}}Fo=function(e,t){for(var n=t.child;null!==n;){if(5===n.tag||6===n.tag)e.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},Oo=function(){},Io=function(e,t,n,i){var r=e.memoizedProps;if(r!==i){e=t.stateNode,Xs(Gs.current);var s,a=null;switch(n){case"input":r=Q(e,r),i=Q(e,i),a=[];break;case"select":r=L({},r,{value:void 0}),i=L({},i,{value:void 0}),a=[];break;case"textarea":r=ie(e,r),i=ie(e,i),a=[];break;default:"function"!==typeof r.onClick&&"function"===typeof i.onClick&&(e.onclick=$i)}for(c in ye(n,i),n=null,r)if(!i.hasOwnProperty(c)&&r.hasOwnProperty(c)&&null!=r[c])if("style"===c){var l=r[c];for(s in l)l.hasOwnProperty(s)&&(n||(n={}),n[s]="")}else"dangerouslySetInnerHTML"!==c&&"children"!==c&&"suppressContentEditableWarning"!==c&&"suppressHydrationWarning"!==c&&"autoFocus"!==c&&(o.hasOwnProperty(c)?a||(a=[]):(a=a||[]).push(c,null));for(c in i){var u=i[c];if(l=null!=r?r[c]:void 0,i.hasOwnProperty(c)&&u!==l&&(null!=u||null!=l))if("style"===c)if(l){for(s in l)!l.hasOwnProperty(s)||u&&u.hasOwnProperty(s)||(n||(n={}),n[s]="");for(s in u)u.hasOwnProperty(s)&&l[s]!==u[s]&&(n||(n={}),n[s]=u[s])}else n||(a||(a=[]),a.push(c,n)),n=u;else"dangerouslySetInnerHTML"===c?(u=u?u.__html:void 0,l=l?l.__html:void 0,null!=u&&l!==u&&(a=a||[]).push(c,u)):"children"===c?"string"!==typeof u&&"number"!==typeof u||(a=a||[]).push(c,""+u):"suppressContentEditableWarning"!==c&&"suppressHydrationWarning"!==c&&(o.hasOwnProperty(c)?(null!=u&&"onScroll"===c&&Ni("scroll",e),a||l===u||(a=[])):(a=a||[]).push(c,u))}n&&(a=a||[]).push("style",n);var c=a;(t.updateQueue=c)&&(t.flags|=4)}},ko=function(e,t,n,i){n!==i&&(t.flags|=4)};var Qo=!1,Ko=!1,Zo="function"===typeof WeakSet?WeakSet:Set,Jo=null;function $o(e,t){var n=e.ref;if(null!==n)if("function"===typeof n)try{n(null)}catch(i){Su(e,t,i)}else n.current=null}function el(e,t,n){try{n()}catch(i){Su(e,t,i)}}var tl=!1;function nl(e,t,n){var i=t.updateQueue;if(null!==(i=null!==i?i.lastEffect:null)){var r=i=i.next;do{if((r.tag&e)===e){var s=r.destroy;r.destroy=void 0,void 0!==s&&el(t,n,s)}r=r.next}while(r!==i)}}function il(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var n=t=t.next;do{if((n.tag&e)===e){var i=n.create;n.destroy=i()}n=n.next}while(n!==t)}}function rl(e){var t=e.ref;if(null!==t){var n=e.stateNode;e.tag,e=n,"function"===typeof t?t(e):t.current=e}}function sl(e){var t=e.alternate;null!==t&&(e.alternate=null,sl(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&(delete t[dr],delete t[pr],delete t[mr],delete t[gr],delete t[vr])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function al(e){return 5===e.tag||3===e.tag||4===e.tag}function ol(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||al(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function ll(e,t,n){var i=e.tag;if(5===i||6===i)e=e.stateNode,t?8===n.nodeType?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(8===n.nodeType?(t=n.parentNode).insertBefore(e,n):(t=n).appendChild(e),null!==(n=n._reactRootContainer)&&void 0!==n||null!==t.onclick||(t.onclick=$i));else if(4!==i&&null!==(e=e.child))for(ll(e,t,n),e=e.sibling;null!==e;)ll(e,t,n),e=e.sibling}function ul(e,t,n){var i=e.tag;if(5===i||6===i)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==i&&null!==(e=e.child))for(ul(e,t,n),e=e.sibling;null!==e;)ul(e,t,n),e=e.sibling}var cl=null,hl=!1;function dl(e,t,n){for(n=n.child;null!==n;)pl(e,t,n),n=n.sibling}function pl(e,t,n){if(st&&"function"===typeof st.onCommitFiberUnmount)try{st.onCommitFiberUnmount(rt,n)}catch(o){}switch(n.tag){case 5:Ko||$o(n,t);case 6:var i=cl,r=hl;cl=null,dl(e,t,n),hl=r,null!==(cl=i)&&(hl?(e=cl,n=n.stateNode,8===e.nodeType?e.parentNode.removeChild(n):e.removeChild(n)):cl.removeChild(n.stateNode));break;case 18:null!==cl&&(hl?(e=cl,n=n.stateNode,8===e.nodeType?lr(e.parentNode,n):1===e.nodeType&&lr(e,n),Vt(e)):lr(cl,n.stateNode));break;case 4:i=cl,r=hl,cl=n.stateNode.containerInfo,hl=!0,dl(e,t,n),cl=i,hl=r;break;case 0:case 11:case 14:case 15:if(!Ko&&(null!==(i=n.updateQueue)&&null!==(i=i.lastEffect))){r=i=i.next;do{var s=r,a=s.destroy;s=s.tag,void 0!==a&&(0!==(2&s)||0!==(4&s))&&el(n,t,a),r=r.next}while(r!==i)}dl(e,t,n);break;case 1:if(!Ko&&($o(n,t),"function"===typeof(i=n.stateNode).componentWillUnmount))try{i.props=n.memoizedProps,i.state=n.memoizedState,i.componentWillUnmount()}catch(o){Su(n,t,o)}dl(e,t,n);break;case 21:dl(e,t,n);break;case 22:1&n.mode?(Ko=(i=Ko)||null!==n.memoizedState,dl(e,t,n),Ko=i):dl(e,t,n);break;default:dl(e,t,n)}}function fl(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var n=e.stateNode;null===n&&(n=e.stateNode=new Zo),t.forEach((function(t){var i=Mu.bind(null,e,t);n.has(t)||(n.add(t),t.then(i,i))}))}}function ml(e,t){var n=t.deletions;if(null!==n)for(var i=0;i<n.length;i++){var r=n[i];try{var a=e,o=t,l=o;e:for(;null!==l;){switch(l.tag){case 5:cl=l.stateNode,hl=!1;break e;case 3:case 4:cl=l.stateNode.containerInfo,hl=!0;break e}l=l.return}if(null===cl)throw Error(s(160));pl(a,o,r),cl=null,hl=!1;var u=r.alternate;null!==u&&(u.return=null),r.return=null}catch(c){Su(r,t,c)}}if(12854&t.subtreeFlags)for(t=t.child;null!==t;)gl(t,e),t=t.sibling}function gl(e,t){var n=e.alternate,i=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(ml(t,e),vl(e),4&i){try{nl(3,e,e.return),il(3,e)}catch(g){Su(e,e.return,g)}try{nl(5,e,e.return)}catch(g){Su(e,e.return,g)}}break;case 1:ml(t,e),vl(e),512&i&&null!==n&&$o(n,n.return);break;case 5:if(ml(t,e),vl(e),512&i&&null!==n&&$o(n,n.return),32&e.flags){var r=e.stateNode;try{de(r,"")}catch(g){Su(e,e.return,g)}}if(4&i&&null!=(r=e.stateNode)){var a=e.memoizedProps,o=null!==n?n.memoizedProps:a,l=e.type,u=e.updateQueue;if(e.updateQueue=null,null!==u)try{"input"===l&&"radio"===a.type&&null!=a.name&&Z(r,a),xe(l,o);var c=xe(l,a);for(o=0;o<u.length;o+=2){var h=u[o],d=u[o+1];"style"===h?ge(r,d):"dangerouslySetInnerHTML"===h?he(r,d):"children"===h?de(r,d):x(r,h,d,c)}switch(l){case"input":J(r,a);break;case"textarea":se(r,a);break;case"select":var p=r._wrapperState.wasMultiple;r._wrapperState.wasMultiple=!!a.multiple;var f=a.value;null!=f?ne(r,!!a.multiple,f,!1):p!==!!a.multiple&&(null!=a.defaultValue?ne(r,!!a.multiple,a.defaultValue,!0):ne(r,!!a.multiple,a.multiple?[]:"",!1))}r[pr]=a}catch(g){Su(e,e.return,g)}}break;case 6:if(ml(t,e),vl(e),4&i){if(null===e.stateNode)throw Error(s(162));r=e.stateNode,a=e.memoizedProps;try{r.nodeValue=a}catch(g){Su(e,e.return,g)}}break;case 3:if(ml(t,e),vl(e),4&i&&null!==n&&n.memoizedState.isDehydrated)try{Vt(t.containerInfo)}catch(g){Su(e,e.return,g)}break;case 4:default:ml(t,e),vl(e);break;case 13:ml(t,e),vl(e),8192&(r=e.child).flags&&(a=null!==r.memoizedState,r.stateNode.isHidden=a,!a||null!==r.alternate&&null!==r.alternate.memoizedState||(Ul=Ze())),4&i&&fl(e);break;case 22:if(h=null!==n&&null!==n.memoizedState,1&e.mode?(Ko=(c=Ko)||h,ml(t,e),Ko=c):ml(t,e),vl(e),8192&i){if(c=null!==e.memoizedState,(e.stateNode.isHidden=c)&&!h&&0!==(1&e.mode))for(Jo=e,h=e.child;null!==h;){for(d=Jo=h;null!==Jo;){switch(f=(p=Jo).child,p.tag){case 0:case 11:case 14:case 15:nl(4,p,p.return);break;case 1:$o(p,p.return);var m=p.stateNode;if("function"===typeof m.componentWillUnmount){i=p,n=p.return;try{t=i,m.props=t.memoizedProps,m.state=t.memoizedState,m.componentWillUnmount()}catch(g){Su(i,n,g)}}break;case 5:$o(p,p.return);break;case 22:if(null!==p.memoizedState){wl(d);continue}}null!==f?(f.return=p,Jo=f):wl(d)}h=h.sibling}e:for(h=null,d=e;;){if(5===d.tag){if(null===h){h=d;try{r=d.stateNode,c?"function"===typeof(a=r.style).setProperty?a.setProperty("display","none","important"):a.display="none":(l=d.stateNode,o=void 0!==(u=d.memoizedProps.style)&&null!==u&&u.hasOwnProperty("display")?u.display:null,l.style.display=me("display",o))}catch(g){Su(e,e.return,g)}}}else if(6===d.tag){if(null===h)try{d.stateNode.nodeValue=c?"":d.memoizedProps}catch(g){Su(e,e.return,g)}}else if((22!==d.tag&&23!==d.tag||null===d.memoizedState||d===e)&&null!==d.child){d.child.return=d,d=d.child;continue}if(d===e)break e;for(;null===d.sibling;){if(null===d.return||d.return===e)break e;h===d&&(h=null),d=d.return}h===d&&(h=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:ml(t,e),vl(e),4&i&&fl(e);case 21:}}function vl(e){var t=e.flags;if(2&t){try{e:{for(var n=e.return;null!==n;){if(al(n)){var i=n;break e}n=n.return}throw Error(s(160))}switch(i.tag){case 5:var r=i.stateNode;32&i.flags&&(de(r,""),i.flags&=-33),ul(e,ol(e),r);break;case 3:case 4:var a=i.stateNode.containerInfo;ll(e,ol(e),a);break;default:throw Error(s(161))}}catch(o){Su(e,e.return,o)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function yl(e,t,n){Jo=e,xl(e,t,n)}function xl(e,t,n){for(var i=0!==(1&e.mode);null!==Jo;){var r=Jo,s=r.child;if(22===r.tag&&i){var a=null!==r.memoizedState||Qo;if(!a){var o=r.alternate,l=null!==o&&null!==o.memoizedState||Ko;o=Qo;var u=Ko;if(Qo=a,(Ko=l)&&!u)for(Jo=r;null!==Jo;)l=(a=Jo).child,22===a.tag&&null!==a.memoizedState?Dl(r):null!==l?(l.return=a,Jo=l):Dl(r);for(;null!==s;)Jo=s,xl(s,t,n),s=s.sibling;Jo=r,Qo=o,Ko=u}bl(e)}else 0!==(8772&r.subtreeFlags)&&null!==s?(s.return=r,Jo=s):bl(e)}}function bl(e){for(;null!==Jo;){var t=Jo;if(0!==(8772&t.flags)){var n=t.alternate;try{if(0!==(8772&t.flags))switch(t.tag){case 0:case 11:case 15:Ko||il(5,t);break;case 1:var i=t.stateNode;if(4&t.flags&&!Ko)if(null===n)i.componentDidMount();else{var r=t.elementType===t.type?n.memoizedProps:to(t.type,n.memoizedProps);i.componentDidUpdate(r,n.memoizedState,i.__reactInternalSnapshotBeforeUpdate)}var a=t.updateQueue;null!==a&&Hs(t,a,i);break;case 3:var o=t.updateQueue;if(null!==o){if(n=null,null!==t.child)switch(t.child.tag){case 5:case 1:n=t.child.stateNode}Hs(t,o,n)}break;case 5:var l=t.stateNode;if(null===n&&4&t.flags){n=l;var u=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":u.autoFocus&&n.focus();break;case"img":u.src&&(n.src=u.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===t.memoizedState){var c=t.alternate;if(null!==c){var h=c.memoizedState;if(null!==h){var d=h.dehydrated;null!==d&&Vt(d)}}}break;default:throw Error(s(163))}Ko||512&t.flags&&rl(t)}catch(p){Su(t,t.return,p)}}if(t===e){Jo=null;break}if(null!==(n=t.sibling)){n.return=t.return,Jo=n;break}Jo=t.return}}function wl(e){for(;null!==Jo;){var t=Jo;if(t===e){Jo=null;break}var n=t.sibling;if(null!==n){n.return=t.return,Jo=n;break}Jo=t.return}}function Dl(e){for(;null!==Jo;){var t=Jo;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{il(4,t)}catch(l){Su(t,n,l)}break;case 1:var i=t.stateNode;if("function"===typeof i.componentDidMount){var r=t.return;try{i.componentDidMount()}catch(l){Su(t,r,l)}}var s=t.return;try{rl(t)}catch(l){Su(t,s,l)}break;case 5:var a=t.return;try{rl(t)}catch(l){Su(t,a,l)}}}catch(l){Su(t,t.return,l)}if(t===e){Jo=null;break}var o=t.sibling;if(null!==o){o.return=t.return,Jo=o;break}Jo=t.return}}var _l,Sl=Math.ceil,El=b.ReactCurrentDispatcher,Cl=b.ReactCurrentOwner,Al=b.ReactCurrentBatchConfig,Ml=0,Tl=null,Pl=null,Fl=0,Ol=0,Il=Sr(0),kl=0,Bl=null,Rl=0,Ll=0,zl=0,Nl=null,jl=null,Ul=0,Vl=1/0,Hl=null,Wl=!1,Gl=null,ql=null,Yl=!1,Xl=null,Ql=0,Kl=0,Zl=null,Jl=-1,$l=0;function eu(){return 0!==(6&Ml)?Ze():-1!==Jl?Jl:Jl=Ze()}function tu(e){return 0===(1&e.mode)?1:0!==(2&Ml)&&0!==Fl?Fl&-Fl:null!==ms.transition?(0===$l&&($l=mt()),$l):0!==(e=xt)?e:e=void 0===(e=window.event)?16:Kt(e.type)}function nu(e,t,n,i){if(50<Kl)throw Kl=0,Zl=null,Error(s(185));vt(e,n,i),0!==(2&Ml)&&e===Tl||(e===Tl&&(0===(2&Ml)&&(Ll|=n),4===kl&&ou(e,Fl)),iu(e,i),1===n&&0===Ml&&0===(1&t.mode)&&(Vl=Ze()+500,Nr&&Vr()))}function iu(e,t){var n=e.callbackNode;!function(e,t){for(var n=e.suspendedLanes,i=e.pingedLanes,r=e.expirationTimes,s=e.pendingLanes;0<s;){var a=31-at(s),o=1<<a,l=r[a];-1===l?0!==(o&n)&&0===(o&i)||(r[a]=pt(o,t)):l<=t&&(e.expiredLanes|=o),s&=~o}}(e,t);var i=dt(e,e===Tl?Fl:0);if(0===i)null!==n&&Xe(n),e.callbackNode=null,e.callbackPriority=0;else if(t=i&-i,e.callbackPriority!==t){if(null!=n&&Xe(n),1===t)0===e.tag?function(e){Nr=!0,Ur(e)}(lu.bind(null,e)):Ur(lu.bind(null,e)),ar((function(){0===(6&Ml)&&Vr()})),n=null;else{switch(bt(i)){case 1:n=$e;break;case 4:n=et;break;case 16:default:n=tt;break;case 536870912:n=it}n=Tu(n,ru.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function ru(e,t){if(Jl=-1,$l=0,0!==(6&Ml))throw Error(s(327));var n=e.callbackNode;if(Du()&&e.callbackNode!==n)return null;var i=dt(e,e===Tl?Fl:0);if(0===i)return null;if(0!==(30&i)||0!==(i&e.expiredLanes)||t)t=gu(e,i);else{t=i;var r=Ml;Ml|=2;var a=fu();for(Tl===e&&Fl===t||(Hl=null,Vl=Ze()+500,du(e,t));;)try{yu();break}catch(l){pu(e,l)}Cs(),El.current=a,Ml=r,null!==Pl?t=0:(Tl=null,Fl=0,t=kl)}if(0!==t){if(2===t&&(0!==(r=ft(e))&&(i=r,t=su(e,r))),1===t)throw n=Bl,du(e,0),ou(e,i),iu(e,Ze()),n;if(6===t)ou(e,i);else{if(r=e.current.alternate,0===(30&i)&&!function(e){for(var t=e;;){if(16384&t.flags){var n=t.updateQueue;if(null!==n&&null!==(n=n.stores))for(var i=0;i<n.length;i++){var r=n[i],s=r.getSnapshot;r=r.value;try{if(!oi(s(),r))return!1}catch(o){return!1}}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(r)&&(2===(t=gu(e,i))&&(0!==(a=ft(e))&&(i=a,t=su(e,a))),1===t))throw n=Bl,du(e,0),ou(e,i),iu(e,Ze()),n;switch(e.finishedWork=r,e.finishedLanes=i,t){case 0:case 1:throw Error(s(345));case 2:case 5:wu(e,jl,Hl);break;case 3:if(ou(e,i),(130023424&i)===i&&10<(t=Ul+500-Ze())){if(0!==dt(e,0))break;if(((r=e.suspendedLanes)&i)!==i){eu(),e.pingedLanes|=e.suspendedLanes&r;break}e.timeoutHandle=ir(wu.bind(null,e,jl,Hl),t);break}wu(e,jl,Hl);break;case 4:if(ou(e,i),(4194240&i)===i)break;for(t=e.eventTimes,r=-1;0<i;){var o=31-at(i);a=1<<o,(o=t[o])>r&&(r=o),i&=~a}if(i=r,10<(i=(120>(i=Ze()-i)?120:480>i?480:1080>i?1080:1920>i?1920:3e3>i?3e3:4320>i?4320:1960*Sl(i/1960))-i)){e.timeoutHandle=ir(wu.bind(null,e,jl,Hl),i);break}wu(e,jl,Hl);break;default:throw Error(s(329))}}}return iu(e,Ze()),e.callbackNode===n?ru.bind(null,e):null}function su(e,t){var n=Nl;return e.current.memoizedState.isDehydrated&&(du(e,t).flags|=256),2!==(e=gu(e,t))&&(t=jl,jl=n,null!==t&&au(t)),e}function au(e){null===jl?jl=e:jl.push.apply(jl,e)}function ou(e,t){for(t&=~zl,t&=~Ll,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-at(t),i=1<<n;e[n]=-1,t&=~i}}function lu(e){if(0!==(6&Ml))throw Error(s(327));Du();var t=dt(e,0);if(0===(1&t))return iu(e,Ze()),null;var n=gu(e,t);if(0!==e.tag&&2===n){var i=ft(e);0!==i&&(t=i,n=su(e,i))}if(1===n)throw n=Bl,du(e,0),ou(e,t),iu(e,Ze()),n;if(6===n)throw Error(s(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,wu(e,jl,Hl),iu(e,Ze()),null}function uu(e,t){var n=Ml;Ml|=1;try{return e(t)}finally{0===(Ml=n)&&(Vl=Ze()+500,Nr&&Vr())}}function cu(e){null!==Xl&&0===Xl.tag&&0===(6&Ml)&&Du();var t=Ml;Ml|=1;var n=Al.transition,i=xt;try{if(Al.transition=null,xt=1,e)return e()}finally{xt=i,Al.transition=n,0===(6&(Ml=t))&&Vr()}}function hu(){Ol=Il.current,Er(Il)}function du(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(-1!==n&&(e.timeoutHandle=-1,rr(n)),null!==Pl)for(n=Pl.return;null!==n;){var i=n;switch(ts(i),i.tag){case 1:null!==(i=i.type.childContextTypes)&&void 0!==i&&Ir();break;case 3:Ks(),Er(Tr),Er(Mr),na();break;case 5:Js(i);break;case 4:Ks();break;case 13:case 19:Er($s);break;case 10:As(i.type._context);break;case 22:case 23:hu()}n=n.return}if(Tl=e,Pl=e=Iu(e.current,null),Fl=Ol=t,kl=0,Bl=null,zl=Ll=Rl=0,jl=Nl=null,null!==Fs){for(t=0;t<Fs.length;t++)if(null!==(i=(n=Fs[t]).interleaved)){n.interleaved=null;var r=i.next,s=n.pending;if(null!==s){var a=s.next;s.next=r,i.next=a}n.pending=i}Fs=null}return e}function pu(e,t){for(;;){var n=Pl;try{if(Cs(),ia.current=Za,ua){for(var i=aa.memoizedState;null!==i;){var r=i.queue;null!==r&&(r.pending=null),i=i.next}ua=!1}if(sa=0,la=oa=aa=null,ca=!1,ha=0,Cl.current=null,null===n||null===n.return){kl=1,Bl=t,Pl=null;break}e:{var a=e,o=n.return,l=n,u=t;if(t=Fl,l.flags|=32768,null!==u&&"object"===typeof u&&"function"===typeof u.then){var c=u,h=l,d=h.tag;if(0===(1&h.mode)&&(0===d||11===d||15===d)){var p=h.alternate;p?(h.updateQueue=p.updateQueue,h.memoizedState=p.memoizedState,h.lanes=p.lanes):(h.updateQueue=null,h.memoizedState=null)}var f=go(o);if(null!==f){f.flags&=-257,vo(f,o,l,0,t),1&f.mode&&mo(a,c,t),u=c;var m=(t=f).updateQueue;if(null===m){var g=new Set;g.add(u),t.updateQueue=g}else m.add(u);break e}if(0===(1&t)){mo(a,c,t),mu();break e}u=Error(s(426))}else if(rs&&1&l.mode){var v=go(o);if(null!==v){0===(65536&v.flags)&&(v.flags|=256),vo(v,o,l,0,t),fs(lo(u,l));break e}}a=u=lo(u,l),4!==kl&&(kl=2),null===Nl?Nl=[a]:Nl.push(a),a=o;do{switch(a.tag){case 3:a.flags|=65536,t&=-t,a.lanes|=t,Us(a,po(0,u,t));break e;case 1:l=u;var y=a.type,x=a.stateNode;if(0===(128&a.flags)&&("function"===typeof y.getDerivedStateFromError||null!==x&&"function"===typeof x.componentDidCatch&&(null===ql||!ql.has(x)))){a.flags|=65536,t&=-t,a.lanes|=t,Us(a,fo(a,l,t));break e}}a=a.return}while(null!==a)}bu(n)}catch(b){t=b,Pl===n&&null!==n&&(Pl=n=n.return);continue}break}}function fu(){var e=El.current;return El.current=Za,null===e?Za:e}function mu(){0!==kl&&3!==kl&&2!==kl||(kl=4),null===Tl||0===(268435455&Rl)&&0===(268435455&Ll)||ou(Tl,Fl)}function gu(e,t){var n=Ml;Ml|=2;var i=fu();for(Tl===e&&Fl===t||(Hl=null,du(e,t));;)try{vu();break}catch(r){pu(e,r)}if(Cs(),Ml=n,El.current=i,null!==Pl)throw Error(s(261));return Tl=null,Fl=0,kl}function vu(){for(;null!==Pl;)xu(Pl)}function yu(){for(;null!==Pl&&!Qe();)xu(Pl)}function xu(e){var t=_l(e.alternate,e,Ol);e.memoizedProps=e.pendingProps,null===t?bu(e):Pl=t,Cl.current=null}function bu(e){var t=e;do{var n=t.alternate;if(e=t.return,0===(32768&t.flags)){if(null!==(n=Yo(n,t,Ol)))return void(Pl=n)}else{if(null!==(n=Xo(n,t)))return n.flags&=32767,void(Pl=n);if(null===e)return kl=6,void(Pl=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}if(null!==(t=t.sibling))return void(Pl=t);Pl=t=e}while(null!==t);0===kl&&(kl=5)}function wu(e,t,n){var i=xt,r=Al.transition;try{Al.transition=null,xt=1,function(e,t,n,i){do{Du()}while(null!==Xl);if(0!==(6&Ml))throw Error(s(327));n=e.finishedWork;var r=e.finishedLanes;if(null===n)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(s(177));e.callbackNode=null,e.callbackPriority=0;var a=n.lanes|n.childLanes;if(function(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var i=e.eventTimes;for(e=e.expirationTimes;0<n;){var r=31-at(n),s=1<<r;t[r]=0,i[r]=-1,e[r]=-1,n&=~s}}(e,a),e===Tl&&(Pl=Tl=null,Fl=0),0===(2064&n.subtreeFlags)&&0===(2064&n.flags)||Yl||(Yl=!0,Tu(tt,(function(){return Du(),null}))),a=0!==(15990&n.flags),0!==(15990&n.subtreeFlags)||a){a=Al.transition,Al.transition=null;var o=xt;xt=1;var l=Ml;Ml|=4,Cl.current=null,function(e,t){if(er=Wt,pi(e=di())){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{var i=(n=(n=e.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(i&&0!==i.rangeCount){n=i.anchorNode;var r=i.anchorOffset,a=i.focusNode;i=i.focusOffset;try{n.nodeType,a.nodeType}catch(w){n=null;break e}var o=0,l=-1,u=-1,c=0,h=0,d=e,p=null;t:for(;;){for(var f;d!==n||0!==r&&3!==d.nodeType||(l=o+r),d!==a||0!==i&&3!==d.nodeType||(u=o+i),3===d.nodeType&&(o+=d.nodeValue.length),null!==(f=d.firstChild);)p=d,d=f;for(;;){if(d===e)break t;if(p===n&&++c===r&&(l=o),p===a&&++h===i&&(u=o),null!==(f=d.nextSibling))break;p=(d=p).parentNode}d=f}n=-1===l||-1===u?null:{start:l,end:u}}else n=null}n=n||{start:0,end:0}}else n=null;for(tr={focusedElem:e,selectionRange:n},Wt=!1,Jo=t;null!==Jo;)if(e=(t=Jo).child,0!==(1028&t.subtreeFlags)&&null!==e)e.return=t,Jo=e;else for(;null!==Jo;){t=Jo;try{var m=t.alternate;if(0!==(1024&t.flags))switch(t.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==m){var g=m.memoizedProps,v=m.memoizedState,y=t.stateNode,x=y.getSnapshotBeforeUpdate(t.elementType===t.type?g:to(t.type,g),v);y.__reactInternalSnapshotBeforeUpdate=x}break;case 3:var b=t.stateNode.containerInfo;1===b.nodeType?b.textContent="":9===b.nodeType&&b.documentElement&&b.removeChild(b.documentElement);break;default:throw Error(s(163))}}catch(w){Su(t,t.return,w)}if(null!==(e=t.sibling)){e.return=t.return,Jo=e;break}Jo=t.return}m=tl,tl=!1}(e,n),gl(n,e),fi(tr),Wt=!!er,tr=er=null,e.current=n,yl(n,e,r),Ke(),Ml=l,xt=o,Al.transition=a}else e.current=n;if(Yl&&(Yl=!1,Xl=e,Ql=r),a=e.pendingLanes,0===a&&(ql=null),function(e){if(st&&"function"===typeof st.onCommitFiberRoot)try{st.onCommitFiberRoot(rt,e,void 0,128===(128&e.current.flags))}catch(t){}}(n.stateNode),iu(e,Ze()),null!==t)for(i=e.onRecoverableError,n=0;n<t.length;n++)r=t[n],i(r.value,{componentStack:r.stack,digest:r.digest});if(Wl)throw Wl=!1,e=Gl,Gl=null,e;0!==(1&Ql)&&0!==e.tag&&Du(),a=e.pendingLanes,0!==(1&a)?e===Zl?Kl++:(Kl=0,Zl=e):Kl=0,Vr()}(e,t,n,i)}finally{Al.transition=r,xt=i}return null}function Du(){if(null!==Xl){var e=bt(Ql),t=Al.transition,n=xt;try{if(Al.transition=null,xt=16>e?16:e,null===Xl)var i=!1;else{if(e=Xl,Xl=null,Ql=0,0!==(6&Ml))throw Error(s(331));var r=Ml;for(Ml|=4,Jo=e.current;null!==Jo;){var a=Jo,o=a.child;if(0!==(16&Jo.flags)){var l=a.deletions;if(null!==l){for(var u=0;u<l.length;u++){var c=l[u];for(Jo=c;null!==Jo;){var h=Jo;switch(h.tag){case 0:case 11:case 15:nl(8,h,a)}var d=h.child;if(null!==d)d.return=h,Jo=d;else for(;null!==Jo;){var p=(h=Jo).sibling,f=h.return;if(sl(h),h===c){Jo=null;break}if(null!==p){p.return=f,Jo=p;break}Jo=f}}}var m=a.alternate;if(null!==m){var g=m.child;if(null!==g){m.child=null;do{var v=g.sibling;g.sibling=null,g=v}while(null!==g)}}Jo=a}}if(0!==(2064&a.subtreeFlags)&&null!==o)o.return=a,Jo=o;else e:for(;null!==Jo;){if(0!==(2048&(a=Jo).flags))switch(a.tag){case 0:case 11:case 15:nl(9,a,a.return)}var y=a.sibling;if(null!==y){y.return=a.return,Jo=y;break e}Jo=a.return}}var x=e.current;for(Jo=x;null!==Jo;){var b=(o=Jo).child;if(0!==(2064&o.subtreeFlags)&&null!==b)b.return=o,Jo=b;else e:for(o=x;null!==Jo;){if(0!==(2048&(l=Jo).flags))try{switch(l.tag){case 0:case 11:case 15:il(9,l)}}catch(D){Su(l,l.return,D)}if(l===o){Jo=null;break e}var w=l.sibling;if(null!==w){w.return=l.return,Jo=w;break e}Jo=l.return}}if(Ml=r,Vr(),st&&"function"===typeof st.onPostCommitFiberRoot)try{st.onPostCommitFiberRoot(rt,e)}catch(D){}i=!0}return i}finally{xt=n,Al.transition=t}}return!1}function _u(e,t,n){e=Ns(e,t=po(0,t=lo(n,t),1),1),t=eu(),null!==e&&(vt(e,1,t),iu(e,t))}function Su(e,t,n){if(3===e.tag)_u(e,e,n);else for(;null!==t;){if(3===t.tag){_u(t,e,n);break}if(1===t.tag){var i=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof i.componentDidCatch&&(null===ql||!ql.has(i))){t=Ns(t,e=fo(t,e=lo(n,e),1),1),e=eu(),null!==t&&(vt(t,1,e),iu(t,e));break}}t=t.return}}function Eu(e,t,n){var i=e.pingCache;null!==i&&i.delete(t),t=eu(),e.pingedLanes|=e.suspendedLanes&n,Tl===e&&(Fl&n)===n&&(4===kl||3===kl&&(130023424&Fl)===Fl&&500>Ze()-Ul?du(e,0):zl|=n),iu(e,t)}function Cu(e,t){0===t&&(0===(1&e.mode)?t=1:(t=ct,0===(130023424&(ct<<=1))&&(ct=4194304)));var n=eu();null!==(e=ks(e,t))&&(vt(e,t,n),iu(e,n))}function Au(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),Cu(e,n)}function Mu(e,t){var n=0;switch(e.tag){case 13:var i=e.stateNode,r=e.memoizedState;null!==r&&(n=r.retryLane);break;case 19:i=e.stateNode;break;default:throw Error(s(314))}null!==i&&i.delete(t),Cu(e,n)}function Tu(e,t){return Ye(e,t)}function Pu(e,t,n,i){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=i,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Fu(e,t,n,i){return new Pu(e,t,n,i)}function Ou(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Iu(e,t){var n=e.alternate;return null===n?((n=Fu(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=14680064&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function ku(e,t,n,i,r,a){var o=2;if(i=e,"function"===typeof e)Ou(e)&&(o=1);else if("string"===typeof e)o=5;else e:switch(e){case _:return Bu(n.children,r,a,t);case S:o=8,r|=8;break;case E:return(e=Fu(12,n,t,2|r)).elementType=E,e.lanes=a,e;case T:return(e=Fu(13,n,t,r)).elementType=T,e.lanes=a,e;case P:return(e=Fu(19,n,t,r)).elementType=P,e.lanes=a,e;case I:return Ru(n,r,a,t);default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case C:o=10;break e;case A:o=9;break e;case M:o=11;break e;case F:o=14;break e;case O:o=16,i=null;break e}throw Error(s(130,null==e?e:typeof e,""))}return(t=Fu(o,n,t,r)).elementType=e,t.type=i,t.lanes=a,t}function Bu(e,t,n,i){return(e=Fu(7,e,i,t)).lanes=n,e}function Ru(e,t,n,i){return(e=Fu(22,e,i,t)).elementType=I,e.lanes=n,e.stateNode={isHidden:!1},e}function Lu(e,t,n){return(e=Fu(6,e,null,t)).lanes=n,e}function zu(e,t,n){return(t=Fu(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Nu(e,t,n,i,r){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=gt(0),this.expirationTimes=gt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=gt(0),this.identifierPrefix=i,this.onRecoverableError=r,this.mutableSourceEagerHydrationData=null}function ju(e,t,n,i,r,s,a,o,l){return e=new Nu(e,t,n,o,l),1===t?(t=1,!0===s&&(t|=8)):t=0,s=Fu(3,null,null,t),e.current=s,s.stateNode=e,s.memoizedState={element:i,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Rs(s),e}function Uu(e){if(!e)return Ar;e:{if(Ve(e=e._reactInternals)!==e||1!==e.tag)throw Error(s(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Or(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(s(171))}if(1===e.tag){var n=e.type;if(Or(n))return Br(e,n,t)}return t}function Vu(e,t,n,i,r,s,a,o,l){return(e=ju(n,i,!0,e,0,s,0,o,l)).context=Uu(null),n=e.current,(s=zs(i=eu(),r=tu(n))).callback=void 0!==t&&null!==t?t:null,Ns(n,s,r),e.current.lanes=r,vt(e,r,i),iu(e,i),e}function Hu(e,t,n,i){var r=t.current,s=eu(),a=tu(r);return n=Uu(n),null===t.context?t.context=n:t.pendingContext=n,(t=zs(s,a)).payload={element:e},null!==(i=void 0===i?null:i)&&(t.callback=i),null!==(e=Ns(r,t,a))&&(nu(e,r,a,s),js(e,r,a)),a}function Wu(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function Gu(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function qu(e,t){Gu(e,t),(e=e.alternate)&&Gu(e,t)}_l=function(e,t,n){if(null!==e)if(e.memoizedProps!==t.pendingProps||Tr.current)xo=!0;else{if(0===(e.lanes&n)&&0===(128&t.flags))return xo=!1,function(e,t,n){switch(t.tag){case 3:To(t),ps();break;case 5:Zs(t);break;case 1:Or(t.type)&&Rr(t);break;case 4:Qs(t,t.stateNode.containerInfo);break;case 10:var i=t.type._context,r=t.memoizedProps.value;Cr(Ds,i._currentValue),i._currentValue=r;break;case 13:if(null!==(i=t.memoizedState))return null!==i.dehydrated?(Cr($s,1&$s.current),t.flags|=128,null):0!==(n&t.child.childLanes)?Lo(e,t,n):(Cr($s,1&$s.current),null!==(e=Wo(e,t,n))?e.sibling:null);Cr($s,1&$s.current);break;case 19:if(i=0!==(n&t.childLanes),0!==(128&e.flags)){if(i)return Vo(e,t,n);t.flags|=128}if(null!==(r=t.memoizedState)&&(r.rendering=null,r.tail=null,r.lastEffect=null),Cr($s,$s.current),i)break;return null;case 22:case 23:return t.lanes=0,So(e,t,n)}return Wo(e,t,n)}(e,t,n);xo=0!==(131072&e.flags)}else xo=!1,rs&&0!==(1048576&t.flags)&&$r(t,qr,t.index);switch(t.lanes=0,t.tag){case 2:var i=t.type;Ho(e,t),e=t.pendingProps;var r=Fr(t,Mr.current);Ts(t,n),r=ma(null,t,i,e,r,n);var a=ga();return t.flags|=1,"object"===typeof r&&null!==r&&"function"===typeof r.render&&void 0===r.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Or(i)?(a=!0,Rr(t)):a=!1,t.memoizedState=null!==r.state&&void 0!==r.state?r.state:null,Rs(t),r.updater=io,t.stateNode=r,r._reactInternals=t,oo(t,i,e,n),t=Mo(null,t,i,!0,a,n)):(t.tag=0,rs&&a&&es(t),bo(null,t,r,n),t=t.child),t;case 16:i=t.elementType;e:{switch(Ho(e,t),e=t.pendingProps,i=(r=i._init)(i._payload),t.type=i,r=t.tag=function(e){if("function"===typeof e)return Ou(e)?1:0;if(void 0!==e&&null!==e){if((e=e.$$typeof)===M)return 11;if(e===F)return 14}return 2}(i),e=to(i,e),r){case 0:t=Co(null,t,i,e,n);break e;case 1:t=Ao(null,t,i,e,n);break e;case 11:t=wo(null,t,i,e,n);break e;case 14:t=Do(null,t,i,to(i.type,e),n);break e}throw Error(s(306,i,""))}return t;case 0:return i=t.type,r=t.pendingProps,Co(e,t,i,r=t.elementType===i?r:to(i,r),n);case 1:return i=t.type,r=t.pendingProps,Ao(e,t,i,r=t.elementType===i?r:to(i,r),n);case 3:e:{if(To(t),null===e)throw Error(s(387));i=t.pendingProps,r=(a=t.memoizedState).element,Ls(e,t),Vs(t,i,null,n);var o=t.memoizedState;if(i=o.element,a.isDehydrated){if(a={element:i,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},t.updateQueue.baseState=a,t.memoizedState=a,256&t.flags){t=Po(e,t,i,n,r=lo(Error(s(423)),t));break e}if(i!==r){t=Po(e,t,i,n,r=lo(Error(s(424)),t));break e}for(is=ur(t.stateNode.containerInfo.firstChild),ns=t,rs=!0,ss=null,n=ws(t,null,i,n),t.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(ps(),i===r){t=Wo(e,t,n);break e}bo(e,t,i,n)}t=t.child}return t;case 5:return Zs(t),null===e&&us(t),i=t.type,r=t.pendingProps,a=null!==e?e.memoizedProps:null,o=r.children,nr(i,r)?o=null:null!==a&&nr(i,a)&&(t.flags|=32),Eo(e,t),bo(e,t,o,n),t.child;case 6:return null===e&&us(t),null;case 13:return Lo(e,t,n);case 4:return Qs(t,t.stateNode.containerInfo),i=t.pendingProps,null===e?t.child=bs(t,null,i,n):bo(e,t,i,n),t.child;case 11:return i=t.type,r=t.pendingProps,wo(e,t,i,r=t.elementType===i?r:to(i,r),n);case 7:return bo(e,t,t.pendingProps,n),t.child;case 8:case 12:return bo(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(i=t.type._context,r=t.pendingProps,a=t.memoizedProps,o=r.value,Cr(Ds,i._currentValue),i._currentValue=o,null!==a)if(oi(a.value,o)){if(a.children===r.children&&!Tr.current){t=Wo(e,t,n);break e}}else for(null!==(a=t.child)&&(a.return=t);null!==a;){var l=a.dependencies;if(null!==l){o=a.child;for(var u=l.firstContext;null!==u;){if(u.context===i){if(1===a.tag){(u=zs(-1,n&-n)).tag=2;var c=a.updateQueue;if(null!==c){var h=(c=c.shared).pending;null===h?u.next=u:(u.next=h.next,h.next=u),c.pending=u}}a.lanes|=n,null!==(u=a.alternate)&&(u.lanes|=n),Ms(a.return,n,t),l.lanes|=n;break}u=u.next}}else if(10===a.tag)o=a.type===t.type?null:a.child;else if(18===a.tag){if(null===(o=a.return))throw Error(s(341));o.lanes|=n,null!==(l=o.alternate)&&(l.lanes|=n),Ms(o,n,t),o=a.sibling}else o=a.child;if(null!==o)o.return=a;else for(o=a;null!==o;){if(o===t){o=null;break}if(null!==(a=o.sibling)){a.return=o.return,o=a;break}o=o.return}a=o}bo(e,t,r.children,n),t=t.child}return t;case 9:return r=t.type,i=t.pendingProps.children,Ts(t,n),i=i(r=Ps(r)),t.flags|=1,bo(e,t,i,n),t.child;case 14:return r=to(i=t.type,t.pendingProps),Do(e,t,i,r=to(i.type,r),n);case 15:return _o(e,t,t.type,t.pendingProps,n);case 17:return i=t.type,r=t.pendingProps,r=t.elementType===i?r:to(i,r),Ho(e,t),t.tag=1,Or(i)?(e=!0,Rr(t)):e=!1,Ts(t,n),so(t,i,r),oo(t,i,r,n),Mo(null,t,i,!0,e,n);case 19:return Vo(e,t,n);case 22:return So(e,t,n)}throw Error(s(156,t.tag))};var Yu="function"===typeof reportError?reportError:function(e){console.error(e)};function Xu(e){this._internalRoot=e}function Qu(e){this._internalRoot=e}function Ku(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function Zu(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function Ju(){}function $u(e,t,n,i,r){var s=n._reactRootContainer;if(s){var a=s;if("function"===typeof r){var o=r;r=function(){var e=Wu(a);o.call(e)}}Hu(t,a,e,r)}else a=function(e,t,n,i,r){if(r){if("function"===typeof i){var s=i;i=function(){var e=Wu(a);s.call(e)}}var a=Vu(t,i,e,0,null,!1,0,"",Ju);return e._reactRootContainer=a,e[fr]=a.current,Vi(8===e.nodeType?e.parentNode:e),cu(),a}for(;r=e.lastChild;)e.removeChild(r);if("function"===typeof i){var o=i;i=function(){var e=Wu(l);o.call(e)}}var l=ju(e,0,!1,null,0,!1,0,"",Ju);return e._reactRootContainer=l,e[fr]=l.current,Vi(8===e.nodeType?e.parentNode:e),cu((function(){Hu(t,l,n,i)})),l}(n,t,e,r,i);return Wu(a)}Qu.prototype.render=Xu.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(s(409));Hu(e,t,null,null)},Qu.prototype.unmount=Xu.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;cu((function(){Hu(null,e,null,null)})),t[fr]=null}},Qu.prototype.unstable_scheduleHydration=function(e){if(e){var t=St();e={blockedOn:null,target:e,priority:t};for(var n=0;n<It.length&&0!==t&&t<It[n].priority;n++);It.splice(n,0,e),0===n&&Lt(e)}},wt=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=ht(t.pendingLanes);0!==n&&(yt(t,1|n),iu(t,Ze()),0===(6&Ml)&&(Vl=Ze()+500,Vr()))}break;case 13:cu((function(){var t=ks(e,1);if(null!==t){var n=eu();nu(t,e,1,n)}})),qu(e,1)}},Dt=function(e){if(13===e.tag){var t=ks(e,134217728);if(null!==t)nu(t,e,134217728,eu());qu(e,134217728)}},_t=function(e){if(13===e.tag){var t=tu(e),n=ks(e,t);if(null!==n)nu(n,e,t,eu());qu(e,t)}},St=function(){return xt},Et=function(e,t){var n=xt;try{return xt=e,t()}finally{xt=n}},De=function(e,t,n){switch(t){case"input":if(J(e,n),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var i=n[t];if(i!==e&&i.form===e.form){var r=wr(i);if(!r)throw Error(s(90));Y(i),J(i,r)}}}break;case"textarea":se(e,n);break;case"select":null!=(t=n.value)&&ne(e,!!n.multiple,t,!1)}},Me=uu,Te=cu;var ec={usingClientEntryPoint:!1,Events:[xr,br,wr,Ce,Ae,uu]},tc={findFiberByHostInstance:yr,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},nc={bundleType:tc.bundleType,version:tc.version,rendererPackageName:tc.rendererPackageName,rendererConfig:tc.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:b.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=Ge(e))?null:e.stateNode},findFiberByHostInstance:tc.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var ic=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ic.isDisabled&&ic.supportsFiber)try{rt=ic.inject(nc),st=ic}catch(ce){}}t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ec,t.createPortal=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!Ku(t))throw Error(s(200));return function(e,t,n){var i=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:D,key:null==i?null:""+i,children:e,containerInfo:t,implementation:n}}(e,t,null,n)},t.createRoot=function(e,t){if(!Ku(e))throw Error(s(299));var n=!1,i="",r=Yu;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(n=!0),void 0!==t.identifierPrefix&&(i=t.identifierPrefix),void 0!==t.onRecoverableError&&(r=t.onRecoverableError)),t=ju(e,1,!1,null,0,n,0,i,r),e[fr]=t.current,Vi(8===e.nodeType?e.parentNode:e),new Xu(t)},t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(s(188));throw e=Object.keys(e).join(","),Error(s(268,e))}return e=null===(e=Ge(t))?null:e.stateNode},t.flushSync=function(e){return cu(e)},t.hydrate=function(e,t,n){if(!Zu(t))throw Error(s(200));return $u(null,e,t,!0,n)},t.hydrateRoot=function(e,t,n){if(!Ku(e))throw Error(s(405));var i=null!=n&&n.hydratedSources||null,r=!1,a="",o=Yu;if(null!==n&&void 0!==n&&(!0===n.unstable_strictMode&&(r=!0),void 0!==n.identifierPrefix&&(a=n.identifierPrefix),void 0!==n.onRecoverableError&&(o=n.onRecoverableError)),t=Vu(t,null,e,1,null!=n?n:null,r,0,a,o),e[fr]=t.current,Vi(e),i)for(e=0;e<i.length;e++)r=(r=(n=i[e])._getVersion)(n._source),null==t.mutableSourceEagerHydrationData?t.mutableSourceEagerHydrationData=[n,r]:t.mutableSourceEagerHydrationData.push(n,r);return new Qu(t)},t.render=function(e,t,n){if(!Zu(t))throw Error(s(200));return $u(null,e,t,!1,n)},t.unmountComponentAtNode=function(e){if(!Zu(e))throw Error(s(40));return!!e._reactRootContainer&&(cu((function(){$u(null,null,e,!1,(function(){e._reactRootContainer=null,e[fr]=null}))})),!0)},t.unstable_batchedUpdates=uu,t.unstable_renderSubtreeIntoContainer=function(e,t,n,i){if(!Zu(n))throw Error(s(200));if(null==e||void 0===e._reactInternals)throw Error(s(38));return $u(e,t,n,!1,i)},t.version="18.3.1-next-f1338f8080-20240426"},391:(e,t,n)=>{"use strict";var i=n(950);t.createRoot=i.createRoot,t.hydrateRoot=i.hydrateRoot},950:(e,t,n)=>{"use strict";!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=n(730)},612:(e,t)=>{"use strict";function n(e,t){var n=e.length;e.push(t);e:for(;0<n;){var i=n-1>>>1,r=e[i];if(!(0<s(r,t)))break e;e[i]=t,e[n]=r,n=i}}function i(e){return 0===e.length?null:e[0]}function r(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var i=0,r=e.length,a=r>>>1;i<a;){var o=2*(i+1)-1,l=e[o],u=o+1,c=e[u];if(0>s(l,n))u<r&&0>s(c,l)?(e[i]=c,e[u]=n,i=u):(e[i]=l,e[o]=n,i=o);else{if(!(u<r&&0>s(c,n)))break e;e[i]=c,e[u]=n,i=u}}}return t}function s(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if("object"===typeof performance&&"function"===typeof performance.now){var a=performance;t.unstable_now=function(){return a.now()}}else{var o=Date,l=o.now();t.unstable_now=function(){return o.now()-l}}var u=[],c=[],h=1,d=null,p=3,f=!1,m=!1,g=!1,v="function"===typeof setTimeout?setTimeout:null,y="function"===typeof clearTimeout?clearTimeout:null,x="undefined"!==typeof setImmediate?setImmediate:null;function b(e){for(var t=i(c);null!==t;){if(null===t.callback)r(c);else{if(!(t.startTime<=e))break;r(c),t.sortIndex=t.expirationTime,n(u,t)}t=i(c)}}function w(e){if(g=!1,b(e),!m)if(null!==i(u))m=!0,I(D);else{var t=i(c);null!==t&&k(w,t.startTime-e)}}function D(e,n){m=!1,g&&(g=!1,y(C),C=-1),f=!0;var s=p;try{for(b(n),d=i(u);null!==d&&(!(d.expirationTime>n)||e&&!T());){var a=d.callback;if("function"===typeof a){d.callback=null,p=d.priorityLevel;var o=a(d.expirationTime<=n);n=t.unstable_now(),"function"===typeof o?d.callback=o:d===i(u)&&r(u),b(n)}else r(u);d=i(u)}if(null!==d)var l=!0;else{var h=i(c);null!==h&&k(w,h.startTime-n),l=!1}return l}finally{d=null,p=s,f=!1}}"undefined"!==typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var _,S=!1,E=null,C=-1,A=5,M=-1;function T(){return!(t.unstable_now()-M<A)}function P(){if(null!==E){var e=t.unstable_now();M=e;var n=!0;try{n=E(!0,e)}finally{n?_():(S=!1,E=null)}}else S=!1}if("function"===typeof x)_=function(){x(P)};else if("undefined"!==typeof MessageChannel){var F=new MessageChannel,O=F.port2;F.port1.onmessage=P,_=function(){O.postMessage(null)}}else _=function(){v(P,0)};function I(e){E=e,S||(S=!0,_())}function k(e,n){C=v((function(){e(t.unstable_now())}),n)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){m||f||(m=!0,I(D))},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):A=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return p},t.unstable_getFirstCallbackNode=function(){return i(u)},t.unstable_next=function(e){switch(p){case 1:case 2:case 3:var t=3;break;default:t=p}var n=p;p=t;try{return e()}finally{p=n}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=p;p=e;try{return t()}finally{p=n}},t.unstable_scheduleCallback=function(e,r,s){var a=t.unstable_now();switch("object"===typeof s&&null!==s?s="number"===typeof(s=s.delay)&&0<s?a+s:a:s=a,e){case 1:var o=-1;break;case 2:o=250;break;case 5:o=1073741823;break;case 4:o=1e4;break;default:o=5e3}return e={id:h++,callback:r,priorityLevel:e,startTime:s,expirationTime:o=s+o,sortIndex:-1},s>a?(e.sortIndex=s,n(c,e),null===i(u)&&e===i(c)&&(g?(y(C),C=-1):g=!0,k(w,s-a))):(e.sortIndex=o,n(u,e),m||f||(m=!0,I(D))),e},t.unstable_shouldYield=T,t.unstable_wrapCallback=function(e){var t=p;return function(){var n=p;p=t;try{return e.apply(this,arguments)}finally{p=n}}}},67:(e,t,n)=>{"use strict";e.exports=n(612)},358:(e,t)=>{"use strict";const n=/^[\u0021-\u003A\u003C\u003E-\u007E]+$/,i=/^[\u0021-\u003A\u003C-\u007E]*$/,r=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,s=/^[\u0020-\u003A\u003D-\u007E]*$/,a=Object.prototype.toString,o=(()=>{const e=function(){};return e.prototype=Object.create(null),e})();function l(e,t,n){do{const n=e.charCodeAt(t);if(32!==n&&9!==n)return t}while(++t<n);return n}function u(e,t,n){for(;t>n;){const n=e.charCodeAt(--t);if(32!==n&&9!==n)return t+1}return n}function c(e){if(-1===e.indexOf("%"))return e;try{return decodeURIComponent(e)}catch(t){return e}}},153:(e,t,n)=>{"use strict";var i=n(43),r=Symbol.for("react.element"),s=Symbol.for("react.fragment"),a=Object.prototype.hasOwnProperty,o=i.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function u(e,t,n){var i,s={},u=null,c=null;for(i in void 0!==n&&(u=""+n),void 0!==t.key&&(u=""+t.key),void 0!==t.ref&&(c=t.ref),t)a.call(t,i)&&!l.hasOwnProperty(i)&&(s[i]=t[i]);if(e&&e.defaultProps)for(i in t=e.defaultProps)void 0===s[i]&&(s[i]=t[i]);return{$$typeof:r,type:e,key:u,ref:c,props:s,_owner:o.current}}t.Fragment=s,t.jsx=u,t.jsxs=u},202:(e,t)=>{"use strict";var n=Symbol.for("react.element"),i=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),o=Symbol.for("react.provider"),l=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),c=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),d=Symbol.for("react.lazy"),p=Symbol.iterator;var f={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},m=Object.assign,g={};function v(e,t,n){this.props=e,this.context=t,this.refs=g,this.updater=n||f}function y(){}function x(e,t,n){this.props=e,this.context=t,this.refs=g,this.updater=n||f}v.prototype.isReactComponent={},v.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},v.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},y.prototype=v.prototype;var b=x.prototype=new y;b.constructor=x,m(b,v.prototype),b.isPureReactComponent=!0;var w=Array.isArray,D=Object.prototype.hasOwnProperty,_={current:null},S={key:!0,ref:!0,__self:!0,__source:!0};function E(e,t,i){var r,s={},a=null,o=null;if(null!=t)for(r in void 0!==t.ref&&(o=t.ref),void 0!==t.key&&(a=""+t.key),t)D.call(t,r)&&!S.hasOwnProperty(r)&&(s[r]=t[r]);var l=arguments.length-2;if(1===l)s.children=i;else if(1<l){for(var u=Array(l),c=0;c<l;c++)u[c]=arguments[c+2];s.children=u}if(e&&e.defaultProps)for(r in l=e.defaultProps)void 0===s[r]&&(s[r]=l[r]);return{$$typeof:n,type:e,key:a,ref:o,props:s,_owner:_.current}}function C(e){return"object"===typeof e&&null!==e&&e.$$typeof===n}var A=/\/+/g;function M(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,(function(e){return t[e]}))}(""+e.key):t.toString(36)}function T(e,t,r,s,a){var o=typeof e;"undefined"!==o&&"boolean"!==o||(e=null);var l=!1;if(null===e)l=!0;else switch(o){case"string":case"number":l=!0;break;case"object":switch(e.$$typeof){case n:case i:l=!0}}if(l)return a=a(l=e),e=""===s?"."+M(l,0):s,w(a)?(r="",null!=e&&(r=e.replace(A,"$&/")+"/"),T(a,t,r,"",(function(e){return e}))):null!=a&&(C(a)&&(a=function(e,t){return{$$typeof:n,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(a,r+(!a.key||l&&l.key===a.key?"":(""+a.key).replace(A,"$&/")+"/")+e)),t.push(a)),1;if(l=0,s=""===s?".":s+":",w(e))for(var u=0;u<e.length;u++){var c=s+M(o=e[u],u);l+=T(o,t,r,c,a)}else if(c=function(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=p&&e[p]||e["@@iterator"])?e:null}(e),"function"===typeof c)for(e=c.call(e),u=0;!(o=e.next()).done;)l+=T(o=o.value,t,r,c=s+M(o,u++),a);else if("object"===o)throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return l}function P(e,t,n){if(null==e)return e;var i=[],r=0;return T(e,i,"","",(function(e){return t.call(n,e,r++)})),i}function F(e){if(-1===e._status){var t=e._result;(t=t()).then((function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)}),(function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)})),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var O={current:null},I={transition:null},k={ReactCurrentDispatcher:O,ReactCurrentBatchConfig:I,ReactCurrentOwner:_};function B(){throw Error("act(...) is not supported in production builds of React.")}t.Children={map:P,forEach:function(e,t,n){P(e,(function(){t.apply(this,arguments)}),n)},count:function(e){var t=0;return P(e,(function(){t++})),t},toArray:function(e){return P(e,(function(e){return e}))||[]},only:function(e){if(!C(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=v,t.Fragment=r,t.Profiler=a,t.PureComponent=x,t.StrictMode=s,t.Suspense=c,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=k,t.act=B,t.cloneElement=function(e,t,i){if(null===e||void 0===e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var r=m({},e.props),s=e.key,a=e.ref,o=e._owner;if(null!=t){if(void 0!==t.ref&&(a=t.ref,o=_.current),void 0!==t.key&&(s=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(u in t)D.call(t,u)&&!S.hasOwnProperty(u)&&(r[u]=void 0===t[u]&&void 0!==l?l[u]:t[u])}var u=arguments.length-2;if(1===u)r.children=i;else if(1<u){l=Array(u);for(var c=0;c<u;c++)l[c]=arguments[c+2];r.children=l}return{$$typeof:n,type:e.type,key:s,ref:a,props:r,_owner:o}},t.createContext=function(e){return(e={$$typeof:l,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:o,_context:e},e.Consumer=e},t.createElement=E,t.createFactory=function(e){var t=E.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:u,render:e}},t.isValidElement=C,t.lazy=function(e){return{$$typeof:d,_payload:{_status:-1,_result:e},_init:F}},t.memo=function(e,t){return{$$typeof:h,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=I.transition;I.transition={};try{e()}finally{I.transition=t}},t.unstable_act=B,t.useCallback=function(e,t){return O.current.useCallback(e,t)},t.useContext=function(e){return O.current.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e){return O.current.useDeferredValue(e)},t.useEffect=function(e,t){return O.current.useEffect(e,t)},t.useId=function(){return O.current.useId()},t.useImperativeHandle=function(e,t,n){return O.current.useImperativeHandle(e,t,n)},t.useInsertionEffect=function(e,t){return O.current.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return O.current.useLayoutEffect(e,t)},t.useMemo=function(e,t){return O.current.useMemo(e,t)},t.useReducer=function(e,t,n){return O.current.useReducer(e,t,n)},t.useRef=function(e){return O.current.useRef(e)},t.useState=function(e){return O.current.useState(e)},t.useSyncExternalStore=function(e,t,n){return O.current.useSyncExternalStore(e,t,n)},t.useTransition=function(){return O.current.useTransition()},t.version="18.3.1"},43:(e,t,n)=>{"use strict";e.exports=n(202)},579:(e,t,n)=>{"use strict";e.exports=n(153)},222:function(e,t,n){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var n=null;if(!e||"string"!==typeof e)return n;var i=(0,r.default)(e),s="function"===typeof t;return i.forEach((function(e){if("declaration"===e.type){var i=e.property,r=e.value;s?t(i,r,e):r&&((n=n||{})[i]=r)}})),n};var r=i(n(403))}},t={};function n(i){var r=t[i];if(void 0!==r)return r.exports;var s=t[i]={exports:{}};return e[i].call(s.exports,s,s.exports,n),s.exports}n.m=e,(()=>{var e,t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__;n.t=function(i,r){if(1&r&&(i=this(i)),8&r)return i;if("object"===typeof i&&i){if(4&r&&i.__esModule)return i;if(16&r&&"function"===typeof i.then)return i}var s=Object.create(null);n.r(s);var a={};e=e||[null,t({}),t([]),t(t)];for(var o=2&r&&i;"object"==typeof o&&!~e.indexOf(o);o=t(o))Object.getOwnPropertyNames(o).forEach((e=>a[e]=()=>i[e]));return a.default=()=>i,n.d(s,a),s}})(),n.d=(e,t)=>{for(var i in t)n.o(t,i)&&!n.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},n.f={},n.e=e=>Promise.all(Object.keys(n.f).reduce(((t,i)=>(n.f[i](e,t),t)),[])),n.u=e=>"static/js/"+e+"."+{23:"94ff5187",160:"d12b4670",208:"253fb789",293:"f2dbe920",516:"a755525b",519:"54f097b2",917:"db7dba75",946:"834b3763"}[e]+".chunk.js",n.miniCssF=e=>{},n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={},t="frontend:";n.l=(i,r,s,a)=>{if(e[i])e[i].push(r);else{var o,l;if(void 0!==s)for(var u=document.getElementsByTagName("script"),c=0;c<u.length;c++){var h=u[c];if(h.getAttribute("src")==i||h.getAttribute("data-webpack")==t+s){o=h;break}}o||(l=!0,(o=document.createElement("script")).charset="utf-8",o.timeout=120,n.nc&&o.setAttribute("nonce",n.nc),o.setAttribute("data-webpack",t+s),o.src=i),e[i]=[r];var d=(t,n)=>{o.onerror=o.onload=null,clearTimeout(p);var r=e[i];if(delete e[i],o.parentNode&&o.parentNode.removeChild(o),r&&r.forEach((e=>e(n))),t)return t(n)},p=setTimeout(d.bind(null,void 0,{type:"timeout",target:o}),12e4);o.onerror=d.bind(null,o.onerror),o.onload=d.bind(null,o.onload),l&&document.head.appendChild(o)}}})(),n.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.p="/",(()=>{var e={792:0};n.f.j=(t,i)=>{var r=n.o(e,t)?e[t]:void 0;if(0!==r)if(r)i.push(r[2]);else{var s=new Promise(((n,i)=>r=e[t]=[n,i]));i.push(r[2]=s);var a=n.p+n.u(t),o=new Error;n.l(a,(i=>{if(n.o(e,t)&&(0!==(r=e[t])&&(e[t]=void 0),r)){var s=i&&("load"===i.type?"missing":i.type),a=i&&i.target&&i.target.src;o.message="Loading chunk "+t+" failed.\n("+s+": "+a+")",o.name="ChunkLoadError",o.type=s,o.request=a,r[1](o)}}),"chunk-"+t,t)}};var t=(t,i)=>{var r,s,a=i[0],o=i[1],l=i[2],u=0;if(a.some((t=>0!==e[t]))){for(r in o)n.o(o,r)&&(n.m[r]=o[r]);if(l)l(n)}for(t&&t(i);u<a.length;u++)s=a[u],n.o(e,s)&&e[s]&&e[s][0](),e[s]=0},i=self.webpackChunkfrontend=self.webpackChunkfrontend||[];i.forEach(t.bind(null,0)),i.push=t.bind(null,i.push.bind(i))})(),(()=>{"use strict";var e={};n.r(e),n.d(e,{hasBrowserEnv:()=>B6,hasStandardBrowserEnv:()=>L6,hasStandardBrowserWebWorkerEnv:()=>z6,navigator:()=>R6,origin:()=>N6});var t={};n.r(t),n.d(t,{boolean:()=>d9,booleanish:()=>p9,commaOrSpaceSeparated:()=>y9,commaSeparated:()=>v9,number:()=>m9,overloadedBoolean:()=>f9,spaceSeparated:()=>g9});var i={};n.r(i),n.d(i,{attentionMarkers:()=>Kee,contentInitial:()=>Wee,disable:()=>Zee,document:()=>Hee,flow:()=>qee,flowInitial:()=>Gee,insideSpan:()=>Qee,string:()=>Yee,text:()=>Xee});var r=n(43),s=n.t(r,2),a=n(391);function o(e,t){if(null==e)return{};var n,i,r=function(e,t){if(null==e)return{};var n={};for(var i in e)if({}.hasOwnProperty.call(e,i)){if(-1!==t.indexOf(i))continue;n[i]=e[i]}return n}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(i=0;i<s.length;i++)n=s[i],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function l(e){return l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l(e)}function u(e){var t=function(e,t){if("object"!=l(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!=l(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==l(t)?t:t+""}function c(e,t,n){return(t=u(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function h(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function d(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?h(Object(n),!0).forEach((function(t){c(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):h(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}n(358);const p=["page"],f=["page","matches"],m=["onClick","discover","prefetch","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],g=["aria-current","caseSensitive","className","end","style","to","viewTransition","children"],v=["discover","fetcherKey","navigate","reloadDocument","replace","state","method","action","onSubmit","relative","preventScrollReset","viewTransition"];var y="popstate";function x(){return C((function(e,t){let{pathname:n,search:i,hash:r}=e.location;return _("",{pathname:n,search:i,hash:r},t.state&&t.state.usr||null,t.state&&t.state.key||"default")}),(function(e,t){return"string"===typeof t?t:S(t)}),null,arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})}function b(e,t){if(!1===e||null===e||"undefined"===typeof e)throw new Error(t)}function w(e,t){if(!e){"undefined"!==typeof console&&console.warn(t);try{throw new Error(t)}catch(Mn){}}}function D(e,t){return{usr:e.state,key:e.key,idx:t}}function _(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3?arguments[3]:void 0;return d(d({pathname:"string"===typeof e?e:e.pathname,search:"",hash:""},"string"===typeof t?E(t):t),{},{state:n,key:t&&t.key||i||Math.random().toString(36).substring(2,10)})}function S(e){let{pathname:t="/",search:n="",hash:i=""}=e;return n&&"?"!==n&&(t+="?"===n.charAt(0)?n:"?"+n),i&&"#"!==i&&(t+="#"===i.charAt(0)?i:"#"+i),t}function E(e){let t={};if(e){let n=e.indexOf("#");n>=0&&(t.hash=e.substring(n),e=e.substring(0,n));let i=e.indexOf("?");i>=0&&(t.search=e.substring(i),e=e.substring(0,i)),e&&(t.pathname=e)}return t}function C(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},{window:r=document.defaultView,v5Compat:s=!1}=i,a=r.history,o="POP",l=null,u=c();function c(){return(a.state||{idx:null}).idx}function h(){o="POP";let e=c(),t=null==e?null:e-u;u=e,l&&l({action:o,location:f.location,delta:t})}function p(e){let t="null"!==r.location.origin?r.location.origin:r.location.href,n="string"===typeof e?e:S(e);return n=n.replace(/ $/,"%20"),b(t,"No window.location.(origin|href) available to create URL for href: ".concat(n)),new URL(n,t)}null==u&&(u=0,a.replaceState(d(d({},a.state),{},{idx:u}),""));let f={get action(){return o},get location(){return e(r,a)},listen(e){if(l)throw new Error("A history only accepts one active listener");return r.addEventListener(y,h),l=e,()=>{r.removeEventListener(y,h),l=null}},createHref:e=>t(r,e),createURL:p,encodeLocation(e){let t=p(e);return{pathname:t.pathname,search:t.search,hash:t.hash}},push:function(e,t){o="PUSH";let i=_(f.location,e,t);n&&n(i,e),u=c()+1;let h=D(i,u),d=f.createHref(i);try{a.pushState(h,"",d)}catch(p){if(p instanceof DOMException&&"DataCloneError"===p.name)throw p;r.location.assign(d)}s&&l&&l({action:o,location:f.location,delta:1})},replace:function(e,t){o="REPLACE";let i=_(f.location,e,t);n&&n(i,e),u=c();let r=D(i,u),h=f.createHref(i);a.replaceState(r,"",h),s&&l&&l({action:o,location:f.location,delta:0})},go:e=>a.go(e)};return f}function A(e,t){return M(e,t,arguments.length>2&&void 0!==arguments[2]?arguments[2]:"/",!1)}function M(e,t,n,i){let r=V(("string"===typeof t?E(t):t).pathname||"/",n);if(null==r)return null;let s=T(e);!function(e){e.sort(((e,t)=>e.score!==t.score?t.score-e.score:function(e,t){let n=e.length===t.length&&e.slice(0,-1).every(((e,n)=>e===t[n]));return n?e[e.length-1]-t[t.length-1]:0}(e.routesMeta.map((e=>e.childrenIndex)),t.routesMeta.map((e=>e.childrenIndex)))))}(s);let a=null;for(let o=0;null==a&&o<s.length;++o){let e=U(r);a=N(s[o],e,i)}return a}function T(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",r=(e,r,s)=>{let a={relativePath:void 0===s?e.path||"":s,caseSensitive:!0===e.caseSensitive,childrenIndex:r,route:e};a.relativePath.startsWith("/")&&(b(a.relativePath.startsWith(i),'Absolute route path "'.concat(a.relativePath,'" nested under path "').concat(i,'" is not valid. An absolute child route path must start with the combined path of all its parent routes.')),a.relativePath=a.relativePath.slice(i.length));let o=Y([i,a.relativePath]),l=n.concat(a);e.children&&e.children.length>0&&(b(!0!==e.index,'Index routes must not have child routes. Please remove all child routes from route path "'.concat(o,'".')),T(e.children,t,l,o)),(null!=e.path||e.index)&&t.push({path:o,score:z(o,e.index),routesMeta:l})};return e.forEach(((e,t)=>{var n;if(""!==e.path&&null!==(n=e.path)&&void 0!==n&&n.includes("?"))for(let i of P(e.path))r(e,t,i);else r(e,t)})),t}function P(e){let t=e.split("/");if(0===t.length)return[];let[n,...i]=t,r=n.endsWith("?"),s=n.replace(/\?$/,"");if(0===i.length)return r?[s,""]:[s];let a=P(i.join("/")),o=[];return o.push(...a.map((e=>""===e?s:[s,e].join("/")))),r&&o.push(...a),o.map((t=>e.startsWith("/")&&""===t?"/":t))}var F=/^:[\w-]+$/,O=3,I=2,k=1,B=10,R=-2,L=e=>"*"===e;function z(e,t){let n=e.split("/"),i=n.length;return n.some(L)&&(i+=R),t&&(i+=I),n.filter((e=>!L(e))).reduce(((e,t)=>e+(F.test(t)?O:""===t?k:B)),i)}function N(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],{routesMeta:i}=e,r={},s="/",a=[];for(let o=0;o<i.length;++o){let e=i[o],l=o===i.length-1,u="/"===s?t:t.slice(s.length)||"/",c=j({path:e.relativePath,caseSensitive:e.caseSensitive,end:l},u),h=e.route;if(!c&&l&&n&&!i[i.length-1].route.index&&(c=j({path:e.relativePath,caseSensitive:e.caseSensitive,end:!1},u)),!c)return null;Object.assign(r,c.params),a.push({params:r,pathname:Y([s,c.pathname]),pathnameBase:X(Y([s,c.pathnameBase])),route:h}),"/"!==c.pathnameBase&&(s=Y([s,c.pathnameBase]))}return a}function j(e,t){"string"===typeof e&&(e={path:e,caseSensitive:!1,end:!0});let[n,i]=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];w("*"===e||!e.endsWith("*")||e.endsWith("/*"),'Route path "'.concat(e,'" will be treated as if it were "').concat(e.replace(/\*$/,"/*"),'" because the `*` character must always follow a `/` in the pattern. To get rid of this warning, please change the route path to "').concat(e.replace(/\*$/,"/*"),'".'));let i=[],r="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,((e,t,n)=>(i.push({paramName:t,isOptional:null!=n}),n?"/?([^\\/]+)?":"/([^\\/]+)")));e.endsWith("*")?(i.push({paramName:"*"}),r+="*"===e||"/*"===e?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?r+="\\/*$":""!==e&&"/"!==e&&(r+="(?:(?=\\/|$))");let s=new RegExp(r,t?void 0:"i");return[s,i]}(e.path,e.caseSensitive,e.end),r=t.match(n);if(!r)return null;let s=r[0],a=s.replace(/(.)\/+$/,"$1"),o=r.slice(1),l=i.reduce(((e,t,n)=>{let{paramName:i,isOptional:r}=t;if("*"===i){let e=o[n]||"";a=s.slice(0,s.length-e.length).replace(/(.)\/+$/,"$1")}const l=o[n];return e[i]=r&&!l?void 0:(l||"").replace(/%2F/g,"/"),e}),{});return{params:l,pathname:s,pathnameBase:a,pattern:e}}function U(e){try{return e.split("/").map((e=>decodeURIComponent(e).replace(/\//g,"%2F"))).join("/")}catch(t){return w(!1,'The URL path "'.concat(e,'" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (').concat(t,").")),e}}function V(e,t){if("/"===t)return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let n=t.endsWith("/")?t.length-1:t.length,i=e.charAt(n);return i&&"/"!==i?null:e.slice(n)||"/"}function H(e,t,n,i){return"Cannot include a '".concat(e,"' character in a manually specified `to.").concat(t,"` field [").concat(JSON.stringify(i),"].  Please separate it out to the `to.").concat(n,'` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.')}function W(e){return e.filter(((e,t)=>0===t||e.route.path&&e.route.path.length>0))}function G(e){let t=W(e);return t.map(((e,n)=>n===t.length-1?e.pathname:e.pathnameBase))}function q(e,t,n){let i,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];"string"===typeof e?i=E(e):(i=d({},e),b(!i.pathname||!i.pathname.includes("?"),H("?","pathname","search",i)),b(!i.pathname||!i.pathname.includes("#"),H("#","pathname","hash",i)),b(!i.search||!i.search.includes("#"),H("#","search","hash",i)));let s,a=""===e||""===i.pathname,o=a?"/":i.pathname;if(null==o)s=n;else{let e=t.length-1;if(!r&&o.startsWith("..")){let t=o.split("/");for(;".."===t[0];)t.shift(),e-=1;i.pathname=t.join("/")}s=e>=0?t[e]:"/"}let l=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"/",{pathname:n,search:i="",hash:r=""}="string"===typeof e?E(e):e,s=n?n.startsWith("/")?n:function(e,t){let n=t.replace(/\/+$/,"").split("/");return e.split("/").forEach((e=>{".."===e?n.length>1&&n.pop():"."!==e&&n.push(e)})),n.length>1?n.join("/"):"/"}(n,t):t;return{pathname:s,search:Q(i),hash:K(r)}}(i,s),u=o&&"/"!==o&&o.endsWith("/"),c=(a||"."===o)&&n.endsWith("/");return l.pathname.endsWith("/")||!u&&!c||(l.pathname+="/"),l}var Y=e=>e.join("/").replace(/\/\/+/g,"/"),X=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),Q=e=>e&&"?"!==e?e.startsWith("?")?e:"?"+e:"",K=e=>e&&"#"!==e?e.startsWith("#")?e:"#"+e:"";function Z(e){return null!=e&&"number"===typeof e.status&&"string"===typeof e.statusText&&"boolean"===typeof e.internal&&"data"in e}var J=["POST","PUT","PATCH","DELETE"],$=(new Set(J),["GET",...J]);new Set($),Symbol("ResetLoaderData");var ee=r.createContext(null);ee.displayName="DataRouter";var te=r.createContext(null);te.displayName="DataRouterState";var ne=r.createContext({isTransitioning:!1});ne.displayName="ViewTransition";var ie=r.createContext(new Map);ie.displayName="Fetchers";var re=r.createContext(null);re.displayName="Await";var se=r.createContext(null);se.displayName="Navigation";var ae=r.createContext(null);ae.displayName="Location";var oe=r.createContext({outlet:null,matches:[],isDataRoute:!1});oe.displayName="Route";var le=r.createContext(null);le.displayName="RouteError";function ue(){return null!=r.useContext(ae)}function ce(){return b(ue(),"useLocation() may be used only in the context of a <Router> component."),r.useContext(ae).location}var he="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function de(e){r.useContext(se).static||r.useLayoutEffect(e)}function pe(){let{isDataRoute:e}=r.useContext(oe);return e?function(){let{router:e}=De("useNavigate"),t=Se("useNavigate"),n=r.useRef(!1);de((()=>{n.current=!0}));let i=r.useCallback((async function(i){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};w(n.current,he),n.current&&("number"===typeof i?e.navigate(i):await e.navigate(i,d({fromRouteId:t},r)))}),[e,t]);return i}():function(){b(ue(),"useNavigate() may be used only in the context of a <Router> component.");let e=r.useContext(ee),{basename:t,navigator:n}=r.useContext(se),{matches:i}=r.useContext(oe),{pathname:s}=ce(),a=JSON.stringify(G(i)),o=r.useRef(!1);de((()=>{o.current=!0}));let l=r.useCallback((function(i){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(w(o.current,he),!o.current)return;if("number"===typeof i)return void n.go(i);let l=q(i,JSON.parse(a),s,"path"===r.relative);null==e&&"/"!==t&&(l.pathname="/"===l.pathname?t:Y([t,l.pathname])),(r.replace?n.replace:n.push)(l,r.state,r)}),[t,n,a,s,e]);return l}()}r.createContext(null);function fe(e){let{relative:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{matches:n}=r.useContext(oe),{pathname:i}=ce(),s=JSON.stringify(G(n));return r.useMemo((()=>q(e,JSON.parse(s),i,"path"===t)),[e,s,i,t])}function me(e,t,n,i){b(ue(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:s,static:a}=r.useContext(se),{matches:o}=r.useContext(oe),l=o[o.length-1],u=l?l.params:{},c=l?l.pathname:"/",h=l?l.pathnameBase:"/",p=l&&l.route;{let e=p&&p.path||"";Ae(c,!p||e.endsWith("*")||e.endsWith("*?"),'You rendered descendant <Routes> (or called `useRoutes()`) at "'.concat(c,'" (under <Route path="').concat(e,'">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won\'t match anymore and therefore the child routes will never render.\n\nPlease change the parent <Route path="').concat(e,'"> to <Route path="').concat("/"===e?"*":"".concat(e,"/*"),'">.'))}let f,m=ce();if(t){var g;let e="string"===typeof t?E(t):t;b("/"===h||(null===(g=e.pathname)||void 0===g?void 0:g.startsWith(h)),'When overriding the location using `<Routes location>` or `useRoutes(routes, location)`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "'.concat(h,'" but pathname "').concat(e.pathname,'" was given in the `location` prop.')),f=e}else f=m;let v=f.pathname||"/",y=v;if("/"!==h){let e=h.replace(/^\//,"").split("/");y="/"+v.replace(/^\//,"").split("/").slice(e.length).join("/")}let x=!a&&n&&n.matches&&n.matches.length>0?n.matches:A(e,{pathname:y});w(p||null!=x,'No routes matched location "'.concat(f.pathname).concat(f.search).concat(f.hash,'" ')),w(null==x||void 0!==x[x.length-1].route.element||void 0!==x[x.length-1].route.Component||void 0!==x[x.length-1].route.lazy,'Matched leaf route at location "'.concat(f.pathname).concat(f.search).concat(f.hash,'" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.'));let D=be(x&&x.map((e=>Object.assign({},e,{params:Object.assign({},u,e.params),pathname:Y([h,s.encodeLocation?s.encodeLocation(e.pathname).pathname:e.pathname]),pathnameBase:"/"===e.pathnameBase?h:Y([h,s.encodeLocation?s.encodeLocation(e.pathnameBase).pathname:e.pathnameBase])}))),o,n,i);return t&&D?r.createElement(ae.Provider,{value:{location:d({pathname:"/",search:"",hash:"",state:null,key:"default"},f),navigationType:"POP"}},D):D}function ge(){let e=Ee(),t=Z(e)?"".concat(e.status," ").concat(e.statusText):e instanceof Error?e.message:JSON.stringify(e),n=e instanceof Error?e.stack:null,i="rgba(200,200,200, 0.5)",s={padding:"0.5rem",backgroundColor:i},a={padding:"2px 4px",backgroundColor:i},o=null;return console.error("Error handled by React Router default ErrorBoundary:",e),o=r.createElement(r.Fragment,null,r.createElement("p",null,"\ud83d\udcbf Hey developer \ud83d\udc4b"),r.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",r.createElement("code",{style:a},"ErrorBoundary")," or"," ",r.createElement("code",{style:a},"errorElement")," prop on your route.")),r.createElement(r.Fragment,null,r.createElement("h2",null,"Unexpected Application Error!"),r.createElement("h3",{style:{fontStyle:"italic"}},t),n?r.createElement("pre",{style:s},n):null,o)}var ve=r.createElement(ge,null),ye=class extends r.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||"idle"!==t.revalidation&&"idle"===e.revalidation?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:void 0!==e.error?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return void 0!==this.state.error?r.createElement(oe.Provider,{value:this.props.routeContext},r.createElement(le.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function xe(e){let{routeContext:t,match:n,children:i}=e,s=r.useContext(ee);return s&&s.static&&s.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=n.route.id),r.createElement(oe.Provider,{value:t},i)}function be(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(null==e){if(!n)return null;if(n.errors)e=n.matches;else{if(0!==t.length||n.initialized||!(n.matches.length>0))return null;e=n.matches}}let i=e,s=null===n||void 0===n?void 0:n.errors;if(null!=s){let e=i.findIndex((e=>e.route.id&&void 0!==(null===s||void 0===s?void 0:s[e.route.id])));b(e>=0,"Could not find a matching route for errors on route IDs: ".concat(Object.keys(s).join(","))),i=i.slice(0,Math.min(i.length,e+1))}let a=!1,o=-1;if(n)for(let r=0;r<i.length;r++){let e=i[r];if((e.route.HydrateFallback||e.route.hydrateFallbackElement)&&(o=r),e.route.id){let{loaderData:t,errors:r}=n,s=e.route.loader&&!t.hasOwnProperty(e.route.id)&&(!r||void 0===r[e.route.id]);if(e.route.lazy||s){a=!0,i=o>=0?i.slice(0,o+1):[i[0]];break}}}return i.reduceRight(((e,l,u)=>{let c,h=!1,d=null,p=null;n&&(c=s&&l.route.id?s[l.route.id]:void 0,d=l.route.errorElement||ve,a&&(o<0&&0===u?(Ae("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),h=!0,p=null):o===u&&(h=!0,p=l.route.hydrateFallbackElement||null)));let f=t.concat(i.slice(0,u+1)),m=()=>{let t;return t=c?d:h?p:l.route.Component?r.createElement(l.route.Component,null):l.route.element?l.route.element:e,r.createElement(xe,{match:l,routeContext:{outlet:e,matches:f,isDataRoute:null!=n},children:t})};return n&&(l.route.ErrorBoundary||l.route.errorElement||0===u)?r.createElement(ye,{location:n.location,revalidation:n.revalidation,component:d,error:c,children:m(),routeContext:{outlet:null,matches:f,isDataRoute:!0}}):m()}),null)}function we(e){return"".concat(e," must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.")}function De(e){let t=r.useContext(ee);return b(t,we(e)),t}function _e(e){let t=r.useContext(te);return b(t,we(e)),t}function Se(e){let t=function(e){let t=r.useContext(oe);return b(t,we(e)),t}(e),n=t.matches[t.matches.length-1];return b(n.route.id,"".concat(e,' can only be used on routes that contain a unique "id"')),n.route.id}function Ee(){var e;let t=r.useContext(le),n=_e("useRouteError"),i=Se("useRouteError");return void 0!==t?t:null===(e=n.errors)||void 0===e?void 0:e[i]}var Ce={};function Ae(e,t,n){t||Ce[e]||(Ce[e]=!0,w(!1,n))}r.memo((function(e){let{routes:t,future:n,state:i}=e;return me(t,void 0,i,n)}));function Me(e){b(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function Te(e){let{basename:t="/",children:n=null,location:i,navigationType:s="POP",navigator:a,static:o=!1}=e;b(!ue(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let l=t.replace(/^\/*/,"/"),u=r.useMemo((()=>({basename:l,navigator:a,static:o,future:{}})),[l,a,o]);"string"===typeof i&&(i=E(i));let{pathname:c="/",search:h="",hash:d="",state:p=null,key:f="default"}=i,m=r.useMemo((()=>{let e=V(c,l);return null==e?null:{location:{pathname:e,search:h,hash:d,state:p,key:f},navigationType:s}}),[l,c,h,d,p,f,s]);return w(null!=m,'<Router basename="'.concat(l,'"> is not able to match the URL "').concat(c).concat(h).concat(d,"\" because it does not start with the basename, so the <Router> won't render anything.")),null==m?null:r.createElement(se.Provider,{value:u},r.createElement(ae.Provider,{children:n,value:m}))}function Pe(e){let{children:t,location:n}=e;return me(Fe(t),n)}r.Component;function Fe(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=[];return r.Children.forEach(e,((e,i)=>{if(!r.isValidElement(e))return;let s=[...t,i];if(e.type===r.Fragment)return void n.push.apply(n,Fe(e.props.children,s));b(e.type===Me,"[".concat("string"===typeof e.type?e.type:e.type.name,"] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>")),b(!e.props.index||!e.props.children,"An index route cannot have child routes.");let a={id:e.props.id||s.join("-"),caseSensitive:e.props.caseSensitive,element:e.props.element,Component:e.props.Component,index:e.props.index,path:e.props.path,loader:e.props.loader,action:e.props.action,hydrateFallbackElement:e.props.hydrateFallbackElement,HydrateFallback:e.props.HydrateFallback,errorElement:e.props.errorElement,ErrorBoundary:e.props.ErrorBoundary,hasErrorBoundary:!0===e.props.hasErrorBoundary||null!=e.props.ErrorBoundary||null!=e.props.errorElement,shouldRevalidate:e.props.shouldRevalidate,handle:e.props.handle,lazy:e.props.lazy};e.props.children&&(a.children=Fe(e.props.children,s)),n.push(a)})),n}var Oe="get",Ie="application/x-www-form-urlencoded";function ke(e){return null!=e&&"string"===typeof e.tagName}var Be=null;var Re=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function Le(e){return null==e||Re.has(e)?e:(w(!1,'"'.concat(e,'" is not a valid `encType` for `<Form>`/`<fetcher.Form>` and will default to "').concat(Ie,'"')),null)}function ze(e,t){let n,i,r,s,a;if(ke(o=e)&&"form"===o.tagName.toLowerCase()){let a=e.getAttribute("action");i=a?V(a,t):null,n=e.getAttribute("method")||Oe,r=Le(e.getAttribute("enctype"))||Ie,s=new FormData(e)}else if(function(e){return ke(e)&&"button"===e.tagName.toLowerCase()}(e)||function(e){return ke(e)&&"input"===e.tagName.toLowerCase()}(e)&&("submit"===e.type||"image"===e.type)){let a=e.form;if(null==a)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let o=e.getAttribute("formaction")||a.getAttribute("action");if(i=o?V(o,t):null,n=e.getAttribute("formmethod")||a.getAttribute("method")||Oe,r=Le(e.getAttribute("formenctype"))||Le(a.getAttribute("enctype"))||Ie,s=new FormData(a,e),!function(){if(null===Be)try{new FormData(document.createElement("form"),0),Be=!1}catch(Mn){Be=!0}return Be}()){let{name:t,type:n,value:i}=e;if("image"===n){let e=t?"".concat(t,"."):"";s.append("".concat(e,"x"),"0"),s.append("".concat(e,"y"),"0")}else t&&s.append(t,i)}}else{if(ke(e))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');n=Oe,i=null,r=Ie,a=e}var o;return s&&"text/plain"===r&&(a=s,s=void 0),{action:i,method:n.toLowerCase(),encType:r,formData:s,body:a}}function Ne(e,t){if(!1===e||null===e||"undefined"===typeof e)throw new Error(t)}async function je(e,t){if(e.id in t)return t[e.id];try{let n=await import(e.module);return t[e.id]=n,n}catch(n){return console.error("Error loading route module `".concat(e.module,"`, reloading page...")),console.error(n),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise((()=>{}))}}function Ue(e){return null!=e&&"string"===typeof e.page}function Ve(e){return null!=e&&(null==e.href?"preload"===e.rel&&"string"===typeof e.imageSrcSet&&"string"===typeof e.imageSizes:"string"===typeof e.rel&&"string"===typeof e.href)}function He(e,t,n,i,r,s){let a=(e,t)=>!n[t]||e.route.id!==n[t].route.id,o=(e,t)=>{var i;return n[t].pathname!==e.pathname||(null===(i=n[t].route.path)||void 0===i?void 0:i.endsWith("*"))&&n[t].params["*"]!==e.params["*"]};return"assets"===s?t.filter(((e,t)=>a(e,t)||o(e,t))):"data"===s?t.filter(((t,s)=>{let l=i.routes[t.route.id];if(!l||!l.hasLoader)return!1;if(a(t,s)||o(t,s))return!0;if(t.route.shouldRevalidate){var u;let i=t.route.shouldRevalidate({currentUrl:new URL(r.pathname+r.search+r.hash,window.origin),currentParams:(null===(u=n[0])||void 0===u?void 0:u.params)||{},nextUrl:new URL(e,window.origin),nextParams:t.params,defaultShouldRevalidate:!0});if("boolean"===typeof i)return i}return!0})):[]}function We(e){return[...new Set(e)]}function Ge(e,t){let n=new Set,i=new Set(t);return e.reduce(((e,r)=>{if(t&&!Ue(r)&&"script"===r.as&&r.href&&i.has(r.href))return e;let s=JSON.stringify(function(e){let t={},n=Object.keys(e).sort();for(let i of n)t[i]=e[i];return t}(r));return n.has(s)||(n.add(s),e.push({key:s,link:r})),e}),[])}function qe(e){return{__html:e}}Symbol("SingleFetchRedirect");function Ye(e){let t="string"===typeof e?new URL(e,"undefined"===typeof window?"server://singlefetch/":window.location.origin):e;return"/"===t.pathname?t.pathname="_root.data":t.pathname="".concat(t.pathname.replace(/\/$/,""),".data"),t}r.Component;function Xe(e){let{error:t,isOutsideRemixApp:n}=e;console.error(t);let i,s=r.createElement("script",{dangerouslySetInnerHTML:{__html:'\n        console.log(\n          "\ud83d\udcbf Hey developer \ud83d\udc4b. You can provide a way better UX than this when your app throws errors. Check out https://remix.run/guides/errors for more information."\n        );\n      '}});if(Z(t))return r.createElement(Qe,{title:"Unhandled Thrown Response!"},r.createElement("h1",{style:{fontSize:"24px"}},t.status," ",t.statusText),s);if(t instanceof Error)0;else{let e=null==t?"Unknown Error":"object"===typeof t&&"toString"in t?t.toString():JSON.stringify(t);new Error(e)}return r.createElement(Qe,{title:"Application Error!",isOutsideRemixApp:n},r.createElement("h1",{style:{fontSize:"24px"}},"Application Error"),r.createElement("pre",{style:{padding:"2rem",background:"hsla(10, 50%, 50%, 0.1)",color:"red",overflow:"auto"}},i.stack),s)}function Qe(e){var t;let{title:n,renderScripts:i,isOutsideRemixApp:s,children:a}=e,{routeModules:o}=et();return null!==o.root&&void 0!==t&&t.Layout&&!s?a:r.createElement("html",{lang:"en"},r.createElement("head",null,r.createElement("meta",{charSet:"utf-8"}),r.createElement("meta",{name:"viewport",content:"width=device-width,initial-scale=1,viewport-fit=cover"}),r.createElement("title",null,n)),r.createElement("body",null,r.createElement("main",{style:{fontFamily:"system-ui, sans-serif",padding:"2rem"}},a,i?r.createElement(ot,null):null)))}function Ke(e){return!e}function Ze(){let e=r.useContext(ee);return Ne(e,"You must render this element inside a <DataRouterContext.Provider> element"),e}function Je(){let e=r.useContext(te);return Ne(e,"You must render this element inside a <DataRouterStateContext.Provider> element"),e}var $e=r.createContext(void 0);function et(){let e=r.useContext($e);return Ne(e,"You must render this element inside a <HydratedRouter> element"),e}function tt(e,t){return n=>{e&&e(n),n.defaultPrevented||t(n)}}function nt(e,t,n){if(n&&!at)return[e[0]];if(t){let n=e.findIndex((e=>void 0!==t[e.route.id]));return e.slice(0,n+1)}return e}function it(e){let{page:t}=e,n=o(e,p),{router:i}=Ze(),s=r.useMemo((()=>A(i.routes,t,i.basename)),[i.routes,t,i.basename]);return s?r.createElement(st,d({page:t,matches:s},n)):null}function rt(e){let{manifest:t,routeModules:n}=et(),[i,s]=r.useState([]);return r.useEffect((()=>{let i=!1;return async function(e,t,n){return Ge((await Promise.all(e.map((async e=>{let i=t.routes[e.route.id];if(i){let e=await je(i,n);return e.links?e.links():[]}return[]})))).flat(1).filter(Ve).filter((e=>"stylesheet"===e.rel||"preload"===e.rel)).map((e=>"stylesheet"===e.rel?d(d({},e),{},{rel:"prefetch",as:"style"}):d(d({},e),{},{rel:"prefetch"}))))}(e,t,n).then((e=>{i||s(e)})),()=>{i=!0}}),[e,t,n]),i}function st(e){let{page:t,matches:n}=e,i=o(e,f),s=ce(),{manifest:a,routeModules:l}=et(),{loaderData:u,matches:c}=Je(),h=r.useMemo((()=>He(t,n,c,a,s,"data")),[t,n,c,a,s]),p=r.useMemo((()=>He(t,n,c,a,s,"assets")),[t,n,c,a,s]),m=r.useMemo((()=>{if(t===s.pathname+s.search+s.hash)return[];let e=new Set,i=!1;if(n.forEach((t=>{var n;let r=a.routes[t.route.id];r&&r.hasLoader&&(!h.some((e=>e.route.id===t.route.id))&&t.route.id in u&&null!==(n=l[t.route.id])&&void 0!==n&&n.shouldRevalidate||r.hasClientLoader?i=!0:e.add(t.route.id))})),0===e.size)return[];let r=Ye(t);return i&&e.size>0&&r.searchParams.set("_routes",n.filter((t=>e.has(t.route.id))).map((e=>e.route.id)).join(",")),[r.pathname+r.search]}),[u,s,a,h,n,t,l]),g=r.useMemo((()=>function(e,t){return We(e.map((e=>{let n=t.routes[e.route.id];if(!n)return[];let i=[n.module];return n.imports&&(i=i.concat(n.imports)),i})).flat(1))}(p,a)),[p,a]),v=rt(p);return r.createElement(r.Fragment,null,m.map((e=>r.createElement("link",d({key:e,rel:"prefetch",as:"fetch",href:e},i)))),g.map((e=>r.createElement("link",d({key:e,rel:"modulepreload",href:e},i)))),v.map((e=>{let{key:t,link:n}=e;return r.createElement("link",d({key:t},n))})))}$e.displayName="FrameworkContext";var at=!1;function ot(e){let{manifest:t,serverHandoffString:n,isSpaMode:i,renderMeta:s}=et(),{router:a,static:o,staticContext:l}=Ze(),{matches:u}=Je(),c=Ke(i);s&&(s.didRenderScripts=!0);let h=nt(u,null,i);r.useEffect((()=>{0}),[]);let p=r.useMemo((()=>{var i;let s=l?"window.__reactRouterContext = ".concat(n,";").concat("window.__reactRouterContext.stream = new ReadableStream({start(controller){window.__reactRouterContext.streamController = controller;}}).pipeThrough(new TextEncoderStream());"):" ",u=o?"".concat(null!==t.hmr&&void 0!==i&&i.runtime?"import ".concat(JSON.stringify(t.hmr.runtime),";"):"").concat(c?"":"import ".concat(JSON.stringify(t.url)),";\n").concat(h.map(((e,n)=>"import * as route".concat(n," from ").concat(JSON.stringify(t.routes[e.route.id].module),";"))).join("\n"),"\n  ").concat(c?"window.__reactRouterManifest = ".concat(JSON.stringify(function(e,t){let n=new Set(t.state.matches.map((e=>e.route.id))),i=t.state.location.pathname.split("/").filter(Boolean),r=["/"];for(i.pop();i.length>0;)r.push("/".concat(i.join("/"))),i.pop();r.forEach((e=>{let i=A(t.routes,e,t.basename);i&&i.forEach((e=>n.add(e.route.id)))}));let s=[...n].reduce(((t,n)=>Object.assign(t,{[n]:e.routes[n]})),{});return d(d({},e),{},{routes:s})}(t,a),null,2),";"):"","\n  window.__reactRouterRouteModules = {").concat(h.map(((e,t)=>"".concat(JSON.stringify(e.route.id),":route").concat(t))).join(","),"};\n\nimport(").concat(JSON.stringify(t.entry.module),");"):" ";return r.createElement(r.Fragment,null,r.createElement("script",d(d({},e),{},{suppressHydrationWarning:!0,dangerouslySetInnerHTML:qe(s),type:void 0})),r.createElement("script",d(d({},e),{},{suppressHydrationWarning:!0,dangerouslySetInnerHTML:qe(u),type:"module",async:!0})))}),[]),f=h.map((e=>{let n=t.routes[e.route.id];return n?(n.imports||[]).concat([n.module]):[]})).flat(1),m=at?[]:t.entry.imports.concat(f);return at?null:r.createElement(r.Fragment,null,c?null:r.createElement("link",{rel:"modulepreload",href:t.url,crossOrigin:e.crossOrigin}),r.createElement("link",{rel:"modulepreload",href:t.entry.module,crossOrigin:e.crossOrigin}),[...new Set(g)].map((t=>r.createElement("link",{key:t,rel:"modulepreload",href:t,crossOrigin:e.crossOrigin}))),p);var g}function lt(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return e=>{t.forEach((t=>{"function"===typeof t?t(e):null!=t&&(t.current=e)}))}}var ut="undefined"!==typeof window&&"undefined"!==typeof window.document&&"undefined"!==typeof window.document.createElement;try{ut&&(window.__reactRouterVersion="7.1.5")}catch(Mn){}function ct(e){let{basename:t,children:n,window:i}=e,s=r.useRef();null==s.current&&(s.current=x({window:i,v5Compat:!0}));let a=s.current,[o,l]=r.useState({action:a.action,location:a.location}),u=r.useCallback((e=>{r.startTransition((()=>l(e)))}),[l]);return r.useLayoutEffect((()=>a.listen(u)),[a,u]),r.createElement(Te,{basename:t,children:n,location:o.location,navigationType:o.action,navigator:a})}var ht=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,dt=r.forwardRef((function(e,t){let n,{onClick:i,discover:s="render",prefetch:a="none",relative:l,reloadDocument:u,replace:c,state:h,target:p,to:f,preventScrollReset:g,viewTransition:v}=e,y=o(e,m),{basename:x}=r.useContext(se),D="string"===typeof f&&ht.test(f),_=!1;if("string"===typeof f&&D&&(n=f,ut))try{let e=new URL(window.location.href),t=f.startsWith("//")?new URL(e.protocol+f):new URL(f),n=V(t.pathname,x);t.origin===e.origin&&null!=n?f=n+t.search+t.hash:_=!0}catch(Mn){w(!1,'<Link to="'.concat(f,'"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.'))}let E=function(e){let{relative:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};b(ue(),"useHref() may be used only in the context of a <Router> component.");let{basename:n,navigator:i}=r.useContext(se),{hash:s,pathname:a,search:o}=fe(e,{relative:t}),l=a;return"/"!==n&&(l="/"===a?n:Y([n,a])),i.createHref({pathname:l,search:o,hash:s})}(f,{relative:l}),[C,A,M]=function(e,t){let n=r.useContext($e),[i,s]=r.useState(!1),[a,o]=r.useState(!1),{onFocus:l,onBlur:u,onMouseEnter:c,onMouseLeave:h,onTouchStart:d}=t,p=r.useRef(null);r.useEffect((()=>{if("render"===e&&o(!0),"viewport"===e){let e=new IntersectionObserver((e=>{e.forEach((e=>{o(e.isIntersecting)}))}),{threshold:.5});return p.current&&e.observe(p.current),()=>{e.disconnect()}}}),[e]),r.useEffect((()=>{if(i){let e=setTimeout((()=>{o(!0)}),100);return()=>{clearTimeout(e)}}}),[i]);let f=()=>{s(!0)},m=()=>{s(!1),o(!1)};return n?"intent"!==e?[a,p,{}]:[a,p,{onFocus:tt(l,f),onBlur:tt(u,m),onMouseEnter:tt(c,f),onMouseLeave:tt(h,m),onTouchStart:tt(d,f)}]:[!1,p,{}]}(a,y),T=function(e){let{target:t,replace:n,state:i,preventScrollReset:s,relative:a,viewTransition:o}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},l=pe(),u=ce(),c=fe(e,{relative:a});return r.useCallback((r=>{if(function(e,t){return 0===e.button&&(!t||"_self"===t)&&!function(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}(e)}(r,t)){r.preventDefault();let t=void 0!==n?n:S(u)===S(c);l(e,{replace:t,state:i,preventScrollReset:s,relative:a,viewTransition:o})}}),[u,l,c,n,i,t,e,s,a,o])}(f,{replace:c,state:h,target:p,preventScrollReset:g,relative:l,viewTransition:v});let P=r.createElement("a",d(d(d({},y),M),{},{href:n||E,onClick:_||u?i:function(e){i&&i(e),e.defaultPrevented||T(e)},ref:lt(t,A),target:p,"data-discover":D||"render"!==s?void 0:"true"}));return C&&!D?r.createElement(r.Fragment,null,P,r.createElement(it,{page:E})):P}));dt.displayName="Link";var pt=r.forwardRef((function(e,t){let{"aria-current":n="page",caseSensitive:i=!1,className:s="",end:a=!1,style:l,to:u,viewTransition:c,children:h}=e,p=o(e,g),f=fe(u,{relative:p.relative}),m=ce(),v=r.useContext(te),{navigator:y,basename:x}=r.useContext(se),w=null!=v&&function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=r.useContext(ne);b(null!=n,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:i}=gt("useViewTransitionState"),s=fe(e,{relative:t.relative});if(!n.isTransitioning)return!1;let a=V(n.currentLocation.pathname,i)||n.currentLocation.pathname,o=V(n.nextLocation.pathname,i)||n.nextLocation.pathname;return null!=j(s.pathname,o)||null!=j(s.pathname,a)}(f)&&!0===c,D=y.encodeLocation?y.encodeLocation(f).pathname:f.pathname,_=m.pathname,S=v&&v.navigation&&v.navigation.location?v.navigation.location.pathname:null;i||(_=_.toLowerCase(),S=S?S.toLowerCase():null,D=D.toLowerCase()),S&&x&&(S=V(S,x)||S);const E="/"!==D&&D.endsWith("/")?D.length-1:D.length;let C,A=_===D||!a&&_.startsWith(D)&&"/"===_.charAt(E),M=null!=S&&(S===D||!a&&S.startsWith(D)&&"/"===S.charAt(D.length)),T={isActive:A,isPending:M,isTransitioning:w},P=A?n:void 0;C="function"===typeof s?s(T):[s,A?"active":null,M?"pending":null,w?"transitioning":null].filter(Boolean).join(" ");let F="function"===typeof l?l(T):l;return r.createElement(dt,d(d({},p),{},{"aria-current":P,className:C,ref:t,style:F,to:u,viewTransition:c}),"function"===typeof h?h(T):h)}));pt.displayName="NavLink";var ft=r.forwardRef(((e,t)=>{let{discover:n="render",fetcherKey:i,navigate:s,reloadDocument:a,replace:l,state:u,method:c=Oe,action:h,onSubmit:p,relative:f,preventScrollReset:m,viewTransition:g}=e,y=o(e,v),x=xt(),w=function(e){let{relative:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{basename:n}=r.useContext(se),i=r.useContext(oe);b(i,"useFormAction must be used inside a RouteContext");let[s]=i.matches.slice(-1),a=d({},fe(e||".",{relative:t})),o=ce();if(null==e){a.search=o.search;let e=new URLSearchParams(a.search),t=e.getAll("index"),n=t.some((e=>""===e));if(n){e.delete("index"),t.filter((e=>e)).forEach((t=>e.append("index",t)));let n=e.toString();a.search=n?"?".concat(n):""}}e&&"."!==e||!s.route.index||(a.search=a.search?a.search.replace(/^\?/,"?index&"):"?index");"/"!==n&&(a.pathname="/"===a.pathname?n:Y([n,a.pathname]));return S(a)}(h,{relative:f}),D="get"===c.toLowerCase()?"get":"post",_="string"===typeof h&&ht.test(h);return r.createElement("form",d(d({ref:t,method:D,action:w,onSubmit:a?p:e=>{if(p&&p(e),e.defaultPrevented)return;e.preventDefault();let t=e.nativeEvent.submitter,n=(null===t||void 0===t?void 0:t.getAttribute("formmethod"))||c;x(t||e.currentTarget,{fetcherKey:i,method:n,navigate:s,replace:l,state:u,relative:f,preventScrollReset:m,viewTransition:g})}},y),{},{"data-discover":_||"render"!==n?void 0:"true"}))}));function mt(e){return"".concat(e," must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.")}function gt(e){let t=r.useContext(ee);return b(t,mt(e)),t}ft.displayName="Form";var vt=0,yt=()=>"__".concat(String(++vt),"__");function xt(){let{router:e}=gt("useSubmit"),{basename:t}=r.useContext(se),n=Se("useRouteId");return r.useCallback((async function(i){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{action:s,method:a,encType:o,formData:l,body:u}=ze(i,t);if(!1===r.navigate){let t=r.fetcherKey||yt();await e.fetch(t,n,r.action||s,{preventScrollReset:r.preventScrollReset,formData:l,body:u,formMethod:r.method||a,formEncType:r.encType||o,flushSync:r.flushSync})}else await e.navigate(r.action||s,{preventScrollReset:r.preventScrollReset,formData:l,body:u,formMethod:r.method||a,formEncType:r.encType||o,replace:r.replace,state:r.state,fromRouteId:n,flushSync:r.flushSync,viewTransition:r.viewTransition})}),[e,t,n])}new TextEncoder;function bt(e){var t;return"undefined"!==typeof window&&null!=window.navigator&&((null===(t=window.navigator.userAgentData)||void 0===t?void 0:t.brands.some((t=>e.test(t.brand))))||e.test(window.navigator.userAgent))}function wt(e){var t;return"undefined"!==typeof window&&null!=window.navigator&&e.test((null===(t=window.navigator.userAgentData)||void 0===t?void 0:t.platform)||window.navigator.platform)}function Dt(e){let t=null;return()=>(null==t&&(t=e()),t)}const _t=Dt((function(){return wt(/^Mac/i)})),St=Dt((function(){return wt(/^iPhone/i)})),Et=Dt((function(){return wt(/^iPad/i)||_t()&&navigator.maxTouchPoints>1})),Ct=Dt((function(){return St()||Et()})),At=(Dt((function(){return _t()||Ct()})),Dt((function(){return bt(/AppleWebKit/i)&&!At()})),Dt((function(){return bt(/Chrome/i)}))),Mt=Dt((function(){return bt(/Android/i)}));Dt((function(){return bt(/Firefox/i)}));const Tt=e=>{var t;return null!==(t=null===e||void 0===e?void 0:e.ownerDocument)&&void 0!==t?t:document},Pt=e=>{if(e&&"window"in e&&e.window===e)return e;return Tt(e).defaultView||window};let Ft=null,Ot=new Set,It=new Map,kt=!1,Bt=!1;const Rt={Tab:!0,Escape:!0};function Lt(e,t){for(let n of Ot)n(e,t)}function zt(e){kt=!0,function(e){return!(e.metaKey||!_t()&&e.altKey||e.ctrlKey||"Control"===e.key||"Shift"===e.key||"Meta"===e.key)}(e)&&(Ft="keyboard",Lt("keyboard",e))}function Nt(e){Ft="pointer","mousedown"!==e.type&&"pointerdown"!==e.type||(kt=!0,Lt("pointer",e))}function jt(e){var t;(0===(t=e).mozInputSource&&t.isTrusted||(Mt()&&t.pointerType?"click"===t.type&&1===t.buttons:0===t.detail&&!t.pointerType))&&(kt=!0,Ft="virtual")}function Ut(e){e.target!==window&&e.target!==document&&(kt||Bt||(Ft="virtual",Lt("virtual",e)),kt=!1,Bt=!1)}function Vt(){kt=!1,Bt=!0}function Ht(e){if("undefined"===typeof window||It.get(Pt(e)))return;const t=Pt(e),n=Tt(e);let i=t.HTMLElement.prototype.focus;t.HTMLElement.prototype.focus=function(){kt=!0,i.apply(this,arguments)},n.addEventListener("keydown",zt,!0),n.addEventListener("keyup",zt,!0),n.addEventListener("click",jt,!0),t.addEventListener("focus",Ut,!0),t.addEventListener("blur",Vt,!1),"undefined"!==typeof PointerEvent?(n.addEventListener("pointerdown",Nt,!0),n.addEventListener("pointermove",Nt,!0),n.addEventListener("pointerup",Nt,!0)):(n.addEventListener("mousedown",Nt,!0),n.addEventListener("mousemove",Nt,!0),n.addEventListener("mouseup",Nt,!0)),t.addEventListener("beforeunload",(()=>{Wt(e)}),{once:!0}),It.set(t,{focus:i})}const Wt=(e,t)=>{const n=Pt(e),i=Tt(e);t&&i.removeEventListener("DOMContentLoaded",t),It.has(n)&&(n.HTMLElement.prototype.focus=It.get(n).focus,i.removeEventListener("keydown",zt,!0),i.removeEventListener("keyup",zt,!0),i.removeEventListener("click",jt,!0),n.removeEventListener("focus",Ut,!0),n.removeEventListener("blur",Vt,!1),"undefined"!==typeof PointerEvent?(i.removeEventListener("pointerdown",Nt,!0),i.removeEventListener("pointermove",Nt,!0),i.removeEventListener("pointerup",Nt,!0)):(i.removeEventListener("mousedown",Nt,!0),i.removeEventListener("mousemove",Nt,!0),i.removeEventListener("mouseup",Nt,!0)),It.delete(n))};function Gt(){return"pointer"!==Ft}"undefined"!==typeof document&&function(e){const t=Tt(e);let n;"loading"!==t.readyState?Ht(e):(n=()=>{Ht(e)},t.addEventListener("DOMContentLoaded",n))}();const qt=new Set(["checkbox","radio","range","color","file","image","button","submit","reset"]);function Yt(e,t,n){Ht(),(0,r.useEffect)((()=>{let t=(t,i)=>{(function(e,t,n){var i;const r="undefined"!==typeof window?Pt(null===n||void 0===n?void 0:n.target).HTMLInputElement:HTMLInputElement,s="undefined"!==typeof window?Pt(null===n||void 0===n?void 0:n.target).HTMLTextAreaElement:HTMLTextAreaElement,a="undefined"!==typeof window?Pt(null===n||void 0===n?void 0:n.target).HTMLElement:HTMLElement,o="undefined"!==typeof window?Pt(null===n||void 0===n?void 0:n.target).KeyboardEvent:KeyboardEvent;return!((e=e||(null===n||void 0===n?void 0:n.target)instanceof r&&!qt.has(null===n||void 0===n||null===(i=n.target)||void 0===i?void 0:i.type)||(null===n||void 0===n?void 0:n.target)instanceof s||(null===n||void 0===n?void 0:n.target)instanceof a&&(null===n||void 0===n?void 0:n.target.isContentEditable))&&"keyboard"===t&&n instanceof o&&!Rt[n.key])})(!!(null===n||void 0===n?void 0:n.isTextInput),t,i)&&e(Gt())};return Ot.add(t),()=>{Ot.delete(t)}}),t)}const Xt="undefined"!==typeof document?r.useLayoutEffect:()=>{};function Qt(e){const t=(0,r.useRef)(null);return Xt((()=>{t.current=e}),[e]),(0,r.useCallback)((function(){const e=t.current;return null===e||void 0===e?void 0:e(...arguments)}),[])}class Kt{isDefaultPrevented(){return this.nativeEvent.defaultPrevented}preventDefault(){this.defaultPrevented=!0,this.nativeEvent.preventDefault()}stopPropagation(){this.nativeEvent.stopPropagation(),this.isPropagationStopped=()=>!0}isPropagationStopped(){return!1}persist(){}constructor(e,t){this.nativeEvent=t,this.target=t.target,this.currentTarget=t.currentTarget,this.relatedTarget=t.relatedTarget,this.bubbles=t.bubbles,this.cancelable=t.cancelable,this.defaultPrevented=t.defaultPrevented,this.eventPhase=t.eventPhase,this.isTrusted=t.isTrusted,this.timeStamp=t.timeStamp,this.type=e}}function Zt(e){let t=(0,r.useRef)({isFocused:!1,observer:null});Xt((()=>{const e=t.current;return()=>{e.observer&&(e.observer.disconnect(),e.observer=null)}}),[]);let n=Qt((t=>{null===e||void 0===e||e(t)}));return(0,r.useCallback)((e=>{if(e.target instanceof HTMLButtonElement||e.target instanceof HTMLInputElement||e.target instanceof HTMLTextAreaElement||e.target instanceof HTMLSelectElement){t.current.isFocused=!0;let i=e.target,r=e=>{t.current.isFocused=!1,i.disabled&&n(new Kt("blur",e)),t.current.observer&&(t.current.observer.disconnect(),t.current.observer=null)};i.addEventListener("focusout",r,{once:!0}),t.current.observer=new MutationObserver((()=>{if(t.current.isFocused&&i.disabled){var e;null===(e=t.current.observer)||void 0===e||e.disconnect();let n=i===document.activeElement?null:document.activeElement;i.dispatchEvent(new FocusEvent("blur",{relatedTarget:n})),i.dispatchEvent(new FocusEvent("focusout",{bubbles:!0,relatedTarget:n}))}})),t.current.observer.observe(i,{attributes:!0,attributeFilter:["disabled"]})}}),[n])}function Jt(e){let{isDisabled:t,onFocus:n,onBlur:i,onFocusChange:s}=e;const a=(0,r.useCallback)((e=>{if(e.target===e.currentTarget)return i&&i(e),s&&s(!1),!0}),[i,s]),o=Zt(a),l=(0,r.useCallback)((e=>{const t=Tt(e.target);e.target===e.currentTarget&&t.activeElement===e.target&&(n&&n(e),s&&s(!0),o(e))}),[s,n,o]);return{focusProps:{onFocus:!t&&(n||s||i)?l:void 0,onBlur:t||!i&&!s?void 0:a}}}function $t(e){let{isDisabled:t,onBlurWithin:n,onFocusWithin:i,onFocusWithinChange:s}=e,a=(0,r.useRef)({isFocusWithin:!1}),o=(0,r.useCallback)((e=>{a.current.isFocusWithin&&!e.currentTarget.contains(e.relatedTarget)&&(a.current.isFocusWithin=!1,n&&n(e),s&&s(!1))}),[n,s,a]),l=Zt(o),u=(0,r.useCallback)((e=>{a.current.isFocusWithin||document.activeElement!==e.target||(i&&i(e),s&&s(!0),a.current.isFocusWithin=!0,l(e))}),[i,s,l]);return t?{focusWithinProps:{onFocus:void 0,onBlur:void 0}}:{focusWithinProps:{onFocus:u,onBlur:o}}}function en(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{autoFocus:t=!1,isTextInput:n,within:i}=e,s=(0,r.useRef)({isFocused:!1,isFocusVisible:t||Gt()}),[a,o]=(0,r.useState)(!1),[l,u]=(0,r.useState)((()=>s.current.isFocused&&s.current.isFocusVisible)),c=(0,r.useCallback)((()=>u(s.current.isFocused&&s.current.isFocusVisible)),[]),h=(0,r.useCallback)((e=>{s.current.isFocused=e,o(e),c()}),[c]);Yt((e=>{s.current.isFocusVisible=e,c()}),[],{isTextInput:n});let{focusProps:d}=Jt({isDisabled:i,onFocusChange:h}),{focusWithinProps:p}=$t({isDisabled:!i,onFocusWithinChange:h});return{isFocused:a,isFocusVisible:l,focusProps:i?p:d}}let tn=!1,nn=0;function rn(){tn=!0,setTimeout((()=>{tn=!1}),50)}function sn(e){"touch"===e.pointerType&&rn()}function an(){if("undefined"!==typeof document)return"undefined"!==typeof PointerEvent?document.addEventListener("pointerup",sn):document.addEventListener("touchend",rn),nn++,()=>{nn--,nn>0||("undefined"!==typeof PointerEvent?document.removeEventListener("pointerup",sn):document.removeEventListener("touchend",rn))}}function on(e){let{onHoverStart:t,onHoverChange:n,onHoverEnd:i,isDisabled:s}=e,[a,o]=(0,r.useState)(!1),l=(0,r.useRef)({isHovered:!1,ignoreEmulatedMouseEvents:!1,pointerType:"",target:null}).current;(0,r.useEffect)(an,[]);let{hoverProps:u,triggerHoverEnd:c}=(0,r.useMemo)((()=>{let e=(e,i)=>{if(l.pointerType=i,s||"touch"===i||l.isHovered||!e.currentTarget.contains(e.target))return;l.isHovered=!0;let r=e.currentTarget;l.target=r,t&&t({type:"hoverstart",target:r,pointerType:i}),n&&n(!0),o(!0)},r=(e,t)=>{if(l.pointerType="",l.target=null,"touch"===t||!l.isHovered)return;l.isHovered=!1;let r=e.currentTarget;i&&i({type:"hoverend",target:r,pointerType:t}),n&&n(!1),o(!1)},a={};return"undefined"!==typeof PointerEvent?(a.onPointerEnter=t=>{tn&&"mouse"===t.pointerType||e(t,t.pointerType)},a.onPointerLeave=e=>{!s&&e.currentTarget.contains(e.target)&&r(e,e.pointerType)}):(a.onTouchStart=()=>{l.ignoreEmulatedMouseEvents=!0},a.onMouseEnter=t=>{l.ignoreEmulatedMouseEvents||tn||e(t,"mouse"),l.ignoreEmulatedMouseEvents=!1},a.onMouseLeave=e=>{!s&&e.currentTarget.contains(e.target)&&r(e,"mouse")}),{hoverProps:a,triggerHoverEnd:r}}),[t,n,i,s,l]);return(0,r.useEffect)((()=>{s&&c({currentTarget:l.target},l.pointerType)}),[s]),{hoverProps:u,isHovered:a}}var ln=Object.defineProperty,un=(e,t,n)=>(((e,t,n)=>{t in e?ln(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n})(e,"symbol"!=typeof t?t+"":t,n),n);let cn=new class{constructor(){un(this,"current",this.detect()),un(this,"handoffState","pending"),un(this,"currentId",0)}set(e){this.current!==e&&(this.handoffState="pending",this.currentId=0,this.current=e)}reset(){this.set(this.detect())}nextId(){return++this.currentId}get isServer(){return"server"===this.current}get isClient(){return"client"===this.current}detect(){return"undefined"==typeof window||"undefined"==typeof document?"server":"client"}handoff(){"pending"===this.handoffState&&(this.handoffState="complete")}get isHandoffComplete(){return"complete"===this.handoffState}};function hn(e){return cn.isServer?null:e instanceof Node?e.ownerDocument:null!=e&&e.hasOwnProperty("current")&&e.current instanceof Node?e.current.ownerDocument:document}function dn(e){"function"==typeof queueMicrotask?queueMicrotask(e):Promise.resolve().then(e).catch((e=>setTimeout((()=>{throw e}))))}function pn(){let e=[],t={addEventListener:(e,n,i,r)=>(e.addEventListener(n,i,r),t.add((()=>e.removeEventListener(n,i,r)))),requestAnimationFrame(){let e=requestAnimationFrame(...arguments);return t.add((()=>cancelAnimationFrame(e)))},nextFrame(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return t.requestAnimationFrame((()=>t.requestAnimationFrame(...n)))},setTimeout(){let e=setTimeout(...arguments);return t.add((()=>clearTimeout(e)))},microTask(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];let r={current:!0};return dn((()=>{r.current&&n[0]()})),t.add((()=>{r.current=!1}))},style(e,t,n){let i=e.style.getPropertyValue(t);return Object.assign(e.style,{[t]:n}),this.add((()=>{Object.assign(e.style,{[t]:i})}))},group(e){let t=pn();return e(t),this.add((()=>t.dispose()))},add:t=>(e.includes(t)||e.push(t),()=>{let n=e.indexOf(t);if(n>=0)for(let t of e.splice(n,1))t()}),dispose(){for(let t of e.splice(0))t()}};return t}function fn(){let[e]=(0,r.useState)(pn);return(0,r.useEffect)((()=>()=>e.dispose()),[e]),e}let mn=(e,t)=>{cn.isServer?(0,r.useEffect)(e,t):(0,r.useLayoutEffect)(e,t)};function gn(e){let t=(0,r.useRef)(e);return mn((()=>{t.current=e}),[e]),t}let vn=function(e){let t=gn(e);return r.useCallback((function(){return t.current(...arguments)}),[t])};function yn(){let{disabled:e=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(0,r.useRef)(null),[n,i]=(0,r.useState)(!1),s=fn(),a=vn((()=>{t.current=null,i(!1),s.dispose()})),o=vn((e=>{if(s.dispose(),null===t.current){t.current=e.currentTarget,i(!0);{let n=hn(e.currentTarget);s.addEventListener(n,"pointerup",a,!1),s.addEventListener(n,"pointermove",(e=>{if(t.current){let n=function(e){let t=e.width/2,n=e.height/2;return{top:e.clientY-n,right:e.clientX+t,bottom:e.clientY+n,left:e.clientX-t}}(e);i(function(e,t){return!(!e||!t||e.right<t.left||e.left>t.right||e.bottom<t.top||e.top>t.bottom)}(n,t.current.getBoundingClientRect()))}}),!1),s.addEventListener(n,"pointercancel",a,!1)}}}));return{pressed:n,pressProps:e?{}:{onPointerDown:o,onPointerUp:a,onClick:a}}}function xn(e,t){return(0,r.useMemo)((()=>{var n;if(e.type)return e.type;let i=null!=(n=e.as)?n:"button";return"string"==typeof i&&"button"===i.toLowerCase()||"BUTTON"===(null==t?void 0:t.tagName)&&!t.hasAttribute("type")?"button":void 0}),[e.type,e.as,t])}let bn=Symbol();function wn(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return Object.assign(e,{[bn]:t})}function Dn(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];let i=(0,r.useRef)(t);(0,r.useEffect)((()=>{i.current=t}),[t]);let s=vn((e=>{for(let t of i.current)null!=t&&("function"==typeof t?t(e):t.current=e)}));return t.every((e=>null==e||(null==e?void 0:e[bn])))?void 0:s}var _n,Sn;"undefined"!=typeof process&&"undefined"!=typeof globalThis&&"undefined"!=typeof Element&&"test"===(null==(_n=null==process?void 0:{NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_GEMINI_KEY:"AIzaSyBHSqIYcjAu1IfQfbT7W2-shVsu2vkwx1M"})?void 0:_n.NODE_ENV)&&"undefined"==typeof(null==(Sn=null==Element?void 0:Element.prototype)?void 0:Sn.getAnimations)&&(Element.prototype.getAnimations=function(){return console.warn(["Headless UI has polyfilled `Element.prototype.getAnimations` for your tests.","Please install a proper polyfill e.g. `jsdom-testing-mocks`, to silence these warnings.","","Example usage:","```js","import { mockAnimationsApi } from 'jsdom-testing-mocks'","mockAnimationsApi()","```"].join("\n")),[]});var En=(e=>(e[e.None=0]="None",e[e.Closed=1]="Closed",e[e.Enter=2]="Enter",e[e.Leave=4]="Leave",e))(En||{});function Cn(e){let t={};for(let n in e)!0===e[n]&&(t["data-".concat(n)]="");return t}function An(e,t,n,i){let[s,a]=(0,r.useState)(n),{hasFlag:o,addFlag:l,removeFlag:u}=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,[t,n]=(0,r.useState)(e),i=(0,r.useCallback)((e=>n(e)),[t]),s=(0,r.useCallback)((e=>n((t=>t|e))),[t]),a=(0,r.useCallback)((e=>(t&e)===e),[t]),o=(0,r.useCallback)((e=>n((t=>t&~e))),[n]),l=(0,r.useCallback)((e=>n((t=>t^e))),[n]);return{flags:t,setFlag:i,addFlag:s,hasFlag:a,removeFlag:o,toggleFlag:l}}(e&&s?3:0),c=(0,r.useRef)(!1),h=(0,r.useRef)(!1),d=fn();return mn((()=>{var r;if(e)return n&&a(!0),t?(null==(r=null==i?void 0:i.start)||r.call(i,n),function(e,t){let{prepare:n,run:i,done:r,inFlight:s}=t,a=pn();return function(e,t){let{inFlight:n,prepare:i}=t;if(null!=n&&n.current)return void i();let r=e.style.transition;e.style.transition="none",i(),e.offsetHeight,e.style.transition=r}(e,{prepare:n,inFlight:s}),a.nextFrame((()=>{i(),a.requestAnimationFrame((()=>{a.add(function(e,t){var n,i;let r=pn();if(!e)return r.dispose;let s=!1;r.add((()=>{s=!0}));let a=null!=(i=null==(n=e.getAnimations)?void 0:n.call(e).filter((e=>e instanceof CSSTransition)))?i:[];return 0===a.length?(t(),r.dispose):(Promise.allSettled(a.map((e=>e.finished))).then((()=>{s||t()})),r.dispose)}(e,r))}))})),a.dispose}(t,{inFlight:c,prepare(){h.current?h.current=!1:h.current=c.current,c.current=!0,!h.current&&(n?(l(3),u(4)):(l(4),u(2)))},run(){h.current?n?(u(3),l(4)):(u(4),l(3)):n?u(1):l(1)},done(){var e;h.current&&"function"==typeof t.getAnimations&&t.getAnimations().length>0||(c.current=!1,u(7),n||a(!1),null==(e=null==i?void 0:i.end)||e.call(i,n))}})):void(n&&l(3))}),[e,n,t,d]),e?[s,{closed:o(1),enter:o(2),leave:o(4),transition:o(2)||o(4)}]:[n,{closed:void 0,enter:void 0,leave:void 0,transition:void 0}]}let Mn=(0,r.createContext)((()=>{}));function Tn(e){let{value:t,children:n}=e;return r.createElement(Mn.Provider,{value:t},n)}let Pn=(0,r.createContext)(null);Pn.displayName="OpenClosedContext";var Fn=(e=>(e[e.Open=1]="Open",e[e.Closed=2]="Closed",e[e.Closing=4]="Closing",e[e.Opening=8]="Opening",e))(Fn||{});function On(){return(0,r.useContext)(Pn)}function In(e){let{value:t,children:n}=e;return r.createElement(Pn.Provider,{value:t},n)}function kn(e){let{children:t}=e;return r.createElement(Pn.Provider,{value:null},t)}function Bn(e){let t=e.parentElement,n=null;for(;t&&!(t instanceof HTMLFieldSetElement);)t instanceof HTMLLegendElement&&(n=t),t=t.parentElement;let i=""===(null==t?void 0:t.getAttribute("disabled"));return(!i||!function(e){if(!e)return!1;let t=e.previousElementSibling;for(;null!==t;){if(t instanceof HTMLLegendElement)return!1;t=t.previousElementSibling}return!0}(n))&&i}function Rn(e,t){if(e in t){let s=t[e];for(var n=arguments.length,i=new Array(n>2?n-2:0),r=2;r<n;r++)i[r-2]=arguments[r];return"function"==typeof s?s(...i):s}let s=new Error('Tried to handle "'.concat(e,'" but there is no handler defined. Only defined handlers are: ').concat(Object.keys(t).map((e=>'"'.concat(e,'"'))).join(", "),"."));throw Error.captureStackTrace&&Error.captureStackTrace(s,Rn),s}function Ln(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Array.from(new Set(t.flatMap((e=>"string"==typeof e?e.split(" "):[])))).filter(Boolean).join(" ")}const zn=["static"],Nn=["unmount"],jn=["as","children","refName"];var Un,Vn=(e=>(e[e.None=0]="None",e[e.RenderStrategy=1]="RenderStrategy",e[e.Static=2]="Static",e))(Vn||{}),Hn=(e=>(e[e.Unmount=0]="Unmount",e[e.Hidden=1]="Hidden",e))(Hn||{});function Wn(){let e=function(){let e=(0,r.useRef)([]),t=(0,r.useCallback)((t=>{for(let n of e.current)null!=n&&("function"==typeof n?n(t):n.current=t)}),[]);return function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];if(!i.every((e=>null==e)))return e.current=i,t}}();return(0,r.useCallback)((t=>function(e){let{ourProps:t,theirProps:n,slot:i,defaultTag:r,features:s,visible:a=!0,name:l,mergeRefs:u}=e;u=null!=u?u:qn;let c=Yn(n,t);if(a)return Gn(c,i,r,l,u);let h=null!=s?s:0;if(2&h){let{static:e=!1}=c,t=o(c,zn);if(e)return Gn(t,i,r,l,u)}if(1&h){let{unmount:e=!0}=c,t=o(c,Nn);return Rn(e?0:1,{0:()=>null,1:()=>Gn(d(d({},t),{},{hidden:!0,style:{display:"none"}}),i,r,l,u)})}return Gn(c,i,r,l,u)}(d({mergeRefs:e},t))),[e])}function Gn(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0,s=arguments.length>4?arguments[4]:void 0,a=Zn(e,["unmount","static"]),{as:l=n,children:u,refName:c="ref"}=a,h=o(a,jn),d=void 0!==e.ref?{[c]:e.ref}:{},p="function"==typeof u?u(t):u;"className"in h&&h.className&&"function"==typeof h.className&&(h.className=h.className(t)),h["aria-labelledby"]&&h["aria-labelledby"]===h.id&&(h["aria-labelledby"]=void 0);let f={};if(t){let e=!1,n=[];for(let[i,r]of Object.entries(t))"boolean"==typeof r&&(e=!0),!0===r&&n.push(i.replace(/([A-Z])/g,(e=>"-".concat(e.toLowerCase()))));if(e){f["data-headlessui-state"]=n.join(" ");for(let e of n)f["data-".concat(e)]=""}}if(l===r.Fragment&&(Object.keys(Kn(h)).length>0||Object.keys(Kn(f)).length>0)){if((0,r.isValidElement)(p)&&!(Array.isArray(p)&&p.length>1)){let e=p.props,t=null==e?void 0:e.className,n="function"==typeof t?function(){return Ln(t(...arguments),h.className)}:Ln(t,h.className),i=n?{className:n}:{},a=Yn(p.props,Kn(Zn(h,["ref"])));for(let r in f)r in a&&delete f[r];return(0,r.cloneElement)(p,Object.assign({},a,f,d,{ref:s(Jn(p),d.ref)},i))}if(Object.keys(Kn(h)).length>0)throw new Error(['Passing props on "Fragment"!',"","The current component <".concat(i,' /> is rendering a "Fragment".'),"However we need to passthrough the following props:",Object.keys(Kn(h)).concat(Object.keys(Kn(f))).map((e=>"  - ".concat(e))).join("\n"),"","You can apply a few solutions:",['Add an `as="..."` prop, to ensure that we render an actual element instead of a "Fragment".',"Render a single element as the child so that we can forward the props onto that element."].map((e=>"  - ".concat(e))).join("\n")].join("\n"))}return(0,r.createElement)(l,Object.assign({},Zn(h,["ref"]),l!==r.Fragment&&d,l!==r.Fragment&&f),p)}function qn(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.every((e=>null==e))?void 0:e=>{for(let n of t)null!=n&&("function"==typeof n?n(e):n.current=e)}}function Yn(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if(0===t.length)return{};if(1===t.length)return t[0];let i={},r={};for(let s of t)for(let e in s)e.startsWith("on")&&"function"==typeof s[e]?(null!=r[e]||(r[e]=[]),r[e].push(s[e])):i[e]=s[e];if(i.disabled||i["aria-disabled"])for(let s in r)/^(on(?:Click|Pointer|Mouse|Key)(?:Down|Up|Press)?)$/.test(s)&&(r[s]=[e=>{var t;return null==(t=null==e?void 0:e.preventDefault)?void 0:t.call(e)}]);for(let s in r)Object.assign(i,{[s](e){let t=r[s];for(var n=arguments.length,i=new Array(n>1?n-1:0),a=1;a<n;a++)i[a-1]=arguments[a];for(let r of t){if((e instanceof Event||(null==e?void 0:e.nativeEvent)instanceof Event)&&e.defaultPrevented)return;r(e,...i)}}});return i}function Xn(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if(0===t.length)return{};if(1===t.length)return t[0];let i={},r={};for(let s of t)for(let e in s)e.startsWith("on")&&"function"==typeof s[e]?(null!=r[e]||(r[e]=[]),r[e].push(s[e])):i[e]=s[e];for(let s in r)Object.assign(i,{[s](){let e=r[s];for(let t of e)null==t||t(...arguments)}});return i}function Qn(e){var t;return Object.assign((0,r.forwardRef)(e),{displayName:null!=(t=e.displayName)?t:e.name})}function Kn(e){let t=Object.assign({},e);for(let n in t)void 0===t[n]&&delete t[n];return t}function Zn(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=Object.assign({},e);for(let i of t)i in n&&delete n[i];return n}function Jn(e){return r.version.split(".")[0]>="19"?e.props.ref:e.ref}let $n=null!=(Un=r.startTransition)?Un:function(e){e()};var ei=(e=>(e.Space=" ",e.Enter="Enter",e.Escape="Escape",e.Backspace="Backspace",e.Delete="Delete",e.ArrowLeft="ArrowLeft",e.ArrowUp="ArrowUp",e.ArrowRight="ArrowRight",e.ArrowDown="ArrowDown",e.Home="Home",e.End="End",e.PageUp="PageUp",e.PageDown="PageDown",e.Tab="Tab",e))(ei||{});const ti=["defaultOpen"],ni=["id","disabled","autoFocus"],ii=["id","transition"];var ri=(e=>(e[e.Open=0]="Open",e[e.Closed=1]="Closed",e))(ri||{}),si=(e=>(e[e.ToggleDisclosure=0]="ToggleDisclosure",e[e.CloseDisclosure=1]="CloseDisclosure",e[e.SetButtonId=2]="SetButtonId",e[e.SetPanelId=3]="SetPanelId",e[e.SetButtonElement=4]="SetButtonElement",e[e.SetPanelElement=5]="SetPanelElement",e))(si||{});let ai={0:e=>d(d({},e),{},{disclosureState:Rn(e.disclosureState,{0:1,1:0})}),1:e=>1===e.disclosureState?e:d(d({},e),{},{disclosureState:1}),2:(e,t)=>e.buttonId===t.buttonId?e:d(d({},e),{},{buttonId:t.buttonId}),3:(e,t)=>e.panelId===t.panelId?e:d(d({},e),{},{panelId:t.panelId}),4:(e,t)=>e.buttonElement===t.element?e:d(d({},e),{},{buttonElement:t.element}),5:(e,t)=>e.panelElement===t.element?e:d(d({},e),{},{panelElement:t.element})},oi=(0,r.createContext)(null);function li(e){let t=(0,r.useContext)(oi);if(null===t){let t=new Error("<".concat(e," /> is missing a parent <Disclosure /> component."));throw Error.captureStackTrace&&Error.captureStackTrace(t,li),t}return t}oi.displayName="DisclosureContext";let ui=(0,r.createContext)(null);function ci(e){let t=(0,r.useContext)(ui);if(null===t){let t=new Error("<".concat(e," /> is missing a parent <Disclosure /> component."));throw Error.captureStackTrace&&Error.captureStackTrace(t,ci),t}return t}ui.displayName="DisclosureAPIContext";let hi=(0,r.createContext)(null);function di(e,t){return Rn(t.type,ai,e,t)}hi.displayName="DisclosurePanelContext";let pi=r.Fragment;let fi=Vn.RenderStrategy|Vn.Static;let mi=Qn((function(e,t){let{defaultOpen:n=!1}=e,i=o(e,ti),s=(0,r.useRef)(null),a=Dn(t,wn((e=>{s.current=e}),void 0===e.as||e.as===r.Fragment)),l=(0,r.useReducer)(di,{disclosureState:n?0:1,buttonElement:null,panelElement:null,buttonId:null,panelId:null}),[{disclosureState:u,buttonId:c},h]=l,d=vn((e=>{h({type:1});let t=hn(s);if(!t||!c)return;let n=e?e instanceof HTMLElement?e:e.current instanceof HTMLElement?e.current:t.getElementById(c):t.getElementById(c);null==n||n.focus()})),p=(0,r.useMemo)((()=>({close:d})),[d]),f=(0,r.useMemo)((()=>({open:0===u,close:d})),[u,d]),m={ref:a},g=Wn();return r.createElement(oi.Provider,{value:l},r.createElement(ui.Provider,{value:p},r.createElement(Tn,{value:d},r.createElement(In,{value:Rn(u,{0:Fn.Open,1:Fn.Closed})},g({ourProps:m,theirProps:i,slot:f,defaultTag:pi,name:"Disclosure"})))))})),gi=Qn((function(e,t){let n=(0,r.useId)(),{id:i="headlessui-disclosure-button-".concat(n),disabled:s=!1,autoFocus:a=!1}=e,l=o(e,ni),[u,c]=li("Disclosure.Button"),h=(0,r.useContext)(hi),d=null!==h&&h===u.panelId,p=Dn((0,r.useRef)(null),t,vn((e=>{if(!d)return c({type:4,element:e})})));(0,r.useEffect)((()=>{if(!d)return c({type:2,buttonId:i}),()=>{c({type:2,buttonId:null})}}),[i,c,d]);let f=vn((e=>{var t;if(d){if(1===u.disclosureState)return;switch(e.key){case ei.Space:case ei.Enter:e.preventDefault(),e.stopPropagation(),c({type:0}),null==(t=u.buttonElement)||t.focus()}}else switch(e.key){case ei.Space:case ei.Enter:e.preventDefault(),e.stopPropagation(),c({type:0})}})),m=vn((e=>{if(e.key===ei.Space)e.preventDefault()})),g=vn((e=>{var t;Bn(e.currentTarget)||s||(d?(c({type:0}),null==(t=u.buttonElement)||t.focus()):c({type:0}))})),{isFocusVisible:v,focusProps:y}=en({autoFocus:a}),{isHovered:x,hoverProps:b}=on({isDisabled:s}),{pressed:w,pressProps:D}=yn({disabled:s}),_=(0,r.useMemo)((()=>({open:0===u.disclosureState,hover:x,active:w,disabled:s,focus:v,autofocus:a})),[u,x,w,v,s,a]),S=xn(e,u.buttonElement),E=Xn(d?{ref:p,type:S,disabled:s||void 0,autoFocus:a,onKeyDown:f,onClick:g}:{ref:p,id:i,type:S,"aria-expanded":0===u.disclosureState,"aria-controls":u.panelElement?u.panelId:void 0,disabled:s||void 0,autoFocus:a,onKeyDown:f,onKeyUp:m,onClick:g},y,b,D);return Wn()({ourProps:E,theirProps:l,slot:_,defaultTag:"button",name:"Disclosure.Button"})})),vi=Qn((function(e,t){let n=(0,r.useId)(),{id:i="headlessui-disclosure-panel-".concat(n),transition:s=!1}=e,a=o(e,ii),[l,u]=li("Disclosure.Panel"),{close:c}=ci("Disclosure.Panel"),[h,p]=(0,r.useState)(null),f=Dn(t,vn((e=>{$n((()=>u({type:5,element:e})))})),p);(0,r.useEffect)((()=>(u({type:3,panelId:i}),()=>{u({type:3,panelId:null})})),[i,u]);let m=On(),[g,v]=An(s,h,null!==m?(m&Fn.Open)===Fn.Open:0===l.disclosureState),y=(0,r.useMemo)((()=>({open:0===l.disclosureState,close:c})),[l.disclosureState,c]),x=d({ref:f,id:i},Cn(v)),b=Wn();return r.createElement(kn,null,r.createElement(hi.Provider,{value:l.panelId},b({ourProps:x,theirProps:a,slot:y,defaultTag:"div",features:fi,visible:g,name:"Disclosure.Panel"})))})),yi=Object.assign(mi,{Button:gi,Panel:vi});var xi=n(950);function bi(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],[n,i]=(0,r.useReducer)((()=>({})),{}),s=(0,r.useMemo)((()=>function(e){if(null===e)return{width:0,height:0};let{width:t,height:n}=e.getBoundingClientRect();return{width:t,height:n}}(e)),[e,n]);return mn((()=>{if(!e)return;let t=new ResizeObserver(i);return t.observe(e),()=>{t.disconnect()}}),[e]),t?{width:"".concat(s.width,"px"),height:"".concat(s.height,"px")}:s}class wi extends Map{constructor(e){super(),this.factory=e}get(e){let t=super.get(e);return void 0===t&&(t=this.factory(e),this.set(e,t)),t}}function Di(e,t){let n=e(),i=new Set;return{getSnapshot:()=>n,subscribe:e=>(i.add(e),()=>i.delete(e)),dispatch(e){for(var r=arguments.length,s=new Array(r>1?r-1:0),a=1;a<r;a++)s[a-1]=arguments[a];let o=t[e].call(n,...s);o&&(n=o,i.forEach((e=>e())))}}}function _i(e){return(0,r.useSyncExternalStore)(e.subscribe,e.getSnapshot,e.getSnapshot)}let Si=new wi((()=>Di((()=>[]),{ADD(e){return this.includes(e)?this:[...this,e]},REMOVE(e){let t=this.indexOf(e);if(-1===t)return this;let n=this.slice();return n.splice(t,1),n}})));function Ei(e,t){let n=Si.get(t),i=(0,r.useId)(),s=_i(n);if(mn((()=>{if(e)return n.dispatch("ADD",i),()=>n.dispatch("REMOVE",i)}),[n,e]),!e)return!1;let a=s.indexOf(i),o=s.length;return-1===a&&(a=o,o+=1),a===o-1}let Ci=new Map,Ai=new Map;function Mi(e){var t;let n=null!=(t=Ai.get(e))?t:0;return Ai.set(e,n+1),0!==n||(Ci.set(e,{"aria-hidden":e.getAttribute("aria-hidden"),inert:e.inert}),e.setAttribute("aria-hidden","true"),e.inert=!0),()=>Ti(e)}function Ti(e){var t;let n=null!=(t=Ai.get(e))?t:1;if(1===n?Ai.delete(e):Ai.set(e,n-1),1!==n)return;let i=Ci.get(e);i&&(null===i["aria-hidden"]?e.removeAttribute("aria-hidden"):e.setAttribute("aria-hidden",i["aria-hidden"]),e.inert=i.inert,Ci.delete(e))}let Pi=["[contentEditable=true]","[tabindex]","a[href]","area[href]","button:not([disabled])","iframe","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].map((e=>"".concat(e,":not([tabindex='-1'])"))).join(","),Fi=["[data-autofocus]"].map((e=>"".concat(e,":not([tabindex='-1'])"))).join(",");var Oi=(e=>(e[e.First=1]="First",e[e.Previous=2]="Previous",e[e.Next=4]="Next",e[e.Last=8]="Last",e[e.WrapAround=16]="WrapAround",e[e.NoScroll=32]="NoScroll",e[e.AutoFocus=64]="AutoFocus",e))(Oi||{}),Ii=(e=>(e[e.Error=0]="Error",e[e.Overflow=1]="Overflow",e[e.Success=2]="Success",e[e.Underflow=3]="Underflow",e))(Ii||{}),ki=(e=>(e[e.Previous=-1]="Previous",e[e.Next=1]="Next",e))(ki||{});function Bi(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document.body;return null==e?[]:Array.from(e.querySelectorAll(Pi)).sort(((e,t)=>Math.sign((e.tabIndex||Number.MAX_SAFE_INTEGER)-(t.tabIndex||Number.MAX_SAFE_INTEGER))))}var Ri=(e=>(e[e.Strict=0]="Strict",e[e.Loose=1]="Loose",e))(Ri||{});function Li(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;var n;return e!==(null==(n=hn(e))?void 0:n.body)&&Rn(t,{0:()=>e.matches(Pi),1(){let t=e;for(;null!==t;){if(t.matches(Pi))return!0;t=t.parentElement}return!1}})}function zi(e){let t=hn(e);pn().nextFrame((()=>{t&&!Li(t.activeElement,0)&&function(e){null==e||e.focus({preventScroll:!0})}(e)}))}var Ni=(e=>(e[e.Keyboard=0]="Keyboard",e[e.Mouse=1]="Mouse",e))(Ni||{});"undefined"!=typeof window&&"undefined"!=typeof document&&(document.addEventListener("keydown",(e=>{e.metaKey||e.altKey||e.ctrlKey||(document.documentElement.dataset.headlessuiFocusVisible="")}),!0),document.addEventListener("click",(e=>{1===e.detail?delete document.documentElement.dataset.headlessuiFocusVisible:0===e.detail&&(document.documentElement.dataset.headlessuiFocusVisible="")}),!0));let ji=["textarea","input"].join(",");function Ui(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e=>e;return e.slice().sort(((e,n)=>{let i=t(e),r=t(n);if(null===i||null===r)return 0;let s=i.compareDocumentPosition(r);return s&Node.DOCUMENT_POSITION_FOLLOWING?-1:s&Node.DOCUMENT_POSITION_PRECEDING?1:0}))}function Vi(e,t){return function(e,t){let{sorted:n=!0,relativeTo:i=null,skipElements:r=[]}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},s=Array.isArray(e)?e.length>0?e[0].ownerDocument:document:e.ownerDocument,a=Array.isArray(e)?n?Ui(e):e:64&t?function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document.body;return null==e?[]:Array.from(e.querySelectorAll(Fi)).sort(((e,t)=>Math.sign((e.tabIndex||Number.MAX_SAFE_INTEGER)-(t.tabIndex||Number.MAX_SAFE_INTEGER))))}(e):Bi(e);r.length>0&&a.length>1&&(a=a.filter((e=>!r.some((t=>null!=t&&"current"in t?(null==t?void 0:t.current)===e:t===e))))),i=null!=i?i:s.activeElement;let o,l=(()=>{if(5&t)return 1;if(10&t)return-1;throw new Error("Missing Focus.First, Focus.Previous, Focus.Next or Focus.Last")})(),u=(()=>{if(1&t)return 0;if(2&t)return Math.max(0,a.indexOf(i))-1;if(4&t)return Math.max(0,a.indexOf(i))+1;if(8&t)return a.length-1;throw new Error("Missing Focus.First, Focus.Previous, Focus.Next or Focus.Last")})(),c=32&t?{preventScroll:!0}:{},h=0,d=a.length;do{if(h>=d||h+d<=0)return 0;let e=u+h;if(16&t)e=(e+d)%d;else{if(e<0)return 3;if(e>=d)return 1}o=a[e],null==o||o.focus(c),h+=l}while(o!==s.activeElement);return 6&t&&function(e){var t,n;return null!=(n=null==(t=null==e?void 0:e.matches)?void 0:t.call(e,ji))&&n}(o)&&o.select(),2}(Bi(),t,{relativeTo:e})}function Hi(){return/iPhone/gi.test(window.navigator.platform)||/Mac/gi.test(window.navigator.platform)&&window.navigator.maxTouchPoints>0}function Wi(){return Hi()||/Android/gi.test(window.navigator.userAgent)}function Gi(e,t,n,i){let s=gn(n);(0,r.useEffect)((()=>{if(e)return document.addEventListener(t,n,i),()=>document.removeEventListener(t,n,i);function n(e){s.current(e)}}),[e,t,i])}function qi(e,t,n){let i=Ei(e,"outside-click"),s=gn(n),a=(0,r.useCallback)((function(e,n){if(e.defaultPrevented)return;let i=n(e);if(null===i||!i.getRootNode().contains(i)||!i.isConnected)return;let r=function e(t){return"function"==typeof t?e(t()):Array.isArray(t)||t instanceof Set?t:[t]}(t);for(let t of r)if(null!==t&&(t.contains(i)||e.composed&&e.composedPath().includes(t)))return;return!Li(i,Ri.Loose)&&-1!==i.tabIndex&&e.preventDefault(),s.current(e,i)}),[s,t]),o=(0,r.useRef)(null);Gi(i,"pointerdown",(e=>{var t,n;o.current=(null==(n=null==(t=e.composedPath)?void 0:t.call(e))?void 0:n[0])||e.target}),!0),Gi(i,"mousedown",(e=>{var t,n;o.current=(null==(n=null==(t=e.composedPath)?void 0:t.call(e))?void 0:n[0])||e.target}),!0),Gi(i,"click",(e=>{Wi()||o.current&&(a(e,(()=>o.current)),o.current=null)}),!0);let l=(0,r.useRef)({x:0,y:0});Gi(i,"touchstart",(e=>{l.current.x=e.touches[0].clientX,l.current.y=e.touches[0].clientY}),!0),Gi(i,"touchend",(e=>{let t=e.changedTouches[0].clientX,n=e.changedTouches[0].clientY;if(!(Math.abs(t-l.current.x)>=30||Math.abs(n-l.current.y)>=30))return a(e,(()=>e.target instanceof HTMLElement?e.target:null))}),!0),function(e,t,n,i){let s=gn(n);(0,r.useEffect)((()=>{if(e)return window.addEventListener(t,n,i),()=>window.removeEventListener(t,n,i);function n(e){s.current(e)}}),[e,t,i])}(i,"blur",(e=>a(e,(()=>window.document.activeElement instanceof HTMLIFrameElement?window.document.activeElement:null))),!0)}function Yi(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return(0,r.useMemo)((()=>hn(...t)),[...t])}function Xi(){let e;return{before(t){let{doc:n}=t;var i;let r=n.documentElement,s=null!=(i=n.defaultView)?i:window;e=Math.max(0,s.innerWidth-r.clientWidth)},after(t){let{doc:n,d:i}=t,r=n.documentElement,s=Math.max(0,r.clientWidth-r.offsetWidth),a=Math.max(0,e-s);i.style(r,"paddingRight","".concat(a,"px"))}}}function Qi(e){let t={};for(let n of e)Object.assign(t,n(t));return t}let Ki=Di((()=>new Map),{PUSH(e,t){var n;let i=null!=(n=this.get(e))?n:{doc:e,count:0,d:pn(),meta:new Set};return i.count++,i.meta.add(t),this.set(e,i),this},POP(e,t){let n=this.get(e);return n&&(n.count--,n.meta.delete(t)),this},SCROLL_PREVENT(e){let{doc:t,d:n,meta:i}=e,r={doc:t,d:n,meta:Qi(i)},s=[Hi()?{before(e){let{doc:t,d:n,meta:i}=e;function r(e){return i.containers.flatMap((e=>e())).some((t=>t.contains(e)))}n.microTask((()=>{var e;if("auto"!==window.getComputedStyle(t.documentElement).scrollBehavior){let e=pn();e.style(t.documentElement,"scrollBehavior","auto"),n.add((()=>n.microTask((()=>e.dispose()))))}let i=null!=(e=window.scrollY)?e:window.pageYOffset,s=null;n.addEventListener(t,"click",(e=>{if(e.target instanceof HTMLElement)try{let n=e.target.closest("a");if(!n)return;let{hash:i}=new URL(n.href),a=t.querySelector(i);a&&!r(a)&&(s=a)}catch(n){}}),!0),n.addEventListener(t,"touchstart",(e=>{if(e.target instanceof HTMLElement)if(r(e.target)){let t=e.target;for(;t.parentElement&&r(t.parentElement);)t=t.parentElement;n.style(t,"overscrollBehavior","contain")}else n.style(e.target,"touchAction","none")})),n.addEventListener(t,"touchmove",(e=>{if(e.target instanceof HTMLElement){if("INPUT"===e.target.tagName)return;if(r(e.target)){let t=e.target;for(;t.parentElement&&""!==t.dataset.headlessuiPortal&&!(t.scrollHeight>t.clientHeight||t.scrollWidth>t.clientWidth);)t=t.parentElement;""===t.dataset.headlessuiPortal&&e.preventDefault()}else e.preventDefault()}}),{passive:!1}),n.add((()=>{var e;let t=null!=(e=window.scrollY)?e:window.pageYOffset;i!==t&&window.scrollTo(0,i),s&&s.isConnected&&(s.scrollIntoView({block:"nearest"}),s=null)}))}))}}:{},Xi(),{before(e){let{doc:t,d:n}=e;n.style(t.documentElement,"overflow","hidden")}}];s.forEach((e=>{let{before:t}=e;return null==t?void 0:t(r)})),s.forEach((e=>{let{after:t}=e;return null==t?void 0:t(r)}))},SCROLL_ALLOW(e){let{d:t}=e;t.dispose()},TEARDOWN(e){let{doc:t}=e;this.delete(t)}});function Zi(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:()=>[document.body];!function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:()=>({containers:[]}),i=_i(Ki),r=t?i.get(t):void 0,s=!!r&&r.count>0;mn((()=>{if(t&&e)return Ki.dispatch("PUSH",t,n),()=>Ki.dispatch("POP",t,n)}),[e,t])}(Ei(e,"scroll-lock"),t,(e=>{var t;return{containers:[...null!=(t=e.containers)?t:[],n]}}))}Ki.subscribe((()=>{let e=Ki.getSnapshot(),t=new Map;for(let[n]of e)t.set(n,n.documentElement.style.overflow);for(let n of e.values()){let e="hidden"===t.get(n.doc),i=0!==n.count;(i&&!e||!i&&e)&&Ki.dispatch(n.count>0?"SCROLL_PREVENT":"SCROLL_ALLOW",n),0===n.count&&Ki.dispatch("TEARDOWN",n)}}));let Ji=/([\u2700-\u27BF]|[\uE000-\uF8FF]|\uD83C[\uDC00-\uDFFF]|\uD83D[\uDC00-\uDFFF]|[\u2011-\u26FF]|\uD83E[\uDD10-\uDDFF])/g;function $i(e){var t,n;let i=null!=(t=e.innerText)?t:"",r=e.cloneNode(!0);if(!(r instanceof HTMLElement))return i;let s=!1;for(let o of r.querySelectorAll('[hidden],[aria-hidden],[role="img"]'))o.remove(),s=!0;let a=s?null!=(n=r.innerText)?n:"":i;return Ji.test(a)&&(a=a.replace(Ji,"")),a}function er(e){let t=(0,r.useRef)(""),n=(0,r.useRef)("");return vn((()=>{let i=e.current;if(!i)return"";let r=i.innerText;if(t.current===r)return n.current;let s=function(e){let t=e.getAttribute("aria-label");if("string"==typeof t)return t.trim();let n=e.getAttribute("aria-labelledby");if(n){let e=n.split(" ").map((e=>{let t=document.getElementById(e);if(t){let e=t.getAttribute("aria-label");return"string"==typeof e?e.trim():$i(t).trim()}return null})).filter(Boolean);if(e.length>0)return e.join(", ")}return $i(e).trim()}(i).trim().toLowerCase();return t.current=r,n.current=s,s}))}function tr(e){return[e.screenX,e.screenY]}function nr(){const e=navigator.userAgentData;return e&&Array.isArray(e.brands)?e.brands.map((e=>{let{brand:t,version:n}=e;return t+"/"+n})).join(" "):navigator.userAgent}const ir=Math.min,rr=Math.max,sr=Math.round,ar=Math.floor,or=e=>({x:e,y:e}),lr={left:"right",right:"left",bottom:"top",top:"bottom"},ur={start:"end",end:"start"};function cr(e,t,n){return rr(e,ir(t,n))}function hr(e,t){return"function"===typeof e?e(t):e}function dr(e){return e.split("-")[0]}function pr(e){return e.split("-")[1]}function fr(e){return"x"===e?"y":"x"}function mr(e){return"y"===e?"height":"width"}function gr(e){return["top","bottom"].includes(dr(e))?"y":"x"}function vr(e){return fr(gr(e))}function yr(e){return e.replace(/start|end/g,(e=>ur[e]))}function xr(e){return e.replace(/left|right|bottom|top/g,(e=>lr[e]))}function br(e){return"number"!==typeof e?function(e){return d({top:0,right:0,bottom:0,left:0},e)}(e):{top:e,right:e,bottom:e,left:e}}function wr(e){const{x:t,y:n,width:i,height:r}=e;return{width:i,height:r,top:n,left:t,right:t+i,bottom:n+r,x:t,y:n}}function Dr(){return"undefined"!==typeof window}function _r(e){return Cr(e)?(e.nodeName||"").toLowerCase():"#document"}function Sr(e){var t;return(null==e||null==(t=e.ownerDocument)?void 0:t.defaultView)||window}function Er(e){var t;return null==(t=(Cr(e)?e.ownerDocument:e.document)||window.document)?void 0:t.documentElement}function Cr(e){return!!Dr()&&(e instanceof Node||e instanceof Sr(e).Node)}function Ar(e){return!!Dr()&&(e instanceof Element||e instanceof Sr(e).Element)}function Mr(e){return!!Dr()&&(e instanceof HTMLElement||e instanceof Sr(e).HTMLElement)}function Tr(e){return!(!Dr()||"undefined"===typeof ShadowRoot)&&(e instanceof ShadowRoot||e instanceof Sr(e).ShadowRoot)}function Pr(e){const{overflow:t,overflowX:n,overflowY:i,display:r}=Rr(e);return/auto|scroll|overlay|hidden|clip/.test(t+i+n)&&!["inline","contents"].includes(r)}function Fr(e){return["table","td","th"].includes(_r(e))}function Or(e){return[":popover-open",":modal"].some((t=>{try{return e.matches(t)}catch(Mn){return!1}}))}function Ir(e){const t=kr(),n=Ar(e)?Rr(e):e;return["transform","translate","scale","rotate","perspective"].some((e=>!!n[e]&&"none"!==n[e]))||!!n.containerType&&"normal"!==n.containerType||!t&&!!n.backdropFilter&&"none"!==n.backdropFilter||!t&&!!n.filter&&"none"!==n.filter||["transform","translate","scale","rotate","perspective","filter"].some((e=>(n.willChange||"").includes(e)))||["paint","layout","strict","content"].some((e=>(n.contain||"").includes(e)))}function kr(){return!("undefined"===typeof CSS||!CSS.supports)&&CSS.supports("-webkit-backdrop-filter","none")}function Br(e){return["html","body","#document"].includes(_r(e))}function Rr(e){return Sr(e).getComputedStyle(e)}function Lr(e){return Ar(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.scrollX,scrollTop:e.scrollY}}function zr(e){if("html"===_r(e))return e;const t=e.assignedSlot||e.parentNode||Tr(e)&&e.host||Er(e);return Tr(t)?t.host:t}function Nr(e){const t=zr(e);return Br(t)?e.ownerDocument?e.ownerDocument.body:e.body:Mr(t)&&Pr(t)?t:Nr(t)}function jr(e,t,n){var i;void 0===t&&(t=[]),void 0===n&&(n=!0);const r=Nr(e),s=r===(null==(i=e.ownerDocument)?void 0:i.body),a=Sr(r);if(s){const e=Ur(a);return t.concat(a,a.visualViewport||[],Pr(r)?r:[],e&&n?jr(e):[])}return t.concat(r,jr(r,[],n))}function Ur(e){return e.parent&&Object.getPrototypeOf(e.parent)?e.frameElement:null}const Vr=["mainAxis","crossAxis","fallbackPlacements","fallbackStrategy","fallbackAxisSideDirection","flipAlignment"],Hr=["mainAxis","crossAxis","limiter"],Wr=["apply"];function Gr(e,t,n){let{reference:i,floating:r}=e;const s=gr(t),a=vr(t),o=mr(a),l=dr(t),u="y"===s,c=i.x+i.width/2-r.width/2,h=i.y+i.height/2-r.height/2,d=i[o]/2-r[o]/2;let p;switch(l){case"top":p={x:c,y:i.y-r.height};break;case"bottom":p={x:c,y:i.y+i.height};break;case"right":p={x:i.x+i.width,y:h};break;case"left":p={x:i.x-r.width,y:h};break;default:p={x:i.x,y:i.y}}switch(pr(t)){case"start":p[a]-=d*(n&&u?-1:1);break;case"end":p[a]+=d*(n&&u?-1:1)}return p}async function qr(e,t){var n;void 0===t&&(t={});const{x:i,y:r,platform:s,rects:a,elements:o,strategy:l}=e,{boundary:u="clippingAncestors",rootBoundary:c="viewport",elementContext:h="floating",altBoundary:d=!1,padding:p=0}=hr(t,e),f=br(p),m=o[d?"floating"===h?"reference":"floating":h],g=wr(await s.getClippingRect({element:null==(n=await(null==s.isElement?void 0:s.isElement(m)))||n?m:m.contextElement||await(null==s.getDocumentElement?void 0:s.getDocumentElement(o.floating)),boundary:u,rootBoundary:c,strategy:l})),v="floating"===h?{x:i,y:r,width:a.floating.width,height:a.floating.height}:a.reference,y=await(null==s.getOffsetParent?void 0:s.getOffsetParent(o.floating)),x=await(null==s.isElement?void 0:s.isElement(y))&&await(null==s.getScale?void 0:s.getScale(y))||{x:1,y:1},b=wr(s.convertOffsetParentRelativeRectToViewportRelativeRect?await s.convertOffsetParentRelativeRectToViewportRelativeRect({elements:o,rect:v,offsetParent:y,strategy:l}):v);return{top:(g.top-b.top+f.top)/x.y,bottom:(b.bottom-g.bottom+f.bottom)/x.y,left:(g.left-b.left+f.left)/x.x,right:(b.right-g.right+f.right)/x.x}}function Yr(e){const t=Rr(e);let n=parseFloat(t.width)||0,i=parseFloat(t.height)||0;const r=Mr(e),s=r?e.offsetWidth:n,a=r?e.offsetHeight:i,o=sr(n)!==s||sr(i)!==a;return o&&(n=s,i=a),{width:n,height:i,$:o}}function Xr(e){return Ar(e)?e:e.contextElement}function Qr(e){const t=Xr(e);if(!Mr(t))return or(1);const n=t.getBoundingClientRect(),{width:i,height:r,$:s}=Yr(t);let a=(s?sr(n.width):n.width)/i,o=(s?sr(n.height):n.height)/r;return a&&Number.isFinite(a)||(a=1),o&&Number.isFinite(o)||(o=1),{x:a,y:o}}const Kr=or(0);function Zr(e){const t=Sr(e);return kr()&&t.visualViewport?{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}:Kr}function Jr(e,t,n,i){void 0===t&&(t=!1),void 0===n&&(n=!1);const r=e.getBoundingClientRect(),s=Xr(e);let a=or(1);t&&(i?Ar(i)&&(a=Qr(i)):a=Qr(e));const o=function(e,t,n){return void 0===t&&(t=!1),!(!n||t&&n!==Sr(e))&&t}(s,n,i)?Zr(s):or(0);let l=(r.left+o.x)/a.x,u=(r.top+o.y)/a.y,c=r.width/a.x,h=r.height/a.y;if(s){const e=Sr(s),t=i&&Ar(i)?Sr(i):i;let n=e,r=Ur(n);for(;r&&i&&t!==n;){const e=Qr(r),t=r.getBoundingClientRect(),i=Rr(r),s=t.left+(r.clientLeft+parseFloat(i.paddingLeft))*e.x,a=t.top+(r.clientTop+parseFloat(i.paddingTop))*e.y;l*=e.x,u*=e.y,c*=e.x,h*=e.y,l+=s,u+=a,n=Sr(r),r=Ur(n)}}return wr({width:c,height:h,x:l,y:u})}function $r(e,t){const n=Lr(e).scrollLeft;return t?t.left+n:Jr(Er(e)).left+n}function es(e,t,n){void 0===n&&(n=!1);const i=e.getBoundingClientRect();return{x:i.left+t.scrollLeft-(n?0:$r(e,i)),y:i.top+t.scrollTop}}function ts(e,t,n){let i;if("viewport"===t)i=function(e,t){const n=Sr(e),i=Er(e),r=n.visualViewport;let s=i.clientWidth,a=i.clientHeight,o=0,l=0;if(r){s=r.width,a=r.height;const e=kr();(!e||e&&"fixed"===t)&&(o=r.offsetLeft,l=r.offsetTop)}return{width:s,height:a,x:o,y:l}}(e,n);else if("document"===t)i=function(e){const t=Er(e),n=Lr(e),i=e.ownerDocument.body,r=rr(t.scrollWidth,t.clientWidth,i.scrollWidth,i.clientWidth),s=rr(t.scrollHeight,t.clientHeight,i.scrollHeight,i.clientHeight);let a=-n.scrollLeft+$r(e);const o=-n.scrollTop;return"rtl"===Rr(i).direction&&(a+=rr(t.clientWidth,i.clientWidth)-r),{width:r,height:s,x:a,y:o}}(Er(e));else if(Ar(t))i=function(e,t){const n=Jr(e,!0,"fixed"===t),i=n.top+e.clientTop,r=n.left+e.clientLeft,s=Mr(e)?Qr(e):or(1);return{width:e.clientWidth*s.x,height:e.clientHeight*s.y,x:r*s.x,y:i*s.y}}(t,n);else{const n=Zr(e);i={x:t.x-n.x,y:t.y-n.y,width:t.width,height:t.height}}return wr(i)}function ns(e,t){const n=zr(e);return!(n===t||!Ar(n)||Br(n))&&("fixed"===Rr(n).position||ns(n,t))}function is(e,t,n){const i=Mr(t),r=Er(t),s="fixed"===n,a=Jr(e,!0,s,t);let o={scrollLeft:0,scrollTop:0};const l=or(0);if(i||!i&&!s)if(("body"!==_r(t)||Pr(r))&&(o=Lr(t)),i){const e=Jr(t,!0,s,t);l.x=e.x+t.clientLeft,l.y=e.y+t.clientTop}else r&&(l.x=$r(r));const u=!r||i||s?or(0):es(r,o);return{x:a.left+o.scrollLeft-l.x-u.x,y:a.top+o.scrollTop-l.y-u.y,width:a.width,height:a.height}}function rs(e){return"static"===Rr(e).position}function ss(e,t){if(!Mr(e)||"fixed"===Rr(e).position)return null;if(t)return t(e);let n=e.offsetParent;return Er(e)===n&&(n=n.ownerDocument.body),n}function as(e,t){const n=Sr(e);if(Or(e))return n;if(!Mr(e)){let t=zr(e);for(;t&&!Br(t);){if(Ar(t)&&!rs(t))return t;t=zr(t)}return n}let i=ss(e,t);for(;i&&Fr(i)&&rs(i);)i=ss(i,t);return i&&Br(i)&&rs(i)&&!Ir(i)?n:i||function(e){let t=zr(e);for(;Mr(t)&&!Br(t);){if(Ir(t))return t;if(Or(t))return null;t=zr(t)}return null}(e)||n}const os={convertOffsetParentRelativeRectToViewportRelativeRect:function(e){let{elements:t,rect:n,offsetParent:i,strategy:r}=e;const s="fixed"===r,a=Er(i),o=!!t&&Or(t.floating);if(i===a||o&&s)return n;let l={scrollLeft:0,scrollTop:0},u=or(1);const c=or(0),h=Mr(i);if((h||!h&&!s)&&(("body"!==_r(i)||Pr(a))&&(l=Lr(i)),Mr(i))){const e=Jr(i);u=Qr(i),c.x=e.x+i.clientLeft,c.y=e.y+i.clientTop}const d=!a||h||s?or(0):es(a,l,!0);return{width:n.width*u.x,height:n.height*u.y,x:n.x*u.x-l.scrollLeft*u.x+c.x+d.x,y:n.y*u.y-l.scrollTop*u.y+c.y+d.y}},getDocumentElement:Er,getClippingRect:function(e){let{element:t,boundary:n,rootBoundary:i,strategy:r}=e;const s="clippingAncestors"===n?Or(t)?[]:function(e,t){const n=t.get(e);if(n)return n;let i=jr(e,[],!1).filter((e=>Ar(e)&&"body"!==_r(e))),r=null;const s="fixed"===Rr(e).position;let a=s?zr(e):e;for(;Ar(a)&&!Br(a);){const t=Rr(a),n=Ir(a);n||"fixed"!==t.position||(r=null),(s?!n&&!r:!n&&"static"===t.position&&r&&["absolute","fixed"].includes(r.position)||Pr(a)&&!n&&ns(e,a))?i=i.filter((e=>e!==a)):r=t,a=zr(a)}return t.set(e,i),i}(t,this._c):[].concat(n),a=[...s,i],o=a[0],l=a.reduce(((e,n)=>{const i=ts(t,n,r);return e.top=rr(i.top,e.top),e.right=ir(i.right,e.right),e.bottom=ir(i.bottom,e.bottom),e.left=rr(i.left,e.left),e}),ts(t,o,r));return{width:l.right-l.left,height:l.bottom-l.top,x:l.left,y:l.top}},getOffsetParent:as,getElementRects:async function(e){const t=this.getOffsetParent||as,n=this.getDimensions,i=await n(e.floating);return{reference:is(e.reference,await t(e.floating),e.strategy),floating:{x:0,y:0,width:i.width,height:i.height}}},getClientRects:function(e){return Array.from(e.getClientRects())},getDimensions:function(e){const{width:t,height:n}=Yr(e);return{width:t,height:n}},getScale:Qr,isElement:Ar,isRTL:function(e){return"rtl"===Rr(e).direction}};function ls(e,t){return e.x===t.x&&e.y===t.y&&e.width===t.width&&e.height===t.height}function us(e,t,n,i){void 0===i&&(i={});const{ancestorScroll:r=!0,ancestorResize:s=!0,elementResize:a="function"===typeof ResizeObserver,layoutShift:o="function"===typeof IntersectionObserver,animationFrame:l=!1}=i,u=Xr(e),c=r||s?[...u?jr(u):[],...jr(t)]:[];c.forEach((e=>{r&&e.addEventListener("scroll",n,{passive:!0}),s&&e.addEventListener("resize",n)}));const h=u&&o?function(e,t){let n,i=null;const r=Er(e);function s(){var e;clearTimeout(n),null==(e=i)||e.disconnect(),i=null}return function a(o,l){void 0===o&&(o=!1),void 0===l&&(l=1),s();const u=e.getBoundingClientRect(),{left:c,top:h,width:p,height:f}=u;if(o||t(),!p||!f)return;const m={rootMargin:-ar(h)+"px "+-ar(r.clientWidth-(c+p))+"px "+-ar(r.clientHeight-(h+f))+"px "+-ar(c)+"px",threshold:rr(0,ir(1,l))||1};let g=!0;function v(t){const i=t[0].intersectionRatio;if(i!==l){if(!g)return a();i?a(!1,i):n=setTimeout((()=>{a(!1,1e-7)}),1e3)}1!==i||ls(u,e.getBoundingClientRect())||a(),g=!1}try{i=new IntersectionObserver(v,d(d({},m),{},{root:r.ownerDocument}))}catch(Mn){i=new IntersectionObserver(v,m)}i.observe(e)}(!0),s}(u,n):null;let p,f=-1,m=null;a&&(m=new ResizeObserver((e=>{let[i]=e;i&&i.target===u&&m&&(m.unobserve(t),cancelAnimationFrame(f),f=requestAnimationFrame((()=>{var e;null==(e=m)||e.observe(t)}))),n()})),u&&!l&&m.observe(u),m.observe(t));let g=l?Jr(e):null;return l&&function t(){const i=Jr(e);g&&!ls(g,i)&&n();g=i,p=requestAnimationFrame(t)}(),n(),()=>{var e;c.forEach((e=>{r&&e.removeEventListener("scroll",n),s&&e.removeEventListener("resize",n)})),null==h||h(),null==(e=m)||e.disconnect(),m=null,l&&cancelAnimationFrame(p)}}const cs=qr,hs=function(e){return void 0===e&&(e=0),{name:"offset",options:e,async fn(t){var n,i;const{x:r,y:s,placement:a,middlewareData:o}=t,l=await async function(e,t){const{placement:n,platform:i,elements:r}=e,s=await(null==i.isRTL?void 0:i.isRTL(r.floating)),a=dr(n),o=pr(n),l="y"===gr(n),u=["left","top"].includes(a)?-1:1,c=s&&l?-1:1,h=hr(t,e);let{mainAxis:d,crossAxis:p,alignmentAxis:f}="number"===typeof h?{mainAxis:h,crossAxis:0,alignmentAxis:null}:{mainAxis:h.mainAxis||0,crossAxis:h.crossAxis||0,alignmentAxis:h.alignmentAxis};return o&&"number"===typeof f&&(p="end"===o?-1*f:f),l?{x:p*c,y:d*u}:{x:d*u,y:p*c}}(t,e);return a===(null==(n=o.offset)?void 0:n.placement)&&null!=(i=o.arrow)&&i.alignmentOffset?{}:{x:r+l.x,y:s+l.y,data:d(d({},l),{},{placement:a})}}}},ds=function(e){return void 0===e&&(e={}),{name:"shift",options:e,async fn(t){const{x:n,y:i,placement:r}=t,s=hr(e,t),{mainAxis:a=!0,crossAxis:l=!1,limiter:u={fn:e=>{let{x:t,y:n}=e;return{x:t,y:n}}}}=s,c=o(s,Hr),h={x:n,y:i},p=await qr(t,c),f=gr(dr(r)),m=fr(f);let g=h[m],v=h[f];if(a){const e="y"===m?"bottom":"right";g=cr(g+p["y"===m?"top":"left"],g,g-p[e])}if(l){const e="y"===f?"bottom":"right";v=cr(v+p["y"===f?"top":"left"],v,v-p[e])}const y=u.fn(d(d({},t),{},{[m]:g,[f]:v}));return d(d({},y),{},{data:{x:y.x-n,y:y.y-i,enabled:{[m]:a,[f]:l}}})}}},ps=function(e){return void 0===e&&(e={}),{name:"flip",options:e,async fn(t){var n,i;const{placement:r,middlewareData:s,rects:a,initialPlacement:l,platform:u,elements:c}=t,h=hr(e,t),{mainAxis:d=!0,crossAxis:p=!0,fallbackPlacements:f,fallbackStrategy:m="bestFit",fallbackAxisSideDirection:g="none",flipAlignment:v=!0}=h,y=o(h,Vr);if(null!=(n=s.arrow)&&n.alignmentOffset)return{};const x=dr(r),b=gr(l),w=dr(l)===l,D=await(null==u.isRTL?void 0:u.isRTL(c.floating)),_=f||(w||!v?[xr(l)]:function(e){const t=xr(e);return[yr(e),t,yr(t)]}(l)),S="none"!==g;!f&&S&&_.push(...function(e,t,n,i){const r=pr(e);let s=function(e,t,n){const i=["left","right"],r=["right","left"],s=["top","bottom"],a=["bottom","top"];switch(e){case"top":case"bottom":return n?t?r:i:t?i:r;case"left":case"right":return t?s:a;default:return[]}}(dr(e),"start"===n,i);return r&&(s=s.map((e=>e+"-"+r)),t&&(s=s.concat(s.map(yr)))),s}(l,v,g,D));const E=[l,..._],C=await qr(t,y),A=[];let M=(null==(i=s.flip)?void 0:i.overflows)||[];if(d&&A.push(C[x]),p){const e=function(e,t,n){void 0===n&&(n=!1);const i=pr(e),r=vr(e),s=mr(r);let a="x"===r?i===(n?"end":"start")?"right":"left":"start"===i?"bottom":"top";return t.reference[s]>t.floating[s]&&(a=xr(a)),[a,xr(a)]}(r,a,D);A.push(C[e[0]],C[e[1]])}if(M=[...M,{placement:r,overflows:A}],!A.every((e=>e<=0))){var T,P;const e=((null==(T=s.flip)?void 0:T.index)||0)+1,t=E[e];if(t)return{data:{index:e,overflows:M},reset:{placement:t}};let n=null==(P=M.filter((e=>e.overflows[0]<=0)).sort(((e,t)=>e.overflows[1]-t.overflows[1]))[0])?void 0:P.placement;if(!n)switch(m){case"bestFit":{var F;const e=null==(F=M.filter((e=>{if(S){const t=gr(e.placement);return t===b||"y"===t}return!0})).map((e=>[e.placement,e.overflows.filter((e=>e>0)).reduce(((e,t)=>e+t),0)])).sort(((e,t)=>e[1]-t[1]))[0])?void 0:F[0];e&&(n=e);break}case"initialPlacement":n=l}if(r!==n)return{reset:{placement:n}}}return{}}}},fs=function(e){return void 0===e&&(e={}),{name:"size",options:e,async fn(t){var n,i;const{placement:r,rects:s,platform:a,elements:l}=t,u=hr(e,t),{apply:c=()=>{}}=u,h=o(u,Wr),p=await qr(t,h),f=dr(r),m=pr(r),g="y"===gr(r),{width:v,height:y}=s.floating;let x,b;"top"===f||"bottom"===f?(x=f,b=m===(await(null==a.isRTL?void 0:a.isRTL(l.floating))?"start":"end")?"left":"right"):(b=f,x="end"===m?"top":"bottom");const w=y-p.top-p.bottom,D=v-p.left-p.right,_=ir(y-p[x],w),S=ir(v-p[b],D),E=!t.middlewareData.shift;let C=_,A=S;if(null!=(n=t.middlewareData.shift)&&n.enabled.x&&(A=D),null!=(i=t.middlewareData.shift)&&i.enabled.y&&(C=w),E&&!m){const e=rr(p.left,0),t=rr(p.right,0),n=rr(p.top,0),i=rr(p.bottom,0);g?A=v-2*(0!==e||0!==t?e+t:rr(p.left,p.right)):C=y-2*(0!==n||0!==i?n+i:rr(p.top,p.bottom))}await c(d(d({},t),{},{availableWidth:A,availableHeight:C}));const M=await a.getDimensions(l.floating);return v!==M.width||y!==M.height?{reset:{rects:!0}}:{}}}},ms=(e,t,n)=>{const i=new Map,r=d({platform:os},n),s=d(d({},r.platform),{},{_c:i});return(async(e,t,n)=>{const{placement:i="bottom",strategy:r="absolute",middleware:s=[],platform:a}=n,o=s.filter(Boolean),l=await(null==a.isRTL?void 0:a.isRTL(t));let u=await a.getElementRects({reference:e,floating:t,strategy:r}),{x:c,y:h}=Gr(u,i,l),p=i,f={},m=0;for(let g=0;g<o.length;g++){const{name:n,fn:s}=o[g],{x:v,y:y,data:x,reset:b}=await s({x:c,y:h,initialPlacement:i,placement:p,strategy:r,middlewareData:f,rects:u,platform:a,elements:{reference:e,floating:t}});c=null!=v?v:c,h=null!=y?y:h,f=d(d({},f),{},{[n]:d(d({},f[n]),x)}),b&&m<=50&&(m++,"object"===typeof b&&(b.placement&&(p=b.placement),b.rects&&(u=!0===b.rects?await a.getElementRects({reference:e,floating:t,strategy:r}):b.rects),({x:c,y:h}=Gr(u,p,l))),g=-1)}return{x:c,y:h,placement:p,strategy:r,middlewareData:f}})(e,t,d(d({},r),{},{platform:s}))};var gs="undefined"!==typeof document?r.useLayoutEffect:r.useEffect;function vs(e,t){if(e===t)return!0;if(typeof e!==typeof t)return!1;if("function"===typeof e&&e.toString()===t.toString())return!0;let n,i,r;if(e&&t&&"object"===typeof e){if(Array.isArray(e)){if(n=e.length,n!==t.length)return!1;for(i=n;0!==i--;)if(!vs(e[i],t[i]))return!1;return!0}if(r=Object.keys(e),n=r.length,n!==Object.keys(t).length)return!1;for(i=n;0!==i--;)if(!{}.hasOwnProperty.call(t,r[i]))return!1;for(i=n;0!==i--;){const n=r[i];if(("_owner"!==n||!e.$$typeof)&&!vs(e[n],t[n]))return!1}return!0}return e!==e&&t!==t}function ys(e){if("undefined"===typeof window)return 1;return(e.ownerDocument.defaultView||window).devicePixelRatio||1}function xs(e,t){const n=ys(e);return Math.round(t*n)/n}function bs(e){const t=r.useRef(e);return gs((()=>{t.current=e})),t}const ws=(e,t)=>d(d({},hs(e)),{},{options:[e,t]}),Ds=(e,t)=>d(d({},ps(e)),{},{options:[e,t]}),_s=(e,t)=>d(d({},fs(e)),{},{options:[e,t]}),Ss=["listRef","overflowRef","onFallbackChange","offset","index","minItemsVisible","referenceOverflowThreshold","scrollRef"];const Es=d({},s),Cs=Es.useInsertionEffect||(e=>e());function As(e){const t=r.useRef((()=>{0}));return Cs((()=>{t.current=e})),r.useCallback((function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return null==t.current?void 0:t.current(...n)}),[])}const Ms="ArrowUp",Ts="ArrowDown",Ps="ArrowLeft",Fs="ArrowRight";var Os="undefined"!==typeof document?r.useLayoutEffect:r.useEffect;const Is=[Ps,Fs],ks=[Ms,Ts];let Bs=!1,Rs=0;const Ls=()=>"floating-ui-"+Math.random().toString(36).slice(2,6)+Rs++;const zs=Es.useId||function(){const[e,t]=r.useState((()=>Bs?Ls():void 0));return Os((()=>{null==e&&t(Ls())}),[]),r.useEffect((()=>{Bs=!0}),[]),e};function Ns(){const e=new Map;return{emit(t,n){var i;null==(i=e.get(t))||i.forEach((e=>e(n)))},on(t,n){e.set(t,[...e.get(t)||[],n])},off(t,n){var i;e.set(t,(null==(i=e.get(t))?void 0:i.filter((e=>e!==n)))||[])}}}const js=r.createContext(null),Us=r.createContext(null),Vs=()=>{var e;return(null==(e=r.useContext(js))?void 0:e.id)||null},Hs=()=>r.useContext(Us);const Ws="data-floating-ui-focusable";function Gs(e){void 0===e&&(e={});const{nodeId:t}=e,n=function(e){const{open:t=!1,onOpenChange:n,elements:i}=e,s=zs(),a=r.useRef({}),[o]=r.useState((()=>Ns())),l=null!=Vs(),[u,c]=r.useState(i.reference),h=As(((e,t,i)=>{a.current.openEvent=e?t:void 0,o.emit("openchange",{open:e,event:t,reason:i,nested:l}),null==n||n(e,t,i)})),d=r.useMemo((()=>({setPositionReference:c})),[]),p=r.useMemo((()=>({reference:u||i.reference||null,floating:i.floating||null,domReference:i.reference})),[u,i.reference,i.floating]);return r.useMemo((()=>({dataRef:a,open:t,onOpenChange:h,elements:p,events:o,floatingId:s,refs:d})),[t,h,p,o,s,d])}(d(d({},e),{},{elements:d({reference:null,floating:null},e.elements)})),i=e.rootContext||n,s=i.elements,[a,o]=r.useState(null),[l,u]=r.useState(null),c=(null==s?void 0:s.domReference)||a,h=r.useRef(null),p=Hs();Os((()=>{c&&(h.current=c)}),[c]);const f=function(e){void 0===e&&(e={});const{placement:t="bottom",strategy:n="absolute",middleware:i=[],platform:s,elements:{reference:a,floating:o}={},transform:l=!0,whileElementsMounted:u,open:c}=e,[h,p]=r.useState({x:0,y:0,strategy:n,placement:t,middlewareData:{},isPositioned:!1}),[f,m]=r.useState(i);vs(f,i)||m(i);const[g,v]=r.useState(null),[y,x]=r.useState(null),b=r.useCallback((e=>{e!==S.current&&(S.current=e,v(e))}),[]),w=r.useCallback((e=>{e!==E.current&&(E.current=e,x(e))}),[]),D=a||g,_=o||y,S=r.useRef(null),E=r.useRef(null),C=r.useRef(h),A=null!=u,M=bs(u),T=bs(s),P=bs(c),F=r.useCallback((()=>{if(!S.current||!E.current)return;const e={placement:t,strategy:n,middleware:f};T.current&&(e.platform=T.current),ms(S.current,E.current,e).then((e=>{const t=d(d({},e),{},{isPositioned:!1!==P.current});O.current&&!vs(C.current,t)&&(C.current=t,xi.flushSync((()=>{p(t)})))}))}),[f,t,n,T,P]);gs((()=>{!1===c&&C.current.isPositioned&&(C.current.isPositioned=!1,p((e=>d(d({},e),{},{isPositioned:!1}))))}),[c]);const O=r.useRef(!1);gs((()=>(O.current=!0,()=>{O.current=!1})),[]),gs((()=>{if(D&&(S.current=D),_&&(E.current=_),D&&_){if(M.current)return M.current(D,_,F);F()}}),[D,_,F,M,A]);const I=r.useMemo((()=>({reference:S,floating:E,setReference:b,setFloating:w})),[b,w]),k=r.useMemo((()=>({reference:D,floating:_})),[D,_]),B=r.useMemo((()=>{const e={position:n,left:0,top:0};if(!k.floating)return e;const t=xs(k.floating,h.x),i=xs(k.floating,h.y);return l?d(d({},e),{},{transform:"translate("+t+"px, "+i+"px)"},ys(k.floating)>=1.5&&{willChange:"transform"}):{position:n,left:t,top:i}}),[n,l,k.floating,h.x,h.y]);return r.useMemo((()=>d(d({},h),{},{update:F,refs:I,elements:k,floatingStyles:B})),[h,F,I,k,B])}(d(d({},e),{},{elements:d(d({},s),l&&{reference:l})})),m=r.useCallback((e=>{const t=Ar(e)?{getBoundingClientRect:()=>e.getBoundingClientRect(),contextElement:e}:e;u(t),f.refs.setReference(t)}),[f.refs]),g=r.useCallback((e=>{(Ar(e)||null===e)&&(h.current=e,o(e)),(Ar(f.refs.reference.current)||null===f.refs.reference.current||null!==e&&!Ar(e))&&f.refs.setReference(e)}),[f.refs]),v=r.useMemo((()=>d(d({},f.refs),{},{setReference:g,setPositionReference:m,domReference:h})),[f.refs,g,m]),y=r.useMemo((()=>d(d({},f.elements),{},{domReference:c})),[f.elements,c]),x=r.useMemo((()=>d(d(d({},f),i),{},{refs:v,elements:y,nodeId:t})),[f,v,y,t,i]);return Os((()=>{i.dataRef.current.floatingContext=x;const e=null==p?void 0:p.nodesRef.current.find((e=>e.id===t));e&&(e.context=x)})),r.useMemo((()=>d(d({},f),{},{context:x,refs:v,elements:y})),[f,v,y,x])}const qs="active",Ys="selected";function Xs(e,t,n){const i=new Map,r="item"===n;let s=e;if(r&&e){const{[qs]:t,[Ys]:n}=e;s=o(e,[qs,Ys].map(u))}return d(d(d({},"floating"===n&&{tabIndex:-1,[Ws]:""}),s),t.map((t=>{const i=t?t[n]:null;return"function"===typeof i?e?i(e):null:i})).concat(e).reduce(((e,t)=>t?(Object.entries(t).forEach((t=>{let[n,s]=t;var a;r&&[qs,Ys].includes(n)||(0===n.indexOf("on")?(i.has(n)||i.set(n,[]),"function"===typeof s&&(null==(a=i.get(n))||a.push(s),e[n]=function(){for(var e,t=arguments.length,r=new Array(t),s=0;s<t;s++)r[s]=arguments[s];return null==(e=i.get(n))?void 0:e.map((e=>e(...r))).find((e=>void 0!==e))})):e[n]=s)})),e):e),{}))}function Qs(e,t){return d(d({},e),{},{rects:d(d({},e.rects),{},{floating:d(d({},e.rects.floating),{},{height:t})})})}let Ks=(0,r.createContext)({styles:void 0,setReference:()=>{},setFloating:()=>{},getReferenceProps:()=>({}),getFloatingProps:()=>({}),slot:{}});Ks.displayName="FloatingContext";let Zs=(0,r.createContext)(null);Zs.displayName="PlacementContext";function Js(e){let{children:t,enabled:n=!0}=e,[i,s]=(0,r.useState)(null),[a,l]=(0,r.useState)(0),u=(0,r.useRef)(null),[c,h]=(0,r.useState)(null);!function(e){mn((()=>{if(!e)return;let t=new MutationObserver((()=>{let t=window.getComputedStyle(e).maxHeight,n=parseFloat(t);if(isNaN(n))return;let i=parseInt(t);isNaN(i)||n!==i&&(e.style.maxHeight="".concat(Math.ceil(n),"px"))}));return t.observe(e,{attributes:!0,attributeFilter:["style"]}),()=>{t.disconnect()}}),[e])}(c);let p=n&&null!==i&&null!==c,{to:f="bottom",gap:m=0,offset:g=0,padding:v=0,inner:y}=function(e,t){var n,i,r;let s=$s(null!=(n=null==e?void 0:e.gap)?n:"var(--anchor-gap, 0)",t),a=$s(null!=(i=null==e?void 0:e.offset)?i:"var(--anchor-offset, 0)",t),o=$s(null!=(r=null==e?void 0:e.padding)?r:"var(--anchor-padding, 0)",t);return d(d({},e),{},{gap:s,offset:a,padding:o})}(i,c),[x,b="center"]=f.split(" ");mn((()=>{p&&l(0)}),[p]);let{refs:w,floatingStyles:D,context:_}=Gs({open:p,placement:"selection"===x?"center"===b?"bottom":"bottom-".concat(b):"center"===b?"".concat(x):"".concat(x,"-").concat(b),strategy:"absolute",transform:!1,middleware:[ws({mainAxis:"selection"===x?0:m,crossAxis:g}),(A={padding:v},d(d({},ds(A)),{},{options:[A,M]})),"selection"!==x&&Ds({padding:v}),"selection"===x&&y?(C=d(d({},y),{},{padding:v,overflowRef:u,offset:a,minItemsVisible:4,referenceOverflowThreshold:v,onFallbackChange(e){var t,n;if(!e)return;let i=_.elements.floating;if(!i)return;let r=parseFloat(getComputedStyle(i).scrollPaddingBottom)||0,s=Math.min(4,i.childElementCount),a=0,o=0;for(let l of null!=(n=null==(t=_.elements.floating)?void 0:t.childNodes)?n:[])if(l instanceof HTMLElement){let e=l.offsetTop,t=e+l.clientHeight+r,n=i.scrollTop,u=n+i.clientHeight;if(!(e>=n&&t<=u)){o=Math.max(0,Math.min(t,u)-Math.max(e,n)),a=l.clientHeight;break}s--}s>=1&&l((e=>{let t=a*s-o+r;return e>=t?e:t}))}}),{name:"inner",options:C,async fn(e){const t=hr(C,e),{listRef:n,overflowRef:i,onFallbackChange:r,offset:s=0,index:a=0,minItemsVisible:l=4,referenceOverflowThreshold:u=0,scrollRef:c}=t,h=o(t,Ss),{rects:p,elements:{floating:f}}=e,m=n.current[a],g=(null==c?void 0:c.current)||f,v=f.clientTop||g.clientTop,y=0!==f.clientTop,x=0!==g.clientTop,b=f===g;if(!m)return{};const w=d(d({},e),await ws(-m.offsetTop-f.clientTop-p.reference.height/2-m.offsetHeight/2-s).fn(e)),D=await cs(Qs(w,g.scrollHeight+v+f.clientTop),h),_=await cs(w,d(d({},h),{},{elementContext:"reference"})),S=rr(0,D.top),E=w.y+S,A=g.scrollHeight>g.clientHeight?e=>e:sr,M=A(rr(0,g.scrollHeight+(y&&b||x?2*v:0)-S-rr(0,D.bottom)));if(g.style.maxHeight=M+"px",g.scrollTop=S,r){const e=g.offsetHeight<m.offsetHeight*ir(l,n.current.length)-1||_.top>=-u||_.bottom>=-u;xi.flushSync((()=>r(e)))}return i&&(i.current=await cs(Qs(d(d({},w),{},{y:E}),g.offsetHeight+v+f.clientTop),h)),{y:E}}}):null,_s({padding:v,apply(e){let{availableWidth:t,availableHeight:n,elements:i}=e;Object.assign(i.floating.style,{overflow:"auto",maxWidth:"".concat(t,"px"),maxHeight:"min(var(--anchor-max-height, 100vh), ".concat(n,"px)")})}})].filter(Boolean),whileElementsMounted:us}),[S=x,E=b]=_.placement.split("-");var C,A,M;"selection"===x&&(S="selection");let T=(0,r.useMemo)((()=>({anchor:[S,E].filter(Boolean).join(" ")})),[S,E]),P=function(e,t){const{open:n,elements:i}=e,{enabled:s=!0,overflowRef:a,scrollRef:o,onChange:l}=t,u=As(l),c=r.useRef(!1),h=r.useRef(null),p=r.useRef(null);r.useEffect((()=>{if(!s)return;function e(e){if(e.ctrlKey||!t||null==a.current)return;const n=e.deltaY,i=a.current.top>=-.5,r=a.current.bottom>=-.5,s=t.scrollHeight-t.clientHeight,o=n<0?-1:1,l=n<0?"max":"min";t.scrollHeight<=t.clientHeight||(!i&&n>0||!r&&n<0?(e.preventDefault(),xi.flushSync((()=>{u((e=>e+Math[l](n,s*o)))}))):/firefox/i.test(nr())&&(t.scrollTop+=n))}const t=(null==o?void 0:o.current)||i.floating;return n&&t?(t.addEventListener("wheel",e),requestAnimationFrame((()=>{h.current=t.scrollTop,null!=a.current&&(p.current=d({},a.current))})),()=>{h.current=null,p.current=null,t.removeEventListener("wheel",e)}):void 0}),[s,n,i.floating,a,o,u]);const f=r.useMemo((()=>({onKeyDown(){c.current=!0},onWheel(){c.current=!1},onPointerMove(){c.current=!1},onScroll(){const e=(null==o?void 0:o.current)||i.floating;if(a.current&&e&&c.current){if(null!==h.current){const t=e.scrollTop-h.current;(a.current.bottom<-.5&&t<-1||a.current.top<-.5&&t>1)&&xi.flushSync((()=>u((e=>e+t))))}requestAnimationFrame((()=>{h.current=e.scrollTop}))}}})),[i.floating,u,a,o]);return r.useMemo((()=>s?{floating:f}:{}),[s,f])}(_,{overflowRef:u,onChange:l}),{getReferenceProps:F,getFloatingProps:O}=function(e){void 0===e&&(e=[]);const t=e.map((e=>null==e?void 0:e.reference)),n=e.map((e=>null==e?void 0:e.floating)),i=e.map((e=>null==e?void 0:e.item)),s=r.useCallback((t=>Xs(t,e,"reference")),t),a=r.useCallback((t=>Xs(t,e,"floating")),n),o=r.useCallback((t=>Xs(t,e,"item")),i);return r.useMemo((()=>({getReferenceProps:s,getFloatingProps:a,getItemProps:o})),[s,a,o])}([P]),I=vn((e=>{h(e),w.setFloating(e)}));return r.createElement(Zs.Provider,{value:s},r.createElement(Ks.Provider,{value:{setFloating:I,setReference:w.setReference,styles:D,getReferenceProps:F,getFloatingProps:O,slot:T}},t))}function $s(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0,i=fn(),s=vn(((e,t)=>{if(null==e)return[n,null];if("number"==typeof e)return[e,null];if("string"==typeof e){if(!t)return[n,null];let r=ta(e,t);return[r,n=>{let s=ea(e);{let a=s.map((e=>window.getComputedStyle(t).getPropertyValue(e)));i.requestAnimationFrame((function o(){i.nextFrame(o);let l=!1;for(let[e,n]of s.entries()){let i=window.getComputedStyle(t).getPropertyValue(n);if(a[e]!==i){a[e]=i,l=!0;break}}if(!l)return;let u=ta(e,t);r!==u&&(n(u),r=u)}))}return i.dispose}]}return[n,null]})),a=(0,r.useMemo)((()=>s(e,t)[0]),[e,t]),[o=a,l]=(0,r.useState)();return mn((()=>{let[n,i]=s(e,t);if(l(n),i)return i(l)}),[e,t]),o}function ea(e){let t=/var\((.*)\)/.exec(e);if(t){let e=t[1].indexOf(",");if(-1===e)return[t[1]];let n=t[1].slice(0,e).trim(),i=t[1].slice(e+1).trim();return i?[n,...ea(i)]:[n]}return[]}function ta(e,t){let n=document.createElement("div");t.appendChild(n),n.style.setProperty("margin-top","0px","important"),n.style.setProperty("margin-top",e,"important");let i=parseFloat(window.getComputedStyle(n).marginTop)||0;return t.removeChild(n),i}var na=(e=>(e[e.First=0]="First",e[e.Previous=1]="Previous",e[e.Next=2]="Next",e[e.Last=3]="Last",e[e.Specific=4]="Specific",e[e.Nothing=5]="Nothing",e))(na||{});function ia(e,t){let n=t.resolveItems();if(n.length<=0)return null;let i=t.resolveActiveIndex(),r=null!=i?i:-1;switch(e.focus){case 0:for(let e=0;e<n.length;++e)if(!t.resolveDisabled(n[e],e,n))return e;return i;case 1:-1===r&&(r=n.length);for(let e=r-1;e>=0;--e)if(!t.resolveDisabled(n[e],e,n))return e;return i;case 2:for(let e=r+1;e<n.length;++e)if(!t.resolveDisabled(n[e],e,n))return e;return i;case 3:for(let e=n.length-1;e>=0;--e)if(!t.resolveDisabled(n[e],e,n))return e;return i;case 4:for(let i=0;i<n.length;++i)if(t.resolveId(n[i],i,n)===e.id)return i;return i;case 5:return null;default:!function(e){throw new Error("Unexpected object: "+e)}(e)}}let ra=(0,r.createContext)(void 0);function sa(){return(0,r.useContext)(ra)}const aa=["id"];let oa=(0,r.createContext)(null);function la(){let e=(0,r.useContext)(oa);if(null===e){let e=new Error("You used a <Description /> component, but it is not inside a relevant parent.");throw Error.captureStackTrace&&Error.captureStackTrace(e,la),e}return e}oa.displayName="DescriptionContext";let ua=Qn((function(e,t){let n=(0,r.useId)(),i=sa(),{id:s="headlessui-description-".concat(n)}=e,a=o(e,aa),l=la(),u=Dn(t);mn((()=>l.register(s)),[s,l.register]);let c=i||!1,h=(0,r.useMemo)((()=>d(d({},l.slot),{},{disabled:c})),[l.slot,c]),p=d(d({ref:u},l.props),{},{id:s});return Wn()({ourProps:p,theirProps:a,slot:h,defaultTag:"p",name:l.name||"Description"})})),ca=(Object.assign(ua,{}),(0,r.createContext)(void 0));const ha=["id","htmlFor","passive"];let da=(0,r.createContext)(null);function pa(){let e=(0,r.useContext)(da);if(null===e){let e=new Error("You used a <Label /> component, but it is not inside a relevant parent.");throw Error.captureStackTrace&&Error.captureStackTrace(e,pa),e}return e}function fa(){let{inherit:e=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=function(e){var t,n,i;let s=null!=(n=null==(t=(0,r.useContext)(da))?void 0:t.value)?n:void 0;return(null!=(i=null==e?void 0:e.length)?i:0)>0?[s,...e].filter(Boolean).join(" "):s}(),[n,i]=(0,r.useState)([]),s=e?[t,...n].filter(Boolean):n;return[s.length>0?s.join(" "):void 0,(0,r.useMemo)((()=>function(e){let t=vn((e=>(i((t=>[...t,e])),()=>i((t=>{let n=t.slice(),i=n.indexOf(e);return-1!==i&&n.splice(i,1),n}))))),n=(0,r.useMemo)((()=>({register:t,slot:e.slot,name:e.name,props:e.props,value:e.value})),[t,e.slot,e.name,e.props,e.value]);return r.createElement(da.Provider,{value:n},e.children)}),[i])]}da.displayName="LabelContext";let ma=Qn((function(e,t){var n;let i=(0,r.useId)(),s=pa(),a=(0,r.useContext)(ca),l=sa(),{id:u="headlessui-label-".concat(i),htmlFor:c=(null!=a?a:null==(n=s.props)?void 0:n.htmlFor),passive:h=!1}=e,p=o(e,ha),f=Dn(t);mn((()=>s.register(u)),[u,s.register]);let m=vn((e=>{let t=e.currentTarget;if(t instanceof HTMLLabelElement&&e.preventDefault(),s.props&&"onClick"in s.props&&"function"==typeof s.props.onClick&&s.props.onClick(e),t instanceof HTMLLabelElement){let e=document.getElementById(t.htmlFor);if(e){let t=e.getAttribute("disabled");if("true"===t||""===t)return;let n=e.getAttribute("aria-disabled");if("true"===n||""===n)return;(e instanceof HTMLInputElement&&("radio"===e.type||"checkbox"===e.type)||"radio"===e.role||"checkbox"===e.role||"switch"===e.role)&&e.click(),e.focus({preventScroll:!0})}}})),g=l||!1,v=(0,r.useMemo)((()=>d(d({},s.slot),{},{disabled:g})),[s.slot,g]),y=d(d({ref:f},s.props),{},{id:u,htmlFor:c,onClick:m});return h&&("onClick"in y&&(delete y.htmlFor,delete y.onClick),"onClick"in p&&delete p.onClick),Wn()({ourProps:y,theirProps:p,slot:v,defaultTag:c?"label":"div",name:s.name||"Label"})}));Object.assign(ma,{});function ga(){let e=function(){let e="undefined"==typeof document;return(e=>e.useSyncExternalStore)(s)((()=>()=>{}),(()=>!1),(()=>!e))}(),[t,n]=r.useState(cn.isHandoffComplete);return t&&!1===cn.isHandoffComplete&&n(!1),r.useEffect((()=>{!0!==t&&n(!0)}),[t]),r.useEffect((()=>cn.handoff()),[]),!e&&t}let va=(0,r.createContext)(!1);const ya=["enabled"],xa=["target"];function ba(e){let t=(0,r.useContext)(va),n=(0,r.useContext)(Sa),i=Yi(e),[s,a]=(0,r.useState)((()=>{var e;if(!t&&null!==n)return null!=(e=n.current)?e:null;if(cn.isServer)return null;let r=null==i?void 0:i.getElementById("headlessui-portal-root");if(r)return r;if(null===i)return null;let s=i.createElement("div");return s.setAttribute("id","headlessui-portal-root"),i.body.appendChild(s)}));return(0,r.useEffect)((()=>{null!==s&&(null!=i&&i.body.contains(s)||null==i||i.body.appendChild(s))}),[s,i]),(0,r.useEffect)((()=>{t||null!==n&&a(n.current)}),[n,a,t]),s}let wa=r.Fragment,Da=Qn((function(e,t){let n=e,i=(0,r.useRef)(null),s=Dn(wn((e=>{i.current=e})),t),a=Yi(i),o=ba(i),[l]=(0,r.useState)((()=>{var e;return cn.isServer?null:null!=(e=null==a?void 0:a.createElement("div"))?e:null})),u=(0,r.useContext)(Ea),c=ga();mn((()=>{!o||!l||o.contains(l)||(l.setAttribute("data-headlessui-portal",""),o.appendChild(l))}),[o,l]),mn((()=>{if(l&&u)return u.register(l)}),[u,l]),function(e){let t=vn(e),n=(0,r.useRef)(!1);(0,r.useEffect)((()=>(n.current=!1,()=>{n.current=!0,dn((()=>{n.current&&t()}))})),[t])}((()=>{var e;!o||!l||(l instanceof Node&&o.contains(l)&&o.removeChild(l),o.childNodes.length<=0&&(null==(e=o.parentElement)||e.removeChild(o)))}));let h=Wn();return c&&o&&l?(0,xi.createPortal)(h({ourProps:{ref:s},theirProps:n,slot:{},defaultTag:wa,name:"Portal"}),l):null}));let _a=r.Fragment,Sa=(0,r.createContext)(null);let Ea=(0,r.createContext)(null);let Ca=Qn((function(e,t){let n=Dn(t),{enabled:i=!0}=e,s=o(e,ya),a=Wn();return i?r.createElement(Da,d(d({},s),{},{ref:n})):a({ourProps:{ref:n},theirProps:s,slot:{},defaultTag:wa,name:"Portal"})})),Aa=Qn((function(e,t){let{target:n}=e,i=o(e,xa),s={ref:Dn(t)},a=Wn();return r.createElement(Sa.Provider,{value:n},a({ourProps:s,theirProps:i,defaultTag:_a,name:"Popover.Group"}))})),Ma=Object.assign(Ca,{Group:Aa});const Ta=["__demoMode"],Pa=["id","disabled","autoFocus"],Fa=["id","anchor","portal","modal","transition"],Oa=["id","disabled"],Ia=["id"];var ka=(e=>(e[e.Open=0]="Open",e[e.Closed=1]="Closed",e))(ka||{}),Ba=(e=>(e[e.Pointer=0]="Pointer",e[e.Other=1]="Other",e))(Ba||{}),Ra=(e=>(e[e.OpenMenu=0]="OpenMenu",e[e.CloseMenu=1]="CloseMenu",e[e.GoToItem=2]="GoToItem",e[e.Search=3]="Search",e[e.ClearSearch=4]="ClearSearch",e[e.RegisterItem=5]="RegisterItem",e[e.UnregisterItem=6]="UnregisterItem",e[e.SetButtonElement=7]="SetButtonElement",e[e.SetItemsElement=8]="SetItemsElement",e))(Ra||{});function La(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e=>e,n=null!==e.activeItemIndex?e.items[e.activeItemIndex]:null,i=Ui(t(e.items.slice()),(e=>e.dataRef.current.domRef.current)),r=n?i.indexOf(n):null;return-1===r&&(r=null),{items:i,activeItemIndex:r}}let za={1:e=>1===e.menuState?e:d(d({},e),{},{activeItemIndex:null,menuState:1}),0:e=>0===e.menuState?e:d(d({},e),{},{__demoMode:!1,menuState:0}),2:(e,t)=>{var n,i,r,s,a;if(1===e.menuState)return e;let o=d(d({},e),{},{searchQuery:"",activationTrigger:null!=(n=t.trigger)?n:1,__demoMode:!1});if(t.focus===na.Nothing)return d(d({},o),{},{activeItemIndex:null});if(t.focus===na.Specific)return d(d({},o),{},{activeItemIndex:e.items.findIndex((e=>e.id===t.id))});if(t.focus===na.Previous){let n=e.activeItemIndex;if(null!==n){let s=e.items[n].dataRef.current.domRef,a=ia(t,{resolveItems:()=>e.items,resolveActiveIndex:()=>e.activeItemIndex,resolveId:e=>e.id,resolveDisabled:e=>e.dataRef.current.disabled});if(null!==a){let t=e.items[a].dataRef.current.domRef;if((null==(i=s.current)?void 0:i.previousElementSibling)===t.current||null===(null==(r=t.current)?void 0:r.previousElementSibling))return d(d({},o),{},{activeItemIndex:a})}}}else if(t.focus===na.Next){let n=e.activeItemIndex;if(null!==n){let i=e.items[n].dataRef.current.domRef,r=ia(t,{resolveItems:()=>e.items,resolveActiveIndex:()=>e.activeItemIndex,resolveId:e=>e.id,resolveDisabled:e=>e.dataRef.current.disabled});if(null!==r){let t=e.items[r].dataRef.current.domRef;if((null==(s=i.current)?void 0:s.nextElementSibling)===t.current||null===(null==(a=t.current)?void 0:a.nextElementSibling))return d(d({},o),{},{activeItemIndex:r})}}}let l=La(e),u=ia(t,{resolveItems:()=>l.items,resolveActiveIndex:()=>l.activeItemIndex,resolveId:e=>e.id,resolveDisabled:e=>e.dataRef.current.disabled});return d(d(d({},o),l),{},{activeItemIndex:u})},3:(e,t)=>{let n=""!==e.searchQuery?0:1,i=e.searchQuery+t.value.toLowerCase(),r=(null!==e.activeItemIndex?e.items.slice(e.activeItemIndex+n).concat(e.items.slice(0,e.activeItemIndex+n)):e.items).find((e=>{var t;return(null==(t=e.dataRef.current.textValue)?void 0:t.startsWith(i))&&!e.dataRef.current.disabled})),s=r?e.items.indexOf(r):-1;return-1===s||s===e.activeItemIndex?d(d({},e),{},{searchQuery:i}):d(d({},e),{},{searchQuery:i,activeItemIndex:s,activationTrigger:1})},4:e=>""===e.searchQuery?e:d(d({},e),{},{searchQuery:"",searchActiveItemIndex:null}),5:(e,t)=>{let n=La(e,(e=>[...e,{id:t.id,dataRef:t.dataRef}]));return d(d({},e),n)},6:(e,t)=>{let n=La(e,(e=>{let n=e.findIndex((e=>e.id===t.id));return-1!==n&&e.splice(n,1),e}));return d(d(d({},e),n),{},{activationTrigger:1})},7:(e,t)=>e.buttonElement===t.element?e:d(d({},e),{},{buttonElement:t.element}),8:(e,t)=>e.itemsElement===t.element?e:d(d({},e),{},{itemsElement:t.element})},Na=(0,r.createContext)(null);function ja(e){let t=(0,r.useContext)(Na);if(null===t){let t=new Error("<".concat(e," /> is missing a parent <Menu /> component."));throw Error.captureStackTrace&&Error.captureStackTrace(t,ja),t}return t}function Ua(e,t){return Rn(t.type,za,e,t)}Na.displayName="MenuContext";let Va=r.Fragment;let Ha=Vn.RenderStrategy|Vn.Static;let Wa=r.Fragment;let Ga=Qn((function(e,t){let{__demoMode:n=!1}=e,i=o(e,Ta),s=(0,r.useReducer)(Ua,{__demoMode:n,menuState:n?0:1,buttonElement:null,itemsElement:null,items:[],searchQuery:"",activeItemIndex:null,activationTrigger:1}),[{menuState:a,itemsElement:l,buttonElement:u},c]=s,h=Dn(t);qi(0===a,[u,l],((e,t)=>{c({type:1}),Li(t,Ri.Loose)||(e.preventDefault(),null==u||u.focus())}));let d=vn((()=>{c({type:1})})),p=(0,r.useMemo)((()=>({open:0===a,close:d})),[a,d]),f={ref:h},m=Wn();return r.createElement(Js,null,r.createElement(Na.Provider,{value:s},r.createElement(In,{value:Rn(a,{0:Fn.Open,1:Fn.Closed})},m({ourProps:f,theirProps:i,slot:p,defaultTag:Va,name:"Menu"}))))})),qa=Qn((function(e,t){var n;let i=(0,r.useId)(),{id:s="headlessui-menu-button-".concat(i),disabled:a=!1,autoFocus:l=!1}=e,u=o(e,Pa),[c,h]=ja("Menu.Button"),d=(0,r.useContext)(Ks).getReferenceProps,p=Dn(t,(0,r.useContext)(Ks).setReference,vn((e=>h({type:7,element:e})))),f=vn((e=>{switch(e.key){case ei.Space:case ei.Enter:case ei.ArrowDown:e.preventDefault(),e.stopPropagation(),(0,xi.flushSync)((()=>h({type:0}))),h({type:2,focus:na.First});break;case ei.ArrowUp:e.preventDefault(),e.stopPropagation(),(0,xi.flushSync)((()=>h({type:0}))),h({type:2,focus:na.Last})}})),m=vn((e=>{if(e.key===ei.Space)e.preventDefault()})),g=vn((e=>{var t;if(Bn(e.currentTarget))return e.preventDefault();a||(0===c.menuState?((0,xi.flushSync)((()=>h({type:1}))),null==(t=c.buttonElement)||t.focus({preventScroll:!0})):(e.preventDefault(),h({type:0})))})),{isFocusVisible:v,focusProps:y}=en({autoFocus:l}),{isHovered:x,hoverProps:b}=on({isDisabled:a}),{pressed:w,pressProps:D}=yn({disabled:a}),_=(0,r.useMemo)((()=>({open:0===c.menuState,active:w||0===c.menuState,disabled:a,hover:x,focus:v,autofocus:l})),[c,x,v,w,a,l]),S=Xn(d(),{ref:p,id:s,type:xn(e,c.buttonElement),"aria-haspopup":"menu","aria-controls":null==(n=c.itemsElement)?void 0:n.id,"aria-expanded":0===c.menuState,disabled:a||void 0,autoFocus:l,onKeyDown:f,onKeyUp:m,onClick:g},y,b,D);return Wn()({ourProps:S,theirProps:u,slot:_,defaultTag:"button",name:"Menu.Button"})})),Ya=Qn((function(e,t){var n,i;let s=(0,r.useId)(),{id:a="headlessui-menu-items-".concat(s),anchor:l,portal:u=!1,modal:c=!0,transition:h=!1}=e,p=o(e,Fa),f=function(e){return(0,r.useMemo)((()=>e?"string"==typeof e?{to:e}:e:null),[e])}(l),[m,g]=ja("Menu.Items"),[v,y]=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;!1===e&&(e=null),"string"==typeof e&&(e={to:e});let t=(0,r.useContext)(Zs),n=(0,r.useMemo)((()=>e),[JSON.stringify(e,((e,t)=>{var n;return null!=(n=null==t?void 0:t.outerHTML)?n:t}))]);mn((()=>{null==t||t(null!=n?n:null)}),[t,n]);let i=(0,r.useContext)(Ks);return(0,r.useMemo)((()=>[i.setFloating,e?i.styles:{}]),[i.setFloating,e,i.styles])}(f),x=function(){let{getFloatingProps:e,slot:t}=(0,r.useContext)(Ks);return(0,r.useCallback)((function(){return Object.assign({},e(...arguments),{"data-anchor":t.anchor})}),[e,t])}(),[b,w]=(0,r.useState)(null),D=Dn(t,f?v:null,vn((e=>g({type:8,element:e}))),w),_=Yi(m.itemsElement);f&&(u=!0);let S=On(),[E,C]=An(h,b,null!==S?(S&Fn.Open)===Fn.Open:0===m.menuState);!function(e,t,n){let i=gn((e=>{let t=e.getBoundingClientRect();0===t.x&&0===t.y&&0===t.width&&0===t.height&&n()}));(0,r.useEffect)((()=>{if(!e)return;let n=null===t?null:t instanceof HTMLElement?t:t.current;if(!n)return;let r=pn();if("undefined"!=typeof ResizeObserver){let e=new ResizeObserver((()=>i.current(n)));e.observe(n),r.add((()=>e.disconnect()))}if("undefined"!=typeof IntersectionObserver){let e=new IntersectionObserver((()=>i.current(n)));e.observe(n),r.add((()=>e.disconnect()))}return()=>r.dispose()}),[t,i,e])}(E,m.buttonElement,(()=>{g({type:1})})),Zi(!m.__demoMode&&(c&&0===m.menuState),_),function(e){let{allowed:t,disallowed:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=Ei(e,"inert-others");mn((()=>{var e,r;if(!i)return;let s=pn();for(let t of null!=(e=null==n?void 0:n())?e:[])t&&s.add(Mi(t));let a=null!=(r=null==t?void 0:t())?r:[];for(let t of a){if(!t)continue;let e=hn(t);if(!e)continue;let n=t.parentElement;for(;n&&n!==e.body;){for(let e of n.children)a.some((t=>e.contains(t)))||s.add(Mi(e));n=n.parentElement}}return s.dispose}),[i,t,n])}(!m.__demoMode&&(c&&0===m.menuState),{allowed:(0,r.useCallback)((()=>[m.buttonElement,m.itemsElement]),[m.buttonElement,m.itemsElement])});let A=!function(e,t){let n=(0,r.useRef)({left:0,top:0});if(mn((()=>{if(!t)return;let e=t.getBoundingClientRect();e&&(n.current=e)}),[e,t]),null==t||!e||t===document.activeElement)return!1;let i=t.getBoundingClientRect();return i.top!==n.current.top||i.left!==n.current.left}(0!==m.menuState,m.buttonElement)&&E;(0,r.useEffect)((()=>{let e=m.itemsElement;e&&0===m.menuState&&e!==(null==_?void 0:_.activeElement)&&e.focus({preventScroll:!0})}),[m.menuState,m.itemsElement,_]),function(e,t){let{container:n,accept:i,walk:s}=t,a=(0,r.useRef)(i),o=(0,r.useRef)(s);(0,r.useEffect)((()=>{a.current=i,o.current=s}),[i,s]),mn((()=>{if(!n||!e)return;let t=hn(n);if(!t)return;let i=a.current,r=o.current,s=Object.assign((e=>i(e)),{acceptNode:i}),l=t.createTreeWalker(n,NodeFilter.SHOW_ELEMENT,s,!1);for(;l.nextNode();)r(l.currentNode)}),[n,e,a,o])}(0===m.menuState,{container:m.itemsElement,accept:e=>"menuitem"===e.getAttribute("role")?NodeFilter.FILTER_REJECT:e.hasAttribute("role")?NodeFilter.FILTER_SKIP:NodeFilter.FILTER_ACCEPT,walk(e){e.setAttribute("role","none")}});let M=fn(),T=vn((e=>{var t,n,i;switch(M.dispose(),e.key){case ei.Space:if(""!==m.searchQuery)return e.preventDefault(),e.stopPropagation(),g({type:3,value:e.key});case ei.Enter:if(e.preventDefault(),e.stopPropagation(),g({type:1}),null!==m.activeItemIndex){let{dataRef:e}=m.items[m.activeItemIndex];null==(n=null==(t=e.current)?void 0:t.domRef.current)||n.click()}zi(m.buttonElement);break;case ei.ArrowDown:return e.preventDefault(),e.stopPropagation(),g({type:2,focus:na.Next});case ei.ArrowUp:return e.preventDefault(),e.stopPropagation(),g({type:2,focus:na.Previous});case ei.Home:case ei.PageUp:return e.preventDefault(),e.stopPropagation(),g({type:2,focus:na.First});case ei.End:case ei.PageDown:return e.preventDefault(),e.stopPropagation(),g({type:2,focus:na.Last});case ei.Escape:e.preventDefault(),e.stopPropagation(),(0,xi.flushSync)((()=>g({type:1}))),null==(i=m.buttonElement)||i.focus({preventScroll:!0});break;case ei.Tab:e.preventDefault(),e.stopPropagation(),(0,xi.flushSync)((()=>g({type:1}))),Vi(m.buttonElement,e.shiftKey?Oi.Previous:Oi.Next);break;default:1===e.key.length&&(g({type:3,value:e.key}),M.setTimeout((()=>g({type:4})),350))}})),P=vn((e=>{if(e.key===ei.Space)e.preventDefault()})),F=(0,r.useMemo)((()=>({open:0===m.menuState})),[m.menuState]),O=Xn(f?x():{},d({"aria-activedescendant":null===m.activeItemIndex||null==(n=m.items[m.activeItemIndex])?void 0:n.id,"aria-labelledby":null==(i=m.buttonElement)?void 0:i.id,id:a,onKeyDown:T,onKeyUp:P,role:"menu",tabIndex:0===m.menuState?0:void 0,ref:D,style:d(d(d({},p.style),y),{},{"--button-width":bi(m.buttonElement,!0).width})},Cn(C))),I=Wn();return r.createElement(Ma,{enabled:!!u&&(e.static||E)},I({ourProps:O,theirProps:p,slot:F,defaultTag:"div",features:Ha,visible:A,name:"Menu.Items"}))})),Xa=Qn((function(e,t){let n=(0,r.useId)(),{id:i="headlessui-menu-item-".concat(n),disabled:s=!1}=e,a=o(e,Oa),[l,u]=ja("Menu.Item"),c=null!==l.activeItemIndex&&l.items[l.activeItemIndex].id===i,h=(0,r.useRef)(null),d=Dn(t,h);mn((()=>{if(!l.__demoMode&&0===l.menuState&&c&&0!==l.activationTrigger)return pn().requestAnimationFrame((()=>{var e,t;null==(t=null==(e=h.current)?void 0:e.scrollIntoView)||t.call(e,{block:"nearest"})}))}),[l.__demoMode,h,c,l.menuState,l.activationTrigger,l.activeItemIndex]);let p=er(h),f=(0,r.useRef)({disabled:s,domRef:h,get textValue(){return p()}});mn((()=>{f.current.disabled=s}),[f,s]),mn((()=>(u({type:5,id:i,dataRef:f}),()=>u({type:6,id:i}))),[f,i]);let m=vn((()=>{u({type:1})})),g=vn((e=>{if(s)return e.preventDefault();u({type:1}),zi(l.buttonElement)})),v=vn((()=>{if(s)return u({type:2,focus:na.Nothing});u({type:2,focus:na.Specific,id:i})})),y=function(){let e=(0,r.useRef)([-1,-1]);return{wasMoved(t){let n=tr(t);return(e.current[0]!==n[0]||e.current[1]!==n[1])&&(e.current=n,!0)},update(t){e.current=tr(t)}}}(),x=vn((e=>{y.update(e),!s&&(c||u({type:2,focus:na.Specific,id:i,trigger:0}))})),b=vn((e=>{y.wasMoved(e)&&(s||c||u({type:2,focus:na.Specific,id:i,trigger:0}))})),w=vn((e=>{y.wasMoved(e)&&(s||c&&u({type:2,focus:na.Nothing}))})),[D,_]=fa(),[S,E]=function(){let[e,t]=(0,r.useState)([]);return[e.length>0?e.join(" "):void 0,(0,r.useMemo)((()=>function(e){let n=vn((e=>(t((t=>[...t,e])),()=>t((t=>{let n=t.slice(),i=n.indexOf(e);return-1!==i&&n.splice(i,1),n}))))),i=(0,r.useMemo)((()=>({register:n,slot:e.slot,name:e.name,props:e.props,value:e.value})),[n,e.slot,e.name,e.props,e.value]);return r.createElement(oa.Provider,{value:i},e.children)}),[t])]}(),C=(0,r.useMemo)((()=>({active:c,focus:c,disabled:s,close:m})),[c,s,m]),A={id:i,ref:d,role:"menuitem",tabIndex:!0===s?void 0:-1,"aria-disabled":!0===s||void 0,"aria-labelledby":D,"aria-describedby":S,disabled:void 0,onClick:g,onFocus:v,onPointerEnter:x,onMouseEnter:x,onPointerMove:b,onMouseMove:b,onPointerLeave:w,onMouseLeave:w},M=Wn();return r.createElement(_,null,r.createElement(E,null,M({ourProps:A,theirProps:a,slot:C,defaultTag:Wa,name:"Menu.Item"})))})),Qa=Qn((function(e,t){let[n,i]=fa(),s=e,a={ref:t,"aria-labelledby":n,role:"group"},o=Wn();return r.createElement(i,null,o({ourProps:a,theirProps:s,slot:{},defaultTag:"div",name:"Menu.Section"}))})),Ka=Qn((function(e,t){let n=(0,r.useId)(),{id:i="headlessui-menu-heading-".concat(n)}=e,s=o(e,Ia),a=pa();mn((()=>a.register(i)),[i,a.register]);let l=d({id:i,ref:t,role:"presentation"},a.props);return Wn()({ourProps:l,theirProps:s,slot:{},defaultTag:"header",name:"Menu.Heading"})})),Za=Qn((function(e,t){let n=e,i={ref:t,role:"separator"};return Wn()({ourProps:i,theirProps:n,slot:{},defaultTag:"div",name:"Menu.Separator"})})),Ja=Object.assign(Ga,{Button:qa,Items:Ya,Item:Xa,Section:Qa,Heading:Ka,Separator:Za});const $a=["title","titleId"];function eo(e,t){let{title:n,titleId:i}=e,s=o(e,$a);return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":i},s),n?r.createElement("title",{id:i},n):null,r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M14.857 17.082a23.848 23.848 0 0 0 5.454-1.31A8.967 8.967 0 0 1 18 9.75V9A6 6 0 0 0 6 9v.75a8.967 8.967 0 0 1-2.312 6.022c1.733.64 3.56 1.085 5.455 1.31m5.714 0a24.255 24.255 0 0 1-5.714 0m5.714 0a3 3 0 1 1-5.714 0"}))}const to=r.forwardRef(eo),no=["title","titleId"];function io(e,t){let{title:n,titleId:i}=e,s=o(e,no);return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":i},s),n?r.createElement("title",{id:i},n):null,r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5"}))}const ro=r.forwardRef(io),so=["title","titleId"];function ao(e,t){let{title:n,titleId:i}=e,s=o(e,so);return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":i},s),n?r.createElement("title",{id:i},n):null,r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18 18 6M6 6l12 12"}))}const oo=r.forwardRef(ao);var lo=n(579);function uo(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function co(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}var ho,po,fo,mo,go,vo,yo,xo,bo,wo,Do,_o={autoSleep:120,force3D:"auto",nullTargetWarn:1,units:{lineHeight:""}},So={duration:.5,overwrite:!1,delay:0},Eo=1e8,Co=1e-8,Ao=2*Math.PI,Mo=Ao/4,To=0,Po=Math.sqrt,Fo=Math.cos,Oo=Math.sin,Io=function(e){return"string"===typeof e},ko=function(e){return"function"===typeof e},Bo=function(e){return"number"===typeof e},Ro=function(e){return"undefined"===typeof e},Lo=function(e){return"object"===typeof e},zo=function(e){return!1!==e},No=function(){return"undefined"!==typeof window},jo=function(e){return ko(e)||Io(e)},Uo="function"===typeof ArrayBuffer&&ArrayBuffer.isView||function(){},Vo=Array.isArray,Ho=/(?:-?\.?\d|\.)+/gi,Wo=/[-+=.]*\d+[.e\-+]*\d*[e\-+]*\d*/g,Go=/[-+=.]*\d+[.e-]*\d*[a-z%]*/g,qo=/[-+=.]*\d+\.?\d*(?:e-|e\+)?\d*/gi,Yo=/[+-]=-?[.\d]+/,Xo=/[^,'"\[\]\s]+/gi,Qo=/^[+\-=e\s\d]*\d+[.\d]*([a-z]*|%)\s*$/i,Ko={},Zo={},Jo=function(e){return(Zo=Al(e,Ko))&&Mc},$o=function(e,t){return console.warn("Invalid property",e,"set to",t,"Missing plugin? gsap.registerPlugin()")},el=function(e,t){return!t&&console.warn(e)},tl=function(e,t){return e&&(Ko[e]=t)&&Zo&&(Zo[e]=t)||Ko},nl=function(){return 0},il={suppressEvents:!0,isStart:!0,kill:!1},rl={suppressEvents:!0,kill:!1},sl={suppressEvents:!0},al={},ol=[],ll={},ul={},cl={},hl=30,dl=[],pl="",fl=function(e){var t,n,i=e[0];if(Lo(i)||ko(i)||(e=[e]),!(t=(i._gsap||{}).harness)){for(n=dl.length;n--&&!dl[n].targetTest(i););t=dl[n]}for(n=e.length;n--;)e[n]&&(e[n]._gsap||(e[n]._gsap=new Vu(e[n],t)))||e.splice(n,1);return e},ml=function(e){return e._gsap||fl(su(e))[0]._gsap},gl=function(e,t,n){return(n=e[t])&&ko(n)?e[t]():Ro(n)&&e.getAttribute&&e.getAttribute(t)||n},vl=function(e,t){return(e=e.split(",")).forEach(t)||e},yl=function(e){return Math.round(1e5*e)/1e5||0},xl=function(e){return Math.round(1e7*e)/1e7||0},bl=function(e,t){var n=t.charAt(0),i=parseFloat(t.substr(2));return e=parseFloat(e),"+"===n?e+i:"-"===n?e-i:"*"===n?e*i:e/i},wl=function(e,t){for(var n=t.length,i=0;e.indexOf(t[i])<0&&++i<n;);return i<n},Dl=function(){var e,t,n=ol.length,i=ol.slice(0);for(ll={},ol.length=0,e=0;e<n;e++)(t=i[e])&&t._lazy&&(t.render(t._lazy[0],t._lazy[1],!0)._lazy=0)},_l=function(e,t,n,i){ol.length&&!po&&Dl(),e.render(t,n,i||po&&t<0&&(e._initted||e._startAt)),ol.length&&!po&&Dl()},Sl=function(e){var t=parseFloat(e);return(t||0===t)&&(e+"").match(Xo).length<2?t:Io(e)?e.trim():e},El=function(e){return e},Cl=function(e,t){for(var n in t)n in e||(e[n]=t[n]);return e},Al=function(e,t){for(var n in t)e[n]=t[n];return e},Ml=function e(t,n){for(var i in n)"__proto__"!==i&&"constructor"!==i&&"prototype"!==i&&(t[i]=Lo(n[i])?e(t[i]||(t[i]={}),n[i]):n[i]);return t},Tl=function(e,t){var n,i={};for(n in e)n in t||(i[n]=e[n]);return i},Pl=function(e){var t,n=e.parent||mo,i=e.keyframes?(t=Vo(e.keyframes),function(e,n){for(var i in n)i in e||"duration"===i&&t||"ease"===i||(e[i]=n[i])}):Cl;if(zo(e.inherit))for(;n;)i(e,n.vars.defaults),n=n.parent||n._dp;return e},Fl=function(e,t,n,i,r){void 0===n&&(n="_first"),void 0===i&&(i="_last");var s,a=e[i];if(r)for(s=t[r];a&&a[r]>s;)a=a._prev;return a?(t._next=a._next,a._next=t):(t._next=e[n],e[n]=t),t._next?t._next._prev=t:e[i]=t,t._prev=a,t.parent=t._dp=e,t},Ol=function(e,t,n,i){void 0===n&&(n="_first"),void 0===i&&(i="_last");var r=t._prev,s=t._next;r?r._next=s:e[n]===t&&(e[n]=s),s?s._prev=r:e[i]===t&&(e[i]=r),t._next=t._prev=t.parent=null},Il=function(e,t){e.parent&&(!t||e.parent.autoRemoveChildren)&&e.parent.remove&&e.parent.remove(e),e._act=0},kl=function(e,t){if(e&&(!t||t._end>e._dur||t._start<0))for(var n=e;n;)n._dirty=1,n=n.parent;return e},Bl=function(e,t,n,i){return e._startAt&&(po?e._startAt.revert(rl):e.vars.immediateRender&&!e.vars.autoRevert||e._startAt.render(t,!0,i))},Rl=function e(t){return!t||t._ts&&e(t.parent)},Ll=function(e){return e._repeat?zl(e._tTime,e=e.duration()+e._rDelay)*e:0},zl=function(e,t){var n=Math.floor(e=xl(e/t));return e&&n===e?n-1:n},Nl=function(e,t){return(e-t._start)*t._ts+(t._ts>=0?0:t._dirty?t.totalDuration():t._tDur)},jl=function(e){return e._end=xl(e._start+(e._tDur/Math.abs(e._ts||e._rts||Co)||0))},Ul=function(e,t){var n=e._dp;return n&&n.smoothChildTiming&&e._ts&&(e._start=xl(n._time-(e._ts>0?t/e._ts:((e._dirty?e.totalDuration():e._tDur)-t)/-e._ts)),jl(e),n._dirty||kl(n,e)),e},Vl=function(e,t){var n;if((t._time||!t._dur&&t._initted||t._start<e._time&&(t._dur||!t.add))&&(n=Nl(e.rawTime(),t),(!t._dur||eu(0,t.totalDuration(),n)-t._tTime>Co)&&t.render(n,!0)),kl(e,t)._dp&&e._initted&&e._time>=e._dur&&e._ts){if(e._dur<e.duration())for(n=e;n._dp;)n.rawTime()>=0&&n.totalTime(n._tTime),n=n._dp;e._zTime=-1e-8}},Hl=function(e,t,n,i){return t.parent&&Il(t),t._start=xl((Bo(n)?n:n||e!==mo?Zl(e,n,t):e._time)+t._delay),t._end=xl(t._start+(t.totalDuration()/Math.abs(t.timeScale())||0)),Fl(e,t,"_first","_last",e._sort?"_start":0),Yl(t)||(e._recent=t),i||Vl(e,t),e._ts<0&&Ul(e,e._tTime),e},Wl=function(e,t){return(Ko.ScrollTrigger||$o("scrollTrigger",t))&&Ko.ScrollTrigger.create(t,e)},Gl=function(e,t,n,i,r){return Ku(e,t,r),e._initted?!n&&e._pt&&!po&&(e._dur&&!1!==e.vars.lazy||!e._dur&&e.vars.lazy)&&bo!==Tu.frame?(ol.push(e),e._lazy=[r,i],1):void 0:1},ql=function e(t){var n=t.parent;return n&&n._ts&&n._initted&&!n._lock&&(n.rawTime()<0||e(n))},Yl=function(e){var t=e.data;return"isFromStart"===t||"isStart"===t},Xl=function(e,t,n,i){var r=e._repeat,s=xl(t)||0,a=e._tTime/e._tDur;return a&&!i&&(e._time*=s/e._dur),e._dur=s,e._tDur=r?r<0?1e10:xl(s*(r+1)+e._rDelay*r):s,a>0&&!i&&Ul(e,e._tTime=e._tDur*a),e.parent&&jl(e),n||kl(e.parent,e),e},Ql=function(e){return e instanceof Wu?kl(e):Xl(e,e._dur)},Kl={_start:0,endTime:nl,totalDuration:nl},Zl=function e(t,n,i){var r,s,a,o=t.labels,l=t._recent||Kl,u=t.duration()>=Eo?l.endTime(!1):t._dur;return Io(n)&&(isNaN(n)||n in o)?(s=n.charAt(0),a="%"===n.substr(-1),r=n.indexOf("="),"<"===s||">"===s?(r>=0&&(n=n.replace(/=/,"")),("<"===s?l._start:l.endTime(l._repeat>=0))+(parseFloat(n.substr(1))||0)*(a?(r<0?l:i).totalDuration()/100:1)):r<0?(n in o||(o[n]=u),o[n]):(s=parseFloat(n.charAt(r-1)+n.substr(r+1)),a&&i&&(s=s/100*(Vo(i)?i[0]:i).totalDuration()),r>1?e(t,n.substr(0,r-1),i)+s:u+s)):null==n?u:+n},Jl=function(e,t,n){var i,r,s=Bo(t[1]),a=(s?2:1)+(e<2?0:1),o=t[a];if(s&&(o.duration=t[1]),o.parent=n,e){for(i=o,r=n;r&&!("immediateRender"in i);)i=r.vars.defaults||{},r=zo(r.vars.inherit)&&r.parent;o.immediateRender=zo(i.immediateRender),e<2?o.runBackwards=1:o.startAt=t[a-1]}return new tc(t[0],o,t[a+1])},$l=function(e,t){return e||0===e?t(e):t},eu=function(e,t,n){return n<e?e:n>t?t:n},tu=function(e,t){return Io(e)&&(t=Qo.exec(e))?t[1]:""},nu=[].slice,iu=function(e,t){return e&&Lo(e)&&"length"in e&&(!t&&!e.length||e.length-1 in e&&Lo(e[0]))&&!e.nodeType&&e!==go},ru=function(e,t,n){return void 0===n&&(n=[]),e.forEach((function(e){var i;return Io(e)&&!t||iu(e,1)?(i=n).push.apply(i,su(e)):n.push(e)}))||n},su=function(e,t,n){return fo&&!t&&fo.selector?fo.selector(e):!Io(e)||n||!vo&&Pu()?Vo(e)?ru(e,n):iu(e)?nu.call(e,0):e?[e]:[]:nu.call((t||yo).querySelectorAll(e),0)},au=function(e){return e=su(e)[0]||el("Invalid scope")||{},function(t){var n=e.current||e.nativeElement||e;return su(t,n.querySelectorAll?n:n===e?el("Invalid scope")||yo.createElement("div"):e)}},ou=function(e){return e.sort((function(){return.5-Math.random()}))},lu=function(e){if(ko(e))return e;var t=Lo(e)?e:{each:e},n=Lu(t.ease),i=t.from||0,r=parseFloat(t.base)||0,s={},a=i>0&&i<1,o=isNaN(i)||a,l=t.axis,u=i,c=i;return Io(i)?u=c={center:.5,edges:.5,end:1}[i]||0:!a&&o&&(u=i[0],c=i[1]),function(e,a,h){var d,p,f,m,g,v,y,x,b,w=(h||t).length,D=s[w];if(!D){if(!(b="auto"===t.grid?0:(t.grid||[1,Eo])[1])){for(y=-Eo;y<(y=h[b++].getBoundingClientRect().left)&&b<w;);b<w&&b--}for(D=s[w]=[],d=o?Math.min(b,w)*u-.5:i%b,p=b===Eo?0:o?w*c/b-.5:i/b|0,y=0,x=Eo,v=0;v<w;v++)f=v%b-d,m=p-(v/b|0),D[v]=g=l?Math.abs("y"===l?m:f):Po(f*f+m*m),g>y&&(y=g),g<x&&(x=g);"random"===i&&ou(D),D.max=y-x,D.min=x,D.v=w=(parseFloat(t.amount)||parseFloat(t.each)*(b>w?w-1:l?"y"===l?w/b:b:Math.max(b,w/b))||0)*("edges"===i?-1:1),D.b=w<0?r-w:r,D.u=tu(t.amount||t.each)||0,n=n&&w<0?Bu(n):n}return w=(D[e]-D.min)/D.max||0,xl(D.b+(n?n(w):w)*D.v)+D.u}},uu=function(e){var t=Math.pow(10,((e+"").split(".")[1]||"").length);return function(n){var i=xl(Math.round(parseFloat(n)/e)*e*t);return(i-i%1)/t+(Bo(n)?0:tu(n))}},cu=function(e,t){var n,i,r=Vo(e);return!r&&Lo(e)&&(n=r=e.radius||Eo,e.values?(e=su(e.values),(i=!Bo(e[0]))&&(n*=n)):e=uu(e.increment)),$l(t,r?ko(e)?function(t){return i=e(t),Math.abs(i-t)<=n?i:t}:function(t){for(var r,s,a=parseFloat(i?t.x:t),o=parseFloat(i?t.y:0),l=Eo,u=0,c=e.length;c--;)(r=i?(r=e[c].x-a)*r+(s=e[c].y-o)*s:Math.abs(e[c]-a))<l&&(l=r,u=c);return u=!n||l<=n?e[u]:t,i||u===t||Bo(t)?u:u+tu(t)}:uu(e))},hu=function(e,t,n,i){return $l(Vo(e)?!t:!0===n?!!(n=0):!i,(function(){return Vo(e)?e[~~(Math.random()*e.length)]:(n=n||1e-5)&&(i=n<1?Math.pow(10,(n+"").length-2):1)&&Math.floor(Math.round((e-n/2+Math.random()*(t-e+.99*n))/n)*n*i)/i}))},du=function(e,t,n){return $l(n,(function(n){return e[~~t(n)]}))},pu=function(e){for(var t,n,i,r,s=0,a="";~(t=e.indexOf("random(",s));)i=e.indexOf(")",t),r="["===e.charAt(t+7),n=e.substr(t+7,i-t-7).match(r?Xo:Ho),a+=e.substr(s,t-s)+hu(r?n:+n[0],r?0:+n[1],+n[2]||1e-5),s=i+1;return a+e.substr(s,e.length-s)},fu=function(e,t,n,i,r){var s=t-e,a=i-n;return $l(r,(function(t){return n+((t-e)/s*a||0)}))},mu=function(e,t,n){var i,r,s,a=e.labels,o=Eo;for(i in a)(r=a[i]-t)<0===!!n&&r&&o>(r=Math.abs(r))&&(s=i,o=r);return s},gu=function(e,t,n){var i,r,s,a=e.vars,o=a[t],l=fo,u=e._ctx;if(o)return i=a[t+"Params"],r=a.callbackScope||e,n&&ol.length&&Dl(),u&&(fo=u),s=i?o.apply(r,i):o.call(r),fo=l,s},vu=function(e){return Il(e),e.scrollTrigger&&e.scrollTrigger.kill(!!po),e.progress()<1&&gu(e,"onInterrupt"),e},yu=[],xu=function(e){if(e)if(e=!e.name&&e.default||e,No()||e.headless){var t=e.name,n=ko(e),i=t&&!n&&e.init?function(){this._props=[]}:e,r={init:nl,render:cc,add:Xu,kill:dc,modifier:hc,rawVars:0},s={targetTest:0,get:0,getSetter:ac,aliases:{},register:0};if(Pu(),e!==i){if(ul[t])return;Cl(i,Cl(Tl(e,r),s)),Al(i.prototype,Al(r,Tl(e,s))),ul[i.prop=t]=i,e.targetTest&&(dl.push(i),al[t]=1),t=("css"===t?"CSS":t.charAt(0).toUpperCase()+t.substr(1))+"Plugin"}tl(t,i),e.register&&e.register(Mc,i,mc)}else yu.push(e)},bu=255,wu={aqua:[0,bu,bu],lime:[0,bu,0],silver:[192,192,192],black:[0,0,0],maroon:[128,0,0],teal:[0,128,128],blue:[0,0,bu],navy:[0,0,128],white:[bu,bu,bu],olive:[128,128,0],yellow:[bu,bu,0],orange:[bu,165,0],gray:[128,128,128],purple:[128,0,128],green:[0,128,0],red:[bu,0,0],pink:[bu,192,203],cyan:[0,bu,bu],transparent:[bu,bu,bu,0]},Du=function(e,t,n){return(6*(e+=e<0?1:e>1?-1:0)<1?t+(n-t)*e*6:e<.5?n:3*e<2?t+(n-t)*(2/3-e)*6:t)*bu+.5|0},_u=function(e,t,n){var i,r,s,a,o,l,u,c,h,d,p=e?Bo(e)?[e>>16,e>>8&bu,e&bu]:0:wu.black;if(!p){if(","===e.substr(-1)&&(e=e.substr(0,e.length-1)),wu[e])p=wu[e];else if("#"===e.charAt(0)){if(e.length<6&&(i=e.charAt(1),r=e.charAt(2),s=e.charAt(3),e="#"+i+i+r+r+s+s+(5===e.length?e.charAt(4)+e.charAt(4):"")),9===e.length)return[(p=parseInt(e.substr(1,6),16))>>16,p>>8&bu,p&bu,parseInt(e.substr(7),16)/255];p=[(e=parseInt(e.substr(1),16))>>16,e>>8&bu,e&bu]}else if("hsl"===e.substr(0,3))if(p=d=e.match(Ho),t){if(~e.indexOf("="))return p=e.match(Wo),n&&p.length<4&&(p[3]=1),p}else a=+p[0]%360/360,o=+p[1]/100,i=2*(l=+p[2]/100)-(r=l<=.5?l*(o+1):l+o-l*o),p.length>3&&(p[3]*=1),p[0]=Du(a+1/3,i,r),p[1]=Du(a,i,r),p[2]=Du(a-1/3,i,r);else p=e.match(Ho)||wu.transparent;p=p.map(Number)}return t&&!d&&(i=p[0]/bu,r=p[1]/bu,s=p[2]/bu,l=((u=Math.max(i,r,s))+(c=Math.min(i,r,s)))/2,u===c?a=o=0:(h=u-c,o=l>.5?h/(2-u-c):h/(u+c),a=u===i?(r-s)/h+(r<s?6:0):u===r?(s-i)/h+2:(i-r)/h+4,a*=60),p[0]=~~(a+.5),p[1]=~~(100*o+.5),p[2]=~~(100*l+.5)),n&&p.length<4&&(p[3]=1),p},Su=function(e){var t=[],n=[],i=-1;return e.split(Cu).forEach((function(e){var r=e.match(Go)||[];t.push.apply(t,r),n.push(i+=r.length+1)})),t.c=n,t},Eu=function(e,t,n){var i,r,s,a,o="",l=(e+o).match(Cu),u=t?"hsla(":"rgba(",c=0;if(!l)return e;if(l=l.map((function(e){return(e=_u(e,t,1))&&u+(t?e[0]+","+e[1]+"%,"+e[2]+"%,"+e[3]:e.join(","))+")"})),n&&(s=Su(e),(i=n.c).join(o)!==s.c.join(o)))for(a=(r=e.replace(Cu,"1").split(Go)).length-1;c<a;c++)o+=r[c]+(~i.indexOf(c)?l.shift()||u+"0,0,0,0)":(s.length?s:l.length?l:n).shift());if(!r)for(a=(r=e.split(Cu)).length-1;c<a;c++)o+=r[c]+l[c];return o+r[a]},Cu=function(){var e,t="(?:\\b(?:(?:rgb|rgba|hsl|hsla)\\(.+?\\))|\\B#(?:[0-9a-f]{3,4}){1,2}\\b";for(e in wu)t+="|"+e+"\\b";return new RegExp(t+")","gi")}(),Au=/hsl[a]?\(/,Mu=function(e){var t,n=e.join(" ");if(Cu.lastIndex=0,Cu.test(n))return t=Au.test(n),e[1]=Eu(e[1],t),e[0]=Eu(e[0],t,Su(e[1])),!0},Tu=function(){var e,t,n,i,r,s,a=Date.now,o=500,l=33,u=a(),c=u,h=1e3/240,d=h,p=[],f=function n(f){var m,g,v,y,x=a()-c,b=!0===f;if((x>o||x<0)&&(u+=x-l),((m=(v=(c+=x)-u)-d)>0||b)&&(y=++i.frame,r=v-1e3*i.time,i.time=v/=1e3,d+=m+(m>=h?4:h-m),g=1),b||(e=t(n)),g)for(s=0;s<p.length;s++)p[s](v,r,y,f)};return i={time:0,frame:0,tick:function(){f(!0)},deltaRatio:function(e){return r/(1e3/(e||60))},wake:function(){xo&&(!vo&&No()&&(go=vo=window,yo=go.document||{},Ko.gsap=Mc,(go.gsapVersions||(go.gsapVersions=[])).push(Mc.version),Jo(Zo||go.GreenSockGlobals||!go.gsap&&go||{}),yu.forEach(xu)),n="undefined"!==typeof requestAnimationFrame&&requestAnimationFrame,e&&i.sleep(),t=n||function(e){return setTimeout(e,d-1e3*i.time+1|0)},Do=1,f(2))},sleep:function(){(n?cancelAnimationFrame:clearTimeout)(e),Do=0,t=nl},lagSmoothing:function(e,t){o=e||1/0,l=Math.min(t||33,o)},fps:function(e){h=1e3/(e||240),d=1e3*i.time+h},add:function(e,t,n){var r=t?function(t,n,s,a){e(t,n,s,a),i.remove(r)}:e;return i.remove(e),p[n?"unshift":"push"](r),Pu(),r},remove:function(e,t){~(t=p.indexOf(e))&&p.splice(t,1)&&s>=t&&s--},_listeners:p},i}(),Pu=function(){return!Do&&Tu.wake()},Fu={},Ou=/^[\d.\-M][\d.\-,\s]/,Iu=/["']/g,ku=function(e){for(var t,n,i,r={},s=e.substr(1,e.length-3).split(":"),a=s[0],o=1,l=s.length;o<l;o++)n=s[o],t=o!==l-1?n.lastIndexOf(","):n.length,i=n.substr(0,t),r[a]=isNaN(i)?i.replace(Iu,"").trim():+i,a=n.substr(t+1).trim();return r},Bu=function(e){return function(t){return 1-e(1-t)}},Ru=function e(t,n){for(var i,r=t._first;r;)r instanceof Wu?e(r,n):!r.vars.yoyoEase||r._yoyo&&r._repeat||r._yoyo===n||(r.timeline?e(r.timeline,n):(i=r._ease,r._ease=r._yEase,r._yEase=i,r._yoyo=n)),r=r._next},Lu=function(e,t){return e&&(ko(e)?e:Fu[e]||function(e){var t=(e+"").split("("),n=Fu[t[0]];return n&&t.length>1&&n.config?n.config.apply(null,~e.indexOf("{")?[ku(t[1])]:function(e){var t=e.indexOf("(")+1,n=e.indexOf(")"),i=e.indexOf("(",t);return e.substring(t,~i&&i<n?e.indexOf(")",n+1):n)}(e).split(",").map(Sl)):Fu._CE&&Ou.test(e)?Fu._CE("",e):n}(e))||t},zu=function(e,t,n,i){void 0===n&&(n=function(e){return 1-t(1-e)}),void 0===i&&(i=function(e){return e<.5?t(2*e)/2:1-t(2*(1-e))/2});var r,s={easeIn:t,easeOut:n,easeInOut:i};return vl(e,(function(e){for(var t in Fu[e]=Ko[e]=s,Fu[r=e.toLowerCase()]=n,s)Fu[r+("easeIn"===t?".in":"easeOut"===t?".out":".inOut")]=Fu[e+"."+t]=s[t]})),s},Nu=function(e){return function(t){return t<.5?(1-e(1-2*t))/2:.5+e(2*(t-.5))/2}},ju=function e(t,n,i){var r=n>=1?n:1,s=(i||(t?.3:.45))/(n<1?n:1),a=s/Ao*(Math.asin(1/r)||0),o=function(e){return 1===e?1:r*Math.pow(2,-10*e)*Oo((e-a)*s)+1},l="out"===t?o:"in"===t?function(e){return 1-o(1-e)}:Nu(o);return s=Ao/s,l.config=function(n,i){return e(t,n,i)},l},Uu=function e(t,n){void 0===n&&(n=1.70158);var i=function(e){return e?--e*e*((n+1)*e+n)+1:0},r="out"===t?i:"in"===t?function(e){return 1-i(1-e)}:Nu(i);return r.config=function(n){return e(t,n)},r};vl("Linear,Quad,Cubic,Quart,Quint,Strong",(function(e,t){var n=t<5?t+1:t;zu(e+",Power"+(n-1),t?function(e){return Math.pow(e,n)}:function(e){return e},(function(e){return 1-Math.pow(1-e,n)}),(function(e){return e<.5?Math.pow(2*e,n)/2:1-Math.pow(2*(1-e),n)/2}))})),Fu.Linear.easeNone=Fu.none=Fu.Linear.easeIn,zu("Elastic",ju("in"),ju("out"),ju()),function(e,t){var n=1/t,i=2*n,r=2.5*n,s=function(s){return s<n?e*s*s:s<i?e*Math.pow(s-1.5/t,2)+.75:s<r?e*(s-=2.25/t)*s+.9375:e*Math.pow(s-2.625/t,2)+.984375};zu("Bounce",(function(e){return 1-s(1-e)}),s)}(7.5625,2.75),zu("Expo",(function(e){return Math.pow(2,10*(e-1))*e+e*e*e*e*e*e*(1-e)})),zu("Circ",(function(e){return-(Po(1-e*e)-1)})),zu("Sine",(function(e){return 1===e?1:1-Fo(e*Mo)})),zu("Back",Uu("in"),Uu("out"),Uu()),Fu.SteppedEase=Fu.steps=Ko.SteppedEase={config:function(e,t){void 0===e&&(e=1);var n=1/e,i=e+(t?0:1),r=t?1:0;return function(e){return((i*eu(0,.99999999,e)|0)+r)*n}}},So.ease=Fu["quad.out"],vl("onComplete,onUpdate,onStart,onRepeat,onReverseComplete,onInterrupt",(function(e){return pl+=e+","+e+"Params,"}));var Vu=function(e,t){this.id=To++,e._gsap=this,this.target=e,this.harness=t,this.get=t?t.get:gl,this.set=t?t.getSetter:ac},Hu=function(){function e(e){this.vars=e,this._delay=+e.delay||0,(this._repeat=e.repeat===1/0?-2:e.repeat||0)&&(this._rDelay=e.repeatDelay||0,this._yoyo=!!e.yoyo||!!e.yoyoEase),this._ts=1,Xl(this,+e.duration,1,1),this.data=e.data,fo&&(this._ctx=fo,fo.data.push(this)),Do||Tu.wake()}var t=e.prototype;return t.delay=function(e){return e||0===e?(this.parent&&this.parent.smoothChildTiming&&this.startTime(this._start+e-this._delay),this._delay=e,this):this._delay},t.duration=function(e){return arguments.length?this.totalDuration(this._repeat>0?e+(e+this._rDelay)*this._repeat:e):this.totalDuration()&&this._dur},t.totalDuration=function(e){return arguments.length?(this._dirty=0,Xl(this,this._repeat<0?e:(e-this._repeat*this._rDelay)/(this._repeat+1))):this._tDur},t.totalTime=function(e,t){if(Pu(),!arguments.length)return this._tTime;var n=this._dp;if(n&&n.smoothChildTiming&&this._ts){for(Ul(this,e),!n._dp||n.parent||Vl(n,this);n&&n.parent;)n.parent._time!==n._start+(n._ts>=0?n._tTime/n._ts:(n.totalDuration()-n._tTime)/-n._ts)&&n.totalTime(n._tTime,!0),n=n.parent;!this.parent&&this._dp.autoRemoveChildren&&(this._ts>0&&e<this._tDur||this._ts<0&&e>0||!this._tDur&&!e)&&Hl(this._dp,this,this._start-this._delay)}return(this._tTime!==e||!this._dur&&!t||this._initted&&Math.abs(this._zTime)===Co||!e&&!this._initted&&(this.add||this._ptLookup))&&(this._ts||(this._pTime=e),_l(this,e,t)),this},t.time=function(e,t){return arguments.length?this.totalTime(Math.min(this.totalDuration(),e+Ll(this))%(this._dur+this._rDelay)||(e?this._dur:0),t):this._time},t.totalProgress=function(e,t){return arguments.length?this.totalTime(this.totalDuration()*e,t):this.totalDuration()?Math.min(1,this._tTime/this._tDur):this.rawTime()>=0&&this._initted?1:0},t.progress=function(e,t){return arguments.length?this.totalTime(this.duration()*(!this._yoyo||1&this.iteration()?e:1-e)+Ll(this),t):this.duration()?Math.min(1,this._time/this._dur):this.rawTime()>0?1:0},t.iteration=function(e,t){var n=this.duration()+this._rDelay;return arguments.length?this.totalTime(this._time+(e-1)*n,t):this._repeat?zl(this._tTime,n)+1:1},t.timeScale=function(e,t){if(!arguments.length)return-1e-8===this._rts?0:this._rts;if(this._rts===e)return this;var n=this.parent&&this._ts?Nl(this.parent._time,this):this._tTime;return this._rts=+e||0,this._ts=this._ps||-1e-8===e?0:this._rts,this.totalTime(eu(-Math.abs(this._delay),this._tDur,n),!1!==t),jl(this),function(e){for(var t=e.parent;t&&t.parent;)t._dirty=1,t.totalDuration(),t=t.parent;return e}(this)},t.paused=function(e){return arguments.length?(this._ps!==e&&(this._ps=e,e?(this._pTime=this._tTime||Math.max(-this._delay,this.rawTime()),this._ts=this._act=0):(Pu(),this._ts=this._rts,this.totalTime(this.parent&&!this.parent.smoothChildTiming?this.rawTime():this._tTime||this._pTime,1===this.progress()&&Math.abs(this._zTime)!==Co&&(this._tTime-=Co)))),this):this._ps},t.startTime=function(e){if(arguments.length){this._start=e;var t=this.parent||this._dp;return t&&(t._sort||!this.parent)&&Hl(t,this,e-this._delay),this}return this._start},t.endTime=function(e){return this._start+(zo(e)?this.totalDuration():this.duration())/Math.abs(this._ts||1)},t.rawTime=function(e){var t=this.parent||this._dp;return t?e&&(!this._ts||this._repeat&&this._time&&this.totalProgress()<1)?this._tTime%(this._dur+this._rDelay):this._ts?Nl(t.rawTime(e),this):this._tTime:this._tTime},t.revert=function(e){void 0===e&&(e=sl);var t=po;return po=e,(this._initted||this._startAt)&&(this.timeline&&this.timeline.revert(e),this.totalTime(-.01,e.suppressEvents)),"nested"!==this.data&&!1!==e.kill&&this.kill(),po=t,this},t.globalTime=function(e){for(var t=this,n=arguments.length?e:t.rawTime();t;)n=t._start+n/(Math.abs(t._ts)||1),t=t._dp;return!this.parent&&this._sat?this._sat.globalTime(e):n},t.repeat=function(e){return arguments.length?(this._repeat=e===1/0?-2:e,Ql(this)):-2===this._repeat?1/0:this._repeat},t.repeatDelay=function(e){if(arguments.length){var t=this._time;return this._rDelay=e,Ql(this),t?this.time(t):this}return this._rDelay},t.yoyo=function(e){return arguments.length?(this._yoyo=e,this):this._yoyo},t.seek=function(e,t){return this.totalTime(Zl(this,e),zo(t))},t.restart=function(e,t){return this.play().totalTime(e?-this._delay:0,zo(t)),this._dur||(this._zTime=-1e-8),this},t.play=function(e,t){return null!=e&&this.seek(e,t),this.reversed(!1).paused(!1)},t.reverse=function(e,t){return null!=e&&this.seek(e||this.totalDuration(),t),this.reversed(!0).paused(!1)},t.pause=function(e,t){return null!=e&&this.seek(e,t),this.paused(!0)},t.resume=function(){return this.paused(!1)},t.reversed=function(e){return arguments.length?(!!e!==this.reversed()&&this.timeScale(-this._rts||(e?-1e-8:0)),this):this._rts<0},t.invalidate=function(){return this._initted=this._act=0,this._zTime=-1e-8,this},t.isActive=function(){var e,t=this.parent||this._dp,n=this._start;return!(t&&!(this._ts&&this._initted&&t.isActive()&&(e=t.rawTime(!0))>=n&&e<this.endTime(!0)-Co))},t.eventCallback=function(e,t,n){var i=this.vars;return arguments.length>1?(t?(i[e]=t,n&&(i[e+"Params"]=n),"onUpdate"===e&&(this._onUpdate=t)):delete i[e],this):i[e]},t.then=function(e){var t=this;return new Promise((function(n){var i=ko(e)?e:El,r=function(){var e=t.then;t.then=null,ko(i)&&(i=i(t))&&(i.then||i===t)&&(t.then=e),n(i),t.then=e};t._initted&&1===t.totalProgress()&&t._ts>=0||!t._tTime&&t._ts<0?r():t._prom=r}))},t.kill=function(){vu(this)},e}();Cl(Hu.prototype,{_time:0,_start:0,_end:0,_tTime:0,_tDur:0,_dirty:0,_repeat:0,_yoyo:!1,parent:null,_initted:!1,_rDelay:0,_ts:1,_dp:0,ratio:0,_zTime:-1e-8,_prom:0,_ps:!1,_rts:1});var Wu=function(e){function t(t,n){var i;return void 0===t&&(t={}),(i=e.call(this,t)||this).labels={},i.smoothChildTiming=!!t.smoothChildTiming,i.autoRemoveChildren=!!t.autoRemoveChildren,i._sort=zo(t.sortChildren),mo&&Hl(t.parent||mo,uo(i),n),t.reversed&&i.reverse(),t.paused&&i.paused(!0),t.scrollTrigger&&Wl(uo(i),t.scrollTrigger),i}co(t,e);var n=t.prototype;return n.to=function(e,t,n){return Jl(0,arguments,this),this},n.from=function(e,t,n){return Jl(1,arguments,this),this},n.fromTo=function(e,t,n,i){return Jl(2,arguments,this),this},n.set=function(e,t,n){return t.duration=0,t.parent=this,Pl(t).repeatDelay||(t.repeat=0),t.immediateRender=!!t.immediateRender,new tc(e,t,Zl(this,n),1),this},n.call=function(e,t,n){return Hl(this,tc.delayedCall(0,e,t),n)},n.staggerTo=function(e,t,n,i,r,s,a){return n.duration=t,n.stagger=n.stagger||i,n.onComplete=s,n.onCompleteParams=a,n.parent=this,new tc(e,n,Zl(this,r)),this},n.staggerFrom=function(e,t,n,i,r,s,a){return n.runBackwards=1,Pl(n).immediateRender=zo(n.immediateRender),this.staggerTo(e,t,n,i,r,s,a)},n.staggerFromTo=function(e,t,n,i,r,s,a,o){return i.startAt=n,Pl(i).immediateRender=zo(i.immediateRender),this.staggerTo(e,t,i,r,s,a,o)},n.render=function(e,t,n){var i,r,s,a,o,l,u,c,h,d,p,f,m=this._time,g=this._dirty?this.totalDuration():this._tDur,v=this._dur,y=e<=0?0:xl(e),x=this._zTime<0!==e<0&&(this._initted||!v);if(this!==mo&&y>g&&e>=0&&(y=g),y!==this._tTime||n||x){if(m!==this._time&&v&&(y+=this._time-m,e+=this._time-m),i=y,h=this._start,l=!(c=this._ts),x&&(v||(m=this._zTime),(e||!t)&&(this._zTime=e)),this._repeat){if(p=this._yoyo,o=v+this._rDelay,this._repeat<-1&&e<0)return this.totalTime(100*o+e,t,n);if(i=xl(y%o),y===g?(a=this._repeat,i=v):((a=~~(d=xl(y/o)))&&a===d&&(i=v,a--),i>v&&(i=v)),d=zl(this._tTime,o),!m&&this._tTime&&d!==a&&this._tTime-d*o-this._dur<=0&&(d=a),p&&1&a&&(i=v-i,f=1),a!==d&&!this._lock){var b=p&&1&d,w=b===(p&&1&a);if(a<d&&(b=!b),m=b?0:y%v?v:y,this._lock=1,this.render(m||(f?0:xl(a*o)),t,!v)._lock=0,this._tTime=y,!t&&this.parent&&gu(this,"onRepeat"),this.vars.repeatRefresh&&!f&&(this.invalidate()._lock=1),m&&m!==this._time||l!==!this._ts||this.vars.onRepeat&&!this.parent&&!this._act)return this;if(v=this._dur,g=this._tDur,w&&(this._lock=2,m=b?v:-1e-4,this.render(m,!0),this.vars.repeatRefresh&&!f&&this.invalidate()),this._lock=0,!this._ts&&!l)return this;Ru(this,f)}}if(this._hasPause&&!this._forcing&&this._lock<2&&(u=function(e,t,n){var i;if(n>t)for(i=e._first;i&&i._start<=n;){if("isPause"===i.data&&i._start>t)return i;i=i._next}else for(i=e._last;i&&i._start>=n;){if("isPause"===i.data&&i._start<t)return i;i=i._prev}}(this,xl(m),xl(i)),u&&(y-=i-(i=u._start))),this._tTime=y,this._time=i,this._act=!c,this._initted||(this._onUpdate=this.vars.onUpdate,this._initted=1,this._zTime=e,m=0),!m&&i&&!t&&!a&&(gu(this,"onStart"),this._tTime!==y))return this;if(i>=m&&e>=0)for(r=this._first;r;){if(s=r._next,(r._act||i>=r._start)&&r._ts&&u!==r){if(r.parent!==this)return this.render(e,t,n);if(r.render(r._ts>0?(i-r._start)*r._ts:(r._dirty?r.totalDuration():r._tDur)+(i-r._start)*r._ts,t,n),i!==this._time||!this._ts&&!l){u=0,s&&(y+=this._zTime=-1e-8);break}}r=s}else{r=this._last;for(var D=e<0?e:i;r;){if(s=r._prev,(r._act||D<=r._end)&&r._ts&&u!==r){if(r.parent!==this)return this.render(e,t,n);if(r.render(r._ts>0?(D-r._start)*r._ts:(r._dirty?r.totalDuration():r._tDur)+(D-r._start)*r._ts,t,n||po&&(r._initted||r._startAt)),i!==this._time||!this._ts&&!l){u=0,s&&(y+=this._zTime=D?-1e-8:Co);break}}r=s}}if(u&&!t&&(this.pause(),u.render(i>=m?0:-1e-8)._zTime=i>=m?1:-1,this._ts))return this._start=h,jl(this),this.render(e,t,n);this._onUpdate&&!t&&gu(this,"onUpdate",!0),(y===g&&this._tTime>=this.totalDuration()||!y&&m)&&(h!==this._start&&Math.abs(c)===Math.abs(this._ts)||this._lock||((e||!v)&&(y===g&&this._ts>0||!y&&this._ts<0)&&Il(this,1),t||e<0&&!m||!y&&!m&&g||(gu(this,y===g&&e>=0?"onComplete":"onReverseComplete",!0),this._prom&&!(y<g&&this.timeScale()>0)&&this._prom())))}return this},n.add=function(e,t){var n=this;if(Bo(t)||(t=Zl(this,t,e)),!(e instanceof Hu)){if(Vo(e))return e.forEach((function(e){return n.add(e,t)})),this;if(Io(e))return this.addLabel(e,t);if(!ko(e))return this;e=tc.delayedCall(0,e)}return this!==e?Hl(this,e,t):this},n.getChildren=function(e,t,n,i){void 0===e&&(e=!0),void 0===t&&(t=!0),void 0===n&&(n=!0),void 0===i&&(i=-Eo);for(var r=[],s=this._first;s;)s._start>=i&&(s instanceof tc?t&&r.push(s):(n&&r.push(s),e&&r.push.apply(r,s.getChildren(!0,t,n)))),s=s._next;return r},n.getById=function(e){for(var t=this.getChildren(1,1,1),n=t.length;n--;)if(t[n].vars.id===e)return t[n]},n.remove=function(e){return Io(e)?this.removeLabel(e):ko(e)?this.killTweensOf(e):(e.parent===this&&Ol(this,e),e===this._recent&&(this._recent=this._last),kl(this))},n.totalTime=function(t,n){return arguments.length?(this._forcing=1,!this._dp&&this._ts&&(this._start=xl(Tu.time-(this._ts>0?t/this._ts:(this.totalDuration()-t)/-this._ts))),e.prototype.totalTime.call(this,t,n),this._forcing=0,this):this._tTime},n.addLabel=function(e,t){return this.labels[e]=Zl(this,t),this},n.removeLabel=function(e){return delete this.labels[e],this},n.addPause=function(e,t,n){var i=tc.delayedCall(0,t||nl,n);return i.data="isPause",this._hasPause=1,Hl(this,i,Zl(this,e))},n.removePause=function(e){var t=this._first;for(e=Zl(this,e);t;)t._start===e&&"isPause"===t.data&&Il(t),t=t._next},n.killTweensOf=function(e,t,n){for(var i=this.getTweensOf(e,n),r=i.length;r--;)Gu!==i[r]&&i[r].kill(e,t);return this},n.getTweensOf=function(e,t){for(var n,i=[],r=su(e),s=this._first,a=Bo(t);s;)s instanceof tc?wl(s._targets,r)&&(a?(!Gu||s._initted&&s._ts)&&s.globalTime(0)<=t&&s.globalTime(s.totalDuration())>t:!t||s.isActive())&&i.push(s):(n=s.getTweensOf(r,t)).length&&i.push.apply(i,n),s=s._next;return i},n.tweenTo=function(e,t){t=t||{};var n,i=this,r=Zl(i,e),s=t,a=s.startAt,o=s.onStart,l=s.onStartParams,u=s.immediateRender,c=tc.to(i,Cl({ease:t.ease||"none",lazy:!1,immediateRender:!1,time:r,overwrite:"auto",duration:t.duration||Math.abs((r-(a&&"time"in a?a.time:i._time))/i.timeScale())||Co,onStart:function(){if(i.pause(),!n){var e=t.duration||Math.abs((r-(a&&"time"in a?a.time:i._time))/i.timeScale());c._dur!==e&&Xl(c,e,0,1).render(c._time,!0,!0),n=1}o&&o.apply(c,l||[])}},t));return u?c.render(0):c},n.tweenFromTo=function(e,t,n){return this.tweenTo(t,Cl({startAt:{time:Zl(this,e)}},n))},n.recent=function(){return this._recent},n.nextLabel=function(e){return void 0===e&&(e=this._time),mu(this,Zl(this,e))},n.previousLabel=function(e){return void 0===e&&(e=this._time),mu(this,Zl(this,e),1)},n.currentLabel=function(e){return arguments.length?this.seek(e,!0):this.previousLabel(this._time+Co)},n.shiftChildren=function(e,t,n){void 0===n&&(n=0);for(var i,r=this._first,s=this.labels;r;)r._start>=n&&(r._start+=e,r._end+=e),r=r._next;if(t)for(i in s)s[i]>=n&&(s[i]+=e);return kl(this)},n.invalidate=function(t){var n=this._first;for(this._lock=0;n;)n.invalidate(t),n=n._next;return e.prototype.invalidate.call(this,t)},n.clear=function(e){void 0===e&&(e=!0);for(var t,n=this._first;n;)t=n._next,this.remove(n),n=t;return this._dp&&(this._time=this._tTime=this._pTime=0),e&&(this.labels={}),kl(this)},n.totalDuration=function(e){var t,n,i,r=0,s=this,a=s._last,o=Eo;if(arguments.length)return s.timeScale((s._repeat<0?s.duration():s.totalDuration())/(s.reversed()?-e:e));if(s._dirty){for(i=s.parent;a;)t=a._prev,a._dirty&&a.totalDuration(),(n=a._start)>o&&s._sort&&a._ts&&!s._lock?(s._lock=1,Hl(s,a,n-a._delay,1)._lock=0):o=n,n<0&&a._ts&&(r-=n,(!i&&!s._dp||i&&i.smoothChildTiming)&&(s._start+=n/s._ts,s._time-=n,s._tTime-=n),s.shiftChildren(-n,!1,-Infinity),o=0),a._end>r&&a._ts&&(r=a._end),a=t;Xl(s,s===mo&&s._time>r?s._time:r,1,1),s._dirty=0}return s._tDur},t.updateRoot=function(e){if(mo._ts&&(_l(mo,Nl(e,mo)),bo=Tu.frame),Tu.frame>=hl){hl+=_o.autoSleep||120;var t=mo._first;if((!t||!t._ts)&&_o.autoSleep&&Tu._listeners.length<2){for(;t&&!t._ts;)t=t._next;t||Tu.sleep()}}},t}(Hu);Cl(Wu.prototype,{_lock:0,_hasPause:0,_forcing:0});var Gu,qu,Yu=function(e,t,n,i,r,s,a){var o,l,u,c,h,d,p,f,m=new mc(this._pt,e,t,0,1,uc,null,r),g=0,v=0;for(m.b=n,m.e=i,n+="",(p=~(i+="").indexOf("random("))&&(i=pu(i)),s&&(s(f=[n,i],e,t),n=f[0],i=f[1]),l=n.match(qo)||[];o=qo.exec(i);)c=o[0],h=i.substring(g,o.index),u?u=(u+1)%5:"rgba("===h.substr(-5)&&(u=1),c!==l[v++]&&(d=parseFloat(l[v-1])||0,m._pt={_next:m._pt,p:h||1===v?h:",",s:d,c:"="===c.charAt(1)?bl(d,c)-d:parseFloat(c)-d,m:u&&u<4?Math.round:0},g=qo.lastIndex);return m.c=g<i.length?i.substring(g,i.length):"",m.fp=a,(Yo.test(i)||p)&&(m.e=0),this._pt=m,m},Xu=function(e,t,n,i,r,s,a,o,l,u){ko(i)&&(i=i(r||0,e,s));var c,h=e[t],d="get"!==n?n:ko(h)?l?e[t.indexOf("set")||!ko(e["get"+t.substr(3)])?t:"get"+t.substr(3)](l):e[t]():h,p=ko(h)?l?rc:ic:nc;if(Io(i)&&(~i.indexOf("random(")&&(i=pu(i)),"="===i.charAt(1)&&((c=bl(d,i)+(tu(d)||0))||0===c)&&(i=c)),!u||d!==i||qu)return isNaN(d*i)||""===i?(!h&&!(t in e)&&$o(t,i),Yu.call(this,e,t,d,i,p,o||_o.stringFilter,l)):(c=new mc(this._pt,e,t,+d||0,i-(d||0),"boolean"===typeof h?lc:oc,0,p),l&&(c.fp=l),a&&c.modifier(a,this,e),this._pt=c)},Qu=function(e,t,n,i,r,s){var a,o,l,u;if(ul[e]&&!1!==(a=new ul[e]).init(r,a.rawVars?t[e]:function(e,t,n,i,r){if(ko(e)&&(e=Ju(e,r,t,n,i)),!Lo(e)||e.style&&e.nodeType||Vo(e)||Uo(e))return Io(e)?Ju(e,r,t,n,i):e;var s,a={};for(s in e)a[s]=Ju(e[s],r,t,n,i);return a}(t[e],i,r,s,n),n,i,s)&&(n._pt=o=new mc(n._pt,r,e,0,1,a.render,a,0,a.priority),n!==wo))for(l=n._ptLookup[n._targets.indexOf(r)],u=a._props.length;u--;)l[a._props[u]]=o;return a},Ku=function e(t,n,i){var r,s,a,o,l,u,c,h,d,p,f,m,g,v=t.vars,y=v.ease,x=v.startAt,b=v.immediateRender,w=v.lazy,D=v.onUpdate,_=v.runBackwards,S=v.yoyoEase,E=v.keyframes,C=v.autoRevert,A=t._dur,M=t._startAt,T=t._targets,P=t.parent,F=P&&"nested"===P.data?P.vars.targets:T,O="auto"===t._overwrite&&!ho,I=t.timeline;if(I&&(!E||!y)&&(y="none"),t._ease=Lu(y,So.ease),t._yEase=S?Bu(Lu(!0===S?y:S,So.ease)):0,S&&t._yoyo&&!t._repeat&&(S=t._yEase,t._yEase=t._ease,t._ease=S),t._from=!I&&!!v.runBackwards,!I||E&&!v.stagger){if(m=(h=T[0]?ml(T[0]).harness:0)&&v[h.prop],r=Tl(v,al),M&&(M._zTime<0&&M.progress(1),n<0&&_&&b&&!C?M.render(-1,!0):M.revert(_&&A?rl:il),M._lazy=0),x){if(Il(t._startAt=tc.set(T,Cl({data:"isStart",overwrite:!1,parent:P,immediateRender:!0,lazy:!M&&zo(w),startAt:null,delay:0,onUpdate:D&&function(){return gu(t,"onUpdate")},stagger:0},x))),t._startAt._dp=0,t._startAt._sat=t,n<0&&(po||!b&&!C)&&t._startAt.revert(rl),b&&A&&n<=0&&i<=0)return void(n&&(t._zTime=n))}else if(_&&A&&!M)if(n&&(b=!1),a=Cl({overwrite:!1,data:"isFromStart",lazy:b&&!M&&zo(w),immediateRender:b,stagger:0,parent:P},r),m&&(a[h.prop]=m),Il(t._startAt=tc.set(T,a)),t._startAt._dp=0,t._startAt._sat=t,n<0&&(po?t._startAt.revert(rl):t._startAt.render(-1,!0)),t._zTime=n,b){if(!n)return}else e(t._startAt,Co,Co);for(t._pt=t._ptCache=0,w=A&&zo(w)||w&&!A,s=0;s<T.length;s++){if(c=(l=T[s])._gsap||fl(T)[s]._gsap,t._ptLookup[s]=p={},ll[c.id]&&ol.length&&Dl(),f=F===T?s:F.indexOf(l),h&&!1!==(d=new h).init(l,m||r,t,f,F)&&(t._pt=o=new mc(t._pt,l,d.name,0,1,d.render,d,0,d.priority),d._props.forEach((function(e){p[e]=o})),d.priority&&(u=1)),!h||m)for(a in r)ul[a]&&(d=Qu(a,r,t,f,l,F))?d.priority&&(u=1):p[a]=o=Xu.call(t,l,a,"get",r[a],f,F,0,v.stringFilter);t._op&&t._op[s]&&t.kill(l,t._op[s]),O&&t._pt&&(Gu=t,mo.killTweensOf(l,p,t.globalTime(n)),g=!t.parent,Gu=0),t._pt&&w&&(ll[c.id]=1)}u&&fc(t),t._onInit&&t._onInit(t)}t._onUpdate=D,t._initted=(!t._op||t._pt)&&!g,E&&n<=0&&I.render(Eo,!0,!0)},Zu=function(e,t,n,i){var r,s,a=t.ease||i||"power1.inOut";if(Vo(t))s=n[e]||(n[e]=[]),t.forEach((function(e,n){return s.push({t:n/(t.length-1)*100,v:e,e:a})}));else for(r in t)s=n[r]||(n[r]=[]),"ease"===r||s.push({t:parseFloat(e),v:t[r],e:a})},Ju=function(e,t,n,i,r){return ko(e)?e.call(t,n,i,r):Io(e)&&~e.indexOf("random(")?pu(e):e},$u=pl+"repeat,repeatDelay,yoyo,repeatRefresh,yoyoEase,autoRevert",ec={};vl($u+",id,stagger,delay,duration,paused,scrollTrigger",(function(e){return ec[e]=1}));var tc=function(e){function t(t,n,i,r){var s;"number"===typeof n&&(i.duration=n,n=i,i=null);var a,o,l,u,c,h,d,p,f=(s=e.call(this,r?n:Pl(n))||this).vars,m=f.duration,g=f.delay,v=f.immediateRender,y=f.stagger,x=f.overwrite,b=f.keyframes,w=f.defaults,D=f.scrollTrigger,_=f.yoyoEase,S=n.parent||mo,E=(Vo(t)||Uo(t)?Bo(t[0]):"length"in n)?[t]:su(t);if(s._targets=E.length?fl(E):el("GSAP target "+t+" not found. https://gsap.com",!_o.nullTargetWarn)||[],s._ptLookup=[],s._overwrite=x,b||y||jo(m)||jo(g)){if(n=s.vars,(a=s.timeline=new Wu({data:"nested",defaults:w||{},targets:S&&"nested"===S.data?S.vars.targets:E})).kill(),a.parent=a._dp=uo(s),a._start=0,y||jo(m)||jo(g)){if(u=E.length,d=y&&lu(y),Lo(y))for(c in y)~$u.indexOf(c)&&(p||(p={}),p[c]=y[c]);for(o=0;o<u;o++)(l=Tl(n,ec)).stagger=0,_&&(l.yoyoEase=_),p&&Al(l,p),h=E[o],l.duration=+Ju(m,uo(s),o,h,E),l.delay=(+Ju(g,uo(s),o,h,E)||0)-s._delay,!y&&1===u&&l.delay&&(s._delay=g=l.delay,s._start+=g,l.delay=0),a.to(h,l,d?d(o,h,E):0),a._ease=Fu.none;a.duration()?m=g=0:s.timeline=0}else if(b){Pl(Cl(a.vars.defaults,{ease:"none"})),a._ease=Lu(b.ease||n.ease||"none");var C,A,M,T=0;if(Vo(b))b.forEach((function(e){return a.to(E,e,">")})),a.duration();else{for(c in l={},b)"ease"===c||"easeEach"===c||Zu(c,b[c],l,b.easeEach);for(c in l)for(C=l[c].sort((function(e,t){return e.t-t.t})),T=0,o=0;o<C.length;o++)(M={ease:(A=C[o]).e,duration:(A.t-(o?C[o-1].t:0))/100*m})[c]=A.v,a.to(E,M,T),T+=M.duration;a.duration()<m&&a.to({},{duration:m-a.duration()})}}m||s.duration(m=a.duration())}else s.timeline=0;return!0!==x||ho||(Gu=uo(s),mo.killTweensOf(E),Gu=0),Hl(S,uo(s),i),n.reversed&&s.reverse(),n.paused&&s.paused(!0),(v||!m&&!b&&s._start===xl(S._time)&&zo(v)&&Rl(uo(s))&&"nested"!==S.data)&&(s._tTime=-1e-8,s.render(Math.max(0,-g)||0)),D&&Wl(uo(s),D),s}co(t,e);var n=t.prototype;return n.render=function(e,t,n){var i,r,s,a,o,l,u,c,h,d=this._time,p=this._tDur,f=this._dur,m=e<0,g=e>p-Co&&!m?p:e<Co?0:e;if(f){if(g!==this._tTime||!e||n||!this._initted&&this._tTime||this._startAt&&this._zTime<0!==m||this._lazy){if(i=g,c=this.timeline,this._repeat){if(a=f+this._rDelay,this._repeat<-1&&m)return this.totalTime(100*a+e,t,n);if(i=xl(g%a),g===p?(s=this._repeat,i=f):(s=~~(o=xl(g/a)))&&s===o?(i=f,s--):i>f&&(i=f),(l=this._yoyo&&1&s)&&(h=this._yEase,i=f-i),o=zl(this._tTime,a),i===d&&!n&&this._initted&&s===o)return this._tTime=g,this;s!==o&&(c&&this._yEase&&Ru(c,l),this.vars.repeatRefresh&&!l&&!this._lock&&i!==a&&this._initted&&(this._lock=n=1,this.render(xl(a*s),!0).invalidate()._lock=0))}if(!this._initted){if(Gl(this,m?e:i,n,t,g))return this._tTime=0,this;if(d!==this._time&&(!n||!this.vars.repeatRefresh||s===o))return this;if(f!==this._dur)return this.render(e,t,n)}if(this._tTime=g,this._time=i,!this._act&&this._ts&&(this._act=1,this._lazy=0),this.ratio=u=(h||this._ease)(i/f),this._from&&(this.ratio=u=1-u),i&&!d&&!t&&!s&&(gu(this,"onStart"),this._tTime!==g))return this;for(r=this._pt;r;)r.r(u,r.d),r=r._next;c&&c.render(e<0?e:c._dur*c._ease(i/this._dur),t,n)||this._startAt&&(this._zTime=e),this._onUpdate&&!t&&(m&&Bl(this,e,0,n),gu(this,"onUpdate")),this._repeat&&s!==o&&this.vars.onRepeat&&!t&&this.parent&&gu(this,"onRepeat"),g!==this._tDur&&g||this._tTime!==g||(m&&!this._onUpdate&&Bl(this,e,0,!0),(e||!f)&&(g===this._tDur&&this._ts>0||!g&&this._ts<0)&&Il(this,1),t||m&&!d||!(g||d||l)||(gu(this,g===p?"onComplete":"onReverseComplete",!0),this._prom&&!(g<p&&this.timeScale()>0)&&this._prom()))}}else!function(e,t,n,i){var r,s,a,o=e.ratio,l=t<0||!t&&(!e._start&&ql(e)&&(e._initted||!Yl(e))||(e._ts<0||e._dp._ts<0)&&!Yl(e))?0:1,u=e._rDelay,c=0;if(u&&e._repeat&&(c=eu(0,e._tDur,t),s=zl(c,u),e._yoyo&&1&s&&(l=1-l),s!==zl(e._tTime,u)&&(o=1-l,e.vars.repeatRefresh&&e._initted&&e.invalidate())),l!==o||po||i||e._zTime===Co||!t&&e._zTime){if(!e._initted&&Gl(e,t,i,n,c))return;for(a=e._zTime,e._zTime=t||(n?Co:0),n||(n=t&&!a),e.ratio=l,e._from&&(l=1-l),e._time=0,e._tTime=c,r=e._pt;r;)r.r(l,r.d),r=r._next;t<0&&Bl(e,t,0,!0),e._onUpdate&&!n&&gu(e,"onUpdate"),c&&e._repeat&&!n&&e.parent&&gu(e,"onRepeat"),(t>=e._tDur||t<0)&&e.ratio===l&&(l&&Il(e,1),n||po||(gu(e,l?"onComplete":"onReverseComplete",!0),e._prom&&e._prom()))}else e._zTime||(e._zTime=t)}(this,e,t,n);return this},n.targets=function(){return this._targets},n.invalidate=function(t){return(!t||!this.vars.runBackwards)&&(this._startAt=0),this._pt=this._op=this._onUpdate=this._lazy=this.ratio=0,this._ptLookup=[],this.timeline&&this.timeline.invalidate(t),e.prototype.invalidate.call(this,t)},n.resetTo=function(e,t,n,i,r){Do||Tu.wake(),this._ts||this.play();var s=Math.min(this._dur,(this._dp._time-this._start)*this._ts);return this._initted||Ku(this,s),function(e,t,n,i,r,s,a,o){var l,u,c,h,d=(e._pt&&e._ptCache||(e._ptCache={}))[t];if(!d)for(d=e._ptCache[t]=[],c=e._ptLookup,h=e._targets.length;h--;){if((l=c[h][t])&&l.d&&l.d._pt)for(l=l.d._pt;l&&l.p!==t&&l.fp!==t;)l=l._next;if(!l)return qu=1,e.vars[t]="+=0",Ku(e,a),qu=0,o?el(t+" not eligible for reset"):1;d.push(l)}for(h=d.length;h--;)(l=(u=d[h])._pt||u).s=!i&&0!==i||r?l.s+(i||0)+s*l.c:i,l.c=n-l.s,u.e&&(u.e=yl(n)+tu(u.e)),u.b&&(u.b=l.s+tu(u.b))}(this,e,t,n,i,this._ease(s/this._dur),s,r)?this.resetTo(e,t,n,i,1):(Ul(this,0),this.parent||Fl(this._dp,this,"_first","_last",this._dp._sort?"_start":0),this.render(0))},n.kill=function(e,t){if(void 0===t&&(t="all"),!e&&(!t||"all"===t))return this._lazy=this._pt=0,this.parent?vu(this):this.scrollTrigger&&this.scrollTrigger.kill(!!po),this;if(this.timeline){var n=this.timeline.totalDuration();return this.timeline.killTweensOf(e,t,Gu&&!0!==Gu.vars.overwrite)._first||vu(this),this.parent&&n!==this.timeline.totalDuration()&&Xl(this,this._dur*this.timeline._tDur/n,0,1),this}var i,r,s,a,o,l,u,c=this._targets,h=e?su(e):c,d=this._ptLookup,p=this._pt;if((!t||"all"===t)&&function(e,t){for(var n=e.length,i=n===t.length;i&&n--&&e[n]===t[n];);return n<0}(c,h))return"all"===t&&(this._pt=0),vu(this);for(i=this._op=this._op||[],"all"!==t&&(Io(t)&&(o={},vl(t,(function(e){return o[e]=1})),t=o),t=function(e,t){var n,i,r,s,a=e[0]?ml(e[0]).harness:0,o=a&&a.aliases;if(!o)return t;for(i in n=Al({},t),o)if(i in n)for(r=(s=o[i].split(",")).length;r--;)n[s[r]]=n[i];return n}(c,t)),u=c.length;u--;)if(~h.indexOf(c[u]))for(o in r=d[u],"all"===t?(i[u]=t,a=r,s={}):(s=i[u]=i[u]||{},a=t),a)(l=r&&r[o])&&("kill"in l.d&&!0!==l.d.kill(o)||Ol(this,l,"_pt"),delete r[o]),"all"!==s&&(s[o]=1);return this._initted&&!this._pt&&p&&vu(this),this},t.to=function(e,n){return new t(e,n,arguments[2])},t.from=function(e,t){return Jl(1,arguments)},t.delayedCall=function(e,n,i,r){return new t(n,0,{immediateRender:!1,lazy:!1,overwrite:!1,delay:e,onComplete:n,onReverseComplete:n,onCompleteParams:i,onReverseCompleteParams:i,callbackScope:r})},t.fromTo=function(e,t,n){return Jl(2,arguments)},t.set=function(e,n){return n.duration=0,n.repeatDelay||(n.repeat=0),new t(e,n)},t.killTweensOf=function(e,t,n){return mo.killTweensOf(e,t,n)},t}(Hu);Cl(tc.prototype,{_targets:[],_lazy:0,_startAt:0,_op:0,_onInit:0}),vl("staggerTo,staggerFrom,staggerFromTo",(function(e){tc[e]=function(){var t=new Wu,n=nu.call(arguments,0);return n.splice("staggerFromTo"===e?5:4,0,0),t[e].apply(t,n)}}));var nc=function(e,t,n){return e[t]=n},ic=function(e,t,n){return e[t](n)},rc=function(e,t,n,i){return e[t](i.fp,n)},sc=function(e,t,n){return e.setAttribute(t,n)},ac=function(e,t){return ko(e[t])?ic:Ro(e[t])&&e.setAttribute?sc:nc},oc=function(e,t){return t.set(t.t,t.p,Math.round(1e6*(t.s+t.c*e))/1e6,t)},lc=function(e,t){return t.set(t.t,t.p,!!(t.s+t.c*e),t)},uc=function(e,t){var n=t._pt,i="";if(!e&&t.b)i=t.b;else if(1===e&&t.e)i=t.e;else{for(;n;)i=n.p+(n.m?n.m(n.s+n.c*e):Math.round(1e4*(n.s+n.c*e))/1e4)+i,n=n._next;i+=t.c}t.set(t.t,t.p,i,t)},cc=function(e,t){for(var n=t._pt;n;)n.r(e,n.d),n=n._next},hc=function(e,t,n,i){for(var r,s=this._pt;s;)r=s._next,s.p===i&&s.modifier(e,t,n),s=r},dc=function(e){for(var t,n,i=this._pt;i;)n=i._next,i.p===e&&!i.op||i.op===e?Ol(this,i,"_pt"):i.dep||(t=1),i=n;return!t},pc=function(e,t,n,i){i.mSet(e,t,i.m.call(i.tween,n,i.mt),i)},fc=function(e){for(var t,n,i,r,s=e._pt;s;){for(t=s._next,n=i;n&&n.pr>s.pr;)n=n._next;(s._prev=n?n._prev:r)?s._prev._next=s:i=s,(s._next=n)?n._prev=s:r=s,s=t}e._pt=i},mc=function(){function e(e,t,n,i,r,s,a,o,l){this.t=t,this.s=i,this.c=r,this.p=n,this.r=s||oc,this.d=a||this,this.set=o||nc,this.pr=l||0,this._next=e,e&&(e._prev=this)}return e.prototype.modifier=function(e,t,n){this.mSet=this.mSet||this.set,this.set=pc,this.m=e,this.mt=n,this.tween=t},e}();vl(pl+"parent,duration,ease,delay,overwrite,runBackwards,startAt,yoyo,immediateRender,repeat,repeatDelay,data,paused,reversed,lazy,callbackScope,stringFilter,id,yoyoEase,stagger,inherit,repeatRefresh,keyframes,autoRevert,scrollTrigger",(function(e){return al[e]=1})),Ko.TweenMax=Ko.TweenLite=tc,Ko.TimelineLite=Ko.TimelineMax=Wu,mo=new Wu({sortChildren:!1,defaults:So,autoRemoveChildren:!0,id:"root",smoothChildTiming:!0}),_o.stringFilter=Mu;var gc=[],vc={},yc=[],xc=0,bc=0,wc=function(e){return(vc[e]||yc).map((function(e){return e()}))},Dc=function(){var e=Date.now(),t=[];e-xc>2&&(wc("matchMediaInit"),gc.forEach((function(e){var n,i,r,s,a=e.queries,o=e.conditions;for(i in a)(n=go.matchMedia(a[i]).matches)&&(r=1),n!==o[i]&&(o[i]=n,s=1);s&&(e.revert(),r&&t.push(e))})),wc("matchMediaRevert"),t.forEach((function(e){return e.onMatch(e,(function(t){return e.add(null,t)}))})),xc=e,wc("matchMedia"))},_c=function(){function e(e,t){this.selector=t&&au(t),this.data=[],this._r=[],this.isReverted=!1,this.id=bc++,e&&this.add(e)}var t=e.prototype;return t.add=function(e,t,n){ko(e)&&(n=t,t=e,e=ko);var i=this,r=function(){var e,r=fo,s=i.selector;return r&&r!==i&&r.data.push(i),n&&(i.selector=au(n)),fo=i,e=t.apply(i,arguments),ko(e)&&i._r.push(e),fo=r,i.selector=s,i.isReverted=!1,e};return i.last=r,e===ko?r(i,(function(e){return i.add(null,e)})):e?i[e]=r:r},t.ignore=function(e){var t=fo;fo=null,e(this),fo=t},t.getTweens=function(){var t=[];return this.data.forEach((function(n){return n instanceof e?t.push.apply(t,n.getTweens()):n instanceof tc&&!(n.parent&&"nested"===n.parent.data)&&t.push(n)})),t},t.clear=function(){this._r.length=this.data.length=0},t.kill=function(e,t){var n=this;if(e?function(){for(var t,i=n.getTweens(),r=n.data.length;r--;)"isFlip"===(t=n.data[r]).data&&(t.revert(),t.getChildren(!0,!0,!1).forEach((function(e){return i.splice(i.indexOf(e),1)})));for(i.map((function(e){return{g:e._dur||e._delay||e._sat&&!e._sat.vars.immediateRender?e.globalTime(0):-1/0,t:e}})).sort((function(e,t){return t.g-e.g||-1/0})).forEach((function(t){return t.t.revert(e)})),r=n.data.length;r--;)(t=n.data[r])instanceof Wu?"nested"!==t.data&&(t.scrollTrigger&&t.scrollTrigger.revert(),t.kill()):!(t instanceof tc)&&t.revert&&t.revert(e);n._r.forEach((function(t){return t(e,n)})),n.isReverted=!0}():this.data.forEach((function(e){return e.kill&&e.kill()})),this.clear(),t)for(var i=gc.length;i--;)gc[i].id===this.id&&gc.splice(i,1)},t.revert=function(e){this.kill(e||{})},e}(),Sc=function(){function e(e){this.contexts=[],this.scope=e,fo&&fo.data.push(this)}var t=e.prototype;return t.add=function(e,t,n){Lo(e)||(e={matches:e});var i,r,s,a=new _c(0,n||this.scope),o=a.conditions={};for(r in fo&&!a.selector&&(a.selector=fo.selector),this.contexts.push(a),t=a.add("onMatch",t),a.queries=e,e)"all"===r?s=1:(i=go.matchMedia(e[r]))&&(gc.indexOf(a)<0&&gc.push(a),(o[r]=i.matches)&&(s=1),i.addListener?i.addListener(Dc):i.addEventListener("change",Dc));return s&&t(a,(function(e){return a.add(null,e)})),this},t.revert=function(e){this.kill(e||{})},t.kill=function(e){this.contexts.forEach((function(t){return t.kill(e,!0)}))},e}(),Ec={registerPlugin:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];t.forEach((function(e){return xu(e)}))},timeline:function(e){return new Wu(e)},getTweensOf:function(e,t){return mo.getTweensOf(e,t)},getProperty:function(e,t,n,i){Io(e)&&(e=su(e)[0]);var r=ml(e||{}).get,s=n?El:Sl;return"native"===n&&(n=""),e?t?s((ul[t]&&ul[t].get||r)(e,t,n,i)):function(t,n,i){return s((ul[t]&&ul[t].get||r)(e,t,n,i))}:e},quickSetter:function(e,t,n){if((e=su(e)).length>1){var i=e.map((function(e){return Mc.quickSetter(e,t,n)})),r=i.length;return function(e){for(var t=r;t--;)i[t](e)}}e=e[0]||{};var s=ul[t],a=ml(e),o=a.harness&&(a.harness.aliases||{})[t]||t,l=s?function(t){var i=new s;wo._pt=0,i.init(e,n?t+n:t,wo,0,[e]),i.render(1,i),wo._pt&&cc(1,wo)}:a.set(e,o);return s?l:function(t){return l(e,o,n?t+n:t,a,1)}},quickTo:function(e,t,n){var i,r=Mc.to(e,Cl(((i={})[t]="+=0.1",i.paused=!0,i.stagger=0,i),n||{})),s=function(e,n,i){return r.resetTo(t,e,n,i)};return s.tween=r,s},isTweening:function(e){return mo.getTweensOf(e,!0).length>0},defaults:function(e){return e&&e.ease&&(e.ease=Lu(e.ease,So.ease)),Ml(So,e||{})},config:function(e){return Ml(_o,e||{})},registerEffect:function(e){var t=e.name,n=e.effect,i=e.plugins,r=e.defaults,s=e.extendTimeline;(i||"").split(",").forEach((function(e){return e&&!ul[e]&&!Ko[e]&&el(t+" effect requires "+e+" plugin.")})),cl[t]=function(e,t,i){return n(su(e),Cl(t||{},r),i)},s&&(Wu.prototype[t]=function(e,n,i){return this.add(cl[t](e,Lo(n)?n:(i=n)&&{},this),i)})},registerEase:function(e,t){Fu[e]=Lu(t)},parseEase:function(e,t){return arguments.length?Lu(e,t):Fu},getById:function(e){return mo.getById(e)},exportRoot:function(e,t){void 0===e&&(e={});var n,i,r=new Wu(e);for(r.smoothChildTiming=zo(e.smoothChildTiming),mo.remove(r),r._dp=0,r._time=r._tTime=mo._time,n=mo._first;n;)i=n._next,!t&&!n._dur&&n instanceof tc&&n.vars.onComplete===n._targets[0]||Hl(r,n,n._start-n._delay),n=i;return Hl(mo,r,0),r},context:function(e,t){return e?new _c(e,t):fo},matchMedia:function(e){return new Sc(e)},matchMediaRefresh:function(){return gc.forEach((function(e){var t,n,i=e.conditions;for(n in i)i[n]&&(i[n]=!1,t=1);t&&e.revert()}))||Dc()},addEventListener:function(e,t){var n=vc[e]||(vc[e]=[]);~n.indexOf(t)||n.push(t)},removeEventListener:function(e,t){var n=vc[e],i=n&&n.indexOf(t);i>=0&&n.splice(i,1)},utils:{wrap:function e(t,n,i){var r=n-t;return Vo(t)?du(t,e(0,t.length),n):$l(i,(function(e){return(r+(e-t)%r)%r+t}))},wrapYoyo:function e(t,n,i){var r=n-t,s=2*r;return Vo(t)?du(t,e(0,t.length-1),n):$l(i,(function(e){return t+((e=(s+(e-t)%s)%s||0)>r?s-e:e)}))},distribute:lu,random:hu,snap:cu,normalize:function(e,t,n){return fu(e,t,0,1,n)},getUnit:tu,clamp:function(e,t,n){return $l(n,(function(n){return eu(e,t,n)}))},splitColor:_u,toArray:su,selector:au,mapRange:fu,pipe:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){return t.reduce((function(e,t){return t(e)}),e)}},unitize:function(e,t){return function(n){return e(parseFloat(n))+(t||tu(n))}},interpolate:function e(t,n,i,r){var s=isNaN(t+n)?0:function(e){return(1-e)*t+e*n};if(!s){var a,o,l,u,c,h=Io(t),d={};if(!0===i&&(r=1)&&(i=null),h)t={p:t},n={p:n};else if(Vo(t)&&!Vo(n)){for(l=[],u=t.length,c=u-2,o=1;o<u;o++)l.push(e(t[o-1],t[o]));u--,s=function(e){e*=u;var t=Math.min(c,~~e);return l[t](e-t)},i=n}else r||(t=Al(Vo(t)?[]:{},t));if(!l){for(a in n)Xu.call(d,t,a,"get",n[a]);s=function(e){return cc(e,d)||(h?t.p:t)}}}return $l(i,s)},shuffle:ou},install:Jo,effects:cl,ticker:Tu,updateRoot:Wu.updateRoot,plugins:ul,globalTimeline:mo,core:{PropTween:mc,globals:tl,Tween:tc,Timeline:Wu,Animation:Hu,getCache:ml,_removeLinkedListItem:Ol,reverting:function(){return po},context:function(e){return e&&fo&&(fo.data.push(e),e._ctx=fo),fo},suppressOverwrites:function(e){return ho=e}}};vl("to,from,fromTo,delayedCall,set,killTweensOf",(function(e){return Ec[e]=tc[e]})),Tu.add(Wu.updateRoot),wo=Ec.to({},{duration:0});var Cc=function(e,t){for(var n=e._pt;n&&n.p!==t&&n.op!==t&&n.fp!==t;)n=n._next;return n},Ac=function(e,t){return{name:e,rawVars:1,init:function(e,n,i){i._onInit=function(e){var i,r;if(Io(n)&&(i={},vl(n,(function(e){return i[e]=1})),n=i),t){for(r in i={},n)i[r]=t(n[r]);n=i}!function(e,t){var n,i,r,s=e._targets;for(n in t)for(i=s.length;i--;)(r=e._ptLookup[i][n])&&(r=r.d)&&(r._pt&&(r=Cc(r,n)),r&&r.modifier&&r.modifier(t[n],e,s[i],n))}(e,n)}}}},Mc=Ec.registerPlugin({name:"attr",init:function(e,t,n,i,r){var s,a,o;for(s in this.tween=n,t)o=e.getAttribute(s)||"",(a=this.add(e,"setAttribute",(o||0)+"",t[s],i,r,0,0,s)).op=s,a.b=o,this._props.push(s)},render:function(e,t){for(var n=t._pt;n;)po?n.set(n.t,n.p,n.b,n):n.r(e,n.d),n=n._next}},{name:"endArray",init:function(e,t){for(var n=t.length;n--;)this.add(e,n,e[n]||0,t[n],0,0,0,0,0,1)}},Ac("roundProps",uu),Ac("modifiers"),Ac("snap",cu))||Ec;tc.version=Wu.version=Mc.version="3.12.7",xo=1,No()&&Pu();Fu.Power0,Fu.Power1,Fu.Power2,Fu.Power3,Fu.Power4,Fu.Linear,Fu.Quad,Fu.Cubic,Fu.Quart,Fu.Quint,Fu.Strong,Fu.Elastic,Fu.Back,Fu.SteppedEase,Fu.Bounce,Fu.Sine,Fu.Expo,Fu.Circ;var Tc,Pc,Fc,Oc,Ic,kc,Bc,Rc,Lc={},zc=180/Math.PI,Nc=Math.PI/180,jc=Math.atan2,Uc=/([A-Z])/g,Vc=/(left|right|width|margin|padding|x)/i,Hc=/[\s,\(]\S/,Wc={autoAlpha:"opacity,visibility",scale:"scaleX,scaleY",alpha:"opacity"},Gc=function(e,t){return t.set(t.t,t.p,Math.round(1e4*(t.s+t.c*e))/1e4+t.u,t)},qc=function(e,t){return t.set(t.t,t.p,1===e?t.e:Math.round(1e4*(t.s+t.c*e))/1e4+t.u,t)},Yc=function(e,t){return t.set(t.t,t.p,e?Math.round(1e4*(t.s+t.c*e))/1e4+t.u:t.b,t)},Xc=function(e,t){var n=t.s+t.c*e;t.set(t.t,t.p,~~(n+(n<0?-.5:.5))+t.u,t)},Qc=function(e,t){return t.set(t.t,t.p,e?t.e:t.b,t)},Kc=function(e,t){return t.set(t.t,t.p,1!==e?t.b:t.e,t)},Zc=function(e,t,n){return e.style[t]=n},Jc=function(e,t,n){return e.style.setProperty(t,n)},$c=function(e,t,n){return e._gsap[t]=n},eh=function(e,t,n){return e._gsap.scaleX=e._gsap.scaleY=n},th=function(e,t,n,i,r){var s=e._gsap;s.scaleX=s.scaleY=n,s.renderTransform(r,s)},nh=function(e,t,n,i,r){var s=e._gsap;s[t]=n,s.renderTransform(r,s)},ih="transform",rh=ih+"Origin",sh=function e(t,n){var i=this,r=this.target,s=r.style,a=r._gsap;if(t in Lc&&s){if(this.tfm=this.tfm||{},"transform"===t)return Wc.transform.split(",").forEach((function(t){return e.call(i,t,n)}));if(~(t=Wc[t]||t).indexOf(",")?t.split(",").forEach((function(e){return i.tfm[e]=_h(r,e)})):this.tfm[t]=a.x?a[t]:_h(r,t),t===rh&&(this.tfm.zOrigin=a.zOrigin),this.props.indexOf(ih)>=0)return;a.svg&&(this.svgo=r.getAttribute("data-svg-origin"),this.props.push(rh,n,"")),t=ih}(s||n)&&this.props.push(t,n,s[t])},ah=function(e){e.translate&&(e.removeProperty("translate"),e.removeProperty("scale"),e.removeProperty("rotate"))},oh=function(){var e,t,n=this.props,i=this.target,r=i.style,s=i._gsap;for(e=0;e<n.length;e+=3)n[e+1]?2===n[e+1]?i[n[e]](n[e+2]):i[n[e]]=n[e+2]:n[e+2]?r[n[e]]=n[e+2]:r.removeProperty("--"===n[e].substr(0,2)?n[e]:n[e].replace(Uc,"-$1").toLowerCase());if(this.tfm){for(t in this.tfm)s[t]=this.tfm[t];s.svg&&(s.renderTransform(),i.setAttribute("data-svg-origin",this.svgo||"")),(e=Bc())&&e.isStart||r[ih]||(ah(r),s.zOrigin&&r[rh]&&(r[rh]+=" "+s.zOrigin+"px",s.zOrigin=0,s.renderTransform()),s.uncache=1)}},lh=function(e,t){var n={target:e,props:[],revert:oh,save:sh};return e._gsap||Mc.core.getCache(e),t&&e.style&&e.nodeType&&t.split(",").forEach((function(e){return n.save(e)})),n},uh=function(e,t){var n=Pc.createElementNS?Pc.createElementNS((t||"http://www.w3.org/1999/xhtml").replace(/^https/,"http"),e):Pc.createElement(e);return n&&n.style?n:Pc.createElement(e)},ch=function e(t,n,i){var r=getComputedStyle(t);return r[n]||r.getPropertyValue(n.replace(Uc,"-$1").toLowerCase())||r.getPropertyValue(n)||!i&&e(t,dh(n)||n,1)||""},hh="O,Moz,ms,Ms,Webkit".split(","),dh=function(e,t,n){var i=(t||Ic).style,r=5;if(e in i&&!n)return e;for(e=e.charAt(0).toUpperCase()+e.substr(1);r--&&!(hh[r]+e in i););return r<0?null:(3===r?"ms":r>=0?hh[r]:"")+e},ph=function(){"undefined"!==typeof window&&window.document&&(Tc=window,Pc=Tc.document,Fc=Pc.documentElement,Ic=uh("div")||{style:{}},uh("div"),ih=dh(ih),rh=ih+"Origin",Ic.style.cssText="border-width:0;line-height:0;position:absolute;padding:0",Rc=!!dh("perspective"),Bc=Mc.core.reverting,Oc=1)},fh=function(e){var t,n=e.ownerSVGElement,i=uh("svg",n&&n.getAttribute("xmlns")||"http://www.w3.org/2000/svg"),r=e.cloneNode(!0);r.style.display="block",i.appendChild(r),Fc.appendChild(i);try{t=r.getBBox()}catch(Mn){}return i.removeChild(r),Fc.removeChild(i),t},mh=function(e,t){for(var n=t.length;n--;)if(e.hasAttribute(t[n]))return e.getAttribute(t[n])},gh=function(e){var t,n;try{t=e.getBBox()}catch(i){t=fh(e),n=1}return t&&(t.width||t.height)||n||(t=fh(e)),!t||t.width||t.x||t.y?t:{x:+mh(e,["x","cx","x1"])||0,y:+mh(e,["y","cy","y1"])||0,width:0,height:0}},vh=function(e){return!(!e.getCTM||e.parentNode&&!e.ownerSVGElement||!gh(e))},yh=function(e,t){if(t){var n,i=e.style;t in Lc&&t!==rh&&(t=ih),i.removeProperty?("ms"!==(n=t.substr(0,2))&&"webkit"!==t.substr(0,6)||(t="-"+t),i.removeProperty("--"===n?t:t.replace(Uc,"-$1").toLowerCase())):i.removeAttribute(t)}},xh=function(e,t,n,i,r,s){var a=new mc(e._pt,t,n,0,1,s?Kc:Qc);return e._pt=a,a.b=i,a.e=r,e._props.push(n),a},bh={deg:1,rad:1,turn:1},wh={grid:1,flex:1},Dh=function e(t,n,i,r){var s,a,o,l,u=parseFloat(i)||0,c=(i+"").trim().substr((u+"").length)||"px",h=Ic.style,d=Vc.test(n),p="svg"===t.tagName.toLowerCase(),f=(p?"client":"offset")+(d?"Width":"Height"),m=100,g="px"===r,v="%"===r;if(r===c||!u||bh[r]||bh[c])return u;if("px"!==c&&!g&&(u=e(t,n,i,"px")),l=t.getCTM&&vh(t),(v||"%"===c)&&(Lc[n]||~n.indexOf("adius")))return s=l?t.getBBox()[d?"width":"height"]:t[f],yl(v?u/s*m:u/100*s);if(h[d?"width":"height"]=m+(g?c:r),a="rem"!==r&&~n.indexOf("adius")||"em"===r&&t.appendChild&&!p?t:t.parentNode,l&&(a=(t.ownerSVGElement||{}).parentNode),a&&a!==Pc&&a.appendChild||(a=Pc.body),(o=a._gsap)&&v&&o.width&&d&&o.time===Tu.time&&!o.uncache)return yl(u/o.width*m);if(!v||"height"!==n&&"width"!==n)(v||"%"===c)&&!wh[ch(a,"display")]&&(h.position=ch(t,"position")),a===t&&(h.position="static"),a.appendChild(Ic),s=Ic[f],a.removeChild(Ic),h.position="absolute";else{var y=t.style[n];t.style[n]=m+r,s=t[f],y?t.style[n]=y:yh(t,n)}return d&&v&&((o=ml(a)).time=Tu.time,o.width=a[f]),yl(g?s*u/m:s&&u?m/s*u:0)},_h=function(e,t,n,i){var r;return Oc||ph(),t in Wc&&"transform"!==t&&~(t=Wc[t]).indexOf(",")&&(t=t.split(",")[0]),Lc[t]&&"transform"!==t?(r=Bh(e,i),r="transformOrigin"!==t?r[t]:r.svg?r.origin:Rh(ch(e,rh))+" "+r.zOrigin+"px"):(!(r=e.style[t])||"auto"===r||i||~(r+"").indexOf("calc("))&&(r=Mh[t]&&Mh[t](e,t,n)||ch(e,t)||gl(e,t)||("opacity"===t?1:0)),n&&!~(r+"").trim().indexOf(" ")?Dh(e,t,r,n)+n:r},Sh=function(e,t,n,i){if(!n||"none"===n){var r=dh(t,e,1),s=r&&ch(e,r,1);s&&s!==n?(t=r,n=s):"borderColor"===t&&(n=ch(e,"borderTopColor"))}var a,o,l,u,c,h,d,p,f,m,g,v=new mc(this._pt,e.style,t,0,1,uc),y=0,x=0;if(v.b=n,v.e=i,n+="","auto"===(i+="")&&(h=e.style[t],e.style[t]=i,i=ch(e,t)||i,h?e.style[t]=h:yh(e,t)),Mu(a=[n,i]),i=a[1],l=(n=a[0]).match(Go)||[],(i.match(Go)||[]).length){for(;o=Go.exec(i);)d=o[0],f=i.substring(y,o.index),c?c=(c+1)%5:"rgba("!==f.substr(-5)&&"hsla("!==f.substr(-5)||(c=1),d!==(h=l[x++]||"")&&(u=parseFloat(h)||0,g=h.substr((u+"").length),"="===d.charAt(1)&&(d=bl(u,d)+g),p=parseFloat(d),m=d.substr((p+"").length),y=Go.lastIndex-m.length,m||(m=m||_o.units[t]||g,y===i.length&&(i+=m,v.e+=m)),g!==m&&(u=Dh(e,t,h,m)||0),v._pt={_next:v._pt,p:f||1===x?f:",",s:u,c:p-u,m:c&&c<4||"zIndex"===t?Math.round:0});v.c=y<i.length?i.substring(y,i.length):""}else v.r="display"===t&&"none"===i?Kc:Qc;return Yo.test(i)&&(v.e=0),this._pt=v,v},Eh={top:"0%",bottom:"100%",left:"0%",right:"100%",center:"50%"},Ch=function(e){var t=e.split(" "),n=t[0],i=t[1]||"50%";return"top"!==n&&"bottom"!==n&&"left"!==i&&"right"!==i||(e=n,n=i,i=e),t[0]=Eh[n]||n,t[1]=Eh[i]||i,t.join(" ")},Ah=function(e,t){if(t.tween&&t.tween._time===t.tween._dur){var n,i,r,s=t.t,a=s.style,o=t.u,l=s._gsap;if("all"===o||!0===o)a.cssText="",i=1;else for(r=(o=o.split(",")).length;--r>-1;)n=o[r],Lc[n]&&(i=1,n="transformOrigin"===n?rh:ih),yh(s,n);i&&(yh(s,ih),l&&(l.svg&&s.removeAttribute("transform"),a.scale=a.rotate=a.translate="none",Bh(s,1),l.uncache=1,ah(a)))}},Mh={clearProps:function(e,t,n,i,r){if("isFromStart"!==r.data){var s=e._pt=new mc(e._pt,t,n,0,0,Ah);return s.u=i,s.pr=-10,s.tween=r,e._props.push(n),1}}},Th=[1,0,0,1,0,0],Ph={},Fh=function(e){return"matrix(1, 0, 0, 1, 0, 0)"===e||"none"===e||!e},Oh=function(e){var t=ch(e,ih);return Fh(t)?Th:t.substr(7).match(Wo).map(yl)},Ih=function(e,t){var n,i,r,s,a=e._gsap||ml(e),o=e.style,l=Oh(e);return a.svg&&e.getAttribute("transform")?"1,0,0,1,0,0"===(l=[(r=e.transform.baseVal.consolidate().matrix).a,r.b,r.c,r.d,r.e,r.f]).join(",")?Th:l:(l!==Th||e.offsetParent||e===Fc||a.svg||(r=o.display,o.display="block",(n=e.parentNode)&&(e.offsetParent||e.getBoundingClientRect().width)||(s=1,i=e.nextElementSibling,Fc.appendChild(e)),l=Oh(e),r?o.display=r:yh(e,"display"),s&&(i?n.insertBefore(e,i):n?n.appendChild(e):Fc.removeChild(e))),t&&l.length>6?[l[0],l[1],l[4],l[5],l[12],l[13]]:l)},kh=function(e,t,n,i,r,s){var a,o,l,u=e._gsap,c=r||Ih(e,!0),h=u.xOrigin||0,d=u.yOrigin||0,p=u.xOffset||0,f=u.yOffset||0,m=c[0],g=c[1],v=c[2],y=c[3],x=c[4],b=c[5],w=t.split(" "),D=parseFloat(w[0])||0,_=parseFloat(w[1])||0;n?c!==Th&&(o=m*y-g*v)&&(l=D*(-g/o)+_*(m/o)-(m*b-g*x)/o,D=D*(y/o)+_*(-v/o)+(v*b-y*x)/o,_=l):(D=(a=gh(e)).x+(~w[0].indexOf("%")?D/100*a.width:D),_=a.y+(~(w[1]||w[0]).indexOf("%")?_/100*a.height:_)),i||!1!==i&&u.smooth?(x=D-h,b=_-d,u.xOffset=p+(x*m+b*v)-x,u.yOffset=f+(x*g+b*y)-b):u.xOffset=u.yOffset=0,u.xOrigin=D,u.yOrigin=_,u.smooth=!!i,u.origin=t,u.originIsAbsolute=!!n,e.style[rh]="0px 0px",s&&(xh(s,u,"xOrigin",h,D),xh(s,u,"yOrigin",d,_),xh(s,u,"xOffset",p,u.xOffset),xh(s,u,"yOffset",f,u.yOffset)),e.setAttribute("data-svg-origin",D+" "+_)},Bh=function(e,t){var n=e._gsap||new Vu(e);if("x"in n&&!t&&!n.uncache)return n;var i,r,s,a,o,l,u,c,h,d,p,f,m,g,v,y,x,b,w,D,_,S,E,C,A,M,T,P,F,O,I,k,B=e.style,R=n.scaleX<0,L="px",z="deg",N=getComputedStyle(e),j=ch(e,rh)||"0";return i=r=s=l=u=c=h=d=p=0,a=o=1,n.svg=!(!e.getCTM||!vh(e)),N.translate&&("none"===N.translate&&"none"===N.scale&&"none"===N.rotate||(B[ih]=("none"!==N.translate?"translate3d("+(N.translate+" 0 0").split(" ").slice(0,3).join(", ")+") ":"")+("none"!==N.rotate?"rotate("+N.rotate+") ":"")+("none"!==N.scale?"scale("+N.scale.split(" ").join(",")+") ":"")+("none"!==N[ih]?N[ih]:"")),B.scale=B.rotate=B.translate="none"),g=Ih(e,n.svg),n.svg&&(n.uncache?(A=e.getBBox(),j=n.xOrigin-A.x+"px "+(n.yOrigin-A.y)+"px",C=""):C=!t&&e.getAttribute("data-svg-origin"),kh(e,C||j,!!C||n.originIsAbsolute,!1!==n.smooth,g)),f=n.xOrigin||0,m=n.yOrigin||0,g!==Th&&(b=g[0],w=g[1],D=g[2],_=g[3],i=S=g[4],r=E=g[5],6===g.length?(a=Math.sqrt(b*b+w*w),o=Math.sqrt(_*_+D*D),l=b||w?jc(w,b)*zc:0,(h=D||_?jc(D,_)*zc+l:0)&&(o*=Math.abs(Math.cos(h*Nc))),n.svg&&(i-=f-(f*b+m*D),r-=m-(f*w+m*_))):(k=g[6],O=g[7],T=g[8],P=g[9],F=g[10],I=g[11],i=g[12],r=g[13],s=g[14],u=(v=jc(k,F))*zc,v&&(C=S*(y=Math.cos(-v))+T*(x=Math.sin(-v)),A=E*y+P*x,M=k*y+F*x,T=S*-x+T*y,P=E*-x+P*y,F=k*-x+F*y,I=O*-x+I*y,S=C,E=A,k=M),c=(v=jc(-D,F))*zc,v&&(y=Math.cos(-v),I=_*(x=Math.sin(-v))+I*y,b=C=b*y-T*x,w=A=w*y-P*x,D=M=D*y-F*x),l=(v=jc(w,b))*zc,v&&(C=b*(y=Math.cos(v))+w*(x=Math.sin(v)),A=S*y+E*x,w=w*y-b*x,E=E*y-S*x,b=C,S=A),u&&Math.abs(u)+Math.abs(l)>359.9&&(u=l=0,c=180-c),a=yl(Math.sqrt(b*b+w*w+D*D)),o=yl(Math.sqrt(E*E+k*k)),v=jc(S,E),h=Math.abs(v)>2e-4?v*zc:0,p=I?1/(I<0?-I:I):0),n.svg&&(C=e.getAttribute("transform"),n.forceCSS=e.setAttribute("transform","")||!Fh(ch(e,ih)),C&&e.setAttribute("transform",C))),Math.abs(h)>90&&Math.abs(h)<270&&(R?(a*=-1,h+=l<=0?180:-180,l+=l<=0?180:-180):(o*=-1,h+=h<=0?180:-180)),t=t||n.uncache,n.x=i-((n.xPercent=i&&(!t&&n.xPercent||(Math.round(e.offsetWidth/2)===Math.round(-i)?-50:0)))?e.offsetWidth*n.xPercent/100:0)+L,n.y=r-((n.yPercent=r&&(!t&&n.yPercent||(Math.round(e.offsetHeight/2)===Math.round(-r)?-50:0)))?e.offsetHeight*n.yPercent/100:0)+L,n.z=s+L,n.scaleX=yl(a),n.scaleY=yl(o),n.rotation=yl(l)+z,n.rotationX=yl(u)+z,n.rotationY=yl(c)+z,n.skewX=h+z,n.skewY=d+z,n.transformPerspective=p+L,(n.zOrigin=parseFloat(j.split(" ")[2])||!t&&n.zOrigin||0)&&(B[rh]=Rh(j)),n.xOffset=n.yOffset=0,n.force3D=_o.force3D,n.renderTransform=n.svg?Hh:Rc?Vh:zh,n.uncache=0,n},Rh=function(e){return(e=e.split(" "))[0]+" "+e[1]},Lh=function(e,t,n){var i=tu(t);return yl(parseFloat(t)+parseFloat(Dh(e,"x",n+"px",i)))+i},zh=function(e,t){t.z="0px",t.rotationY=t.rotationX="0deg",t.force3D=0,Vh(e,t)},Nh="0deg",jh="0px",Uh=") ",Vh=function(e,t){var n=t||this,i=n.xPercent,r=n.yPercent,s=n.x,a=n.y,o=n.z,l=n.rotation,u=n.rotationY,c=n.rotationX,h=n.skewX,d=n.skewY,p=n.scaleX,f=n.scaleY,m=n.transformPerspective,g=n.force3D,v=n.target,y=n.zOrigin,x="",b="auto"===g&&e&&1!==e||!0===g;if(y&&(c!==Nh||u!==Nh)){var w,D=parseFloat(u)*Nc,_=Math.sin(D),S=Math.cos(D);D=parseFloat(c)*Nc,w=Math.cos(D),s=Lh(v,s,_*w*-y),a=Lh(v,a,-Math.sin(D)*-y),o=Lh(v,o,S*w*-y+y)}m!==jh&&(x+="perspective("+m+Uh),(i||r)&&(x+="translate("+i+"%, "+r+"%) "),(b||s!==jh||a!==jh||o!==jh)&&(x+=o!==jh||b?"translate3d("+s+", "+a+", "+o+") ":"translate("+s+", "+a+Uh),l!==Nh&&(x+="rotate("+l+Uh),u!==Nh&&(x+="rotateY("+u+Uh),c!==Nh&&(x+="rotateX("+c+Uh),h===Nh&&d===Nh||(x+="skew("+h+", "+d+Uh),1===p&&1===f||(x+="scale("+p+", "+f+Uh),v.style[ih]=x||"translate(0, 0)"},Hh=function(e,t){var n,i,r,s,a,o=t||this,l=o.xPercent,u=o.yPercent,c=o.x,h=o.y,d=o.rotation,p=o.skewX,f=o.skewY,m=o.scaleX,g=o.scaleY,v=o.target,y=o.xOrigin,x=o.yOrigin,b=o.xOffset,w=o.yOffset,D=o.forceCSS,_=parseFloat(c),S=parseFloat(h);d=parseFloat(d),p=parseFloat(p),(f=parseFloat(f))&&(p+=f=parseFloat(f),d+=f),d||p?(d*=Nc,p*=Nc,n=Math.cos(d)*m,i=Math.sin(d)*m,r=Math.sin(d-p)*-g,s=Math.cos(d-p)*g,p&&(f*=Nc,a=Math.tan(p-f),r*=a=Math.sqrt(1+a*a),s*=a,f&&(a=Math.tan(f),n*=a=Math.sqrt(1+a*a),i*=a)),n=yl(n),i=yl(i),r=yl(r),s=yl(s)):(n=m,s=g,i=r=0),(_&&!~(c+"").indexOf("px")||S&&!~(h+"").indexOf("px"))&&(_=Dh(v,"x",c,"px"),S=Dh(v,"y",h,"px")),(y||x||b||w)&&(_=yl(_+y-(y*n+x*r)+b),S=yl(S+x-(y*i+x*s)+w)),(l||u)&&(a=v.getBBox(),_=yl(_+l/100*a.width),S=yl(S+u/100*a.height)),a="matrix("+n+","+i+","+r+","+s+","+_+","+S+")",v.setAttribute("transform",a),D&&(v.style[ih]=a)},Wh=function(e,t,n,i,r){var s,a,o=360,l=Io(r),u=parseFloat(r)*(l&&~r.indexOf("rad")?zc:1)-i,c=i+u+"deg";return l&&("short"===(s=r.split("_")[1])&&(u%=o)!==u%180&&(u+=u<0?o:-360),"cw"===s&&u<0?u=(u+36e9)%o-~~(u/o)*o:"ccw"===s&&u>0&&(u=(u-36e9)%o-~~(u/o)*o)),e._pt=a=new mc(e._pt,t,n,i,u,qc),a.e=c,a.u="deg",e._props.push(n),a},Gh=function(e,t){for(var n in t)e[n]=t[n];return e},qh=function(e,t,n){var i,r,s,a,o,l,u,c=Gh({},n._gsap),h=n.style;for(r in c.svg?(s=n.getAttribute("transform"),n.setAttribute("transform",""),h[ih]=t,i=Bh(n,1),yh(n,ih),n.setAttribute("transform",s)):(s=getComputedStyle(n)[ih],h[ih]=t,i=Bh(n,1),h[ih]=s),Lc)(s=c[r])!==(a=i[r])&&"perspective,force3D,transformOrigin,svgOrigin".indexOf(r)<0&&(o=tu(s)!==(u=tu(a))?Dh(n,r,s,u):parseFloat(s),l=parseFloat(a),e._pt=new mc(e._pt,i,r,o,l-o,Gc),e._pt.u=u||0,e._props.push(r));Gh(i,c)};vl("padding,margin,Width,Radius",(function(e,t){var n="Top",i="Right",r="Bottom",s="Left",a=(t<3?[n,i,r,s]:[n+s,n+i,r+i,r+s]).map((function(n){return t<2?e+n:"border"+n+e}));Mh[t>1?"border"+e:e]=function(e,t,n,i,r){var s,o;if(arguments.length<4)return s=a.map((function(t){return _h(e,t,n)})),5===(o=s.join(" ")).split(s[0]).length?s[0]:o;s=(i+"").split(" "),o={},a.forEach((function(e,t){return o[e]=s[t]=s[t]||s[(t-1)/2|0]})),e.init(t,o,r)}}));var Yh={name:"css",register:ph,targetTest:function(e){return e.style&&e.nodeType},init:function(e,t,n,i,r){var s,a,o,l,u,c,h,d,p,f,m,g,v,y,x,b,w=this._props,D=e.style,_=n.vars.startAt;for(h in Oc||ph(),this.styles=this.styles||lh(e),b=this.styles.props,this.tween=n,t)if("autoRound"!==h&&(a=t[h],!ul[h]||!Qu(h,t,n,i,e,r)))if(u=typeof a,c=Mh[h],"function"===u&&(u=typeof(a=a.call(n,i,e,r))),"string"===u&&~a.indexOf("random(")&&(a=pu(a)),c)c(this,e,h,a,n)&&(x=1);else if("--"===h.substr(0,2))s=(getComputedStyle(e).getPropertyValue(h)+"").trim(),a+="",Cu.lastIndex=0,Cu.test(s)||(d=tu(s),p=tu(a)),p?d!==p&&(s=Dh(e,h,s,p)+p):d&&(a+=d),this.add(D,"setProperty",s,a,i,r,0,0,h),w.push(h),b.push(h,0,D[h]);else if("undefined"!==u){if(_&&h in _?(s="function"===typeof _[h]?_[h].call(n,i,e,r):_[h],Io(s)&&~s.indexOf("random(")&&(s=pu(s)),tu(s+"")||"auto"===s||(s+=_o.units[h]||tu(_h(e,h))||""),"="===(s+"").charAt(1)&&(s=_h(e,h))):s=_h(e,h),l=parseFloat(s),(f="string"===u&&"="===a.charAt(1)&&a.substr(0,2))&&(a=a.substr(2)),o=parseFloat(a),h in Wc&&("autoAlpha"===h&&(1===l&&"hidden"===_h(e,"visibility")&&o&&(l=0),b.push("visibility",0,D.visibility),xh(this,D,"visibility",l?"inherit":"hidden",o?"inherit":"hidden",!o)),"scale"!==h&&"transform"!==h&&~(h=Wc[h]).indexOf(",")&&(h=h.split(",")[0])),m=h in Lc)if(this.styles.save(h),g||((v=e._gsap).renderTransform&&!t.parseTransform||Bh(e,t.parseTransform),y=!1!==t.smoothOrigin&&v.smooth,(g=this._pt=new mc(this._pt,D,ih,0,1,v.renderTransform,v,0,-1)).dep=1),"scale"===h)this._pt=new mc(this._pt,v,"scaleY",v.scaleY,(f?bl(v.scaleY,f+o):o)-v.scaleY||0,Gc),this._pt.u=0,w.push("scaleY",h),h+="X";else{if("transformOrigin"===h){b.push(rh,0,D[rh]),a=Ch(a),v.svg?kh(e,a,0,y,0,this):((p=parseFloat(a.split(" ")[2])||0)!==v.zOrigin&&xh(this,v,"zOrigin",v.zOrigin,p),xh(this,D,h,Rh(s),Rh(a)));continue}if("svgOrigin"===h){kh(e,a,1,y,0,this);continue}if(h in Ph){Wh(this,v,h,l,f?bl(l,f+a):a);continue}if("smoothOrigin"===h){xh(this,v,"smooth",v.smooth,a);continue}if("force3D"===h){v[h]=a;continue}if("transform"===h){qh(this,a,e);continue}}else h in D||(h=dh(h)||h);if(m||(o||0===o)&&(l||0===l)&&!Hc.test(a)&&h in D)o||(o=0),(d=(s+"").substr((l+"").length))!==(p=tu(a)||(h in _o.units?_o.units[h]:d))&&(l=Dh(e,h,s,p)),this._pt=new mc(this._pt,m?v:D,h,l,(f?bl(l,f+o):o)-l,m||"px"!==p&&"zIndex"!==h||!1===t.autoRound?Gc:Xc),this._pt.u=p||0,d!==p&&"%"!==p&&(this._pt.b=s,this._pt.r=Yc);else if(h in D)Sh.call(this,e,h,s,f?f+a:a);else if(h in e)this.add(e,h,s||e[h],f?f+a:a,i,r);else if("parseTransform"!==h){$o(h,a);continue}m||(h in D?b.push(h,0,D[h]):"function"===typeof e[h]?b.push(h,2,e[h]()):b.push(h,1,s||e[h])),w.push(h)}x&&fc(this)},render:function(e,t){if(t.tween._time||!Bc())for(var n=t._pt;n;)n.r(e,n.d),n=n._next;else t.styles.revert()},get:_h,aliases:Wc,getSetter:function(e,t,n){var i=Wc[t];return i&&i.indexOf(",")<0&&(t=i),t in Lc&&t!==rh&&(e._gsap.x||_h(e,"x"))?n&&kc===n?"scale"===t?eh:$c:(kc=n||{})&&("scale"===t?th:nh):e.style&&!Ro(e.style[t])?Zc:~t.indexOf("-")?Jc:ac(e,t)},core:{_removeProperty:yh,_getMatrix:Ih}};Mc.utils.checkPrefix=dh,Mc.core.getStyleSaver=lh,function(e,t){var n=vl(e+","+t+",transform,transformOrigin,svgOrigin,force3D,smoothOrigin,transformPerspective",(function(e){Lc[e]=1}));vl(t,(function(e){_o.units[e]="deg",Ph[e]=1})),Wc[n[13]]=e+","+t,vl("0:translateX,1:translateY,2:translateZ,8:rotate,8:rotationZ,8:rotateZ,9:rotateX,10:rotateY",(function(e){var t=e.split(":");Wc[t[1]]=n[t[0]]}))}("x,y,z,scale,scaleX,scaleY,xPercent,yPercent","rotation,rotationX,rotationY,skewX,skewY"),vl("x,y,z,top,right,bottom,left,width,height,fontSize,padding,margin,perspective",(function(e){_o.units[e]="px"})),Mc.registerPlugin(Yh);var Xh=Mc.registerPlugin(Yh)||Mc;Xh.core.Tween;function Qh(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var Kh,Zh,Jh,$h,ed,td,nd,id,rd,sd,ad,od,ld,ud=function(){return Kh||"undefined"!==typeof window&&(Kh=window.gsap)&&Kh.registerPlugin&&Kh},cd=1,hd=[],dd=[],pd=[],fd=Date.now,md=function(e,t){return t},gd=function(e,t){return~pd.indexOf(e)&&pd[pd.indexOf(e)+1][t]},vd=function(e){return!!~sd.indexOf(e)},yd=function(e,t,n,i,r){return e.addEventListener(t,n,{passive:!1!==i,capture:!!r})},xd=function(e,t,n,i){return e.removeEventListener(t,n,!!i)},bd="scrollLeft",wd="scrollTop",Dd=function(){return ad&&ad.isPressed||dd.cache++},_d=function(e,t){var n=function n(i){if(i||0===i){cd&&(Jh.history.scrollRestoration="manual");var r=ad&&ad.isPressed;i=n.v=Math.round(i)||(ad&&ad.iOS?1:0),e(i),n.cacheID=dd.cache,r&&md("ss",i)}else(t||dd.cache!==n.cacheID||md("ref"))&&(n.cacheID=dd.cache,n.v=e());return n.v+n.offset};return n.offset=0,e&&n},Sd={s:bd,p:"left",p2:"Left",os:"right",os2:"Right",d:"width",d2:"Width",a:"x",sc:_d((function(e){return arguments.length?Jh.scrollTo(e,Ed.sc()):Jh.pageXOffset||$h[bd]||ed[bd]||td[bd]||0}))},Ed={s:wd,p:"top",p2:"Top",os:"bottom",os2:"Bottom",d:"height",d2:"Height",a:"y",op:Sd,sc:_d((function(e){return arguments.length?Jh.scrollTo(Sd.sc(),e):Jh.pageYOffset||$h[wd]||ed[wd]||td[wd]||0}))},Cd=function(e,t){return(t&&t._ctx&&t._ctx.selector||Kh.utils.toArray)(e)[0]||("string"===typeof e&&!1!==Kh.config().nullTargetWarn?console.warn("Element not found:",e):null)},Ad=function(e,t){var n=t.s,i=t.sc;vd(e)&&(e=$h.scrollingElement||ed);var r=dd.indexOf(e),s=i===Ed.sc?1:2;!~r&&(r=dd.push(e)-1),dd[r+s]||yd(e,"scroll",Dd);var a=dd[r+s],o=a||(dd[r+s]=_d(gd(e,n),!0)||(vd(e)?i:_d((function(t){return arguments.length?e[n]=t:e[n]}))));return o.target=e,a||(o.smooth="smooth"===Kh.getProperty(e,"scrollBehavior")),o},Md=function(e,t,n){var i=e,r=e,s=fd(),a=s,o=t||50,l=Math.max(500,3*o),u=function(e,t){var l=fd();t||l-s>o?(r=i,i=e,a=s,s=l):n?i+=e:i=r+(e-r)/(l-a)*(s-a)};return{update:u,reset:function(){r=i=n?0:i,a=s=0},getVelocity:function(e){var t=a,o=r,c=fd();return(e||0===e)&&e!==i&&u(e),s===a||c-a>l?0:(i+(n?o:-o))/((n?c:s)-t)*1e3}}},Td=function(e,t){return t&&!e._gsapAllow&&e.preventDefault(),e.changedTouches?e.changedTouches[0]:e},Pd=function(e){var t=Math.max.apply(Math,e),n=Math.min.apply(Math,e);return Math.abs(t)>=Math.abs(n)?t:n},Fd=function(){(rd=Kh.core.globals().ScrollTrigger)&&rd.core&&function(){var e=rd.core,t=e.bridge||{},n=e._scrollers,i=e._proxies;n.push.apply(n,dd),i.push.apply(i,pd),dd=n,pd=i,md=function(e,n){return t[e](n)}}()},Od=function(e){return Kh=e||ud(),!Zh&&Kh&&"undefined"!==typeof document&&document.body&&(Jh=window,$h=document,ed=$h.documentElement,td=$h.body,sd=[Jh,$h,ed,td],Kh.utils.clamp,ld=Kh.core.context||function(){},id="onpointerenter"in td?"pointer":"mouse",nd=Id.isTouch=Jh.matchMedia&&Jh.matchMedia("(hover: none), (pointer: coarse)").matches?1:"ontouchstart"in Jh||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0?2:0,od=Id.eventTypes=("ontouchstart"in ed?"touchstart,touchmove,touchcancel,touchend":"onpointerdown"in ed?"pointerdown,pointermove,pointercancel,pointerup":"mousedown,mousemove,mouseup,mouseup").split(","),setTimeout((function(){return cd=0}),500),Fd(),Zh=1),Zh};Sd.op=Ed,dd.cache=0;var Id=function(){function e(e){this.init(e)}var t,n,i;return e.prototype.init=function(e){Zh||Od(Kh)||console.warn("Please gsap.registerPlugin(Observer)"),rd||Fd();var t=e.tolerance,n=e.dragMinimum,i=e.type,r=e.target,s=e.lineHeight,a=e.debounce,o=e.preventDefault,l=e.onStop,u=e.onStopDelay,c=e.ignore,h=e.wheelSpeed,d=e.event,p=e.onDragStart,f=e.onDragEnd,m=e.onDrag,g=e.onPress,v=e.onRelease,y=e.onRight,x=e.onLeft,b=e.onUp,w=e.onDown,D=e.onChangeX,_=e.onChangeY,S=e.onChange,E=e.onToggleX,C=e.onToggleY,A=e.onHover,M=e.onHoverEnd,T=e.onMove,P=e.ignoreCheck,F=e.isNormalizer,O=e.onGestureStart,I=e.onGestureEnd,k=e.onWheel,B=e.onEnable,R=e.onDisable,L=e.onClick,z=e.scrollSpeed,N=e.capture,j=e.allowClicks,U=e.lockAxis,V=e.onLockAxis;this.target=r=Cd(r)||ed,this.vars=e,c&&(c=Kh.utils.toArray(c)),t=t||1e-9,n=n||0,h=h||1,z=z||1,i=i||"wheel,touch,pointer",a=!1!==a,s||(s=parseFloat(Jh.getComputedStyle(td).lineHeight)||22);var H,W,G,q,Y,X,Q,K=this,Z=0,J=0,$=e.passive||!o&&!1!==e.passive,ee=Ad(r,Sd),te=Ad(r,Ed),ne=ee(),ie=te(),re=~i.indexOf("touch")&&!~i.indexOf("pointer")&&"pointerdown"===od[0],se=vd(r),ae=r.ownerDocument||$h,oe=[0,0,0],le=[0,0,0],ue=0,ce=function(){return ue=fd()},he=function(e,t){return(K.event=e)&&c&&~c.indexOf(e.target)||t&&re&&"touch"!==e.pointerType||P&&P(e,t)},de=function(){var e=K.deltaX=Pd(oe),n=K.deltaY=Pd(le),i=Math.abs(e)>=t,r=Math.abs(n)>=t;S&&(i||r)&&S(K,e,n,oe,le),i&&(y&&K.deltaX>0&&y(K),x&&K.deltaX<0&&x(K),D&&D(K),E&&K.deltaX<0!==Z<0&&E(K),Z=K.deltaX,oe[0]=oe[1]=oe[2]=0),r&&(w&&K.deltaY>0&&w(K),b&&K.deltaY<0&&b(K),_&&_(K),C&&K.deltaY<0!==J<0&&C(K),J=K.deltaY,le[0]=le[1]=le[2]=0),(q||G)&&(T&&T(K),G&&(p&&1===G&&p(K),m&&m(K),G=0),q=!1),X&&!(X=!1)&&V&&V(K),Y&&(k(K),Y=!1),H=0},pe=function(e,t,n){oe[n]+=e,le[n]+=t,K._vx.update(e),K._vy.update(t),a?H||(H=requestAnimationFrame(de)):de()},fe=function(e,t){U&&!Q&&(K.axis=Q=Math.abs(e)>Math.abs(t)?"x":"y",X=!0),"y"!==Q&&(oe[2]+=e,K._vx.update(e,!0)),"x"!==Q&&(le[2]+=t,K._vy.update(t,!0)),a?H||(H=requestAnimationFrame(de)):de()},me=function(e){if(!he(e,1)){var t=(e=Td(e,o)).clientX,i=e.clientY,r=t-K.x,s=i-K.y,a=K.isDragging;K.x=t,K.y=i,(a||(r||s)&&(Math.abs(K.startX-t)>=n||Math.abs(K.startY-i)>=n))&&(G=a?2:1,a||(K.isDragging=!0),fe(r,s))}},ge=K.onPress=function(e){he(e,1)||e&&e.button||(K.axis=Q=null,W.pause(),K.isPressed=!0,e=Td(e),Z=J=0,K.startX=K.x=e.clientX,K.startY=K.y=e.clientY,K._vx.reset(),K._vy.reset(),yd(F?r:ae,od[1],me,$,!0),K.deltaX=K.deltaY=0,g&&g(K))},ve=K.onRelease=function(e){if(!he(e,1)){xd(F?r:ae,od[1],me,!0);var t=!isNaN(K.y-K.startY),n=K.isDragging,i=n&&(Math.abs(K.x-K.startX)>3||Math.abs(K.y-K.startY)>3),s=Td(e);!i&&t&&(K._vx.reset(),K._vy.reset(),o&&j&&Kh.delayedCall(.08,(function(){if(fd()-ue>300&&!e.defaultPrevented)if(e.target.click)e.target.click();else if(ae.createEvent){var t=ae.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,Jh,1,s.screenX,s.screenY,s.clientX,s.clientY,!1,!1,!1,!1,0,null),e.target.dispatchEvent(t)}}))),K.isDragging=K.isGesturing=K.isPressed=!1,l&&n&&!F&&W.restart(!0),G&&de(),f&&n&&f(K),v&&v(K,i)}},ye=function(e){return e.touches&&e.touches.length>1&&(K.isGesturing=!0)&&O(e,K.isDragging)},xe=function(){return(K.isGesturing=!1)||I(K)},be=function(e){if(!he(e)){var t=ee(),n=te();pe((t-ne)*z,(n-ie)*z,1),ne=t,ie=n,l&&W.restart(!0)}},we=function(e){if(!he(e)){e=Td(e,o),k&&(Y=!0);var t=(1===e.deltaMode?s:2===e.deltaMode?Jh.innerHeight:1)*h;pe(e.deltaX*t,e.deltaY*t,0),l&&!F&&W.restart(!0)}},De=function(e){if(!he(e)){var t=e.clientX,n=e.clientY,i=t-K.x,r=n-K.y;K.x=t,K.y=n,q=!0,l&&W.restart(!0),(i||r)&&fe(i,r)}},_e=function(e){K.event=e,A(K)},Se=function(e){K.event=e,M(K)},Ee=function(e){return he(e)||Td(e,o)&&L(K)};W=K._dc=Kh.delayedCall(u||.25,(function(){K._vx.reset(),K._vy.reset(),W.pause(),l&&l(K)})).pause(),K.deltaX=K.deltaY=0,K._vx=Md(0,50,!0),K._vy=Md(0,50,!0),K.scrollX=ee,K.scrollY=te,K.isDragging=K.isGesturing=K.isPressed=!1,ld(this),K.enable=function(e){return K.isEnabled||(yd(se?ae:r,"scroll",Dd),i.indexOf("scroll")>=0&&yd(se?ae:r,"scroll",be,$,N),i.indexOf("wheel")>=0&&yd(r,"wheel",we,$,N),(i.indexOf("touch")>=0&&nd||i.indexOf("pointer")>=0)&&(yd(r,od[0],ge,$,N),yd(ae,od[2],ve),yd(ae,od[3],ve),j&&yd(r,"click",ce,!0,!0),L&&yd(r,"click",Ee),O&&yd(ae,"gesturestart",ye),I&&yd(ae,"gestureend",xe),A&&yd(r,id+"enter",_e),M&&yd(r,id+"leave",Se),T&&yd(r,id+"move",De)),K.isEnabled=!0,K.isDragging=K.isGesturing=K.isPressed=q=G=!1,K._vx.reset(),K._vy.reset(),ne=ee(),ie=te(),e&&e.type&&ge(e),B&&B(K)),K},K.disable=function(){K.isEnabled&&(hd.filter((function(e){return e!==K&&vd(e.target)})).length||xd(se?ae:r,"scroll",Dd),K.isPressed&&(K._vx.reset(),K._vy.reset(),xd(F?r:ae,od[1],me,!0)),xd(se?ae:r,"scroll",be,N),xd(r,"wheel",we,N),xd(r,od[0],ge,N),xd(ae,od[2],ve),xd(ae,od[3],ve),xd(r,"click",ce,!0),xd(r,"click",Ee),xd(ae,"gesturestart",ye),xd(ae,"gestureend",xe),xd(r,id+"enter",_e),xd(r,id+"leave",Se),xd(r,id+"move",De),K.isEnabled=K.isPressed=K.isDragging=!1,R&&R(K))},K.kill=K.revert=function(){K.disable();var e=hd.indexOf(K);e>=0&&hd.splice(e,1),ad===K&&(ad=0)},hd.push(K),F&&vd(r)&&(ad=K),K.enable(d)},t=e,(n=[{key:"velocityX",get:function(){return this._vx.getVelocity()}},{key:"velocityY",get:function(){return this._vy.getVelocity()}}])&&Qh(t.prototype,n),i&&Qh(t,i),e}();Id.version="3.12.7",Id.create=function(e){return new Id(e)},Id.register=Od,Id.getAll=function(){return hd.slice()},Id.getById=function(e){return hd.filter((function(t){return t.vars.id===e}))[0]},ud()&&Kh.registerPlugin(Id);var kd,Bd,Rd,Ld,zd,Nd,jd,Ud,Vd,Hd,Wd,Gd,qd,Yd,Xd,Qd,Kd,Zd,Jd,$d,ep,tp,np,ip,rp,sp,ap,op,lp,up,cp,hp,dp,pp,fp,mp,gp,vp,yp=1,xp=Date.now,bp=xp(),wp=0,Dp=0,_p=function(e,t,n){var i=Lp(e)&&("clamp("===e.substr(0,6)||e.indexOf("max")>-1);return n["_"+t+"Clamp"]=i,i?e.substr(6,e.length-7):e},Sp=function(e,t){return!t||Lp(e)&&"clamp("===e.substr(0,6)?e:"clamp("+e+")"},Ep=function e(){return Dp&&requestAnimationFrame(e)},Cp=function(){return Yd=1},Ap=function(){return Yd=0},Mp=function(e){return e},Tp=function(e){return Math.round(1e5*e)/1e5||0},Pp=function(){return"undefined"!==typeof window},Fp=function(){return kd||Pp()&&(kd=window.gsap)&&kd.registerPlugin&&kd},Op=function(e){return!!~jd.indexOf(e)},Ip=function(e){return("Height"===e?cp:Rd["inner"+e])||zd["client"+e]||Nd["client"+e]},kp=function(e){return gd(e,"getBoundingClientRect")||(Op(e)?function(){return Xf.width=Rd.innerWidth,Xf.height=cp,Xf}:function(){return of(e)})},Bp=function(e,t){var n=t.s,i=t.d2,r=t.d,s=t.a;return Math.max(0,(n="scroll"+i)&&(s=gd(e,n))?s()-kp(e)()[r]:Op(e)?(zd[n]||Nd[n])-Ip(i):e[n]-e["offset"+i])},Rp=function(e,t){for(var n=0;n<Jd.length;n+=3)(!t||~t.indexOf(Jd[n+1]))&&e(Jd[n],Jd[n+1],Jd[n+2])},Lp=function(e){return"string"===typeof e},zp=function(e){return"function"===typeof e},Np=function(e){return"number"===typeof e},jp=function(e){return"object"===typeof e},Up=function(e,t,n){return e&&e.progress(t?0:1)&&n&&e.pause()},Vp=function(e,t){if(e.enabled){var n=e._ctx?e._ctx.add((function(){return t(e)})):t(e);n&&n.totalTime&&(e.callbackAnimation=n)}},Hp=Math.abs,Wp="left",Gp="right",qp="bottom",Yp="width",Xp="height",Qp="Right",Kp="Left",Zp="Top",Jp="Bottom",$p="padding",ef="margin",tf="Width",nf="Height",rf="px",sf=function(e){return Rd.getComputedStyle(e)},af=function(e,t){for(var n in t)n in e||(e[n]=t[n]);return e},of=function(e,t){var n=t&&"matrix(1, 0, 0, 1, 0, 0)"!==sf(e)[Xd]&&kd.to(e,{x:0,y:0,xPercent:0,yPercent:0,rotation:0,rotationX:0,rotationY:0,scale:1,skewX:0,skewY:0}).progress(1),i=e.getBoundingClientRect();return n&&n.progress(0).kill(),i},lf=function(e,t){var n=t.d2;return e["offset"+n]||e["client"+n]||0},uf=function(e){var t,n=[],i=e.labels,r=e.duration();for(t in i)n.push(i[t]/r);return n},cf=function(e){var t=kd.utils.snap(e),n=Array.isArray(e)&&e.slice(0).sort((function(e,t){return e-t}));return n?function(e,i,r){var s;if(void 0===r&&(r=.001),!i)return t(e);if(i>0){for(e-=r,s=0;s<n.length;s++)if(n[s]>=e)return n[s];return n[s-1]}for(s=n.length,e+=r;s--;)if(n[s]<=e)return n[s];return n[0]}:function(n,i,r){void 0===r&&(r=.001);var s=t(n);return!i||Math.abs(s-n)<r||s-n<0===i<0?s:t(i<0?n-e:n+e)}},hf=function(e,t,n,i){return n.split(",").forEach((function(n){return e(t,n,i)}))},df=function(e,t,n,i,r){return e.addEventListener(t,n,{passive:!i,capture:!!r})},pf=function(e,t,n,i){return e.removeEventListener(t,n,!!i)},ff=function(e,t,n){(n=n&&n.wheelHandler)&&(e(t,"wheel",n),e(t,"touchmove",n))},mf={startColor:"green",endColor:"red",indent:0,fontSize:"16px",fontWeight:"normal"},gf={toggleActions:"play",anticipatePin:0},vf={top:0,left:0,center:.5,bottom:1,right:1},yf=function(e,t){if(Lp(e)){var n=e.indexOf("="),i=~n?+(e.charAt(n-1)+1)*parseFloat(e.substr(n+1)):0;~n&&(e.indexOf("%")>n&&(i*=t/100),e=e.substr(0,n-1)),e=i+(e in vf?vf[e]*t:~e.indexOf("%")?parseFloat(e)*t/100:parseFloat(e)||0)}return e},xf=function(e,t,n,i,r,s,a,o){var l=r.startColor,u=r.endColor,c=r.fontSize,h=r.indent,d=r.fontWeight,p=Ld.createElement("div"),f=Op(n)||"fixed"===gd(n,"pinType"),m=-1!==e.indexOf("scroller"),g=f?Nd:n,v=-1!==e.indexOf("start"),y=v?l:u,x="border-color:"+y+";font-size:"+c+";color:"+y+";font-weight:"+d+";pointer-events:none;white-space:nowrap;font-family:sans-serif,Arial;z-index:1000;padding:4px 8px;border-width:0;border-style:solid;";return x+="position:"+((m||o)&&f?"fixed;":"absolute;"),(m||o||!f)&&(x+=(i===Ed?Gp:qp)+":"+(s+parseFloat(h))+"px;"),a&&(x+="box-sizing:border-box;text-align:left;width:"+a.offsetWidth+"px;"),p._isStart=v,p.setAttribute("class","gsap-marker-"+e+(t?" marker-"+t:"")),p.style.cssText=x,p.innerText=t||0===t?e+"-"+t:e,g.children[0]?g.insertBefore(p,g.children[0]):g.appendChild(p),p._offset=p["offset"+i.op.d2],bf(p,0,i,v),p},bf=function(e,t,n,i){var r={display:"block"},s=n[i?"os2":"p2"],a=n[i?"p2":"os2"];e._isFlipped=i,r[n.a+"Percent"]=i?-100:0,r[n.a]=i?"1px":0,r["border"+s+tf]=1,r["border"+a+tf]=0,r[n.p]=t+"px",kd.set(e,r)},wf=[],Df={},_f=function(){return xp()-wp>34&&(fp||(fp=requestAnimationFrame(Uf)))},Sf=function(){(!np||!np.isPressed||np.startX>Nd.clientWidth)&&(dd.cache++,np?fp||(fp=requestAnimationFrame(Uf)):Uf(),wp||Pf("scrollStart"),wp=xp())},Ef=function(){sp=Rd.innerWidth,rp=Rd.innerHeight},Cf=function(e){dd.cache++,(!0===e||!qd&&!tp&&!Ld.fullscreenElement&&!Ld.webkitFullscreenElement&&(!ip||sp!==Rd.innerWidth||Math.abs(Rd.innerHeight-rp)>.25*Rd.innerHeight))&&Ud.restart(!0)},Af={},Mf=[],Tf=function e(){return pf(tm,"scrollEnd",e)||zf(!0)},Pf=function(e){return Af[e]&&Af[e].map((function(e){return e()}))||Mf},Ff=[],Of=function(e){for(var t=0;t<Ff.length;t+=5)(!e||Ff[t+4]&&Ff[t+4].query===e)&&(Ff[t].style.cssText=Ff[t+1],Ff[t].getBBox&&Ff[t].setAttribute("transform",Ff[t+2]||""),Ff[t+3].uncache=1)},If=function(e,t){var n;for(Qd=0;Qd<wf.length;Qd++)!(n=wf[Qd])||t&&n._ctx!==t||(e?n.kill(1):n.revert(!0,!0));hp=!0,t&&Of(t),t||Pf("revert")},kf=function(e,t){dd.cache++,(t||!mp)&&dd.forEach((function(e){return zp(e)&&e.cacheID++&&(e.rec=0)})),Lp(e)&&(Rd.history.scrollRestoration=lp=e)},Bf=0,Rf=function(){Nd.appendChild(up),cp=!np&&up.offsetHeight||Rd.innerHeight,Nd.removeChild(up)},Lf=function(e){return Vd(".gsap-marker-start, .gsap-marker-end, .gsap-marker-scroller-start, .gsap-marker-scroller-end").forEach((function(t){return t.style.display=e?"none":"block"}))},zf=function(e,t){if(zd=Ld.documentElement,Nd=Ld.body,jd=[Rd,Ld,zd,Nd],!wp||e||hp){Rf(),mp=tm.isRefreshing=!0,dd.forEach((function(e){return zp(e)&&++e.cacheID&&(e.rec=e())}));var n=Pf("refreshInit");$d&&tm.sort(),t||If(),dd.forEach((function(e){zp(e)&&(e.smooth&&(e.target.style.scrollBehavior="auto"),e(0))})),wf.slice(0).forEach((function(e){return e.refresh()})),hp=!1,wf.forEach((function(e){if(e._subPinOffset&&e.pin){var t=e.vars.horizontal?"offsetWidth":"offsetHeight",n=e.pin[t];e.revert(!0,1),e.adjustPinSpacing(e.pin[t]-n),e.refresh()}})),dp=1,Lf(!0),wf.forEach((function(e){var t=Bp(e.scroller,e._dir),n="max"===e.vars.end||e._endClamp&&e.end>t,i=e._startClamp&&e.start>=t;(n||i)&&e.setPositions(i?t-1:e.start,n?Math.max(i?t:e.start+1,t):e.end,!0)})),Lf(!1),dp=0,n.forEach((function(e){return e&&e.render&&e.render(-1)})),dd.forEach((function(e){zp(e)&&(e.smooth&&requestAnimationFrame((function(){return e.target.style.scrollBehavior="smooth"})),e.rec&&e(e.rec))})),kf(lp,1),Ud.pause(),Bf++,mp=2,Uf(2),wf.forEach((function(e){return zp(e.vars.onRefresh)&&e.vars.onRefresh(e)})),mp=tm.isRefreshing=!1,Pf("refresh")}else df(tm,"scrollEnd",Tf)},Nf=0,jf=1,Uf=function(e){if(2===e||!mp&&!hp){tm.isUpdating=!0,vp&&vp.update(0);var t=wf.length,n=xp(),i=n-bp>=50,r=t&&wf[0].scroll();if(jf=Nf>r?-1:1,mp||(Nf=r),i&&(wp&&!Yd&&n-wp>200&&(wp=0,Pf("scrollEnd")),Wd=bp,bp=n),jf<0){for(Qd=t;Qd-- >0;)wf[Qd]&&wf[Qd].update(0,i);jf=1}else for(Qd=0;Qd<t;Qd++)wf[Qd]&&wf[Qd].update(0,i);tm.isUpdating=!1}fp=0},Vf=[Wp,"top",qp,Gp,ef+Jp,ef+Qp,ef+Zp,ef+Kp,"display","flexShrink","float","zIndex","gridColumnStart","gridColumnEnd","gridRowStart","gridRowEnd","gridArea","justifySelf","alignSelf","placeSelf","order"],Hf=Vf.concat([Yp,Xp,"boxSizing","max"+tf,"max"+nf,"position",ef,$p,$p+Zp,$p+Qp,$p+Jp,$p+Kp]),Wf=function(e,t,n,i){if(!e._gsap.swappedIn){for(var r,s=Vf.length,a=t.style,o=e.style;s--;)a[r=Vf[s]]=n[r];a.position="absolute"===n.position?"absolute":"relative","inline"===n.display&&(a.display="inline-block"),o[qp]=o[Gp]="auto",a.flexBasis=n.flexBasis||"auto",a.overflow="visible",a.boxSizing="border-box",a[Yp]=lf(e,Sd)+rf,a[Xp]=lf(e,Ed)+rf,a[$p]=o[ef]=o.top=o[Wp]="0",qf(i),o[Yp]=o["max"+tf]=n[Yp],o[Xp]=o["max"+nf]=n[Xp],o[$p]=n[$p],e.parentNode!==t&&(e.parentNode.insertBefore(t,e),t.appendChild(e)),e._gsap.swappedIn=!0}},Gf=/([A-Z])/g,qf=function(e){if(e){var t,n,i=e.t.style,r=e.length,s=0;for((e.t._gsap||kd.core.getCache(e.t)).uncache=1;s<r;s+=2)n=e[s+1],t=e[s],n?i[t]=n:i[t]&&i.removeProperty(t.replace(Gf,"-$1").toLowerCase())}},Yf=function(e){for(var t=Hf.length,n=e.style,i=[],r=0;r<t;r++)i.push(Hf[r],n[Hf[r]]);return i.t=e,i},Xf={left:0,top:0},Qf=function(e,t,n,i,r,s,a,o,l,u,c,h,d,p){zp(e)&&(e=e(o)),Lp(e)&&"max"===e.substr(0,3)&&(e=h+("="===e.charAt(4)?yf("0"+e.substr(3),n):0));var f,m,g,v=d?d.time():0;if(d&&d.seek(0),isNaN(e)||(e=+e),Np(e))d&&(e=kd.utils.mapRange(d.scrollTrigger.start,d.scrollTrigger.end,0,h,e)),a&&bf(a,n,i,!0);else{zp(t)&&(t=t(o));var y,x,b,w,D=(e||"0").split(" ");g=Cd(t,o)||Nd,(y=of(g)||{})&&(y.left||y.top)||"none"!==sf(g).display||(w=g.style.display,g.style.display="block",y=of(g),w?g.style.display=w:g.style.removeProperty("display")),x=yf(D[0],y[i.d]),b=yf(D[1]||"0",n),e=y[i.p]-l[i.p]-u+x+r-b,a&&bf(a,b,i,n-b<20||a._isStart&&b>20),n-=n-b}if(p&&(o[p]=e||-.001,e<0&&(e=0)),s){var _=e+n,S=s._isStart;f="scroll"+i.d2,bf(s,_,i,S&&_>20||!S&&(c?Math.max(Nd[f],zd[f]):s.parentNode[f])<=_+1),c&&(l=of(a),c&&(s.style[i.op.p]=l[i.op.p]-i.op.m-s._offset+rf))}return d&&g&&(f=of(g),d.seek(h),m=of(g),d._caScrollDist=f[i.p]-m[i.p],e=e/d._caScrollDist*h),d&&d.seek(v),d?e:Math.round(e)},Kf=/(webkit|moz|length|cssText|inset)/i,Zf=function(e,t,n,i){if(e.parentNode!==t){var r,s,a=e.style;if(t===Nd){for(r in e._stOrig=a.cssText,s=sf(e))+r||Kf.test(r)||!s[r]||"string"!==typeof a[r]||"0"===r||(a[r]=s[r]);a.top=n,a.left=i}else a.cssText=e._stOrig;kd.core.getCache(e).uncache=1,t.appendChild(e)}},Jf=function(e,t,n){var i=t,r=i;return function(t){var s=Math.round(e());return s!==i&&s!==r&&Math.abs(s-i)>3&&Math.abs(s-r)>3&&(t=s,n&&n()),r=i,i=Math.round(t)}},$f=function(e,t,n){var i={};i[t.p]="+="+n,kd.set(e,i)},em=function(e,t){var n=Ad(e,t),i="_scroll"+t.p2,r=function t(r,s,a,o,l){var u=t.tween,c=s.onComplete,h={};a=a||n();var d=Jf(n,a,(function(){u.kill(),t.tween=0}));return l=o&&l||0,o=o||r-a,u&&u.kill(),s[i]=r,s.inherit=!1,s.modifiers=h,h[i]=function(){return d(a+o*u.ratio+l*u.ratio*u.ratio)},s.onUpdate=function(){dd.cache++,t.tween&&Uf()},s.onComplete=function(){t.tween=0,c&&c.call(u)},u=t.tween=kd.to(e,s)};return e[i]=n,n.wheelHandler=function(){return r.tween&&r.tween.kill()&&(r.tween=0)},df(e,"wheel",n.wheelHandler),tm.isTouch&&df(e,"touchmove",n.wheelHandler),r},tm=function(){function e(t,n){Bd||e.register(kd)||console.warn("Please gsap.registerPlugin(ScrollTrigger)"),op(this),this.init(t,n)}return e.prototype.init=function(t,n){if(this.progress=this.start=0,this.vars&&this.kill(!0,!0),Dp){var i,r,s,a,o,l,u,c,h,d,p,f,m,g,v,y,x,b,w,D,_,S,E,C,A,M,T,P,F,O,I,k,B,R,L,z,N,j,U,V,H=t=af(Lp(t)||Np(t)||t.nodeType?{trigger:t}:t,gf),W=H.onUpdate,G=H.toggleClass,q=H.id,Y=H.onToggle,X=H.onRefresh,Q=H.scrub,K=H.trigger,Z=H.pin,J=H.pinSpacing,$=H.invalidateOnRefresh,ee=H.anticipatePin,te=H.onScrubComplete,ne=H.onSnapComplete,ie=H.once,re=H.snap,se=H.pinReparent,ae=H.pinSpacer,oe=H.containerAnimation,le=H.fastScrollEnd,ue=H.preventOverlaps,ce=t.horizontal||t.containerAnimation&&!1!==t.horizontal?Sd:Ed,he=!Q&&0!==Q,de=Cd(t.scroller||Rd),pe=kd.core.getCache(de),fe=Op(de),me="fixed"===("pinType"in t?t.pinType:gd(de,"pinType")||fe&&"fixed"),ge=[t.onEnter,t.onLeave,t.onEnterBack,t.onLeaveBack],ve=he&&t.toggleActions.split(" "),ye="markers"in t?t.markers:gf.markers,xe=fe?0:parseFloat(sf(de)["border"+ce.p2+tf])||0,be=this,we=t.onRefreshInit&&function(){return t.onRefreshInit(be)},De=function(e,t,n){var i=n.d,r=n.d2,s=n.a;return(s=gd(e,"getBoundingClientRect"))?function(){return s()[i]}:function(){return(t?Ip(r):e["client"+r])||0}}(de,fe,ce),_e=function(e,t){return!t||~pd.indexOf(e)?kp(e):function(){return Xf}}(de,fe),Se=0,Ee=0,Ce=0,Ae=Ad(de,ce);if(be._startClamp=be._endClamp=!1,be._dir=ce,ee*=45,be.scroller=de,be.scroll=oe?oe.time.bind(oe):Ae,a=Ae(),be.vars=t,n=n||t.animation,"refreshPriority"in t&&($d=1,-9999===t.refreshPriority&&(vp=be)),pe.tweenScroll=pe.tweenScroll||{top:em(de,Ed),left:em(de,Sd)},be.tweenTo=i=pe.tweenScroll[ce.p],be.scrubDuration=function(e){(B=Np(e)&&e)?k?k.duration(e):k=kd.to(n,{ease:"expo",totalProgress:"+=0",inherit:!1,duration:B,paused:!0,onComplete:function(){return te&&te(be)}}):(k&&k.progress(1).kill(),k=0)},n&&(n.vars.lazy=!1,n._initted&&!be.isReverted||!1!==n.vars.immediateRender&&!1!==t.immediateRender&&n.duration()&&n.render(0,!0,!0),be.animation=n.pause(),n.scrollTrigger=be,be.scrubDuration(Q),O=0,q||(q=n.vars.id)),re&&(jp(re)&&!re.push||(re={snapTo:re}),"scrollBehavior"in Nd.style&&kd.set(fe?[Nd,zd]:de,{scrollBehavior:"auto"}),dd.forEach((function(e){return zp(e)&&e.target===(fe?Ld.scrollingElement||zd:de)&&(e.smooth=!1)})),s=zp(re.snapTo)?re.snapTo:"labels"===re.snapTo?function(e){return function(t){return kd.utils.snap(uf(e),t)}}(n):"labelsDirectional"===re.snapTo?(V=n,function(e,t){return cf(uf(V))(e,t.direction)}):!1!==re.directional?function(e,t){return cf(re.snapTo)(e,xp()-Ee<500?0:t.direction)}:kd.utils.snap(re.snapTo),R=re.duration||{min:.1,max:2},R=jp(R)?Hd(R.min,R.max):Hd(R,R),L=kd.delayedCall(re.delay||B/2||.1,(function(){var e=Ae(),t=xp()-Ee<500,r=i.tween;if(!(t||Math.abs(be.getVelocity())<10)||r||Yd||Se===e)be.isActive&&Se!==e&&L.restart(!0);else{var a,o,c=(e-l)/g,h=n&&!he?n.totalProgress():c,d=t?0:(h-I)/(xp()-Wd)*1e3||0,p=kd.utils.clamp(-c,1-c,Hp(d/2)*d/.185),f=c+(!1===re.inertia?0:p),m=re,v=m.onStart,y=m.onInterrupt,x=m.onComplete;if(a=s(f,be),Np(a)||(a=f),o=Math.max(0,Math.round(l+a*g)),e<=u&&e>=l&&o!==e){if(r&&!r._initted&&r.data<=Hp(o-e))return;!1===re.inertia&&(p=a-c),i(o,{duration:R(Hp(.185*Math.max(Hp(f-h),Hp(a-h))/d/.05||0)),ease:re.ease||"power3",data:Hp(o-e),onInterrupt:function(){return L.restart(!0)&&y&&y(be)},onComplete:function(){be.update(),Se=Ae(),n&&!he&&(k?k.resetTo("totalProgress",a,n._tTime/n._tDur):n.progress(a)),O=I=n&&!he?n.totalProgress():be.progress,ne&&ne(be),x&&x(be)}},e,p*g,o-e-p*g),v&&v(be,i.tween)}}})).pause()),q&&(Df[q]=be),(U=(K=be.trigger=Cd(K||!0!==Z&&Z))&&K._gsap&&K._gsap.stRevert)&&(U=U(be)),Z=!0===Z?K:Cd(Z),Lp(G)&&(G={targets:K,className:G}),Z&&(!1===J||J===ef||(J=!(!J&&Z.parentNode&&Z.parentNode.style&&"flex"===sf(Z.parentNode).display)&&$p),be.pin=Z,(r=kd.core.getCache(Z)).spacer?v=r.pinState:(ae&&((ae=Cd(ae))&&!ae.nodeType&&(ae=ae.current||ae.nativeElement),r.spacerIsNative=!!ae,ae&&(r.spacerState=Yf(ae))),r.spacer=b=ae||Ld.createElement("div"),b.classList.add("pin-spacer"),q&&b.classList.add("pin-spacer-"+q),r.pinState=v=Yf(Z)),!1!==t.force3D&&kd.set(Z,{force3D:!0}),be.spacer=b=r.spacer,F=sf(Z),C=F[J+ce.os2],D=kd.getProperty(Z),_=kd.quickSetter(Z,ce.a,rf),Wf(Z,b,F),x=Yf(Z)),ye){f=jp(ye)?af(ye,mf):mf,d=xf("scroller-start",q,de,ce,f,0),p=xf("scroller-end",q,de,ce,f,0,d),w=d["offset"+ce.op.d2];var Me=Cd(gd(de,"content")||de);c=this.markerStart=xf("start",q,Me,ce,f,w,0,oe),h=this.markerEnd=xf("end",q,Me,ce,f,w,0,oe),oe&&(j=kd.quickSetter([c,h],ce.a,rf)),me||pd.length&&!0===gd(de,"fixedMarkers")||(!function(e){var t=sf(e).position;e.style.position="absolute"===t||"fixed"===t?t:"relative"}(fe?Nd:de),kd.set([d,p],{force3D:!0}),M=kd.quickSetter(d,ce.a,rf),P=kd.quickSetter(p,ce.a,rf))}if(oe){var Te=oe.vars.onUpdate,Pe=oe.vars.onUpdateParams;oe.eventCallback("onUpdate",(function(){be.update(0,0,1),Te&&Te.apply(oe,Pe||[])}))}if(be.previous=function(){return wf[wf.indexOf(be)-1]},be.next=function(){return wf[wf.indexOf(be)+1]},be.revert=function(e,t){if(!t)return be.kill(!0);var i=!1!==e||!be.enabled,r=qd;i!==be.isReverted&&(i&&(z=Math.max(Ae(),be.scroll.rec||0),Ce=be.progress,N=n&&n.progress()),c&&[c,h,d,p].forEach((function(e){return e.style.display=i?"none":"block"})),i&&(qd=be,be.update(i)),!Z||se&&be.isActive||(i?function(e,t,n){qf(n);var i=e._gsap;if(i.spacerIsNative)qf(i.spacerState);else if(e._gsap.swappedIn){var r=t.parentNode;r&&(r.insertBefore(e,t),r.removeChild(t))}e._gsap.swappedIn=!1}(Z,b,v):Wf(Z,b,sf(Z),A)),i||be.update(i),qd=r,be.isReverted=i)},be.refresh=function(r,s,f,w){if(!qd&&be.enabled||s)if(Z&&r&&wp)df(e,"scrollEnd",Tf);else{!mp&&we&&we(be),qd=be,i.tween&&!f&&(i.tween.kill(),i.tween=0),k&&k.pause(),$&&n&&n.revert({kill:!1}).invalidate(),be.isReverted||be.revert(!0,!0),be._subPinOffset=!1;var _,C,M,P,F,O,I,B,R,j,U,V,H,W=De(),G=_e(),q=oe?oe.duration():Bp(de,ce),Y=g<=.01,Q=0,ee=w||0,te=jp(f)?f.end:t.end,ne=t.endTrigger||K,ie=jp(f)?f.start:t.start||(0!==t.start&&K?Z?"0 0":"0 100%":0),re=be.pinnedContainer=t.pinnedContainer&&Cd(t.pinnedContainer,be),ae=K&&Math.max(0,wf.indexOf(be))||0,le=ae;for(ye&&jp(f)&&(V=kd.getProperty(d,ce.p),H=kd.getProperty(p,ce.p));le-- >0;)(O=wf[le]).end||O.refresh(0,1)||(qd=be),!(I=O.pin)||I!==K&&I!==Z&&I!==re||O.isReverted||(j||(j=[]),j.unshift(O),O.revert(!0,!0)),O!==wf[le]&&(ae--,le--);for(zp(ie)&&(ie=ie(be)),ie=_p(ie,"start",be),l=Qf(ie,K,W,ce,Ae(),c,d,be,G,xe,me,q,oe,be._startClamp&&"_startClamp")||(Z?-.001:0),zp(te)&&(te=te(be)),Lp(te)&&!te.indexOf("+=")&&(~te.indexOf(" ")?te=(Lp(ie)?ie.split(" ")[0]:"")+te:(Q=yf(te.substr(2),W),te=Lp(ie)?ie:(oe?kd.utils.mapRange(0,oe.duration(),oe.scrollTrigger.start,oe.scrollTrigger.end,l):l)+Q,ne=K)),te=_p(te,"end",be),u=Math.max(l,Qf(te||(ne?"100% 0":q),ne,W,ce,Ae()+Q,h,p,be,G,xe,me,q,oe,be._endClamp&&"_endClamp"))||-.001,Q=0,le=ae;le--;)(I=(O=wf[le]).pin)&&O.start-O._pinPush<=l&&!oe&&O.end>0&&(_=O.end-(be._startClamp?Math.max(0,O.start):O.start),(I===K&&O.start-O._pinPush<l||I===re)&&isNaN(ie)&&(Q+=_*(1-O.progress)),I===Z&&(ee+=_));if(l+=Q,u+=Q,be._startClamp&&(be._startClamp+=Q),be._endClamp&&!mp&&(be._endClamp=u||-.001,u=Math.min(u,Bp(de,ce))),g=u-l||(l-=.01)&&.001,Y&&(Ce=kd.utils.clamp(0,1,kd.utils.normalize(l,u,z))),be._pinPush=ee,c&&Q&&((_={})[ce.a]="+="+Q,re&&(_[ce.p]="-="+Ae()),kd.set([c,h],_)),!Z||dp&&be.end>=Bp(de,ce)){if(K&&Ae()&&!oe)for(C=K.parentNode;C&&C!==Nd;)C._pinOffset&&(l-=C._pinOffset,u-=C._pinOffset),C=C.parentNode}else _=sf(Z),P=ce===Ed,M=Ae(),S=parseFloat(D(ce.a))+ee,!q&&u>1&&(U={style:U=(fe?Ld.scrollingElement||zd:de).style,value:U["overflow"+ce.a.toUpperCase()]},fe&&"scroll"!==sf(Nd)["overflow"+ce.a.toUpperCase()]&&(U.style["overflow"+ce.a.toUpperCase()]="scroll")),Wf(Z,b,_),x=Yf(Z),C=of(Z,!0),B=me&&Ad(de,P?Sd:Ed)(),J?((A=[J+ce.os2,g+ee+rf]).t=b,(le=J===$p?lf(Z,ce)+g+ee:0)&&(A.push(ce.d,le+rf),"auto"!==b.style.flexBasis&&(b.style.flexBasis=le+rf)),qf(A),re&&wf.forEach((function(e){e.pin===re&&!1!==e.vars.pinSpacing&&(e._subPinOffset=!0)})),me&&Ae(z)):(le=lf(Z,ce))&&"auto"!==b.style.flexBasis&&(b.style.flexBasis=le+rf),me&&((F={top:C.top+(P?M-l:B)+rf,left:C.left+(P?B:M-l)+rf,boxSizing:"border-box",position:"fixed"})[Yp]=F["max"+tf]=Math.ceil(C.width)+rf,F[Xp]=F["max"+nf]=Math.ceil(C.height)+rf,F[ef]=F[ef+Zp]=F[ef+Qp]=F[ef+Jp]=F[ef+Kp]="0",F[$p]=_[$p],F[$p+Zp]=_[$p+Zp],F[$p+Qp]=_[$p+Qp],F[$p+Jp]=_[$p+Jp],F[$p+Kp]=_[$p+Kp],y=function(e,t,n){for(var i,r=[],s=e.length,a=n?8:0;a<s;a+=2)i=e[a],r.push(i,i in t?t[i]:e[a+1]);return r.t=e.t,r}(v,F,se),mp&&Ae(0)),n?(R=n._initted,ep(1),n.render(n.duration(),!0,!0),E=D(ce.a)-S+g+ee,T=Math.abs(g-E)>1,me&&T&&y.splice(y.length-2,2),n.render(0,!0,!0),R||n.invalidate(!0),n.parent||n.totalTime(n.totalTime()),ep(0)):E=g,U&&(U.value?U.style["overflow"+ce.a.toUpperCase()]=U.value:U.style.removeProperty("overflow-"+ce.a));j&&j.forEach((function(e){return e.revert(!1,!0)})),be.start=l,be.end=u,a=o=mp?z:Ae(),oe||mp||(a<z&&Ae(z),be.scroll.rec=0),be.revert(!1,!0),Ee=xp(),L&&(Se=-1,L.restart(!0)),qd=0,n&&he&&(n._initted||N)&&n.progress()!==N&&n.progress(N||0,!0).render(n.time(),!0,!0),(Y||Ce!==be.progress||oe||$||n&&!n._initted)&&(n&&!he&&n.totalProgress(oe&&l<-.001&&!Ce?kd.utils.normalize(l,u,0):Ce,!0),be.progress=Y||(a-l)/g===Ce?0:Ce),Z&&J&&(b._pinOffset=Math.round(be.progress*E)),k&&k.invalidate(),isNaN(V)||(V-=kd.getProperty(d,ce.p),H-=kd.getProperty(p,ce.p),$f(d,ce,V),$f(c,ce,V-(w||0)),$f(p,ce,H),$f(h,ce,H-(w||0))),Y&&!mp&&be.update(),!X||mp||m||(m=!0,X(be),m=!1)}},be.getVelocity=function(){return(Ae()-o)/(xp()-Wd)*1e3||0},be.endAnimation=function(){Up(be.callbackAnimation),n&&(k?k.progress(1):n.paused()?he||Up(n,be.direction<0,1):Up(n,n.reversed()))},be.labelToScroll=function(e){return n&&n.labels&&(l||be.refresh()||l)+n.labels[e]/n.duration()*g||0},be.getTrailing=function(e){var t=wf.indexOf(be),n=be.direction>0?wf.slice(0,t).reverse():wf.slice(t+1);return(Lp(e)?n.filter((function(t){return t.vars.preventOverlaps===e})):n).filter((function(e){return be.direction>0?e.end<=l:e.start>=u}))},be.update=function(e,t,r){if(!oe||r||e){var s,c,h,p,f,m,v,w=!0===mp?z:be.scroll(),D=e?0:(w-l)/g,A=D<0?0:D>1?1:D||0,F=be.progress;if(t&&(o=a,a=oe?Ae():w,re&&(I=O,O=n&&!he?n.totalProgress():A)),ee&&Z&&!qd&&!yp&&wp&&(!A&&l<w+(w-o)/(xp()-Wd)*ee?A=1e-4:1===A&&u>w+(w-o)/(xp()-Wd)*ee&&(A=.9999)),A!==F&&be.enabled){if(p=(f=(s=be.isActive=!!A&&A<1)!==(!!F&&F<1))||!!A!==!!F,be.direction=A>F?1:-1,be.progress=A,p&&!qd&&(c=A&&!F?0:1===A?1:1===F?2:3,he&&(h=!f&&"none"!==ve[c+1]&&ve[c+1]||ve[c],v=n&&("complete"===h||"reset"===h||h in n))),ue&&(f||v)&&(v||Q||!n)&&(zp(ue)?ue(be):be.getTrailing(ue).forEach((function(e){return e.endAnimation()}))),he||(!k||qd||yp?n&&n.totalProgress(A,!(!qd||!Ee&&!e)):(k._dp._time-k._start!==k._time&&k.render(k._dp._time-k._start),k.resetTo?k.resetTo("totalProgress",A,n._tTime/n._tDur):(k.vars.totalProgress=A,k.invalidate().restart()))),Z)if(e&&J&&(b.style[J+ce.os2]=C),me){if(p){if(m=!e&&A>F&&u+1>w&&w+1>=Bp(de,ce),se)if(e||!s&&!m)Zf(Z,b);else{var B=of(Z,!0),R=w-l;Zf(Z,Nd,B.top+(ce===Ed?R:0)+rf,B.left+(ce===Ed?0:R)+rf)}qf(s||m?y:x),T&&A<1&&s||_(S+(1!==A||m?0:E))}}else _(Tp(S+E*A));re&&!i.tween&&!qd&&!yp&&L.restart(!0),G&&(f||ie&&A&&(A<1||!pp))&&Vd(G.targets).forEach((function(e){return e.classList[s||ie?"add":"remove"](G.className)})),W&&!he&&!e&&W(be),p&&!qd?(he&&(v&&("complete"===h?n.pause().totalProgress(1):"reset"===h?n.restart(!0).pause():"restart"===h?n.restart(!0):n[h]()),W&&W(be)),!f&&pp||(Y&&f&&Vp(be,Y),ge[c]&&Vp(be,ge[c]),ie&&(1===A?be.kill(!1,1):ge[c]=0),f||ge[c=1===A?1:3]&&Vp(be,ge[c])),le&&!s&&Math.abs(be.getVelocity())>(Np(le)?le:2500)&&(Up(be.callbackAnimation),k?k.progress(1):Up(n,"reverse"===h?1:!A,1))):he&&W&&!qd&&W(be)}if(P){var N=oe?w/oe.duration()*(oe._caScrollDist||0):w;M(N+(d._isFlipped?1:0)),P(N)}j&&j(-w/oe.duration()*(oe._caScrollDist||0))}},be.enable=function(t,n){be.enabled||(be.enabled=!0,df(de,"resize",Cf),fe||df(de,"scroll",Sf),we&&df(e,"refreshInit",we),!1!==t&&(be.progress=Ce=0,a=o=Se=Ae()),!1!==n&&be.refresh())},be.getTween=function(e){return e&&i?i.tween:k},be.setPositions=function(e,t,n,i){if(oe){var r=oe.scrollTrigger,s=oe.duration(),a=r.end-r.start;e=r.start+a*e/s,t=r.start+a*t/s}be.refresh(!1,!1,{start:Sp(e,n&&!!be._startClamp),end:Sp(t,n&&!!be._endClamp)},i),be.update()},be.adjustPinSpacing=function(e){if(A&&e){var t=A.indexOf(ce.d)+1;A[t]=parseFloat(A[t])+e+rf,A[1]=parseFloat(A[1])+e+rf,qf(A)}},be.disable=function(t,n){if(be.enabled&&(!1!==t&&be.revert(!0,!0),be.enabled=be.isActive=!1,n||k&&k.pause(),z=0,r&&(r.uncache=1),we&&pf(e,"refreshInit",we),L&&(L.pause(),i.tween&&i.tween.kill()&&(i.tween=0)),!fe)){for(var s=wf.length;s--;)if(wf[s].scroller===de&&wf[s]!==be)return;pf(de,"resize",Cf),fe||pf(de,"scroll",Sf)}},be.kill=function(e,i){be.disable(e,i),k&&!i&&k.kill(),q&&delete Df[q];var s=wf.indexOf(be);s>=0&&wf.splice(s,1),s===Qd&&jf>0&&Qd--,s=0,wf.forEach((function(e){return e.scroller===be.scroller&&(s=1)})),s||mp||(be.scroll.rec=0),n&&(n.scrollTrigger=null,e&&n.revert({kill:!1}),i||n.kill()),c&&[c,h,d,p].forEach((function(e){return e.parentNode&&e.parentNode.removeChild(e)})),vp===be&&(vp=0),Z&&(r&&(r.uncache=1),s=0,wf.forEach((function(e){return e.pin===Z&&s++})),s||(r.spacer=0)),t.onKill&&t.onKill(be)},wf.push(be),be.enable(!1,!1),U&&U(be),n&&n.add&&!g){var Fe=be.update;be.update=function(){be.update=Fe,dd.cache++,l||u||be.refresh()},kd.delayedCall(.01,be.update),g=.01,l=u=0}else be.refresh();Z&&function(){if(gp!==Bf){var e=gp=Bf;requestAnimationFrame((function(){return e===Bf&&zf(!0)}))}}()}else this.update=this.refresh=this.kill=Mp},e.register=function(t){return Bd||(kd=t||Fp(),Pp()&&window.document&&e.enable(),Bd=Dp),Bd},e.defaults=function(e){if(e)for(var t in e)gf[t]=e[t];return gf},e.disable=function(e,t){Dp=0,wf.forEach((function(n){return n[t?"kill":"disable"](e)})),pf(Rd,"wheel",Sf),pf(Ld,"scroll",Sf),clearInterval(Gd),pf(Ld,"touchcancel",Mp),pf(Nd,"touchstart",Mp),hf(pf,Ld,"pointerdown,touchstart,mousedown",Cp),hf(pf,Ld,"pointerup,touchend,mouseup",Ap),Ud.kill(),Rp(pf);for(var n=0;n<dd.length;n+=3)ff(pf,dd[n],dd[n+1]),ff(pf,dd[n],dd[n+2])},e.enable=function(){if(Rd=window,Ld=document,zd=Ld.documentElement,Nd=Ld.body,kd&&(Vd=kd.utils.toArray,Hd=kd.utils.clamp,op=kd.core.context||Mp,ep=kd.core.suppressOverwrites||Mp,lp=Rd.history.scrollRestoration||"auto",Nf=Rd.pageYOffset||0,kd.core.globals("ScrollTrigger",e),Nd)){Dp=1,(up=document.createElement("div")).style.height="100vh",up.style.position="absolute",Rf(),Ep(),Id.register(kd),e.isTouch=Id.isTouch,ap=Id.isTouch&&/(iPad|iPhone|iPod|Mac)/g.test(navigator.userAgent),ip=1===Id.isTouch,df(Rd,"wheel",Sf),jd=[Rd,Ld,zd,Nd],kd.matchMedia?(e.matchMedia=function(e){var t,n=kd.matchMedia();for(t in e)n.add(t,e[t]);return n},kd.addEventListener("matchMediaInit",(function(){return If()})),kd.addEventListener("matchMediaRevert",(function(){return Of()})),kd.addEventListener("matchMedia",(function(){zf(0,1),Pf("matchMedia")})),kd.matchMedia().add("(orientation: portrait)",(function(){return Ef(),Ef}))):console.warn("Requires GSAP 3.11.0 or later"),Ef(),df(Ld,"scroll",Sf);var t,n,i=Nd.hasAttribute("style"),r=Nd.style,s=r.borderTopStyle,a=kd.core.Animation.prototype;for(a.revert||Object.defineProperty(a,"revert",{value:function(){return this.time(-.01,!0)}}),r.borderTopStyle="solid",t=of(Nd),Ed.m=Math.round(t.top+Ed.sc())||0,Sd.m=Math.round(t.left+Sd.sc())||0,s?r.borderTopStyle=s:r.removeProperty("border-top-style"),i||(Nd.setAttribute("style",""),Nd.removeAttribute("style")),Gd=setInterval(_f,250),kd.delayedCall(.5,(function(){return yp=0})),df(Ld,"touchcancel",Mp),df(Nd,"touchstart",Mp),hf(df,Ld,"pointerdown,touchstart,mousedown",Cp),hf(df,Ld,"pointerup,touchend,mouseup",Ap),Xd=kd.utils.checkPrefix("transform"),Hf.push(Xd),Bd=xp(),Ud=kd.delayedCall(.2,zf).pause(),Jd=[Ld,"visibilitychange",function(){var e=Rd.innerWidth,t=Rd.innerHeight;Ld.hidden?(Kd=e,Zd=t):Kd===e&&Zd===t||Cf()},Ld,"DOMContentLoaded",zf,Rd,"load",zf,Rd,"resize",Cf],Rp(df),wf.forEach((function(e){return e.enable(0,1)})),n=0;n<dd.length;n+=3)ff(pf,dd[n],dd[n+1]),ff(pf,dd[n],dd[n+2])}},e.config=function(t){"limitCallbacks"in t&&(pp=!!t.limitCallbacks);var n=t.syncInterval;n&&clearInterval(Gd)||(Gd=n)&&setInterval(_f,n),"ignoreMobileResize"in t&&(ip=1===e.isTouch&&t.ignoreMobileResize),"autoRefreshEvents"in t&&(Rp(pf)||Rp(df,t.autoRefreshEvents||"none"),tp=-1===(t.autoRefreshEvents+"").indexOf("resize"))},e.scrollerProxy=function(e,t){var n=Cd(e),i=dd.indexOf(n),r=Op(n);~i&&dd.splice(i,r?6:2),t&&(r?pd.unshift(Rd,t,Nd,t,zd,t):pd.unshift(n,t))},e.clearMatchMedia=function(e){wf.forEach((function(t){return t._ctx&&t._ctx.query===e&&t._ctx.kill(!0,!0)}))},e.isInViewport=function(e,t,n){var i=(Lp(e)?Cd(e):e).getBoundingClientRect(),r=i[n?Yp:Xp]*t||0;return n?i.right-r>0&&i.left+r<Rd.innerWidth:i.bottom-r>0&&i.top+r<Rd.innerHeight},e.positionInViewport=function(e,t,n){Lp(e)&&(e=Cd(e));var i=e.getBoundingClientRect(),r=i[n?Yp:Xp],s=null==t?r/2:t in vf?vf[t]*r:~t.indexOf("%")?parseFloat(t)*r/100:parseFloat(t)||0;return n?(i.left+s)/Rd.innerWidth:(i.top+s)/Rd.innerHeight},e.killAll=function(e){if(wf.slice(0).forEach((function(e){return"ScrollSmoother"!==e.vars.id&&e.kill()})),!0!==e){var t=Af.killAll||[];Af={},t.forEach((function(e){return e()}))}},e}();tm.version="3.12.7",tm.saveStyles=function(e){return e?Vd(e).forEach((function(e){if(e&&e.style){var t=Ff.indexOf(e);t>=0&&Ff.splice(t,5),Ff.push(e,e.style.cssText,e.getBBox&&e.getAttribute("transform"),kd.core.getCache(e),op())}})):Ff},tm.revert=function(e,t){return If(!e,t)},tm.create=function(e,t){return new tm(e,t)},tm.refresh=function(e){return e?Cf(!0):(Bd||tm.register())&&zf(!0)},tm.update=function(e){return++dd.cache&&Uf(!0===e?2:0)},tm.clearScrollMemory=kf,tm.maxScroll=function(e,t){return Bp(e,t?Sd:Ed)},tm.getScrollFunc=function(e,t){return Ad(Cd(e),t?Sd:Ed)},tm.getById=function(e){return Df[e]},tm.getAll=function(){return wf.filter((function(e){return"ScrollSmoother"!==e.vars.id}))},tm.isScrolling=function(){return!!wp},tm.snapDirectional=cf,tm.addEventListener=function(e,t){var n=Af[e]||(Af[e]=[]);~n.indexOf(t)||n.push(t)},tm.removeEventListener=function(e,t){var n=Af[e],i=n&&n.indexOf(t);i>=0&&n.splice(i,1)},tm.batch=function(e,t){var n,i=[],r={},s=t.interval||.016,a=t.batchMax||1e9,o=function(e,t){var n=[],i=[],r=kd.delayedCall(s,(function(){t(n,i),n=[],i=[]})).pause();return function(e){n.length||r.restart(!0),n.push(e.trigger),i.push(e),a<=n.length&&r.progress(1)}};for(n in t)r[n]="on"===n.substr(0,2)&&zp(t[n])&&"onRefreshInit"!==n?o(0,t[n]):t[n];return zp(a)&&(a=a(),df(tm,"refresh",(function(){return a=t.batchMax()}))),Vd(e).forEach((function(e){var t={};for(n in r)t[n]=r[n];t.trigger=e,i.push(tm.create(t))})),i};var nm,im=function(e,t,n,i){return t>i?e(i):t<0&&e(0),n>i?(i-t)/(n-t):n<0?t/(t-n):1},rm=function e(t,n){!0===n?t.style.removeProperty("touch-action"):t.style.touchAction=!0===n?"auto":n?"pan-"+n+(Id.isTouch?" pinch-zoom":""):"none",t===zd&&e(Nd,n)},sm={auto:1,scroll:1},am=function(e){var t,n=e.event,i=e.target,r=e.axis,s=(n.changedTouches?n.changedTouches[0]:n).target,a=s._gsap||kd.core.getCache(s),o=xp();if(!a._isScrollT||o-a._isScrollT>2e3){for(;s&&s!==Nd&&(s.scrollHeight<=s.clientHeight&&s.scrollWidth<=s.clientWidth||!sm[(t=sf(s)).overflowY]&&!sm[t.overflowX]);)s=s.parentNode;a._isScroll=s&&s!==i&&!Op(s)&&(sm[(t=sf(s)).overflowY]||sm[t.overflowX]),a._isScrollT=o}(a._isScroll||"x"===r)&&(n.stopPropagation(),n._gsapAllow=!0)},om=function(e,t,n,i){return Id.create({target:e,capture:!0,debounce:!1,lockAxis:!0,type:t,onWheel:i=i&&am,onPress:i,onDrag:i,onScroll:i,onEnable:function(){return n&&df(Ld,Id.eventTypes[0],um,!1,!0)},onDisable:function(){return pf(Ld,Id.eventTypes[0],um,!0)}})},lm=/(input|label|select|textarea)/i,um=function(e){var t=lm.test(e.target.tagName);(t||nm)&&(e._gsapAllow=!0,nm=t)},cm=function(e){jp(e)||(e={}),e.preventDefault=e.isNormalizer=e.allowClicks=!0,e.type||(e.type="wheel,touch"),e.debounce=!!e.debounce,e.id=e.id||"normalizer";var t,n,i,r,s,a,o,l,u=e,c=u.normalizeScrollX,h=u.momentum,d=u.allowNestedScroll,p=u.onRelease,f=Cd(e.target)||zd,m=kd.core.globals().ScrollSmoother,g=m&&m.get(),v=ap&&(e.content&&Cd(e.content)||g&&!1!==e.content&&!g.smooth()&&g.content()),y=Ad(f,Ed),x=Ad(f,Sd),b=1,w=(Id.isTouch&&Rd.visualViewport?Rd.visualViewport.scale*Rd.visualViewport.width:Rd.outerWidth)/Rd.innerWidth,D=0,_=zp(h)?function(){return h(t)}:function(){return h||2.8},S=om(f,e.type,!0,d),E=function(){return r=!1},C=Mp,A=Mp,M=function(){n=Bp(f,Ed),A=Hd(ap?1:0,n),c&&(C=Hd(0,Bp(f,Sd))),i=Bf},T=function(){v._gsap.y=Tp(parseFloat(v._gsap.y)+y.offset)+"px",v.style.transform="matrix3d(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, "+parseFloat(v._gsap.y)+", 0, 1)",y.offset=y.cacheID=0},P=function(){M(),s.isActive()&&s.vars.scrollY>n&&(y()>n?s.progress(1)&&y(n):s.resetTo("scrollY",n))};return v&&kd.set(v,{y:"+=0"}),e.ignoreCheck=function(e){return ap&&"touchmove"===e.type&&function(){if(r){requestAnimationFrame(E);var e=Tp(t.deltaY/2),n=A(y.v-e);if(v&&n!==y.v+y.offset){y.offset=n-y.v;var i=Tp((parseFloat(v&&v._gsap.y)||0)-y.offset);v.style.transform="matrix3d(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, "+i+", 0, 1)",v._gsap.y=i+"px",y.cacheID=dd.cache,Uf()}return!0}y.offset&&T(),r=!0}()||b>1.05&&"touchstart"!==e.type||t.isGesturing||e.touches&&e.touches.length>1},e.onPress=function(){r=!1;var e=b;b=Tp((Rd.visualViewport&&Rd.visualViewport.scale||1)/w),s.pause(),e!==b&&rm(f,b>1.01||!c&&"x"),a=x(),o=y(),M(),i=Bf},e.onRelease=e.onGestureStart=function(e,t){if(y.offset&&T(),t){dd.cache++;var i,r,a=_();c&&(r=(i=x())+.05*a*-e.velocityX/.227,a*=im(x,i,r,Bp(f,Sd)),s.vars.scrollX=C(r)),r=(i=y())+.05*a*-e.velocityY/.227,a*=im(y,i,r,Bp(f,Ed)),s.vars.scrollY=A(r),s.invalidate().duration(a).play(.01),(ap&&s.vars.scrollY>=n||i>=n-1)&&kd.to({},{onUpdate:P,duration:a})}else l.restart(!0);p&&p(e)},e.onWheel=function(){s._ts&&s.pause(),xp()-D>1e3&&(i=0,D=xp())},e.onChange=function(e,t,n,r,s){if(Bf!==i&&M(),t&&c&&x(C(r[2]===t?a+(e.startX-e.x):x()+t-r[1])),n){y.offset&&T();var l=s[2]===n,u=l?o+e.startY-e.y:y()+n-s[1],h=A(u);l&&u!==h&&(o+=h-u),y(h)}(n||t)&&Uf()},e.onEnable=function(){rm(f,!c&&"x"),tm.addEventListener("refresh",P),df(Rd,"resize",P),y.smooth&&(y.target.style.scrollBehavior="auto",y.smooth=x.smooth=!1),S.enable()},e.onDisable=function(){rm(f,!0),pf(Rd,"resize",P),tm.removeEventListener("refresh",P),S.kill()},e.lockAxis=!1!==e.lockAxis,(t=new Id(e)).iOS=ap,ap&&!y()&&y(1),ap&&kd.ticker.add(Mp),l=t._dc,s=kd.to(t,{ease:"power4",paused:!0,inherit:!1,scrollX:c?"+=0.1":"+=0",scrollY:"+=0.1",modifiers:{scrollY:Jf(y,y(),(function(){return s.pause()}))},onUpdate:Uf,onComplete:l.vars.onComplete}),t};function hm(e,t){return hm=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},hm(e,t)}function dm(){dm=function(e,t){return new n(e,void 0,t)};var e=RegExp.prototype,t=new WeakMap;function n(e,i,r){var s=RegExp(e,i);return t.set(s,r||t.get(e)),hm(s,n.prototype)}function i(e,n){var i=t.get(n);return Object.keys(i).reduce((function(t,n){var r=i[n];if("number"==typeof r)t[n]=e[r];else{for(var s=0;void 0===e[r[s]]&&s+1<r.length;)s++;t[n]=e[r[s]]}return t}),Object.create(null))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&hm(e,t)}(n,RegExp),n.prototype.exec=function(t){var n=e.exec.call(this,t);if(n){n.groups=i(n,this);var r=n.indices;r&&(r.groups=i(r,this))}return n},n.prototype[Symbol.replace]=function(n,r){if("string"==typeof r){var s=t.get(this);return e[Symbol.replace].call(this,n,r.replace(/\$<([^>]+)>/g,(function(e,t){var n=s[t];return"$"+(Array.isArray(n)?n.join("$"):n)})))}if("function"==typeof r){var a=this;return e[Symbol.replace].call(this,n,(function(){var e=arguments;return"object"!=l(e[e.length-1])&&(e=[].slice.call(e)).push(i(e,a)),r.apply(this,e)}))}return e[Symbol.replace].call(this,n,r)},dm.apply(this,arguments)}tm.sort=function(e){if(zp(e))return wf.sort(e);var t=Rd.pageYOffset||0;return tm.getAll().forEach((function(e){return e._sortY=e.trigger?t+e.trigger.getBoundingClientRect().top:e.start+Rd.innerHeight})),wf.sort(e||function(e,t){return-1e6*(e.vars.refreshPriority||0)+(e.vars.containerAnimation?1e6:e._sortY)-((t.vars.containerAnimation?1e6:t._sortY)+-1e6*(t.vars.refreshPriority||0))})},tm.observe=function(e){return new Id(e)},tm.normalizeScroll=function(e){if("undefined"===typeof e)return np;if(!0===e&&np)return np.enable();if(!1===e)return np&&np.kill(),void(np=e);var t=e instanceof Id?e:cm(e);return np&&np.target===t.target&&np.kill(),Op(t.target)&&(np=t),t},tm.core={_getVelocityProp:Md,_inputObserver:om,_scrollers:dd,_proxies:pd,bridge:{ss:function(){wp||Pf("scrollStart"),wp=xp()},ref:function(){return qd}}},Fp()&&kd.registerPlugin(tm);const pm=["texture"],fm=["texture"],mm=["name"],gm=["material"],vm=["enabled"],ym=["name"];var xm=Object.create,bm=Object.defineProperty,wm=Object.getOwnPropertyDescriptor,Dm=Object.getOwnPropertyNames,_m=Object.getPrototypeOf,Sm=Object.prototype.hasOwnProperty,Em=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),Cm=(e,t,n)=>(n=null!=e?xm(_m(e)):{},((e,t,n,i)=>{if(t&&"object"==typeof t||"function"==typeof t)for(let r of Dm(t))!Sm.call(e,r)&&r!==n&&bm(e,r,{get:()=>t[r],enumerable:!(i=wm(t,r))||i.enumerable});return e})(!t&&e&&e.__esModule?n:bm(n,"default",{value:e,enumerable:!0}),e)),Am=(e,t,n)=>(((e,t,n)=>{t in e?bm(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n})(e,"symbol"!=typeof t?t+"":t,n),n),Mm=Em(((e,t)=>{!function(n,i){"object"==typeof e?t.exports=i():"function"==typeof define&&define.amd?define(i):n.Alea=i()}(e,(function(){return e.importState=function(t){var n=new e;return n.importState(t),n},e;function e(){return function(e){var t=0,n=0,i=0,r=1;0==e.length&&(e=[+new Date]);var s=function(){var e=4022871197,t=function(t){t=t.toString();for(var n=0;n<t.length;n++){var i=.02519603282416938*(e+=t.charCodeAt(n));i-=e=i>>>0,e=(i*=e)>>>0,e+=4294967296*(i-=e)}return 2.3283064365386963e-10*(e>>>0)};return t.version="Mash 0.9",t}();t=s(" "),n=s(" "),i=s(" ");for(var a=0;a<e.length;a++)(t-=s(e[a]))<0&&(t+=1),(n-=s(e[a]))<0&&(n+=1),(i-=s(e[a]))<0&&(i+=1);s=null;var o=function(){var e=2091639*t+2.3283064365386963e-10*r;return t=n,n=i,i=e-(r=0|e)};return o.next=o,o.uint32=function(){return 4294967296*o()},o.fract53=function(){return o()+11102230246251565e-32*(2097152*o()|0)},o.version="Alea 0.9",o.args=e,o.exportState=function(){return[t,n,i,r]},o.importState=function(e){t=+e[0]||0,n=+e[1]||0,i=+e[2]||0,r=+e[3]||0},o}(Array.prototype.slice.call(arguments))}}))})),Tm=Em(((e,t)=>{!function(n,i){"object"==typeof e&&typeof t<"u"?i(e):"function"==typeof define&&define.amd?define(["exports"],i):i((n=typeof globalThis<"u"?globalThis:n||self).SVDJS={})}(e,(function(e){e.SVD=function(e,t,n,i,r){if(t=void 0===t||t,n=void 0===n||n,r=1e-64/(i=i||Math.pow(2,-52)),!e)throw new TypeError("Matrix a is not defined");var s,a,o,l,u,c,h,d,p,f,m,g,v=e[0].length,y=e.length;if(y<v)throw new TypeError("Invalid matrix: m < n");for(var x=[],b=[],w=[],D="f"===t?y:v,_=f=h=0;_<y;_++)b[_]=new Array(D).fill(0);for(_=0;_<v;_++)w[_]=new Array(v).fill(0);var S,E=new Array(v).fill(0);for(_=0;_<y;_++)for(s=0;s<v;s++)b[_][s]=e[_][s];for(_=0;_<v;_++){for(x[_]=h,p=0,o=_+1,s=_;s<y;s++)p+=Math.pow(b[s][_],2);if(p<r)h=0;else for(d=(c=b[_][_])*(h=c<0?Math.sqrt(p):-Math.sqrt(p))-p,b[_][_]=c-h,s=o;s<v;s++){for(p=0,a=_;a<y;a++)p+=b[a][_]*b[a][s];for(c=p/d,a=_;a<y;a++)b[a][s]=b[a][s]+c*b[a][_]}for(E[_]=h,p=0,s=o;s<v;s++)p+=Math.pow(b[_][s],2);if(p<r)h=0;else{for(d=(c=b[_][_+1])*(h=c<0?Math.sqrt(p):-Math.sqrt(p))-p,b[_][_+1]=c-h,s=o;s<v;s++)x[s]=b[_][s]/d;for(s=o;s<y;s++){for(p=0,a=o;a<v;a++)p+=b[s][a]*b[_][a];for(a=o;a<v;a++)b[s][a]=b[s][a]+p*x[a]}}f<(m=Math.abs(E[_])+Math.abs(x[_]))&&(f=m)}if(n)for(_=v-1;0<=_;_--){if(0!==h){for(d=b[_][_+1]*h,s=o;s<v;s++)w[s][_]=b[_][s]/d;for(s=o;s<v;s++){for(p=0,a=o;a<v;a++)p+=b[_][a]*w[a][s];for(a=o;a<v;a++)w[a][s]=w[a][s]+p*w[a][_]}}for(s=o;s<v;s++)w[_][s]=0,w[s][_]=0;w[_][_]=1,h=x[_],o=_}if(t){if("f"===t)for(_=v;_<y;_++){for(s=v;s<y;s++)b[_][s]=0;b[_][_]=1}for(_=v-1;0<=_;_--){for(o=_+1,h=E[_],s=o;s<D;s++)b[_][s]=0;if(0!==h){for(d=b[_][_]*h,s=o;s<D;s++){for(p=0,a=o;a<y;a++)p+=b[a][_]*b[a][s];for(c=p/d,a=_;a<y;a++)b[a][s]=b[a][s]+c*b[a][_]}for(s=_;s<y;s++)b[s][_]=b[s][_]/h}else for(s=_;s<y;s++)b[s][_]=0;b[_][_]=b[_][_]+1}}for(i*=f,a=v-1;0<=a;a--)for(var C=0;C<50;C++){for(S=!1,o=a;0<=o;o--){if(Math.abs(x[o])<=i){S=!0;break}if(Math.abs(E[o-1])<=i)break}if(!S)for(u=0,l=o-(p=1),_=o;_<a+1&&(c=p*x[_],x[_]=u*x[_],!(Math.abs(c)<=i));_++)if(h=E[_],E[_]=Math.sqrt(c*c+h*h),u=h/(d=E[_]),p=-c/d,t)for(s=0;s<y;s++)m=b[s][l],g=b[s][_],b[s][l]=m*u+g*p,b[s][_]=-m*p+g*u;if(g=E[a],o===a){if(g<0&&(E[a]=-g,n))for(s=0;s<v;s++)w[s][a]=-w[s][a];break}for(f=E[o],c=(((m=E[a-1])-g)*(m+g)+((h=x[a-1])-(d=x[a]))*(h+d))/(2*d*m),h=Math.sqrt(c*c+1),c=((f-g)*(f+g)+d*(m/(c<0?c-h:c+h)-d))/f,_=o+(p=u=1);_<a+1;_++){if(h=x[_],m=E[_],d=p*h,h*=u,g=Math.sqrt(c*c+d*d),c=f*(u=c/(x[_-1]=g))+h*(p=d/g),h=-f*p+h*u,d=m*p,m*=u,n)for(s=0;s<v;s++)f=w[s][_-1],g=w[s][_],w[s][_-1]=f*u+g*p,w[s][_]=-f*p+g*u;if(g=Math.sqrt(c*c+d*d),c=(u=c/(E[_-1]=g))*h+(p=d/g)*m,f=-p*h+u*m,t)for(s=0;s<y;s++)m=b[s][_-1],g=b[s][_],b[s][_-1]=m*u+g*p,b[s][_]=-m*p+g*u}x[o]=0,x[a]=c,E[a]=f}for(_=0;_<v;_++)E[_]<i&&(E[_]=0);return{u:b,q:E,v:w}},e.VERSION="1.1.1",Object.defineProperty(e,"__esModule",{value:!0})}))})),Pm=Em(((e,t)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(e){if(null===e||!0===e||!1===e)return NaN;var t=Number(e);return isNaN(t)?t:t<0?Math.ceil(t):Math.floor(t)},t.exports=e.default})),Fm=Em(((e,t)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(e){var t=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()));return t.setUTCFullYear(e.getFullYear()),e.getTime()-t.getTime()},t.exports=e.default})),Om=Em(((e,t)=>{function n(e,t,i,r){this.message=e,this.expected=t,this.found=i,this.location=r,this.name="SyntaxError","function"==typeof Error.captureStackTrace&&Error.captureStackTrace(this,n)}!function(e,t){function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n}(n,Error),n.buildMessage=function(e,t){var n={literal:function(e){return'"'+r(e.text)+'"'},class:function(e){var t,n="";for(t=0;t<e.parts.length;t++)n+=e.parts[t]instanceof Array?s(e.parts[t][0])+"-"+s(e.parts[t][1]):s(e.parts[t]);return"["+(e.inverted?"^":"")+n+"]"},any:function(e){return"any character"},end:function(e){return"end of input"},other:function(e){return e.description}};function i(e){return e.charCodeAt(0).toString(16).toUpperCase()}function r(e){return e.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(e){return"\\x0"+i(e)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(e){return"\\x"+i(e)}))}function s(e){return e.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(e){return"\\x0"+i(e)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(e){return"\\x"+i(e)}))}function a(e){return n[e.type](e)}return"Expected "+function(e){var t,n,i=new Array(e.length);for(t=0;t<e.length;t++)i[t]=a(e[t]);if(i.sort(),i.length>0){for(t=1,n=1;t<i.length;t++)i[t-1]!==i[t]&&(i[n]=i[t],n++);i.length=n}switch(i.length){case 1:return i[0];case 2:return i[0]+" or "+i[1];default:return i.slice(0,-1).join(", ")+", or "+i[i.length-1]}}(e)+" but "+function(e){return e?'"'+r(e)+'"':"end of input"}(t)+" found."},t.exports={SyntaxError:n,parse:function(e,t){t=void 0!==t?t:{};var i,r={},s={svg_path:ge},a=ge,o=function(e){if(!e)return[];for(var t=[],n=0;n<e.length;n++)t=t.concat.apply(t,e[n]);var i=t[0];return i&&"m"==i.code&&(delete i.relative,i.code="M"),t},l=function(e,t){return function(e,t){if(!t)return[e];for(var n=[e],i=0,r=t.length;i<r;i++)n[i+1]=t[i][1];return n}(e,t)},u=/^[Mm]/,c=he(["M","m"],!1,!1),h=function(e,t,n){var i=ze(e,[t]);return n&&(i=i.concat(ze("M"==e?"L":"l",n[1]))),i},d=/^[Zz]/,p=he(["Z","z"],!1,!1),f=function(){return ze("Z")},m=/^[Ll]/,g=he(["L","l"],!1,!1),v=function(e,t){return ze(e,t)},y=/^[Hh]/,x=he(["H","h"],!1,!1),b=function(e,t){return ze(e,t.map((function(e){return{x:e}})))},w=/^[Vv]/,D=he(["V","v"],!1,!1),_=function(e,t){return ze(e,t.map((function(e){return{y:e}})))},S=/^[Cc]/,E=he(["C","c"],!1,!1),C=function(e,t,n){return{x1:e.x,y1:e.y,x2:t.x,y2:t.y,x:n.x,y:n.y}},A=/^[Ss]/,M=he(["S","s"],!1,!1),T=function(e,t){return{x2:e.x,y2:e.y,x:t.x,y:t.y}},P=/^[Qq]/,F=he(["Q","q"],!1,!1),O=function(e,t){return{x1:e.x,y1:e.y,x:t.x,y:t.y}},I=/^[Tt]/,k=he(["T","t"],!1,!1),B=/^[Aa]/,R=he(["A","a"],!1,!1),L=function(e,t,n,i,r,s){return{rx:e,ry:t,xAxisRotation:n,largeArc:i,sweep:r,x:s.x,y:s.y}},z=function(e,t){return{x:e,y:t}},N=function(e){return 1*e},j=function(e){return 1*e.join("")},U=/^[01]/,V=he(["0","1"],!1,!1),H=function(e){return"1"==e},W=function(){return""},G=",",q=ce(",",!1),Y=function(e){return e.join("")},X=".",Q=ce(".",!1),K=/^[eE]/,Z=he(["e","E"],!1,!1),J=/^[+\-]/,$=he(["+","-"],!1,!1),ee=/^[0-9]/,te=he([["0","9"]],!1,!1),ne=function(e){return e.join("")},ie=/^[ \t\n\r]/,re=he([" ","\t","\n","\r"],!1,!1),se=0,ae=[{line:1,column:1}],oe=0,le=[],ue=0;if("startRule"in t){if(!(t.startRule in s))throw new Error("Can't start parsing from rule \""+t.startRule+'".');a=s[t.startRule]}function ce(e,t){return{type:"literal",text:e,ignoreCase:t}}function he(e,t,n){return{type:"class",parts:e,inverted:t,ignoreCase:n}}function de(t){var n,i=ae[t];if(i)return i;for(n=t-1;!ae[n];)n--;for(i={line:(i=ae[n]).line,column:i.column};n<t;)10===e.charCodeAt(n)?(i.line++,i.column=1):i.column++,n++;return ae[t]=i,i}function pe(e,t){var n=de(e),i=de(t);return{start:{offset:e,line:n.line,column:n.column},end:{offset:t,line:i.line,column:i.column}}}function fe(e){se<oe||(se>oe&&(oe=se,le=[]),le.push(e))}function me(e,t,i){return new n(n.buildMessage(e,t),e,t,i)}function ge(){var e,t,n,i,s;for(e=se,t=[],n=Be();n!==r;)t.push(n),n=Be();if(t!==r)if(n=function(){var e,t,n,i,s,a;if(e=se,t=ve(),t!==r){for(n=[],i=se,s=[],a=Be();a!==r;)s.push(a),a=Be();for(s!==r?(a=ve())!==r?i=s=[s,a]:(se=i,i=r):(se=i,i=r);i!==r;){for(n.push(i),i=se,s=[],a=Be();a!==r;)s.push(a),a=Be();s!==r?(a=ve())!==r?i=s=[s,a]:(se=i,i=r):(se=i,i=r)}n!==r?e=t=l(t,n):(se=e,e=r)}else se=e,e=r;return e}(),n===r&&(n=null),n!==r){for(i=[],s=Be();s!==r;)i.push(s),s=Be();i!==r?e=t=o(n):(se=e,e=r)}else se=e,e=r;else se=e,e=r;return e}function ve(){var t,n,i,s,a,o;if(t=se,n=function(){var t,n,i,s,a,o,l;if(t=se,u.test(e.charAt(se))?(n=e.charAt(se),se++):(n=r,0===ue&&fe(c)),n!==r){for(i=[],s=Be();s!==r;)i.push(s),s=Be();i!==r?(s=Ee())!==r?(a=se,(o=Te())===r&&(o=null),o!==r?(l=xe())!==r?a=o=[o,l]:(se=a,a=r):(se=a,a=r),a===r&&(a=null),a!==r?t=n=h(n,s,a):(se=t,t=r)):(se=t,t=r):(se=t,t=r)}else se=t,t=r;return t}(),n!==r){for(i=[],s=se,a=[],o=Be();o!==r;)a.push(o),o=Be();for(a!==r?(o=ye())!==r?s=a=[a,o]:(se=s,s=r):(se=s,s=r);s!==r;){for(i.push(s),s=se,a=[],o=Be();o!==r;)a.push(o),o=Be();a!==r?(o=ye())!==r?s=a=[a,o]:(se=s,s=r):(se=s,s=r)}i!==r?t=n=l(n,i):(se=t,t=r)}else se=t,t=r;return t}function ye(){var t;return t=function(){var t,n;return t=se,d.test(e.charAt(se))?(n=e.charAt(se),se++):(n=r,0===ue&&fe(p)),n!==r&&(n=f()),t=n,t}(),t===r&&(t=function(){var t,n,i,s;if(t=se,m.test(e.charAt(se))?(n=e.charAt(se),se++):(n=r,0===ue&&fe(g)),n!==r){for(i=[],s=Be();s!==r;)i.push(s),s=Be();i!==r?(s=xe())!==r?t=n=v(n,s):(se=t,t=r):(se=t,t=r)}else se=t,t=r;return t}(),t===r&&(t=function(){var t,n,i,s;if(t=se,y.test(e.charAt(se))?(n=e.charAt(se),se++):(n=r,0===ue&&fe(x)),n!==r){for(i=[],s=Be();s!==r;)i.push(s),s=Be();i!==r?(s=be())!==r?t=n=b(n,s):(se=t,t=r):(se=t,t=r)}else se=t,t=r;return t}(),t===r&&(t=function(){var t,n,i,s;if(t=se,w.test(e.charAt(se))?(n=e.charAt(se),se++):(n=r,0===ue&&fe(D)),n!==r){for(i=[],s=Be();s!==r;)i.push(s),s=Be();i!==r?(s=be())!==r?t=n=_(n,s):(se=t,t=r):(se=t,t=r)}else se=t,t=r;return t}(),t===r&&(t=function(){var t,n,i,s;if(t=se,S.test(e.charAt(se))?(n=e.charAt(se),se++):(n=r,0===ue&&fe(E)),n!==r){for(i=[],s=Be();s!==r;)i.push(s),s=Be();i!==r?(s=function(){var e,t,n,i,s,a;if(e=se,t=we(),t!==r){for(n=[],i=se,(s=Te())===r&&(s=null),s!==r?(a=we())!==r?i=s=[s,a]:(se=i,i=r):(se=i,i=r);i!==r;)n.push(i),i=se,(s=Te())===r&&(s=null),s!==r?(a=we())!==r?i=s=[s,a]:(se=i,i=r):(se=i,i=r);n!==r?e=t=l(t,n):(se=e,e=r)}else se=e,e=r;return e}(),s!==r?t=n=v(n,s):(se=t,t=r)):(se=t,t=r)}else se=t,t=r;return t}(),t===r&&(t=function(){var t,n,i,s;if(t=se,A.test(e.charAt(se))?(n=e.charAt(se),se++):(n=r,0===ue&&fe(M)),n!==r){for(i=[],s=Be();s!==r;)i.push(s),s=Be();i!==r?(s=function(){var e,t,n,i,s,a;if(e=se,t=De(),t!==r){for(n=[],i=se,(s=Te())===r&&(s=null),s!==r?(a=De())!==r?i=s=[s,a]:(se=i,i=r):(se=i,i=r);i!==r;)n.push(i),i=se,(s=Te())===r&&(s=null),s!==r?(a=De())!==r?i=s=[s,a]:(se=i,i=r):(se=i,i=r);n!==r?e=t=l(t,n):(se=e,e=r)}else se=e,e=r;return e}(),s!==r?t=n=v(n,s):(se=t,t=r)):(se=t,t=r)}else se=t,t=r;return t}(),t===r&&(t=function(){var t,n,i,s;if(t=se,P.test(e.charAt(se))?(n=e.charAt(se),se++):(n=r,0===ue&&fe(F)),n!==r){for(i=[],s=Be();s!==r;)i.push(s),s=Be();i!==r?(s=function(){var e,t,n,i,s,a;if(e=se,t=_e(),t!==r){for(n=[],i=se,(s=Te())===r&&(s=null),s!==r?(a=_e())!==r?i=s=[s,a]:(se=i,i=r):(se=i,i=r);i!==r;)n.push(i),i=se,(s=Te())===r&&(s=null),s!==r?(a=_e())!==r?i=s=[s,a]:(se=i,i=r):(se=i,i=r);n!==r?e=t=l(t,n):(se=e,e=r)}else se=e,e=r;return e}(),s!==r?t=n=v(n,s):(se=t,t=r)):(se=t,t=r)}else se=t,t=r;return t}(),t===r&&(t=function(){var t,n,i,s;if(t=se,I.test(e.charAt(se))?(n=e.charAt(se),se++):(n=r,0===ue&&fe(k)),n!==r){for(i=[],s=Be();s!==r;)i.push(s),s=Be();i!==r?(s=function(){var e,t,n,i,s,a;if(e=se,t=Ee(),t!==r){for(n=[],i=se,(s=Te())===r&&(s=null),s!==r?(a=Ee())!==r?i=s=[s,a]:(se=i,i=r):(se=i,i=r);i!==r;)n.push(i),i=se,(s=Te())===r&&(s=null),s!==r?(a=Ee())!==r?i=s=[s,a]:(se=i,i=r):(se=i,i=r);n!==r?e=t=l(t,n):(se=e,e=r)}else se=e,e=r;return e}(),s!==r?t=n=v(n,s):(se=t,t=r)):(se=t,t=r)}else se=t,t=r;return t}(),t===r&&(t=function(){var t,n,i,s;if(t=se,B.test(e.charAt(se))?(n=e.charAt(se),se++):(n=r,0===ue&&fe(R)),n!==r){for(i=[],s=Be();s!==r;)i.push(s),s=Be();i!==r?(s=function(){var e,t,n,i,s,a;if(e=se,t=Se(),t!==r){for(n=[],i=se,(s=Te())===r&&(s=null),s!==r?(a=Se())!==r?i=s=[s,a]:(se=i,i=r):(se=i,i=r);i!==r;)n.push(i),i=se,(s=Te())===r&&(s=null),s!==r?(a=Se())!==r?i=s=[s,a]:(se=i,i=r):(se=i,i=r);n!==r?e=t=l(t,n):(se=e,e=r)}else se=e,e=r;return e}(),s!==r?t=n=v(n,s):(se=t,t=r)):(se=t,t=r)}else se=t,t=r;return t}())))))))),t}function xe(){var e,t,n,i,s,a;if(e=se,(t=Ee())!==r){for(n=[],i=se,(s=Te())===r&&(s=null),s!==r?(a=Ee())!==r?i=s=[s,a]:(se=i,i=r):(se=i,i=r);i!==r;)n.push(i),i=se,(s=Te())===r&&(s=null),s!==r?(a=Ee())!==r?i=s=[s,a]:(se=i,i=r):(se=i,i=r);n!==r?e=t=l(t,n):(se=e,e=r)}else se=e,e=r;return e}function be(){var e,t,n,i,s,a;if(e=se,(t=Ae())!==r){for(n=[],i=se,(s=Te())===r&&(s=null),s!==r?(a=Ae())!==r?i=s=[s,a]:(se=i,i=r):(se=i,i=r);i!==r;)n.push(i),i=se,(s=Te())===r&&(s=null),s!==r?(a=Ae())!==r?i=s=[s,a]:(se=i,i=r):(se=i,i=r);n!==r?e=t=l(t,n):(se=e,e=r)}else se=e,e=r;return e}function we(){var e,t,n,i,s,a;return e=se,(t=Ee())!==r?((n=Te())===r&&(n=null),n!==r?(i=Ee())!==r?((s=Te())===r&&(s=null),s!==r?(a=Ee())!==r?e=t=C(t,i,a):(se=e,e=r):(se=e,e=r)):(se=e,e=r):(se=e,e=r)):(se=e,e=r),e}function De(){var e,t,n,i;return e=se,(t=Ee())!==r?((n=Te())===r&&(n=null),n!==r?(i=Ee())!==r?e=t=T(t,i):(se=e,e=r):(se=e,e=r)):(se=e,e=r),e}function _e(){var e,t,n,i;return e=se,(t=Ee())!==r?((n=Te())===r&&(n=null),n!==r?(i=Ee())!==r?e=t=O(t,i):(se=e,e=r):(se=e,e=r)):(se=e,e=r),e}function Se(){var e,t,n,i,s,a,o,l,u,c,h;return e=se,(t=Ce())!==r?((n=Te())===r&&(n=null),n!==r?(i=Ce())!==r?((s=Te())===r&&(s=null),s!==r?(a=Ae())!==r?Te()!==r?(o=Me())!==r?((l=Te())===r&&(l=null),l!==r?(u=Me())!==r?((c=Te())===r&&(c=null),c!==r?(h=Ee())!==r?e=t=L(t,i,a,o,u,h):(se=e,e=r):(se=e,e=r)):(se=e,e=r):(se=e,e=r)):(se=e,e=r):(se=e,e=r):(se=e,e=r):(se=e,e=r)):(se=e,e=r):(se=e,e=r)):(se=e,e=r),e}function Ee(){var e,t,n,i;return e=se,(t=Ae())!==r?((n=Te())===r&&(n=null),n!==r?(i=Ae())!==r?e=t=z(t,i):(se=e,e=r):(se=e,e=r)):(se=e,e=r),e}function Ce(){var e,t;return e=se,(t=Fe())===r&&(t=ke()),t!==r&&(t=N(t)),e=t}function Ae(){var e,t,n,i;return e=se,t=se,(n=Ie())===r&&(n=null),n!==r?(i=Fe())!==r?t=n=[n,i]:(se=t,t=r):(se=t,t=r),t===r&&(t=se,(n=Ie())===r&&(n=null),n!==r?(i=ke())!==r?t=n=[n,i]:(se=t,t=r):(se=t,t=r)),t!==r&&(t=j(t)),e=t}function Me(){var t,n;return t=se,U.test(e.charAt(se))?(n=e.charAt(se),se++):(n=r,0===ue&&fe(V)),n!==r&&(n=H(n)),t=n}function Te(){var e,t,n,i,s;if(e=se,t=[],(n=Be())!==r)for(;n!==r;)t.push(n),n=Be();else t=r;if(t!==r)if((n=Pe())===r&&(n=null),n!==r){for(i=[],s=Be();s!==r;)i.push(s),s=Be();i!==r?e=t=[t,n,i]:(se=e,e=r)}else se=e,e=r;else se=e,e=r;if(e===r){if(e=se,t=se,(n=Pe())!==r){for(i=[],s=Be();s!==r;)i.push(s),s=Be();i!==r?t=n=[n,i]:(se=t,t=r)}else se=t,t=r;t!==r&&(t=W()),e=t}return e}function Pe(){var t;return 44===e.charCodeAt(se)?(t=G,se++):(t=r,0===ue&&fe(q)),t}function Fe(){var t,n,i,s;return t=se,n=se,i=function(){var t,n,i,s,a;return t=se,n=se,i=ke(),i===r&&(i=null),i!==r?(46===e.charCodeAt(se)?(s=X,se++):(s=r,0===ue&&fe(Q)),s!==r&&(a=ke())!==r?(i=[i,s,a],n=i):(se=n,n=r)):(se=n,n=r),n===r&&(n=se,i=ke(),i!==r?(46===e.charCodeAt(se)?(s=X,se++):(s=r,0===ue&&fe(Q)),s!==r?(i=[i,s],n=i):(se=n,n=r)):(se=n,n=r)),n!==r&&(n=Y(n)),t=n,t}(),i!==r?((s=Oe())===r&&(s=null),s!==r?n=i=[i,s]:(se=n,n=r)):(se=n,n=r),n===r&&(n=se,(i=ke())!==r?(s=Oe())!==r?n=i=[i,s]:(se=n,n=r):(se=n,n=r)),n!==r&&(n=Y(n)),t=n}function Oe(){var t,n,i,s,a;return t=se,n=se,K.test(e.charAt(se))?(i=e.charAt(se),se++):(i=r,0===ue&&fe(Z)),i!==r?((s=Ie())===r&&(s=null),s!==r?(a=ke())!==r?n=i=[i,s,a]:(se=n,n=r):(se=n,n=r)):(se=n,n=r),n!==r&&(n=Y(n)),t=n}function Ie(){var t;return J.test(e.charAt(se))?(t=e.charAt(se),se++):(t=r,0===ue&&fe($)),t}function ke(){var t,n,i;if(t=se,n=[],ee.test(e.charAt(se))?(i=e.charAt(se),se++):(i=r,0===ue&&fe(te)),i!==r)for(;i!==r;)n.push(i),ee.test(e.charAt(se))?(i=e.charAt(se),se++):(i=r,0===ue&&fe(te));else n=r;return n!==r&&(n=ne(n)),t=n}function Be(){var t,n;return t=se,ie.test(e.charAt(se))?(n=e.charAt(se),se++):(n=r,0===ue&&fe(re)),n!==r&&(n=W()),t=n}var Re={m:"moveto",l:"lineto",h:"horizontal lineto",v:"vertical lineto",c:"curveto",s:"smooth curveto",q:"quadratic curveto",t:"smooth quadratic curveto",a:"elliptical arc",z:"closepath"};for(var Le in Re)Re[Le.toUpperCase()]=Re[Le];function ze(e,t){t||(t=[{}]);for(var n=t.length;n--;){var i={code:e,command:Re[e]};for(var r in e==e.toLowerCase()&&(i.relative=!0),t[n])i[r]=t[n][r];t[n]=i}return t}if((i=a())!==r&&se===e.length)return i;throw i!==r&&se<e.length&&fe({type:"end"}),me(le,oe<e.length?e.charAt(oe):null,oe<e.length?pe(oe,oe+1):pe(oe,oe))}}})),Im=Em(((e,t)=>{var n=Om().parse;n.parseSVG=n,n.makeAbsolute=function(e){var t,n={x:0,y:0},i={x:"x0",y:"y0",x1:"x0",y1:"y0",x2:"x0",y2:"y0"};return e.forEach((function(e){for(var r in"moveto"===e.command&&(t=e),e.x0=n.x,e.y0=n.y,i)r in e&&(e[r]+=e.relative?e[i[r]]:0);"x"in e||(e.x=n.x),"y"in e||(e.y=n.y),e.relative=!1,e.code=e.code.toUpperCase(),"closepath"==e.command&&(e.x=t.x,e.y=t.y),n=e})),e},t.exports=n})),km=Em(((e,t)=>{t.exports=function(e,t){for(var n=e.split("."),i=t.split("."),r=0;r<3;r++){var s=Number(n[r]),a=Number(i[r]);if(s>a)return 1;if(a>s)return-1;if(!isNaN(s)&&isNaN(a))return 1;if(isNaN(s)&&!isNaN(a))return-1}return 0}})),Bm="149",Rm=0,Lm=1,zm=2,Nm=3,jm=0,Um=1,Vm=2,Hm=100,Wm=101,Gm=102,qm=200,Ym=201,Xm=202,Qm=203,Km=204,Zm=205,Jm=206,$m=207,eg=208,tg=209,ng=210,ig=301,rg=302,sg=306,ag=1e3,og=1001,lg=1002,ug=1003,cg=1004,hg=1005,dg=1006,pg=1007,fg=1008,mg=1009,gg=1014,vg=1015,yg=1016,xg=1020,bg=1023,wg=1026,Dg=1027,_g=1028,Sg=1030,Eg=33776,Cg=33777,Ag=33778,Mg=33779,Tg=36492,Pg=2202,Fg=2300,Og=2301,Ig=2302,kg=2400,Bg=2401,Rg=2402,Lg=2500,zg=3e3,Ng=3001,jg=3200,Ug="srgb",Vg="srgb-linear",Hg=7680,Wg=35044,Gg="300 es",qg=1035,Yg=class{addEventListener(e,t){void 0===this._listeners&&(this._listeners={});let n=this._listeners;void 0===n[e]&&(n[e]=[]),-1===n[e].indexOf(t)&&n[e].push(t)}hasEventListener(e,t){if(void 0===this._listeners)return!1;let n=this._listeners;return void 0!==n[e]&&-1!==n[e].indexOf(t)}removeEventListener(e,t){if(void 0===this._listeners)return;let n=this._listeners[e];if(void 0!==n){let e=n.indexOf(t);-1!==e&&n.splice(e,1)}}dispatchEvent(e){if(void 0===this._listeners)return;let t=this._listeners[e.type];if(void 0!==t){e.target=this;let n=t.slice(0);for(let t=0,i=n.length;t<i;t++)n[t].call(this,e);e.target=null}}},Xg=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"],Qg=1234567,Kg=Math.PI/180,Zg=180/Math.PI;function Jg(){let e=4294967295*Math.random()|0,t=4294967295*Math.random()|0,n=4294967295*Math.random()|0,i=4294967295*Math.random()|0;return(Xg[255&e]+Xg[e>>8&255]+Xg[e>>16&255]+Xg[e>>24&255]+"-"+Xg[255&t]+Xg[t>>8&255]+"-"+Xg[t>>16&15|64]+Xg[t>>24&255]+"-"+Xg[63&n|128]+Xg[n>>8&255]+"-"+Xg[n>>16&255]+Xg[n>>24&255]+Xg[255&i]+Xg[i>>8&255]+Xg[i>>16&255]+Xg[i>>24&255]).toLowerCase()}function $g(e,t,n){return Math.max(t,Math.min(n,e))}function ev(e,t){return(e%t+t)%t}function tv(e,t,n){return(1-n)*e+n*t}function nv(e){return 0===(e&e-1)&&0!==e}function iv(e){return Math.pow(2,Math.ceil(Math.log(e)/Math.LN2))}function rv(e){return Math.pow(2,Math.floor(Math.log(e)/Math.LN2))}function sv(e,t){switch(t.constructor){case Float32Array:return e;case Uint16Array:return e/65535;case Uint8Array:return e/255;case Int16Array:return Math.max(e/32767,-1);case Int8Array:return Math.max(e/127,-1);default:throw new Error("Invalid component type.")}}function av(e,t){switch(t.constructor){case Float32Array:return e;case Uint16Array:return Math.round(65535*e);case Uint8Array:return Math.round(255*e);case Int16Array:return Math.round(32767*e);case Int8Array:return Math.round(127*e);default:throw new Error("Invalid component type.")}}var ov=Object.freeze({__proto__:null,DEG2RAD:Kg,RAD2DEG:Zg,ceilPowerOfTwo:iv,clamp:$g,damp:function(e,t,n,i){return tv(e,t,1-Math.exp(-n*i))},degToRad:function(e){return e*Kg},denormalize:sv,euclideanModulo:ev,floorPowerOfTwo:rv,generateUUID:Jg,inverseLerp:function(e,t,n){return e!==t?(n-e)/(t-e):0},isPowerOfTwo:nv,lerp:tv,mapLinear:function(e,t,n,i,r){return i+(e-t)*(r-i)/(n-t)},normalize:av,pingpong:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return t-Math.abs(ev(e,2*t)-t)},radToDeg:function(e){return e*Zg},randFloat:function(e,t){return e+Math.random()*(t-e)},randFloatSpread:function(e){return e*(.5-Math.random())},randInt:function(e,t){return e+Math.floor(Math.random()*(t-e+1))},seededRandom:function(e){void 0!==e&&(Qg=e);let t=Qg+=1831565813;return t=Math.imul(t^t>>>15,1|t),t^=t+Math.imul(t^t>>>7,61|t),((t^t>>>14)>>>0)/4294967296},setQuaternionFromProperEuler:function(e,t,n,i,r){let s=Math.cos,a=Math.sin,o=s(n/2),l=a(n/2),u=s((t+i)/2),c=a((t+i)/2),h=s((t-i)/2),d=a((t-i)/2),p=s((i-t)/2),f=a((i-t)/2);switch(r){case"XYX":e.set(o*c,l*h,l*d,o*u);break;case"YZY":e.set(l*d,o*c,l*h,o*u);break;case"ZXZ":e.set(l*h,l*d,o*c,o*u);break;case"XZX":e.set(o*c,l*f,l*p,o*u);break;case"YXY":e.set(l*p,o*c,l*f,o*u);break;case"ZYZ":e.set(l*f,l*p,o*c,o*u);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+r)}},smootherstep:function(e,t,n){return e<=t?0:e>=n?1:(e=(e-t)/(n-t))*e*e*(e*(6*e-15)+10)},smoothstep:function(e,t,n){return e<=t?0:e>=n?1:(e=(e-t)/(n-t))*e*(3-2*e)}}),lv=class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;lv.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){let t=this.x,n=this.y,i=e.elements;return this.x=i[0]*t+i[3]*n+i[6],this.y=i[1]*t+i[4]*n+i[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this}clampLength(e,t){let n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){let t=this.x-e.x,n=this.y-e.y;return t*t+n*n}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.x=e[t],this.y=e[t+1],this}toArray(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){let n=Math.cos(t),i=Math.sin(t),r=this.x-e.x,s=this.y-e.y;return this.x=r*n-s*i+e.x,this.y=r*i+s*n+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}},uv=class{constructor(){uv.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1]}set(e,t,n,i,r,s,a,o,l){let u=this.elements;return u[0]=e,u[1]=i,u[2]=a,u[3]=t,u[4]=r,u[5]=o,u[6]=n,u[7]=s,u[8]=l,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){let t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],this}extractBasis(e,t,n){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),n.setFromMatrix3Column(this,2),this}setFromMatrix4(e){let t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){let n=e.elements,i=t.elements,r=this.elements,s=n[0],a=n[3],o=n[6],l=n[1],u=n[4],c=n[7],h=n[2],d=n[5],p=n[8],f=i[0],m=i[3],g=i[6],v=i[1],y=i[4],x=i[7],b=i[2],w=i[5],D=i[8];return r[0]=s*f+a*v+o*b,r[3]=s*m+a*y+o*w,r[6]=s*g+a*x+o*D,r[1]=l*f+u*v+c*b,r[4]=l*m+u*y+c*w,r[7]=l*g+u*x+c*D,r[2]=h*f+d*v+p*b,r[5]=h*m+d*y+p*w,r[8]=h*g+d*x+p*D,this}multiplyScalar(e){let t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){let e=this.elements,t=e[0],n=e[1],i=e[2],r=e[3],s=e[4],a=e[5],o=e[6],l=e[7],u=e[8];return t*s*u-t*a*l-n*r*u+n*a*o+i*r*l-i*s*o}invert(){let e=this.elements,t=e[0],n=e[1],i=e[2],r=e[3],s=e[4],a=e[5],o=e[6],l=e[7],u=e[8],c=u*s-a*l,h=a*o-u*r,d=l*r-s*o,p=t*c+n*h+i*d;if(0===p)return this.set(0,0,0,0,0,0,0,0,0);let f=1/p;return e[0]=c*f,e[1]=(i*l-u*n)*f,e[2]=(a*n-i*s)*f,e[3]=h*f,e[4]=(u*t-i*o)*f,e[5]=(i*r-a*t)*f,e[6]=d*f,e[7]=(n*o-l*t)*f,e[8]=(s*t-n*r)*f,this}transpose(){let e,t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){let t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,n,i,r,s,a){let o=Math.cos(r),l=Math.sin(r);return this.set(n*o,n*l,-n*(o*s+l*a)+s+e,-i*l,i*o,-i*(-l*s+o*a)+a+t,0,0,1),this}scale(e,t){return this.premultiply(cv.makeScale(e,t)),this}rotate(e){return this.premultiply(cv.makeRotation(-e)),this}translate(e,t){return this.premultiply(cv.makeTranslation(e,t)),this}makeTranslation(e,t){return this.set(1,0,e,0,1,t,0,0,1),this}makeRotation(e){let t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,n,t,0,0,0,1),this}makeScale(e,t){return this.set(e,0,0,0,t,0,0,0,1),this}equals(e){let t=this.elements,n=e.elements;for(let i=0;i<9;i++)if(t[i]!==n[i])return!1;return!0}fromArray(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;for(let n=0;n<9;n++)this.elements[n]=e[n+t];return this}toArray(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e}clone(){return(new this.constructor).fromArray(this.elements)}},cv=new uv;function hv(e){for(let t=e.length-1;t>=0;--t)if(e[t]>=65535)return!0;return!1}var dv={Int8Array:Int8Array,Uint8Array:Uint8Array,Uint8ClampedArray:Uint8ClampedArray,Int16Array:Int16Array,Uint16Array:Uint16Array,Int32Array:Int32Array,Uint32Array:Uint32Array,Float32Array:Float32Array,Float64Array:Float64Array};function pv(e,t){return new dv[e](t)}function fv(e){return document.createElementNS("http://www.w3.org/1999/xhtml",e)}function mv(e){return e<.04045?.0773993808*e:Math.pow(.9478672986*e+.0521327014,2.4)}function gv(e){return e<.0031308?12.92*e:1.055*Math.pow(e,.41666)-.055}var vv={[Ug]:{[Vg]:mv},[Vg]:{[Ug]:gv}},yv={legacyMode:!0,get workingColorSpace(){return Vg},set workingColorSpace(e){console.warn("THREE.ColorManagement: .workingColorSpace is readonly.")},convert:function(e,t,n){if(this.legacyMode||t===n||!t||!n)return e;if(vv[t]&&void 0!==vv[t][n]){let i=vv[t][n];return e.r=i(e.r),e.g=i(e.g),e.b=i(e.b),e}throw new Error("Unsupported color space conversion.")},fromWorkingColorSpace:function(e,t){return this.convert(e,this.workingColorSpace,t)},toWorkingColorSpace:function(e,t){return this.convert(e,t,this.workingColorSpace)}},xv={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},bv={r:0,g:0,b:0},wv={h:0,s:0,l:0},Dv={h:0,s:0,l:0};function _v(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+6*(t-e)*n:n<.5?t:n<2/3?e+6*(t-e)*(2/3-n):e}function Sv(e,t){return t.r=e.r,t.g=e.g,t.b=e.b,t}var Ev=class{constructor(e,t,n){return this.isColor=!0,this.r=1,this.g=1,this.b=1,void 0===t&&void 0===n?this.set(e):this.setRGB(e,t,n)}set(e){return e&&e.isColor?this.copy(e):"number"==typeof e?this.setHex(e):"string"==typeof e&&this.setStyle(e),this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Ug;return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(255&e)/255,yv.toWorkingColorSpace(this,t),this}setRGB(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:yv.workingColorSpace;return this.r=e,this.g=t,this.b=n,yv.toWorkingColorSpace(this,i),this}setHSL(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:yv.workingColorSpace;if(e=ev(e,1),t=$g(t,0,1),n=$g(n,0,1),0===t)this.r=this.g=this.b=n;else{let i=n<=.5?n*(1+t):n+t-n*t,r=2*n-i;this.r=_v(r,i,e+1/3),this.g=_v(r,i,e),this.b=_v(r,i,e-1/3)}return yv.toWorkingColorSpace(this,i),this}setStyle(e){let t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Ug;function i(t){void 0!==t&&parseFloat(t)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}if(t=/^((?:rgb|hsl)a?)\(([^\)]*)\)/.exec(e)){let e,r=t[1],s=t[2];switch(r){case"rgb":case"rgba":if(e=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(s))return this.r=Math.min(255,parseInt(e[1],10))/255,this.g=Math.min(255,parseInt(e[2],10))/255,this.b=Math.min(255,parseInt(e[3],10))/255,yv.toWorkingColorSpace(this,n),i(e[4]),this;if(e=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(s))return this.r=Math.min(100,parseInt(e[1],10))/100,this.g=Math.min(100,parseInt(e[2],10))/100,this.b=Math.min(100,parseInt(e[3],10))/100,yv.toWorkingColorSpace(this,n),i(e[4]),this;break;case"hsl":case"hsla":if(e=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(s)){let t=parseFloat(e[1])/360,r=parseFloat(e[2])/100,s=parseFloat(e[3])/100;return i(e[4]),this.setHSL(t,r,s,n)}}}else if(t=/^\#([A-Fa-f\d]+)$/.exec(e)){let e=t[1],i=e.length;if(3===i)return this.r=parseInt(e.charAt(0)+e.charAt(0),16)/255,this.g=parseInt(e.charAt(1)+e.charAt(1),16)/255,this.b=parseInt(e.charAt(2)+e.charAt(2),16)/255,yv.toWorkingColorSpace(this,n),this;if(6===i)return this.r=parseInt(e.charAt(0)+e.charAt(1),16)/255,this.g=parseInt(e.charAt(2)+e.charAt(3),16)/255,this.b=parseInt(e.charAt(4)+e.charAt(5),16)/255,yv.toWorkingColorSpace(this,n),this}return e&&e.length>0?this.setColorName(e,n):this}setColorName(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Ug,n=xv[e.toLowerCase()];return void 0!==n?this.setHex(n,t):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=mv(e.r),this.g=mv(e.g),this.b=mv(e.b),this}copyLinearToSRGB(e){return this.r=gv(e.r),this.g=gv(e.g),this.b=gv(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ug;return yv.fromWorkingColorSpace(Sv(this,bv),e),$g(255*bv.r,0,255)<<16^$g(255*bv.g,0,255)<<8^$g(255*bv.b,0,255)}getHexString(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ug;return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:yv.workingColorSpace;yv.fromWorkingColorSpace(Sv(this,bv),t);let n,i,r=bv.r,s=bv.g,a=bv.b,o=Math.max(r,s,a),l=Math.min(r,s,a),u=(l+o)/2;if(l===o)n=0,i=0;else{let e=o-l;switch(i=u<=.5?e/(o+l):e/(2-o-l),o){case r:n=(s-a)/e+(s<a?6:0);break;case s:n=(a-r)/e+2;break;case a:n=(r-s)/e+4}n/=6}return e.h=n,e.s=i,e.l=u,e}getRGB(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:yv.workingColorSpace;return yv.fromWorkingColorSpace(Sv(this,bv),t),e.r=bv.r,e.g=bv.g,e.b=bv.b,e}getStyle(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ug;return yv.fromWorkingColorSpace(Sv(this,bv),e),e!==Ug?"color(".concat(e," ").concat(bv.r," ").concat(bv.g," ").concat(bv.b,")"):"rgb(".concat(255*bv.r|0,",").concat(255*bv.g|0,",").concat(255*bv.b|0,")")}offsetHSL(e,t,n){return this.getHSL(wv),wv.h+=e,wv.s+=t,wv.l+=n,this.setHSL(wv.h,wv.s,wv.l),this}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,n){return this.r=e.r+(t.r-e.r)*n,this.g=e.g+(t.g-e.g)*n,this.b=e.b+(t.b-e.b)*n,this}lerpHSL(e,t){this.getHSL(wv),e.getHSL(Dv);let n=tv(wv.h,Dv.h,t),i=tv(wv.s,Dv.s,t),r=tv(wv.l,Dv.l,t);return this.setHSL(n,i,r),this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}};Ev.NAMES=xv;var Cv,Av=class{static getDataURL(e){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let t;if(e instanceof HTMLCanvasElement)t=e;else{void 0===Cv&&(Cv=fv("canvas")),Cv.width=e.width,Cv.height=e.height;let n=Cv.getContext("2d");e instanceof ImageData?n.putImageData(e,0,0):n.drawImage(e,0,0,e.width,e.height),t=Cv}return t.width>2048||t.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),t.toDataURL("image/jpeg",.6)):t.toDataURL("image/png")}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){let t=fv("canvas");t.width=e.width,t.height=e.height;let n=t.getContext("2d");n.drawImage(e,0,0,e.width,e.height);let i=n.getImageData(0,0,e.width,e.height),r=i.data;for(let e=0;e<r.length;e++)r[e]=255*mv(r[e]/255);return n.putImageData(i,0,0),t}if(e.data){let t=e.data.slice(0);for(let e=0;e<t.length;e++)t instanceof Uint8Array||t instanceof Uint8ClampedArray?t[e]=Math.floor(255*mv(t[e]/255)):t[e]=mv(t[e]);return{data:t,width:e.width,height:e.height}}return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}},Mv=class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.isSource=!0,this.uuid=Jg(),this.data=e,this.version=0}set needsUpdate(e){!0===e&&this.version++}toJSON(e){let t=void 0===e||"string"==typeof e;if(!t&&void 0!==e.images[this.uuid])return e.images[this.uuid];let n={uuid:this.uuid,url:""},i=this.data;if(null!==i){let e;if(Array.isArray(i)){e=[];for(let t=0,n=i.length;t<n;t++)i[t].isDataTexture?e.push(Tv(i[t].image)):e.push(Tv(i[t]))}else e=Tv(i);n.url=e}return t||(e.images[this.uuid]=n),n}};function Tv(e){return typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap?Av.getDataURL(e):e.data?{data:Array.from(e.data),width:e.width,height:e.height,type:e.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}var Pv=0,Fv=class extends Yg{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Fv.DEFAULT_IMAGE,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Fv.DEFAULT_MAPPING,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:og,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:og,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:dg,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:fg,a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:bg,o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:mg,l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:Fv.DEFAULT_ANISOTROPY,u=arguments.length>9&&void 0!==arguments[9]?arguments[9]:zg;super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:Pv++}),this.uuid=Jg(),this.name="",this.source=new Mv(e),this.mipmaps=[],this.mapping=t,this.wrapS=n,this.wrapT=i,this.magFilter=r,this.minFilter=s,this.anisotropy=l,this.format=a,this.internalFormat=null,this.type=o,this.offset=new lv(0,0),this.repeat=new lv(1,1),this.center=new lv(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new uv,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=u,this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(e){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return(new this.constructor).copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.encoding=e.encoding,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}toJSON(e){let t=void 0===e||"string"==typeof e;if(!t&&void 0!==e.textures[this.uuid])return e.textures[this.uuid];let n={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(n.userData=this.userData),t||(e.textures[this.uuid]=n),n}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(300!==this.mapping)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case ag:e.x=e.x-Math.floor(e.x);break;case og:e.x=e.x<0?0:1;break;case lg:1===Math.abs(Math.floor(e.x)%2)?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x)}if(e.y<0||e.y>1)switch(this.wrapT){case ag:e.y=e.y-Math.floor(e.y);break;case og:e.y=e.y<0?0:1;break;case lg:1===Math.abs(Math.floor(e.y)%2)?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y)}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){!0===e&&(this.version++,this.source.needsUpdate=!0)}};Fv.DEFAULT_IMAGE=null,Fv.DEFAULT_MAPPING=300,Fv.DEFAULT_ANISOTROPY=1;var Ov=class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;Ov.prototype.isVector4=!0,this.x=e,this.y=t,this.z=n,this.w=i}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,n,i){return this.x=e,this.y=t,this.z=n,this.w=i,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=void 0!==e.w?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){let t=this.x,n=this.y,i=this.z,r=this.w,s=e.elements;return this.x=s[0]*t+s[4]*n+s[8]*i+s[12]*r,this.y=s[1]*t+s[5]*n+s[9]*i+s[13]*r,this.z=s[2]*t+s[6]*n+s[10]*i+s[14]*r,this.w=s[3]*t+s[7]*n+s[11]*i+s[15]*r,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);let t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,n,i,r,s=e.elements,a=s[0],o=s[4],l=s[8],u=s[1],c=s[5],h=s[9],d=s[2],p=s[6],f=s[10];if(Math.abs(o-u)<.01&&Math.abs(l-d)<.01&&Math.abs(h-p)<.01){if(Math.abs(o+u)<.1&&Math.abs(l+d)<.1&&Math.abs(h+p)<.1&&Math.abs(a+c+f-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;let e=(a+1)/2,s=(c+1)/2,m=(f+1)/2,g=(o+u)/4,v=(l+d)/4,y=(h+p)/4;return e>s&&e>m?e<.01?(n=0,i=.707106781,r=.707106781):(n=Math.sqrt(e),i=g/n,r=v/n):s>m?s<.01?(n=.707106781,i=0,r=.707106781):(i=Math.sqrt(s),n=g/i,r=y/i):m<.01?(n=.707106781,i=.707106781,r=0):(r=Math.sqrt(m),n=v/r,i=y/r),this.set(n,i,r,t),this}let m=Math.sqrt((p-h)*(p-h)+(l-d)*(l-d)+(u-o)*(u-o));return Math.abs(m)<.001&&(m=1),this.x=(p-h)/m,this.y=(l-d)/m,this.z=(u-o)/m,this.w=Math.acos((a+c+f-1)/2),this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this}clampLength(e,t){let n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this.w=e.w+(t.w-e.w)*n,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}},Iv=class extends Yg{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};super(),this.isWebGLRenderTarget=!0,this.width=e,this.height=t,this.depth=1,this.scissor=new Ov(0,0,e,t),this.scissorTest=!1,this.viewport=new Ov(0,0,e,t);let i={width:e,height:t,depth:1};this.texture=new Fv(i,n.mapping,n.wrapS,n.wrapT,n.magFilter,n.minFilter,n.format,n.type,n.anisotropy,n.encoding),this.texture.isRenderTargetTexture=!0,this.texture.flipY=!1,this.texture.generateMipmaps=void 0!==n.generateMipmaps&&n.generateMipmaps,this.texture.internalFormat=void 0!==n.internalFormat?n.internalFormat:null,this.texture.minFilter=void 0!==n.minFilter?n.minFilter:dg,this.depthBuffer=void 0===n.depthBuffer||n.depthBuffer,this.stencilBuffer=void 0!==n.stencilBuffer&&n.stencilBuffer,this.depthTexture=void 0!==n.depthTexture?n.depthTexture:null,this.samples=void 0!==n.samples?n.samples:0}setSize(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;(this.width!==e||this.height!==t||this.depth!==n)&&(this.width=e,this.height=t,this.depth=n,this.texture.image.width=e,this.texture.image.height=t,this.texture.image.depth=n,this.dispose()),this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return(new this.constructor).copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.texture.isRenderTargetTexture=!0;let t=Object.assign({},e.texture.image);return this.texture.source=new Mv(t),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,null!==e.depthTexture&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}},kv=class extends Fv{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;super(null),this.isDataArrayTexture=!0,this.image={data:e,width:t,height:n,depth:i},this.magFilter=ug,this.minFilter=ug,this.wrapR=og,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}},Bv=class extends Iv{constructor(){let e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,arguments.length>3&&void 0!==arguments[3]?arguments[3]:{}),this.isWebGLMultipleRenderTargets=!0;let t=this.texture;this.texture=[];for(let n=0;n<e;n++)this.texture[n]=t.clone(),this.texture[n].isRenderTargetTexture=!0}setSize(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;if(this.width!==e||this.height!==t||this.depth!==n){this.width=e,this.height=t,this.depth=n;for(let i=0,r=this.texture.length;i<r;i++)this.texture[i].image.width=e,this.texture[i].image.height=t,this.texture[i].image.depth=n;this.dispose()}return this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t),this}copy(e){this.dispose(),this.width=e.width,this.height=e.height,this.depth=e.depth,this.viewport.set(0,0,this.width,this.height),this.scissor.set(0,0,this.width,this.height),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,null!==e.depthTexture&&(this.depthTexture=e.depthTexture.clone()),this.texture.length=0;for(let t=0,n=e.texture.length;t<n;t++)this.texture[t]=e.texture[t].clone(),this.texture[t].isRenderTargetTexture=!0;return this}},Rv=class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;this.isQuaternion=!0,this._x=e,this._y=t,this._z=n,this._w=i}static slerpFlat(e,t,n,i,r,s,a){let o=n[i+0],l=n[i+1],u=n[i+2],c=n[i+3],h=r[s+0],d=r[s+1],p=r[s+2],f=r[s+3];if(0===a)return e[t+0]=o,e[t+1]=l,e[t+2]=u,void(e[t+3]=c);if(1===a)return e[t+0]=h,e[t+1]=d,e[t+2]=p,void(e[t+3]=f);if(c!==f||o!==h||l!==d||u!==p){let e=1-a,t=o*h+l*d+u*p+c*f,n=t>=0?1:-1,i=1-t*t;if(i>Number.EPSILON){let r=Math.sqrt(i),s=Math.atan2(r,t*n);e=Math.sin(e*s)/r,a=Math.sin(a*s)/r}let r=a*n;if(o=o*e+h*r,l=l*e+d*r,u=u*e+p*r,c=c*e+f*r,e===1-a){let e=1/Math.sqrt(o*o+l*l+u*u+c*c);o*=e,l*=e,u*=e,c*=e}}e[t]=o,e[t+1]=l,e[t+2]=u,e[t+3]=c}static multiplyQuaternionsFlat(e,t,n,i,r,s){let a=n[i],o=n[i+1],l=n[i+2],u=n[i+3],c=r[s],h=r[s+1],d=r[s+2],p=r[s+3];return e[t]=a*p+u*c+o*d-l*h,e[t+1]=o*p+u*h+l*c-a*d,e[t+2]=l*p+u*d+a*h-o*c,e[t+3]=u*p-a*c-o*h-l*d,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,n,i){return this._x=e,this._y=t,this._z=n,this._w=i,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t){let n=e._x,i=e._y,r=e._z,s=e._order,a=Math.cos,o=Math.sin,l=a(n/2),u=a(i/2),c=a(r/2),h=o(n/2),d=o(i/2),p=o(r/2);switch(s){case"XYZ":this._x=h*u*c+l*d*p,this._y=l*d*c-h*u*p,this._z=l*u*p+h*d*c,this._w=l*u*c-h*d*p;break;case"YXZ":this._x=h*u*c+l*d*p,this._y=l*d*c-h*u*p,this._z=l*u*p-h*d*c,this._w=l*u*c+h*d*p;break;case"ZXY":this._x=h*u*c-l*d*p,this._y=l*d*c+h*u*p,this._z=l*u*p+h*d*c,this._w=l*u*c-h*d*p;break;case"ZYX":this._x=h*u*c-l*d*p,this._y=l*d*c+h*u*p,this._z=l*u*p-h*d*c,this._w=l*u*c+h*d*p;break;case"YZX":this._x=h*u*c+l*d*p,this._y=l*d*c+h*u*p,this._z=l*u*p-h*d*c,this._w=l*u*c-h*d*p;break;case"XZY":this._x=h*u*c-l*d*p,this._y=l*d*c-h*u*p,this._z=l*u*p+h*d*c,this._w=l*u*c+h*d*p;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+s)}return!1!==t&&this._onChangeCallback(),this}setFromAxisAngle(e,t){let n=t/2,i=Math.sin(n);return this._x=e.x*i,this._y=e.y*i,this._z=e.z*i,this._w=Math.cos(n),this._onChangeCallback(),this}setFromRotationMatrix(e){let t=e.elements,n=t[0],i=t[4],r=t[8],s=t[1],a=t[5],o=t[9],l=t[2],u=t[6],c=t[10],h=n+a+c;if(h>0){let e=.5/Math.sqrt(h+1);this._w=.25/e,this._x=(u-o)*e,this._y=(r-l)*e,this._z=(s-i)*e}else if(n>a&&n>c){let e=2*Math.sqrt(1+n-a-c);this._w=(u-o)/e,this._x=.25*e,this._y=(i+s)/e,this._z=(r+l)/e}else if(a>c){let e=2*Math.sqrt(1+a-n-c);this._w=(r-l)/e,this._x=(i+s)/e,this._y=.25*e,this._z=(o+u)/e}else{let e=2*Math.sqrt(1+c-n-a);this._w=(s-i)/e,this._x=(r+l)/e,this._y=(o+u)/e,this._z=.25*e}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let n=e.dot(t)+1;return n<Number.EPSILON?(n=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=n):(this._x=0,this._y=-e.z,this._z=e.y,this._w=n)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=n),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs($g(this.dot(e),-1,1)))}rotateTowards(e,t){let n=this.angleTo(e);if(0===n)return this;let i=Math.min(1,t/n);return this.slerp(e,i),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return 0===e?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){let n=e._x,i=e._y,r=e._z,s=e._w,a=t._x,o=t._y,l=t._z,u=t._w;return this._x=n*u+s*a+i*l-r*o,this._y=i*u+s*o+r*a-n*l,this._z=r*u+s*l+n*o-i*a,this._w=s*u-n*a-i*o-r*l,this._onChangeCallback(),this}slerp(e,t){if(0===t)return this;if(1===t)return this.copy(e);let n=this._x,i=this._y,r=this._z,s=this._w,a=s*e._w+n*e._x+i*e._y+r*e._z;if(a<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,a=-a):this.copy(e),a>=1)return this._w=s,this._x=n,this._y=i,this._z=r,this;let o=1-a*a;if(o<=Number.EPSILON){let e=1-t;return this._w=e*s+t*this._w,this._x=e*n+t*this._x,this._y=e*i+t*this._y,this._z=e*r+t*this._z,this.normalize(),this._onChangeCallback(),this}let l=Math.sqrt(o),u=Math.atan2(l,a),c=Math.sin((1-t)*u)/l,h=Math.sin(t*u)/l;return this._w=s*c+this._w*h,this._x=n*c+this._x*h,this._y=i*c+this._y*h,this._z=r*c+this._z*h,this._onChangeCallback(),this}slerpQuaternions(e,t,n){return this.copy(e).slerp(t,n)}random(){let e=Math.random(),t=Math.sqrt(1-e),n=Math.sqrt(e),i=2*Math.PI*Math.random(),r=2*Math.PI*Math.random();return this.set(t*Math.cos(i),n*Math.sin(r),n*Math.cos(r),t*Math.sin(i))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}},Lv=class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;Lv.prototype.isVector3=!0,this.x=e,this.y=t,this.z=n}set(e,t,n){return void 0===n&&(n=this.z),this.x=e,this.y=t,this.z=n,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion(Nv.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(Nv.setFromAxisAngle(e,t))}applyMatrix3(e){let t=this.x,n=this.y,i=this.z,r=e.elements;return this.x=r[0]*t+r[3]*n+r[6]*i,this.y=r[1]*t+r[4]*n+r[7]*i,this.z=r[2]*t+r[5]*n+r[8]*i,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){let t=this.x,n=this.y,i=this.z,r=e.elements,s=1/(r[3]*t+r[7]*n+r[11]*i+r[15]);return this.x=(r[0]*t+r[4]*n+r[8]*i+r[12])*s,this.y=(r[1]*t+r[5]*n+r[9]*i+r[13])*s,this.z=(r[2]*t+r[6]*n+r[10]*i+r[14])*s,this}applyQuaternion(e){let t=this.x,n=this.y,i=this.z,r=e.x,s=e.y,a=e.z,o=e.w,l=o*t+s*i-a*n,u=o*n+a*t-r*i,c=o*i+r*n-s*t,h=-r*t-s*n-a*i;return this.x=l*o+h*-r+u*-a-c*-s,this.y=u*o+h*-s+c*-r-l*-a,this.z=c*o+h*-a+l*-s-u*-r,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){let t=this.x,n=this.y,i=this.z,r=e.elements;return this.x=r[0]*t+r[4]*n+r[8]*i,this.y=r[1]*t+r[5]*n+r[9]*i,this.z=r[2]*t+r[6]*n+r[10]*i,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this}clampLength(e,t){let n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){let n=e.x,i=e.y,r=e.z,s=t.x,a=t.y,o=t.z;return this.x=i*o-r*a,this.y=r*s-n*o,this.z=n*a-i*s,this}projectOnVector(e){let t=e.lengthSq();if(0===t)return this.set(0,0,0);let n=e.dot(this)/t;return this.copy(e).multiplyScalar(n)}projectOnPlane(e){return zv.copy(this).projectOnVector(e),this.sub(zv)}reflect(e){return this.sub(zv.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){let t=Math.sqrt(this.lengthSq()*e.lengthSq());if(0===t)return Math.PI/2;let n=this.dot(e)/t;return Math.acos($g(n,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){let t=this.x-e.x,n=this.y-e.y,i=this.z-e.z;return t*t+n*n+i*i}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,n){let i=Math.sin(t)*e;return this.x=i*Math.sin(n),this.y=Math.cos(t)*e,this.z=i*Math.cos(n),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,n){return this.x=e*Math.sin(t),this.y=n,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){let t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){let t=this.setFromMatrixColumn(e,0).length(),n=this.setFromMatrixColumn(e,1).length(),i=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=n,this.z=i,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,4*t)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,3*t)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){let e=2*(Math.random()-.5),t=Math.random()*Math.PI*2,n=Math.sqrt(1-e**2);return this.x=n*Math.cos(t),this.y=n*Math.sin(t),this.z=e,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}},zv=new Lv,Nv=new Rv,jv=class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Lv(1/0,1/0,1/0),t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Lv(-1/0,-1/0,-1/0);this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){let t=1/0,n=1/0,i=1/0,r=-1/0,s=-1/0,a=-1/0;for(let o=0,l=e.length;o<l;o+=3){let l=e[o],u=e[o+1],c=e[o+2];l<t&&(t=l),u<n&&(n=u),c<i&&(i=c),l>r&&(r=l),u>s&&(s=u),c>a&&(a=c)}return this.min.set(t,n,i),this.max.set(r,s,a),this}setFromBufferAttribute(e){let t=1/0,n=1/0,i=1/0,r=-1/0,s=-1/0,a=-1/0;for(let o=0,l=e.count;o<l;o++){let l=e.getX(o),u=e.getY(o),c=e.getZ(o);l<t&&(t=l),u<n&&(n=u),c<i&&(i=c),l>r&&(r=l),u>s&&(s=u),c>a&&(a=c)}return this.min.set(t,n,i),this.max.set(r,s,a),this}setFromPoints(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){let n=Vv.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}setFromObject(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.makeEmpty(),this.expandByObject(e,t)}clone(){return(new this.constructor).copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];e.updateWorldMatrix(!1,!1);let n=e.geometry;if(void 0!==n)if(t&&null!=n.attributes&&void 0!==n.attributes.position){let t=n.attributes.position;for(let n=0,i=t.count;n<i;n++)Vv.fromBufferAttribute(t,n).applyMatrix4(e.matrixWorld),this.expandByPoint(Vv)}else null===n.boundingBox&&n.computeBoundingBox(),Hv.copy(n.boundingBox),Hv.applyMatrix4(e.matrixWorld),this.union(Hv);let i=e.children;for(let r=0,s=i.length;r<s;r++)this.expandByObject(i[r],t);return this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}intersectsSphere(e){return this.clampPoint(e.center,Vv),Vv.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,n;return e.normal.x>0?(t=e.normal.x*this.min.x,n=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,n=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,n+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,n+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,n+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,n+=e.normal.z*this.min.z),t<=-e.constant&&n>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(Kv),Zv.subVectors(this.max,Kv),Wv.subVectors(e.a,Kv),Gv.subVectors(e.b,Kv),qv.subVectors(e.c,Kv),Yv.subVectors(Gv,Wv),Xv.subVectors(qv,Gv),Qv.subVectors(Wv,qv);let t=[0,-Yv.z,Yv.y,0,-Xv.z,Xv.y,0,-Qv.z,Qv.y,Yv.z,0,-Yv.x,Xv.z,0,-Xv.x,Qv.z,0,-Qv.x,-Yv.y,Yv.x,0,-Xv.y,Xv.x,0,-Qv.y,Qv.x,0];return!(!ey(t,Wv,Gv,qv,Zv)||(t=[1,0,0,0,1,0,0,0,1],!ey(t,Wv,Gv,qv,Zv)))&&(Jv.crossVectors(Yv,Xv),t=[Jv.x,Jv.y,Jv.z],ey(t,Wv,Gv,qv,Zv))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return Vv.copy(e).clamp(this.min,this.max).sub(e).length()}getBoundingSphere(e){return this.getCenter(e.center),e.radius=.5*this.getSize(Vv).length(),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()||(Uv[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),Uv[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),Uv[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),Uv[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),Uv[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),Uv[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),Uv[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),Uv[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(Uv)),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}},Uv=[new Lv,new Lv,new Lv,new Lv,new Lv,new Lv,new Lv,new Lv],Vv=new Lv,Hv=new jv,Wv=new Lv,Gv=new Lv,qv=new Lv,Yv=new Lv,Xv=new Lv,Qv=new Lv,Kv=new Lv,Zv=new Lv,Jv=new Lv,$v=new Lv;function ey(e,t,n,i,r){for(let s=0,a=e.length-3;s<=a;s+=3){$v.fromArray(e,s);let a=r.x*Math.abs($v.x)+r.y*Math.abs($v.y)+r.z*Math.abs($v.z),o=t.dot($v),l=n.dot($v),u=i.dot($v);if(Math.max(-Math.max(o,l,u),Math.min(o,l,u))>a)return!1}return!0}var ty=new jv,ny=new Lv,iy=new Lv,ry=class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Lv,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){let n=this.center;void 0!==t?n.copy(t):ty.setFromPoints(e).getCenter(n);let i=0;for(let r=0,s=e.length;r<s;r++)i=Math.max(i,n.distanceToSquared(e[r]));return this.radius=Math.sqrt(i),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){let t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){let n=this.center.distanceToSquared(e);return t.copy(e),n>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;ny.subVectors(e,this.center);let t=ny.lengthSq();if(t>this.radius*this.radius){let e=Math.sqrt(t),n=.5*(e-this.radius);this.center.addScaledVector(ny,n/e),this.radius+=n}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(!0===this.center.equals(e.center)?this.radius=Math.max(this.radius,e.radius):(iy.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(ny.copy(e.center).add(iy)),this.expandByPoint(ny.copy(e.center).sub(iy))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return(new this.constructor).copy(this)}},sy=new Lv,ay=new Lv,oy=new Lv,ly=new Lv,uy=new Lv,cy=new Lv,hy=new Lv,dy=class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Lv,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Lv(0,0,-1);this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.direction).multiplyScalar(e).add(this.origin)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,sy)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);let n=t.dot(this.direction);return n<0?t.copy(this.origin):t.copy(this.direction).multiplyScalar(n).add(this.origin)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){let t=sy.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(sy.copy(this.direction).multiplyScalar(t).add(this.origin),sy.distanceToSquared(e))}distanceSqToSegment(e,t,n,i){ay.copy(e).add(t).multiplyScalar(.5),oy.copy(t).sub(e).normalize(),ly.copy(this.origin).sub(ay);let r,s,a,o,l=.5*e.distanceTo(t),u=-this.direction.dot(oy),c=ly.dot(this.direction),h=-ly.dot(oy),d=ly.lengthSq(),p=Math.abs(1-u*u);if(p>0)if(r=u*h-c,s=u*c-h,o=l*p,r>=0)if(s>=-o)if(s<=o){let e=1/p;r*=e,s*=e,a=r*(r+u*s+2*c)+s*(u*r+s+2*h)+d}else s=l,r=Math.max(0,-(u*s+c)),a=-r*r+s*(s+2*h)+d;else s=-l,r=Math.max(0,-(u*s+c)),a=-r*r+s*(s+2*h)+d;else s<=-o?(r=Math.max(0,-(-u*l+c)),s=r>0?-l:Math.min(Math.max(-l,-h),l),a=-r*r+s*(s+2*h)+d):s<=o?(r=0,s=Math.min(Math.max(-l,-h),l),a=s*(s+2*h)+d):(r=Math.max(0,-(u*l+c)),s=r>0?l:Math.min(Math.max(-l,-h),l),a=-r*r+s*(s+2*h)+d);else s=u>0?-l:l,r=Math.max(0,-(u*s+c)),a=-r*r+s*(s+2*h)+d;return n&&n.copy(this.direction).multiplyScalar(r).add(this.origin),i&&i.copy(oy).multiplyScalar(s).add(ay),a}intersectSphere(e,t){sy.subVectors(e.center,this.origin);let n=sy.dot(this.direction),i=sy.dot(sy)-n*n,r=e.radius*e.radius;if(i>r)return null;let s=Math.sqrt(r-i),a=n-s,o=n+s;return a<0&&o<0?null:a<0?this.at(o,t):this.at(a,t)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){let t=e.normal.dot(this.direction);if(0===t)return 0===e.distanceToPoint(this.origin)?0:null;let n=-(this.origin.dot(e.normal)+e.constant)/t;return n>=0?n:null}intersectPlane(e,t){let n=this.distanceToPlane(e);return null===n?null:this.at(n,t)}intersectsPlane(e){let t=e.distanceToPoint(this.origin);return 0===t||e.normal.dot(this.direction)*t<0}intersectBox(e,t){let n,i,r,s,a,o,l=1/this.direction.x,u=1/this.direction.y,c=1/this.direction.z,h=this.origin;return l>=0?(n=(e.min.x-h.x)*l,i=(e.max.x-h.x)*l):(n=(e.max.x-h.x)*l,i=(e.min.x-h.x)*l),u>=0?(r=(e.min.y-h.y)*u,s=(e.max.y-h.y)*u):(r=(e.max.y-h.y)*u,s=(e.min.y-h.y)*u),n>s||r>i||((r>n||isNaN(n))&&(n=r),(s<i||isNaN(i))&&(i=s),c>=0?(a=(e.min.z-h.z)*c,o=(e.max.z-h.z)*c):(a=(e.max.z-h.z)*c,o=(e.min.z-h.z)*c),n>o||a>i)||((a>n||n!==n)&&(n=a),(o<i||i!==i)&&(i=o),i<0)?null:this.at(n>=0?n:i,t)}intersectsBox(e){return null!==this.intersectBox(e,sy)}intersectTriangle(e,t,n,i,r){uy.subVectors(t,e),cy.subVectors(n,e),hy.crossVectors(uy,cy);let s,a=this.direction.dot(hy);if(a>0){if(i)return null;s=1}else{if(!(a<0))return null;s=-1,a=-a}ly.subVectors(this.origin,e);let o=s*this.direction.dot(cy.crossVectors(ly,cy));if(o<0)return null;let l=s*this.direction.dot(uy.cross(ly));if(l<0||o+l>a)return null;let u=-s*ly.dot(hy);return u<0?null:this.at(u/a,r)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return(new this.constructor).copy(this)}},py=class{constructor(){py.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}set(e,t,n,i,r,s,a,o,l,u,c,h,d,p,f,m){let g=this.elements;return g[0]=e,g[4]=t,g[8]=n,g[12]=i,g[1]=r,g[5]=s,g[9]=a,g[13]=o,g[2]=l,g[6]=u,g[10]=c,g[14]=h,g[3]=d,g[7]=p,g[11]=f,g[15]=m,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return(new py).fromArray(this.elements)}copy(e){let t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],this}copyPosition(e){let t=this.elements,n=e.elements;return t[12]=n[12],t[13]=n[13],t[14]=n[14],this}setFromMatrix3(e){let t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,n){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this}makeBasis(e,t,n){return this.set(e.x,t.x,n.x,0,e.y,t.y,n.y,0,e.z,t.z,n.z,0,0,0,0,1),this}extractRotation(e){let t=this.elements,n=e.elements,i=1/fy.setFromMatrixColumn(e,0).length(),r=1/fy.setFromMatrixColumn(e,1).length(),s=1/fy.setFromMatrixColumn(e,2).length();return t[0]=n[0]*i,t[1]=n[1]*i,t[2]=n[2]*i,t[3]=0,t[4]=n[4]*r,t[5]=n[5]*r,t[6]=n[6]*r,t[7]=0,t[8]=n[8]*s,t[9]=n[9]*s,t[10]=n[10]*s,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){let t=this.elements,n=e.x,i=e.y,r=e.z,s=Math.cos(n),a=Math.sin(n),o=Math.cos(i),l=Math.sin(i),u=Math.cos(r),c=Math.sin(r);if("XYZ"===e.order){let e=s*u,n=s*c,i=a*u,r=a*c;t[0]=o*u,t[4]=-o*c,t[8]=l,t[1]=n+i*l,t[5]=e-r*l,t[9]=-a*o,t[2]=r-e*l,t[6]=i+n*l,t[10]=s*o}else if("YXZ"===e.order){let e=o*u,n=o*c,i=l*u,r=l*c;t[0]=e+r*a,t[4]=i*a-n,t[8]=s*l,t[1]=s*c,t[5]=s*u,t[9]=-a,t[2]=n*a-i,t[6]=r+e*a,t[10]=s*o}else if("ZXY"===e.order){let e=o*u,n=o*c,i=l*u,r=l*c;t[0]=e-r*a,t[4]=-s*c,t[8]=i+n*a,t[1]=n+i*a,t[5]=s*u,t[9]=r-e*a,t[2]=-s*l,t[6]=a,t[10]=s*o}else if("ZYX"===e.order){let e=s*u,n=s*c,i=a*u,r=a*c;t[0]=o*u,t[4]=i*l-n,t[8]=e*l+r,t[1]=o*c,t[5]=r*l+e,t[9]=n*l-i,t[2]=-l,t[6]=a*o,t[10]=s*o}else if("YZX"===e.order){let e=s*o,n=s*l,i=a*o,r=a*l;t[0]=o*u,t[4]=r-e*c,t[8]=i*c+n,t[1]=c,t[5]=s*u,t[9]=-a*u,t[2]=-l*u,t[6]=n*c+i,t[10]=e-r*c}else if("XZY"===e.order){let e=s*o,n=s*l,i=a*o,r=a*l;t[0]=o*u,t[4]=-c,t[8]=l*u,t[1]=e*c+r,t[5]=s*u,t[9]=n*c-i,t[2]=i*c-n,t[6]=a*u,t[10]=r*c+e}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(gy,e,vy)}lookAt(e,t,n){let i=this.elements;return by.subVectors(e,t),0===by.lengthSq()&&(by.z=1),by.normalize(),yy.crossVectors(n,by),0===yy.lengthSq()&&(1===Math.abs(n.z)?by.x+=1e-4:by.z+=1e-4,by.normalize(),yy.crossVectors(n,by)),yy.normalize(),xy.crossVectors(by,yy),i[0]=yy.x,i[4]=xy.x,i[8]=by.x,i[1]=yy.y,i[5]=xy.y,i[9]=by.y,i[2]=yy.z,i[6]=xy.z,i[10]=by.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){let n=e.elements,i=t.elements,r=this.elements,s=n[0],a=n[4],o=n[8],l=n[12],u=n[1],c=n[5],h=n[9],d=n[13],p=n[2],f=n[6],m=n[10],g=n[14],v=n[3],y=n[7],x=n[11],b=n[15],w=i[0],D=i[4],_=i[8],S=i[12],E=i[1],C=i[5],A=i[9],M=i[13],T=i[2],P=i[6],F=i[10],O=i[14],I=i[3],k=i[7],B=i[11],R=i[15];return r[0]=s*w+a*E+o*T+l*I,r[4]=s*D+a*C+o*P+l*k,r[8]=s*_+a*A+o*F+l*B,r[12]=s*S+a*M+o*O+l*R,r[1]=u*w+c*E+h*T+d*I,r[5]=u*D+c*C+h*P+d*k,r[9]=u*_+c*A+h*F+d*B,r[13]=u*S+c*M+h*O+d*R,r[2]=p*w+f*E+m*T+g*I,r[6]=p*D+f*C+m*P+g*k,r[10]=p*_+f*A+m*F+g*B,r[14]=p*S+f*M+m*O+g*R,r[3]=v*w+y*E+x*T+b*I,r[7]=v*D+y*C+x*P+b*k,r[11]=v*_+y*A+x*F+b*B,r[15]=v*S+y*M+x*O+b*R,this}multiplyScalar(e){let t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){let e=this.elements,t=e[0],n=e[4],i=e[8],r=e[12],s=e[1],a=e[5],o=e[9],l=e[13],u=e[2],c=e[6],h=e[10],d=e[14];return e[3]*(+r*o*c-i*l*c-r*a*h+n*l*h+i*a*d-n*o*d)+e[7]*(+t*o*d-t*l*h+r*s*h-i*s*d+i*l*u-r*o*u)+e[11]*(+t*l*c-t*a*d-r*s*c+n*s*d+r*a*u-n*l*u)+e[15]*(-i*a*u-t*o*c+t*a*h+i*s*c-n*s*h+n*o*u)}transpose(){let e,t=this.elements;return e=t[1],t[1]=t[4],t[4]=e,e=t[2],t[2]=t[8],t[8]=e,e=t[6],t[6]=t[9],t[9]=e,e=t[3],t[3]=t[12],t[12]=e,e=t[7],t[7]=t[13],t[13]=e,e=t[11],t[11]=t[14],t[14]=e,this}setPosition(e,t,n){let i=this.elements;return e.isVector3?(i[12]=e.x,i[13]=e.y,i[14]=e.z):(i[12]=e,i[13]=t,i[14]=n),this}invert(){let e=this.elements,t=e[0],n=e[1],i=e[2],r=e[3],s=e[4],a=e[5],o=e[6],l=e[7],u=e[8],c=e[9],h=e[10],d=e[11],p=e[12],f=e[13],m=e[14],g=e[15],v=c*m*l-f*h*l+f*o*d-a*m*d-c*o*g+a*h*g,y=p*h*l-u*m*l-p*o*d+s*m*d+u*o*g-s*h*g,x=u*f*l-p*c*l+p*a*d-s*f*d-u*a*g+s*c*g,b=p*c*o-u*f*o-p*a*h+s*f*h+u*a*m-s*c*m,w=t*v+n*y+i*x+r*b;if(0===w)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);let D=1/w;return e[0]=v*D,e[1]=(f*h*r-c*m*r-f*i*d+n*m*d+c*i*g-n*h*g)*D,e[2]=(a*m*r-f*o*r+f*i*l-n*m*l-a*i*g+n*o*g)*D,e[3]=(c*o*r-a*h*r-c*i*l+n*h*l+a*i*d-n*o*d)*D,e[4]=y*D,e[5]=(u*m*r-p*h*r+p*i*d-t*m*d-u*i*g+t*h*g)*D,e[6]=(p*o*r-s*m*r-p*i*l+t*m*l+s*i*g-t*o*g)*D,e[7]=(s*h*r-u*o*r+u*i*l-t*h*l-s*i*d+t*o*d)*D,e[8]=x*D,e[9]=(p*c*r-u*f*r-p*n*d+t*f*d+u*n*g-t*c*g)*D,e[10]=(s*f*r-p*a*r+p*n*l-t*f*l-s*n*g+t*a*g)*D,e[11]=(u*a*r-s*c*r-u*n*l+t*c*l+s*n*d-t*a*d)*D,e[12]=b*D,e[13]=(u*f*i-p*c*i+p*n*h-t*f*h-u*n*m+t*c*m)*D,e[14]=(p*a*i-s*f*i-p*n*o+t*f*o+s*n*m-t*a*m)*D,e[15]=(s*c*i-u*a*i+u*n*o-t*c*o-s*n*h+t*a*h)*D,this}scale(e){let t=this.elements,n=e.x,i=e.y,r=e.z;return t[0]*=n,t[4]*=i,t[8]*=r,t[1]*=n,t[5]*=i,t[9]*=r,t[2]*=n,t[6]*=i,t[10]*=r,t[3]*=n,t[7]*=i,t[11]*=r,this}getMaxScaleOnAxis(){let e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],n=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],i=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,n,i))}makeTranslation(e,t,n){return this.set(1,0,0,e,0,1,0,t,0,0,1,n,0,0,0,1),this}makeRotationX(e){let t=Math.cos(e),n=Math.sin(e);return this.set(1,0,0,0,0,t,-n,0,0,n,t,0,0,0,0,1),this}makeRotationY(e){let t=Math.cos(e),n=Math.sin(e);return this.set(t,0,n,0,0,1,0,0,-n,0,t,0,0,0,0,1),this}makeRotationZ(e){let t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,0,n,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){let n=Math.cos(t),i=Math.sin(t),r=1-n,s=e.x,a=e.y,o=e.z,l=r*s,u=r*a;return this.set(l*s+n,l*a-i*o,l*o+i*a,0,l*a+i*o,u*a+n,u*o-i*s,0,l*o-i*a,u*o+i*s,r*o*o+n,0,0,0,0,1),this}makeScale(e,t,n){return this.set(e,0,0,0,0,t,0,0,0,0,n,0,0,0,0,1),this}makeShear(e,t,n,i,r,s){return this.set(1,n,r,0,e,1,s,0,t,i,1,0,0,0,0,1),this}compose(e,t,n){let i=this.elements,r=t._x,s=t._y,a=t._z,o=t._w,l=r+r,u=s+s,c=a+a,h=r*l,d=r*u,p=r*c,f=s*u,m=s*c,g=a*c,v=o*l,y=o*u,x=o*c,b=n.x,w=n.y,D=n.z;return i[0]=(1-(f+g))*b,i[1]=(d+x)*b,i[2]=(p-y)*b,i[3]=0,i[4]=(d-x)*w,i[5]=(1-(h+g))*w,i[6]=(m+v)*w,i[7]=0,i[8]=(p+y)*D,i[9]=(m-v)*D,i[10]=(1-(h+f))*D,i[11]=0,i[12]=e.x,i[13]=e.y,i[14]=e.z,i[15]=1,this}decompose(e,t,n){let i=this.elements,r=fy.set(i[0],i[1],i[2]).length(),s=fy.set(i[4],i[5],i[6]).length(),a=fy.set(i[8],i[9],i[10]).length();this.determinant()<0&&(r=-r),e.x=i[12],e.y=i[13],e.z=i[14],my.copy(this);let o=1/r,l=1/s,u=1/a;return my.elements[0]*=o,my.elements[1]*=o,my.elements[2]*=o,my.elements[4]*=l,my.elements[5]*=l,my.elements[6]*=l,my.elements[8]*=u,my.elements[9]*=u,my.elements[10]*=u,t.setFromRotationMatrix(my),n.x=r,n.y=s,n.z=a,this}makePerspective(e,t,n,i,r,s){let a=this.elements,o=2*r/(t-e),l=2*r/(n-i),u=(t+e)/(t-e),c=(n+i)/(n-i),h=-(s+r)/(s-r),d=-2*s*r/(s-r);return a[0]=o,a[4]=0,a[8]=u,a[12]=0,a[1]=0,a[5]=l,a[9]=c,a[13]=0,a[2]=0,a[6]=0,a[10]=h,a[14]=d,a[3]=0,a[7]=0,a[11]=-1,a[15]=0,this}makeOrthographic(e,t,n,i,r,s){let a=this.elements,o=1/(t-e),l=1/(n-i),u=1/(s-r),c=(t+e)*o,h=(n+i)*l,d=(s+r)*u;return a[0]=2*o,a[4]=0,a[8]=0,a[12]=-c,a[1]=0,a[5]=2*l,a[9]=0,a[13]=-h,a[2]=0,a[6]=0,a[10]=-2*u,a[14]=-d,a[3]=0,a[7]=0,a[11]=0,a[15]=1,this}equals(e){let t=this.elements,n=e.elements;for(let i=0;i<16;i++)if(t[i]!==n[i])return!1;return!0}fromArray(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;for(let n=0;n<16;n++)this.elements[n]=e[n+t];return this}toArray(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e[t+9]=n[9],e[t+10]=n[10],e[t+11]=n[11],e[t+12]=n[12],e[t+13]=n[13],e[t+14]=n[14],e[t+15]=n[15],e}},fy=new Lv,my=new py,gy=new Lv(0,0,0),vy=new Lv(1,1,1),yy=new Lv,xy=new Lv,by=new Lv,wy=new py,Dy=new Rv,_y=class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:_y.DEFAULT_ORDER;this.isEuler=!0,this._x=e,this._y=t,this._z=n,this._order=i}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this._order;return this._x=e,this._y=t,this._z=n,this._order=i,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this._order,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=e.elements,r=i[0],s=i[4],a=i[8],o=i[1],l=i[5],u=i[9],c=i[2],h=i[6],d=i[10];switch(t){case"XYZ":this._y=Math.asin($g(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(-u,d),this._z=Math.atan2(-s,r)):(this._x=Math.atan2(h,l),this._z=0);break;case"YXZ":this._x=Math.asin(-$g(u,-1,1)),Math.abs(u)<.9999999?(this._y=Math.atan2(a,d),this._z=Math.atan2(o,l)):(this._y=Math.atan2(-c,r),this._z=0);break;case"ZXY":this._x=Math.asin($g(h,-1,1)),Math.abs(h)<.9999999?(this._y=Math.atan2(-c,d),this._z=Math.atan2(-s,l)):(this._y=0,this._z=Math.atan2(o,r));break;case"ZYX":this._y=Math.asin(-$g(c,-1,1)),Math.abs(c)<.9999999?(this._x=Math.atan2(h,d),this._z=Math.atan2(o,r)):(this._x=0,this._z=Math.atan2(-s,l));break;case"YZX":this._z=Math.asin($g(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(-u,l),this._y=Math.atan2(-c,r)):(this._x=0,this._y=Math.atan2(a,d));break;case"XZY":this._z=Math.asin(-$g(s,-1,1)),Math.abs(s)<.9999999?(this._x=Math.atan2(h,l),this._y=Math.atan2(a,r)):(this._x=Math.atan2(-u,d),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}return this._order=t,!0===n&&this._onChangeCallback(),this}setFromQuaternion(e,t,n){return wy.makeRotationFromQuaternion(e),this.setFromRotationMatrix(wy,t,n)}setFromVector3(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this._order;return this.set(e.x,e.y,e.z,t)}reorder(e){return Dy.setFromEuler(this),this.setFromQuaternion(Dy,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],void 0!==e[3]&&(this._order=e[3]),this._onChangeCallback(),this}toArray(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}};_y.DEFAULT_ORDER="XYZ";var Sy=class{constructor(){this.mask=1}set(e){this.mask=1<<e>>>0}enable(e){this.mask|=1<<e}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e}disable(e){this.mask&=~(1<<e)}disableAll(){this.mask=0}test(e){return 0!==(this.mask&e.mask)}isEnabled(e){return 0!==(this.mask&1<<e)}},Ey=0,Cy=new Lv,Ay=new Rv,My=new py,Ty=new Lv,Py=new Lv,Fy=new Lv,Oy=new Rv,Iy=new Lv(1,0,0),ky=new Lv(0,1,0),By=new Lv(0,0,1),Ry={type:"added"},Ly={type:"removed"},zy=class extends Yg{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:Ey++}),this.uuid=Jg(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=zy.DEFAULT_UP.clone();let e=new Lv,t=new _y,n=new Rv,i=new Lv(1,1,1);t._onChange((function(){n.setFromEuler(t,!1)})),n._onChange((function(){t.setFromQuaternion(n,void 0,!1)})),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:n},scale:{configurable:!0,enumerable:!0,value:i},modelViewMatrix:{value:new py},normalMatrix:{value:new uv}}),this.matrix=new py,this.matrixWorld=new py,this.matrixAutoUpdate=zy.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.matrixWorldAutoUpdate=zy.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.layers=new Sy,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,t){this.quaternion.setFromAxisAngle(e,t)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,t){return Ay.setFromAxisAngle(e,t),this.quaternion.multiply(Ay),this}rotateOnWorldAxis(e,t){return Ay.setFromAxisAngle(e,t),this.quaternion.premultiply(Ay),this}rotateX(e){return this.rotateOnAxis(Iy,e)}rotateY(e){return this.rotateOnAxis(ky,e)}rotateZ(e){return this.rotateOnAxis(By,e)}translateOnAxis(e,t){return Cy.copy(e).applyQuaternion(this.quaternion),this.position.add(Cy.multiplyScalar(t)),this}translateX(e){return this.translateOnAxis(Iy,e)}translateY(e){return this.translateOnAxis(ky,e)}translateZ(e){return this.translateOnAxis(By,e)}localToWorld(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(My.copy(this.matrixWorld).invert())}lookAt(e,t,n){e.isVector3?Ty.copy(e):Ty.set(e,t,n);let i=this.parent;this.updateWorldMatrix(!0,!1),Py.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?My.lookAt(Py,Ty,this.up):My.lookAt(Ty,Py,this.up),this.quaternion.setFromRotationMatrix(My),i&&(My.extractRotation(i.matrixWorld),Ay.setFromRotationMatrix(My),this.quaternion.premultiply(Ay.invert()))}add(e){if(arguments.length>1){for(let e=0;e<arguments.length;e++)this.add(arguments[e]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(null!==e.parent&&e.parent.remove(e),e.parent=this,this.children.push(e),e.dispatchEvent(Ry)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let e=0;e<arguments.length;e++)this.remove(arguments[e]);return this}let t=this.children.indexOf(e);return-1!==t&&(e.parent=null,this.children.splice(t,1),e.dispatchEvent(Ly)),this}removeFromParent(){let e=this.parent;return null!==e&&e.remove(this),this}clear(){for(let e=0;e<this.children.length;e++){let t=this.children[e];t.parent=null,t.dispatchEvent(Ly)}return this.children.length=0,this}attach(e){return this.updateWorldMatrix(!0,!1),My.copy(this.matrixWorld).invert(),null!==e.parent&&(e.parent.updateWorldMatrix(!0,!1),My.multiply(e.parent.matrixWorld)),e.applyMatrix4(My),this.add(e),e.updateWorldMatrix(!1,!0),this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,t){if(this[e]===t)return this;for(let n=0,i=this.children.length;n<i;n++){let i=this.children[n].getObjectByProperty(e,t);if(void 0!==i)return i}}getObjectsByProperty(e,t){let n=[];this[e]===t&&n.push(this);for(let i=0,r=this.children.length;i<r;i++){let r=this.children[i].getObjectsByProperty(e,t);r.length>0&&(n=n.concat(r))}return n}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Py,e,Fy),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Py,Oy,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);let t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()}raycast(){}traverse(e){e(this);let t=this.children;for(let n=0,i=t.length;n<i;n++)t[n].traverse(e)}traverseVisible(e){if(!1===this.visible)return;e(this);let t=this.children;for(let n=0,i=t.length;n<i;n++)t[n].traverseVisible(e)}traverseAncestors(e){let t=this.parent;null!==t&&(e(t),t.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);let t=this.children;for(let n=0,i=t.length;n<i;n++){let i=t[n];(!0===i.matrixWorldAutoUpdate||!0===e)&&i.updateMatrixWorld(e)}}updateWorldMatrix(e,t){let n=this.parent;if(!0===e&&null!==n&&!0===n.matrixWorldAutoUpdate&&n.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),!0===t){let e=this.children;for(let t=0,n=e.length;t<n;t++){let n=e[t];!0===n.matrixWorldAutoUpdate&&n.updateWorldMatrix(!1,!0)}}}toJSON(e){let t=void 0===e||"string"==typeof e,n={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},n.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});let i={};function r(t,n){return void 0===t[n.uuid]&&(t[n.uuid]=n.toJSON(e)),n.uuid}if(i.uuid=this.uuid,i.type=this.type,""!==this.name&&(i.name=this.name),!0===this.castShadow&&(i.castShadow=!0),!0===this.receiveShadow&&(i.receiveShadow=!0),!1===this.visible&&(i.visible=!1),!1===this.frustumCulled&&(i.frustumCulled=!1),0!==this.renderOrder&&(i.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(i.userData=this.userData),i.layers=this.layers.mask,i.matrix=this.matrix.toArray(),!1===this.matrixAutoUpdate&&(i.matrixAutoUpdate=!1),this.isInstancedMesh&&(i.type="InstancedMesh",i.count=this.count,i.instanceMatrix=this.instanceMatrix.toJSON(),null!==this.instanceColor&&(i.instanceColor=this.instanceColor.toJSON())),this.isScene)this.background&&(this.background.isColor?i.background=this.background.toJSON():this.background.isTexture&&(i.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&!0!==this.environment.isRenderTargetTexture&&(i.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){i.geometry=r(e.geometries,this.geometry);let t=this.geometry.parameters;if(void 0!==t&&void 0!==t.shapes){let n=t.shapes;if(Array.isArray(n))for(let t=0,i=n.length;t<i;t++){let i=n[t];r(e.shapes,i)}else r(e.shapes,n)}}if(this.isSkinnedMesh&&(i.bindMode=this.bindMode,i.bindMatrix=this.bindMatrix.toArray(),void 0!==this.skeleton&&(r(e.skeletons,this.skeleton),i.skeleton=this.skeleton.uuid)),void 0!==this.material)if(Array.isArray(this.material)){let t=[];for(let n=0,i=this.material.length;n<i;n++)t.push(r(e.materials,this.material[n]));i.material=t}else i.material=r(e.materials,this.material);if(this.children.length>0){i.children=[];for(let t=0;t<this.children.length;t++)i.children.push(this.children[t].toJSON(e).object)}if(this.animations.length>0){i.animations=[];for(let t=0;t<this.animations.length;t++){let n=this.animations[t];i.animations.push(r(e.animations,n))}}if(t){let t=s(e.geometries),i=s(e.materials),r=s(e.textures),a=s(e.images),o=s(e.shapes),l=s(e.skeletons),u=s(e.animations),c=s(e.nodes);t.length>0&&(n.geometries=t),i.length>0&&(n.materials=i),r.length>0&&(n.textures=r),a.length>0&&(n.images=a),o.length>0&&(n.shapes=o),l.length>0&&(n.skeletons=l),u.length>0&&(n.animations=u),c.length>0&&(n.nodes=c)}return n.object=i,n;function s(e){let t=[];for(let n in e){let i=e[n];delete i.metadata,t.push(i)}return t}}clone(e){return(new this.constructor).copy(this,e)}copy(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.userData=JSON.parse(JSON.stringify(e.userData)),!0===t)for(let n=0;n<e.children.length;n++){let t=e.children[n];this.add(t.clone())}return this}};zy.DEFAULT_UP=new Lv(0,1,0),zy.DEFAULT_MATRIX_AUTO_UPDATE=!0,zy.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;var Ny=new Lv,jy=new Lv,Uy=new Lv,Vy=new Lv,Hy=new Lv,Wy=new Lv,Gy=new Lv,qy=new Lv,Yy=new Lv,Xy=new Lv,Qy=class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Lv,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Lv,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Lv;this.a=e,this.b=t,this.c=n}static getNormal(e,t,n,i){i.subVectors(n,t),Ny.subVectors(e,t),i.cross(Ny);let r=i.lengthSq();return r>0?i.multiplyScalar(1/Math.sqrt(r)):i.set(0,0,0)}static getBarycoord(e,t,n,i,r){Ny.subVectors(i,t),jy.subVectors(n,t),Uy.subVectors(e,t);let s=Ny.dot(Ny),a=Ny.dot(jy),o=Ny.dot(Uy),l=jy.dot(jy),u=jy.dot(Uy),c=s*l-a*a;if(0===c)return r.set(-2,-1,-1);let h=1/c,d=(l*o-a*u)*h,p=(s*u-a*o)*h;return r.set(1-d-p,p,d)}static containsPoint(e,t,n,i){return this.getBarycoord(e,t,n,i,Vy),Vy.x>=0&&Vy.y>=0&&Vy.x+Vy.y<=1}static getUV(e,t,n,i,r,s,a,o){return this.getBarycoord(e,t,n,i,Vy),o.set(0,0),o.addScaledVector(r,Vy.x),o.addScaledVector(s,Vy.y),o.addScaledVector(a,Vy.z),o}static isFrontFacing(e,t,n,i){return Ny.subVectors(n,t),jy.subVectors(e,t),Ny.cross(jy).dot(i)<0}set(e,t,n){return this.a.copy(e),this.b.copy(t),this.c.copy(n),this}setFromPointsAndIndices(e,t,n,i){return this.a.copy(e[t]),this.b.copy(e[n]),this.c.copy(e[i]),this}setFromAttributeAndIndices(e,t,n,i){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,n),this.c.fromBufferAttribute(e,i),this}clone(){return(new this.constructor).copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return Ny.subVectors(this.c,this.b),jy.subVectors(this.a,this.b),.5*Ny.cross(jy).length()}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return Qy.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return Qy.getBarycoord(e,this.a,this.b,this.c,t)}getUV(e,t,n,i,r){return Qy.getUV(e,this.a,this.b,this.c,t,n,i,r)}containsPoint(e){return Qy.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return Qy.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){let n,i,r=this.a,s=this.b,a=this.c;Hy.subVectors(s,r),Wy.subVectors(a,r),qy.subVectors(e,r);let o=Hy.dot(qy),l=Wy.dot(qy);if(o<=0&&l<=0)return t.copy(r);Yy.subVectors(e,s);let u=Hy.dot(Yy),c=Wy.dot(Yy);if(u>=0&&c<=u)return t.copy(s);let h=o*c-u*l;if(h<=0&&o>=0&&u<=0)return n=o/(o-u),t.copy(r).addScaledVector(Hy,n);Xy.subVectors(e,a);let d=Hy.dot(Xy),p=Wy.dot(Xy);if(p>=0&&d<=p)return t.copy(a);let f=d*l-o*p;if(f<=0&&l>=0&&p<=0)return i=l/(l-p),t.copy(r).addScaledVector(Wy,i);let m=u*p-d*c;if(m<=0&&c-u>=0&&d-p>=0)return Gy.subVectors(a,s),i=(c-u)/(c-u+(d-p)),t.copy(s).addScaledVector(Gy,i);let g=1/(m+f+h);return n=f*g,i=h*g,t.copy(r).addScaledVector(Hy,n).addScaledVector(Wy,i)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}},Ky=0,Zy=class extends Yg{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:Ky++}),this.uuid=Jg(),this.name="",this.type="Material",this.blending=1,this.side=0,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.blendSrc=204,this.blendDst=205,this.blendEquation=Hm,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=3,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=519,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=Hg,this.stencilZFail=Hg,this.stencilZPass=Hg,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(void 0!==e)for(let t in e){let n=e[t];if(void 0===n){console.warn("THREE.Material: '"+t+"' parameter is undefined.");continue}let i=this[t];void 0!==i?i&&i.isColor?i.set(n):i&&i.isVector3&&n&&n.isVector3?i.copy(n):this[t]=n:console.warn("THREE."+this.type+": '"+t+"' is not a property of this material.")}}toJSON(e){let t=void 0===e||"string"==typeof e;t&&(e={textures:{},images:{}});let n={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};function i(e){let t=[];for(let n in e){let i=e[n];delete i.metadata,t.push(i)}return t}if(n.uuid=this.uuid,n.type=this.type,""!==this.name&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),void 0!==this.roughness&&(n.roughness=this.roughness),void 0!==this.metalness&&(n.metalness=this.metalness),void 0!==this.sheen&&(n.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(n.sheenColor=this.sheenColor.getHex()),void 0!==this.sheenRoughness&&(n.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),this.emissiveIntensity&&1!==this.emissiveIntensity&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),void 0!==this.specularIntensity&&(n.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(n.specularColor=this.specularColor.getHex()),void 0!==this.shininess&&(n.shininess=this.shininess),void 0!==this.clearcoat&&(n.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(n.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(n.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(n.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(n.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,n.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),void 0!==this.iridescence&&(n.iridescence=this.iridescence),void 0!==this.iridescenceIOR&&(n.iridescenceIOR=this.iridescenceIOR),void 0!==this.iridescenceThicknessRange&&(n.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(n.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(n.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(n.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(e).uuid,n.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(n.aoMap=this.aoMap.toJSON(e).uuid,n.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(e).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(e).uuid,n.normalMapType=this.normalMapType,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(e).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(n.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(n.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(e).uuid,void 0!==this.combine&&(n.combine=this.combine)),void 0!==this.envMapIntensity&&(n.envMapIntensity=this.envMapIntensity),void 0!==this.reflectivity&&(n.reflectivity=this.reflectivity),void 0!==this.refractionRatio&&(n.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(e).uuid),void 0!==this.transmission&&(n.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(n.transmissionMap=this.transmissionMap.toJSON(e).uuid),void 0!==this.thickness&&(n.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(n.thicknessMap=this.thicknessMap.toJSON(e).uuid),void 0!==this.attenuationDistance&&this.attenuationDistance!==1/0&&(n.attenuationDistance=this.attenuationDistance),void 0!==this.attenuationColor&&(n.attenuationColor=this.attenuationColor.getHex()),void 0!==this.size&&(n.size=this.size),null!==this.shadowSide&&(n.shadowSide=this.shadowSide),void 0!==this.sizeAttenuation&&(n.sizeAttenuation=this.sizeAttenuation),1!==this.blending&&(n.blending=this.blending),0!==this.side&&(n.side=this.side),this.vertexColors&&(n.vertexColors=!0),this.opacity<1&&(n.opacity=this.opacity),!0===this.transparent&&(n.transparent=this.transparent),n.depthFunc=this.depthFunc,n.depthTest=this.depthTest,n.depthWrite=this.depthWrite,n.colorWrite=this.colorWrite,n.stencilWrite=this.stencilWrite,n.stencilWriteMask=this.stencilWriteMask,n.stencilFunc=this.stencilFunc,n.stencilRef=this.stencilRef,n.stencilFuncMask=this.stencilFuncMask,n.stencilFail=this.stencilFail,n.stencilZFail=this.stencilZFail,n.stencilZPass=this.stencilZPass,void 0!==this.rotation&&0!==this.rotation&&(n.rotation=this.rotation),!0===this.polygonOffset&&(n.polygonOffset=!0),0!==this.polygonOffsetFactor&&(n.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(n.polygonOffsetUnits=this.polygonOffsetUnits),void 0!==this.linewidth&&1!==this.linewidth&&(n.linewidth=this.linewidth),void 0!==this.dashSize&&(n.dashSize=this.dashSize),void 0!==this.gapSize&&(n.gapSize=this.gapSize),void 0!==this.scale&&(n.scale=this.scale),!0===this.dithering&&(n.dithering=!0),this.alphaTest>0&&(n.alphaTest=this.alphaTest),!0===this.alphaToCoverage&&(n.alphaToCoverage=this.alphaToCoverage),!0===this.premultipliedAlpha&&(n.premultipliedAlpha=this.premultipliedAlpha),!0===this.forceSinglePass&&(n.forceSinglePass=this.forceSinglePass),!0===this.wireframe&&(n.wireframe=this.wireframe),this.wireframeLinewidth>1&&(n.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(n.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(n.wireframeLinejoin=this.wireframeLinejoin),!0===this.flatShading&&(n.flatShading=this.flatShading),!1===this.visible&&(n.visible=!1),!1===this.toneMapped&&(n.toneMapped=!1),!1===this.fog&&(n.fog=!1),Object.keys(this.userData).length>0&&(n.userData=this.userData),t){let t=i(e.textures),r=i(e.images);t.length>0&&(n.textures=t),r.length>0&&(n.images=r)}return n}clone(){return(new this.constructor).copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;let t=e.clippingPlanes,n=null;if(null!==t){let e=t.length;n=new Array(e);for(let i=0;i!==e;++i)n[i]=t[i].clone()}return this.clippingPlanes=n,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){!0===e&&this.version++}},Jy=class extends Zy{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new Ev(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}},$y=new Lv,ex=new lv,tx=class{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=e,this.itemSize=t,this.count=void 0!==e?e.length/t:0,this.normalized=n,this.usage=Wg,this.updateRange={offset:0,count:-1},this.version=0}onUploadCallback(){}set needsUpdate(e){!0===e&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this}copyAt(e,t,n){e*=this.itemSize,n*=t.itemSize;for(let i=0,r=this.itemSize;i<r;i++)this.array[e+i]=t.array[n+i];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(2===this.itemSize)for(let t=0,n=this.count;t<n;t++)ex.fromBufferAttribute(this,t),ex.applyMatrix3(e),this.setXY(t,ex.x,ex.y);else if(3===this.itemSize)for(let t=0,n=this.count;t<n;t++)$y.fromBufferAttribute(this,t),$y.applyMatrix3(e),this.setXYZ(t,$y.x,$y.y,$y.z);return this}applyMatrix4(e){for(let t=0,n=this.count;t<n;t++)$y.fromBufferAttribute(this,t),$y.applyMatrix4(e),this.setXYZ(t,$y.x,$y.y,$y.z);return this}applyNormalMatrix(e){for(let t=0,n=this.count;t<n;t++)$y.fromBufferAttribute(this,t),$y.applyNormalMatrix(e),this.setXYZ(t,$y.x,$y.y,$y.z);return this}transformDirection(e){for(let t=0,n=this.count;t<n;t++)$y.fromBufferAttribute(this,t),$y.transformDirection(e),this.setXYZ(t,$y.x,$y.y,$y.z);return this}set(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.array.set(e,t),this}getX(e){let t=this.array[e*this.itemSize];return this.normalized&&(t=sv(t,this.array)),t}setX(e,t){return this.normalized&&(t=av(t,this.array)),this.array[e*this.itemSize]=t,this}getY(e){let t=this.array[e*this.itemSize+1];return this.normalized&&(t=sv(t,this.array)),t}setY(e,t){return this.normalized&&(t=av(t,this.array)),this.array[e*this.itemSize+1]=t,this}getZ(e){let t=this.array[e*this.itemSize+2];return this.normalized&&(t=sv(t,this.array)),t}setZ(e,t){return this.normalized&&(t=av(t,this.array)),this.array[e*this.itemSize+2]=t,this}getW(e){let t=this.array[e*this.itemSize+3];return this.normalized&&(t=sv(t,this.array)),t}setW(e,t){return this.normalized&&(t=av(t,this.array)),this.array[e*this.itemSize+3]=t,this}setXY(e,t,n){return e*=this.itemSize,this.normalized&&(t=av(t,this.array),n=av(n,this.array)),this.array[e+0]=t,this.array[e+1]=n,this}setXYZ(e,t,n,i){return e*=this.itemSize,this.normalized&&(t=av(t,this.array),n=av(n,this.array),i=av(i,this.array)),this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=i,this}setXYZW(e,t,n,i,r){return e*=this.itemSize,this.normalized&&(t=av(t,this.array),n=av(n,this.array),i=av(i,this.array),r=av(r,this.array)),this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=i,this.array[e+3]=r,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){let e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return""!==this.name&&(e.name=this.name),this.usage!==Wg&&(e.usage=this.usage),(0!==this.updateRange.offset||-1!==this.updateRange.count)&&(e.updateRange=this.updateRange),e}copyColorsArray(){console.error("THREE.BufferAttribute: copyColorsArray() was removed in r144.")}copyVector2sArray(){console.error("THREE.BufferAttribute: copyVector2sArray() was removed in r144.")}copyVector3sArray(){console.error("THREE.BufferAttribute: copyVector3sArray() was removed in r144.")}copyVector4sArray(){console.error("THREE.BufferAttribute: copyVector4sArray() was removed in r144.")}},nx=class extends tx{constructor(e,t,n){super(new Uint16Array(e),t,n)}},ix=class extends tx{constructor(e,t,n){super(new Uint32Array(e),t,n)}},rx=class extends tx{constructor(e,t,n){super(new Float32Array(e),t,n)}},sx=0,ax=new py,ox=new zy,lx=new Lv,ux=new jv,cx=new jv,hx=new Lv,dx=class extends Yg{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:sx++}),this.uuid=Jg(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(hv(e)?ix:nx)(e,1):this.index=e,this}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return void 0!==this.attributes[e]}addGroup(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this.groups.push({start:e,count:t,materialIndex:n})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){let t=this.attributes.position;void 0!==t&&(t.applyMatrix4(e),t.needsUpdate=!0);let n=this.attributes.normal;if(void 0!==n){let t=(new uv).getNormalMatrix(e);n.applyNormalMatrix(t),n.needsUpdate=!0}let i=this.attributes.tangent;return void 0!==i&&(i.transformDirection(e),i.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this}applyQuaternion(e){return ax.makeRotationFromQuaternion(e),this.applyMatrix4(ax),this}rotateX(e){return ax.makeRotationX(e),this.applyMatrix4(ax),this}rotateY(e){return ax.makeRotationY(e),this.applyMatrix4(ax),this}rotateZ(e){return ax.makeRotationZ(e),this.applyMatrix4(ax),this}translate(e,t,n){return ax.makeTranslation(e,t,n),this.applyMatrix4(ax),this}scale(e,t,n){return ax.makeScale(e,t,n),this.applyMatrix4(ax),this}lookAt(e){return ox.lookAt(e),ox.updateMatrix(),this.applyMatrix4(ox.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(lx).negate(),this.translate(lx.x,lx.y,lx.z),this}setFromPoints(e){let t=[];for(let n=0,i=e.length;n<i;n++){let i=e[n];t.push(i.x,i.y,i.z||0)}return this.setAttribute("position",new rx(t,3)),this}computeBoundingBox(){null===this.boundingBox&&(this.boundingBox=new jv);let e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingBox.set(new Lv(-1/0,-1/0,-1/0),new Lv(1/0,1/0,1/0));if(void 0!==e){if(this.boundingBox.setFromBufferAttribute(e),t)for(let n=0,i=t.length;n<i;n++){let e=t[n];ux.setFromBufferAttribute(e),this.morphTargetsRelative?(hx.addVectors(this.boundingBox.min,ux.min),this.boundingBox.expandByPoint(hx),hx.addVectors(this.boundingBox.max,ux.max),this.boundingBox.expandByPoint(hx)):(this.boundingBox.expandByPoint(ux.min),this.boundingBox.expandByPoint(ux.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){null===this.boundingSphere&&(this.boundingSphere=new ry);let e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingSphere.set(new Lv,1/0);if(e){let n=this.boundingSphere.center;if(ux.setFromBufferAttribute(e),t)for(let e=0,r=t.length;e<r;e++){let n=t[e];cx.setFromBufferAttribute(n),this.morphTargetsRelative?(hx.addVectors(ux.min,cx.min),ux.expandByPoint(hx),hx.addVectors(ux.max,cx.max),ux.expandByPoint(hx)):(ux.expandByPoint(cx.min),ux.expandByPoint(cx.max))}ux.getCenter(n);let i=0;for(let t=0,r=e.count;t<r;t++)hx.fromBufferAttribute(e,t),i=Math.max(i,n.distanceToSquared(hx));if(t)for(let r=0,s=t.length;r<s;r++){let s=t[r],a=this.morphTargetsRelative;for(let t=0,r=s.count;t<r;t++)hx.fromBufferAttribute(s,t),a&&(lx.fromBufferAttribute(e,t),hx.add(lx)),i=Math.max(i,n.distanceToSquared(hx))}this.boundingSphere.radius=Math.sqrt(i),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){let e=this.index,t=this.attributes;if(null===e||void 0===t.position||void 0===t.normal||void 0===t.uv)return void console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");let n=e.array,i=t.position.array,r=t.normal.array,s=t.uv.array,a=i.length/3;!1===this.hasAttribute("tangent")&&this.setAttribute("tangent",new tx(new Float32Array(4*a),4));let o=this.getAttribute("tangent").array,l=[],u=[];for(let E=0;E<a;E++)l[E]=new Lv,u[E]=new Lv;let c=new Lv,h=new Lv,d=new Lv,p=new lv,f=new lv,m=new lv,g=new Lv,v=new Lv;function y(e,t,n){c.fromArray(i,3*e),h.fromArray(i,3*t),d.fromArray(i,3*n),p.fromArray(s,2*e),f.fromArray(s,2*t),m.fromArray(s,2*n),h.sub(c),d.sub(c),f.sub(p),m.sub(p);let r=1/(f.x*m.y-m.x*f.y);!isFinite(r)||(g.copy(h).multiplyScalar(m.y).addScaledVector(d,-f.y).multiplyScalar(r),v.copy(d).multiplyScalar(f.x).addScaledVector(h,-m.x).multiplyScalar(r),l[e].add(g),l[t].add(g),l[n].add(g),u[e].add(v),u[t].add(v),u[n].add(v))}let x=this.groups;0===x.length&&(x=[{start:0,count:n.length}]);for(let E=0,C=x.length;E<C;++E){let e=x[E],t=e.start;for(let i=t,r=t+e.count;i<r;i+=3)y(n[i+0],n[i+1],n[i+2])}let b=new Lv,w=new Lv,D=new Lv,_=new Lv;function S(e){D.fromArray(r,3*e),_.copy(D);let t=l[e];b.copy(t),b.sub(D.multiplyScalar(D.dot(t))).normalize(),w.crossVectors(_,t);let n=w.dot(u[e])<0?-1:1;o[4*e]=b.x,o[4*e+1]=b.y,o[4*e+2]=b.z,o[4*e+3]=n}for(let E=0,C=x.length;E<C;++E){let e=x[E],t=e.start;for(let i=t,r=t+e.count;i<r;i+=3)S(n[i+0]),S(n[i+1]),S(n[i+2])}}computeVertexNormals(){let e=this.index,t=this.getAttribute("position");if(void 0!==t){let n=this.getAttribute("normal");if(void 0===n)n=new tx(new Float32Array(3*t.count),3),this.setAttribute("normal",n);else for(let e=0,t=n.count;e<t;e++)n.setXYZ(e,0,0,0);let i=new Lv,r=new Lv,s=new Lv,a=new Lv,o=new Lv,l=new Lv,u=new Lv,c=new Lv;if(e)for(let h=0,d=e.count;h<d;h+=3){let d=e.getX(h+0),p=e.getX(h+1),f=e.getX(h+2);i.fromBufferAttribute(t,d),r.fromBufferAttribute(t,p),s.fromBufferAttribute(t,f),u.subVectors(s,r),c.subVectors(i,r),u.cross(c),a.fromBufferAttribute(n,d),o.fromBufferAttribute(n,p),l.fromBufferAttribute(n,f),a.add(u),o.add(u),l.add(u),n.setXYZ(d,a.x,a.y,a.z),n.setXYZ(p,o.x,o.y,o.z),n.setXYZ(f,l.x,l.y,l.z)}else for(let e=0,h=t.count;e<h;e+=3)i.fromBufferAttribute(t,e+0),r.fromBufferAttribute(t,e+1),s.fromBufferAttribute(t,e+2),u.subVectors(s,r),c.subVectors(i,r),u.cross(c),n.setXYZ(e+0,u.x,u.y,u.z),n.setXYZ(e+1,u.x,u.y,u.z),n.setXYZ(e+2,u.x,u.y,u.z);this.normalizeNormals(),n.needsUpdate=!0}}merge(){return console.error("THREE.BufferGeometry.merge() has been removed. Use THREE.BufferGeometryUtils.mergeBufferGeometries() instead."),this}normalizeNormals(){let e=this.attributes.normal;for(let t=0,n=e.count;t<n;t++)hx.fromBufferAttribute(e,t),hx.normalize(),e.setXYZ(t,hx.x,hx.y,hx.z)}toNonIndexed(){function e(e,t){let n=e.array,i=e.itemSize,r=e.normalized,s=new n.constructor(t.length*i),a=0,o=0;for(let l=0,u=t.length;l<u;l++){a=e.isInterleavedBufferAttribute?t[l]*e.data.stride+e.offset:t[l]*i;for(let e=0;e<i;e++)s[o++]=n[a++]}return new tx(s,i,r)}if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;let t=new dx,n=this.index.array,i=this.attributes;for(let a in i){let r=e(i[a],n);t.setAttribute(a,r)}let r=this.morphAttributes;for(let a in r){let i=[],s=r[a];for(let t=0,r=s.length;t<r;t++){let r=e(s[t],n);i.push(r)}t.morphAttributes[a]=i}t.morphTargetsRelative=this.morphTargetsRelative;let s=this.groups;for(let a=0,o=s.length;a<o;a++){let e=s[a];t.addGroup(e.start,e.count,e.materialIndex)}return t}toJSON(){let e={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),void 0!==this.parameters){let t=this.parameters;for(let n in t)void 0!==t[n]&&(e[n]=t[n]);return e}e.data={attributes:{}};let t=this.index;null!==t&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});let n=this.attributes;for(let o in n){let t=n[o];e.data.attributes[o]=t.toJSON(e.data)}let i={},r=!1;for(let o in this.morphAttributes){let t=this.morphAttributes[o],n=[];for(let i=0,r=t.length;i<r;i++){let r=t[i];n.push(r.toJSON(e.data))}n.length>0&&(i[o]=n,r=!0)}r&&(e.data.morphAttributes=i,e.data.morphTargetsRelative=this.morphTargetsRelative);let s=this.groups;s.length>0&&(e.data.groups=JSON.parse(JSON.stringify(s)));let a=this.boundingSphere;return null!==a&&(e.data.boundingSphere={center:a.center.toArray(),radius:a.radius}),e}clone(){return(new this.constructor).copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;let t={};this.name=e.name;let n=e.index;null!==n&&this.setIndex(n.clone(t));let i=e.attributes;for(let l in i){let e=i[l];this.setAttribute(l,e.clone(t))}let r=e.morphAttributes;for(let l in r){let e=[],n=r[l];for(let i=0,r=n.length;i<r;i++)e.push(n[i].clone(t));this.morphAttributes[l]=e}this.morphTargetsRelative=e.morphTargetsRelative;let s=e.groups;for(let l=0,u=s.length;l<u;l++){let e=s[l];this.addGroup(e.start,e.count,e.materialIndex)}let a=e.boundingBox;null!==a&&(this.boundingBox=a.clone());let o=e.boundingSphere;return null!==o&&(this.boundingSphere=o.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,void 0!==e.parameters&&(this.parameters=Object.assign({},e.parameters)),this}dispose(){this.dispatchEvent({type:"dispose"})}},px=new py,fx=new dy,mx=new ry,gx=new Lv,vx=new Lv,yx=new Lv,xx=new Lv,bx=new Lv,wx=new lv,Dx=new lv,_x=new lv,Sx=new Lv,Ex=new Lv,Cx=class extends zy{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new dx,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Jy;super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),void 0!==e.morphTargetInfluences&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),void 0!==e.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=e.material,this.geometry=e.geometry,this}updateMorphTargets(){let e=this.geometry.morphAttributes,t=Object.keys(e);if(t.length>0){let n=e[t[0]];if(void 0!==n){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let e=0,t=n.length;e<t;e++){let t=n[e].name||String(e);this.morphTargetInfluences.push(0),this.morphTargetDictionary[t]=e}}}}getVertexPosition(e,t){let n=this.geometry,i=n.attributes.position,r=n.morphAttributes.position,s=n.morphTargetsRelative;t.fromBufferAttribute(i,e);let a=this.morphTargetInfluences;if(r&&a){bx.set(0,0,0);for(let n=0,i=r.length;n<i;n++){let i=a[n],o=r[n];0!==i&&(xx.fromBufferAttribute(o,e),s?bx.addScaledVector(xx,i):bx.addScaledVector(xx.sub(t),i))}t.add(bx)}return this.isSkinnedMesh&&this.boneTransform(e,t),t}raycast(e,t){let n=this.geometry,i=this.material,r=this.matrixWorld;if(void 0===i||(null===n.boundingSphere&&n.computeBoundingSphere(),mx.copy(n.boundingSphere),mx.applyMatrix4(r),!1===e.ray.intersectsSphere(mx))||(px.copy(r).invert(),fx.copy(e.ray).applyMatrix4(px),null!==n.boundingBox&&!1===fx.intersectsBox(n.boundingBox)))return;let s,a=n.index,o=n.attributes.position,l=n.attributes.uv,u=n.attributes.uv2,c=n.groups,h=n.drawRange;if(null!==a)if(Array.isArray(i))for(let d=0,p=c.length;d<p;d++){let n=c[d],r=i[n.materialIndex];for(let i=Math.max(n.start,h.start),o=Math.min(a.count,Math.min(n.start+n.count,h.start+h.count));i<o;i+=3){let o=a.getX(i),c=a.getX(i+1),h=a.getX(i+2);s=Ax(this,r,e,fx,l,u,o,c,h),s&&(s.faceIndex=Math.floor(i/3),s.face.materialIndex=n.materialIndex,t.push(s))}}else{for(let n=Math.max(0,h.start),r=Math.min(a.count,h.start+h.count);n<r;n+=3){let r=a.getX(n),o=a.getX(n+1),c=a.getX(n+2);s=Ax(this,i,e,fx,l,u,r,o,c),s&&(s.faceIndex=Math.floor(n/3),t.push(s))}}else if(void 0!==o)if(Array.isArray(i))for(let d=0,p=c.length;d<p;d++){let n=c[d],r=i[n.materialIndex];for(let i=Math.max(n.start,h.start),a=Math.min(o.count,Math.min(n.start+n.count,h.start+h.count));i<a;i+=3){s=Ax(this,r,e,fx,l,u,i,i+1,i+2),s&&(s.faceIndex=Math.floor(i/3),s.face.materialIndex=n.materialIndex,t.push(s))}}else{for(let n=Math.max(0,h.start),r=Math.min(o.count,h.start+h.count);n<r;n+=3){s=Ax(this,i,e,fx,l,u,n,n+1,n+2),s&&(s.faceIndex=Math.floor(n/3),t.push(s))}}}};function Ax(e,t,n,i,r,s,a,o,l){e.getVertexPosition(a,gx),e.getVertexPosition(o,vx),e.getVertexPosition(l,yx);let u=function(e,t,n,i,r,s,a,o){let l;if(l=1===t.side?i.intersectTriangle(a,s,r,!0,o):i.intersectTriangle(r,s,a,0===t.side,o),null===l)return null;Ex.copy(o),Ex.applyMatrix4(e.matrixWorld);let u=n.ray.origin.distanceTo(Ex);return u<n.near||u>n.far?null:{distance:u,point:Ex.clone(),object:e}}(e,t,n,i,gx,vx,yx,Sx);if(u){r&&(wx.fromBufferAttribute(r,a),Dx.fromBufferAttribute(r,o),_x.fromBufferAttribute(r,l),u.uv=Qy.getUV(Sx,gx,vx,yx,wx,Dx,_x,new lv)),s&&(wx.fromBufferAttribute(s,a),Dx.fromBufferAttribute(s,o),_x.fromBufferAttribute(s,l),u.uv2=Qy.getUV(Sx,gx,vx,yx,wx,Dx,_x,new lv));let e={a:a,b:o,c:l,normal:new Lv,materialIndex:0};Qy.getNormal(gx,vx,yx,e.normal),u.face=e}return u}var Mx=class extends dx{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1;super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:n,widthSegments:i,heightSegments:r,depthSegments:s};let a=this;i=Math.floor(i),r=Math.floor(r),s=Math.floor(s);let o=[],l=[],u=[],c=[],h=0,d=0;function p(e,t,n,i,r,s,p,f,m,g,v){let y=s/m,x=p/g,b=s/2,w=p/2,D=f/2,_=m+1,S=g+1,E=0,C=0,A=new Lv;for(let a=0;a<S;a++){let s=a*x-w;for(let o=0;o<_;o++){let h=o*y-b;A[e]=h*i,A[t]=s*r,A[n]=D,l.push(A.x,A.y,A.z),A[e]=0,A[t]=0,A[n]=f>0?1:-1,u.push(A.x,A.y,A.z),c.push(o/m),c.push(1-a/g),E+=1}}for(let a=0;a<g;a++)for(let e=0;e<m;e++){let t=h+e+_*a,n=h+e+_*(a+1),i=h+(e+1)+_*(a+1),r=h+(e+1)+_*a;o.push(t,n,r),o.push(n,i,r),C+=6}a.addGroup(d,C,v),d+=C,h+=E}p("z","y","x",-1,-1,n,t,e,s,r,0),p("z","y","x",1,-1,n,t,-e,s,r,1),p("x","z","y",1,1,e,n,t,i,s,2),p("x","z","y",1,-1,e,n,-t,i,s,3),p("x","y","z",1,-1,e,t,n,i,r,4),p("x","y","z",-1,-1,e,t,-n,i,r,5),this.setIndex(o),this.setAttribute("position",new rx(l,3)),this.setAttribute("normal",new rx(u,3)),this.setAttribute("uv",new rx(c,2))}static fromJSON(e){return new Mx(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}};function Tx(e){let t={};for(let n in e){t[n]={};for(let i in e[n]){let r=e[n][i];r&&(r.isColor||r.isMatrix3||r.isMatrix4||r.isVector2||r.isVector3||r.isVector4||r.isTexture||r.isQuaternion)?t[n][i]=r.clone():Array.isArray(r)?t[n][i]=r.slice():t[n][i]=r}}return t}function Px(e){let t={};for(let n=0;n<e.length;n++){let i=Tx(e[n]);for(let e in i)t[e]=i[e]}return t}function Fx(e){return null===e.getRenderTarget()&&e.outputEncoding===Ng?Ug:Vg}var Ox={clone:Tx,merge:Px},Ix=class extends Zy{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,void 0!==e&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=Tx(e.uniforms),this.uniformsGroups=function(e){let t=[];for(let n=0;n<e.length;n++)t.push(e[n].clone());return t}(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){let t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(let i in this.uniforms){let n=this.uniforms[i].value;n&&n.isTexture?t.uniforms[i]={type:"t",value:n.toJSON(e).uuid}:n&&n.isColor?t.uniforms[i]={type:"c",value:n.getHex()}:n&&n.isVector2?t.uniforms[i]={type:"v2",value:n.toArray()}:n&&n.isVector3?t.uniforms[i]={type:"v3",value:n.toArray()}:n&&n.isVector4?t.uniforms[i]={type:"v4",value:n.toArray()}:n&&n.isMatrix3?t.uniforms[i]={type:"m3",value:n.toArray()}:n&&n.isMatrix4?t.uniforms[i]={type:"m4",value:n.toArray()}:t.uniforms[i]={value:n}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader;let n={};for(let i in this.extensions)!0===this.extensions[i]&&(n[i]=!0);return Object.keys(n).length>0&&(t.extensions=n),t}},kx=class extends zy{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new py,this.projectionMatrix=new py,this.projectionMatrixInverse=new py}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this}getWorldDirection(e){this.updateWorldMatrix(!0,!1);let t=this.matrixWorld.elements;return e.set(-t[8],-t[9],-t[10]).normalize()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return(new this.constructor).copy(this)}},Bx=class extends kx{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:50,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2e3;super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=n,this.far=i,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=null===e.view?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){let t=.5*this.getFilmHeight()/e;this.fov=2*Zg*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){let e=Math.tan(.5*Kg*this.fov);return.5*this.getFilmHeight()/e}getEffectiveFOV(){return 2*Zg*Math.atan(Math.tan(.5*Kg*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(e,t,n,i,r,s){this.aspect=e/t,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=i,this.view.width=r,this.view.height=s,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){let e=this.near,t=e*Math.tan(.5*Kg*this.fov)/this.zoom,n=2*t,i=this.aspect*n,r=-.5*i,s=this.view;if(null!==this.view&&this.view.enabled){let e=s.fullWidth,a=s.fullHeight;r+=s.offsetX*i/e,t-=s.offsetY*n/a,i*=s.width/e,n*=s.height/a}let a=this.filmOffset;0!==a&&(r+=e*a/this.getFilmWidth()),this.projectionMatrix.makePerspective(r,r+i,t,t-n,e,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){let t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,null!==this.view&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}},Rx=-90,Lx=class extends zy{constructor(e,t,n){super(),this.type="CubeCamera",this.renderTarget=n;let i=new Bx(Rx,1,e,t);i.layers=this.layers,i.up.set(0,1,0),i.lookAt(1,0,0),this.add(i);let r=new Bx(Rx,1,e,t);r.layers=this.layers,r.up.set(0,1,0),r.lookAt(-1,0,0),this.add(r);let s=new Bx(Rx,1,e,t);s.layers=this.layers,s.up.set(0,0,-1),s.lookAt(0,1,0),this.add(s);let a=new Bx(Rx,1,e,t);a.layers=this.layers,a.up.set(0,0,1),a.lookAt(0,-1,0),this.add(a);let o=new Bx(Rx,1,e,t);o.layers=this.layers,o.up.set(0,1,0),o.lookAt(0,0,1),this.add(o);let l=new Bx(Rx,1,e,t);l.layers=this.layers,l.up.set(0,1,0),l.lookAt(0,0,-1),this.add(l)}update(e,t){null===this.parent&&this.updateMatrixWorld();let n=this.renderTarget,[i,r,s,a,o,l]=this.children,u=e.getRenderTarget(),c=e.toneMapping,h=e.xr.enabled;e.toneMapping=0,e.xr.enabled=!1;let d=n.texture.generateMipmaps;n.texture.generateMipmaps=!1,e.setRenderTarget(n,0),e.render(t,i),e.setRenderTarget(n,1),e.render(t,r),e.setRenderTarget(n,2),e.render(t,s),e.setRenderTarget(n,3),e.render(t,a),e.setRenderTarget(n,4),e.render(t,o),n.texture.generateMipmaps=d,e.setRenderTarget(n,5),e.render(t,l),e.setRenderTarget(u),e.toneMapping=c,e.xr.enabled=h,n.texture.needsPMREMUpdate=!0}},zx=class extends Fv{constructor(e,t,n,i,r,s,a,o,l,u){super(e=void 0!==e?e:[],t=void 0!==t?t:ig,n,i,r,s,a,o,l,u),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}},Nx=class extends Iv{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(e,e,t),this.isWebGLCubeRenderTarget=!0;let n={width:e,height:e,depth:1},i=[n,n,n,n,n,n];this.texture=new zx(i,t.mapping,t.wrapS,t.wrapT,t.magFilter,t.minFilter,t.format,t.type,t.anisotropy,t.encoding),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=void 0!==t.generateMipmaps&&t.generateMipmaps,this.texture.minFilter=void 0!==t.minFilter?t.minFilter:dg}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.encoding=t.encoding,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;let n={tEquirect:{value:null}},i="\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\tvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\n\t\t\t\t\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvWorldDirection = transformDirection( position, modelMatrix );\n\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t\t#include <project_vertex>\n\n\t\t\t\t}\n\t\t\t",r="\n\n\t\t\t\tuniform sampler2D tEquirect;\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\t#include <common>\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvec3 direction = normalize( vWorldDirection );\n\n\t\t\t\t\tvec2 sampleUV = equirectUv( direction );\n\n\t\t\t\t\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\n\t\t\t\t}\n\t\t\t",s=new Mx(5,5,5),a=new Ix({name:"CubemapFromEquirect",uniforms:Tx(n),vertexShader:i,fragmentShader:r,side:1,blending:0});a.uniforms.tEquirect.value=t;let o=new Cx(s,a),l=t.minFilter;return t.minFilter===fg&&(t.minFilter=dg),new Lx(1,10,this).update(e,o),t.minFilter=l,o.geometry.dispose(),o.material.dispose(),this}clear(e,t,n,i){let r=e.getRenderTarget();for(let s=0;s<6;s++)e.setRenderTarget(this,s),e.clear(t,n,i);e.setRenderTarget(r)}},jx=new Lv,Ux=new Lv,Vx=new uv,Hx=class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Lv(1,0,0),t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.isPlane=!0,this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,n,i){return this.normal.set(e,t,n),this.constant=i,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,n){let i=jx.subVectors(n,t).cross(Ux.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(i,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){let e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(this.normal).multiplyScalar(-this.distanceToPoint(e)).add(e)}intersectLine(e,t){let n=e.delta(jx),i=this.normal.dot(n);if(0===i)return 0===this.distanceToPoint(e.start)?t.copy(e.start):null;let r=-(e.start.dot(this.normal)+this.constant)/i;return r<0||r>1?null:t.copy(n).multiplyScalar(r).add(e.start)}intersectsLine(e){let t=this.distanceToPoint(e.start),n=this.distanceToPoint(e.end);return t<0&&n>0||n<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){let n=t||Vx.getNormalMatrix(e),i=this.coplanarPoint(jx).applyMatrix4(e),r=this.normal.applyMatrix3(n).normalize();return this.constant=-i.dot(r),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return(new this.constructor).copy(this)}},Wx=new ry,Gx=new Lv,qx=class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Hx,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Hx,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Hx,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new Hx,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:new Hx,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:new Hx;this.planes=[e,t,n,i,r,s]}set(e,t,n,i,r,s){let a=this.planes;return a[0].copy(e),a[1].copy(t),a[2].copy(n),a[3].copy(i),a[4].copy(r),a[5].copy(s),this}copy(e){let t=this.planes;for(let n=0;n<6;n++)t[n].copy(e.planes[n]);return this}setFromProjectionMatrix(e){let t=this.planes,n=e.elements,i=n[0],r=n[1],s=n[2],a=n[3],o=n[4],l=n[5],u=n[6],c=n[7],h=n[8],d=n[9],p=n[10],f=n[11],m=n[12],g=n[13],v=n[14],y=n[15];return t[0].setComponents(a-i,c-o,f-h,y-m).normalize(),t[1].setComponents(a+i,c+o,f+h,y+m).normalize(),t[2].setComponents(a+r,c+l,f+d,y+g).normalize(),t[3].setComponents(a-r,c-l,f-d,y-g).normalize(),t[4].setComponents(a-s,c-u,f-p,y-v).normalize(),t[5].setComponents(a+s,c+u,f+p,y+v).normalize(),this}intersectsObject(e){let t=e.geometry;return null===t.boundingSphere&&t.computeBoundingSphere(),Wx.copy(t.boundingSphere).applyMatrix4(e.matrixWorld),this.intersectsSphere(Wx)}intersectsSprite(e){return Wx.center.set(0,0,0),Wx.radius=.7071067811865476,Wx.applyMatrix4(e.matrixWorld),this.intersectsSphere(Wx)}intersectsSphere(e){let t=this.planes,n=e.center,i=-e.radius;for(let r=0;r<6;r++)if(t[r].distanceToPoint(n)<i)return!1;return!0}intersectsBox(e){let t=this.planes;for(let n=0;n<6;n++){let i=t[n];if(Gx.x=i.normal.x>0?e.max.x:e.min.x,Gx.y=i.normal.y>0?e.max.y:e.min.y,Gx.z=i.normal.z>0?e.max.z:e.min.z,i.distanceToPoint(Gx)<0)return!1}return!0}containsPoint(e){let t=this.planes;for(let n=0;n<6;n++)if(t[n].distanceToPoint(e)<0)return!1;return!0}clone(){return(new this.constructor).copy(this)}};function Yx(){let e=null,t=!1,n=null,i=null;function r(t,s){n(t,s),i=e.requestAnimationFrame(r)}return{start:function(){!0!==t&&null!==n&&(i=e.requestAnimationFrame(r),t=!0)},stop:function(){e.cancelAnimationFrame(i),t=!1},setAnimationLoop:function(e){n=e},setContext:function(t){e=t}}}function Xx(e,t){let n=t.isWebGL2,i=new WeakMap;return{get:function(e){return e.isInterleavedBufferAttribute&&(e=e.data),i.get(e)},remove:function(t){t.isInterleavedBufferAttribute&&(t=t.data);let n=i.get(t);n&&(e.deleteBuffer(n.buffer),i.delete(t))},update:function(t,r){if(t.isGLBufferAttribute){let e=i.get(t);return void((!e||e.version<t.version)&&i.set(t,{buffer:t.buffer,type:t.type,bytesPerElement:t.elementSize,version:t.version}))}t.isInterleavedBufferAttribute&&(t=t.data);let s=i.get(t);void 0===s?i.set(t,function(t,i){let r,s=t.array,a=t.usage,o=e.createBuffer();if(e.bindBuffer(i,o),e.bufferData(i,s,a),t.onUploadCallback(),s instanceof Float32Array)r=5126;else if(s instanceof Uint16Array)if(t.isFloat16BufferAttribute){if(!n)throw new Error("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2.");r=5131}else r=5123;else if(s instanceof Int16Array)r=5122;else if(s instanceof Uint32Array)r=5125;else if(s instanceof Int32Array)r=5124;else if(s instanceof Int8Array)r=5120;else if(s instanceof Uint8Array)r=5121;else{if(!(s instanceof Uint8ClampedArray))throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+s);r=5121}return{buffer:o,type:r,bytesPerElement:s.BYTES_PER_ELEMENT,version:t.version}}(t,r)):s.version<t.version&&(function(t,i,r){let s=i.array,a=i.updateRange;e.bindBuffer(r,t),-1===a.count?e.bufferSubData(r,0,s):(n?e.bufferSubData(r,a.offset*s.BYTES_PER_ELEMENT,s,a.offset,a.count):e.bufferSubData(r,a.offset*s.BYTES_PER_ELEMENT,s.subarray(a.offset,a.offset+a.count)),a.count=-1),i.onUploadCallback()}(s.buffer,t,r),s.version=t.version)}}}var Qx=class extends dx{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:n,heightSegments:i};let r=e/2,s=t/2,a=Math.floor(n),o=Math.floor(i),l=a+1,u=o+1,c=e/a,h=t/o,d=[],p=[],f=[],m=[];for(let g=0;g<u;g++){let e=g*h-s;for(let t=0;t<l;t++){let n=t*c-r;p.push(n,-e,0),f.push(0,0,1),m.push(t/a),m.push(1-g/o)}}for(let g=0;g<o;g++)for(let e=0;e<a;e++){let t=e+l*g,n=e+l*(g+1),i=e+1+l*(g+1),r=e+1+l*g;d.push(t,n,r),d.push(n,i,r)}this.setIndex(d),this.setAttribute("position",new rx(p,3)),this.setAttribute("normal",new rx(f,3)),this.setAttribute("uv",new rx(m,2))}static fromJSON(e){return new Qx(e.width,e.height,e.widthSegments,e.heightSegments)}},Kx={alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n#endif",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",alphatest_fragment:"#ifdef USE_ALPHATEST\n\tif ( diffuseColor.a < alphaTest ) discard;\n#endif",alphatest_pars_fragment:"#ifdef USE_ALPHATEST\n\tuniform float alphaTest;\n#endif",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( STANDARD )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );\n\t#endif\n#endif",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",begin_vertex:"vec3 transformed = vec3( position );",beginnormal_vertex:"vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n\tvec3 objectTangent = vec3( tangent.xyz );\n#endif",bsdfs:"vec3 BRDF_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n}\nfloat F_Schlick( const in float f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n}\nvec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {\n    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );\n    float x2 = x * x;\n    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );\n    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );\n}\nfloat V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\nvec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float roughness ) {\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( f0, f90, dotVH );\n\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\tfloat D = D_GGX( alpha, dotNH );\n\treturn F * ( V * D );\n}\n#ifdef USE_IRIDESCENCE\n\tvec3 BRDF_GGX_Iridescence( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float iridescence, const in vec3 iridescenceFresnel, const in float roughness ) {\n\t\tfloat alpha = pow2( roughness );\n\t\tvec3 halfDir = normalize( lightDir + viewDir );\n\t\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\t\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\t\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\t\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\t\tvec3 F = mix( F_Schlick( f0, f90, dotVH ), iridescenceFresnel, iridescence );\n\t\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\t\tfloat D = D_GGX( alpha, dotNH );\n\t\treturn F * ( V * D );\n\t}\n#endif\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\nfloat G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, 1.0, dotVH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n}\n#if defined( USE_SHEEN )\nfloat D_Charlie( float roughness, float dotNH ) {\n\tfloat alpha = pow2( roughness );\n\tfloat invAlpha = 1.0 / alpha;\n\tfloat cos2h = dotNH * dotNH;\n\tfloat sin2h = max( 1.0 - cos2h, 0.0078125 );\n\treturn ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );\n}\nfloat V_Neubelt( float dotNV, float dotNL ) {\n\treturn saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );\n}\nvec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat D = D_Charlie( sheenRoughness, dotNH );\n\tfloat V = V_Neubelt( dotNV, dotNL );\n\treturn sheenColor * ( D * V );\n}\n#endif",iridescence_fragment:"#ifdef USE_IRIDESCENCE\n\tconst mat3 XYZ_TO_REC709 = mat3(\n\t\t 3.2404542, -0.9692660,  0.0556434,\n\t\t-1.5371385,  1.8760108, -0.2040259,\n\t\t-0.4985314,  0.0415560,  1.0572252\n\t);\n\tvec3 Fresnel0ToIor( vec3 fresnel0 ) {\n\t\tvec3 sqrtF0 = sqrt( fresnel0 );\n\t\treturn ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );\n\t}\n\tvec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {\n\t\treturn pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );\n\t}\n\tfloat IorToFresnel0( float transmittedIor, float incidentIor ) {\n\t\treturn pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));\n\t}\n\tvec3 evalSensitivity( float OPD, vec3 shift ) {\n\t\tfloat phase = 2.0 * PI * OPD * 1.0e-9;\n\t\tvec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );\n\t\tvec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );\n\t\tvec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );\n\t\tvec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );\n\t\txyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );\n\t\txyz /= 1.0685e-7;\n\t\tvec3 rgb = XYZ_TO_REC709 * xyz;\n\t\treturn rgb;\n\t}\n\tvec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {\n\t\tvec3 I;\n\t\tfloat iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );\n\t\tfloat sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );\n\t\tfloat cosTheta2Sq = 1.0 - sinTheta2Sq;\n\t\tif ( cosTheta2Sq < 0.0 ) {\n\t\t\t return vec3( 1.0 );\n\t\t}\n\t\tfloat cosTheta2 = sqrt( cosTheta2Sq );\n\t\tfloat R0 = IorToFresnel0( iridescenceIOR, outsideIOR );\n\t\tfloat R12 = F_Schlick( R0, 1.0, cosTheta1 );\n\t\tfloat R21 = R12;\n\t\tfloat T121 = 1.0 - R12;\n\t\tfloat phi12 = 0.0;\n\t\tif ( iridescenceIOR < outsideIOR ) phi12 = PI;\n\t\tfloat phi21 = PI - phi12;\n\t\tvec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );\t\tvec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );\n\t\tvec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );\n\t\tvec3 phi23 = vec3( 0.0 );\n\t\tif ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;\n\t\tif ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;\n\t\tif ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;\n\t\tfloat OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;\n\t\tvec3 phi = vec3( phi21 ) + phi23;\n\t\tvec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );\n\t\tvec3 r123 = sqrt( R123 );\n\t\tvec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );\n\t\tvec3 C0 = R12 + Rs;\n\t\tI = C0;\n\t\tvec3 Cm = Rs - T121;\n\t\tfor ( int m = 1; m <= 2; ++ m ) {\n\t\t\tCm *= r123;\n\t\t\tvec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );\n\t\t\tI += Cm * Sm;\n\t\t}\n\t\treturn max( I, vec3( 0.0 ) );\n\t}\n#endif",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {\n\t\tvec3 vSigmaX = dFdx( surf_pos.xyz );\n\t\tvec3 vSigmaY = dFdy( surf_pos.xyz );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 ) * faceDirection;\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\tplane = clippingPlanes[ i ];\n\t\tif ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t#pragma unroll_loop_end\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\tif ( clipped ) discard;\n\t#endif\n#endif",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n#endif",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvClipPosition = - mvPosition.xyz;\n#endif",color_fragment:"#if defined( USE_COLOR_ALPHA )\n\tdiffuseColor *= vColor;\n#elif defined( USE_COLOR )\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR )\n\tvarying vec3 vColor;\n#endif",color_pars_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvarying vec3 vColor;\n#endif",color_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvColor = vec4( 1.0 );\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvColor = vec3( 1.0 );\n#endif\n#ifdef USE_COLOR\n\tvColor *= color;\n#endif\n#ifdef USE_INSTANCING_COLOR\n\tvColor.xyz *= instanceColor.xyz;\n#endif",common:"#define PI 3.141592653589793\n#define PI2 6.283185307179586\n#define PI_HALF 1.5707963267948966\n#define RECIPROCAL_PI 0.3183098861837907\n#define RECIPROCAL_PI2 0.15915494309189535\n#define EPSILON 1e-6\n#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement( a ) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nvec3 pow2( const in vec3 x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }\nfloat average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract( sin( sn ) * c );\n}\n#ifdef HIGH_PRECISION\n\tfloat precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n\tfloat precisionSafeLength( vec3 v ) {\n\t\tfloat maxComponent = max3( abs( v ) );\n\t\treturn length( v / maxComponent ) * maxComponent;\n\t}\n#endif\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal;\n#endif\n};\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat luminance( const in vec3 rgb ) {\n\tconst vec3 weights = vec3( 0.2126729, 0.7151522, 0.0721750 );\n\treturn dot( weights, rgb );\n}\nbool isPerspectiveMatrix( mat4 m ) {\n\treturn m[ 2 ][ 3 ] == - 1.0;\n}\nvec2 equirectUv( in vec3 dir ) {\n\tfloat u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;\n\tfloat v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\treturn vec2( u, v );\n}",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n\t#define cubeUV_minMipLevel 4.0\n\t#define cubeUV_minTileSize 16.0\n\tfloat getFace( vec3 direction ) {\n\t\tvec3 absDirection = abs( direction );\n\t\tfloat face = - 1.0;\n\t\tif ( absDirection.x > absDirection.z ) {\n\t\t\tif ( absDirection.x > absDirection.y )\n\t\t\t\tface = direction.x > 0.0 ? 0.0 : 3.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t} else {\n\t\t\tif ( absDirection.z > absDirection.y )\n\t\t\t\tface = direction.z > 0.0 ? 2.0 : 5.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t}\n\t\treturn face;\n\t}\n\tvec2 getUV( vec3 direction, float face ) {\n\t\tvec2 uv;\n\t\tif ( face == 0.0 ) {\n\t\t\tuv = vec2( direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 1.0 ) {\n\t\t\tuv = vec2( - direction.x, - direction.z ) / abs( direction.y );\n\t\t} else if ( face == 2.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.y ) / abs( direction.z );\n\t\t} else if ( face == 3.0 ) {\n\t\t\tuv = vec2( - direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 4.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.z ) / abs( direction.y );\n\t\t} else {\n\t\t\tuv = vec2( direction.x, direction.y ) / abs( direction.z );\n\t\t}\n\t\treturn 0.5 * ( uv + 1.0 );\n\t}\n\tvec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {\n\t\tfloat face = getFace( direction );\n\t\tfloat filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );\n\t\tmipInt = max( mipInt, cubeUV_minMipLevel );\n\t\tfloat faceSize = exp2( mipInt );\n\t\thighp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;\n\t\tif ( face > 2.0 ) {\n\t\t\tuv.y += faceSize;\n\t\t\tface -= 3.0;\n\t\t}\n\t\tuv.x += face * faceSize;\n\t\tuv.x += filterInt * 3.0 * cubeUV_minTileSize;\n\t\tuv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );\n\t\tuv.x *= CUBEUV_TEXEL_WIDTH;\n\t\tuv.y *= CUBEUV_TEXEL_HEIGHT;\n\t\t#ifdef texture2DGradEXT\n\t\t\treturn texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;\n\t\t#else\n\t\t\treturn texture2D( envMap, uv ).rgb;\n\t\t#endif\n\t}\n\t#define cubeUV_r0 1.0\n\t#define cubeUV_v0 0.339\n\t#define cubeUV_m0 - 2.0\n\t#define cubeUV_r1 0.8\n\t#define cubeUV_v1 0.276\n\t#define cubeUV_m1 - 1.0\n\t#define cubeUV_r4 0.4\n\t#define cubeUV_v4 0.046\n\t#define cubeUV_m4 2.0\n\t#define cubeUV_r5 0.305\n\t#define cubeUV_v5 0.016\n\t#define cubeUV_m5 3.0\n\t#define cubeUV_r6 0.21\n\t#define cubeUV_v6 0.0038\n\t#define cubeUV_m6 4.0\n\tfloat roughnessToMip( float roughness ) {\n\t\tfloat mip = 0.0;\n\t\tif ( roughness >= cubeUV_r1 ) {\n\t\t\tmip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;\n\t\t} else if ( roughness >= cubeUV_r4 ) {\n\t\t\tmip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;\n\t\t} else if ( roughness >= cubeUV_r5 ) {\n\t\t\tmip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;\n\t\t} else if ( roughness >= cubeUV_r6 ) {\n\t\t\tmip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;\n\t\t} else {\n\t\t\tmip = - 2.0 * log2( 1.16 * roughness );\t\t}\n\t\treturn mip;\n\t}\n\tvec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {\n\t\tfloat mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );\n\t\tfloat mipF = fract( mip );\n\t\tfloat mipInt = floor( mip );\n\t\tvec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );\n\t\tif ( mipF == 0.0 ) {\n\t\t\treturn vec4( color0, 1.0 );\n\t\t} else {\n\t\t\tvec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );\n\t\t\treturn vec4( mix( color0, color1, mipF ), 1.0 );\n\t\t}\n\t}\n#endif",defaultnormal_vertex:"vec3 transformedNormal = objectNormal;\n#ifdef USE_INSTANCING\n\tmat3 m = mat3( instanceMatrix );\n\ttransformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );\n\ttransformedNormal = m * transformedNormal;\n#endif\ntransformedNormal = normalMatrix * transformedNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n\tvec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#ifdef FLIP_SIDED\n\t\ttransformedTangent = - transformedTangent;\n\t#endif\n#endif",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );\n#endif",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif",encodings_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",encodings_pars_fragment:"vec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}",envmap_fragment:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvec3 cameraToFrag;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToFrag = normalize( vWorldPosition - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToFrag, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif",envmap_common_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float envMapIntensity;\n\tuniform float flipEnvMap;\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\t\n#endif",envmap_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float reflectivity;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\tvarying vec3 vWorldPosition;\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\t\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif",envmap_physical_pars_fragment:"#if defined( USE_ENVMAP )\n\tvec3 getIBLIrradiance( const in vec3 normal ) {\n\t\t#if defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );\n\t\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\tvec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {\n\t\t#if defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 reflectVec = reflect( - viewDir, normal );\n\t\t\treflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );\n\t\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );\n\t\t\treturn envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n#endif",envmap_vertex:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif",fog_vertex:"#ifdef USE_FOG\n\tvFogDepth = - mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n\tvarying float vFogDepth;\n#endif",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, vFogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float vFogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",gradientmap_pars_fragment:"#ifdef USE_GRADIENTMAP\n\tuniform sampler2D gradientMap;\n#endif\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\tfloat dotNL = dot( normal, lightDirection );\n\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t#ifdef USE_GRADIENTMAP\n\t\treturn vec3( texture2D( gradientMap, coord ).r );\n\t#else\n\t\tvec2 fw = fwidth( coord ) * 0.5;\n\t\treturn mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );\n\t#endif\n}",lightmap_fragment:"#ifdef USE_LIGHTMAP\n\tvec4 lightMapTexel = texture2D( lightMap, vUv2 );\n\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\treflectedLight.indirectDiffuse += lightMapIrradiance;\n#endif",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_fragment:"LambertMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularStrength = specularStrength;",lights_lambert_pars_fragment:"varying vec3 vViewPosition;\nstruct LambertMaterial {\n\tvec3 diffuseColor;\n\tfloat specularStrength;\n};\nvoid RE_Direct_Lambert( const in IncidentLight directLight, const in GeometricContext geometry, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in GeometricContext geometry, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Lambert\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Lambert",lights_pars_begin:"uniform bool receiveShadow;\nuniform vec3 ambientLightColor;\nuniform vec3 lightProbe[ 9 ];\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\treturn result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {\n\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n\treturn irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\treturn irradiance;\n}\nfloat getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\t#if defined ( PHYSICALLY_CORRECT_LIGHTS )\n\t\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\t\tif ( cutoffDistance > 0.0 ) {\n\t\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t\t}\n\t\treturn distanceFalloff;\n\t#else\n\t\tif ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {\n\t\t\treturn pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );\n\t\t}\n\t\treturn 1.0;\n\t#endif\n}\nfloat getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {\n\treturn smoothstep( coneCosine, penumbraCosine, angleCosine );\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalLightInfo( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tlight.color = directionalLight.color;\n\t\tlight.direction = directionalLight.direction;\n\t\tlight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointLightInfo( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tlight.color = pointLight.color;\n\t\tlight.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );\n\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotLightInfo( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat angleCos = dot( light.direction, spotLight.direction );\n\t\tfloat spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\tif ( spotAttenuation > 0.0 ) {\n\t\t\tfloat lightDistance = length( lVector );\n\t\t\tlight.color = spotLight.color * spotAttenuation;\n\t\t\tlight.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t\t} else {\n\t\t\tlight.color = vec3( 0.0 );\n\t\t\tlight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {\n\t\tfloat dotNL = dot( normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\treturn irradiance;\n\t}\n#endif",lights_toon_fragment:"ToonMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;",lights_toon_pars_fragment:"varying vec3 vViewPosition;\nstruct ToonMaterial {\n\tvec3 diffuseColor;\n};\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Toon\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Toon",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_phong_pars_fragment:"varying vec3 vViewPosition;\nstruct BlinnPhongMaterial {\n\tvec3 diffuseColor;\n\tvec3 specularColor;\n\tfloat specularShininess;\n\tfloat specularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nvec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;\nmaterial.roughness = min( material.roughness, 1.0 );\n#ifdef IOR\n\tmaterial.ior = ior;\n\t#ifdef SPECULAR\n\t\tfloat specularIntensityFactor = specularIntensity;\n\t\tvec3 specularColorFactor = specularColor;\n\t\t#ifdef USE_SPECULARINTENSITYMAP\n\t\t\tspecularIntensityFactor *= texture2D( specularIntensityMap, vUv ).a;\n\t\t#endif\n\t\t#ifdef USE_SPECULARCOLORMAP\n\t\t\tspecularColorFactor *= texture2D( specularColorMap, vUv ).rgb;\n\t\t#endif\n\t\tmaterial.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );\n\t#else\n\t\tfloat specularIntensityFactor = 1.0;\n\t\tvec3 specularColorFactor = vec3( 1.0 );\n\t\tmaterial.specularF90 = 1.0;\n\t#endif\n\tmaterial.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.specularF90 = 1.0;\n#endif\n#ifdef USE_CLEARCOAT\n\tmaterial.clearcoat = clearcoat;\n\tmaterial.clearcoatRoughness = clearcoatRoughness;\n\tmaterial.clearcoatF0 = vec3( 0.04 );\n\tmaterial.clearcoatF90 = 1.0;\n\t#ifdef USE_CLEARCOATMAP\n\t\tmaterial.clearcoat *= texture2D( clearcoatMap, vUv ).x;\n\t#endif\n\t#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\t\tmaterial.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;\n\t#endif\n\tmaterial.clearcoat = saturate( material.clearcoat );\tmaterial.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );\n\tmaterial.clearcoatRoughness += geometryRoughness;\n\tmaterial.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );\n#endif\n#ifdef USE_IRIDESCENCE\n\tmaterial.iridescence = iridescence;\n\tmaterial.iridescenceIOR = iridescenceIOR;\n\t#ifdef USE_IRIDESCENCEMAP\n\t\tmaterial.iridescence *= texture2D( iridescenceMap, vUv ).r;\n\t#endif\n\t#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\t\tmaterial.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vUv ).g + iridescenceThicknessMinimum;\n\t#else\n\t\tmaterial.iridescenceThickness = iridescenceThicknessMaximum;\n\t#endif\n#endif\n#ifdef USE_SHEEN\n\tmaterial.sheenColor = sheenColor;\n\t#ifdef USE_SHEENCOLORMAP\n\t\tmaterial.sheenColor *= texture2D( sheenColorMap, vUv ).rgb;\n\t#endif\n\tmaterial.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );\n\t#ifdef USE_SHEENROUGHNESSMAP\n\t\tmaterial.sheenRoughness *= texture2D( sheenRoughnessMap, vUv ).a;\n\t#endif\n#endif",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3 diffuseColor;\n\tfloat roughness;\n\tvec3 specularColor;\n\tfloat specularF90;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat clearcoat;\n\t\tfloat clearcoatRoughness;\n\t\tvec3 clearcoatF0;\n\t\tfloat clearcoatF90;\n\t#endif\n\t#ifdef USE_IRIDESCENCE\n\t\tfloat iridescence;\n\t\tfloat iridescenceIOR;\n\t\tfloat iridescenceThickness;\n\t\tvec3 iridescenceFresnel;\n\t\tvec3 iridescenceF0;\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tvec3 sheenColor;\n\t\tfloat sheenRoughness;\n\t#endif\n\t#ifdef IOR\n\t\tfloat ior;\n\t#endif\n\t#ifdef USE_TRANSMISSION\n\t\tfloat transmission;\n\t\tfloat transmissionAlpha;\n\t\tfloat thickness;\n\t\tfloat attenuationDistance;\n\t\tvec3 attenuationColor;\n\t#endif\n};\nvec3 clearcoatSpecular = vec3( 0.0 );\nvec3 sheenSpecular = vec3( 0.0 );\nfloat IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat r2 = roughness * roughness;\n\tfloat a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;\n\tfloat b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;\n\tfloat DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );\n\treturn saturate( DG * RECIPROCAL_PI );\n}\nvec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\tvec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;\n\treturn fab;\n}\nvec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\treturn specularColor * fab.x + specularF90 * fab.y;\n}\n#ifdef USE_IRIDESCENCE\nvoid computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#else\nvoid computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#endif\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\t#ifdef USE_IRIDESCENCE\n\t\tvec3 Fr = mix( specularColor, iridescenceF0, iridescence );\n\t#else\n\t\tvec3 Fr = specularColor;\n\t#endif\n\tvec3 FssEss = Fr * fab.x + specularF90 * fab.y;\n\tfloat Ess = fab.x + fab.y;\n\tfloat Ems = 1.0 - Ess;\n\tvec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometry.normal;\n\t\tvec3 viewDir = geometry.viewDir;\n\t\tvec3 position = geometry.position;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.roughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNLcc = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );\n\t\tvec3 ccIrradiance = dotNLcc * directLight.color;\n\t\tclearcoatSpecular += ccIrradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.clearcoatNormal, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecular += irradiance * BRDF_Sheen( directLight.direction, geometry.viewDir, geometry.normal, material.sheenColor, material.sheenRoughness );\n\t#endif\n\t#ifdef USE_IRIDESCENCE\n\t\treflectedLight.directSpecular += irradiance * BRDF_GGX_Iridescence( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness );\n\t#else\n\t\treflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.roughness );\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatSpecular += clearcoatRadiance * EnvironmentBRDF( geometry.clearcoatNormal, geometry.viewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecular += irradiance * material.sheenColor * IBLSheenBRDF( geometry.normal, geometry.viewDir, material.sheenRoughness );\n\t#endif\n\tvec3 singleScattering = vec3( 0.0 );\n\tvec3 multiScattering = vec3( 0.0 );\n\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\t#ifdef USE_IRIDESCENCE\n\t\tcomputeMultiscatteringIridescence( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );\n\t#else\n\t\tcomputeMultiscattering( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );\n\t#endif\n\tvec3 totalScattering = singleScattering + multiScattering;\n\tvec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );\n\treflectedLight.indirectSpecular += radiance * singleScattering;\n\treflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\n\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",lights_fragment_begin:"\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\n#ifdef USE_CLEARCOAT\n\tgeometry.clearcoatNormal = clearcoatNormal;\n#endif\n#ifdef USE_IRIDESCENCE\n\tfloat dotNVi = saturate( dot( normal, geometry.viewDir ) );\n\tif ( material.iridescenceThickness == 0.0 ) {\n\t\tmaterial.iridescence = 0.0;\n\t} else {\n\t\tmaterial.iridescence = saturate( material.iridescence );\n\t}\n\tif ( material.iridescence > 0.0 ) {\n\t\tmaterial.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );\n\t\tmaterial.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );\n\t}\n#endif\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointLightInfo( pointLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\n\t\tpointLightShadow = pointLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\tvec4 spotColor;\n\tvec3 spotLightCoord;\n\tbool inSpotLightMap;\n\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotLightInfo( spotLight, geometry, directLight );\n\t\t#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n\t\t#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX\n\t\t#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\t#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS\n\t\t#else\n\t\t#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n\t\t#endif\n\t\t#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )\n\t\t\tspotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;\n\t\t\tinSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );\n\t\t\tspotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );\n\t\t\tdirectLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;\n\t\t#endif\n\t\t#undef SPOT_LIGHT_MAP_INDEX\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\tspotLightShadow = spotLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalLightInfo( directionalLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n\t\tdirectionalLightShadow = directionalLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 iblIrradiance = vec3( 0.0 );\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\tirradiance += getLightProbeIrradiance( lightProbe, geometry.normal );\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearcoatRadiance = vec3( 0.0 );\n#endif",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vUv2 );\n\t\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tiblIrradiance += getIBLIrradiance( geometry.normal );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\tradiance += getIBLRadiance( geometry.viewDir, geometry.normal, material.roughness );\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatRadiance += getIBLRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness );\n\t#endif\n#endif",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );\n#endif",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t\tvarying float vIsPerspective;\n\t#else\n\t\tuniform float logDepthBufFC;\n\t#endif\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t\tvIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n\t#else\n\t\tif ( isPerspectiveMatrix( projectionMatrix ) ) {\n\t\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\t\tgl_Position.z *= gl_Position.w;\n\t\t}\n\t#endif\n#endif",map_fragment:"#ifdef USE_MAP\n\tvec4 sampledDiffuseColor = texture2D( map, vUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\tsampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );\n\t#endif\n\tdiffuseColor *= sampledDiffuseColor;\n#endif",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif",map_particle_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n#endif\n#ifdef USE_MAP\n\tdiffuseColor *= texture2D( map, uv );\n#endif\n#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, uv ).g;\n#endif",map_particle_pars_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tuniform mat3 uvTransform;\n#endif\n#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphcolor_vertex:"#if defined( USE_MORPHCOLORS ) && defined( MORPHTARGETS_TEXTURE )\n\tvColor *= morphTargetBaseInfluence;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t#if defined( USE_COLOR_ALPHA )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];\n\t\t#elif defined( USE_COLOR )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];\n\t\t#endif\n\t}\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];\n\t\t}\n\t#else\n\t\tobjectNormal += morphNormal0 * morphTargetInfluences[ 0 ];\n\t\tobjectNormal += morphNormal1 * morphTargetInfluences[ 1 ];\n\t\tobjectNormal += morphNormal2 * morphTargetInfluences[ 2 ];\n\t\tobjectNormal += morphNormal3 * morphTargetInfluences[ 3 ];\n\t#endif\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\tuniform float morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tuniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];\n\t\tuniform sampler2DArray morphTargetsTexture;\n\t\tuniform ivec2 morphTargetsTextureSize;\n\t\tvec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {\n\t\t\tint texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;\n\t\t\tint y = texelIndex / morphTargetsTextureSize.x;\n\t\t\tint x = texelIndex - y * morphTargetsTextureSize.x;\n\t\t\tivec3 morphUV = ivec3( x, y, morphTargetIndex );\n\t\t\treturn texelFetch( morphTargetsTexture, morphUV, 0 );\n\t\t}\n\t#else\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\tuniform float morphTargetInfluences[ 8 ];\n\t\t#else\n\t\t\tuniform float morphTargetInfluences[ 4 ];\n\t\t#endif\n\t#endif\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];\n\t\t}\n\t#else\n\t\ttransformed += morphTarget0 * morphTargetInfluences[ 0 ];\n\t\ttransformed += morphTarget1 * morphTargetInfluences[ 1 ];\n\t\ttransformed += morphTarget2 * morphTargetInfluences[ 2 ];\n\t\ttransformed += morphTarget3 * morphTargetInfluences[ 3 ];\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\ttransformed += morphTarget4 * morphTargetInfluences[ 4 ];\n\t\t\ttransformed += morphTarget5 * morphTargetInfluences[ 5 ];\n\t\t\ttransformed += morphTarget6 * morphTargetInfluences[ 6 ];\n\t\t\ttransformed += morphTarget7 * morphTargetInfluences[ 7 ];\n\t\t#endif\n\t#endif\n#endif",normal_fragment_begin:"float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;\n#ifdef FLAT_SHADED\n\tvec3 fdx = dFdx( vViewPosition );\n\tvec3 fdy = dFdy( vViewPosition );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\t#ifdef USE_TANGENT\n\t\tvec3 tangent = normalize( vTangent );\n\t\tvec3 bitangent = normalize( vBitangent );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\ttangent = tangent * faceDirection;\n\t\t\tbitangent = bitangent * faceDirection;\n\t\t#endif\n\t\t#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )\n\t\t\tmat3 vTBN = mat3( tangent, bitangent, normal );\n\t\t#endif\n\t#endif\n#endif\nvec3 geometryNormal = normal;",normal_fragment_maps:"#ifdef OBJECTSPACE_NORMALMAP\n\tnormal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t#ifdef FLIP_SIDED\n\t\tnormal = - normal;\n\t#endif\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\tnormal = normalize( normalMatrix * normal );\n#elif defined( TANGENTSPACE_NORMALMAP )\n\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\tmapN.xy *= normalScale;\n\t#ifdef USE_TANGENT\n\t\tnormal = normalize( vTBN * mapN );\n\t#else\n\t\tnormal = perturbNormal2Arb( - vViewPosition, normal, mapN, faceDirection );\n\t#endif\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );\n#endif",normal_pars_fragment:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_pars_vertex:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_vertex:"#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n#endif\n#ifdef OBJECTSPACE_NORMALMAP\n\tuniform mat3 normalMatrix;\n#endif\n#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )\n\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN, float faceDirection ) {\n\t\tvec3 q0 = dFdx( eye_pos.xyz );\n\t\tvec3 q1 = dFdy( eye_pos.xyz );\n\t\tvec2 st0 = dFdx( vUv.st );\n\t\tvec2 st1 = dFdy( vUv.st );\n\t\tvec3 N = surf_norm;\n\t\tvec3 q1perp = cross( q1, N );\n\t\tvec3 q0perp = cross( N, q0 );\n\t\tvec3 T = q1perp * st0.x + q0perp * st1.x;\n\t\tvec3 B = q1perp * st0.y + q0perp * st1.y;\n\t\tfloat det = max( dot( T, T ), dot( B, B ) );\n\t\tfloat scale = ( det == 0.0 ) ? 0.0 : faceDirection * inversesqrt( det );\n\t\treturn normalize( T * ( mapN.x * scale ) + B * ( mapN.y * scale ) + N * mapN.z );\n\t}\n#endif",clearcoat_normal_fragment_begin:"#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal = geometryNormal;\n#endif",clearcoat_normal_fragment_maps:"#ifdef USE_CLEARCOAT_NORMALMAP\n\tvec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;\n\tclearcoatMapN.xy *= clearcoatNormalScale;\n\t#ifdef USE_TANGENT\n\t\tclearcoatNormal = normalize( vTBN * clearcoatMapN );\n\t#else\n\t\tclearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN, faceDirection );\n\t#endif\n#endif",clearcoat_pars_fragment:"#ifdef USE_CLEARCOATMAP\n\tuniform sampler2D clearcoatMap;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform sampler2D clearcoatRoughnessMap;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform sampler2D clearcoatNormalMap;\n\tuniform vec2 clearcoatNormalScale;\n#endif",iridescence_pars_fragment:"#ifdef USE_IRIDESCENCEMAP\n\tuniform sampler2D iridescenceMap;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tuniform sampler2D iridescenceThicknessMap;\n#endif",output_fragment:"#ifdef OPAQUE\ndiffuseColor.a = 1.0;\n#endif\n#ifdef USE_TRANSMISSION\ndiffuseColor.a *= material.transmissionAlpha + 0.1;\n#endif\ngl_FragColor = vec4( outgoingLight, diffuseColor.a );",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nvec2 packDepthToRG( in highp float v ) {\n\treturn packDepthToRGBA( v ).yx;\n}\nfloat unpackRGToDepth( const in highp vec2 v ) {\n\treturn unpackRGBAToDepth( vec4( v.xy, 0.0, 0.0 ) );\n}\nvec4 pack2HalfToRGBA( vec2 v ) {\n\tvec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );\n\treturn vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );\n}\nvec2 unpackRGBATo2Half( vec4 v ) {\n\treturn vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\n\treturn linearClipZ * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * invClipZ - far );\n}",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif",project_vertex:"vec4 mvPosition = vec4( transformed, 1.0 );\n#ifdef USE_INSTANCING\n\tmvPosition = instanceMatrix * mvPosition;\n#endif\nmvPosition = modelViewMatrix * mvPosition;\ngl_Position = projectionMatrix * mvPosition;",dithering_fragment:"#ifdef DITHERING\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",dithering_pars_fragment:"#ifdef DITHERING\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\n\troughnessFactor *= texelRoughness.g;\n#endif",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#if NUM_SPOT_LIGHT_COORDS > 0\n  varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#if NUM_SPOT_LIGHT_MAPS > 0\n  uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];\n#endif\n#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tvec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n\t\treturn unpackRGBATo2Half( texture2D( shadow, uv ) );\n\t}\n\tfloat VSMShadow (sampler2D shadow, vec2 uv, float compare ){\n\t\tfloat occlusion = 1.0;\n\t\tvec2 distribution = texture2DDistribution( shadow, uv );\n\t\tfloat hard_shadow = step( compare , distribution.x );\n\t\tif (hard_shadow != 1.0 ) {\n\t\t\tfloat distance = compare - distribution.x ;\n\t\t\tfloat variance = max( 0.00000, distribution.y * distribution.y );\n\t\t\tfloat softness_probability = variance / (variance + distance * distance );\t\t\tsoftness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );\t\t\tocclusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n\t\t}\n\t\treturn occlusion;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;\n\t\tbool frustumTest = inFrustum && shadowCoord.z <= 1.0;\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tfloat dx2 = dx0 / 2.0;\n\t\t\tfloat dy2 = dy0 / 2.0;\n\t\t\tfloat dx3 = dx1 / 2.0;\n\t\t\tfloat dy3 = dy1 / 2.0;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 17.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx = texelSize.x;\n\t\t\tfloat dy = texelSize.y;\n\t\t\tvec2 uv = shadowCoord.xy;\n\t\t\tvec2 f = fract( uv * shadowMapSize + 0.5 );\n\t\t\tuv -= f * texelSize;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, uv, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t f.y )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_VSM )\n\t\t\tshadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif",shadowmap_pars_vertex:"#if NUM_SPOT_LIGHT_COORDS > 0\n  uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];\n  varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n#endif",shadowmap_vertex:"#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )\n\tvec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\tvec4 shadowWorldPosition;\n#endif\n#if defined( USE_SHADOWMAP )\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );\n\t\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );\n\t\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if NUM_SPOT_LIGHT_COORDS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition;\n\t\t#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\t\tshadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;\n\t\t#endif\n\t\tvSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n#endif",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tdirectionalLight = directionalLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tspotLight = spotLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tpointLight = pointLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#endif\n\treturn shadow;\n}",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\tuniform highp sampler2D boneTexture;\n\tuniform int boneTextureSize;\n\tmat4 getBoneMatrix( const in float i ) {\n\t\tfloat j = i * 4.0;\n\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\tfloat y = floor( j / float( boneTextureSize ) );\n\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\tfloat dy = 1.0 / float( boneTextureSize );\n\t\ty = dy * ( y + 0.5 );\n\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\treturn bone;\n\t}\n#endif",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\t#ifdef USE_TANGENT\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#endif\n#endif",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",tonemapping_pars_fragment:"#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn toneMappingExposure * color;\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 RRTAndODTFit( vec3 v ) {\n\tvec3 a = v * ( v + 0.0245786 ) - 0.000090537;\n\tvec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;\n\treturn a / b;\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tconst mat3 ACESInputMat = mat3(\n\t\tvec3( 0.59719, 0.07600, 0.02840 ),\t\tvec3( 0.35458, 0.90834, 0.13383 ),\n\t\tvec3( 0.04823, 0.01566, 0.83777 )\n\t);\n\tconst mat3 ACESOutputMat = mat3(\n\t\tvec3(  1.60475, -0.10208, -0.00327 ),\t\tvec3( -0.53108,  1.10813, -0.07276 ),\n\t\tvec3( -0.07367, -0.00605,  1.07602 )\n\t);\n\tcolor *= toneMappingExposure / 0.6;\n\tcolor = ACESInputMat * color;\n\tcolor = RRTAndODTFit( color );\n\tcolor = ACESOutputMat * color;\n\treturn saturate( color );\n}\nvec3 CustomToneMapping( vec3 color ) { return color; }",transmission_fragment:"#ifdef USE_TRANSMISSION\n\tmaterial.transmission = transmission;\n\tmaterial.transmissionAlpha = 1.0;\n\tmaterial.thickness = thickness;\n\tmaterial.attenuationDistance = attenuationDistance;\n\tmaterial.attenuationColor = attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tmaterial.transmission *= texture2D( transmissionMap, vUv ).r;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tmaterial.thickness *= texture2D( thicknessMap, vUv ).g;\n\t#endif\n\tvec3 pos = vWorldPosition;\n\tvec3 v = normalize( cameraPosition - pos );\n\tvec3 n = inverseTransformDirection( normal, viewMatrix );\n\tvec4 transmission = getIBLVolumeRefraction(\n\t\tn, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,\n\t\tpos, modelMatrix, viewMatrix, projectionMatrix, material.ior, material.thickness,\n\t\tmaterial.attenuationColor, material.attenuationDistance );\n\tmaterial.transmissionAlpha = mix( material.transmissionAlpha, transmission.a, material.transmission );\n\ttotalDiffuse = mix( totalDiffuse, transmission.rgb, material.transmission );\n#endif",transmission_pars_fragment:"#ifdef USE_TRANSMISSION\n\tuniform float transmission;\n\tuniform float thickness;\n\tuniform float attenuationDistance;\n\tuniform vec3 attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tuniform sampler2D transmissionMap;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tuniform sampler2D thicknessMap;\n\t#endif\n\tuniform vec2 transmissionSamplerSize;\n\tuniform sampler2D transmissionSamplerMap;\n\tuniform mat4 modelMatrix;\n\tuniform mat4 projectionMatrix;\n\tvarying vec3 vWorldPosition;\n\tvec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {\n\t\tvec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );\n\t\tvec3 modelScale;\n\t\tmodelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );\n\t\tmodelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );\n\t\tmodelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );\n\t\treturn normalize( refractionVector ) * thickness * modelScale;\n\t}\n\tfloat applyIorToRoughness( const in float roughness, const in float ior ) {\n\t\treturn roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );\n\t}\n\tvec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {\n\t\tfloat framebufferLod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );\n\t\t#ifdef texture2DLodEXT\n\t\t\treturn texture2DLodEXT( transmissionSamplerMap, fragCoord.xy, framebufferLod );\n\t\t#else\n\t\t\treturn texture2D( transmissionSamplerMap, fragCoord.xy, framebufferLod );\n\t\t#endif\n\t}\n\tvec3 applyVolumeAttenuation( const in vec3 radiance, const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tif ( isinf( attenuationDistance ) ) {\n\t\t\treturn radiance;\n\t\t} else {\n\t\t\tvec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;\n\t\t\tvec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );\t\t\treturn transmittance * radiance;\n\t\t}\n\t}\n\tvec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,\n\t\tconst in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,\n\t\tconst in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,\n\t\tconst in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tvec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );\n\t\tvec3 refractedRayExit = position + transmissionRay;\n\t\tvec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );\n\t\tvec2 refractionCoords = ndcPos.xy / ndcPos.w;\n\t\trefractionCoords += 1.0;\n\t\trefractionCoords /= 2.0;\n\t\tvec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );\n\t\tvec3 attenuatedColor = applyVolumeAttenuation( transmittedLight.rgb, length( transmissionRay ), attenuationColor, attenuationDistance );\n\t\tvec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );\n\t\treturn vec4( ( 1.0 - F ) * attenuatedColor * diffuseColor, transmittedLight.a );\n\t}\n#endif",uv_pars_fragment:"#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )\n\tvarying vec2 vUv;\n#endif",uv_pars_vertex:"#ifdef USE_UV\n\t#ifdef UVS_VERTEX_ONLY\n\t\tvec2 vUv;\n\t#else\n\t\tvarying vec2 vUv;\n\t#endif\n\tuniform mat3 uvTransform;\n#endif",uv_vertex:"#ifdef USE_UV\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n#endif",uv2_pars_fragment:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvarying vec2 vUv2;\n#endif",uv2_pars_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tattribute vec2 uv2;\n\tvarying vec2 vUv2;\n\tuniform mat3 uv2Transform;\n#endif",uv2_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0\n\tvec4 worldPosition = vec4( transformed, 1.0 );\n\t#ifdef USE_INSTANCING\n\t\tworldPosition = instanceMatrix * worldPosition;\n\t#endif\n\tworldPosition = modelMatrix * worldPosition;\n#endif",background_vert:"varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}",background_frag:"uniform sampler2D t2D;\nuniform float backgroundIntensity;\nvarying vec2 vUv;\nvoid main() {\n\tvec4 texColor = texture2D( t2D, vUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\ttexColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );\n\t#endif\n\ttexColor.rgb *= backgroundIntensity;\n\tgl_FragColor = texColor;\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",backgroundCube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",backgroundCube_frag:"#ifdef ENVMAP_TYPE_CUBE\n\tuniform samplerCube envMap;\n#elif defined( ENVMAP_TYPE_CUBE_UV )\n\tuniform sampler2D envMap;\n#endif\nuniform float flipEnvMap;\nuniform float backgroundBlurriness;\nuniform float backgroundIntensity;\nvarying vec3 vWorldDirection;\n#include <cube_uv_reflection_fragment>\nvoid main() {\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 texColor = textureCube( envMap, vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );\n\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\tvec4 texColor = textureCubeUV( envMap, vWorldDirection, backgroundBlurriness );\n\t#else\n\t\tvec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t#endif\n\ttexColor.rgb *= backgroundIntensity;\n\tgl_FragColor = texColor;\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",cube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",cube_frag:"uniform samplerCube tCube;\nuniform float tFlip;\nuniform float opacity;\nvarying vec3 vWorldDirection;\nvoid main() {\n\tvec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );\n\tgl_FragColor = texColor;\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",depth_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvHighPrecisionZW = gl_Position.zw;\n}",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <logdepthbuf_fragment>\n\tfloat fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( fragCoordZ );\n\t#endif\n}",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}",equirect_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV = equirectUv( direction );\n\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\tvLineDistance = scale * lineDistance;\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",meshbasic_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinbase_vertex>\n\t\t#include <skinnormal_vertex>\n\t\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vUv2 );\n\t\treflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshlambert_vert:"#define LAMBERT\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshlambert_frag:"#define LAMBERT\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_lambert_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_lambert_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshmatcap_vert:"#define MATCAP\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}",meshmatcap_frag:"#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t#else\n\t\tvec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );\n\t#endif\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshnormal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}",meshnormal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n\t#ifdef OPAQUE\n\t\tgl_FragColor.a = 1.0;\n\t#endif\n}",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphysical_vert:"#define STANDARD\nvarying vec3 vViewPosition;\n#ifdef USE_TRANSMISSION\n\tvarying vec3 vWorldPosition;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n#ifdef USE_TRANSMISSION\n\tvWorldPosition = worldPosition.xyz;\n#endif\n}",meshphysical_frag:"#define STANDARD\n#ifdef PHYSICAL\n\t#define IOR\n\t#define SPECULAR\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef IOR\n\tuniform float ior;\n#endif\n#ifdef SPECULAR\n\tuniform float specularIntensity;\n\tuniform vec3 specularColor;\n\t#ifdef USE_SPECULARINTENSITYMAP\n\t\tuniform sampler2D specularIntensityMap;\n\t#endif\n\t#ifdef USE_SPECULARCOLORMAP\n\t\tuniform sampler2D specularColorMap;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n#ifdef USE_IRIDESCENCE\n\tuniform float iridescence;\n\tuniform float iridescenceIOR;\n\tuniform float iridescenceThicknessMinimum;\n\tuniform float iridescenceThicknessMaximum;\n#endif\n#ifdef USE_SHEEN\n\tuniform vec3 sheenColor;\n\tuniform float sheenRoughness;\n\t#ifdef USE_SHEENCOLORMAP\n\t\tuniform sampler2D sheenColorMap;\n\t#endif\n\t#ifdef USE_SHEENROUGHNESSMAP\n\t\tuniform sampler2D sheenRoughnessMap;\n\t#endif\n#endif\nvarying vec3 vViewPosition;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <bsdfs>\n#include <iridescence_fragment>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_physical_pars_fragment>\n#include <transmission_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <iridescence_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;\n\tvec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;\n\t#include <transmission_fragment>\n\tvec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;\n\t#ifdef USE_SHEEN\n\t\tfloat sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );\n\t\toutgoingLight = outgoingLight * sheenEnergyComp + sheenSpecular;\n\t#endif\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNVcc = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );\n\t\tvec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );\n\t\toutgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + clearcoatSpecular * material.clearcoat;\n\t#endif\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshtoon_vert:"#define TOON\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshtoon_frag:"#define TOON\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_toon_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",shadow_vert:"#include <common>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\tvec2 scale;\n\tscale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n\tscale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}"},Zx={common:{diffuse:{value:new Ev(16777215)},opacity:{value:1},map:{value:null},uvTransform:{value:new uv},uv2Transform:{value:new uv},alphaMap:{value:null},alphaTest:{value:0}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new lv(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Ev(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new Ev(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new uv}},sprite:{diffuse:{value:new Ev(16777215)},opacity:{value:1},center:{value:new lv(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new uv}}},Jx={basic:{uniforms:Px([Zx.common,Zx.specularmap,Zx.envmap,Zx.aomap,Zx.lightmap,Zx.fog]),vertexShader:Kx.meshbasic_vert,fragmentShader:Kx.meshbasic_frag},lambert:{uniforms:Px([Zx.common,Zx.specularmap,Zx.envmap,Zx.aomap,Zx.lightmap,Zx.emissivemap,Zx.bumpmap,Zx.normalmap,Zx.displacementmap,Zx.fog,Zx.lights,{emissive:{value:new Ev(0)}}]),vertexShader:Kx.meshlambert_vert,fragmentShader:Kx.meshlambert_frag},phong:{uniforms:Px([Zx.common,Zx.specularmap,Zx.envmap,Zx.aomap,Zx.lightmap,Zx.emissivemap,Zx.bumpmap,Zx.normalmap,Zx.displacementmap,Zx.fog,Zx.lights,{emissive:{value:new Ev(0)},specular:{value:new Ev(1118481)},shininess:{value:30}}]),vertexShader:Kx.meshphong_vert,fragmentShader:Kx.meshphong_frag},standard:{uniforms:Px([Zx.common,Zx.envmap,Zx.aomap,Zx.lightmap,Zx.emissivemap,Zx.bumpmap,Zx.normalmap,Zx.displacementmap,Zx.roughnessmap,Zx.metalnessmap,Zx.fog,Zx.lights,{emissive:{value:new Ev(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:Kx.meshphysical_vert,fragmentShader:Kx.meshphysical_frag},toon:{uniforms:Px([Zx.common,Zx.aomap,Zx.lightmap,Zx.emissivemap,Zx.bumpmap,Zx.normalmap,Zx.displacementmap,Zx.gradientmap,Zx.fog,Zx.lights,{emissive:{value:new Ev(0)}}]),vertexShader:Kx.meshtoon_vert,fragmentShader:Kx.meshtoon_frag},matcap:{uniforms:Px([Zx.common,Zx.bumpmap,Zx.normalmap,Zx.displacementmap,Zx.fog,{matcap:{value:null}}]),vertexShader:Kx.meshmatcap_vert,fragmentShader:Kx.meshmatcap_frag},points:{uniforms:Px([Zx.points,Zx.fog]),vertexShader:Kx.points_vert,fragmentShader:Kx.points_frag},dashed:{uniforms:Px([Zx.common,Zx.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Kx.linedashed_vert,fragmentShader:Kx.linedashed_frag},depth:{uniforms:Px([Zx.common,Zx.displacementmap]),vertexShader:Kx.depth_vert,fragmentShader:Kx.depth_frag},normal:{uniforms:Px([Zx.common,Zx.bumpmap,Zx.normalmap,Zx.displacementmap,{opacity:{value:1}}]),vertexShader:Kx.meshnormal_vert,fragmentShader:Kx.meshnormal_frag},sprite:{uniforms:Px([Zx.sprite,Zx.fog]),vertexShader:Kx.sprite_vert,fragmentShader:Kx.sprite_frag},background:{uniforms:{uvTransform:{value:new uv},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:Kx.background_vert,fragmentShader:Kx.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1}},vertexShader:Kx.backgroundCube_vert,fragmentShader:Kx.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:Kx.cube_vert,fragmentShader:Kx.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Kx.equirect_vert,fragmentShader:Kx.equirect_frag},distanceRGBA:{uniforms:Px([Zx.common,Zx.displacementmap,{referencePosition:{value:new Lv},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Kx.distanceRGBA_vert,fragmentShader:Kx.distanceRGBA_frag},shadow:{uniforms:Px([Zx.lights,Zx.fog,{color:{value:new Ev(0)},opacity:{value:1}}]),vertexShader:Kx.shadow_vert,fragmentShader:Kx.shadow_frag}};Jx.physical={uniforms:Px([Jx.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new lv(1,1)},clearcoatNormalMap:{value:null},iridescence:{value:0},iridescenceMap:{value:null},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},sheen:{value:0},sheenColor:{value:new Ev(0)},sheenColorMap:{value:null},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},transmission:{value:0},transmissionMap:{value:null},transmissionSamplerSize:{value:new lv},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},attenuationDistance:{value:0},attenuationColor:{value:new Ev(0)},specularIntensity:{value:1},specularIntensityMap:{value:null},specularColor:{value:new Ev(1,1,1)},specularColorMap:{value:null}}]),vertexShader:Kx.meshphysical_vert,fragmentShader:Kx.meshphysical_frag};var $x={r:0,b:0,g:0};function eb(e,t,n,i,r,s,a){let o,l,u=new Ev(0),c=!0===s?0:1,h=null,d=0,p=null;function f(t,n){t.getRGB($x,Fx(e)),i.buffers.color.setClear($x.r,$x.g,$x.b,n,a)}return{getClearColor:function(){return u},setClearColor:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;u.set(e),c=t,f(u,c)},getClearAlpha:function(){return c},setClearAlpha:function(e){c=e,f(u,c)},render:function(i,s){let a=!1,m=!0===s.isScene?s.background:null;m&&m.isTexture&&(m=(s.backgroundBlurriness>0?n:t).get(m));let g=e.xr,v=g.getSession&&g.getSession();v&&"additive"===v.environmentBlendMode&&(m=null),null===m?f(u,c):m&&m.isColor&&(f(m,1),a=!0),(e.autoClear||a)&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),m&&(m.isCubeTexture||m.mapping===sg)?(void 0===l&&(l=new Cx(new Mx(1,1,1),new Ix({name:"BackgroundCubeMaterial",uniforms:Tx(Jx.backgroundCube.uniforms),vertexShader:Jx.backgroundCube.vertexShader,fragmentShader:Jx.backgroundCube.fragmentShader,side:1,depthTest:!1,depthWrite:!1,fog:!1})),l.geometry.deleteAttribute("normal"),l.geometry.deleteAttribute("uv"),l.onBeforeRender=function(e,t,n){this.matrixWorld.copyPosition(n.matrixWorld)},Object.defineProperty(l.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),r.update(l)),l.material.uniforms.envMap.value=m,l.material.uniforms.flipEnvMap.value=m.isCubeTexture&&!1===m.isRenderTargetTexture?-1:1,l.material.uniforms.backgroundBlurriness.value=s.backgroundBlurriness,l.material.uniforms.backgroundIntensity.value=s.backgroundIntensity,l.material.toneMapped=m.encoding!==Ng,(h!==m||d!==m.version||p!==e.toneMapping)&&(l.material.needsUpdate=!0,h=m,d=m.version,p=e.toneMapping),l.layers.enableAll(),i.unshift(l,l.geometry,l.material,0,0,null)):m&&m.isTexture&&(void 0===o&&(o=new Cx(new Qx(2,2),new Ix({name:"BackgroundMaterial",uniforms:Tx(Jx.background.uniforms),vertexShader:Jx.background.vertexShader,fragmentShader:Jx.background.fragmentShader,side:0,depthTest:!1,depthWrite:!1,fog:!1})),o.geometry.deleteAttribute("normal"),Object.defineProperty(o.material,"map",{get:function(){return this.uniforms.t2D.value}}),r.update(o)),o.material.uniforms.t2D.value=m,o.material.uniforms.backgroundIntensity.value=s.backgroundIntensity,o.material.toneMapped=m.encoding!==Ng,!0===m.matrixAutoUpdate&&m.updateMatrix(),o.material.uniforms.uvTransform.value.copy(m.matrix),(h!==m||d!==m.version||p!==e.toneMapping)&&(o.material.needsUpdate=!0,h=m,d=m.version,p=e.toneMapping),o.layers.enableAll(),i.unshift(o,o.geometry,o.material,0,0,null))}}}function tb(e,t,n,i){let r=e.getParameter(34921),s=i.isWebGL2?null:t.get("OES_vertex_array_object"),a=i.isWebGL2||null!==s,o={},l=p(null),u=l,c=!1;function h(t){return i.isWebGL2?e.bindVertexArray(t):s.bindVertexArrayOES(t)}function d(t){return i.isWebGL2?e.deleteVertexArray(t):s.deleteVertexArrayOES(t)}function p(e){let t=[],n=[],i=[];for(let s=0;s<r;s++)t[s]=0,n[s]=0,i[s]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:t,enabledAttributes:n,attributeDivisors:i,object:e,attributes:{},index:null}}function f(){let e=u.newAttributes;for(let t=0,n=e.length;t<n;t++)e[t]=0}function m(e){g(e,0)}function g(n,r){let s=u.newAttributes,a=u.enabledAttributes,o=u.attributeDivisors;s[n]=1,0===a[n]&&(e.enableVertexAttribArray(n),a[n]=1),o[n]!==r&&((i.isWebGL2?e:t.get("ANGLE_instanced_arrays"))[i.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](n,r),o[n]=r)}function v(){let t=u.newAttributes,n=u.enabledAttributes;for(let i=0,r=n.length;i<r;i++)n[i]!==t[i]&&(e.disableVertexAttribArray(i),n[i]=0)}function y(t,n,r,s,a,o){!0!==i.isWebGL2||5124!==r&&5125!==r?e.vertexAttribPointer(t,n,r,s,a,o):e.vertexAttribIPointer(t,n,r,a,o)}function x(){b(),c=!0,u!==l&&(u=l,h(u.object))}function b(){l.geometry=null,l.program=null,l.wireframe=!1}return{setup:function(r,l,d,x,b){let w=!1;if(a){let t=function(t,n,r){let a=!0===r.wireframe,l=o[t.id];void 0===l&&(l={},o[t.id]=l);let u=l[n.id];void 0===u&&(u={},l[n.id]=u);let c=u[a];return void 0===c&&(c=p(i.isWebGL2?e.createVertexArray():s.createVertexArrayOES()),u[a]=c),c}(x,d,l);u!==t&&(u=t,h(u.object)),w=function(e,t,n,i){let r=u.attributes,s=t.attributes,a=0,o=n.getAttributes();for(let l in o)if(o[l].location>=0){let t=r[l],n=s[l];if(void 0===n&&("instanceMatrix"===l&&e.instanceMatrix&&(n=e.instanceMatrix),"instanceColor"===l&&e.instanceColor&&(n=e.instanceColor)),void 0===t||t.attribute!==n||n&&t.data!==n.data)return!0;a++}return u.attributesNum!==a||u.index!==i}(r,x,d,b),w&&function(e,t,n,i){let r={},s=t.attributes,a=0,o=n.getAttributes();for(let l in o)if(o[l].location>=0){let t=s[l];void 0===t&&("instanceMatrix"===l&&e.instanceMatrix&&(t=e.instanceMatrix),"instanceColor"===l&&e.instanceColor&&(t=e.instanceColor));let n={};n.attribute=t,t&&t.data&&(n.data=t.data),r[l]=n,a++}u.attributes=r,u.attributesNum=a,u.index=i}(r,x,d,b)}else{let e=!0===l.wireframe;(u.geometry!==x.id||u.program!==d.id||u.wireframe!==e)&&(u.geometry=x.id,u.program=d.id,u.wireframe=e,w=!0)}null!==b&&n.update(b,34963),(w||c)&&(c=!1,function(r,s,a,o){if(!1===i.isWebGL2&&(r.isInstancedMesh||o.isInstancedBufferGeometry)&&null===t.get("ANGLE_instanced_arrays"))return;f();let l=o.attributes,u=a.getAttributes(),c=s.defaultAttributeValues;for(let t in u){let i=u[t];if(i.location>=0){let s=l[t];if(void 0===s&&("instanceMatrix"===t&&r.instanceMatrix&&(s=r.instanceMatrix),"instanceColor"===t&&r.instanceColor&&(s=r.instanceColor)),void 0!==s){let t=s.normalized,a=s.itemSize,l=n.get(s);if(void 0===l)continue;let u=l.buffer,c=l.type,h=l.bytesPerElement;if(s.isInterleavedBufferAttribute){let n=s.data,l=n.stride,d=s.offset;if(n.isInstancedInterleavedBuffer){for(let e=0;e<i.locationSize;e++)g(i.location+e,n.meshPerAttribute);!0!==r.isInstancedMesh&&void 0===o._maxInstanceCount&&(o._maxInstanceCount=n.meshPerAttribute*n.count)}else for(let e=0;e<i.locationSize;e++)m(i.location+e);e.bindBuffer(34962,u);for(let e=0;e<i.locationSize;e++)y(i.location+e,a/i.locationSize,c,t,l*h,(d+a/i.locationSize*e)*h)}else{if(s.isInstancedBufferAttribute){for(let e=0;e<i.locationSize;e++)g(i.location+e,s.meshPerAttribute);!0!==r.isInstancedMesh&&void 0===o._maxInstanceCount&&(o._maxInstanceCount=s.meshPerAttribute*s.count)}else for(let e=0;e<i.locationSize;e++)m(i.location+e);e.bindBuffer(34962,u);for(let e=0;e<i.locationSize;e++)y(i.location+e,a/i.locationSize,c,t,a*h,a/i.locationSize*e*h)}}else if(void 0!==c){let n=c[t];if(void 0!==n)switch(n.length){case 2:e.vertexAttrib2fv(i.location,n);break;case 3:e.vertexAttrib3fv(i.location,n);break;case 4:e.vertexAttrib4fv(i.location,n);break;default:e.vertexAttrib1fv(i.location,n)}}}}v()}(r,l,d,x),null!==b&&e.bindBuffer(34963,n.get(b).buffer))},reset:x,resetDefaultState:b,dispose:function(){x();for(let e in o){let t=o[e];for(let e in t){let n=t[e];for(let e in n)d(n[e].object),delete n[e];delete t[e]}delete o[e]}},releaseStatesOfGeometry:function(e){if(void 0===o[e.id])return;let t=o[e.id];for(let n in t){let e=t[n];for(let t in e)d(e[t].object),delete e[t];delete t[n]}delete o[e.id]},releaseStatesOfProgram:function(e){for(let t in o){let n=o[t];if(void 0===n[e.id])continue;let i=n[e.id];for(let e in i)d(i[e].object),delete i[e];delete n[e.id]}},initAttributes:f,enableAttribute:m,disableUnusedAttributes:v}}function nb(e,t,n,i){let r,s=i.isWebGL2;this.setMode=function(e){r=e},this.render=function(t,i){e.drawArrays(r,t,i),n.update(i,r,1)},this.renderInstances=function(i,a,o){if(0===o)return;let l,u;if(s)l=e,u="drawArraysInstanced";else if(l=t.get("ANGLE_instanced_arrays"),u="drawArraysInstancedANGLE",null===l)return void console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");l[u](r,i,a,o),n.update(a,r,o)}}function ib(e,t,n){let i;function r(t){if("highp"===t){if(e.getShaderPrecisionFormat(35633,36338).precision>0&&e.getShaderPrecisionFormat(35632,36338).precision>0)return"highp";t="mediump"}return"mediump"===t&&e.getShaderPrecisionFormat(35633,36337).precision>0&&e.getShaderPrecisionFormat(35632,36337).precision>0?"mediump":"lowp"}let s=typeof WebGL2RenderingContext<"u"&&e instanceof WebGL2RenderingContext,a=void 0!==n.precision?n.precision:"highp",o=r(a);o!==a&&(console.warn("THREE.WebGLRenderer:",a,"not supported, using",o,"instead."),a=o);let l=s||t.has("WEBGL_draw_buffers"),u=!0===n.logarithmicDepthBuffer,c=e.getParameter(34930),h=e.getParameter(35660),d=e.getParameter(3379),p=e.getParameter(34076),f=e.getParameter(34921),m=e.getParameter(36347),g=e.getParameter(36348),v=e.getParameter(36349),y=h>0,x=s||t.has("OES_texture_float");return{isWebGL2:s,drawBuffers:l,getMaxAnisotropy:function(){if(void 0!==i)return i;if(!0===t.has("EXT_texture_filter_anisotropic")){let n=t.get("EXT_texture_filter_anisotropic");i=e.getParameter(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else i=0;return i},getMaxPrecision:r,precision:a,logarithmicDepthBuffer:u,maxTextures:c,maxVertexTextures:h,maxTextureSize:d,maxCubemapSize:p,maxAttributes:f,maxVertexUniforms:m,maxVaryings:g,maxFragmentUniforms:v,vertexTextures:y,floatFragmentTextures:x,floatVertexTextures:y&&x,maxSamples:s?e.getParameter(36183):0}}function rb(e){let t=this,n=null,i=0,r=!1,s=!1,a=new Hx,o=new uv,l={value:null,needsUpdate:!1};function u(e,n,i,r){let s=null!==e?e.length:0,u=null;if(0!==s){if(u=l.value,!0!==r||null===u){let t=i+4*s,r=n.matrixWorldInverse;o.getNormalMatrix(r),(null===u||u.length<t)&&(u=new Float32Array(t));for(let n=0,l=i;n!==s;++n,l+=4)a.copy(e[n]).applyMatrix4(r,o),a.normal.toArray(u,l),u[l+3]=a.constant}l.value=u,l.needsUpdate=!0}return t.numPlanes=s,t.numIntersection=0,u}this.uniform=l,this.numPlanes=0,this.numIntersection=0,this.init=function(e,t){let n=0!==e.length||t||0!==i||r;return r=t,i=e.length,n},this.beginShadows=function(){s=!0,u(null)},this.endShadows=function(){s=!1},this.setGlobalState=function(e,t){n=u(e,t,0)},this.setState=function(a,o,c){let h=a.clippingPlanes,d=a.clipIntersection,p=a.clipShadows,f=e.get(a);if(!r||null===h||0===h.length||s&&!p)s?u(null):(l.value!==n&&(l.value=n,l.needsUpdate=i>0),t.numPlanes=i,t.numIntersection=0);else{let e=s?0:i,t=4*e,r=f.clippingState||null;l.value=r,r=u(h,o,t,c);for(let i=0;i!==t;++i)r[i]=n[i];f.clippingState=r,this.numIntersection=d?this.numPlanes:0,this.numPlanes+=e}}}function sb(e){let t=new WeakMap;function n(e,t){return 303===t?e.mapping=ig:304===t&&(e.mapping=rg),e}function i(e){let n=e.target;n.removeEventListener("dispose",i);let r=t.get(n);void 0!==r&&(t.delete(n),r.dispose())}return{get:function(r){if(r&&r.isTexture&&!1===r.isRenderTargetTexture){let s=r.mapping;if(303===s||304===s){if(t.has(r)){return n(t.get(r).texture,r.mapping)}{let s=r.image;if(s&&s.height>0){let a=new Nx(s.height/2);return a.fromEquirectangularTexture(e,r),t.set(r,a),r.addEventListener("dispose",i),n(a.texture,r.mapping)}return null}}}return r},dispose:function(){t=new WeakMap}}}var ab=class extends kx{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:-1,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.1,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:2e3;super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=n,this.bottom=i,this.near=r,this.far=s,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=null===e.view?null:Object.assign({},e.view),this}setViewOffset(e,t,n,i,r,s){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=i,this.view.width=r,this.view.height=s,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){let e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,i=(this.top+this.bottom)/2,r=n-e,s=n+e,a=i+t,o=i-t;if(null!==this.view&&this.view.enabled){let e=(this.right-this.left)/this.view.fullWidth/this.zoom,t=(this.top-this.bottom)/this.view.fullHeight/this.zoom;r+=e*this.view.offsetX,s=r+e*this.view.width,a-=t*this.view.offsetY,o=a-t*this.view.height}this.projectionMatrix.makeOrthographic(r,s,a,o,this.near,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){let t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,null!==this.view&&(t.object.view=Object.assign({},this.view)),t}},ob=[.125,.215,.35,.446,.526,.582],lb=20,ub=new ab,cb=new Ev,hb=null,db=(1+Math.sqrt(5))/2,pb=1/db,fb=[new Lv(1,1,1),new Lv(-1,1,1),new Lv(1,1,-1),new Lv(-1,1,-1),new Lv(0,db,pb),new Lv(0,db,-pb),new Lv(pb,0,db),new Lv(-pb,0,db),new Lv(db,pb,0),new Lv(-db,pb,0)],mb=class{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:100;hb=this._renderer.getRenderTarget(),this._setSize(256);let r=this._allocateTargets();return r.depthBuffer=!0,this._sceneToCubeUV(e,n,i,r),t>0&&this._blur(r,0,0,t),this._applyPMREM(r),this._cleanup(r),r}fromEquirectangular(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return this._fromTexture(e,t)}fromCubemap(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return this._fromTexture(e,t)}compileCubemapShader(){null===this._cubemapMaterial&&(this._cubemapMaterial=xb(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){null===this._equirectMaterial&&(this._equirectMaterial=yb(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),null!==this._cubemapMaterial&&this._cubemapMaterial.dispose(),null!==this._equirectMaterial&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){null!==this._blurMaterial&&this._blurMaterial.dispose(),null!==this._pingPongRenderTarget&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(hb),e.scissorTest=!1,vb(e,0,0,e.width,e.height)}_fromTexture(e,t){e.mapping===ig||e.mapping===rg?this._setSize(0===e.image.length?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),hb=this._renderer.getRenderTarget();let n=t||this._allocateTargets();return this._textureToCubeUV(e,n),this._applyPMREM(n),this._cleanup(n),n}_allocateTargets(){let e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,n={magFilter:dg,minFilter:dg,generateMipmaps:!1,type:yg,format:bg,encoding:zg,depthBuffer:!1},i=gb(e,t,n);if(null===this._pingPongRenderTarget||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==t){null!==this._pingPongRenderTarget&&this._dispose(),this._pingPongRenderTarget=gb(e,t,n);let{_lodMax:i}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=function(e){let t=[],n=[],i=[],r=e,s=e-4+1+ob.length;for(let a=0;a<s;a++){let s=Math.pow(2,r);n.push(s);let o=1/s;a>e-4?o=ob[a-e+4-1]:0===a&&(o=0),i.push(o);let l=1/(s-2),u=-l,c=1+l,h=[u,u,c,u,c,c,u,u,c,c,u,c],d=6,p=6,f=3,m=2,g=1,v=new Float32Array(f*p*d),y=new Float32Array(m*p*d),x=new Float32Array(g*p*d);for(let e=0;e<d;e++){let t=e%3*2/3-1,n=e>2?0:-1,i=[t,n,0,t+2/3,n,0,t+2/3,n+1,0,t,n,0,t+2/3,n+1,0,t,n+1,0];v.set(i,f*p*e),y.set(h,m*p*e);let r=[e,e,e,e,e,e];x.set(r,g*p*e)}let b=new dx;b.setAttribute("position",new tx(v,f)),b.setAttribute("uv",new tx(y,m)),b.setAttribute("faceIndex",new tx(x,g)),t.push(b),r>4&&r--}return{lodPlanes:t,sizeLods:n,sigmas:i}}(i)),this._blurMaterial=function(e,t,n){let i=new Float32Array(lb),r=new Lv(0,1,0);return new Ix({name:"SphericalGaussianBlur",defines:{n:lb,CUBEUV_TEXEL_WIDTH:1/t,CUBEUV_TEXEL_HEIGHT:1/n,CUBEUV_MAX_MIP:"".concat(e,".0")},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:i},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:r}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform int samples;\n\t\t\tuniform float weights[ n ];\n\t\t\tuniform bool latitudinal;\n\t\t\tuniform float dTheta;\n\t\t\tuniform float mipInt;\n\t\t\tuniform vec3 poleAxis;\n\n\t\t\t#define ENVMAP_TYPE_CUBE_UV\n\t\t\t#include <cube_uv_reflection_fragment>\n\n\t\t\tvec3 getSample( float theta, vec3 axis ) {\n\n\t\t\t\tfloat cosTheta = cos( theta );\n\t\t\t\t// Rodrigues' axis-angle rotation\n\t\t\t\tvec3 sampleDirection = vOutputDirection * cosTheta\n\t\t\t\t\t+ cross( axis, vOutputDirection ) * sin( theta )\n\t\t\t\t\t+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );\n\n\t\t\t\treturn bilinearCubeUV( envMap, sampleDirection, mipInt );\n\n\t\t\t}\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );\n\n\t\t\t\tif ( all( equal( axis, vec3( 0.0 ) ) ) ) {\n\n\t\t\t\t\taxis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );\n\n\t\t\t\t}\n\n\t\t\t\taxis = normalize( axis );\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t\t\t\tgl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );\n\n\t\t\t\tfor ( int i = 1; i < n; i++ ) {\n\n\t\t\t\t\tif ( i >= samples ) {\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tfloat theta = dTheta * float( i );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( theta, axis );\n\n\t\t\t\t}\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}(i,e,t)}return i}_compileMaterial(e){let t=new Cx(this._lodPlanes[0],e);this._renderer.compile(t,ub)}_sceneToCubeUV(e,t,n,i){let r=new Bx(90,1,t,n),s=[1,-1,1,1,1,1],a=[1,1,1,-1,-1,-1],o=this._renderer,l=o.autoClear,u=o.toneMapping;o.getClearColor(cb),o.toneMapping=0,o.autoClear=!1;let c=new Jy({name:"PMREM.Background",side:1,depthWrite:!1,depthTest:!1}),h=new Cx(new Mx,c),d=!1,p=e.background;p?p.isColor&&(c.color.copy(p),e.background=null,d=!0):(c.color.copy(cb),d=!0);for(let f=0;f<6;f++){let t=f%3;0===t?(r.up.set(0,s[f],0),r.lookAt(a[f],0,0)):1===t?(r.up.set(0,0,s[f]),r.lookAt(0,a[f],0)):(r.up.set(0,s[f],0),r.lookAt(0,0,a[f]));let n=this._cubeSize;vb(i,t*n,f>2?n:0,n,n),o.setRenderTarget(i),d&&o.render(h,r),o.render(e,r)}h.geometry.dispose(),h.material.dispose(),o.toneMapping=u,o.autoClear=l,e.background=p}_textureToCubeUV(e,t){let n=this._renderer,i=e.mapping===ig||e.mapping===rg;i?(null===this._cubemapMaterial&&(this._cubemapMaterial=xb()),this._cubemapMaterial.uniforms.flipEnvMap.value=!1===e.isRenderTargetTexture?-1:1):null===this._equirectMaterial&&(this._equirectMaterial=yb());let r=i?this._cubemapMaterial:this._equirectMaterial,s=new Cx(this._lodPlanes[0],r);r.uniforms.envMap.value=e;let a=this._cubeSize;vb(t,0,0,3*a,2*a),n.setRenderTarget(t),n.render(s,ub)}_applyPMREM(e){let t=this._renderer,n=t.autoClear;t.autoClear=!1;for(let i=1;i<this._lodPlanes.length;i++){let t=Math.sqrt(this._sigmas[i]*this._sigmas[i]-this._sigmas[i-1]*this._sigmas[i-1]),n=fb[(i-1)%fb.length];this._blur(e,i-1,i,t,n)}t.autoClear=n}_blur(e,t,n,i,r){let s=this._pingPongRenderTarget;this._halfBlur(e,s,t,n,i,"latitudinal",r),this._halfBlur(s,e,n,n,i,"longitudinal",r)}_halfBlur(e,t,n,i,r,s,a){let o=this._renderer,l=this._blurMaterial;"latitudinal"!==s&&"longitudinal"!==s&&console.error("blur direction must be either latitudinal or longitudinal!");let u=new Cx(this._lodPlanes[i],l),c=l.uniforms,h=this._sizeLods[n]-1,d=isFinite(r)?Math.PI/(2*h):2*Math.PI/39,p=r/d,f=isFinite(r)?1+Math.floor(3*p):lb;f>lb&&console.warn("sigmaRadians, ".concat(r,", is too large and will clip, as it requested ").concat(f," samples when the maximum is set to ").concat(lb));let m=[],g=0;for(let x=0;x<lb;++x){let e=x/p,t=Math.exp(-e*e/2);m.push(t),0===x?g+=t:x<f&&(g+=2*t)}for(let x=0;x<m.length;x++)m[x]=m[x]/g;c.envMap.value=e.texture,c.samples.value=f,c.weights.value=m,c.latitudinal.value="latitudinal"===s,a&&(c.poleAxis.value=a);let{_lodMax:v}=this;c.dTheta.value=d,c.mipInt.value=v-n;let y=this._sizeLods[i];vb(t,3*y*(i>v-4?i-v+4:0),4*(this._cubeSize-y),3*y,2*y),o.setRenderTarget(t),o.render(u,ub)}};function gb(e,t,n){let i=new Iv(e,t,n);return i.texture.mapping=sg,i.texture.name="PMREM.cubeUv",i.scissorTest=!0,i}function vb(e,t,n,i,r){e.viewport.set(t,n,i,r),e.scissor.set(t,n,i,r)}function yb(){return new Ix({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\n\t\t\t#include <common>\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 outputDirection = normalize( vOutputDirection );\n\t\t\t\tvec2 uv = equirectUv( outputDirection );\n\n\t\t\t\tgl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}function xb(){return new Ix({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tuniform float flipEnvMap;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform samplerCube envMap;\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}function bb(e){let t=new WeakMap,n=null;function i(e){let n=e.target;n.removeEventListener("dispose",i);let r=t.get(n);void 0!==r&&(t.delete(n),r.dispose())}return{get:function(r){if(r&&r.isTexture){let s=r.mapping,a=303===s||304===s,o=s===ig||s===rg;if(a||o){if(r.isRenderTargetTexture&&!0===r.needsPMREMUpdate){r.needsPMREMUpdate=!1;let i=t.get(r);return null===n&&(n=new mb(e)),i=a?n.fromEquirectangular(r,i):n.fromCubemap(r,i),t.set(r,i),i.texture}if(t.has(r))return t.get(r).texture;{let s=r.image;if(a&&s&&s.height>0||o&&s&&function(e){let t=0,n=6;for(let i=0;i<n;i++)void 0!==e[i]&&t++;return t===n}(s)){null===n&&(n=new mb(e));let s=a?n.fromEquirectangular(r):n.fromCubemap(r);return t.set(r,s),r.addEventListener("dispose",i),s.texture}return null}}}return r},dispose:function(){t=new WeakMap,null!==n&&(n.dispose(),n=null)}}}function wb(e){let t={};function n(n){if(void 0!==t[n])return t[n];let i;switch(n){case"WEBGL_depth_texture":i=e.getExtension("WEBGL_depth_texture")||e.getExtension("MOZ_WEBGL_depth_texture")||e.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":i=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":i=e.getExtension("WEBGL_compressed_texture_s3tc")||e.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":i=e.getExtension("WEBGL_compressed_texture_pvrtc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:i=e.getExtension(n)}return t[n]=i,i}return{has:function(e){return null!==n(e)},init:function(e){e.isWebGL2?n("EXT_color_buffer_float"):(n("WEBGL_depth_texture"),n("OES_texture_float"),n("OES_texture_half_float"),n("OES_texture_half_float_linear"),n("OES_standard_derivatives"),n("OES_element_index_uint"),n("OES_vertex_array_object"),n("ANGLE_instanced_arrays")),n("OES_texture_float_linear"),n("EXT_color_buffer_half_float"),n("WEBGL_multisampled_render_to_texture")},get:function(e){let t=n(e);return null===t&&console.warn("THREE.WebGLRenderer: "+e+" extension not supported."),t}}}function Db(e,t,n,i){let r={},s=new WeakMap;function a(e){let o=e.target;null!==o.index&&t.remove(o.index);for(let n in o.attributes)t.remove(o.attributes[n]);o.removeEventListener("dispose",a),delete r[o.id];let l=s.get(o);l&&(t.remove(l),s.delete(o)),i.releaseStatesOfGeometry(o),!0===o.isInstancedBufferGeometry&&delete o._maxInstanceCount,n.memory.geometries--}function o(e){let n=[],i=e.index,r=e.attributes.position,a=0;if(null!==i){let e=i.array;a=i.version;for(let t=0,i=e.length;t<i;t+=3){let i=e[t+0],r=e[t+1],s=e[t+2];n.push(i,r,r,s,s,i)}}else{let e=r.array;a=r.version;for(let t=0,i=e.length/3-1;t<i;t+=3){let e=t+0,i=t+1,r=t+2;n.push(e,i,i,r,r,e)}}let o=new(hv(n)?ix:nx)(n,1);o.version=a;let l=s.get(e);l&&t.remove(l),s.set(e,o)}return{get:function(e,t){return!0===r[t.id]||(t.addEventListener("dispose",a),r[t.id]=!0,n.memory.geometries++),t},update:function(e){let n=e.attributes;for(let r in n)t.update(n[r],34962);let i=e.morphAttributes;for(let r in i){let e=i[r];for(let n=0,i=e.length;n<i;n++)t.update(e[n],34962)}},getWireframeAttribute:function(e){let t=s.get(e);if(t){let n=e.index;null!==n&&t.version<n.version&&o(e)}else o(e);return s.get(e)}}}function _b(e,t,n,i){let r,s,a,o=i.isWebGL2;this.setMode=function(e){r=e},this.setIndex=function(e){s=e.type,a=e.bytesPerElement},this.render=function(t,i){e.drawElements(r,i,s,t*a),n.update(i,r,1)},this.renderInstances=function(i,l,u){if(0===u)return;let c,h;if(o)c=e,h="drawElementsInstanced";else if(c=t.get("ANGLE_instanced_arrays"),h="drawElementsInstancedANGLE",null===c)return void console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");c[h](r,l,s,i*a,u),n.update(l,r,u)}}function Sb(e){let t={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:t,programs:null,autoReset:!0,reset:function(){t.frame++,t.calls=0,t.triangles=0,t.points=0,t.lines=0},update:function(e,n,i){switch(t.calls++,n){case 4:t.triangles+=i*(e/3);break;case 1:t.lines+=i*(e/2);break;case 3:t.lines+=i*(e-1);break;case 2:t.lines+=i*e;break;case 0:t.points+=i*e;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",n)}}}}function Eb(e,t){return e[0]-t[0]}function Cb(e,t){return Math.abs(t[1])-Math.abs(e[1])}function Ab(e,t,n){let i={},r=new Float32Array(8),s=new WeakMap,a=new Ov,o=[];for(let l=0;l<8;l++)o[l]=[l,0];return{update:function(l,u,c,h){let d=l.morphTargetInfluences;if(!0===t.isWebGL2){let i=u.morphAttributes.position||u.morphAttributes.normal||u.morphAttributes.color,r=void 0!==i?i.length:0,o=s.get(u);if(void 0===o||o.count!==r){let e=function(){v.dispose(),s.delete(u),u.removeEventListener("dispose",e)};void 0!==o&&o.texture.dispose();let n=void 0!==u.morphAttributes.position,i=void 0!==u.morphAttributes.normal,l=void 0!==u.morphAttributes.color,c=u.morphAttributes.position||[],h=u.morphAttributes.normal||[],d=u.morphAttributes.color||[],p=0;!0===n&&(p=1),!0===i&&(p=2),!0===l&&(p=3);let f=u.attributes.position.count*p,m=1;f>t.maxTextureSize&&(m=Math.ceil(f/t.maxTextureSize),f=t.maxTextureSize);let g=new Float32Array(f*m*4*r),v=new kv(g,f,m,r);v.type=vg,v.needsUpdate=!0;let y=4*p;for(let t=0;t<r;t++){let e=c[t],r=h[t],s=d[t],o=f*m*4*t;for(let t=0;t<e.count;t++){let u=t*y;!0===n&&(a.fromBufferAttribute(e,t),g[o+u+0]=a.x,g[o+u+1]=a.y,g[o+u+2]=a.z,g[o+u+3]=0),!0===i&&(a.fromBufferAttribute(r,t),g[o+u+4]=a.x,g[o+u+5]=a.y,g[o+u+6]=a.z,g[o+u+7]=0),!0===l&&(a.fromBufferAttribute(s,t),g[o+u+8]=a.x,g[o+u+9]=a.y,g[o+u+10]=a.z,g[o+u+11]=4===s.itemSize?a.w:1)}}o={count:r,texture:v,size:new lv(f,m)},s.set(u,o),u.addEventListener("dispose",e)}let l=0;for(let e=0;e<d.length;e++)l+=d[e];let c=u.morphTargetsRelative?1:1-l;h.getUniforms().setValue(e,"morphTargetBaseInfluence",c),h.getUniforms().setValue(e,"morphTargetInfluences",d),h.getUniforms().setValue(e,"morphTargetsTexture",o.texture,n),h.getUniforms().setValue(e,"morphTargetsTextureSize",o.size)}else{let t=void 0===d?0:d.length,n=i[u.id];if(void 0===n||n.length!==t){n=[];for(let e=0;e<t;e++)n[e]=[e,0];i[u.id]=n}for(let e=0;e<t;e++){let t=n[e];t[0]=e,t[1]=d[e]}n.sort(Cb);for(let e=0;e<8;e++)e<t&&n[e][1]?(o[e][0]=n[e][0],o[e][1]=n[e][1]):(o[e][0]=Number.MAX_SAFE_INTEGER,o[e][1]=0);o.sort(Eb);let s=u.morphAttributes.position,a=u.morphAttributes.normal,l=0;for(let e=0;e<8;e++){let t=o[e],n=t[0],i=t[1];n!==Number.MAX_SAFE_INTEGER&&i?(s&&u.getAttribute("morphTarget"+e)!==s[n]&&u.setAttribute("morphTarget"+e,s[n]),a&&u.getAttribute("morphNormal"+e)!==a[n]&&u.setAttribute("morphNormal"+e,a[n]),r[e]=i,l+=i):(s&&!0===u.hasAttribute("morphTarget"+e)&&u.deleteAttribute("morphTarget"+e),a&&!0===u.hasAttribute("morphNormal"+e)&&u.deleteAttribute("morphNormal"+e),r[e]=0)}let c=u.morphTargetsRelative?1:1-l;h.getUniforms().setValue(e,"morphTargetBaseInfluence",c),h.getUniforms().setValue(e,"morphTargetInfluences",r)}}}}function Mb(e,t,n,i){let r=new WeakMap;function s(e){let t=e.target;t.removeEventListener("dispose",s),n.remove(t.instanceMatrix),null!==t.instanceColor&&n.remove(t.instanceColor)}return{update:function(e){let a=i.render.frame,o=e.geometry,l=t.get(e,o);return r.get(l)!==a&&(t.update(l),r.set(l,a)),e.isInstancedMesh&&(!1===e.hasEventListener("dispose",s)&&e.addEventListener("dispose",s),n.update(e.instanceMatrix,34962),null!==e.instanceColor&&n.update(e.instanceColor,34962)),l},dispose:function(){r=new WeakMap}}}var Tb=new Fv,Pb=new kv,Fb=new class extends Fv{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;super(null),this.isData3DTexture=!0,this.image={data:e,width:t,height:n,depth:i},this.magFilter=ug,this.minFilter=ug,this.wrapR=og,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}},Ob=new zx,Ib=[],kb=[],Bb=new Float32Array(16),Rb=new Float32Array(9),Lb=new Float32Array(4);function zb(e,t,n){let i=e[0];if(null==i||i<=0||i>0)return e;let r=t*n,s=Ib[r];if(void 0===s&&(s=new Float32Array(r),Ib[r]=s),0!==t){i.toArray(s,0);for(let i=1,r=0;i!==t;++i)r+=n,e[i].toArray(s,r)}return s}function Nb(e,t){if(e.length!==t.length)return!1;for(let n=0,i=e.length;n<i;n++)if(e[n]!==t[n])return!1;return!0}function jb(e,t){for(let n=0,i=t.length;n<i;n++)e[n]=t[n]}function Ub(e,t){let n=kb[t];void 0===n&&(n=new Int32Array(t),kb[t]=n);for(let i=0;i!==t;++i)n[i]=e.allocateTextureUnit();return n}function Vb(e,t){let n=this.cache;n[0]!==t&&(e.uniform1f(this.addr,t),n[0]=t)}function Hb(e,t){let n=this.cache;if(void 0!==t.x)(n[0]!==t.x||n[1]!==t.y)&&(e.uniform2f(this.addr,t.x,t.y),n[0]=t.x,n[1]=t.y);else{if(Nb(n,t))return;e.uniform2fv(this.addr,t),jb(n,t)}}function Wb(e,t){let n=this.cache;if(void 0!==t.x)(n[0]!==t.x||n[1]!==t.y||n[2]!==t.z)&&(e.uniform3f(this.addr,t.x,t.y,t.z),n[0]=t.x,n[1]=t.y,n[2]=t.z);else if(void 0!==t.r)(n[0]!==t.r||n[1]!==t.g||n[2]!==t.b)&&(e.uniform3f(this.addr,t.r,t.g,t.b),n[0]=t.r,n[1]=t.g,n[2]=t.b);else{if(Nb(n,t))return;e.uniform3fv(this.addr,t),jb(n,t)}}function Gb(e,t){let n=this.cache;if(void 0!==t.x)(n[0]!==t.x||n[1]!==t.y||n[2]!==t.z||n[3]!==t.w)&&(e.uniform4f(this.addr,t.x,t.y,t.z,t.w),n[0]=t.x,n[1]=t.y,n[2]=t.z,n[3]=t.w);else{if(Nb(n,t))return;e.uniform4fv(this.addr,t),jb(n,t)}}function qb(e,t){let n=this.cache,i=t.elements;if(void 0===i){if(Nb(n,t))return;e.uniformMatrix2fv(this.addr,!1,t),jb(n,t)}else{if(Nb(n,i))return;Lb.set(i),e.uniformMatrix2fv(this.addr,!1,Lb),jb(n,i)}}function Yb(e,t){let n=this.cache,i=t.elements;if(void 0===i){if(Nb(n,t))return;e.uniformMatrix3fv(this.addr,!1,t),jb(n,t)}else{if(Nb(n,i))return;Rb.set(i),e.uniformMatrix3fv(this.addr,!1,Rb),jb(n,i)}}function Xb(e,t){let n=this.cache,i=t.elements;if(void 0===i){if(Nb(n,t))return;e.uniformMatrix4fv(this.addr,!1,t),jb(n,t)}else{if(Nb(n,i))return;Bb.set(i),e.uniformMatrix4fv(this.addr,!1,Bb),jb(n,i)}}function Qb(e,t){let n=this.cache;n[0]!==t&&(e.uniform1i(this.addr,t),n[0]=t)}function Kb(e,t){let n=this.cache;if(void 0!==t.x)(n[0]!==t.x||n[1]!==t.y)&&(e.uniform2i(this.addr,t.x,t.y),n[0]=t.x,n[1]=t.y);else{if(Nb(n,t))return;e.uniform2iv(this.addr,t),jb(n,t)}}function Zb(e,t){let n=this.cache;if(void 0!==t.x)(n[0]!==t.x||n[1]!==t.y||n[2]!==t.z)&&(e.uniform3i(this.addr,t.x,t.y,t.z),n[0]=t.x,n[1]=t.y,n[2]=t.z);else{if(Nb(n,t))return;e.uniform3iv(this.addr,t),jb(n,t)}}function Jb(e,t){let n=this.cache;if(void 0!==t.x)(n[0]!==t.x||n[1]!==t.y||n[2]!==t.z||n[3]!==t.w)&&(e.uniform4i(this.addr,t.x,t.y,t.z,t.w),n[0]=t.x,n[1]=t.y,n[2]=t.z,n[3]=t.w);else{if(Nb(n,t))return;e.uniform4iv(this.addr,t),jb(n,t)}}function $b(e,t){let n=this.cache;n[0]!==t&&(e.uniform1ui(this.addr,t),n[0]=t)}function ew(e,t){let n=this.cache;if(void 0!==t.x)(n[0]!==t.x||n[1]!==t.y)&&(e.uniform2ui(this.addr,t.x,t.y),n[0]=t.x,n[1]=t.y);else{if(Nb(n,t))return;e.uniform2uiv(this.addr,t),jb(n,t)}}function tw(e,t){let n=this.cache;if(void 0!==t.x)(n[0]!==t.x||n[1]!==t.y||n[2]!==t.z)&&(e.uniform3ui(this.addr,t.x,t.y,t.z),n[0]=t.x,n[1]=t.y,n[2]=t.z);else{if(Nb(n,t))return;e.uniform3uiv(this.addr,t),jb(n,t)}}function nw(e,t){let n=this.cache;if(void 0!==t.x)(n[0]!==t.x||n[1]!==t.y||n[2]!==t.z||n[3]!==t.w)&&(e.uniform4ui(this.addr,t.x,t.y,t.z,t.w),n[0]=t.x,n[1]=t.y,n[2]=t.z,n[3]=t.w);else{if(Nb(n,t))return;e.uniform4uiv(this.addr,t),jb(n,t)}}function iw(e,t,n){let i=this.cache,r=n.allocateTextureUnit();i[0]!==r&&(e.uniform1i(this.addr,r),i[0]=r),n.setTexture2D(t||Tb,r)}function rw(e,t,n){let i=this.cache,r=n.allocateTextureUnit();i[0]!==r&&(e.uniform1i(this.addr,r),i[0]=r),n.setTexture3D(t||Fb,r)}function sw(e,t,n){let i=this.cache,r=n.allocateTextureUnit();i[0]!==r&&(e.uniform1i(this.addr,r),i[0]=r),n.setTextureCube(t||Ob,r)}function aw(e,t,n){let i=this.cache,r=n.allocateTextureUnit();i[0]!==r&&(e.uniform1i(this.addr,r),i[0]=r),n.setTexture2DArray(t||Pb,r)}function ow(e,t){e.uniform1fv(this.addr,t)}function lw(e,t){let n=zb(t,this.size,2);e.uniform2fv(this.addr,n)}function uw(e,t){let n=zb(t,this.size,3);e.uniform3fv(this.addr,n)}function cw(e,t){let n=zb(t,this.size,4);e.uniform4fv(this.addr,n)}function hw(e,t){let n=zb(t,this.size,4);e.uniformMatrix2fv(this.addr,!1,n)}function dw(e,t){let n=zb(t,this.size,9);e.uniformMatrix3fv(this.addr,!1,n)}function pw(e,t){let n=zb(t,this.size,16);e.uniformMatrix4fv(this.addr,!1,n)}function fw(e,t){e.uniform1iv(this.addr,t)}function mw(e,t){e.uniform2iv(this.addr,t)}function gw(e,t){e.uniform3iv(this.addr,t)}function vw(e,t){e.uniform4iv(this.addr,t)}function yw(e,t){e.uniform1uiv(this.addr,t)}function xw(e,t){e.uniform2uiv(this.addr,t)}function bw(e,t){e.uniform3uiv(this.addr,t)}function ww(e,t){e.uniform4uiv(this.addr,t)}function Dw(e,t,n){let i=this.cache,r=t.length,s=Ub(n,r);Nb(i,s)||(e.uniform1iv(this.addr,s),jb(i,s));for(let a=0;a!==r;++a)n.setTexture2D(t[a]||Tb,s[a])}function _w(e,t,n){let i=this.cache,r=t.length,s=Ub(n,r);Nb(i,s)||(e.uniform1iv(this.addr,s),jb(i,s));for(let a=0;a!==r;++a)n.setTexture3D(t[a]||Fb,s[a])}function Sw(e,t,n){let i=this.cache,r=t.length,s=Ub(n,r);Nb(i,s)||(e.uniform1iv(this.addr,s),jb(i,s));for(let a=0;a!==r;++a)n.setTextureCube(t[a]||Ob,s[a])}function Ew(e,t,n){let i=this.cache,r=t.length,s=Ub(n,r);Nb(i,s)||(e.uniform1iv(this.addr,s),jb(i,s));for(let a=0;a!==r;++a)n.setTexture2DArray(t[a]||Pb,s[a])}var Cw=class{constructor(e,t,n){this.id=e,this.addr=n,this.cache=[],this.setValue=function(e){switch(e){case 5126:return Vb;case 35664:return Hb;case 35665:return Wb;case 35666:return Gb;case 35674:return qb;case 35675:return Yb;case 35676:return Xb;case 5124:case 35670:return Qb;case 35667:case 35671:return Kb;case 35668:case 35672:return Zb;case 35669:case 35673:return Jb;case 5125:return $b;case 36294:return ew;case 36295:return tw;case 36296:return nw;case 35678:case 36198:case 36298:case 36306:case 35682:return iw;case 35679:case 36299:case 36307:return rw;case 35680:case 36300:case 36308:case 36293:return sw;case 36289:case 36303:case 36311:case 36292:return aw}}(t.type)}},Aw=class{constructor(e,t,n){this.id=e,this.addr=n,this.cache=[],this.size=t.size,this.setValue=function(e){switch(e){case 5126:return ow;case 35664:return lw;case 35665:return uw;case 35666:return cw;case 35674:return hw;case 35675:return dw;case 35676:return pw;case 5124:case 35670:return fw;case 35667:case 35671:return mw;case 35668:case 35672:return gw;case 35669:case 35673:return vw;case 5125:return yw;case 36294:return xw;case 36295:return bw;case 36296:return ww;case 35678:case 36198:case 36298:case 36306:case 35682:return Dw;case 35679:case 36299:case 36307:return _w;case 35680:case 36300:case 36308:case 36293:return Sw;case 36289:case 36303:case 36311:case 36292:return Ew}}(t.type)}},Mw=class{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,t,n){if(void 0===t)return;let i=this.seq;for(let r=0,s=i.length;r!==s;++r){let s=i[r];s.setValue(e,t[s.id],n)}}},Tw=/(\w+)(\])?(\[|\.)?/g;function Pw(e,t){e.seq.push(t),e.map[t.id]=t}function Fw(e,t,n){let i=e.name,r=i.length;for(Tw.lastIndex=0;;){let s=Tw.exec(i),a=Tw.lastIndex,o=s[1],l="]"===s[2],u=s[3];if(l&&(o|=0),void 0===u||"["===u&&a+2===r){Pw(n,void 0===u?new Cw(o,e,t):new Aw(o,e,t));break}{let e=n.map[o];void 0===e&&(e=new Mw(o),Pw(n,e)),n=e}}}var Ow=class{constructor(e,t){this.seq=[],this.map={};let n=e.getProgramParameter(t,35718);for(let i=0;i<n;++i){let n=e.getActiveUniform(t,i);Fw(n,e.getUniformLocation(t,n.name),this)}}setValue(e,t,n,i){let r=this.map[t];void 0!==r&&r.setValue(e,n,i)}setOptional(e,t,n){let i=t[n];void 0!==i&&this.setValue(e,n,i)}static upload(e,t,n,i){for(let r=0,s=t.length;r!==s;++r){let s=t[r],a=n[s.id];!1!==a.needsUpdate&&s.setValue(e,a.value,i)}}static seqWithValue(e,t){let n=[];for(let i=0,r=e.length;i!==r;++i){let r=e[i];r.id in t&&n.push(r)}return n}};function Iw(e,t,n){let i=e.createShader(t);return e.shaderSource(i,n),e.compileShader(i),i}var kw=0;function Bw(e,t,n){let i=e.getShaderParameter(t,35713),r=e.getShaderInfoLog(t).trim();if(i&&""===r)return"";let s=/ERROR: 0:(\d+)/.exec(r);if(s){let i=parseInt(s[1]);return n.toUpperCase()+"\n\n"+r+"\n\n"+function(e,t){let n=e.split("\n"),i=[],r=Math.max(t-6,0),s=Math.min(t+6,n.length);for(let a=r;a<s;a++){let e=a+1;i.push("".concat(e===t?">":" "," ").concat(e,": ").concat(n[a]))}return i.join("\n")}(e.getShaderSource(t),i)}return r}function Rw(e,t){let n=function(e){switch(e){case zg:return["Linear","( value )"];case Ng:return["sRGB","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported encoding:",e),["Linear","( value )"]}}(t);return"vec4 "+e+"( vec4 value ) { return LinearTo"+n[0]+n[1]+"; }"}function Lw(e,t){let n;switch(t){case 1:n="Linear";break;case 2:n="Reinhard";break;case 3:n="OptimizedCineon";break;case 4:n="ACESFilmic";break;case 5:n="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",t),n="Linear"}return"vec3 "+e+"( vec3 color ) { return "+n+"ToneMapping( color ); }"}function zw(e){return""!==e}function Nw(e,t){let n=t.numSpotLightShadows+t.numSpotLightMaps-t.numSpotLightShadowsWithMaps;return e.replace(/NUM_DIR_LIGHTS/g,t.numDirLights).replace(/NUM_SPOT_LIGHTS/g,t.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,t.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,n).replace(/NUM_RECT_AREA_LIGHTS/g,t.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,t.numPointLights).replace(/NUM_HEMI_LIGHTS/g,t.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,t.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,t.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,t.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,t.numPointLightShadows)}function jw(e,t){return e.replace(/NUM_CLIPPING_PLANES/g,t.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,t.numClippingPlanes-t.numClipIntersection)}var Uw=/^[ \t]*#include +<([\w\d./]+)>/gm;function Vw(e){return e.replace(Uw,Hw)}function Hw(e,t){let n=Kx[t];if(void 0===n)throw new Error("Can not resolve #include <"+t+">");return Vw(n)}var Ww=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function Gw(e){return e.replace(Ww,qw)}function qw(e,t,n,i){let r="";for(let s=parseInt(t);s<parseInt(n);s++)r+=i.replace(/\[\s*i\s*\]/g,"[ "+s+" ]").replace(/UNROLLED_LOOP_INDEX/g,s);return r}function Yw(e){let t="precision "+e.precision+" float;\nprecision "+e.precision+" int;";return"highp"===e.precision?t+="\n#define HIGH_PRECISION":"mediump"===e.precision?t+="\n#define MEDIUM_PRECISION":"lowp"===e.precision&&(t+="\n#define LOW_PRECISION"),t}function Xw(e,t,n,i){let r,s,a=e.getContext(),o=n.defines,l=n.vertexShader,u=n.fragmentShader,c=function(e){let t="SHADOWMAP_TYPE_BASIC";return 1===e.shadowMapType?t="SHADOWMAP_TYPE_PCF":2===e.shadowMapType?t="SHADOWMAP_TYPE_PCF_SOFT":3===e.shadowMapType&&(t="SHADOWMAP_TYPE_VSM"),t}(n),h=function(e){let t="ENVMAP_TYPE_CUBE";if(e.envMap)switch(e.envMapMode){case ig:case rg:t="ENVMAP_TYPE_CUBE";break;case sg:t="ENVMAP_TYPE_CUBE_UV"}return t}(n),d=function(e){let t="ENVMAP_MODE_REFLECTION";e.envMap&&e.envMapMode===rg&&(t="ENVMAP_MODE_REFRACTION");return t}(n),p=function(e){let t="ENVMAP_BLENDING_NONE";if(e.envMap)switch(e.combine){case 0:t="ENVMAP_BLENDING_MULTIPLY";break;case 1:t="ENVMAP_BLENDING_MIX";break;case 2:t="ENVMAP_BLENDING_ADD"}return t}(n),f=function(e){let t=e.envMapCubeUVHeight;if(null===t)return null;let n=Math.log2(t)-2,i=1/t;return{texelWidth:1/(3*Math.max(Math.pow(2,n),112)),texelHeight:i,maxMip:n}}(n),m=n.isWebGL2?"":function(e){return[e.extensionDerivatives||e.envMapCubeUVHeight||e.bumpMap||e.tangentSpaceNormalMap||e.clearcoatNormalMap||e.flatShading||"physical"===e.shaderID?"#extension GL_OES_standard_derivatives : enable":"",(e.extensionFragDepth||e.logarithmicDepthBuffer)&&e.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",e.extensionDrawBuffers&&e.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(e.extensionShaderTextureLOD||e.envMap||e.transmission)&&e.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(zw).join("\n")}(n),g=function(e){let t=[];for(let n in e){let i=e[n];!1!==i&&t.push("#define "+n+" "+i)}return t.join("\n")}(o),v=a.createProgram(),y=n.glslVersion?"#version "+n.glslVersion+"\n":"";n.isRawShaderMaterial?(r=[g].filter(zw).join("\n"),r.length>0&&(r+="\n"),s=[m,g].filter(zw).join("\n"),s.length>0&&(s+="\n")):(r=[Yw(n),"#define SHADER_NAME "+n.shaderName,g,n.instancing?"#define USE_INSTANCING":"",n.instancingColor?"#define USE_INSTANCING_COLOR":"",n.supportsVertexTextures?"#define VERTEX_TEXTURES":"",n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+d:"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMap&&n.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",n.normalMap&&n.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",n.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",n.displacementMap&&n.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",n.specularColorMap?"#define USE_SPECULARCOLORMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.transmission?"#define USE_TRANSMISSION":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.thicknessMap?"#define USE_THICKNESSMAP":"",n.sheenColorMap?"#define USE_SHEENCOLORMAP":"",n.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",n.vertexTangents?"#define USE_TANGENT":"",n.vertexColors?"#define USE_COLOR":"",n.vertexAlphas?"#define USE_COLOR_ALPHA":"",n.vertexUvs?"#define USE_UV":"",n.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",n.flatShading?"#define FLAT_SHADED":"",n.skinning?"#define USE_SKINNING":"",n.morphTargets?"#define USE_MORPHTARGETS":"",n.morphNormals&&!1===n.flatShading?"#define USE_MORPHNORMALS":"",n.morphColors&&n.isWebGL2?"#define USE_MORPHCOLORS":"",n.morphTargetsCount>0&&n.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",n.morphTargetsCount>0&&n.isWebGL2?"#define MORPHTARGETS_TEXTURE_STRIDE "+n.morphTextureStride:"",n.morphTargetsCount>0&&n.isWebGL2?"#define MORPHTARGETS_COUNT "+n.morphTargetsCount:"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+c:"",n.sizeAttenuation?"#define USE_SIZEATTENUATION":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.logarithmicDepthBuffer&&n.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","\tattribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","\tattribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","\tattribute vec4 color;","#elif defined( USE_COLOR )","\tattribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(zw).join("\n"),s=[m,Yw(n),"#define SHADER_NAME "+n.shaderName,g,n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.matcap?"#define USE_MATCAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+h:"",n.envMap?"#define "+d:"",n.envMap?"#define "+p:"",f?"#define CUBEUV_TEXEL_WIDTH "+f.texelWidth:"",f?"#define CUBEUV_TEXEL_HEIGHT "+f.texelHeight:"",f?"#define CUBEUV_MAX_MIP "+f.maxMip+".0":"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMap&&n.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",n.normalMap&&n.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",n.clearcoat?"#define USE_CLEARCOAT":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.iridescence?"#define USE_IRIDESCENCE":"",n.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",n.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",n.specularColorMap?"#define USE_SPECULARCOLORMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.alphaTest?"#define USE_ALPHATEST":"",n.sheen?"#define USE_SHEEN":"",n.sheenColorMap?"#define USE_SHEENCOLORMAP":"",n.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",n.transmission?"#define USE_TRANSMISSION":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.thicknessMap?"#define USE_THICKNESSMAP":"",n.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",n.vertexTangents?"#define USE_TANGENT":"",n.vertexColors||n.instancingColor?"#define USE_COLOR":"",n.vertexAlphas?"#define USE_COLOR_ALPHA":"",n.vertexUvs?"#define USE_UV":"",n.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",n.gradientMap?"#define USE_GRADIENTMAP":"",n.flatShading?"#define FLAT_SHADED":"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+c:"",n.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",n.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.logarithmicDepthBuffer&&n.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",0!==n.toneMapping?"#define TONE_MAPPING":"",0!==n.toneMapping?Kx.tonemapping_pars_fragment:"",0!==n.toneMapping?Lw("toneMapping",n.toneMapping):"",n.dithering?"#define DITHERING":"",n.opaque?"#define OPAQUE":"",Kx.encodings_pars_fragment,Rw("linearToOutputTexel",n.outputEncoding),n.useDepthPacking?"#define DEPTH_PACKING "+n.depthPacking:"","\n"].filter(zw).join("\n")),l=Vw(l),l=Nw(l,n),l=jw(l,n),u=Vw(u),u=Nw(u,n),u=jw(u,n),l=Gw(l),u=Gw(u),n.isWebGL2&&!0!==n.isRawShaderMaterial&&(y="#version 300 es\n",r=["precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n"+r,s=["#define varying in",n.glslVersion===Gg?"":"layout(location = 0) out highp vec4 pc_fragColor;",n.glslVersion===Gg?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+s);let x,b,w=y+s+u,D=Iw(a,35633,y+r+l),_=Iw(a,35632,w);if(a.attachShader(v,D),a.attachShader(v,_),void 0!==n.index0AttributeName?a.bindAttribLocation(v,0,n.index0AttributeName):!0===n.morphTargets&&a.bindAttribLocation(v,0,"position"),a.linkProgram(v),e.debug.checkShaderErrors){let e=a.getProgramInfoLog(v).trim(),t=a.getShaderInfoLog(D).trim(),n=a.getShaderInfoLog(_).trim(),i=!0,o=!0;if(!1===a.getProgramParameter(v,35714)){i=!1;let t=Bw(a,D,"vertex"),n=Bw(a,_,"fragment");console.error("THREE.WebGLProgram: Shader Error "+a.getError()+" - VALIDATE_STATUS "+a.getProgramParameter(v,35715)+"\n\nProgram Info Log: "+e+"\n"+t+"\n"+n)}else""!==e?console.warn("THREE.WebGLProgram: Program Info Log:",e):(""===t||""===n)&&(o=!1);o&&(this.diagnostics={runnable:i,programLog:e,vertexShader:{log:t,prefix:r},fragmentShader:{log:n,prefix:s}})}return a.deleteShader(D),a.deleteShader(_),this.getUniforms=function(){return void 0===x&&(x=new Ow(a,v)),x},this.getAttributes=function(){return void 0===b&&(b=function(e,t){let n={},i=e.getProgramParameter(t,35721);for(let r=0;r<i;r++){let i=e.getActiveAttrib(t,r),s=i.name,a=1;35674===i.type&&(a=2),35675===i.type&&(a=3),35676===i.type&&(a=4),n[s]={type:i.type,location:e.getAttribLocation(t,s),locationSize:a}}return n}(a,v)),b},this.destroy=function(){i.releaseStatesOfProgram(this),a.deleteProgram(v),this.program=void 0},this.name=n.shaderName,this.id=kw++,this.cacheKey=t,this.usedTimes=1,this.program=v,this.vertexShader=D,this.fragmentShader=_,this}var Qw=0,Kw=class{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){let t=e.vertexShader,n=e.fragmentShader,i=this._getShaderStage(t),r=this._getShaderStage(n),s=this._getShaderCacheForMaterial(e);return!1===s.has(i)&&(s.add(i),i.usedTimes++),!1===s.has(r)&&(s.add(r),r.usedTimes++),this}remove(e){let t=this.materialCache.get(e);for(let n of t)n.usedTimes--,0===n.usedTimes&&this.shaderCache.delete(n.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){let t=this.materialCache,n=t.get(e);return void 0===n&&(n=new Set,t.set(e,n)),n}_getShaderStage(e){let t=this.shaderCache,n=t.get(e);return void 0===n&&(n=new Zw(e),t.set(e,n)),n}},Zw=class{constructor(e){this.id=Qw++,this.code=e,this.usedTimes=0}};function Jw(e,t,n,i,r,s,a){let o=new Sy,l=new Kw,u=[],c=r.isWebGL2,h=r.logarithmicDepthBuffer,d=r.vertexTextures,p=r.precision,f={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};return{getParameters:function(s,o,u,m,g){let v=m.fog,y=g.geometry,x=s.isMeshStandardMaterial?m.environment:null,b=(s.isMeshStandardMaterial?n:t).get(s.envMap||x),w=b&&b.mapping===sg?b.image.height:null,D=f[s.type];null!==s.precision&&(p=r.getMaxPrecision(s.precision),p!==s.precision&&console.warn("THREE.WebGLProgram.getParameters:",s.precision,"not supported, using",p,"instead."));let _,S,E,C,A=y.morphAttributes.position||y.morphAttributes.normal||y.morphAttributes.color,M=void 0!==A?A.length:0,T=0;if(void 0!==y.morphAttributes.position&&(T=1),void 0!==y.morphAttributes.normal&&(T=2),void 0!==y.morphAttributes.color&&(T=3),D){let e=Jx[D];_=e.vertexShader,S=e.fragmentShader}else _=s.vertexShader,S=s.fragmentShader,l.update(s),E=l.getVertexShaderID(s),C=l.getFragmentShaderID(s);let P=e.getRenderTarget(),F=s.alphaTest>0,O=s.clearcoat>0,I=s.iridescence>0;return{isWebGL2:c,shaderID:D,shaderName:s.type,vertexShader:_,fragmentShader:S,defines:s.defines,customVertexShaderID:E,customFragmentShaderID:C,isRawShaderMaterial:!0===s.isRawShaderMaterial,glslVersion:s.glslVersion,precision:p,instancing:!0===g.isInstancedMesh,instancingColor:!0===g.isInstancedMesh&&null!==g.instanceColor,supportsVertexTextures:d,outputEncoding:null===P?e.outputEncoding:!0===P.isXRRenderTarget?P.texture.encoding:zg,map:!!s.map,matcap:!!s.matcap,envMap:!!b,envMapMode:b&&b.mapping,envMapCubeUVHeight:w,lightMap:!!s.lightMap,aoMap:!!s.aoMap,emissiveMap:!!s.emissiveMap,bumpMap:!!s.bumpMap,normalMap:!!s.normalMap,objectSpaceNormalMap:1===s.normalMapType,tangentSpaceNormalMap:0===s.normalMapType,decodeVideoTexture:!!s.map&&!0===s.map.isVideoTexture&&s.map.encoding===Ng,clearcoat:O,clearcoatMap:O&&!!s.clearcoatMap,clearcoatRoughnessMap:O&&!!s.clearcoatRoughnessMap,clearcoatNormalMap:O&&!!s.clearcoatNormalMap,iridescence:I,iridescenceMap:I&&!!s.iridescenceMap,iridescenceThicknessMap:I&&!!s.iridescenceThicknessMap,displacementMap:!!s.displacementMap,roughnessMap:!!s.roughnessMap,metalnessMap:!!s.metalnessMap,specularMap:!!s.specularMap,specularIntensityMap:!!s.specularIntensityMap,specularColorMap:!!s.specularColorMap,opaque:!1===s.transparent&&1===s.blending,alphaMap:!!s.alphaMap,alphaTest:F,gradientMap:!!s.gradientMap,sheen:s.sheen>0,sheenColorMap:!!s.sheenColorMap,sheenRoughnessMap:!!s.sheenRoughnessMap,transmission:s.transmission>0,transmissionMap:!!s.transmissionMap,thicknessMap:!!s.thicknessMap,combine:s.combine,vertexTangents:!!s.normalMap&&!!y.attributes.tangent,vertexColors:s.vertexColors,vertexAlphas:!0===s.vertexColors&&!!y.attributes.color&&4===y.attributes.color.itemSize,vertexUvs:!!s.map||!!s.bumpMap||!!s.normalMap||!!s.specularMap||!!s.alphaMap||!!s.emissiveMap||!!s.roughnessMap||!!s.metalnessMap||!!s.clearcoatMap||!!s.clearcoatRoughnessMap||!!s.clearcoatNormalMap||!!s.iridescenceMap||!!s.iridescenceThicknessMap||!!s.displacementMap||!!s.transmissionMap||!!s.thicknessMap||!!s.specularIntensityMap||!!s.specularColorMap||!!s.sheenColorMap||!!s.sheenRoughnessMap,uvsVertexOnly:!(s.map||s.bumpMap||s.normalMap||s.specularMap||s.alphaMap||s.emissiveMap||s.roughnessMap||s.metalnessMap||s.clearcoatNormalMap||s.iridescenceMap||s.iridescenceThicknessMap||s.transmission>0||s.transmissionMap||s.thicknessMap||s.specularIntensityMap||s.specularColorMap||s.sheen>0||s.sheenColorMap||s.sheenRoughnessMap)&&!!s.displacementMap,fog:!!v,useFog:!0===s.fog,fogExp2:v&&v.isFogExp2,flatShading:!!s.flatShading,sizeAttenuation:s.sizeAttenuation,logarithmicDepthBuffer:h,skinning:!0===g.isSkinnedMesh,morphTargets:void 0!==y.morphAttributes.position,morphNormals:void 0!==y.morphAttributes.normal,morphColors:void 0!==y.morphAttributes.color,morphTargetsCount:M,morphTextureStride:T,numDirLights:o.directional.length,numPointLights:o.point.length,numSpotLights:o.spot.length,numSpotLightMaps:o.spotLightMap.length,numRectAreaLights:o.rectArea.length,numHemiLights:o.hemi.length,numDirLightShadows:o.directionalShadowMap.length,numPointLightShadows:o.pointShadowMap.length,numSpotLightShadows:o.spotShadowMap.length,numSpotLightShadowsWithMaps:o.numSpotLightShadowsWithMaps,numClippingPlanes:a.numPlanes,numClipIntersection:a.numIntersection,dithering:s.dithering,shadowMapEnabled:e.shadowMap.enabled&&u.length>0,shadowMapType:e.shadowMap.type,toneMapping:s.toneMapped?e.toneMapping:0,physicallyCorrectLights:e.physicallyCorrectLights,premultipliedAlpha:s.premultipliedAlpha,doubleSided:2===s.side,flipSided:1===s.side,useDepthPacking:!!s.depthPacking,depthPacking:s.depthPacking||0,index0AttributeName:s.index0AttributeName,extensionDerivatives:s.extensions&&s.extensions.derivatives,extensionFragDepth:s.extensions&&s.extensions.fragDepth,extensionDrawBuffers:s.extensions&&s.extensions.drawBuffers,extensionShaderTextureLOD:s.extensions&&s.extensions.shaderTextureLOD,rendererExtensionFragDepth:c||i.has("EXT_frag_depth"),rendererExtensionDrawBuffers:c||i.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:c||i.has("EXT_shader_texture_lod"),customProgramCacheKey:s.customProgramCacheKey()}},getProgramCacheKey:function(t){let n=[];if(t.shaderID?n.push(t.shaderID):(n.push(t.customVertexShaderID),n.push(t.customFragmentShaderID)),void 0!==t.defines)for(let e in t.defines)n.push(e),n.push(t.defines[e]);return!1===t.isRawShaderMaterial&&(function(e,t){e.push(t.precision),e.push(t.outputEncoding),e.push(t.envMapMode),e.push(t.envMapCubeUVHeight),e.push(t.combine),e.push(t.vertexUvs),e.push(t.fogExp2),e.push(t.sizeAttenuation),e.push(t.morphTargetsCount),e.push(t.morphAttributeCount),e.push(t.numDirLights),e.push(t.numPointLights),e.push(t.numSpotLights),e.push(t.numSpotLightMaps),e.push(t.numHemiLights),e.push(t.numRectAreaLights),e.push(t.numDirLightShadows),e.push(t.numPointLightShadows),e.push(t.numSpotLightShadows),e.push(t.numSpotLightShadowsWithMaps),e.push(t.shadowMapType),e.push(t.toneMapping),e.push(t.numClippingPlanes),e.push(t.numClipIntersection),e.push(t.depthPacking)}(n,t),function(e,t){o.disableAll(),t.isWebGL2&&o.enable(0),t.supportsVertexTextures&&o.enable(1),t.instancing&&o.enable(2),t.instancingColor&&o.enable(3),t.map&&o.enable(4),t.matcap&&o.enable(5),t.envMap&&o.enable(6),t.lightMap&&o.enable(7),t.aoMap&&o.enable(8),t.emissiveMap&&o.enable(9),t.bumpMap&&o.enable(10),t.normalMap&&o.enable(11),t.objectSpaceNormalMap&&o.enable(12),t.tangentSpaceNormalMap&&o.enable(13),t.clearcoat&&o.enable(14),t.clearcoatMap&&o.enable(15),t.clearcoatRoughnessMap&&o.enable(16),t.clearcoatNormalMap&&o.enable(17),t.iridescence&&o.enable(18),t.iridescenceMap&&o.enable(19),t.iridescenceThicknessMap&&o.enable(20),t.displacementMap&&o.enable(21),t.specularMap&&o.enable(22),t.roughnessMap&&o.enable(23),t.metalnessMap&&o.enable(24),t.gradientMap&&o.enable(25),t.alphaMap&&o.enable(26),t.alphaTest&&o.enable(27),t.vertexColors&&o.enable(28),t.vertexAlphas&&o.enable(29),t.vertexUvs&&o.enable(30),t.vertexTangents&&o.enable(31),t.uvsVertexOnly&&o.enable(32),e.push(o.mask),o.disableAll(),t.fog&&o.enable(0),t.useFog&&o.enable(1),t.flatShading&&o.enable(2),t.logarithmicDepthBuffer&&o.enable(3),t.skinning&&o.enable(4),t.morphTargets&&o.enable(5),t.morphNormals&&o.enable(6),t.morphColors&&o.enable(7),t.premultipliedAlpha&&o.enable(8),t.shadowMapEnabled&&o.enable(9),t.physicallyCorrectLights&&o.enable(10),t.doubleSided&&o.enable(11),t.flipSided&&o.enable(12),t.useDepthPacking&&o.enable(13),t.dithering&&o.enable(14),t.specularIntensityMap&&o.enable(15),t.specularColorMap&&o.enable(16),t.transmission&&o.enable(17),t.transmissionMap&&o.enable(18),t.thicknessMap&&o.enable(19),t.sheen&&o.enable(20),t.sheenColorMap&&o.enable(21),t.sheenRoughnessMap&&o.enable(22),t.decodeVideoTexture&&o.enable(23),t.opaque&&o.enable(24),e.push(o.mask)}(n,t),n.push(e.outputEncoding)),n.push(t.customProgramCacheKey),n.join()},getUniforms:function(e){let t,n=f[e.type];if(n){let e=Jx[n];t=Ox.clone(e.uniforms)}else t=e.uniforms;return t},acquireProgram:function(t,n){let i;for(let e=0,r=u.length;e<r;e++){let t=u[e];if(t.cacheKey===n){i=t,++i.usedTimes;break}}return void 0===i&&(i=new Xw(e,n,t,s),u.push(i)),i},releaseProgram:function(e){if(0===--e.usedTimes){let t=u.indexOf(e);u[t]=u[u.length-1],u.pop(),e.destroy()}},releaseShaderCache:function(e){l.remove(e)},programs:u,dispose:function(){l.dispose()}}}function $w(){let e=new WeakMap;return{get:function(t){let n=e.get(t);return void 0===n&&(n={},e.set(t,n)),n},remove:function(t){e.delete(t)},update:function(t,n,i){e.get(t)[n]=i},dispose:function(){e=new WeakMap}}}function eD(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.material.id!==t.material.id?e.material.id-t.material.id:e.z!==t.z?e.z-t.z:e.id-t.id}function tD(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.z!==t.z?t.z-e.z:e.id-t.id}function nD(){let e=[],t=0,n=[],i=[],r=[];function s(n,i,r,s,a,o){let l=e[t];return void 0===l?(l={id:n.id,object:n,geometry:i,material:r,groupOrder:s,renderOrder:n.renderOrder,z:a,group:o},e[t]=l):(l.id=n.id,l.object=n,l.geometry=i,l.material=r,l.groupOrder=s,l.renderOrder=n.renderOrder,l.z=a,l.group=o),t++,l}return{opaque:n,transmissive:i,transparent:r,init:function(){t=0,n.length=0,i.length=0,r.length=0},push:function(e,t,a,o,l,u){let c=s(e,t,a,o,l,u);a.transmission>0?i.push(c):!0===a.transparent?r.push(c):n.push(c)},unshift:function(e,t,a,o,l,u){let c=s(e,t,a,o,l,u);a.transmission>0?i.unshift(c):!0===a.transparent?r.unshift(c):n.unshift(c)},finish:function(){for(let n=t,i=e.length;n<i;n++){let t=e[n];if(null===t.id)break;t.id=null,t.object=null,t.geometry=null,t.material=null,t.group=null}},sort:function(e,t){n.length>1&&n.sort(e||eD),i.length>1&&i.sort(t||tD),r.length>1&&r.sort(t||tD)}}}function iD(){let e=new WeakMap;return{get:function(t,n){let i,r=e.get(t);return void 0===r?(i=new nD,e.set(t,[i])):n>=r.length?(i=new nD,r.push(i)):i=r[n],i},dispose:function(){e=new WeakMap}}}function rD(){let e={};return{get:function(t){if(void 0!==e[t.id])return e[t.id];let n;switch(t.type){case"DirectionalLight":n={direction:new Lv,color:new Ev};break;case"SpotLight":n={position:new Lv,direction:new Lv,color:new Ev,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":n={position:new Lv,color:new Ev,distance:0,decay:0};break;case"HemisphereLight":n={direction:new Lv,skyColor:new Ev,groundColor:new Ev};break;case"RectAreaLight":n={color:new Ev,position:new Lv,halfWidth:new Lv,halfHeight:new Lv}}return e[t.id]=n,n}}}var sD=0;function aD(e,t){return(t.castShadow?2:0)-(e.castShadow?2:0)+(t.map?1:0)-(e.map?1:0)}function oD(e,t){let n=new rD,i=function(){let e={};return{get:function(t){if(void 0!==e[t.id])return e[t.id];let n;switch(t.type){case"DirectionalLight":case"SpotLight":n={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new lv};break;case"PointLight":n={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new lv,shadowCameraNear:1,shadowCameraFar:1e3}}return e[t.id]=n,n}}}(),r={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0};for(let l=0;l<9;l++)r.probe.push(new Lv);let s=new Lv,a=new py,o=new py;return{setup:function(s,a){let o=0,l=0,u=0;for(let e=0;e<9;e++)r.probe[e].set(0,0,0);let c=0,h=0,d=0,p=0,f=0,m=0,g=0,v=0,y=0,x=0;s.sort(aD);let b=!0!==a?Math.PI:1;for(let e=0,t=s.length;e<t;e++){let t=s[e],a=t.color,w=t.intensity,D=t.distance,_=t.shadow&&t.shadow.map?t.shadow.map.texture:null;if(t.isAmbientLight)o+=a.r*w*b,l+=a.g*w*b,u+=a.b*w*b;else if(t.isLightProbe)for(let e=0;e<9;e++)r.probe[e].addScaledVector(t.sh.coefficients[e],w);else if(t.isDirectionalLight){let e=n.get(t);if(e.color.copy(t.color).multiplyScalar(t.intensity*b),t.castShadow){let e=t.shadow,n=i.get(t);n.shadowBias=e.bias,n.shadowNormalBias=e.normalBias,n.shadowRadius=e.radius,n.shadowMapSize=e.mapSize,r.directionalShadow[c]=n,r.directionalShadowMap[c]=_,r.directionalShadowMatrix[c]=t.shadow.matrix,m++}r.directional[c]=e,c++}else if(t.isSpotLight){let e=n.get(t);e.position.setFromMatrixPosition(t.matrixWorld),e.color.copy(a).multiplyScalar(w*b),e.distance=D,e.coneCos=Math.cos(t.angle),e.penumbraCos=Math.cos(t.angle*(1-t.penumbra)),e.decay=t.decay,r.spot[d]=e;let s=t.shadow;if(t.map&&(r.spotLightMap[y]=t.map,y++,s.updateMatrices(t),t.castShadow&&x++),r.spotLightMatrix[d]=s.matrix,t.castShadow){let e=i.get(t);e.shadowBias=s.bias,e.shadowNormalBias=s.normalBias,e.shadowRadius=s.radius,e.shadowMapSize=s.mapSize,r.spotShadow[d]=e,r.spotShadowMap[d]=_,v++}d++}else if(t.isRectAreaLight){let e=n.get(t);e.color.copy(a).multiplyScalar(w),e.halfWidth.set(.5*t.width,0,0),e.halfHeight.set(0,.5*t.height,0),r.rectArea[p]=e,p++}else if(t.isPointLight){let e=n.get(t);if(e.color.copy(t.color).multiplyScalar(t.intensity*b),e.distance=t.distance,e.decay=t.decay,t.castShadow){let e=t.shadow,n=i.get(t);n.shadowBias=e.bias,n.shadowNormalBias=e.normalBias,n.shadowRadius=e.radius,n.shadowMapSize=e.mapSize,n.shadowCameraNear=e.camera.near,n.shadowCameraFar=e.camera.far,r.pointShadow[h]=n,r.pointShadowMap[h]=_,r.pointShadowMatrix[h]=t.shadow.matrix,g++}r.point[h]=e,h++}else if(t.isHemisphereLight){let e=n.get(t);e.skyColor.copy(t.color).multiplyScalar(w*b),e.groundColor.copy(t.groundColor).multiplyScalar(w*b),r.hemi[f]=e,f++}}p>0&&(t.isWebGL2||!0===e.has("OES_texture_float_linear")?(r.rectAreaLTC1=Zx.LTC_FLOAT_1,r.rectAreaLTC2=Zx.LTC_FLOAT_2):!0===e.has("OES_texture_half_float_linear")?(r.rectAreaLTC1=Zx.LTC_HALF_1,r.rectAreaLTC2=Zx.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),r.ambient[0]=o,r.ambient[1]=l,r.ambient[2]=u;let w=r.hash;(w.directionalLength!==c||w.pointLength!==h||w.spotLength!==d||w.rectAreaLength!==p||w.hemiLength!==f||w.numDirectionalShadows!==m||w.numPointShadows!==g||w.numSpotShadows!==v||w.numSpotMaps!==y)&&(r.directional.length=c,r.spot.length=d,r.rectArea.length=p,r.point.length=h,r.hemi.length=f,r.directionalShadow.length=m,r.directionalShadowMap.length=m,r.pointShadow.length=g,r.pointShadowMap.length=g,r.spotShadow.length=v,r.spotShadowMap.length=v,r.directionalShadowMatrix.length=m,r.pointShadowMatrix.length=g,r.spotLightMatrix.length=v+y-x,r.spotLightMap.length=y,r.numSpotLightShadowsWithMaps=x,w.directionalLength=c,w.pointLength=h,w.spotLength=d,w.rectAreaLength=p,w.hemiLength=f,w.numDirectionalShadows=m,w.numPointShadows=g,w.numSpotShadows=v,w.numSpotMaps=y,r.version=sD++)},setupView:function(e,t){let n=0,i=0,l=0,u=0,c=0,h=t.matrixWorldInverse;for(let d=0,p=e.length;d<p;d++){let t=e[d];if(t.isDirectionalLight){let e=r.directional[n];e.direction.setFromMatrixPosition(t.matrixWorld),s.setFromMatrixPosition(t.target.matrixWorld),e.direction.sub(s),e.direction.transformDirection(h),n++}else if(t.isSpotLight){let e=r.spot[l];e.position.setFromMatrixPosition(t.matrixWorld),e.position.applyMatrix4(h),e.direction.setFromMatrixPosition(t.matrixWorld),s.setFromMatrixPosition(t.target.matrixWorld),e.direction.sub(s),e.direction.transformDirection(h),l++}else if(t.isRectAreaLight){let e=r.rectArea[u];e.position.setFromMatrixPosition(t.matrixWorld),e.position.applyMatrix4(h),o.identity(),a.copy(t.matrixWorld),a.premultiply(h),o.extractRotation(a),e.halfWidth.set(.5*t.width,0,0),e.halfHeight.set(0,.5*t.height,0),e.halfWidth.applyMatrix4(o),e.halfHeight.applyMatrix4(o),u++}else if(t.isPointLight){let e=r.point[i];e.position.setFromMatrixPosition(t.matrixWorld),e.position.applyMatrix4(h),i++}else if(t.isHemisphereLight){let e=r.hemi[c];e.direction.setFromMatrixPosition(t.matrixWorld),e.direction.transformDirection(h),c++}}},state:r}}function lD(e,t){let n=new oD(e,t),i=[],r=[];return{init:function(){i.length=0,r.length=0},state:{lightsArray:i,shadowsArray:r,lights:n},setupLights:function(e){n.setup(i,e)},setupLightsView:function(e){n.setupView(i,e)},pushLight:function(e){i.push(e)},pushShadow:function(e){r.push(e)}}}function uD(e,t){let n=new WeakMap;return{get:function(i){let r,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=n.get(i);return void 0===a?(r=new lD(e,t),n.set(i,[r])):s>=a.length?(r=new lD(e,t),a.push(r)):r=a[s],r},dispose:function(){n=new WeakMap}}}var cD=class extends Zy{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=jg,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}},hD=class extends Zy{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.referencePosition=new Lv,this.nearDistance=1,this.farDistance=1e3,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.referencePosition.copy(e.referencePosition),this.nearDistance=e.nearDistance,this.farDistance=e.farDistance,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}};function dD(e,t,n){let i=new qx,r=new lv,s=new lv,a=new Ov,o=new cD({depthPacking:3201}),l=new hD,u={},c=n.maxTextureSize,h={[jm]:1,[Um]:0,[Vm]:2},d=new Ix({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new lv},radius:{value:4}},vertexShader:"void main() {\n\tgl_Position = vec4( position, 1.0 );\n}",fragmentShader:"uniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\n#include <packing>\nvoid main() {\n\tconst float samples = float( VSM_SAMPLES );\n\tfloat mean = 0.0;\n\tfloat squared_mean = 0.0;\n\tfloat uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );\n\tfloat uvStart = samples <= 1.0 ? 0.0 : - 1.0;\n\tfor ( float i = 0.0; i < samples; i ++ ) {\n\t\tfloat uvOffset = uvStart + i * uvStride;\n\t\t#ifdef HORIZONTAL_PASS\n\t\t\tvec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );\n\t\t\tmean += distribution.x;\n\t\t\tsquared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\n\t\t#else\n\t\t\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );\n\t\t\tmean += depth;\n\t\t\tsquared_mean += depth * depth;\n\t\t#endif\n\t}\n\tmean = mean / samples;\n\tsquared_mean = squared_mean / samples;\n\tfloat std_dev = sqrt( squared_mean - mean * mean );\n\tgl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );\n}"}),p=d.clone();p.defines.HORIZONTAL_PASS=1;let f=new dx;f.setAttribute("position",new tx(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));let m=new Cx(f,d),g=this;function v(n,i){let s=t.update(m);d.defines.VSM_SAMPLES!==n.blurSamples&&(d.defines.VSM_SAMPLES=n.blurSamples,p.defines.VSM_SAMPLES=n.blurSamples,d.needsUpdate=!0,p.needsUpdate=!0),null===n.mapPass&&(n.mapPass=new Iv(r.x,r.y)),d.uniforms.shadow_pass.value=n.map.texture,d.uniforms.resolution.value=n.mapSize,d.uniforms.radius.value=n.radius,e.setRenderTarget(n.mapPass),e.clear(),e.renderBufferDirect(i,null,s,d,m,null),p.uniforms.shadow_pass.value=n.mapPass.texture,p.uniforms.resolution.value=n.mapSize,p.uniforms.radius.value=n.radius,e.setRenderTarget(n.map),e.clear(),e.renderBufferDirect(i,null,s,p,m,null)}function y(t,n,i,r,s,a){let c=null,d=!0===i.isPointLight?t.customDistanceMaterial:t.customDepthMaterial;if(void 0!==d)c=d;else if(c=!0===i.isPointLight?l:o,e.localClippingEnabled&&!0===n.clipShadows&&Array.isArray(n.clippingPlanes)&&0!==n.clippingPlanes.length||n.displacementMap&&0!==n.displacementScale||n.alphaMap&&n.alphaTest>0||n.map&&n.alphaTest>0){let e=c.uuid,t=n.uuid,i=u[e];void 0===i&&(i={},u[e]=i);let r=i[t];void 0===r&&(r=c.clone(),i[t]=r),c=r}return c.visible=n.visible,c.wireframe=n.wireframe,c.side=3===a?null!==n.shadowSide?n.shadowSide:n.side:null!==n.shadowSide?n.shadowSide:h[n.side],c.alphaMap=n.alphaMap,c.alphaTest=n.alphaTest,c.map=n.map,c.clipShadows=n.clipShadows,c.clippingPlanes=n.clippingPlanes,c.clipIntersection=n.clipIntersection,c.displacementMap=n.displacementMap,c.displacementScale=n.displacementScale,c.displacementBias=n.displacementBias,c.wireframeLinewidth=n.wireframeLinewidth,c.linewidth=n.linewidth,!0===i.isPointLight&&!0===c.isMeshDistanceMaterial&&(c.referencePosition.setFromMatrixPosition(i.matrixWorld),c.nearDistance=r,c.farDistance=s),c}function x(n,r,s,a,o){if(!1===n.visible)return;if(n.layers.test(r.layers)&&(n.isMesh||n.isLine||n.isPoints)&&(n.castShadow||n.receiveShadow&&3===o)&&(!n.frustumCulled||i.intersectsObject(n))){n.modelViewMatrix.multiplyMatrices(s.matrixWorldInverse,n.matrixWorld);let i=t.update(n),r=n.material;if(Array.isArray(r)){let t=i.groups;for(let l=0,u=t.length;l<u;l++){let u=t[l],c=r[u.materialIndex];if(c&&c.visible){let t=y(n,c,a,s.near,s.far,o);e.renderBufferDirect(s,null,i,t,n,u)}}}else if(r.visible){let t=y(n,r,a,s.near,s.far,o);e.renderBufferDirect(s,null,i,t,n,null)}}let l=n.children;for(let e=0,t=l.length;e<t;e++)x(l[e],r,s,a,o)}this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=1,this.render=function(t,n,o){if(!1===g.enabled||!1===g.autoUpdate&&!1===g.needsUpdate||0===t.length)return;let l=e.getRenderTarget(),u=e.getActiveCubeFace(),h=e.getActiveMipmapLevel(),d=e.state;d.setBlending(0),d.buffers.color.setClear(1,1,1,1),d.buffers.depth.setTest(!0),d.setScissorTest(!1);for(let p=0,f=t.length;p<f;p++){let l=t[p],u=l.shadow;if(void 0===u){console.warn("THREE.WebGLShadowMap:",l,"has no shadow.");continue}if(!1===u.autoUpdate&&!1===u.needsUpdate)continue;r.copy(u.mapSize);let h=u.getFrameExtents();if(r.multiply(h),s.copy(u.mapSize),(r.x>c||r.y>c)&&(r.x>c&&(s.x=Math.floor(c/h.x),r.x=s.x*h.x,u.mapSize.x=s.x),r.y>c&&(s.y=Math.floor(c/h.y),r.y=s.y*h.y,u.mapSize.y=s.y)),null===u.map){let e=3!==this.type?{minFilter:ug,magFilter:ug}:{};u.map=new Iv(r.x,r.y,e),u.map.texture.name=l.name+".shadowMap",u.camera.updateProjectionMatrix()}e.setRenderTarget(u.map),e.clear();let f=u.getViewportCount();for(let e=0;e<f;e++){let t=u.getViewport(e);a.set(s.x*t.x,s.y*t.y,s.x*t.z,s.y*t.w),d.viewport(a),u.updateMatrices(l,e),i=u.getFrustum(),x(n,o,u.camera,l,this.type)}!0!==u.isPointLightShadow&&3===this.type&&v(u,o),u.needsUpdate=!1}g.needsUpdate=!1,e.setRenderTarget(l,u,h)}}function pD(e,t,n){let i=n.isWebGL2;let r=new function(){let t=!1,n=new Ov,i=null,r=new Ov(0,0,0,0);return{setMask:function(n){i!==n&&!t&&(e.colorMask(n,n,n,n),i=n)},setLocked:function(e){t=e},setClear:function(t,i,s,a,o){!0===o&&(t*=a,i*=a,s*=a),n.set(t,i,s,a),!1===r.equals(n)&&(e.clearColor(t,i,s,a),r.copy(n))},reset:function(){t=!1,i=null,r.set(-1,0,0,0)}}},s=new function(){let t=!1,n=null,i=null,r=null;return{setTest:function(e){e?j(2929):U(2929)},setMask:function(i){n!==i&&!t&&(e.depthMask(i),n=i)},setFunc:function(t){if(i!==t){switch(t){case 0:e.depthFunc(512);break;case 1:e.depthFunc(519);break;case 2:e.depthFunc(513);break;case 3:default:e.depthFunc(515);break;case 4:e.depthFunc(514);break;case 5:e.depthFunc(518);break;case 6:e.depthFunc(516);break;case 7:e.depthFunc(517)}i=t}},setLocked:function(e){t=e},setClear:function(t){r!==t&&(e.clearDepth(t),r=t)},reset:function(){t=!1,n=null,i=null,r=null}}},a=new function(){let t=!1,n=null,i=null,r=null,s=null,a=null,o=null,l=null,u=null;return{setTest:function(e){t||(e?j(2960):U(2960))},setMask:function(i){n!==i&&!t&&(e.stencilMask(i),n=i)},setFunc:function(t,n,a){(i!==t||r!==n||s!==a)&&(e.stencilFunc(t,n,a),i=t,r=n,s=a)},setOp:function(t,n,i){(a!==t||o!==n||l!==i)&&(e.stencilOp(t,n,i),a=t,o=n,l=i)},setLocked:function(e){t=e},setClear:function(t){u!==t&&(e.clearStencil(t),u=t)},reset:function(){t=!1,n=null,i=null,r=null,s=null,a=null,o=null,l=null,u=null}}},o=new WeakMap,l=new WeakMap,u={},c={},h=new WeakMap,d=[],p=null,f=!1,m=null,g=null,v=null,y=null,x=null,b=null,w=null,D=!1,_=null,S=null,E=null,C=null,A=null,M=e.getParameter(35661),T=!1,P=0,F=e.getParameter(7938);-1!==F.indexOf("WebGL")?(P=parseFloat(/^WebGL (\d)/.exec(F)[1]),T=P>=1):-1!==F.indexOf("OpenGL ES")&&(P=parseFloat(/^OpenGL ES (\d)/.exec(F)[1]),T=P>=2);let O=null,I={},k=e.getParameter(3088),B=e.getParameter(2978),R=(new Ov).fromArray(k),L=(new Ov).fromArray(B);function z(t,n,i){let r=new Uint8Array(4),s=e.createTexture();e.bindTexture(t,s),e.texParameteri(t,10241,9728),e.texParameteri(t,10240,9728);for(let a=0;a<i;a++)e.texImage2D(n+a,0,6408,1,1,0,6408,5121,r);return s}let N={};function j(t){!0!==u[t]&&(e.enable(t),u[t]=!0)}function U(t){!1!==u[t]&&(e.disable(t),u[t]=!1)}N[3553]=z(3553,3553,1),N[34067]=z(34067,34069,6),r.setClear(0,0,0,1),s.setClear(1),a.setClear(0),j(2929),s.setFunc(3),G(!1),q(1),j(2884),W(0);let V={[Hm]:32774,[Wm]:32778,[Gm]:32779};if(i)V[103]=32775,V[104]=32776;else{let e=t.get("EXT_blend_minmax");null!==e&&(V[103]=e.MIN_EXT,V[104]=e.MAX_EXT)}let H={[qm]:0,[Ym]:1,[Xm]:768,[Km]:770,[ng]:776,[eg]:774,[Jm]:772,[Qm]:769,[Zm]:771,[tg]:775,[$m]:773};function W(t,n,i,r,s,a,o,l){if(0!==t){if(!1===f&&(j(3042),f=!0),5===t)s=s||n,a=a||i,o=o||r,(n!==g||s!==x)&&(e.blendEquationSeparate(V[n],V[s]),g=n,x=s),(i!==v||r!==y||a!==b||o!==w)&&(e.blendFuncSeparate(H[i],H[r],H[a],H[o]),v=i,y=r,b=a,w=o),m=t,D=!1;else if(t!==m||l!==D){if((g!==Hm||x!==Hm)&&(e.blendEquation(32774),g=Hm,x=Hm),l)switch(t){case 1:e.blendFuncSeparate(1,771,1,771);break;case 2:e.blendFunc(1,1);break;case 3:e.blendFuncSeparate(0,769,0,1);break;case 4:e.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",t)}else switch(t){case 1:e.blendFuncSeparate(770,771,1,771);break;case 2:e.blendFunc(770,1);break;case 3:e.blendFuncSeparate(0,769,0,1);break;case 4:e.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",t)}v=null,y=null,b=null,w=null,m=t,D=l}}else!0===f&&(U(3042),f=!1)}function G(t){_!==t&&(t?e.frontFace(2304):e.frontFace(2305),_=t)}function q(t){0!==t?(j(2884),t!==S&&(1===t?e.cullFace(1029):2===t?e.cullFace(1028):e.cullFace(1032))):U(2884),S=t}function Y(t,n,i){t?(j(32823),(C!==n||A!==i)&&(e.polygonOffset(n,i),C=n,A=i)):U(32823)}return{buffers:{color:r,depth:s,stencil:a},enable:j,disable:U,bindFramebuffer:function(t,n){return c[t]!==n&&(e.bindFramebuffer(t,n),c[t]=n,i&&(36009===t&&(c[36160]=n),36160===t&&(c[36009]=n)),!0)},drawBuffers:function(i,r){let s=d,a=!1;if(i)if(s=h.get(r),void 0===s&&(s=[],h.set(r,s)),i.isWebGLMultipleRenderTargets){let e=i.texture;if(s.length!==e.length||36064!==s[0]){for(let t=0,n=e.length;t<n;t++)s[t]=36064+t;s.length=e.length,a=!0}}else 36064!==s[0]&&(s[0]=36064,a=!0);else 1029!==s[0]&&(s[0]=1029,a=!0);a&&(n.isWebGL2?e.drawBuffers(s):t.get("WEBGL_draw_buffers").drawBuffersWEBGL(s))},useProgram:function(t){return p!==t&&(e.useProgram(t),p=t,!0)},setBlending:W,setMaterial:function(e,t){2===e.side?U(2884):j(2884);let n=1===e.side;t&&(n=!n),G(n),1===e.blending&&!1===e.transparent?W(0):W(e.blending,e.blendEquation,e.blendSrc,e.blendDst,e.blendEquationAlpha,e.blendSrcAlpha,e.blendDstAlpha,e.premultipliedAlpha),s.setFunc(e.depthFunc),s.setTest(e.depthTest),s.setMask(e.depthWrite),r.setMask(e.colorWrite);let i=e.stencilWrite;a.setTest(i),i&&(a.setMask(e.stencilWriteMask),a.setFunc(e.stencilFunc,e.stencilRef,e.stencilFuncMask),a.setOp(e.stencilFail,e.stencilZFail,e.stencilZPass)),Y(e.polygonOffset,e.polygonOffsetFactor,e.polygonOffsetUnits),!0===e.alphaToCoverage?j(32926):U(32926)},setFlipSided:G,setCullFace:q,setLineWidth:function(t){t!==E&&(T&&e.lineWidth(t),E=t)},setPolygonOffset:Y,setScissorTest:function(e){e?j(3089):U(3089)},activeTexture:function(t){void 0===t&&(t=33984+M-1),O!==t&&(e.activeTexture(t),O=t)},bindTexture:function(t,n,i){void 0===i&&(i=null===O?33984+M-1:O);let r=I[i];void 0===r&&(r={type:void 0,texture:void 0},I[i]=r),(r.type!==t||r.texture!==n)&&(O!==i&&(e.activeTexture(i),O=i),e.bindTexture(t,n||N[t]),r.type=t,r.texture=n)},unbindTexture:function(){let t=I[O];void 0!==t&&void 0!==t.type&&(e.bindTexture(t.type,null),t.type=void 0,t.texture=void 0)},compressedTexImage2D:function(){try{e.compressedTexImage2D.apply(e,arguments)}catch(Qn){console.error("THREE.WebGLState:",Qn)}},compressedTexImage3D:function(){try{e.compressedTexImage3D.apply(e,arguments)}catch(Qn){console.error("THREE.WebGLState:",Qn)}},texImage2D:function(){try{e.texImage2D.apply(e,arguments)}catch(Qn){console.error("THREE.WebGLState:",Qn)}},texImage3D:function(){try{e.texImage3D.apply(e,arguments)}catch(Qn){console.error("THREE.WebGLState:",Qn)}},updateUBOMapping:function(t,n){let i=l.get(n);void 0===i&&(i=new WeakMap,l.set(n,i));let r=i.get(t);void 0===r&&(r=e.getUniformBlockIndex(n,t.name),i.set(t,r))},uniformBlockBinding:function(t,n){let i=l.get(n).get(t);o.get(n)!==i&&(e.uniformBlockBinding(n,i,t.__bindingPointIndex),o.set(n,i))},texStorage2D:function(){try{e.texStorage2D.apply(e,arguments)}catch(Qn){console.error("THREE.WebGLState:",Qn)}},texStorage3D:function(){try{e.texStorage3D.apply(e,arguments)}catch(Qn){console.error("THREE.WebGLState:",Qn)}},texSubImage2D:function(){try{e.texSubImage2D.apply(e,arguments)}catch(Qn){console.error("THREE.WebGLState:",Qn)}},texSubImage3D:function(){try{e.texSubImage3D.apply(e,arguments)}catch(Qn){console.error("THREE.WebGLState:",Qn)}},compressedTexSubImage2D:function(){try{e.compressedTexSubImage2D.apply(e,arguments)}catch(Qn){console.error("THREE.WebGLState:",Qn)}},compressedTexSubImage3D:function(){try{e.compressedTexSubImage3D.apply(e,arguments)}catch(Qn){console.error("THREE.WebGLState:",Qn)}},scissor:function(t){!1===R.equals(t)&&(e.scissor(t.x,t.y,t.z,t.w),R.copy(t))},viewport:function(t){!1===L.equals(t)&&(e.viewport(t.x,t.y,t.z,t.w),L.copy(t))},reset:function(){e.disable(3042),e.disable(2884),e.disable(2929),e.disable(32823),e.disable(3089),e.disable(2960),e.disable(32926),e.blendEquation(32774),e.blendFunc(1,0),e.blendFuncSeparate(1,0,1,0),e.colorMask(!0,!0,!0,!0),e.clearColor(0,0,0,0),e.depthMask(!0),e.depthFunc(513),e.clearDepth(1),e.stencilMask(4294967295),e.stencilFunc(519,0,4294967295),e.stencilOp(7680,7680,7680),e.clearStencil(0),e.cullFace(1029),e.frontFace(2305),e.polygonOffset(0,0),e.activeTexture(33984),e.bindFramebuffer(36160,null),!0===i&&(e.bindFramebuffer(36009,null),e.bindFramebuffer(36008,null)),e.useProgram(null),e.lineWidth(1),e.scissor(0,0,e.canvas.width,e.canvas.height),e.viewport(0,0,e.canvas.width,e.canvas.height),u={},O=null,I={},c={},h=new WeakMap,d=[],p=null,f=!1,m=null,g=null,v=null,y=null,x=null,b=null,w=null,D=!1,_=null,S=null,E=null,C=null,A=null,R.set(0,0,e.canvas.width,e.canvas.height),L.set(0,0,e.canvas.width,e.canvas.height),r.reset(),s.reset(),a.reset()}}}function fD(e,t,n,i,r,s,a){let o,l=r.isWebGL2,u=r.maxTextures,c=r.maxCubemapSize,h=r.maxTextureSize,d=r.maxSamples,p=t.has("WEBGL_multisampled_render_to_texture")?t.get("WEBGL_multisampled_render_to_texture"):null,f=!(typeof navigator>"u")&&/OculusBrowser/g.test(navigator.userAgent),m=new WeakMap,g=new WeakMap,v=!1;try{v=typeof OffscreenCanvas<"u"&&null!==new OffscreenCanvas(1,1).getContext("2d")}catch(V){}function y(e,t){return v?new OffscreenCanvas(e,t):fv("canvas")}function x(e,t,n,i){let r=1;if((e.width>i||e.height>i)&&(r=i/Math.max(e.width,e.height)),r<1||!0===t){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){let i=t?rv:Math.floor,s=i(r*e.width),a=i(r*e.height);void 0===o&&(o=y(s,a));let l=n?y(s,a):o;return l.width=s,l.height=a,l.getContext("2d").drawImage(e,0,0,s,a),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+e.width+"x"+e.height+") to ("+s+"x"+a+")."),l}return"data"in e&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+e.width+"x"+e.height+")."),e}return e}function b(e){return nv(e.width)&&nv(e.height)}function w(e,t){return e.generateMipmaps&&t&&e.minFilter!==ug&&e.minFilter!==dg}function D(t){e.generateMipmap(t)}function _(n,i,r,s){let a=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(!1===l)return i;if(null!==n){if(void 0!==e[n])return e[n];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+n+"'")}let o=i;return 6403===i&&(5126===r&&(o=33326),5131===r&&(o=33325),5121===r&&(o=33321)),33319===i&&(5126===r&&(o=33328),5131===r&&(o=33327),5121===r&&(o=33323)),6408===i&&(5126===r&&(o=34836),5131===r&&(o=34842),5121===r&&(o=s===Ng&&!1===a?35907:32856),32819===r&&(o=32854),32820===r&&(o=32855)),(33325===o||33326===o||33327===o||33328===o||34842===o||34836===o)&&t.get("EXT_color_buffer_float"),o}function S(e,t,n){return!0===w(e,n)||e.isFramebufferTexture&&e.minFilter!==ug&&e.minFilter!==dg?Math.log2(Math.max(t.width,t.height))+1:void 0!==e.mipmaps&&e.mipmaps.length>0?e.mipmaps.length:e.isCompressedTexture&&Array.isArray(e.image)?t.mipmaps.length:1}function E(e){return e===ug||1004===e||e===hg?9728:9729}function C(e){let t=e.target;t.removeEventListener("dispose",C),function(e){let t=i.get(e);if(void 0===t.__webglInit)return;let n=e.source,r=g.get(n);if(r){let i=r[t.__cacheKey];i.usedTimes--,0===i.usedTimes&&M(e),0===Object.keys(r).length&&g.delete(n)}i.remove(e)}(t),t.isVideoTexture&&m.delete(t)}function A(t){let n=t.target;n.removeEventListener("dispose",A),function(t){let n=t.texture,r=i.get(t),s=i.get(n);if(void 0!==s.__webglTexture&&(e.deleteTexture(s.__webglTexture),a.memory.textures--),t.depthTexture&&t.depthTexture.dispose(),t.isWebGLCubeRenderTarget)for(let i=0;i<6;i++)e.deleteFramebuffer(r.__webglFramebuffer[i]),r.__webglDepthbuffer&&e.deleteRenderbuffer(r.__webglDepthbuffer[i]);else{if(e.deleteFramebuffer(r.__webglFramebuffer),r.__webglDepthbuffer&&e.deleteRenderbuffer(r.__webglDepthbuffer),r.__webglMultisampledFramebuffer&&e.deleteFramebuffer(r.__webglMultisampledFramebuffer),r.__webglColorRenderbuffer)for(let t=0;t<r.__webglColorRenderbuffer.length;t++)r.__webglColorRenderbuffer[t]&&e.deleteRenderbuffer(r.__webglColorRenderbuffer[t]);r.__webglDepthRenderbuffer&&e.deleteRenderbuffer(r.__webglDepthRenderbuffer)}if(t.isWebGLMultipleRenderTargets)for(let o=0,l=n.length;o<l;o++){let t=i.get(n[o]);t.__webglTexture&&(e.deleteTexture(t.__webglTexture),a.memory.textures--),i.remove(n[o])}i.remove(n),i.remove(t)}(n)}function M(t){let n=i.get(t);e.deleteTexture(n.__webglTexture);let r=t.source;delete g.get(r)[n.__cacheKey],a.memory.textures--}let T=0;function P(e,t){let r=i.get(e);if(e.isVideoTexture&&function(e){let t=a.render.frame;m.get(e)!==t&&(m.set(e,t),e.update())}(e),!1===e.isRenderTargetTexture&&e.version>0&&r.__version!==e.version){let n=e.image;if(null===n)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else{if(!1!==n.complete)return void B(r,e,t);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete")}}n.bindTexture(3553,r.__webglTexture,33984+t)}let F={[ag]:10497,[og]:33071,[lg]:33648},O={[ug]:9728,[cg]:9984,[hg]:9986,[dg]:9729,[pg]:9985,[fg]:9987};function I(n,s,a){if(a?(e.texParameteri(n,10242,F[s.wrapS]),e.texParameteri(n,10243,F[s.wrapT]),(32879===n||35866===n)&&e.texParameteri(n,32882,F[s.wrapR]),e.texParameteri(n,10240,O[s.magFilter]),e.texParameteri(n,10241,O[s.minFilter])):(e.texParameteri(n,10242,33071),e.texParameteri(n,10243,33071),(32879===n||35866===n)&&e.texParameteri(n,32882,33071),(s.wrapS!==og||s.wrapT!==og)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),e.texParameteri(n,10240,E(s.magFilter)),e.texParameteri(n,10241,E(s.minFilter)),s.minFilter!==ug&&s.minFilter!==dg&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),!0===t.has("EXT_texture_filter_anisotropic")){let a=t.get("EXT_texture_filter_anisotropic");if(s.magFilter===ug||s.minFilter!==hg&&s.minFilter!==fg||s.type===vg&&!1===t.has("OES_texture_float_linear")||!1===l&&s.type===yg&&!1===t.has("OES_texture_half_float_linear"))return;(s.anisotropy>1||i.get(s).__currentAnisotropy)&&(e.texParameterf(n,a.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(s.anisotropy,r.getMaxAnisotropy())),i.get(s).__currentAnisotropy=s.anisotropy)}}function k(t,n){let i=!1;void 0===t.__webglInit&&(t.__webglInit=!0,n.addEventListener("dispose",C));let r=n.source,s=g.get(r);void 0===s&&(s={},g.set(r,s));let o=function(e){let t=[];return t.push(e.wrapS),t.push(e.wrapT),t.push(e.wrapR||0),t.push(e.magFilter),t.push(e.minFilter),t.push(e.anisotropy),t.push(e.internalFormat),t.push(e.format),t.push(e.type),t.push(e.generateMipmaps),t.push(e.premultiplyAlpha),t.push(e.flipY),t.push(e.unpackAlignment),t.push(e.encoding),t.join()}(n);if(o!==t.__cacheKey){void 0===s[o]&&(s[o]={texture:e.createTexture(),usedTimes:0},a.memory.textures++,i=!0),s[o].usedTimes++;let r=s[t.__cacheKey];void 0!==r&&(s[t.__cacheKey].usedTimes--,0===r.usedTimes&&M(n)),t.__cacheKey=o,t.__webglTexture=s[o].texture}return i}function B(t,r,a){let o=3553;(r.isDataArrayTexture||r.isCompressedArrayTexture)&&(o=35866),r.isData3DTexture&&(o=32879);let u=k(t,r),c=r.source;n.bindTexture(o,t.__webglTexture,33984+a);let d=i.get(c);if(c.version!==d.__version||!0===u){n.activeTexture(33984+a),e.pixelStorei(37440,r.flipY),e.pixelStorei(37441,r.premultiplyAlpha),e.pixelStorei(3317,r.unpackAlignment),e.pixelStorei(37443,0);let t=function(e){return!l&&(e.wrapS!==og||e.wrapT!==og||e.minFilter!==ug&&e.minFilter!==dg)}(r)&&!1===b(r.image),i=x(r.image,t,!1,h);i=U(r,i);let p=b(i)||l,f=s.convert(r.format,r.encoding),m=s.convert(r.type),g=_(r.internalFormat,f,m,r.encoding,r.isVideoTexture);I(o,r,p);let v,y=r.mipmaps,E=l&&!0!==r.isVideoTexture,C=void 0===d.__version||!0===u,A=S(r,i,p);if(r.isDepthTexture)g=6402,l?g=r.type===vg?36012:r.type===gg?33190:r.type===xg?35056:33189:r.type===vg&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),r.format===wg&&6402===g&&1012!==r.type&&r.type!==gg&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),r.type=gg,m=s.convert(r.type)),r.format===Dg&&6402===g&&(g=34041,r.type!==xg&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),r.type=xg,m=s.convert(r.type))),C&&(E?n.texStorage2D(3553,1,g,i.width,i.height):n.texImage2D(3553,0,g,i.width,i.height,0,f,m,null));else if(r.isDataTexture)if(y.length>0&&p){E&&C&&n.texStorage2D(3553,A,g,y[0].width,y[0].height);for(let e=0,t=y.length;e<t;e++)v=y[e],E?n.texSubImage2D(3553,e,0,0,v.width,v.height,f,m,v.data):n.texImage2D(3553,e,g,v.width,v.height,0,f,m,v.data);r.generateMipmaps=!1}else E?(C&&n.texStorage2D(3553,A,g,i.width,i.height),n.texSubImage2D(3553,0,0,0,i.width,i.height,f,m,i.data)):n.texImage2D(3553,0,g,i.width,i.height,0,f,m,i.data);else if(r.isCompressedTexture)if(r.isCompressedArrayTexture){E&&C&&n.texStorage3D(35866,A,g,y[0].width,y[0].height,i.depth);for(let e=0,t=y.length;e<t;e++)v=y[e],r.format!==bg?null!==f?E?n.compressedTexSubImage3D(35866,e,0,0,0,v.width,v.height,i.depth,f,v.data,0,0):n.compressedTexImage3D(35866,e,g,v.width,v.height,i.depth,0,v.data,0,0):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):E?n.texSubImage3D(35866,e,0,0,0,v.width,v.height,i.depth,f,m,v.data):n.texImage3D(35866,e,g,v.width,v.height,i.depth,0,f,m,v.data)}else{E&&C&&n.texStorage2D(3553,A,g,y[0].width,y[0].height);for(let e=0,t=y.length;e<t;e++)v=y[e],r.format!==bg?null!==f?E?n.compressedTexSubImage2D(3553,e,0,0,v.width,v.height,f,v.data):n.compressedTexImage2D(3553,e,g,v.width,v.height,0,v.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):E?n.texSubImage2D(3553,e,0,0,v.width,v.height,f,m,v.data):n.texImage2D(3553,e,g,v.width,v.height,0,f,m,v.data)}else if(r.isDataArrayTexture)E?(C&&n.texStorage3D(35866,A,g,i.width,i.height,i.depth),n.texSubImage3D(35866,0,0,0,0,i.width,i.height,i.depth,f,m,i.data)):n.texImage3D(35866,0,g,i.width,i.height,i.depth,0,f,m,i.data);else if(r.isData3DTexture)E?(C&&n.texStorage3D(32879,A,g,i.width,i.height,i.depth),n.texSubImage3D(32879,0,0,0,0,i.width,i.height,i.depth,f,m,i.data)):n.texImage3D(32879,0,g,i.width,i.height,i.depth,0,f,m,i.data);else if(r.isFramebufferTexture){if(C)if(E)n.texStorage2D(3553,A,g,i.width,i.height);else{let e=i.width,t=i.height;for(let i=0;i<A;i++)n.texImage2D(3553,i,g,e,t,0,f,m,null),e>>=1,t>>=1}}else if(y.length>0&&p){E&&C&&n.texStorage2D(3553,A,g,y[0].width,y[0].height);for(let e=0,t=y.length;e<t;e++)v=y[e],E?n.texSubImage2D(3553,e,0,0,f,m,v):n.texImage2D(3553,e,g,f,m,v);r.generateMipmaps=!1}else E?(C&&n.texStorage2D(3553,A,g,i.width,i.height),n.texSubImage2D(3553,0,0,0,f,m,i)):n.texImage2D(3553,0,g,f,m,i);w(r,p)&&D(o),d.__version=c.version,r.onUpdate&&r.onUpdate(r)}t.__version=r.version}function R(t,r,a,o,l){let u=s.convert(a.format,a.encoding),c=s.convert(a.type),h=_(a.internalFormat,u,c,a.encoding);i.get(r).__hasExternalTextures||(32879===l||35866===l?n.texImage3D(l,0,h,r.width,r.height,r.depth,0,u,c,null):n.texImage2D(l,0,h,r.width,r.height,0,u,c,null)),n.bindFramebuffer(36160,t),j(r)?p.framebufferTexture2DMultisampleEXT(36160,o,l,i.get(a).__webglTexture,0,N(r)):(3553===l||l>=34069&&l<=34074)&&e.framebufferTexture2D(36160,o,l,i.get(a).__webglTexture,0),n.bindFramebuffer(36160,null)}function L(t,n,i){if(e.bindRenderbuffer(36161,t),n.depthBuffer&&!n.stencilBuffer){let r=33189;if(i||j(n)){let t=n.depthTexture;t&&t.isDepthTexture&&(t.type===vg?r=36012:t.type===gg&&(r=33190));let i=N(n);j(n)?p.renderbufferStorageMultisampleEXT(36161,i,r,n.width,n.height):e.renderbufferStorageMultisample(36161,i,r,n.width,n.height)}else e.renderbufferStorage(36161,r,n.width,n.height);e.framebufferRenderbuffer(36160,36096,36161,t)}else if(n.depthBuffer&&n.stencilBuffer){let r=N(n);i&&!1===j(n)?e.renderbufferStorageMultisample(36161,r,35056,n.width,n.height):j(n)?p.renderbufferStorageMultisampleEXT(36161,r,35056,n.width,n.height):e.renderbufferStorage(36161,34041,n.width,n.height),e.framebufferRenderbuffer(36160,33306,36161,t)}else{let t=!0===n.isWebGLMultipleRenderTargets?n.texture:[n.texture];for(let r=0;r<t.length;r++){let a=t[r],o=s.convert(a.format,a.encoding),l=s.convert(a.type),u=_(a.internalFormat,o,l,a.encoding),c=N(n);i&&!1===j(n)?e.renderbufferStorageMultisample(36161,c,u,n.width,n.height):j(n)?p.renderbufferStorageMultisampleEXT(36161,c,u,n.width,n.height):e.renderbufferStorage(36161,u,n.width,n.height)}}e.bindRenderbuffer(36161,null)}function z(t){let r=i.get(t),s=!0===t.isWebGLCubeRenderTarget;if(t.depthTexture&&!r.__autoAllocateDepthBuffer){if(s)throw new Error("target.depthTexture not supported in Cube render targets");!function(t,r){if(r&&r.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(n.bindFramebuffer(36160,t),!r.depthTexture||!r.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!i.get(r.depthTexture).__webglTexture||r.depthTexture.image.width!==r.width||r.depthTexture.image.height!==r.height)&&(r.depthTexture.image.width=r.width,r.depthTexture.image.height=r.height,r.depthTexture.needsUpdate=!0),P(r.depthTexture,0);let s=i.get(r.depthTexture).__webglTexture,a=N(r);if(r.depthTexture.format===wg)j(r)?p.framebufferTexture2DMultisampleEXT(36160,36096,3553,s,0,a):e.framebufferTexture2D(36160,36096,3553,s,0);else{if(r.depthTexture.format!==Dg)throw new Error("Unknown depthTexture format");j(r)?p.framebufferTexture2DMultisampleEXT(36160,33306,3553,s,0,a):e.framebufferTexture2D(36160,33306,3553,s,0)}}(r.__webglFramebuffer,t)}else if(s){r.__webglDepthbuffer=[];for(let i=0;i<6;i++)n.bindFramebuffer(36160,r.__webglFramebuffer[i]),r.__webglDepthbuffer[i]=e.createRenderbuffer(),L(r.__webglDepthbuffer[i],t,!1)}else n.bindFramebuffer(36160,r.__webglFramebuffer),r.__webglDepthbuffer=e.createRenderbuffer(),L(r.__webglDepthbuffer,t,!1);n.bindFramebuffer(36160,null)}function N(e){return Math.min(d,e.samples)}function j(e){let n=i.get(e);return l&&e.samples>0&&!0===t.has("WEBGL_multisampled_render_to_texture")&&!1!==n.__useRenderToTexture}function U(e,n){let i=e.encoding,r=e.format,s=e.type;return!0===e.isCompressedTexture||!0===e.isVideoTexture||e.format===qg||i!==zg&&(i===Ng?!1===l?!0===t.has("EXT_sRGB")&&r===bg?(e.format=qg,e.minFilter=dg,e.generateMipmaps=!1):n=Av.sRGBToLinear(n):(r!==bg||s!==mg)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture encoding:",i)),n}this.allocateTextureUnit=function(){let e=T;return e>=u&&console.warn("THREE.WebGLTextures: Trying to use "+e+" texture units while this GPU supports only "+u),T+=1,e},this.resetTextureUnits=function(){T=0},this.setTexture2D=P,this.setTexture2DArray=function(e,t){let r=i.get(e);e.version>0&&r.__version!==e.version?B(r,e,t):n.bindTexture(35866,r.__webglTexture,33984+t)},this.setTexture3D=function(e,t){let r=i.get(e);e.version>0&&r.__version!==e.version?B(r,e,t):n.bindTexture(32879,r.__webglTexture,33984+t)},this.setTextureCube=function(t,r){let a=i.get(t);t.version>0&&a.__version!==t.version?function(t,r,a){if(6!==r.image.length)return;let o=k(t,r),u=r.source;n.bindTexture(34067,t.__webglTexture,33984+a);let h=i.get(u);if(u.version!==h.__version||!0===o){n.activeTexture(33984+a),e.pixelStorei(37440,r.flipY),e.pixelStorei(37441,r.premultiplyAlpha),e.pixelStorei(3317,r.unpackAlignment),e.pixelStorei(37443,0);let t=r.isCompressedTexture||r.image[0].isCompressedTexture,i=r.image[0]&&r.image[0].isDataTexture,d=[];for(let e=0;e<6;e++)d[e]=t||i?i?r.image[e].image:r.image[e]:x(r.image[e],!1,!0,c),d[e]=U(r,d[e]);let p,f=d[0],m=b(f)||l,g=s.convert(r.format,r.encoding),v=s.convert(r.type),y=_(r.internalFormat,g,v,r.encoding),E=l&&!0!==r.isVideoTexture,C=void 0===h.__version||!0===o,A=S(r,f,m);if(I(34067,r,m),t){E&&C&&n.texStorage2D(34067,A,y,f.width,f.height);for(let e=0;e<6;e++){p=d[e].mipmaps;for(let t=0;t<p.length;t++){let i=p[t];r.format!==bg?null!==g?E?n.compressedTexSubImage2D(34069+e,t,0,0,i.width,i.height,g,i.data):n.compressedTexImage2D(34069+e,t,y,i.width,i.height,0,i.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):E?n.texSubImage2D(34069+e,t,0,0,i.width,i.height,g,v,i.data):n.texImage2D(34069+e,t,y,i.width,i.height,0,g,v,i.data)}}}else{p=r.mipmaps,E&&C&&(p.length>0&&A++,n.texStorage2D(34067,A,y,d[0].width,d[0].height));for(let e=0;e<6;e++)if(i){E?n.texSubImage2D(34069+e,0,0,0,d[e].width,d[e].height,g,v,d[e].data):n.texImage2D(34069+e,0,y,d[e].width,d[e].height,0,g,v,d[e].data);for(let t=0;t<p.length;t++){let i=p[t].image[e].image;E?n.texSubImage2D(34069+e,t+1,0,0,i.width,i.height,g,v,i.data):n.texImage2D(34069+e,t+1,y,i.width,i.height,0,g,v,i.data)}}else{E?n.texSubImage2D(34069+e,0,0,0,g,v,d[e]):n.texImage2D(34069+e,0,y,g,v,d[e]);for(let t=0;t<p.length;t++){let i=p[t];E?n.texSubImage2D(34069+e,t+1,0,0,g,v,i.image[e]):n.texImage2D(34069+e,t+1,y,g,v,i.image[e])}}}w(r,m)&&D(34067),h.__version=u.version,r.onUpdate&&r.onUpdate(r)}t.__version=r.version}(a,t,r):n.bindTexture(34067,a.__webglTexture,33984+r)},this.rebindTextures=function(e,t,n){let r=i.get(e);void 0!==t&&R(r.__webglFramebuffer,e,e.texture,36064,3553),void 0!==n&&z(e)},this.setupRenderTarget=function(t){let o=t.texture,u=i.get(t),c=i.get(o);t.addEventListener("dispose",A),!0!==t.isWebGLMultipleRenderTargets&&(void 0===c.__webglTexture&&(c.__webglTexture=e.createTexture()),c.__version=o.version,a.memory.textures++);let h=!0===t.isWebGLCubeRenderTarget,d=!0===t.isWebGLMultipleRenderTargets,p=b(t)||l;if(h){u.__webglFramebuffer=[];for(let t=0;t<6;t++)u.__webglFramebuffer[t]=e.createFramebuffer()}else{if(u.__webglFramebuffer=e.createFramebuffer(),d)if(r.drawBuffers){let n=t.texture;for(let t=0,r=n.length;t<r;t++){let r=i.get(n[t]);void 0===r.__webglTexture&&(r.__webglTexture=e.createTexture(),a.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");if(l&&t.samples>0&&!1===j(t)){let i=d?o:[o];u.__webglMultisampledFramebuffer=e.createFramebuffer(),u.__webglColorRenderbuffer=[],n.bindFramebuffer(36160,u.__webglMultisampledFramebuffer);for(let n=0;n<i.length;n++){let r=i[n];u.__webglColorRenderbuffer[n]=e.createRenderbuffer(),e.bindRenderbuffer(36161,u.__webglColorRenderbuffer[n]);let a=s.convert(r.format,r.encoding),o=s.convert(r.type),l=_(r.internalFormat,a,o,r.encoding,!0===t.isXRRenderTarget),c=N(t);e.renderbufferStorageMultisample(36161,c,l,t.width,t.height),e.framebufferRenderbuffer(36160,36064+n,36161,u.__webglColorRenderbuffer[n])}e.bindRenderbuffer(36161,null),t.depthBuffer&&(u.__webglDepthRenderbuffer=e.createRenderbuffer(),L(u.__webglDepthRenderbuffer,t,!0)),n.bindFramebuffer(36160,null)}}if(h){n.bindTexture(34067,c.__webglTexture),I(34067,o,p);for(let e=0;e<6;e++)R(u.__webglFramebuffer[e],t,o,36064,34069+e);w(o,p)&&D(34067),n.unbindTexture()}else if(d){let e=t.texture;for(let r=0,s=e.length;r<s;r++){let s=e[r],a=i.get(s);n.bindTexture(3553,a.__webglTexture),I(3553,s,p),R(u.__webglFramebuffer,t,s,36064+r,3553),w(s,p)&&D(3553)}n.unbindTexture()}else{let e=3553;(t.isWebGL3DRenderTarget||t.isWebGLArrayRenderTarget)&&(l?e=t.isWebGL3DRenderTarget?32879:35866:console.error("THREE.WebGLTextures: THREE.Data3DTexture and THREE.DataArrayTexture only supported with WebGL2.")),n.bindTexture(e,c.__webglTexture),I(e,o,p),R(u.__webglFramebuffer,t,o,36064,e),w(o,p)&&D(e),n.unbindTexture()}t.depthBuffer&&z(t)},this.updateRenderTargetMipmap=function(e){let t=b(e)||l,r=!0===e.isWebGLMultipleRenderTargets?e.texture:[e.texture];for(let s=0,a=r.length;s<a;s++){let a=r[s];if(w(a,t)){let t=e.isWebGLCubeRenderTarget?34067:3553,r=i.get(a).__webglTexture;n.bindTexture(t,r),D(t),n.unbindTexture()}}},this.updateMultisampleRenderTarget=function(t){if(l&&t.samples>0&&!1===j(t)){let r=t.isWebGLMultipleRenderTargets?t.texture:[t.texture],s=t.width,a=t.height,o=16384,l=[],u=t.stencilBuffer?33306:36096,c=i.get(t),h=!0===t.isWebGLMultipleRenderTargets;if(h)for(let t=0;t<r.length;t++)n.bindFramebuffer(36160,c.__webglMultisampledFramebuffer),e.framebufferRenderbuffer(36160,36064+t,36161,null),n.bindFramebuffer(36160,c.__webglFramebuffer),e.framebufferTexture2D(36009,36064+t,3553,null,0);n.bindFramebuffer(36008,c.__webglMultisampledFramebuffer),n.bindFramebuffer(36009,c.__webglFramebuffer);for(let n=0;n<r.length;n++){l.push(36064+n),t.depthBuffer&&l.push(u);let d=void 0!==c.__ignoreDepthValues&&c.__ignoreDepthValues;if(!1===d&&(t.depthBuffer&&(o|=256),t.stencilBuffer&&(o|=1024)),h&&e.framebufferRenderbuffer(36008,36064,36161,c.__webglColorRenderbuffer[n]),!0===d&&(e.invalidateFramebuffer(36008,[u]),e.invalidateFramebuffer(36009,[u])),h){let t=i.get(r[n]).__webglTexture;e.framebufferTexture2D(36009,36064,3553,t,0)}e.blitFramebuffer(0,0,s,a,0,0,s,a,o,9728),f&&e.invalidateFramebuffer(36008,l)}if(n.bindFramebuffer(36008,null),n.bindFramebuffer(36009,null),h)for(let t=0;t<r.length;t++){n.bindFramebuffer(36160,c.__webglMultisampledFramebuffer),e.framebufferRenderbuffer(36160,36064+t,36161,c.__webglColorRenderbuffer[t]);let s=i.get(r[t]).__webglTexture;n.bindFramebuffer(36160,c.__webglFramebuffer),e.framebufferTexture2D(36009,36064+t,3553,s,0)}n.bindFramebuffer(36009,c.__webglMultisampledFramebuffer)}},this.setupDepthRenderbuffer=z,this.setupFrameBufferTexture=R,this.useMultisampledRTT=j}function mD(e,t,n){let i=n.isWebGL2;return{convert:function(n){let r,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(n===mg)return 5121;if(1017===n)return 32819;if(1018===n)return 32820;if(1010===n)return 5120;if(1011===n)return 5122;if(1012===n)return 5123;if(1013===n)return 5124;if(n===gg)return 5125;if(n===vg)return 5126;if(n===yg)return i?5131:(r=t.get("OES_texture_half_float"),null!==r?r.HALF_FLOAT_OES:null);if(1021===n)return 6406;if(n===bg)return 6408;if(1024===n)return 6409;if(1025===n)return 6410;if(n===wg)return 6402;if(n===Dg)return 34041;if(n===qg)return r=t.get("EXT_sRGB"),null!==r?r.SRGB_ALPHA_EXT:null;if(n===_g)return 6403;if(1029===n)return 36244;if(n===Sg)return 33319;if(1031===n)return 33320;if(1033===n)return 36249;if(n===Eg||n===Cg||n===Ag||n===Mg)if(s===Ng){if(r=t.get("WEBGL_compressed_texture_s3tc_srgb"),null===r)return null;if(n===Eg)return r.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(n===Cg)return r.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(n===Ag)return r.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(n===Mg)return r.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else{if(r=t.get("WEBGL_compressed_texture_s3tc"),null===r)return null;if(n===Eg)return r.COMPRESSED_RGB_S3TC_DXT1_EXT;if(n===Cg)return r.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(n===Ag)return r.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(n===Mg)return r.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(35840===n||35841===n||35842===n||35843===n){if(r=t.get("WEBGL_compressed_texture_pvrtc"),null===r)return null;if(35840===n)return r.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(35841===n)return r.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(35842===n)return r.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(35843===n)return r.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(36196===n)return r=t.get("WEBGL_compressed_texture_etc1"),null!==r?r.COMPRESSED_RGB_ETC1_WEBGL:null;if(37492===n||37496===n){if(r=t.get("WEBGL_compressed_texture_etc"),null===r)return null;if(37492===n)return s===Ng?r.COMPRESSED_SRGB8_ETC2:r.COMPRESSED_RGB8_ETC2;if(37496===n)return s===Ng?r.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:r.COMPRESSED_RGBA8_ETC2_EAC}if(37808===n||37809===n||37810===n||37811===n||37812===n||37813===n||37814===n||37815===n||37816===n||37817===n||37818===n||37819===n||37820===n||37821===n){if(r=t.get("WEBGL_compressed_texture_astc"),null===r)return null;if(37808===n)return s===Ng?r.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:r.COMPRESSED_RGBA_ASTC_4x4_KHR;if(37809===n)return s===Ng?r.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:r.COMPRESSED_RGBA_ASTC_5x4_KHR;if(37810===n)return s===Ng?r.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:r.COMPRESSED_RGBA_ASTC_5x5_KHR;if(37811===n)return s===Ng?r.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:r.COMPRESSED_RGBA_ASTC_6x5_KHR;if(37812===n)return s===Ng?r.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:r.COMPRESSED_RGBA_ASTC_6x6_KHR;if(37813===n)return s===Ng?r.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:r.COMPRESSED_RGBA_ASTC_8x5_KHR;if(37814===n)return s===Ng?r.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:r.COMPRESSED_RGBA_ASTC_8x6_KHR;if(37815===n)return s===Ng?r.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:r.COMPRESSED_RGBA_ASTC_8x8_KHR;if(37816===n)return s===Ng?r.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:r.COMPRESSED_RGBA_ASTC_10x5_KHR;if(37817===n)return s===Ng?r.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:r.COMPRESSED_RGBA_ASTC_10x6_KHR;if(37818===n)return s===Ng?r.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:r.COMPRESSED_RGBA_ASTC_10x8_KHR;if(37819===n)return s===Ng?r.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:r.COMPRESSED_RGBA_ASTC_10x10_KHR;if(37820===n)return s===Ng?r.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:r.COMPRESSED_RGBA_ASTC_12x10_KHR;if(37821===n)return s===Ng?r.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:r.COMPRESSED_RGBA_ASTC_12x12_KHR}if(n===Tg){if(r=t.get("EXT_texture_compression_bptc"),null===r)return null;if(n===Tg)return s===Ng?r.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:r.COMPRESSED_RGBA_BPTC_UNORM_EXT}if(36283===n||36284===n||36285===n||36286===n){if(r=t.get("EXT_texture_compression_rgtc"),null===r)return null;if(n===Tg)return r.COMPRESSED_RED_RGTC1_EXT;if(36284===n)return r.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(36285===n)return r.COMPRESSED_RED_GREEN_RGTC2_EXT;if(36286===n)return r.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}return n===xg?i?34042:(r=t.get("WEBGL_depth_texture"),null!==r?r.UNSIGNED_INT_24_8_WEBGL:null):void 0!==e[n]?e[n]:null}}}var gD=class extends Bx{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];super(),this.isArrayCamera=!0,this.cameras=e}},vD=class extends zy{constructor(){super(),this.isGroup=!0,this.type="Group"}},yD={type:"move"},xD=class{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return null===this._hand&&(this._hand=new vD,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return null===this._targetRay&&(this._targetRay=new vD,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new Lv,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new Lv),this._targetRay}getGripSpace(){return null===this._grip&&(this._grip=new vD,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new Lv,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new Lv),this._grip}dispatchEvent(e){return null!==this._targetRay&&this._targetRay.dispatchEvent(e),null!==this._grip&&this._grip.dispatchEvent(e),null!==this._hand&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){let t=this._hand;if(t)for(let n of e.hand.values())this._getHandJoint(t,n)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),null!==this._targetRay&&(this._targetRay.visible=!1),null!==this._grip&&(this._grip.visible=!1),null!==this._hand&&(this._hand.visible=!1),this}update(e,t,n){let i=null,r=null,s=null,a=this._targetRay,o=this._grip,l=this._hand;if(e&&"visible-blurred"!==t.session.visibilityState){if(l&&e.hand){s=!0;for(let s of e.hand.values()){let e=t.getJointPose(s,n),i=this._getHandJoint(l,s);null!==e&&(i.matrix.fromArray(e.transform.matrix),i.matrix.decompose(i.position,i.rotation,i.scale),i.jointRadius=e.radius),i.visible=null!==e}let i=l.joints["index-finger-tip"],r=l.joints["thumb-tip"],a=i.position.distanceTo(r.position),o=.02,u=.005;l.inputState.pinching&&a>o+u?(l.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!l.inputState.pinching&&a<=o-u&&(l.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else null!==o&&e.gripSpace&&(r=t.getPose(e.gripSpace,n),null!==r&&(o.matrix.fromArray(r.transform.matrix),o.matrix.decompose(o.position,o.rotation,o.scale),r.linearVelocity?(o.hasLinearVelocity=!0,o.linearVelocity.copy(r.linearVelocity)):o.hasLinearVelocity=!1,r.angularVelocity?(o.hasAngularVelocity=!0,o.angularVelocity.copy(r.angularVelocity)):o.hasAngularVelocity=!1));null!==a&&(i=t.getPose(e.targetRaySpace,n),null===i&&null!==r&&(i=r),null!==i&&(a.matrix.fromArray(i.transform.matrix),a.matrix.decompose(a.position,a.rotation,a.scale),i.linearVelocity?(a.hasLinearVelocity=!0,a.linearVelocity.copy(i.linearVelocity)):a.hasLinearVelocity=!1,i.angularVelocity?(a.hasAngularVelocity=!0,a.angularVelocity.copy(i.angularVelocity)):a.hasAngularVelocity=!1,this.dispatchEvent(yD)))}return null!==a&&(a.visible=null!==i),null!==o&&(o.visible=null!==r),null!==l&&(l.visible=null!==s),this}_getHandJoint(e,t){if(void 0===e.joints[t.jointName]){let n=new vD;n.matrixAutoUpdate=!1,n.visible=!1,e.joints[t.jointName]=n,e.add(n)}return e.joints[t.jointName]}},bD=class extends Fv{constructor(e,t,n,i,r,s,a,o,l,u){if((u=void 0!==u?u:wg)!==wg&&u!==Dg)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===n&&u===wg&&(n=gg),void 0===n&&u===Dg&&(n=xg),super(null,i,r,s,a,o,u,n,l),this.isDepthTexture=!0,this.image={width:e,height:t},this.magFilter=void 0!==a?a:ug,this.minFilter=void 0!==o?o:ug,this.flipY=!1,this.generateMipmaps=!1}},wD=class extends Yg{constructor(e,t){super();let n=this,i=null,r=1,s=null,a="local-floor",o=1,l=null,u=null,c=null,h=null,d=null,p=null,f=t.getContextAttributes(),m=null,g=null,v=[],y=[],x=new Set,b=new Map,w=new Bx;w.layers.enable(1),w.viewport=new Ov;let D=new Bx;D.layers.enable(2),D.viewport=new Ov;let _=[w,D],S=new gD;S.layers.enable(1),S.layers.enable(2);let E=null,C=null;function A(e){let t=y.indexOf(e.inputSource);if(-1===t)return;let n=v[t];void 0!==n&&n.dispatchEvent({type:e.type,data:e.inputSource})}function M(){i.removeEventListener("select",A),i.removeEventListener("selectstart",A),i.removeEventListener("selectend",A),i.removeEventListener("squeeze",A),i.removeEventListener("squeezestart",A),i.removeEventListener("squeezeend",A),i.removeEventListener("end",M),i.removeEventListener("inputsourceschange",T);for(let e=0;e<v.length;e++){let t=y[e];null!==t&&(y[e]=null,v[e].disconnect(t))}E=null,C=null,e.setRenderTarget(m),d=null,h=null,c=null,i=null,g=null,k.stop(),n.isPresenting=!1,n.dispatchEvent({type:"sessionend"})}function T(e){for(let t=0;t<e.removed.length;t++){let n=e.removed[t],i=y.indexOf(n);i>=0&&(y[i]=null,v[i].disconnect(n))}for(let t=0;t<e.added.length;t++){let n=e.added[t],i=y.indexOf(n);if(-1===i){for(let e=0;e<v.length;e++){if(e>=y.length){y.push(n),i=e;break}if(null===y[e]){y[e]=n,i=e;break}}if(-1===i)break}let r=v[i];r&&r.connect(n)}}this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(e){let t=v[e];return void 0===t&&(t=new xD,v[e]=t),t.getTargetRaySpace()},this.getControllerGrip=function(e){let t=v[e];return void 0===t&&(t=new xD,v[e]=t),t.getGripSpace()},this.getHand=function(e){let t=v[e];return void 0===t&&(t=new xD,v[e]=t),t.getHandSpace()},this.setFramebufferScaleFactor=function(e){r=e,!0===n.isPresenting&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(e){a=e,!0===n.isPresenting&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return l||s},this.setReferenceSpace=function(e){l=e},this.getBaseLayer=function(){return null!==h?h:d},this.getBinding=function(){return c},this.getFrame=function(){return p},this.getSession=function(){return i},this.setSession=async function(u){if(i=u,null!==i){if(m=e.getRenderTarget(),i.addEventListener("select",A),i.addEventListener("selectstart",A),i.addEventListener("selectend",A),i.addEventListener("squeeze",A),i.addEventListener("squeezestart",A),i.addEventListener("squeezeend",A),i.addEventListener("end",M),i.addEventListener("inputsourceschange",T),!0!==f.xrCompatible&&await t.makeXRCompatible(),void 0===i.renderState.layers||!1===e.capabilities.isWebGL2){let n={antialias:void 0!==i.renderState.layers||f.antialias,alpha:f.alpha,depth:f.depth,stencil:f.stencil,framebufferScaleFactor:r};d=new XRWebGLLayer(i,t,n),i.updateRenderState({baseLayer:d}),g=new Iv(d.framebufferWidth,d.framebufferHeight,{format:bg,type:mg,encoding:e.outputEncoding,stencilBuffer:f.stencil})}else{let n=null,s=null,a=null;f.depth&&(a=f.stencil?35056:33190,n=f.stencil?Dg:wg,s=f.stencil?xg:gg);let o={colorFormat:32856,depthFormat:a,scaleFactor:r};c=new XRWebGLBinding(i,t),h=c.createProjectionLayer(o),i.updateRenderState({layers:[h]}),g=new Iv(h.textureWidth,h.textureHeight,{format:bg,type:mg,depthTexture:new bD(h.textureWidth,h.textureHeight,s,void 0,void 0,void 0,void 0,void 0,void 0,n),stencilBuffer:f.stencil,encoding:e.outputEncoding,samples:f.antialias?4:0}),e.properties.get(g).__ignoreDepthValues=h.ignoreDepthValues}g.isXRRenderTarget=!0,this.setFoveation(o),l=null,s=await i.requestReferenceSpace(a),k.setContext(i),k.start(),n.isPresenting=!0,n.dispatchEvent({type:"sessionstart"})}};let P=new Lv,F=new Lv;function O(e,t){null===t?e.matrixWorld.copy(e.matrix):e.matrixWorld.multiplyMatrices(t.matrixWorld,e.matrix),e.matrixWorldInverse.copy(e.matrixWorld).invert()}this.updateCamera=function(e){if(null===i)return;S.near=D.near=w.near=e.near,S.far=D.far=w.far=e.far,(E!==S.near||C!==S.far)&&(i.updateRenderState({depthNear:S.near,depthFar:S.far}),E=S.near,C=S.far);let t=e.parent,n=S.cameras;O(S,t);for(let i=0;i<n.length;i++)O(n[i],t);S.matrixWorld.decompose(S.position,S.quaternion,S.scale),e.matrix.copy(S.matrix),e.matrix.decompose(e.position,e.quaternion,e.scale);let r=e.children;for(let i=0,s=r.length;i<s;i++)r[i].updateMatrixWorld(!0);2===n.length?function(e,t,n){P.setFromMatrixPosition(t.matrixWorld),F.setFromMatrixPosition(n.matrixWorld);let i=P.distanceTo(F),r=t.projectionMatrix.elements,s=n.projectionMatrix.elements,a=r[14]/(r[10]-1),o=r[14]/(r[10]+1),l=(r[9]+1)/r[5],u=(r[9]-1)/r[5],c=(r[8]-1)/r[0],h=(s[8]+1)/s[0],d=a*c,p=a*h,f=i/(-c+h),m=f*-c;t.matrixWorld.decompose(e.position,e.quaternion,e.scale),e.translateX(m),e.translateZ(f),e.matrixWorld.compose(e.position,e.quaternion,e.scale),e.matrixWorldInverse.copy(e.matrixWorld).invert();let g=a+f,v=o+f,y=d-m,x=p+(i-m),b=l*o/v*g,w=u*o/v*g;e.projectionMatrix.makePerspective(y,x,b,w,g,v)}(S,w,D):S.projectionMatrix.copy(w.projectionMatrix)},this.getCamera=function(){return S},this.getFoveation=function(){if(null!==h||null!==d)return o},this.setFoveation=function(e){o=e,null!==h&&(h.fixedFoveation=e),null!==d&&void 0!==d.fixedFoveation&&(d.fixedFoveation=e)},this.getPlanes=function(){return x};let I=null;let k=new Yx;k.setAnimationLoop((function(t,i){if(u=i.getViewerPose(l||s),p=i,null!==u){let t=u.views;null!==d&&(e.setRenderTargetFramebuffer(g,d.framebuffer),e.setRenderTarget(g));let n=!1;t.length!==S.cameras.length&&(S.cameras.length=0,n=!0);for(let i=0;i<t.length;i++){let r=t[i],s=null;if(null!==d)s=d.getViewport(r);else{let t=c.getViewSubImage(h,r);s=t.viewport,0===i&&(e.setRenderTargetTextures(g,t.colorTexture,h.ignoreDepthValues?void 0:t.depthStencilTexture),e.setRenderTarget(g))}let a=_[i];void 0===a&&(a=new Bx,a.layers.enable(i),a.viewport=new Ov,_[i]=a),a.matrix.fromArray(r.transform.matrix),a.projectionMatrix.fromArray(r.projectionMatrix),a.viewport.set(s.x,s.y,s.width,s.height),0===i&&S.matrix.copy(a.matrix),!0===n&&S.cameras.push(a)}}for(let e=0;e<v.length;e++){let t=y[e],n=v[e];null!==t&&void 0!==n&&n.update(t,i,l||s)}if(I&&I(t,i),i.detectedPlanes){n.dispatchEvent({type:"planesdetected",data:i.detectedPlanes});let e=null;for(let t of x)i.detectedPlanes.has(t)||(null===e&&(e=[]),e.push(t));if(null!==e)for(let t of e)x.delete(t),b.delete(t),n.dispatchEvent({type:"planeremoved",data:t});for(let t of i.detectedPlanes)if(x.has(t)){let e=b.get(t);t.lastChangedTime>e&&(b.set(t,t.lastChangedTime),n.dispatchEvent({type:"planechanged",data:t}))}else x.add(t),b.set(t,i.lastChangedTime),n.dispatchEvent({type:"planeadded",data:t})}p=null})),this.setAnimationLoop=function(e){I=e},this.dispose=function(){}}};function DD(e,t){function n(n,i){n.opacity.value=i.opacity,i.color&&n.diffuse.value.copy(i.color),i.emissive&&n.emissive.value.copy(i.emissive).multiplyScalar(i.emissiveIntensity),i.map&&(n.map.value=i.map),i.alphaMap&&(n.alphaMap.value=i.alphaMap),i.bumpMap&&(n.bumpMap.value=i.bumpMap,n.bumpScale.value=i.bumpScale,1===i.side&&(n.bumpScale.value*=-1)),i.displacementMap&&(n.displacementMap.value=i.displacementMap,n.displacementScale.value=i.displacementScale,n.displacementBias.value=i.displacementBias),i.emissiveMap&&(n.emissiveMap.value=i.emissiveMap),i.normalMap&&(n.normalMap.value=i.normalMap,n.normalScale.value.copy(i.normalScale),1===i.side&&n.normalScale.value.negate()),i.specularMap&&(n.specularMap.value=i.specularMap),i.alphaTest>0&&(n.alphaTest.value=i.alphaTest);let r,s,a=t.get(i).envMap;if(a&&(n.envMap.value=a,n.flipEnvMap.value=a.isCubeTexture&&!1===a.isRenderTargetTexture?-1:1,n.reflectivity.value=i.reflectivity,n.ior.value=i.ior,n.refractionRatio.value=i.refractionRatio),i.lightMap){n.lightMap.value=i.lightMap;let t=!0!==e.physicallyCorrectLights?Math.PI:1;n.lightMapIntensity.value=i.lightMapIntensity*t}i.aoMap&&(n.aoMap.value=i.aoMap,n.aoMapIntensity.value=i.aoMapIntensity),i.map?r=i.map:i.specularMap?r=i.specularMap:i.displacementMap?r=i.displacementMap:i.normalMap?r=i.normalMap:i.bumpMap?r=i.bumpMap:i.roughnessMap?r=i.roughnessMap:i.metalnessMap?r=i.metalnessMap:i.alphaMap?r=i.alphaMap:i.emissiveMap?r=i.emissiveMap:i.clearcoatMap?r=i.clearcoatMap:i.clearcoatNormalMap?r=i.clearcoatNormalMap:i.clearcoatRoughnessMap?r=i.clearcoatRoughnessMap:i.iridescenceMap?r=i.iridescenceMap:i.iridescenceThicknessMap?r=i.iridescenceThicknessMap:i.specularIntensityMap?r=i.specularIntensityMap:i.specularColorMap?r=i.specularColorMap:i.transmissionMap?r=i.transmissionMap:i.thicknessMap?r=i.thicknessMap:i.sheenColorMap?r=i.sheenColorMap:i.sheenRoughnessMap&&(r=i.sheenRoughnessMap),void 0!==r&&(r.isWebGLRenderTarget&&(r=r.texture),!0===r.matrixAutoUpdate&&r.updateMatrix(),n.uvTransform.value.copy(r.matrix)),i.aoMap?s=i.aoMap:i.lightMap&&(s=i.lightMap),void 0!==s&&(s.isWebGLRenderTarget&&(s=s.texture),!0===s.matrixAutoUpdate&&s.updateMatrix(),n.uv2Transform.value.copy(s.matrix))}return{refreshFogUniforms:function(t,n){n.color.getRGB(t.fogColor.value,Fx(e)),n.isFog?(t.fogNear.value=n.near,t.fogFar.value=n.far):n.isFogExp2&&(t.fogDensity.value=n.density)},refreshMaterialUniforms:function(e,i,r,s,a){i.isMeshBasicMaterial||i.isMeshLambertMaterial?n(e,i):i.isMeshToonMaterial?(n(e,i),function(e,t){t.gradientMap&&(e.gradientMap.value=t.gradientMap)}(e,i)):i.isMeshPhongMaterial?(n(e,i),function(e,t){e.specular.value.copy(t.specular),e.shininess.value=Math.max(t.shininess,1e-4)}(e,i)):i.isMeshStandardMaterial?(n(e,i),function(e,n){e.roughness.value=n.roughness,e.metalness.value=n.metalness,n.roughnessMap&&(e.roughnessMap.value=n.roughnessMap),n.metalnessMap&&(e.metalnessMap.value=n.metalnessMap),t.get(n).envMap&&(e.envMapIntensity.value=n.envMapIntensity)}(e,i),i.isMeshPhysicalMaterial&&function(e,t,n){e.ior.value=t.ior,t.sheen>0&&(e.sheenColor.value.copy(t.sheenColor).multiplyScalar(t.sheen),e.sheenRoughness.value=t.sheenRoughness,t.sheenColorMap&&(e.sheenColorMap.value=t.sheenColorMap),t.sheenRoughnessMap&&(e.sheenRoughnessMap.value=t.sheenRoughnessMap)),t.clearcoat>0&&(e.clearcoat.value=t.clearcoat,e.clearcoatRoughness.value=t.clearcoatRoughness,t.clearcoatMap&&(e.clearcoatMap.value=t.clearcoatMap),t.clearcoatRoughnessMap&&(e.clearcoatRoughnessMap.value=t.clearcoatRoughnessMap),t.clearcoatNormalMap&&(e.clearcoatNormalScale.value.copy(t.clearcoatNormalScale),e.clearcoatNormalMap.value=t.clearcoatNormalMap,1===t.side&&e.clearcoatNormalScale.value.negate())),t.iridescence>0&&(e.iridescence.value=t.iridescence,e.iridescenceIOR.value=t.iridescenceIOR,e.iridescenceThicknessMinimum.value=t.iridescenceThicknessRange[0],e.iridescenceThicknessMaximum.value=t.iridescenceThicknessRange[1],t.iridescenceMap&&(e.iridescenceMap.value=t.iridescenceMap),t.iridescenceThicknessMap&&(e.iridescenceThicknessMap.value=t.iridescenceThicknessMap)),t.transmission>0&&(e.transmission.value=t.transmission,e.transmissionSamplerMap.value=n.texture,e.transmissionSamplerSize.value.set(n.width,n.height),t.transmissionMap&&(e.transmissionMap.value=t.transmissionMap),e.thickness.value=t.thickness,t.thicknessMap&&(e.thicknessMap.value=t.thicknessMap),e.attenuationDistance.value=t.attenuationDistance,e.attenuationColor.value.copy(t.attenuationColor)),e.specularIntensity.value=t.specularIntensity,e.specularColor.value.copy(t.specularColor),t.specularIntensityMap&&(e.specularIntensityMap.value=t.specularIntensityMap),t.specularColorMap&&(e.specularColorMap.value=t.specularColorMap)}(e,i,a)):i.isMeshMatcapMaterial?(n(e,i),function(e,t){t.matcap&&(e.matcap.value=t.matcap)}(e,i)):i.isMeshDepthMaterial?n(e,i):i.isMeshDistanceMaterial?(n(e,i),function(e,t){e.referencePosition.value.copy(t.referencePosition),e.nearDistance.value=t.nearDistance,e.farDistance.value=t.farDistance}(e,i)):i.isMeshNormalMaterial?n(e,i):i.isLineBasicMaterial?(function(e,t){e.diffuse.value.copy(t.color),e.opacity.value=t.opacity}(e,i),i.isLineDashedMaterial&&function(e,t){e.dashSize.value=t.dashSize,e.totalSize.value=t.dashSize+t.gapSize,e.scale.value=t.scale}(e,i)):i.isPointsMaterial?function(e,t,n,i){let r;e.diffuse.value.copy(t.color),e.opacity.value=t.opacity,e.size.value=t.size*n,e.scale.value=.5*i,t.map&&(e.map.value=t.map),t.alphaMap&&(e.alphaMap.value=t.alphaMap),t.alphaTest>0&&(e.alphaTest.value=t.alphaTest),t.map?r=t.map:t.alphaMap&&(r=t.alphaMap),void 0!==r&&(!0===r.matrixAutoUpdate&&r.updateMatrix(),e.uvTransform.value.copy(r.matrix))}(e,i,r,s):i.isSpriteMaterial?function(e,t){let n;e.diffuse.value.copy(t.color),e.opacity.value=t.opacity,e.rotation.value=t.rotation,t.map&&(e.map.value=t.map),t.alphaMap&&(e.alphaMap.value=t.alphaMap),t.alphaTest>0&&(e.alphaTest.value=t.alphaTest),t.map?n=t.map:t.alphaMap&&(n=t.alphaMap),void 0!==n&&(!0===n.matrixAutoUpdate&&n.updateMatrix(),e.uvTransform.value.copy(n.matrix))}(e,i):i.isShadowMaterial?(e.color.value.copy(i.color),e.opacity.value=i.opacity):i.isShaderMaterial&&(i.uniformsNeedUpdate=!1)}}}function _D(e,t,n,i){let r={},s={},a=[],o=n.isWebGL2?e.getParameter(35375):0;function l(e,t,n){let i=e.value;if(void 0===n[t]){if("number"==typeof i)n[t]=i;else{let e=Array.isArray(i)?i:[i],r=[];for(let t=0;t<e.length;t++)r.push(e[t].clone());n[t]=r}return!0}if("number"==typeof i){if(n[t]!==i)return n[t]=i,!0}else{let e=Array.isArray(n[t])?n[t]:[n[t]],r=Array.isArray(i)?i:[i];for(let t=0;t<e.length;t++){let n=e[t];if(!1===n.equals(r[t]))return n.copy(r[t]),!0}}return!1}function u(e){let t={boundary:0,storage:0};return"number"==typeof e?(t.boundary=4,t.storage=4):e.isVector2?(t.boundary=8,t.storage=8):e.isVector3||e.isColor?(t.boundary=16,t.storage=12):e.isVector4?(t.boundary=16,t.storage=16):e.isMatrix3?(t.boundary=48,t.storage=48):e.isMatrix4?(t.boundary=64,t.storage=64):e.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",e),t}function c(t){let n=t.target;n.removeEventListener("dispose",c);let i=a.indexOf(n.__bindingPointIndex);a.splice(i,1),e.deleteBuffer(r[n.id]),delete r[n.id],delete s[n.id]}return{bind:function(e,t){let n=t.program;i.uniformBlockBinding(e,n)},update:function(n,h){let d=r[n.id];void 0===d&&(function(e){let t=e.uniforms,n=0,i=16,r=0;for(let s=0,a=t.length;s<a;s++){let e=t[s],a={boundary:0,storage:0},o=Array.isArray(e.value)?e.value:[e.value];for(let t=0,n=o.length;t<n;t++){let e=u(o[t]);a.boundary+=e.boundary,a.storage+=e.storage}if(e.__data=new Float32Array(a.storage/Float32Array.BYTES_PER_ELEMENT),e.__offset=n,s>0){r=n%i,0!==r&&i-r-a.boundary<0&&(n+=i-r,e.__offset=n)}n+=a.storage}r=n%i,r>0&&(n+=i-r),e.__size=n,e.__cache={}}(n),d=function(t){let n=function(){for(let e=0;e<o;e++)if(-1===a.indexOf(e))return a.push(e),e;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}();t.__bindingPointIndex=n;let i=e.createBuffer(),r=t.__size,s=t.usage;return e.bindBuffer(35345,i),e.bufferData(35345,r,s),e.bindBuffer(35345,null),e.bindBufferBase(35345,n,i),i}(n),r[n.id]=d,n.addEventListener("dispose",c));let p=h.program;i.updateUBOMapping(n,p);let f=t.render.frame;s[n.id]!==f&&(function(t){let n=r[t.id],i=t.uniforms,s=t.__cache;e.bindBuffer(35345,n);for(let r=0,a=i.length;r<a;r++){let t=i[r];if(!0===l(t,r,s)){let n=t.__offset,i=Array.isArray(t.value)?t.value:[t.value],r=0;for(let s=0;s<i.length;s++){let a=i[s],o=u(a);"number"==typeof a?(t.__data[0]=a,e.bufferSubData(35345,n+r,t.__data)):a.isMatrix3?(t.__data[0]=a.elements[0],t.__data[1]=a.elements[1],t.__data[2]=a.elements[2],t.__data[3]=a.elements[0],t.__data[4]=a.elements[3],t.__data[5]=a.elements[4],t.__data[6]=a.elements[5],t.__data[7]=a.elements[0],t.__data[8]=a.elements[6],t.__data[9]=a.elements[7],t.__data[10]=a.elements[8],t.__data[11]=a.elements[0]):(a.toArray(t.__data,r),r+=o.storage/Float32Array.BYTES_PER_ELEMENT)}e.bufferSubData(35345,n,t.__data)}}e.bindBuffer(35345,null)}(n),s[n.id]=f)},dispose:function(){for(let t in r)e.deleteBuffer(r[t]);a=[],r={},s={}}}}function SD(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.isWebGLRenderer=!0;let t,n=void 0!==e.canvas?e.canvas:function(){let e=fv("canvas");return e.style.display="block",e}(),i=void 0!==e.context?e.context:null,r=void 0===e.depth||e.depth,s=void 0===e.stencil||e.stencil,a=void 0!==e.antialias&&e.antialias,o=void 0===e.premultipliedAlpha||e.premultipliedAlpha,l=void 0!==e.preserveDrawingBuffer&&e.preserveDrawingBuffer,u=void 0!==e.powerPreference?e.powerPreference:"default",c=void 0!==e.failIfMajorPerformanceCaveat&&e.failIfMajorPerformanceCaveat;t=null!==i?i.getContextAttributes().alpha:void 0!==e.alpha&&e.alpha;let h=null,d=null,p=[],f=[];this.domElement=n,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.outputEncoding=zg,this.physicallyCorrectLights=!1,this.toneMapping=0,this.toneMappingExposure=1;let m=this,g=!1,v=0,y=0,x=null,b=-1,w=null,D=new Ov,_=new Ov,S=null,E=n.width,C=n.height,A=1,M=null,T=null,P=new Ov(0,0,E,C),F=new Ov(0,0,E,C),O=!1,I=new qx,k=!1,B=!1,R=null,L=new py,z=new lv,N=new Lv,j={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function U(){return null===x?A:1}let V,H,W,G,q,Y,X,Q,K,Z,J,$,ee,te,ne,ie,re,se,ae,oe,le,ue,ce,he,de=i;function pe(e,t){for(let i=0;i<e.length;i++){let r=e[i],s=n.getContext(r,t);if(null!==s)return s}return null}try{let e={alpha:!0,depth:r,stencil:s,antialias:a,premultipliedAlpha:o,preserveDrawingBuffer:l,powerPreference:u,failIfMajorPerformanceCaveat:c};if("setAttribute"in n&&n.setAttribute("data-engine","three.js r".concat(Bm)),n.addEventListener("webglcontextlost",ge,!1),n.addEventListener("webglcontextrestored",ve,!1),n.addEventListener("webglcontextcreationerror",ye,!1),null===de){let t=["webgl2","webgl","experimental-webgl"];if(!0===m.isWebGL1Renderer&&t.shift(),de=pe(t,e),null===de)throw pe(t)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}void 0===de.getShaderPrecisionFormat&&(de.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(Pe){throw console.error("THREE.WebGLRenderer: "+Pe.message),Pe}function fe(){V=new wb(de),H=new ib(de,V,e),V.init(H),ue=new mD(de,V,H),W=new pD(de,V,H),G=new Sb,q=new $w,Y=new fD(de,V,W,q,H,ue,G),X=new sb(m),Q=new bb(m),K=new Xx(de,H),ce=new tb(de,V,K,H),Z=new Db(de,K,G,ce),J=new Mb(de,Z,K,G),ae=new Ab(de,H,Y),ie=new rb(q),$=new Jw(m,X,Q,V,H,ce,ie),ee=new DD(m,q),te=new iD,ne=new uD(V,H),se=new eb(m,X,Q,W,J,t,o),re=new dD(m,J,H),he=new _D(de,G,H,W),oe=new nb(de,V,G,H),le=new _b(de,V,G,H),G.programs=$.programs,m.capabilities=H,m.extensions=V,m.properties=q,m.renderLists=te,m.shadowMap=re,m.state=W,m.info=G}fe();let me=new wD(m,de);function ge(e){e.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),g=!0}function ve(){console.log("THREE.WebGLRenderer: Context Restored."),g=!1;let e=G.autoReset,t=re.enabled,n=re.autoUpdate,i=re.needsUpdate,r=re.type;fe(),G.autoReset=e,re.enabled=t,re.autoUpdate=n,re.needsUpdate=i,re.type=r}function ye(e){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",e.statusMessage)}function xe(e){let t=e.target;t.removeEventListener("dispose",xe),function(e){(function(e){let t=q.get(e).programs;void 0!==t&&(t.forEach((function(e){$.releaseProgram(e)})),e.isShaderMaterial&&$.releaseShaderCache(e))})(e),q.remove(e)}(t)}this.xr=me,this.getContext=function(){return de},this.getContextAttributes=function(){return de.getContextAttributes()},this.forceContextLoss=function(){let e=V.get("WEBGL_lose_context");e&&e.loseContext()},this.forceContextRestore=function(){let e=V.get("WEBGL_lose_context");e&&e.restoreContext()},this.getPixelRatio=function(){return A},this.setPixelRatio=function(e){void 0!==e&&(A=e,this.setSize(E,C,!1))},this.getSize=function(e){return e.set(E,C)},this.setSize=function(e,t,i){me.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(E=e,C=t,n.width=Math.floor(e*A),n.height=Math.floor(t*A),!1!==i&&(n.style.width=e+"px",n.style.height=t+"px"),this.setViewport(0,0,e,t))},this.getDrawingBufferSize=function(e){return e.set(E*A,C*A).floor()},this.setDrawingBufferSize=function(e,t,i){E=e,C=t,A=i,n.width=Math.floor(e*i),n.height=Math.floor(t*i),this.setViewport(0,0,e,t)},this.getCurrentViewport=function(e){return e.copy(D)},this.getViewport=function(e){return e.copy(P)},this.setViewport=function(e,t,n,i){e.isVector4?P.set(e.x,e.y,e.z,e.w):P.set(e,t,n,i),W.viewport(D.copy(P).multiplyScalar(A).floor())},this.getScissor=function(e){return e.copy(F)},this.setScissor=function(e,t,n,i){e.isVector4?F.set(e.x,e.y,e.z,e.w):F.set(e,t,n,i),W.scissor(_.copy(F).multiplyScalar(A).floor())},this.getScissorTest=function(){return O},this.setScissorTest=function(e){W.setScissorTest(O=e)},this.setOpaqueSort=function(e){M=e},this.setTransparentSort=function(e){T=e},this.getClearColor=function(e){return e.copy(se.getClearColor())},this.setClearColor=function(){se.setClearColor.apply(se,arguments)},this.getClearAlpha=function(){return se.getClearAlpha()},this.setClearAlpha=function(){se.setClearAlpha.apply(se,arguments)},this.clear=function(){let e=0;(!(arguments.length>0&&void 0!==arguments[0])||arguments[0])&&(e|=16384),(!(arguments.length>1&&void 0!==arguments[1])||arguments[1])&&(e|=256),(!(arguments.length>2&&void 0!==arguments[2])||arguments[2])&&(e|=1024),de.clear(e)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){n.removeEventListener("webglcontextlost",ge,!1),n.removeEventListener("webglcontextrestored",ve,!1),n.removeEventListener("webglcontextcreationerror",ye,!1),te.dispose(),ne.dispose(),q.dispose(),X.dispose(),Q.dispose(),J.dispose(),ce.dispose(),he.dispose(),$.dispose(),me.dispose(),me.removeEventListener("sessionstart",we),me.removeEventListener("sessionend",De),R&&(R.dispose(),R=null),_e.stop()},this.renderBufferDirect=function(e,t,n,i,r,s){null===t&&(t=j);let a=r.isMesh&&r.matrixWorld.determinant()<0,o=function(e,t,n,i,r){!0!==t.isScene&&(t=j),Y.resetTextureUnits();let s=t.fog,a=i.isMeshStandardMaterial?t.environment:null,o=null===x?m.outputEncoding:!0===x.isXRRenderTarget?x.texture.encoding:zg,l=(i.isMeshStandardMaterial?Q:X).get(i.envMap||a),u=!0===i.vertexColors&&!!n.attributes.color&&4===n.attributes.color.itemSize,c=!!i.normalMap&&!!n.attributes.tangent,h=!!n.morphAttributes.position,p=!!n.morphAttributes.normal,f=!!n.morphAttributes.color,g=i.toneMapped?m.toneMapping:0,v=n.morphAttributes.position||n.morphAttributes.normal||n.morphAttributes.color,y=void 0!==v?v.length:0,D=q.get(i),_=d.state.lights;if(!0===k&&(!0===B||e!==w)){let t=e===w&&i.id===b;ie.setState(i,e,t)}let S=!1;i.version===D.__version?(D.needsLights&&D.lightsStateVersion!==_.state.version||D.outputEncoding!==o||r.isInstancedMesh&&!1===D.instancing||!r.isInstancedMesh&&!0===D.instancing||r.isSkinnedMesh&&!1===D.skinning||!r.isSkinnedMesh&&!0===D.skinning||D.envMap!==l||!0===i.fog&&D.fog!==s||void 0!==D.numClippingPlanes&&(D.numClippingPlanes!==ie.numPlanes||D.numIntersection!==ie.numIntersection)||D.vertexAlphas!==u||D.vertexTangents!==c||D.morphTargets!==h||D.morphNormals!==p||D.morphColors!==f||D.toneMapping!==g||!0===H.isWebGL2&&D.morphTargetsCount!==y)&&(S=!0):(S=!0,D.__version=i.version);let E=D.currentProgram;!0===S&&(E=Me(i,t,r));let M=!1,T=!1,P=!1,F=E.getUniforms(),O=D.uniforms;if(W.useProgram(E.program)&&(M=!0,T=!0,P=!0),i.id!==b&&(b=i.id,T=!0),M||w!==e){if(F.setValue(de,"projectionMatrix",e.projectionMatrix),H.logarithmicDepthBuffer&&F.setValue(de,"logDepthBufFC",2/(Math.log(e.far+1)/Math.LN2)),w!==e&&(w=e,T=!0,P=!0),i.isShaderMaterial||i.isMeshPhongMaterial||i.isMeshToonMaterial||i.isMeshStandardMaterial||i.envMap){let t=F.map.cameraPosition;void 0!==t&&t.setValue(de,N.setFromMatrixPosition(e.matrixWorld))}(i.isMeshPhongMaterial||i.isMeshToonMaterial||i.isMeshLambertMaterial||i.isMeshBasicMaterial||i.isMeshStandardMaterial||i.isShaderMaterial)&&F.setValue(de,"isOrthographic",!0===e.isOrthographicCamera),(i.isMeshPhongMaterial||i.isMeshToonMaterial||i.isMeshLambertMaterial||i.isMeshBasicMaterial||i.isMeshStandardMaterial||i.isShaderMaterial||i.isShadowMaterial||r.isSkinnedMesh)&&F.setValue(de,"viewMatrix",e.matrixWorldInverse)}if(r.isSkinnedMesh){F.setOptional(de,r,"bindMatrix"),F.setOptional(de,r,"bindMatrixInverse");let e=r.skeleton;e&&(H.floatVertexTextures?(null===e.boneTexture&&e.computeBoneTexture(),F.setValue(de,"boneTexture",e.boneTexture,Y),F.setValue(de,"boneTextureSize",e.boneTextureSize)):console.warn("THREE.WebGLRenderer: SkinnedMesh can only be used with WebGL 2. With WebGL 1 OES_texture_float and vertex textures support is required."))}let I=n.morphAttributes;if((void 0!==I.position||void 0!==I.normal||void 0!==I.color&&!0===H.isWebGL2)&&ae.update(r,n,i,E),(T||D.receiveShadow!==r.receiveShadow)&&(D.receiveShadow=r.receiveShadow,F.setValue(de,"receiveShadow",r.receiveShadow)),i.isMeshGouraudMaterial&&null!==i.envMap&&(O.envMap.value=l,O.flipEnvMap.value=l.isCubeTexture&&!1===l.isRenderTargetTexture?-1:1),T&&(F.setValue(de,"toneMappingExposure",m.toneMappingExposure),D.needsLights&&function(e,t){e.ambientLightColor.needsUpdate=t,e.lightProbe.needsUpdate=t,e.directionalLights.needsUpdate=t,e.directionalLightShadows.needsUpdate=t,e.pointLights.needsUpdate=t,e.pointLightShadows.needsUpdate=t,e.spotLights.needsUpdate=t,e.spotLightShadows.needsUpdate=t,e.rectAreaLights.needsUpdate=t,e.hemisphereLights.needsUpdate=t}(O,P),s&&!0===i.fog&&ee.refreshFogUniforms(O,s),ee.refreshMaterialUniforms(O,i,A,C,R),Ow.upload(de,D.uniformsList,O,Y)),i.isShaderMaterial&&!0===i.uniformsNeedUpdate&&(Ow.upload(de,D.uniformsList,O,Y),i.uniformsNeedUpdate=!1),i.isSpriteMaterial&&F.setValue(de,"center",r.center),F.setValue(de,"modelViewMatrix",r.modelViewMatrix),F.setValue(de,"normalMatrix",r.normalMatrix),F.setValue(de,"modelMatrix",r.matrixWorld),r.previousModelViewMatrix&&F.setValue(de,"previousModelViewMatrix",r.previousModelViewMatrix),e.previousProjectionMatrix&&F.setValue(de,"previousProjectionMatrix",e.previousProjectionMatrix),i.isShaderMaterial||i.isRawShaderMaterial){let e=i.uniformsGroups;for(let t=0,n=e.length;t<n;t++)if(H.isWebGL2){let n=e[t];he.update(n,E),he.bind(n,E)}else console.warn("THREE.WebGLRenderer: Uniform Buffer Objects can only be used with WebGL 2.")}return E}(e,t,n,i,r);W.setMaterial(i,a);let l=n.index,u=1;!0===i.wireframe&&(l=Z.getWireframeAttribute(n),u=2);let c=n.drawRange,h=n.attributes.position,p=c.start*u,f=(c.start+c.count)*u;null!==s&&(p=Math.max(p,s.start*u),f=Math.min(f,(s.start+s.count)*u)),null!==l?(p=Math.max(p,0),f=Math.min(f,l.count)):null!=h&&(p=Math.max(p,0),f=Math.min(f,h.count));let g=f-p;if(g<0||g===1/0)return;ce.setup(r,i,o,n,l);let v,y=oe;if(null!==l&&(v=K.get(l),y=le,y.setIndex(v)),r.isMesh)!0===i.wireframe?(W.setLineWidth(i.wireframeLinewidth*U()),y.setMode(1)):y.setMode(4);else if(r.isLine){let e=i.linewidth;void 0===e&&(e=1),W.setLineWidth(e*U()),r.isLineSegments?y.setMode(1):r.isLineLoop?y.setMode(2):y.setMode(3)}else r.isPoints?y.setMode(0):r.isSprite&&y.setMode(4);if(r.isInstancedMesh)y.renderInstances(p,g,r.count);else if(n.isInstancedBufferGeometry){let e=void 0!==n._maxInstanceCount?n._maxInstanceCount:1/0,t=Math.min(n.instanceCount,e);y.renderInstances(p,g,t)}else y.render(p,g)},this.compile=function(e,t){function n(e,t,n){!0===e.transparent&&2===e.side&&!1===e.forceSinglePass?(e.side=1,e.needsUpdate=!0,Me(e,t,n),e.side=0,e.needsUpdate=!0,Me(e,t,n),e.side=2):Me(e,t,n)}d=ne.get(e),d.init(),f.push(d),e.traverseVisible((function(e){e.isLight&&e.layers.test(t.layers)&&(d.pushLight(e),e.castShadow&&d.pushShadow(e))})),d.setupLights(m.physicallyCorrectLights),e.traverse((function(t){let i=t.material;if(i)if(Array.isArray(i))for(let r=0;r<i.length;r++){n(i[r],e,t)}else n(i,e,t)})),f.pop(),d=null};let be=null;function we(){_e.stop()}function De(){_e.start()}let _e=new Yx;function Se(e,t,n,i){if(!1===e.visible)return;if(e.layers.test(t.layers))if(e.isGroup)n=e.renderOrder;else if(e.isLOD)!0===e.autoUpdate&&e.update(t);else if(e.isLight)d.pushLight(e),e.castShadow&&d.pushShadow(e);else if(e.isSprite){if(!e.frustumCulled||I.intersectsSprite(e)){i&&N.setFromMatrixPosition(e.matrixWorld).applyMatrix4(L);let t=J.update(e),r=e.material;r.visible&&h.push(e,t,r,n,N.z,null)}}else if((e.isMesh||e.isLine||e.isPoints)&&(e.isSkinnedMesh&&e.skeleton.frame!==G.render.frame&&(e.skeleton.update(),e.skeleton.frame=G.render.frame),!e.frustumCulled||I.intersectsObject(e))){i&&N.setFromMatrixPosition(e.matrixWorld).applyMatrix4(L);let t=J.update(e),r=e.material;if(Array.isArray(r)){let i=t.groups;for(let s=0,a=i.length;s<a;s++){let a=i[s],o=r[a.materialIndex];o&&o.visible&&h.push(e,t,o,n,N.z,a)}}else r.visible&&h.push(e,t,r,n,N.z,null)}let r=e.children;for(let s=0,a=r.length;s<a;s++)Se(r[s],t,n,i)}function Ee(e,t,n,i){let r=e.opaque,s=e.transmissive,o=e.transparent;d.setupLightsView(n),!0===k&&ie.setGlobalState(m.clippingPlanes,n),s.length>0&&function(e,t,n){let i=H.isWebGL2;null===R&&(R=new Iv(1,1,{generateMipmaps:!0,type:V.has("EXT_color_buffer_half_float")?yg:mg,minFilter:fg,samples:i&&!0===a?4:0})),m.getDrawingBufferSize(z),i?R.setSize(z.x,z.y):R.setSize(rv(z.x),rv(z.y));let r=m.getRenderTarget();m.setRenderTarget(R),m.clear();let s=m.toneMapping;m.toneMapping=0,Ce(e,t,n),m.toneMapping=s,Y.updateMultisampleRenderTarget(R),Y.updateRenderTargetMipmap(R),m.setRenderTarget(r)}(r,t,n),i&&W.viewport(D.copy(i)),r.length>0&&Ce(r,t,n),s.length>0&&Ce(s,t,n),o.length>0&&Ce(o,t,n),W.buffers.depth.setTest(!0),W.buffers.depth.setMask(!0),W.buffers.color.setMask(!0),W.setPolygonOffset(!1)}function Ce(e,t,n){let i=!0===t.isScene?t.overrideMaterial:null;for(let r=0,s=e.length;r<s;r++){let s=e[r],a=s.object,o=s.geometry,l=null===i?s.material:i,u=s.group;a.layers.test(n.layers)&&Ae(a,t,n,o,l,u)}}function Ae(e,t,n,i,r,s){e.onBeforeRender(m,t,n,i,r,s),e.modelViewMatrix.multiplyMatrices(n.matrixWorldInverse,e.matrixWorld),e.normalMatrix.getNormalMatrix(e.modelViewMatrix),r.onBeforeRender(m,t,n,i,e,s),!0===r.transparent&&2===r.side&&!1===r.forceSinglePass?(r.side=1,r.needsUpdate=!0,m.renderBufferDirect(n,t,i,r,e,s),r.side=0,r.needsUpdate=!0,m.renderBufferDirect(n,t,i,r,e,s),r.side=2):m.renderBufferDirect(n,t,i,r,e,s),e.onAfterRender(m,t,n,i,r,s)}function Me(e,t,n){!0!==t.isScene&&(t=j);let i=q.get(e),r=d.state.lights,s=d.state.shadowsArray,a=r.state.version,o=$.getParameters(e,r.state,s,t,n),l=$.getProgramCacheKey(o),u=i.programs;i.environment=e.isMeshStandardMaterial?t.environment:null,i.fog=t.fog,i.envMap=(e.isMeshStandardMaterial?Q:X).get(e.envMap||i.environment),void 0===u&&(e.addEventListener("dispose",xe),u=new Map,i.programs=u);let c=u.get(l);if(void 0!==c){if(i.currentProgram===c&&i.lightsStateVersion===a)return Te(e,o),c}else o.uniforms=$.getUniforms(e),e.onBuild(n,o,m),e.onBeforeCompile(o,m),c=$.acquireProgram(o,l),u.set(l,c),i.uniforms=o.uniforms;let h=i.uniforms;(!e.isShaderMaterial&&!e.isRawShaderMaterial||!0===e.clipping)&&(h.clippingPlanes=ie.uniform),Te(e,o),i.needsLights=function(e){return e.isMeshLambertMaterial||e.isMeshToonMaterial||e.isMeshPhongMaterial||e.isMeshStandardMaterial||e.isShadowMaterial||e.isShaderMaterial&&!0===e.lights}(e),i.lightsStateVersion=a,i.needsLights&&(h.ambientLightColor.value=r.state.ambient,h.lightProbe.value=r.state.probe,h.directionalLights.value=r.state.directional,h.directionalLightShadows.value=r.state.directionalShadow,h.spotLights.value=r.state.spot,h.spotLightShadows.value=r.state.spotShadow,h.rectAreaLights.value=r.state.rectArea,h.ltc_1.value=r.state.rectAreaLTC1,h.ltc_2.value=r.state.rectAreaLTC2,h.pointLights.value=r.state.point,h.pointLightShadows.value=r.state.pointShadow,h.hemisphereLights.value=r.state.hemi,h.directionalShadowMap.value=r.state.directionalShadowMap,h.directionalShadowMatrix.value=r.state.directionalShadowMatrix,h.spotShadowMap.value=r.state.spotShadowMap,h.spotLightMatrix.value=r.state.spotLightMatrix,h.spotLightMap.value=r.state.spotLightMap,h.pointShadowMap.value=r.state.pointShadowMap,h.pointShadowMatrix.value=r.state.pointShadowMatrix);let p=c.getUniforms(),f=Ow.seqWithValue(p.seq,h);return i.currentProgram=c,i.uniformsList=f,c}function Te(e,t){let n=q.get(e);n.outputEncoding=t.outputEncoding,n.instancing=t.instancing,n.skinning=t.skinning,n.morphTargets=t.morphTargets,n.morphNormals=t.morphNormals,n.morphColors=t.morphColors,n.morphTargetsCount=t.morphTargetsCount,n.numClippingPlanes=t.numClippingPlanes,n.numIntersection=t.numClipIntersection,n.vertexAlphas=t.vertexAlphas,n.vertexTangents=t.vertexTangents,n.toneMapping=t.toneMapping}_e.setAnimationLoop((function(e){be&&be(e)})),typeof self<"u"&&_e.setContext(self),this.setAnimationLoop=function(e){be=e,me.setAnimationLoop(e),null===e?_e.stop():_e.start()},me.addEventListener("sessionstart",we),me.addEventListener("sessionend",De),this.render=function(e,t){if(void 0!==t&&!0!==t.isCamera)return void console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");if(!0===g)return;!0===e.matrixWorldAutoUpdate&&e.updateMatrixWorld(),null===t.parent&&!0===t.matrixWorldAutoUpdate&&t.updateMatrixWorld(),!0===me.enabled&&!0===me.isPresenting&&(!0===me.cameraAutoUpdate&&me.updateCamera(t),t=me.getCamera()),!0===e.isScene&&e.onBeforeRender(m,e,t,x),d=ne.get(e,f.length),d.init(),f.push(d),L.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),I.setFromProjectionMatrix(L),B=this.localClippingEnabled,k=ie.init(this.clippingPlanes,B),h=te.get(e,p.length),h.init(),p.push(h),Se(e,t,0,m.sortObjects),h.finish(),!0===m.sortObjects&&h.sort(M,T),!0===k&&ie.beginShadows();let n=d.state.shadowsArray;if(re.render(n,e,t),!0===k&&ie.endShadows(),!0===this.info.autoReset&&this.info.reset(),se.render(h,e),d.setupLights(m.physicallyCorrectLights),t.isArrayCamera){let n=t.cameras;for(let t=0,i=n.length;t<i;t++){let i=n[t];Ee(h,e,i,i.viewport)}}else Ee(h,e,t);null!==x&&(Y.updateMultisampleRenderTarget(x),Y.updateRenderTargetMipmap(x)),!0===e.isScene&&e.onAfterRender(m,e,t),ce.resetDefaultState(),b=-1,w=null,f.pop(),d=f.length>0?f[f.length-1]:null,p.pop(),h=p.length>0?p[p.length-1]:null},this.getActiveCubeFace=function(){return v},this.getActiveMipmapLevel=function(){return y},this.getRenderTarget=function(){return x},this.setRenderTargetTextures=function(e,t,n){q.get(e.texture).__webglTexture=t,q.get(e.depthTexture).__webglTexture=n;let i=q.get(e);i.__hasExternalTextures=!0,i.__hasExternalTextures&&(i.__autoAllocateDepthBuffer=void 0===n,i.__autoAllocateDepthBuffer||!0===V.has("WEBGL_multisampled_render_to_texture")&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),i.__useRenderToTexture=!1))},this.setRenderTargetFramebuffer=function(e,t){let n=q.get(e);n.__webglFramebuffer=t,n.__useDefaultFramebuffer=void 0===t},this.setRenderTarget=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;x=e,v=t,y=n;let i=!0,r=null,s=!1,a=!1;if(e){let n=q.get(e);void 0!==n.__useDefaultFramebuffer?(W.bindFramebuffer(36160,null),i=!1):void 0===n.__webglFramebuffer?Y.setupRenderTarget(e):n.__hasExternalTextures&&Y.rebindTextures(e,q.get(e.texture).__webglTexture,q.get(e.depthTexture).__webglTexture);let o=e.texture;(o.isData3DTexture||o.isDataArrayTexture||o.isCompressedArrayTexture)&&(a=!0);let l=q.get(e).__webglFramebuffer;e.isWebGLCubeRenderTarget?(r=l[t],s=!0):r=H.isWebGL2&&e.samples>0&&!1===Y.useMultisampledRTT(e)?q.get(e).__webglMultisampledFramebuffer:l,D.copy(e.viewport),_.copy(e.scissor),S=e.scissorTest}else D.copy(P).multiplyScalar(A).floor(),_.copy(F).multiplyScalar(A).floor(),S=O;if(W.bindFramebuffer(36160,r)&&H.drawBuffers&&i&&W.drawBuffers(e,r),W.viewport(D),W.scissor(_),W.setScissorTest(S),s){let i=q.get(e.texture);de.framebufferTexture2D(36160,36064,34069+t,i.__webglTexture,n)}else if(a){let i=q.get(e.texture),r=t||0;de.framebufferTextureLayer(36160,36064,i.__webglTexture,n||0,r)}b=-1},this.readRenderTargetPixels=function(e,t,n,i,r,s,a){if(!e||!e.isWebGLRenderTarget)return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let o=q.get(e).__webglFramebuffer;if(e.isWebGLCubeRenderTarget&&void 0!==a&&(o=o[a]),o){W.bindFramebuffer(36160,o);try{let a=e.texture,o=a.format,l=a.type;if(o!==bg&&ue.convert(o)!==de.getParameter(35739))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");let u=l===yg&&(V.has("EXT_color_buffer_half_float")||H.isWebGL2&&V.has("EXT_color_buffer_float"));if(l!==mg&&ue.convert(l)!==de.getParameter(35738)&&(l!==vg||!(H.isWebGL2||V.has("OES_texture_float")||V.has("WEBGL_color_buffer_float")))&&!u)return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");t>=0&&t<=e.width-i&&n>=0&&n<=e.height-r&&de.readPixels(t,n,i,r,ue.convert(o),ue.convert(l),s)}finally{let e=null!==x?q.get(x).__webglFramebuffer:null;W.bindFramebuffer(36160,e)}}},this.readRenderTargetPixelsAsync=async function(e,t,n,i,r,s,a){if(!e||!e.isWebGLRenderTarget)throw new Error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let o=q.get(e).__webglFramebuffer;if(e.isWebGLCubeRenderTarget&&void 0!==a&&(o=o[a]),o){let a=e.texture,l=a.format,u=a.type;if(t>=0&&t<=e.width-i&&n>=0&&n<=e.height-r){W.bindFramebuffer(de.FRAMEBUFFER,o);let e=de.createBuffer();de.bindBuffer(de.PIXEL_PACK_BUFFER,e),de.bufferData(de.PIXEL_PACK_BUFFER,s.byteLength,de.STREAM_READ),de.readPixels(t,n,i,r,ue.convert(l),ue.convert(u),0);let a=null!==x?q.get(x).__webglFramebuffer:null;W.bindFramebuffer(de.FRAMEBUFFER,a);let c=de.fenceSync(de.SYNC_GPU_COMMANDS_COMPLETE,0);return de.flush(),await function(e,t,n){return new Promise((function(i,r){setTimeout((function s(){switch(e.clientWaitSync(t,e.SYNC_FLUSH_COMMANDS_BIT,0)){case e.WAIT_FAILED:r();break;case e.TIMEOUT_EXPIRED:setTimeout(s,n);break;default:i()}}),n)}))}(de,c,4),de.bindBuffer(de.PIXEL_PACK_BUFFER,e),de.getBufferSubData(de.PIXEL_PACK_BUFFER,0,s),de.deleteBuffer(e),de.deleteSync(c),s}throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: requested read bounds are out of range.")}},this.copyFramebufferToTexture=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=Math.pow(2,-n),r=Math.floor(t.image.width*i),s=Math.floor(t.image.height*i);Y.setTexture2D(t,0),de.copyTexSubImage2D(3553,n,0,0,e.x,e.y,r,s),W.unbindTexture()},this.copyTextureToTexture=function(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=t.image.width,s=t.image.height,a=ue.convert(n.format),o=ue.convert(n.type);Y.setTexture2D(n,0),de.pixelStorei(37440,n.flipY),de.pixelStorei(37441,n.premultiplyAlpha),de.pixelStorei(3317,n.unpackAlignment),t.isDataTexture?de.texSubImage2D(3553,i,e.x,e.y,r,s,a,o,t.image.data):t.isCompressedTexture?de.compressedTexSubImage2D(3553,i,e.x,e.y,t.mipmaps[0].width,t.mipmaps[0].height,a,t.mipmaps[0].data):de.texSubImage2D(3553,i,e.x,e.y,a,o,t.image),0===i&&n.generateMipmaps&&de.generateMipmap(3553),W.unbindTexture()},this.copyTextureToTexture3D=function(e,t,n,i){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;if(m.isWebGL1Renderer)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");let s,a=e.max.x-e.min.x+1,o=e.max.y-e.min.y+1,l=e.max.z-e.min.z+1,u=ue.convert(i.format),c=ue.convert(i.type);if(i.isData3DTexture)Y.setTexture3D(i,0),s=32879;else{if(!i.isDataArrayTexture)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");Y.setTexture2DArray(i,0),s=35866}de.pixelStorei(37440,i.flipY),de.pixelStorei(37441,i.premultiplyAlpha),de.pixelStorei(3317,i.unpackAlignment);let h=de.getParameter(3314),d=de.getParameter(32878),p=de.getParameter(3316),f=de.getParameter(3315),g=de.getParameter(32877),v=n.isCompressedTexture?n.mipmaps[0]:n.image;de.pixelStorei(3314,v.width),de.pixelStorei(32878,v.height),de.pixelStorei(3316,e.min.x),de.pixelStorei(3315,e.min.y),de.pixelStorei(32877,e.min.z),n.isDataTexture||n.isData3DTexture?de.texSubImage3D(s,r,t.x,t.y,t.z,a,o,l,u,c,v.data):n.isCompressedArrayTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),de.compressedTexSubImage3D(s,r,t.x,t.y,t.z,a,o,l,u,v.data)):de.texSubImage3D(s,r,t.x,t.y,t.z,a,o,l,u,c,v),de.pixelStorei(3314,h),de.pixelStorei(32878,d),de.pixelStorei(3316,p),de.pixelStorei(3315,f),de.pixelStorei(32877,g),0===r&&i.generateMipmaps&&de.generateMipmap(s),W.unbindTexture()},this.initRenderTarget=function(e){void 0===q.get(e).__webglFramebuffer&&Y.setupRenderTarget(e)},this.initTexture=function(e){e.isCubeTexture?Y.setTextureCube(e,0):e.isData3DTexture?Y.setTexture3D(e,0):e.isDataArrayTexture||e.isCompressedArrayTexture?Y.setTexture2DArray(e,0):Y.setTexture2D(e,0),W.unbindTexture()},this.resetState=function(){v=0,y=0,x=null,W.reset(),ce.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}(class extends SD{}).prototype.isWebGL1Renderer=!0;var ED=class{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3;this.isFog=!0,this.name="",this.color=new Ev(e),this.near=t,this.far=n}clone(){return new ED(this.color,this.near,this.far)}toJSON(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}}},CD=class extends zy{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),null!==e.background&&(this.background=e.background.clone()),null!==e.environment&&(this.environment=e.environment.clone()),null!==e.fog&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,null!==e.overrideMaterial&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){let t=super.toJSON(e);return null!==this.fog&&(t.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(t.object.backgroundBlurriness=this.backgroundBlurriness),1!==this.backgroundIntensity&&(t.object.backgroundIntensity=this.backgroundIntensity),t}get autoUpdate(){return console.warn("THREE.Scene: autoUpdate was renamed to matrixWorldAutoUpdate in r144."),this.matrixWorldAutoUpdate}set autoUpdate(e){console.warn("THREE.Scene: autoUpdate was renamed to matrixWorldAutoUpdate in r144."),this.matrixWorldAutoUpdate=e}},AD=class{constructor(e,t){this.isInterleavedBuffer=!0,this.array=e,this.stride=t,this.count=void 0!==e?e.length/t:0,this.usage=Wg,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=Jg()}onUploadCallback(){}set needsUpdate(e){!0===e&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,t,n){e*=this.stride,n*=t.stride;for(let i=0,r=this.stride;i<r;i++)this.array[e+i]=t.array[n+i];return this}set(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.array.set(e,t),this}clone(e){void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=Jg()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);let t=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),n=new this.constructor(t,this.stride);return n.setUsage(this.usage),n}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=Jg()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}},MD=new Lv,TD=class{constructor(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=t,this.offset=n,this.normalized=i}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let t=0,n=this.data.count;t<n;t++)MD.fromBufferAttribute(this,t),MD.applyMatrix4(e),this.setXYZ(t,MD.x,MD.y,MD.z);return this}applyNormalMatrix(e){for(let t=0,n=this.count;t<n;t++)MD.fromBufferAttribute(this,t),MD.applyNormalMatrix(e),this.setXYZ(t,MD.x,MD.y,MD.z);return this}transformDirection(e){for(let t=0,n=this.count;t<n;t++)MD.fromBufferAttribute(this,t),MD.transformDirection(e),this.setXYZ(t,MD.x,MD.y,MD.z);return this}setX(e,t){return this.normalized&&(t=av(t,this.array)),this.data.array[e*this.data.stride+this.offset]=t,this}setY(e,t){return this.normalized&&(t=av(t,this.array)),this.data.array[e*this.data.stride+this.offset+1]=t,this}setZ(e,t){return this.normalized&&(t=av(t,this.array)),this.data.array[e*this.data.stride+this.offset+2]=t,this}setW(e,t){return this.normalized&&(t=av(t,this.array)),this.data.array[e*this.data.stride+this.offset+3]=t,this}getX(e){let t=this.data.array[e*this.data.stride+this.offset];return this.normalized&&(t=sv(t,this.array)),t}getY(e){let t=this.data.array[e*this.data.stride+this.offset+1];return this.normalized&&(t=sv(t,this.array)),t}getZ(e){let t=this.data.array[e*this.data.stride+this.offset+2];return this.normalized&&(t=sv(t,this.array)),t}getW(e){let t=this.data.array[e*this.data.stride+this.offset+3];return this.normalized&&(t=sv(t,this.array)),t}setXY(e,t,n){return e=e*this.data.stride+this.offset,this.normalized&&(t=av(t,this.array),n=av(n,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this}setXYZ(e,t,n,i){return e=e*this.data.stride+this.offset,this.normalized&&(t=av(t,this.array),n=av(n,this.array),i=av(i,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=i,this}setXYZW(e,t,n,i,r){return e=e*this.data.stride+this.offset,this.normalized&&(t=av(t,this.array),n=av(n,this.array),i=av(i,this.array),r=av(r,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=i,this.data.array[e+3]=r,this}clone(e){if(void 0===e){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");let e=[];for(let t=0;t<this.count;t++){let n=t*this.data.stride+this.offset;for(let t=0;t<this.itemSize;t++)e.push(this.data.array[n+t])}return new tx(new this.array.constructor(e),this.itemSize,this.normalized)}return void 0===e.interleavedBuffers&&(e.interleavedBuffers={}),void 0===e.interleavedBuffers[this.data.uuid]&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new TD(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(void 0===e){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");let e=[];for(let t=0;t<this.count;t++){let n=t*this.data.stride+this.offset;for(let t=0;t<this.itemSize;t++)e.push(this.data.array[n+t])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:e,normalized:this.normalized}}return void 0===e.interleavedBuffers&&(e.interleavedBuffers={}),void 0===e.interleavedBuffers[this.data.uuid]&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}},PD=class extends zy{constructor(){super(),this.isBone=!0,this.type="Bone"}},FD=class extends Fv{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;super(null,arguments.length>5?arguments[5]:void 0,arguments.length>6?arguments[6]:void 0,arguments.length>7?arguments[7]:void 0,arguments.length>8&&void 0!==arguments[8]?arguments[8]:ug,arguments.length>9&&void 0!==arguments[9]?arguments[9]:ug,arguments.length>3?arguments[3]:void 0,arguments.length>4?arguments[4]:void 0,arguments.length>10?arguments[10]:void 0,arguments.length>11?arguments[11]:void 0),this.isDataTexture=!0,this.image={data:e,width:t,height:n},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}},OD=new py,ID=new py,kD=class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];this.uuid=Jg(),this.bones=e.slice(0),this.boneInverses=t,this.boneMatrices=null,this.boneTexture=null,this.boneTextureSize=0,this.frame=-1,this.init()}init(){let e=this.bones,t=this.boneInverses;if(this.boneMatrices=new Float32Array(16*e.length),0===t.length)this.calculateInverses();else if(e.length!==t.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let e=0,t=this.bones.length;e<t;e++)this.boneInverses.push(new py)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,t=this.bones.length;e<t;e++){let t=new py;this.bones[e]&&t.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(t)}}pose(){for(let e=0,t=this.bones.length;e<t;e++){let t=this.bones[e];t&&t.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,t=this.bones.length;e<t;e++){let t=this.bones[e];t&&(t.parent&&t.parent.isBone?(t.matrix.copy(t.parent.matrixWorld).invert(),t.matrix.multiply(t.matrixWorld)):t.matrix.copy(t.matrixWorld),t.matrix.decompose(t.position,t.quaternion,t.scale))}}update(){let e=this.bones,t=this.boneInverses,n=this.boneMatrices,i=this.boneTexture;for(let r=0,s=e.length;r<s;r++){let i=e[r]?e[r].matrixWorld:ID;OD.multiplyMatrices(i,t[r]),OD.toArray(n,16*r)}null!==i&&(i.needsUpdate=!0)}clone(){return new kD(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(4*this.bones.length);e=iv(e),e=Math.max(e,4);let t=new Float32Array(e*e*4);t.set(this.boneMatrices);let n=new FD(t,e,e,bg,vg);return n.needsUpdate=!0,this.boneMatrices=t,this.boneTexture=n,this.boneTextureSize=e,this}getBoneByName(e){for(let t=0,n=this.bones.length;t<n;t++){let n=this.bones[t];if(n.name===e)return n}}dispose(){null!==this.boneTexture&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,t){this.uuid=e.uuid;for(let n=0,i=e.bones.length;n<i;n++){let i=e.bones[n],r=t[i];void 0===r&&(console.warn("THREE.Skeleton: No bone found with UUID:",i),r=new PD),this.bones.push(r),this.boneInverses.push((new py).fromArray(e.boneInverses[n]))}return this.init(),this}toJSON(){let e={metadata:{version:4.5,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;let t=this.bones,n=this.boneInverses;for(let i=0,r=t.length;i<r;i++){let r=t[i];e.bones.push(r.uuid);let s=n[i];e.boneInverses.push(s.toArray())}return e}},BD=class extends tx{constructor(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;super(e,t,n),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=i}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){let e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}},RD=new py,LD=new py,zD=[],ND=new py,jD=new Cx,UD=class extends Cx{constructor(e,t,n){super(e,t),this.isInstancedMesh=!0,this.instanceMatrix=new BD(new Float32Array(16*n),16),this.instanceColor=null,this.count=n,this.frustumCulled=!1;for(let i=0;i<n;i++)this.setMatrixAt(i,ND)}copy(e,t){return super.copy(e,t),this.instanceMatrix.copy(e.instanceMatrix),null!==e.instanceColor&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,this}getColorAt(e,t){t.fromArray(this.instanceColor.array,3*e)}getMatrixAt(e,t){t.fromArray(this.instanceMatrix.array,16*e)}raycast(e,t){let n=this.matrixWorld,i=this.count;if(jD.geometry=this.geometry,jD.material=this.material,void 0!==jD.material)for(let r=0;r<i;r++){this.getMatrixAt(r,RD),LD.multiplyMatrices(n,RD),jD.matrixWorld=LD,jD.raycast(e,zD);for(let e=0,n=zD.length;e<n;e++){let n=zD[e];n.instanceId=r,n.object=this,t.push(n)}zD.length=0}}setColorAt(e,t){null===this.instanceColor&&(this.instanceColor=new BD(new Float32Array(3*this.instanceMatrix.count),3)),t.toArray(this.instanceColor.array,3*e)}setMatrixAt(e,t){t.toArray(this.instanceMatrix.array,16*e)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"})}},VD=class extends Zy{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new Ev(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}},HD=new Lv,WD=new Lv,GD=new py,qD=new dy,YD=new ry,XD=class extends zy{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new dx,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new VD;super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=e.material,this.geometry=e.geometry,this}computeLineDistances(){let e=this.geometry;if(null===e.index){let t=e.attributes.position,n=[0];for(let e=1,i=t.count;e<i;e++)HD.fromBufferAttribute(t,e-1),WD.fromBufferAttribute(t,e),n[e]=n[e-1],n[e]+=HD.distanceTo(WD);e.setAttribute("lineDistance",new rx(n,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,t){let n=this.geometry,i=this.matrixWorld,r=e.params.Line.threshold,s=n.drawRange;if(null===n.boundingSphere&&n.computeBoundingSphere(),YD.copy(n.boundingSphere),YD.applyMatrix4(i),YD.radius+=r,!1===e.ray.intersectsSphere(YD))return;GD.copy(i).invert(),qD.copy(e.ray).applyMatrix4(GD);let a=r/((this.scale.x+this.scale.y+this.scale.z)/3),o=a*a,l=new Lv,u=new Lv,c=new Lv,h=new Lv,d=this.isLineSegments?2:1,p=n.index,f=n.attributes.position;if(null!==p){for(let n=Math.max(0,s.start),i=Math.min(p.count,s.start+s.count)-1;n<i;n+=d){let i=p.getX(n),r=p.getX(n+1);if(l.fromBufferAttribute(f,i),u.fromBufferAttribute(f,r),qD.distanceSqToSegment(l,u,h,c)>o)continue;h.applyMatrix4(this.matrixWorld);let s=e.ray.origin.distanceTo(h);s<e.near||s>e.far||t.push({distance:s,point:c.clone().applyMatrix4(this.matrixWorld),index:n,face:null,faceIndex:null,object:this})}}else{for(let n=Math.max(0,s.start),i=Math.min(f.count,s.start+s.count)-1;n<i;n+=d){if(l.fromBufferAttribute(f,n),u.fromBufferAttribute(f,n+1),qD.distanceSqToSegment(l,u,h,c)>o)continue;h.applyMatrix4(this.matrixWorld);let i=e.ray.origin.distanceTo(h);i<e.near||i>e.far||t.push({distance:i,point:c.clone().applyMatrix4(this.matrixWorld),index:n,face:null,faceIndex:null,object:this})}}}updateMorphTargets(){let e=this.geometry.morphAttributes,t=Object.keys(e);if(t.length>0){let n=e[t[0]];if(void 0!==n){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let e=0,t=n.length;e<t;e++){let t=n[e].name||String(e);this.morphTargetInfluences.push(0),this.morphTargetDictionary[t]=e}}}}},QD=new Lv,KD=new Lv,ZD=class extends XD{constructor(e,t){super(e,t),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){let e=this.geometry;if(null===e.index){let t=e.attributes.position,n=[];for(let e=0,i=t.count;e<i;e+=2)QD.fromBufferAttribute(t,e),KD.fromBufferAttribute(t,e+1),n[e]=0===e?0:n[e-1],n[e+1]=n[e]+QD.distanceTo(KD);e.setAttribute("lineDistance",new rx(n,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}},JD=class extends Fv{constructor(e,t,n,i,r,s,a,o,l){super(e,t,n,i,r,s,a,o,l),this.isVideoTexture=!0,this.minFilter=void 0!==s?s:dg,this.magFilter=void 0!==r?r:dg,this.generateMipmaps=!1;let u=this;"requestVideoFrameCallback"in e&&e.requestVideoFrameCallback((function t(){u.needsUpdate=!0,e.requestVideoFrameCallback(t)}))}clone(){return new this.constructor(this.image).copy(this)}update(){let e=this.image;"requestVideoFrameCallback"in e===!1&&e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}},$D=class extends Fv{constructor(e,t,n,i,r,s,a,o,l){super(e,t,n,i,r,s,a,o,l),this.isCanvasTexture=!0,this.needsUpdate=!0}},e_=class{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(e,t){let n=this.getUtoTmapping(e);return this.getPoint(n,t)}getPoints(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5,t=[];for(let n=0;n<=e;n++)t.push(this.getPoint(n/e));return t}getSpacedPoints(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5,t=[];for(let n=0;n<=e;n++)t.push(this.getPointAt(n/e));return t}getLength(){let e=this.getLengths();return e[e.length-1]}getLengths(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.arcLengthDivisions;if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;let t,n=[],i=this.getPoint(0),r=0;n.push(0);for(let s=1;s<=e;s++)t=this.getPoint(s/e),r+=t.distanceTo(i),n.push(r),i=t;return this.cacheArcLengths=n,n}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,t){let n,i=this.getLengths(),r=0,s=i.length;n=t||e*i[s-1];let a,o=0,l=s-1;for(;o<=l;)if(r=Math.floor(o+(l-o)/2),a=i[r]-n,a<0)o=r+1;else{if(!(a>0)){l=r;break}l=r-1}if(r=l,i[r]===n)return r/(s-1);let u=i[r];return(r+(n-u)/(i[r+1]-u))/(s-1)}getTangent(e,t){let n=e-1e-4,i=e+1e-4;n<0&&(n=0),i>1&&(i=1);let r=this.getPoint(n),s=this.getPoint(i),a=t||(r.isVector2?new lv:new Lv);return a.copy(s).sub(r).normalize(),a}getTangentAt(e,t){let n=this.getUtoTmapping(e);return this.getTangent(n,t)}computeFrenetFrames(e,t){let n=new Lv,i=[],r=[],s=[],a=new Lv,o=new py;for(let d=0;d<=e;d++){let t=d/e;i[d]=this.getTangentAt(t,new Lv)}r[0]=new Lv,s[0]=new Lv;let l=Number.MAX_VALUE,u=Math.abs(i[0].x),c=Math.abs(i[0].y),h=Math.abs(i[0].z);u<=l&&(l=u,n.set(1,0,0)),c<=l&&(l=c,n.set(0,1,0)),h<=l&&n.set(0,0,1),a.crossVectors(i[0],n).normalize(),r[0].crossVectors(i[0],a),s[0].crossVectors(i[0],r[0]);for(let d=1;d<=e;d++){if(r[d]=r[d-1].clone(),s[d]=s[d-1].clone(),a.crossVectors(i[d-1],i[d]),a.length()>Number.EPSILON){a.normalize();let e=Math.acos($g(i[d-1].dot(i[d]),-1,1));r[d].applyMatrix4(o.makeRotationAxis(a,e))}s[d].crossVectors(i[d],r[d])}if(!0===t){let t=Math.acos($g(r[0].dot(r[e]),-1,1));t/=e,i[0].dot(a.crossVectors(r[0],r[e]))>0&&(t=-t);for(let n=1;n<=e;n++)r[n].applyMatrix4(o.makeRotationAxis(i[n],t*n)),s[n].crossVectors(i[n],r[n])}return{tangents:i,normals:r,binormals:s}}clone(){return(new this.constructor).copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){let e={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}},t_=class extends e_{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:2*Math.PI,a=arguments.length>6&&void 0!==arguments[6]&&arguments[6],o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0;super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=e,this.aY=t,this.xRadius=n,this.yRadius=i,this.aStartAngle=r,this.aEndAngle=s,this.aClockwise=a,this.aRotation=o}getPoint(e,t){let n=t||new lv,i=2*Math.PI,r=this.aEndAngle-this.aStartAngle,s=Math.abs(r)<Number.EPSILON;for(;r<0;)r+=i;for(;r>i;)r-=i;r<Number.EPSILON&&(r=s?0:i),!0===this.aClockwise&&!s&&(r===i?r=-i:r-=i);let a=this.aStartAngle+e*r,o=this.aX+this.xRadius*Math.cos(a),l=this.aY+this.yRadius*Math.sin(a);if(0!==this.aRotation){let e=Math.cos(this.aRotation),t=Math.sin(this.aRotation),n=o-this.aX,i=l-this.aY;o=n*e-i*t+this.aX,l=n*t+i*e+this.aY}return n.set(o,l)}copy(e){return super.copy(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}toJSON(){let e=super.toJSON();return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}fromJSON(e){return super.fromJSON(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}};function n_(){let e=0,t=0,n=0,i=0;function r(r,s,a,o){e=r,t=a,n=-3*r+3*s-2*a-o,i=2*r-2*s+a+o}return{initCatmullRom:function(e,t,n,i,s){r(t,n,s*(n-e),s*(i-t))},initNonuniformCatmullRom:function(e,t,n,i,s,a,o){let l=(t-e)/s-(n-e)/(s+a)+(n-t)/a,u=(n-t)/a-(i-t)/(a+o)+(i-n)/o;l*=a,u*=a,r(t,n,l,u)},calc:function(r){let s=r*r;return e+t*r+n*s+i*(s*r)}}}var i_=new Lv,r_=new n_,s_=new n_,a_=new n_;function o_(e,t,n,i,r){let s=.5*(i-t),a=.5*(r-n),o=e*e;return(2*n-2*i+s+a)*(e*o)+(-3*n+3*i-2*s-a)*o+s*e+n}function l_(e,t,n,i){return function(e,t){let n=1-e;return n*n*t}(e,t)+function(e,t){return 2*(1-e)*e*t}(e,n)+function(e,t){return e*e*t}(e,i)}function u_(e,t,n,i,r){return function(e,t){let n=1-e;return n*n*n*t}(e,t)+function(e,t){let n=1-e;return 3*n*n*e*t}(e,n)+function(e,t){return 3*(1-e)*e*e*t}(e,i)+function(e,t){return e*e*e*t}(e,r)}var c_=class extends e_{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new lv,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new lv,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new lv,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new lv;super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=e,this.v1=t,this.v2=n,this.v3=i}getPoint(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new lv,n=this.v0,i=this.v1,r=this.v2,s=this.v3;return t.set(u_(e,n.x,i.x,r.x,s.x),u_(e,n.y,i.y,r.y,s.y)),t}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){let e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}},h_=class extends e_{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Lv,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Lv,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Lv,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new Lv;super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=e,this.v1=t,this.v2=n,this.v3=i}getPoint(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Lv,n=this.v0,i=this.v1,r=this.v2,s=this.v3;return t.set(u_(e,n.x,i.x,r.x,s.x),u_(e,n.y,i.y,r.y,s.y),u_(e,n.z,i.z,r.z,s.z)),t}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){let e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}},d_=class extends e_{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new lv,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new lv;super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=e,this.v2=t}getPoint(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new lv;return 1===e?t.copy(this.v2):(t.copy(this.v2).sub(this.v1),t.multiplyScalar(e).add(this.v1)),t}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t){let n=t||new lv;return n.copy(this.v2).sub(this.v1).normalize(),n}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){let e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}},p_=class extends e_{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Lv,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Lv;super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=e,this.v2=t}getPoint(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Lv;return 1===e?t.copy(this.v2):(t.copy(this.v2).sub(this.v1),t.multiplyScalar(e).add(this.v1)),t}getPointAt(e,t){return this.getPoint(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){let e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}},f_=class extends e_{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new lv,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new lv,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new lv;super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=e,this.v1=t,this.v2=n}getPoint(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new lv,n=this.v0,i=this.v1,r=this.v2;return t.set(l_(e,n.x,i.x,r.x),l_(e,n.y,i.y,r.y)),t}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){let e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}},m_=class extends e_{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=e}getPoint(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new lv,n=this.points,i=(n.length-1)*e,r=Math.floor(i),s=i-r,a=n[0===r?r:r-1],o=n[r],l=n[r>n.length-2?n.length-1:r+1],u=n[r>n.length-3?n.length-1:r+2];return t.set(o_(s,a.x,o.x,l.x,u.x),o_(s,a.y,o.y,l.y,u.y)),t}copy(e){super.copy(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){let n=e.points[t];this.points.push(n.clone())}return this}toJSON(){let e=super.toJSON();e.points=[];for(let t=0,n=this.points.length;t<n;t++){let n=this.points[t];e.points.push(n.toArray())}return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){let n=e.points[t];this.points.push((new lv).fromArray(n))}return this}},g_=Object.freeze({__proto__:null,ArcCurve:class extends t_{constructor(e,t,n,i,r,s){super(e,t,n,n,i,r,s),this.isArcCurve=!0,this.type="ArcCurve"}},CatmullRomCurve3:class extends e_{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"centripetal",i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5;super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=e,this.closed=t,this.curveType=n,this.tension=i}getPoint(e){let t,n,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Lv,r=this.points,s=r.length,a=(s-(this.closed?0:1))*e,o=Math.floor(a),l=a-o;this.closed?o+=o>0?0:(Math.floor(Math.abs(o)/s)+1)*s:0===l&&o===s-1&&(o=s-2,l=1),this.closed||o>0?t=r[(o-1)%s]:(i_.subVectors(r[0],r[1]).add(r[0]),t=i_);let u=r[o%s],c=r[(o+1)%s];if(this.closed||o+2<s?n=r[(o+2)%s]:(i_.subVectors(r[s-1],r[s-2]).add(r[s-1]),n=i_),"centripetal"===this.curveType||"chordal"===this.curveType){let e="chordal"===this.curveType?.5:.25,i=Math.pow(t.distanceToSquared(u),e),r=Math.pow(u.distanceToSquared(c),e),s=Math.pow(c.distanceToSquared(n),e);r<1e-4&&(r=1),i<1e-4&&(i=r),s<1e-4&&(s=r),r_.initNonuniformCatmullRom(t.x,u.x,c.x,n.x,i,r,s),s_.initNonuniformCatmullRom(t.y,u.y,c.y,n.y,i,r,s),a_.initNonuniformCatmullRom(t.z,u.z,c.z,n.z,i,r,s)}else"catmullrom"===this.curveType&&(r_.initCatmullRom(t.x,u.x,c.x,n.x,this.tension),s_.initCatmullRom(t.y,u.y,c.y,n.y,this.tension),a_.initCatmullRom(t.z,u.z,c.z,n.z,this.tension));return i.set(r_.calc(l),s_.calc(l),a_.calc(l)),i}copy(e){super.copy(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){let n=e.points[t];this.points.push(n.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){let e=super.toJSON();e.points=[];for(let t=0,n=this.points.length;t<n;t++){let n=this.points[t];e.points.push(n.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){let n=e.points[t];this.points.push((new Lv).fromArray(n))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}},CubicBezierCurve:c_,CubicBezierCurve3:h_,EllipseCurve:t_,LineCurve:d_,LineCurve3:p_,QuadraticBezierCurve:f_,QuadraticBezierCurve3:class extends e_{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Lv,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Lv,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Lv;super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=e,this.v1=t,this.v2=n}getPoint(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Lv,n=this.v0,i=this.v1,r=this.v2;return t.set(l_(e,n.x,i.x,r.x),l_(e,n.y,i.y,r.y),l_(e,n.z,i.z,r.z)),t}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){let e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}},SplineCurve:m_}),v_=class extends e_{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(e){this.curves.push(e)}closePath(){let e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);e.equals(t)||this.curves.push(new d_(t,e))}getPoint(e,t){let n=e*this.getLength(),i=this.getCurveLengths(),r=0;for(;r<i.length;){if(i[r]>=n){let e=i[r]-n,s=this.curves[r],a=s.getLength(),o=0===a?0:1-e/a;return s.getPointAt(o,t)}r++}return null}getLength(){let e=this.getCurveLengths();return e[e.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;let e=[],t=0;for(let n=0,i=this.curves.length;n<i;n++)t+=this.curves[n].getLength(),e.push(t);return this.cacheLengths=e,e}getSpacedPoints(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:40,t=[];for(let n=0;n<=e;n++)t.push(this.getPoint(n/e));return this.autoClose&&t.push(t[0]),t}getPoints(){let e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:12,n=[];for(let i=0,r=this.curves;i<r.length;i++){let s=r[i],a=s.isEllipseCurve?2*t:s.isLineCurve||s.isLineCurve3?1:s.isSplineCurve?t*s.points.length:t,o=s.getPoints(a);for(let t=0;t<o.length;t++){let i=o[t];e&&e.equals(i)||(n.push(i),e=i)}}return this.autoClose&&n.length>1&&!n[n.length-1].equals(n[0])&&n.push(n[0]),n}copy(e){super.copy(e),this.curves=[];for(let t=0,n=e.curves.length;t<n;t++){let n=e.curves[t];this.curves.push(n.clone())}return this.autoClose=e.autoClose,this}toJSON(){let e=super.toJSON();e.autoClose=this.autoClose,e.curves=[];for(let t=0,n=this.curves.length;t<n;t++){let n=this.curves[t];e.curves.push(n.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.autoClose=e.autoClose,this.curves=[];for(let t=0,n=e.curves.length;t<n;t++){let n=e.curves[t];this.curves.push((new g_[n.type]).fromJSON(n))}return this}},y_=class extends v_{constructor(e){super(),this.type="Path",this.currentPoint=new lv,e&&this.setFromPoints(e)}setFromPoints(e){this.moveTo(e[0].x,e[0].y);for(let t=1,n=e.length;t<n;t++)this.lineTo(e[t].x,e[t].y);return this}moveTo(e,t){return this.currentPoint.set(e,t),this}lineTo(e,t){let n=new d_(this.currentPoint.clone(),new lv(e,t));return this.curves.push(n),this.currentPoint.set(e,t),this}quadraticCurveTo(e,t,n,i){let r=new f_(this.currentPoint.clone(),new lv(e,t),new lv(n,i));return this.curves.push(r),this.currentPoint.set(n,i),this}bezierCurveTo(e,t,n,i,r,s){let a=new c_(this.currentPoint.clone(),new lv(e,t),new lv(n,i),new lv(r,s));return this.curves.push(a),this.currentPoint.set(r,s),this}splineThru(e){let t=[this.currentPoint.clone()].concat(e),n=new m_(t);return this.curves.push(n),this.currentPoint.copy(e[e.length-1]),this}arc(e,t,n,i,r,s){let a=this.currentPoint.x,o=this.currentPoint.y;return this.absarc(e+a,t+o,n,i,r,s),this}absarc(e,t,n,i,r,s){return this.absellipse(e,t,n,n,i,r,s),this}ellipse(e,t,n,i,r,s,a,o){let l=this.currentPoint.x,u=this.currentPoint.y;return this.absellipse(e+l,t+u,n,i,r,s,a,o),this}absellipse(e,t,n,i,r,s,a,o){let l=new t_(e,t,n,i,r,s,a,o);if(this.curves.length>0){let e=l.getPoint(0);e.equals(this.currentPoint)||this.lineTo(e.x,e.y)}this.curves.push(l);let u=l.getPoint(1);return this.currentPoint.copy(u),this}copy(e){return super.copy(e),this.currentPoint.copy(e.currentPoint),this}toJSON(){let e=super.toJSON();return e.currentPoint=this.currentPoint.toArray(),e}fromJSON(e){return super.fromJSON(e),this.currentPoint.fromArray(e.currentPoint),this}},x_=class extends dx{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[new lv(0,-.5),new lv(.5,0),new lv(0,.5)],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:12,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2*Math.PI;super(),this.type="LatheGeometry",this.parameters={points:e,segments:t,phiStart:n,phiLength:i},t=Math.floor(t),i=$g(i,0,2*Math.PI);let r=[],s=[],a=[],o=[],l=[],u=1/t,c=new Lv,h=new lv,d=new Lv,p=new Lv,f=new Lv,m=0,g=0;for(let v=0;v<=e.length-1;v++)switch(v){case 0:m=e[v+1].x-e[v].x,g=e[v+1].y-e[v].y,d.x=1*g,d.y=-m,d.z=0*g,f.copy(d),d.normalize(),o.push(d.x,d.y,d.z);break;case e.length-1:o.push(f.x,f.y,f.z);break;default:m=e[v+1].x-e[v].x,g=e[v+1].y-e[v].y,d.x=1*g,d.y=-m,d.z=0*g,p.copy(d),d.x+=f.x,d.y+=f.y,d.z+=f.z,d.normalize(),o.push(d.x,d.y,d.z),f.copy(p)}for(let v=0;v<=t;v++){let r=n+v*u*i,d=Math.sin(r),p=Math.cos(r);for(let n=0;n<=e.length-1;n++){c.x=e[n].x*d,c.y=e[n].y,c.z=e[n].x*p,s.push(c.x,c.y,c.z),h.x=v/t,h.y=n/(e.length-1),a.push(h.x,h.y);let i=o[3*n+0]*d,r=o[3*n+1],u=o[3*n+0]*p;l.push(i,r,u)}}for(let v=0;v<t;v++)for(let t=0;t<e.length-1;t++){let n=t+v*e.length,i=n,s=n+e.length,a=n+e.length+1,o=n+1;r.push(i,s,o),r.push(a,o,s)}this.setIndex(r),this.setAttribute("position",new rx(s,3)),this.setAttribute("uv",new rx(a,2)),this.setAttribute("normal",new rx(l,3))}static fromJSON(e){return new x_(e.points,e.segments,e.phiStart,e.phiLength)}},b_=class extends dx{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:32,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,s=arguments.length>5&&void 0!==arguments[5]&&arguments[5],a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:2*Math.PI;super(),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:n,radialSegments:i,heightSegments:r,openEnded:s,thetaStart:a,thetaLength:o};let l=this;i=Math.floor(i),r=Math.floor(r);let u=[],c=[],h=[],d=[],p=0,f=[],m=n/2,g=0;function v(n){let r=p,s=new lv,f=new Lv,v=0,y=!0===n?e:t,x=!0===n?1:-1;for(let e=1;e<=i;e++)c.push(0,m*x,0),h.push(0,x,0),d.push(.5,.5),p++;let b=p;for(let e=0;e<=i;e++){let t=e/i*o+a,n=Math.cos(t),r=Math.sin(t);f.x=y*r,f.y=m*x,f.z=y*n,c.push(f.x,f.y,f.z),h.push(0,x,0),s.x=.5*n+.5,s.y=.5*r*x+.5,d.push(s.x,s.y),p++}for(let e=0;e<i;e++){let t=r+e,i=b+e;!0===n?u.push(i,i+1,t):u.push(i+1,i,t),v+=3}l.addGroup(g,v,!0===n?1:2),g+=v}(function(){let s=new Lv,v=new Lv,y=0,x=(t-e)/n;for(let l=0;l<=r;l++){let u=[],g=l/r,y=g*(t-e)+e;for(let e=0;e<=i;e++){let t=e/i,r=t*o+a,l=Math.sin(r),f=Math.cos(r);v.x=y*l,v.y=-g*n+m,v.z=y*f,c.push(v.x,v.y,v.z),s.set(l,x,f).normalize(),h.push(s.x,s.y,s.z),d.push(t,1-g),u.push(p++)}f.push(u)}for(let e=0;e<i;e++)for(let t=0;t<r;t++){let n=f[t][e],i=f[t+1][e],r=f[t+1][e+1],s=f[t][e+1];u.push(n,i,s),u.push(i,r,s),y+=6}l.addGroup(g,y,0),g+=y})(),!1===s&&(e>0&&v(!0),t>0&&v(!1)),this.setIndex(u),this.setAttribute("position",new rx(c,3)),this.setAttribute("normal",new rx(h,3)),this.setAttribute("uv",new rx(d,2))}static fromJSON(e){return new b_(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}},w_=class extends b_{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:32,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,r=arguments.length>4&&void 0!==arguments[4]&&arguments[4],s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:2*Math.PI;super(0,e,t,n,i,r,s,a),this.type="ConeGeometry",this.parameters={radius:e,height:t,radialSegments:n,heightSegments:i,openEnded:r,thetaStart:s,thetaLength:a}}static fromJSON(e){return new w_(e.radius,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}},D_=class extends dx{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;super(),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:t,radius:n,detail:i};let r=[],s=[];function a(e,t,n,i){let r=i+1,s=[];for(let a=0;a<=r;a++){s[a]=[];let i=e.clone().lerp(n,a/r),o=t.clone().lerp(n,a/r),l=r-a;for(let e=0;e<=l;e++)s[a][e]=0===e&&a===r?i:i.clone().lerp(o,e/l)}for(let a=0;a<r;a++)for(let e=0;e<2*(r-a)-1;e++){let t=Math.floor(e/2);e%2===0?(o(s[a][t+1]),o(s[a+1][t]),o(s[a][t])):(o(s[a][t+1]),o(s[a+1][t+1]),o(s[a+1][t]))}}function o(e){r.push(e.x,e.y,e.z)}function l(t,n){let i=3*t;n.x=e[i+0],n.y=e[i+1],n.z=e[i+2]}function u(e,t,n,i){i<0&&1===e.x&&(s[t]=e.x-1),0===n.x&&0===n.z&&(s[t]=i/2/Math.PI+.5)}function c(e){return Math.atan2(e.z,-e.x)}function h(e){return Math.atan2(-e.y,Math.sqrt(e.x*e.x+e.z*e.z))}(function(e){let n=new Lv,i=new Lv,r=new Lv;for(let s=0;s<t.length;s+=3)l(t[s+0],n),l(t[s+1],i),l(t[s+2],r),a(n,i,r,e)})(i),function(e){let t=new Lv;for(let n=0;n<r.length;n+=3)t.x=r[n+0],t.y=r[n+1],t.z=r[n+2],t.normalize().multiplyScalar(e),r[n+0]=t.x,r[n+1]=t.y,r[n+2]=t.z}(n),function(){let e=new Lv;for(let t=0;t<r.length;t+=3){e.x=r[t+0],e.y=r[t+1],e.z=r[t+2];let n=c(e)/2/Math.PI+.5,i=h(e)/Math.PI+.5;s.push(n,1-i)}(function(){let e=new Lv,t=new Lv,n=new Lv,i=new Lv,a=new lv,o=new lv,l=new lv;for(let h=0,d=0;h<r.length;h+=9,d+=6){e.set(r[h+0],r[h+1],r[h+2]),t.set(r[h+3],r[h+4],r[h+5]),n.set(r[h+6],r[h+7],r[h+8]),a.set(s[d+0],s[d+1]),o.set(s[d+2],s[d+3]),l.set(s[d+4],s[d+5]),i.copy(e).add(t).add(n).divideScalar(3);let p=c(i);u(a,d+0,e,p),u(o,d+2,t,p),u(l,d+4,n,p)}})(),function(){for(let e=0;e<s.length;e+=6){let t=s[e+0],n=s[e+2],i=s[e+4],r=Math.max(t,n,i),a=Math.min(t,n,i);r>.9&&a<.1&&(t<.2&&(s[e+0]+=1),n<.2&&(s[e+2]+=1),i<.2&&(s[e+4]+=1))}}()}(),this.setAttribute("position",new rx(r,3)),this.setAttribute("normal",new rx(r.slice(),3)),this.setAttribute("uv",new rx(s,2)),0===i?this.computeVertexNormals():this.normalizeNormals()}static fromJSON(e){return new D_(e.vertices,e.indices,e.radius,e.details)}},__=class extends D_{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=(1+Math.sqrt(5))/2,i=1/n;super([-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-i,-n,0,-i,n,0,i,-n,0,i,n,-i,-n,0,-i,n,0,i,-n,0,i,n,0,-n,0,-i,n,0,-i,-n,0,i,n,0,i],[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],e,t),this.type="DodecahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new __(e.radius,e.detail)}},S_=class extends y_{constructor(e){super(e),this.uuid=Jg(),this.type="Shape",this.holes=[]}getPointsHoles(e){let t=[];for(let n=0,i=this.holes.length;n<i;n++)t[n]=this.holes[n].getPoints(e);return t}extractPoints(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}copy(e){super.copy(e),this.holes=[];for(let t=0,n=e.holes.length;t<n;t++){let n=e.holes[t];this.holes.push(n.clone())}return this}toJSON(){let e=super.toJSON();e.uuid=this.uuid,e.holes=[];for(let t=0,n=this.holes.length;t<n;t++){let n=this.holes[t];e.holes.push(n.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.uuid=e.uuid,this.holes=[];for(let t=0,n=e.holes.length;t<n;t++){let n=e.holes[t];this.holes.push((new y_).fromJSON(n))}return this}},E_=function(e,t){let n,i,r,s,a,o,l,u=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2,c=t&&t.length,h=c?t[0]*u:e.length,d=C_(e,0,h,u,!0),p=[];if(!d||d.next===d.prev)return p;if(c&&(d=function(e,t,n,i){let r,s,a,o,l,u=[];for(r=0,s=t.length;r<s;r++)a=t[r]*i,o=r<s-1?t[r+1]*i:e.length,l=C_(e,a,o,i,!1),l===l.next&&(l.steiner=!0),u.push(L_(l));for(u.sort(I_),r=0;r<u.length;r++)n=k_(u[r],n);return n}(e,t,d,u)),e.length>80*u){n=r=e[0],i=s=e[1];for(let t=u;t<h;t+=u)a=e[t],o=e[t+1],a<n&&(n=a),o<i&&(i=o),a>r&&(r=a),o>s&&(s=o);l=Math.max(r-n,s-i),l=0!==l?32767/l:0}return M_(d,p,u,n,i,l,0),p};function C_(e,t,n,i,r){let s,a;if(r===function(e,t,n,i){let r=0;for(let s=t,a=n-i;s<n;s+=i)r+=(e[a]-e[s])*(e[s+1]+e[a+1]),a=s;return r}(e,t,n,i)>0)for(s=t;s<n;s+=i)a=Y_(s,e[s],e[s+1],a);else for(s=n-i;s>=t;s-=i)a=Y_(s,e[s],e[s+1],a);return a&&U_(a,a.next)&&(X_(a),a=a.next),a}function A_(e,t){if(!e)return e;t||(t=e);let n,i=e;do{if(n=!1,i.steiner||!U_(i,i.next)&&0!==j_(i.prev,i,i.next))i=i.next;else{if(X_(i),i=t=i.prev,i===i.next)break;n=!0}}while(n||i!==t);return t}function M_(e,t,n,i,r,s,a){if(!e)return;!a&&s&&function(e,t,n,i){let r=e;do{0===r.z&&(r.z=R_(r.x,r.y,t,n,i)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next}while(r!==e);r.prevZ.nextZ=null,r.prevZ=null,function(e){let t,n,i,r,s,a,o,l,u=1;do{for(n=e,e=null,s=null,a=0;n;){for(a++,i=n,o=0,t=0;t<u&&(o++,i=i.nextZ,i);t++);for(l=u;o>0||l>0&&i;)0!==o&&(0===l||!i||n.z<=i.z)?(r=n,n=n.nextZ,o--):(r=i,i=i.nextZ,l--),s?s.nextZ=r:e=r,r.prevZ=s,s=r;n=i}s.nextZ=null,u*=2}while(a>1)}(r)}(e,i,r,s);let o,l,u=e;for(;e.prev!==e.next;)if(o=e.prev,l=e.next,s?P_(e,i,r,s):T_(e))t.push(o.i/n|0),t.push(e.i/n|0),t.push(l.i/n|0),X_(e),e=l.next,u=l.next;else if((e=l)===u){a?1===a?M_(e=F_(A_(e),t,n),t,n,i,r,s,2):2===a&&O_(e,t,n,i,r,s):M_(A_(e),t,n,i,r,s,1);break}}function T_(e){let t=e.prev,n=e,i=e.next;if(j_(t,n,i)>=0)return!1;let r=t.x,s=n.x,a=i.x,o=t.y,l=n.y,u=i.y,c=r<s?r<a?r:a:s<a?s:a,h=o<l?o<u?o:u:l<u?l:u,d=r>s?r>a?r:a:s>a?s:a,p=o>l?o>u?o:u:l>u?l:u,f=i.next;for(;f!==t;){if(f.x>=c&&f.x<=d&&f.y>=h&&f.y<=p&&z_(r,o,s,l,a,u,f.x,f.y)&&j_(f.prev,f,f.next)>=0)return!1;f=f.next}return!0}function P_(e,t,n,i){let r=e.prev,s=e,a=e.next;if(j_(r,s,a)>=0)return!1;let o=r.x,l=s.x,u=a.x,c=r.y,h=s.y,d=a.y,p=o<l?o<u?o:u:l<u?l:u,f=c<h?c<d?c:d:h<d?h:d,m=o>l?o>u?o:u:l>u?l:u,g=c>h?c>d?c:d:h>d?h:d,v=R_(p,f,t,n,i),y=R_(m,g,t,n,i),x=e.prevZ,b=e.nextZ;for(;x&&x.z>=v&&b&&b.z<=y;){if(x.x>=p&&x.x<=m&&x.y>=f&&x.y<=g&&x!==r&&x!==a&&z_(o,c,l,h,u,d,x.x,x.y)&&j_(x.prev,x,x.next)>=0||(x=x.prevZ,b.x>=p&&b.x<=m&&b.y>=f&&b.y<=g&&b!==r&&b!==a&&z_(o,c,l,h,u,d,b.x,b.y)&&j_(b.prev,b,b.next)>=0))return!1;b=b.nextZ}for(;x&&x.z>=v;){if(x.x>=p&&x.x<=m&&x.y>=f&&x.y<=g&&x!==r&&x!==a&&z_(o,c,l,h,u,d,x.x,x.y)&&j_(x.prev,x,x.next)>=0)return!1;x=x.prevZ}for(;b&&b.z<=y;){if(b.x>=p&&b.x<=m&&b.y>=f&&b.y<=g&&b!==r&&b!==a&&z_(o,c,l,h,u,d,b.x,b.y)&&j_(b.prev,b,b.next)>=0)return!1;b=b.nextZ}return!0}function F_(e,t,n){let i=e;do{let r=i.prev,s=i.next.next;!U_(r,s)&&V_(r,i,i.next,s)&&G_(r,s)&&G_(s,r)&&(t.push(r.i/n|0),t.push(i.i/n|0),t.push(s.i/n|0),X_(i),X_(i.next),i=e=s),i=i.next}while(i!==e);return A_(i)}function O_(e,t,n,i,r,s){let a=e;do{let e=a.next.next;for(;e!==a.prev;){if(a.i!==e.i&&N_(a,e)){let o=q_(a,e);return a=A_(a,a.next),o=A_(o,o.next),M_(a,t,n,i,r,s,0),void M_(o,t,n,i,r,s,0)}e=e.next}a=a.next}while(a!==e)}function I_(e,t){return e.x-t.x}function k_(e,t){let n=function(e,t){let n,i=t,r=-1/0,s=e.x,a=e.y;do{if(a<=i.y&&a>=i.next.y&&i.next.y!==i.y){let e=i.x+(a-i.y)*(i.next.x-i.x)/(i.next.y-i.y);if(e<=s&&e>r&&(r=e,n=i.x<i.next.x?i:i.next,e===s))return n}i=i.next}while(i!==t);if(!n)return null;let o,l=n,u=n.x,c=n.y,h=1/0;i=n;do{s>=i.x&&i.x>=u&&s!==i.x&&z_(a<c?s:r,a,u,c,a<c?r:s,a,i.x,i.y)&&(o=Math.abs(a-i.y)/(s-i.x),G_(i,e)&&(o<h||o===h&&(i.x>n.x||i.x===n.x&&B_(n,i)))&&(n=i,h=o)),i=i.next}while(i!==l);return n}(e,t);if(!n)return t;let i=q_(n,e);return A_(i,i.next),A_(n,n.next)}function B_(e,t){return j_(e.prev,e,t.prev)<0&&j_(t.next,e,e.next)<0}function R_(e,t,n,i,r){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-n)*r|0)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-i)*r|0)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function L_(e){let t=e,n=e;do{(t.x<n.x||t.x===n.x&&t.y<n.y)&&(n=t),t=t.next}while(t!==e);return n}function z_(e,t,n,i,r,s,a,o){return(r-a)*(t-o)>=(e-a)*(s-o)&&(e-a)*(i-o)>=(n-a)*(t-o)&&(n-a)*(s-o)>=(r-a)*(i-o)}function N_(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!function(e,t){let n=e;do{if(n.i!==e.i&&n.next.i!==e.i&&n.i!==t.i&&n.next.i!==t.i&&V_(n,n.next,e,t))return!0;n=n.next}while(n!==e);return!1}(e,t)&&(G_(e,t)&&G_(t,e)&&function(e,t){let n=e,i=!1,r=(e.x+t.x)/2,s=(e.y+t.y)/2;do{n.y>s!=n.next.y>s&&n.next.y!==n.y&&r<(n.next.x-n.x)*(s-n.y)/(n.next.y-n.y)+n.x&&(i=!i),n=n.next}while(n!==e);return i}(e,t)&&(j_(e.prev,e,t.prev)||j_(e,t.prev,t))||U_(e,t)&&j_(e.prev,e,e.next)>0&&j_(t.prev,t,t.next)>0)}function j_(e,t,n){return(t.y-e.y)*(n.x-t.x)-(t.x-e.x)*(n.y-t.y)}function U_(e,t){return e.x===t.x&&e.y===t.y}function V_(e,t,n,i){let r=W_(j_(e,t,n)),s=W_(j_(e,t,i)),a=W_(j_(n,i,e)),o=W_(j_(n,i,t));return!!(r!==s&&a!==o||0===r&&H_(e,n,t)||0===s&&H_(e,i,t)||0===a&&H_(n,e,i)||0===o&&H_(n,t,i))}function H_(e,t,n){return t.x<=Math.max(e.x,n.x)&&t.x>=Math.min(e.x,n.x)&&t.y<=Math.max(e.y,n.y)&&t.y>=Math.min(e.y,n.y)}function W_(e){return e>0?1:e<0?-1:0}function G_(e,t){return j_(e.prev,e,e.next)<0?j_(e,t,e.next)>=0&&j_(e,e.prev,t)>=0:j_(e,t,e.prev)<0||j_(e,e.next,t)<0}function q_(e,t){let n=new Q_(e.i,e.x,e.y),i=new Q_(t.i,t.x,t.y),r=e.next,s=t.prev;return e.next=t,t.prev=e,n.next=r,r.prev=n,i.next=n,n.prev=i,s.next=i,i.prev=s,i}function Y_(e,t,n,i){let r=new Q_(e,t,n);return i?(r.next=i.next,r.prev=i,i.next.prev=r,i.next=r):(r.prev=r,r.next=r),r}function X_(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function Q_(e,t,n){this.i=e,this.x=t,this.y=n,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}var K_=class{static area(e){let t=e.length,n=0;for(let i=t-1,r=0;r<t;i=r++)n+=e[i].x*e[r].y-e[r].x*e[i].y;return.5*n}static isClockWise(e){return K_.area(e)<0}static triangulateShape(e,t){let n=[],i=[],r=[];Z_(e),J_(n,e);let s=e.length;t.forEach(Z_);for(let o=0;o<t.length;o++)i.push(s),s+=t[o].length,J_(n,t[o]);let a=E_(n,i);for(let o=0;o<a.length;o+=3)r.push(a.slice(o,o+3));return r}};function Z_(e){let t=e.length;t>2&&e[t-1].equals(e[0])&&e.pop()}function J_(e,t){for(let n=0;n<t.length;n++)e.push(t[n].x),e.push(t[n].y)}var $_=class extends D_{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=(1+Math.sqrt(5))/2;super([-1,n,0,1,n,0,-1,-n,0,1,-n,0,0,-1,n,0,1,n,0,-1,-n,0,1,-n,n,0,-1,n,0,1,-n,0,-1,-n,0,1],[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],e,t),this.type="IcosahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new $_(e.radius,e.detail)}},eS=class extends dx{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:32,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:16,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:2*Math.PI,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:Math.PI;super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:n,phiStart:i,phiLength:r,thetaStart:s,thetaLength:a},t=Math.max(3,Math.floor(t)),n=Math.max(2,Math.floor(n));let o=Math.min(s+a,Math.PI),l=0,u=[],c=new Lv,h=new Lv,d=[],p=[],f=[],m=[];for(let g=0;g<=n;g++){let d=[],v=g/n,y=0;0==g&&0==s?y=.5/t:g==n&&o==Math.PI&&(y=-.5/t);for(let n=0;n<=t;n++){let o=n/t;c.x=-e*Math.cos(i+o*r)*Math.sin(s+v*a),c.y=e*Math.cos(s+v*a),c.z=e*Math.sin(i+o*r)*Math.sin(s+v*a),p.push(c.x,c.y,c.z),h.copy(c).normalize(),f.push(h.x,h.y,h.z),m.push(o+y,1-v),d.push(l++)}u.push(d)}for(let g=0;g<n;g++)for(let e=0;e<t;e++){let t=u[g][e+1],i=u[g][e],r=u[g+1][e],a=u[g+1][e+1];(0!==g||s>0)&&d.push(t,i,a),(g!==n-1||o<Math.PI)&&d.push(i,r,a)}this.setIndex(d),this.setAttribute("position",new rx(p,3)),this.setAttribute("normal",new rx(f,3)),this.setAttribute("uv",new rx(m,2))}static fromJSON(e){return new eS(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}},tS=class extends dx{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.4,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:12,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:48,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:2*Math.PI;super(),this.type="TorusGeometry",this.parameters={radius:e,tube:t,radialSegments:n,tubularSegments:i,arc:r},n=Math.floor(n),i=Math.floor(i);let s=[],a=[],o=[],l=[],u=new Lv,c=new Lv,h=new Lv;for(let d=0;d<=n;d++)for(let s=0;s<=i;s++){let p=s/i*r,f=d/n*Math.PI*2;c.x=(e+t*Math.cos(f))*Math.cos(p),c.y=(e+t*Math.cos(f))*Math.sin(p),c.z=t*Math.sin(f),a.push(c.x,c.y,c.z),u.x=e*Math.cos(p),u.y=e*Math.sin(p),h.subVectors(c,u).normalize(),o.push(h.x,h.y,h.z),l.push(s/i),l.push(d/n)}for(let d=1;d<=n;d++)for(let e=1;e<=i;e++){let t=(i+1)*d+e-1,n=(i+1)*(d-1)+e-1,r=(i+1)*(d-1)+e,a=(i+1)*d+e;s.push(t,n,a),s.push(n,r,a)}this.setIndex(s),this.setAttribute("position",new rx(a,3)),this.setAttribute("normal",new rx(o,3)),this.setAttribute("uv",new rx(l,2))}static fromJSON(e){return new tS(e.radius,e.tube,e.radialSegments,e.tubularSegments,e.arc)}},nS=class extends dx{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.4,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:64,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:8,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:2,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:3;super(),this.type="TorusKnotGeometry",this.parameters={radius:e,tube:t,tubularSegments:n,radialSegments:i,p:r,q:s},n=Math.floor(n),i=Math.floor(i);let a=[],o=[],l=[],u=[],c=new Lv,h=new Lv,d=new Lv,p=new Lv,f=new Lv,m=new Lv,g=new Lv;for(let y=0;y<=n;++y){let a=y/n*r*Math.PI*2;v(a,r,s,e,d),v(a+.01,r,s,e,p),m.subVectors(p,d),g.addVectors(p,d),f.crossVectors(m,g),g.crossVectors(f,m),f.normalize(),g.normalize();for(let e=0;e<=i;++e){let r=e/i*Math.PI*2,s=-t*Math.cos(r),a=t*Math.sin(r);c.x=d.x+(s*g.x+a*f.x),c.y=d.y+(s*g.y+a*f.y),c.z=d.z+(s*g.z+a*f.z),o.push(c.x,c.y,c.z),h.subVectors(c,d).normalize(),l.push(h.x,h.y,h.z),u.push(y/n),u.push(e/i)}}for(let y=1;y<=n;y++)for(let e=1;e<=i;e++){let t=(i+1)*(y-1)+(e-1),n=(i+1)*y+(e-1),r=(i+1)*y+e,s=(i+1)*(y-1)+e;a.push(t,n,s),a.push(n,r,s)}function v(e,t,n,i,r){let s=Math.cos(e),a=Math.sin(e),o=n/t*e,l=Math.cos(o);r.x=i*(2+l)*.5*s,r.y=i*(2+l)*a*.5,r.z=i*Math.sin(o)*.5}this.setIndex(a),this.setAttribute("position",new rx(o,3)),this.setAttribute("normal",new rx(l,3)),this.setAttribute("uv",new rx(u,2))}static fromJSON(e){return new nS(e.radius,e.tube,e.tubularSegments,e.radialSegments,e.p,e.q)}},iS=class extends Ix{constructor(e){super(e),this.isRawShaderMaterial=!0,this.type="RawShaderMaterial"}};function rS(e,t,n){return aS(e)?new e.constructor(e.subarray(t,void 0!==n?n:e.length)):e.slice(t,n)}function sS(e,t,n){return!e||!n&&e.constructor===t?e:"number"==typeof t.BYTES_PER_ELEMENT?new t(e):Array.prototype.slice.call(e)}function aS(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function oS(e){let t=e.length,n=new Array(t);for(let i=0;i!==t;++i)n[i]=i;return n.sort((function(t,n){return e[t]-e[n]})),n}function lS(e,t,n){let i=e.length,r=new e.constructor(i);for(let s=0,a=0;a!==i;++s){let i=n[s]*t;for(let n=0;n!==t;++n)r[a++]=e[i+n]}return r}function uS(e,t,n,i){let r=1,s=e[0];for(;void 0!==s&&void 0===s[i];)s=e[r++];if(void 0===s)return;let a=s[i];if(void 0!==a)if(Array.isArray(a))do{a=s[i],void 0!==a&&(t.push(s.time),n.push.apply(n,a)),s=e[r++]}while(void 0!==s);else if(void 0!==a.toArray)do{a=s[i],void 0!==a&&(t.push(s.time),a.toArray(n,n.length)),s=e[r++]}while(void 0!==s);else do{a=s[i],void 0!==a&&(t.push(s.time),n.push(a)),s=e[r++]}while(void 0!==s)}var cS=class{constructor(e,t,n,i){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=void 0!==i?i:new t.constructor(n),this.sampleValues=t,this.valueSize=n,this.settings=null,this.DefaultSettings_={}}evaluate(e){let t=this.parameterPositions,n=this._cachedIndex,i=t[n],r=t[n-1];e:{t:{let s;n:{i:if(!(e<i)){for(let s=n+2;;){if(void 0===i){if(e<r)break i;return n=t.length,this._cachedIndex=n,this.copySampleValue_(n-1)}if(n===s)break;if(r=i,i=t[++n],e<i)break t}s=t.length;break n}if(e>=r)break e;{let a=t[1];e<a&&(n=2,r=a);for(let s=n-2;;){if(void 0===r)return this._cachedIndex=0,this.copySampleValue_(0);if(n===s)break;if(i=r,r=t[--n-1],e>=r)break t}s=n,n=0}}for(;n<s;){let i=n+s>>>1;e<t[i]?s=i:n=i+1}if(i=t[n],r=t[n-1],void 0===r)return this._cachedIndex=0,this.copySampleValue_(0);if(void 0===i)return n=t.length,this._cachedIndex=n,this.copySampleValue_(n-1)}this._cachedIndex=n,this.intervalChanged_(n,r,i)}return this.interpolate_(n,r,e,i)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){let t=this.resultBuffer,n=this.sampleValues,i=this.valueSize,r=e*i;for(let s=0;s!==i;++s)t[s]=n[r+s];return t}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}},hS=class extends cS{constructor(e,t,n,i){super(e,t,n,i),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:kg,endingEnd:kg}}intervalChanged_(e,t,n){let i=this.parameterPositions,r=e-2,s=e+1,a=i[r],o=i[s];if(void 0===a)switch(this.getSettings_().endingStart){case Bg:r=e,a=2*t-n;break;case Rg:r=i.length-2,a=t+i[r]-i[r+1];break;default:r=e,a=n}if(void 0===o)switch(this.getSettings_().endingEnd){case Bg:s=e,o=2*n-t;break;case Rg:s=1,o=n+i[1]-i[0];break;default:s=e-1,o=t}let l=.5*(n-t),u=this.valueSize;this._weightPrev=l/(t-a),this._weightNext=l/(o-n),this._offsetPrev=r*u,this._offsetNext=s*u}interpolate_(e,t,n,i){let r=this.resultBuffer,s=this.sampleValues,a=this.valueSize,o=e*a,l=o-a,u=this._offsetPrev,c=this._offsetNext,h=this._weightPrev,d=this._weightNext,p=(n-t)/(i-t),f=p*p,m=f*p,g=-h*m+2*h*f-h*p,v=(1+h)*m+(-1.5-2*h)*f+(-.5+h)*p+1,y=(-1-d)*m+(1.5+d)*f+.5*p,x=d*m-d*f;for(let b=0;b!==a;++b)r[b]=g*s[u+b]+v*s[l+b]+y*s[o+b]+x*s[c+b];return r}},dS=class extends cS{constructor(e,t,n,i){super(e,t,n,i)}interpolate_(e,t,n,i){let r=this.resultBuffer,s=this.sampleValues,a=this.valueSize,o=e*a,l=o-a,u=(n-t)/(i-t),c=1-u;for(let h=0;h!==a;++h)r[h]=s[l+h]*c+s[o+h]*u;return r}},pS=class extends cS{constructor(e,t,n,i){super(e,t,n,i)}interpolate_(e){return this.copySampleValue_(e-1)}},fS=class{constructor(e,t,n,i){if(void 0===e)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===t||0===t.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=sS(t,this.TimeBufferType),this.values=sS(n,this.ValueBufferType),this.setInterpolation(i||this.DefaultInterpolation)}static toJSON(e){let t,n=e.constructor;if(n.toJSON!==this.toJSON)t=n.toJSON(e);else{t={name:e.name,times:sS(e.times,Array),values:sS(e.values,Array)};let n=e.getInterpolation();n!==e.DefaultInterpolation&&(t.interpolation=n)}return t.type=e.ValueTypeName,t}InterpolantFactoryMethodDiscrete(e){return new pS(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new dS(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new hS(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case Fg:t=this.InterpolantFactoryMethodDiscrete;break;case Og:t=this.InterpolantFactoryMethodLinear;break;case Ig:t=this.InterpolantFactoryMethodSmooth}if(void 0===t){let t="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(e===this.DefaultInterpolation)throw new Error(t);this.setInterpolation(this.DefaultInterpolation)}return console.warn("THREE.KeyframeTrack:",t),this}return this.createInterpolant=t,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return Fg;case this.InterpolantFactoryMethodLinear:return Og;case this.InterpolantFactoryMethodSmooth:return Ig}}getValueSize(){return this.values.length/this.times.length}shift(e){if(0!==e){let t=this.times;for(let n=0,i=t.length;n!==i;++n)t[n]+=e}return this}scale(e){if(1!==e){let t=this.times;for(let n=0,i=t.length;n!==i;++n)t[n]*=e}return this}trim(e,t){let n=this.times,i=n.length,r=0,s=i-1;for(;r!==i&&n[r]<e;)++r;for(;-1!==s&&n[s]>t;)--s;if(++s,0!==r||s!==i){r>=s&&(s=Math.max(s,1),r=s-1);let e=this.getValueSize();this.times=rS(n,r,s),this.values=rS(this.values,r*e,s*e)}return this}validate(){let e=!0,t=this.getValueSize();t-Math.floor(t)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);let n=this.times,i=this.values,r=n.length;0===r&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let s=null;for(let a=0;a!==r;a++){let t=n[a];if("number"==typeof t&&isNaN(t)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,a,t),e=!1;break}if(null!==s&&s>t){console.error("THREE.KeyframeTrack: Out of order keys.",this,a,t,s),e=!1;break}s=t}if(void 0!==i&&aS(i))for(let a=0,o=i.length;a!==o;++a){let t=i[a];if(isNaN(t)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,a,t),e=!1;break}}return e}optimize(){let e=rS(this.times),t=rS(this.values),n=this.getValueSize(),i=this.getInterpolation()===Ig,r=e.length-1,s=1;for(let a=1;a<r;++a){let r=!1,o=e[a];if(o!==e[a+1]&&(1!==a||o!==e[0]))if(i)r=!0;else{let e=a*n,i=e-n,s=e+n;for(let a=0;a!==n;++a){let n=t[e+a];if(n!==t[i+a]||n!==t[s+a]){r=!0;break}}}if(r){if(a!==s){e[s]=e[a];let i=a*n,r=s*n;for(let e=0;e!==n;++e)t[r+e]=t[i+e]}++s}}if(r>0){e[s]=e[r];for(let e=r*n,i=s*n,a=0;a!==n;++a)t[i+a]=t[e+a];++s}return s!==e.length?(this.times=rS(e,0,s),this.values=rS(t,0,s*n)):(this.times=e,this.values=t),this}clone(){let e=rS(this.times,0),t=rS(this.values,0),n=new(0,this.constructor)(this.name,e,t);return n.createInterpolant=this.createInterpolant,n}};fS.prototype.TimeBufferType=Float32Array,fS.prototype.ValueBufferType=Float32Array,fS.prototype.DefaultInterpolation=Og;var mS=class extends fS{};mS.prototype.ValueTypeName="bool",mS.prototype.ValueBufferType=Array,mS.prototype.DefaultInterpolation=Fg,mS.prototype.InterpolantFactoryMethodLinear=void 0,mS.prototype.InterpolantFactoryMethodSmooth=void 0;var gS=class extends fS{};gS.prototype.ValueTypeName="color";var vS=class extends fS{};vS.prototype.ValueTypeName="number";var yS=class extends cS{constructor(e,t,n,i){super(e,t,n,i)}interpolate_(e,t,n,i){let r=this.resultBuffer,s=this.sampleValues,a=this.valueSize,o=(n-t)/(i-t),l=e*a;for(let u=l+a;l!==u;l+=4)Rv.slerpFlat(r,0,s,l-a,s,l,o);return r}},xS=class extends fS{InterpolantFactoryMethodLinear(e){return new yS(this.times,this.values,this.getValueSize(),e)}};xS.prototype.ValueTypeName="quaternion",xS.prototype.DefaultInterpolation=Og,xS.prototype.InterpolantFactoryMethodSmooth=void 0;var bS=class extends fS{};bS.prototype.ValueTypeName="string",bS.prototype.ValueBufferType=Array,bS.prototype.DefaultInterpolation=Fg,bS.prototype.InterpolantFactoryMethodLinear=void 0,bS.prototype.InterpolantFactoryMethodSmooth=void 0;var wS=class extends fS{};wS.prototype.ValueTypeName="vector";var DS=class{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,n=arguments.length>2?arguments[2]:void 0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Lg;this.name=e,this.tracks=n,this.duration=t,this.blendMode=i,this.uuid=Jg(),this.duration<0&&this.resetDuration()}static parse(e){let t=[],n=e.tracks,i=1/(e.fps||1);for(let s=0,a=n.length;s!==a;++s)t.push(_S(n[s]).scale(i));let r=new this(e.name,e.duration,t,e.blendMode);return r.uuid=e.uuid,r}static toJSON(e){let t=[],n=e.tracks,i={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid,blendMode:e.blendMode};for(let r=0,s=n.length;r!==s;++r)t.push(fS.toJSON(n[r]));return i}static CreateFromMorphTargetSequence(e,t,n,i){let r=t.length,s=[];for(let a=0;a<r;a++){let e=[],o=[];e.push((a+r-1)%r,a,(a+1)%r),o.push(0,1,0);let l=oS(e);e=lS(e,1,l),o=lS(o,1,l),!i&&0===e[0]&&(e.push(r),o.push(o[0])),s.push(new vS(".morphTargetInfluences["+t[a].name+"]",e,o).scale(1/n))}return new this(e,-1,s)}static findByName(e,t){let n=e;if(!Array.isArray(e)){let t=e;n=t.geometry&&t.geometry.animations||t.animations}for(let i=0;i<n.length;i++)if(n[i].name===t)return n[i];return null}static CreateClipsFromMorphTargetSequences(e,t,n){let i={},r=/^([\w-]*?)([\d]+)$/;for(let a=0,o=e.length;a<o;a++){let t=e[a],n=t.name.match(r);if(n&&n.length>1){let e=n[1],r=i[e];r||(i[e]=r=[]),r.push(t)}}let s=[];for(let a in i)s.push(this.CreateFromMorphTargetSequence(a,i[a],t,n));return s}static parseAnimation(e,t){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;let n=function(e,t,n,i,r){if(0!==n.length){let s=[],a=[];uS(n,s,a,i),0!==s.length&&r.push(new e(t,s,a))}},i=[],r=e.name||"default",s=e.fps||30,a=e.blendMode,o=e.length||-1,l=e.hierarchy||[];for(let u=0;u<l.length;u++){let e=l[u].keys;if(e&&0!==e.length)if(e[0].morphTargets){let t,n={};for(t=0;t<e.length;t++)if(e[t].morphTargets)for(let i=0;i<e[t].morphTargets.length;i++)n[e[t].morphTargets[i]]=-1;for(let r in n){let n=[],s=[];for(let i=0;i!==e[t].morphTargets.length;++i){let i=e[t];n.push(i.time),s.push(i.morphTarget===r?1:0)}i.push(new vS(".morphTargetInfluence["+r+"]",n,s))}o=n.length*s}else{let r=".bones["+t[u].name+"]";n(wS,r+".position",e,"pos",i),n(xS,r+".quaternion",e,"rot",i),n(wS,r+".scale",e,"scl",i)}}return 0===i.length?null:new this(r,o,i,a)}resetDuration(){let e=0;for(let t=0,n=this.tracks.length;t!==n;++t){let n=this.tracks[t];e=Math.max(e,n.times[n.times.length-1])}return this.duration=e,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){let e=[];for(let t=0;t<this.tracks.length;t++)e.push(this.tracks[t].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}};function _S(e){if(void 0===e.type)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");let t=function(e){switch(e.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return vS;case"vector":case"vector2":case"vector3":case"vector4":return wS;case"color":return gS;case"quaternion":return xS;case"bool":case"boolean":return mS;case"string":return bS}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+e)}(e.type);if(void 0===e.times){let t=[],n=[];uS(e.keys,t,n,"value"),e.times=t,e.values=n}return void 0!==t.parse?t.parse(e):new t(e.name,e.times,e.values,e.interpolation)}var SS={enabled:!1,files:{},add:function(e,t){!1!==this.enabled&&(this.files[e]=t)},get:function(e){if(!1!==this.enabled)return this.files[e]},remove:function(e){delete this.files[e]},clear:function(){this.files={}}},ES=class{constructor(e,t,n){let i,r=this,s=!1,a=0,o=0,l=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=n,this.itemStart=function(e){o++,!1===s&&void 0!==r.onStart&&r.onStart(e,a,o),s=!0},this.itemEnd=function(e){a++,void 0!==r.onProgress&&r.onProgress(e,a,o),a===o&&(s=!1,void 0!==r.onLoad&&r.onLoad())},this.itemError=function(e){void 0!==r.onError&&r.onError(e)},this.resolveURL=function(e){return i?i(e):e},this.setURLModifier=function(e){return i=e,this},this.addHandler=function(e,t){return l.push(e,t),this},this.removeHandler=function(e){let t=l.indexOf(e);return-1!==t&&l.splice(t,2),this},this.getHandler=function(e){for(let t=0,n=l.length;t<n;t+=2){let n=l[t],i=l[t+1];if(n.global&&(n.lastIndex=0),n.test(e))return i}return null}}},CS=new ES,AS=class{constructor(e){this.manager=void 0!==e?e:CS,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,t){let n=this;return new Promise((function(i,r){n.load(e,i,t,r)}))}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}},MS={},TS=class extends Error{constructor(e,t){super(e),this.response=t}},PS=class extends AS{constructor(e){super(e)}load(e,t,n,i){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);let r=SS.get(e);if(void 0!==r)return this.manager.itemStart(e),setTimeout((()=>{t&&t(r),this.manager.itemEnd(e)}),0),r;if(void 0!==MS[e])return void MS[e].push({onLoad:t,onProgress:n,onError:i});MS[e]=[],MS[e].push({onLoad:t,onProgress:n,onError:i});let s=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),a=this.mimeType,o=this.responseType;fetch(s).then((t=>{if(200===t.status||0===t.status){if(0===t.status&&console.warn("THREE.FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||void 0===t.body||void 0===t.body.getReader)return t;let n=MS[e],i=t.body.getReader(),r=t.headers.get("Content-Length")||t.headers.get("X-File-Size"),s=r?parseInt(r):0,a=0!==s,o=0,l=new ReadableStream({start(e){!function t(){i.read().then((i=>{let{done:r,value:l}=i;if(r)e.close();else{o+=l.byteLength;let i=new ProgressEvent("progress",{lengthComputable:a,loaded:o,total:s});for(let e=0,t=n.length;e<t;e++){let t=n[e];t.onProgress&&t.onProgress(i)}e.enqueue(l),t()}}))}()}});return new Response(l)}throw new TS('fetch for "'.concat(t.url,'" responded with ').concat(t.status,": ").concat(t.statusText),t)})).then((e=>{switch(o){case"arraybuffer":return e.arrayBuffer();case"blob":return e.blob();case"document":return e.text().then((e=>(new DOMParser).parseFromString(e,a)));case"json":return e.json();default:if(void 0===a)return e.text();{let t=/charset="?([^;"\s]*)"?/i.exec(a),n=t&&t[1]?t[1].toLowerCase():void 0,i=new TextDecoder(n);return e.arrayBuffer().then((e=>i.decode(e)))}}})).then((t=>{SS.add(e,t);let n=MS[e];delete MS[e];for(let e=0,i=n.length;e<i;e++){let i=n[e];i.onLoad&&i.onLoad(t)}})).catch((t=>{let n=MS[e];if(void 0===n)throw this.manager.itemError(e),t;delete MS[e];for(let e=0,i=n.length;e<i;e++){let i=n[e];i.onError&&i.onError(t)}this.manager.itemError(e)})).finally((()=>{this.manager.itemEnd(e)})),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}},FS=class extends AS{constructor(e){super(e)}load(e,t,n,i){void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);let r=this,s=SS.get(e);if(void 0!==s)return r.manager.itemStart(e),setTimeout((function(){t&&t(s),r.manager.itemEnd(e)}),0),s;let a=fv("img");function o(){u(),SS.add(e,this),t&&t(this),r.manager.itemEnd(e)}function l(t){u(),i&&i(t),r.manager.itemError(e),r.manager.itemEnd(e)}function u(){a.removeEventListener("load",o,!1),a.removeEventListener("error",l,!1)}return a.addEventListener("load",o,!1),a.addEventListener("error",l,!1),"data:"!==e.slice(0,5)&&void 0!==this.crossOrigin&&(a.crossOrigin=this.crossOrigin),r.manager.itemStart(e),a.src=e,a}},OS=class extends AS{constructor(e){super(e)}load(e,t,n,i){let r=new Fv,s=new FS(this.manager);return s.setCrossOrigin(this.crossOrigin),s.setPath(this.path),s.load(e,(function(e){r.image=e,r.needsUpdate=!0,void 0!==t&&t(r)}),n,i),r}},IS=class extends zy{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;super(),this.isLight=!0,this.type="Light",this.color=new Ev(e),this.intensity=t}dispose(){}copy(e,t){return super.copy(e,t),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){let t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,void 0!==this.groundColor&&(t.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(t.object.distance=this.distance),void 0!==this.angle&&(t.object.angle=this.angle),void 0!==this.decay&&(t.object.decay=this.decay),void 0!==this.penumbra&&(t.object.penumbra=this.penumbra),void 0!==this.shadow&&(t.object.shadow=this.shadow.toJSON()),t}},kS=class extends IS{constructor(e,t,n){super(e,n),this.isHemisphereLight=!0,this.type="HemisphereLight",this.position.copy(zy.DEFAULT_UP),this.updateMatrix(),this.groundColor=new Ev(t)}copy(e,t){return super.copy(e,t),this.groundColor.copy(e.groundColor),this}},BS=new py,RS=new Lv,LS=new Lv,zS=class{constructor(e){this.camera=e,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new lv(512,512),this.map=null,this.mapPass=null,this.matrix=new py,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new qx,this._frameExtents=new lv(1,1),this._viewportCount=1,this._viewports=[new Ov(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){let t=this.camera,n=this.matrix;RS.setFromMatrixPosition(e.matrixWorld),t.position.copy(RS),LS.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(LS),t.updateMatrixWorld(),BS.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(BS),n.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),n.multiply(BS)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}clone(){return(new this.constructor).copy(this)}toJSON(){let e={};return 0!==this.bias&&(e.bias=this.bias),0!==this.normalBias&&(e.normalBias=this.normalBias),1!==this.radius&&(e.radius=this.radius),(512!==this.mapSize.x||512!==this.mapSize.y)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}},NS=class extends zS{constructor(){super(new Bx(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(e){let t=this.camera,n=2*Zg*e.angle*this.focus,i=this.mapSize.width/this.mapSize.height,r=e.distance||t.far;(n!==t.fov||i!==t.aspect||r!==t.far)&&(t.fov=n,t.aspect=i,t.far=r,t.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}},jS=class extends IS{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Math.PI/3,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:2;super(e,t),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(zy.DEFAULT_UP),this.updateMatrix(),this.target=new zy,this.distance=n,this.angle=i,this.penumbra=r,this.decay=s,this.map=null,this.shadow=new NS}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}},US=new py,VS=new Lv,HS=new Lv,WS=class extends zS{constructor(){super(new Bx(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new lv(4,2),this._viewportCount=6,this._viewports=[new Ov(2,1,1,1),new Ov(0,1,1,1),new Ov(3,1,1,1),new Ov(1,1,1,1),new Ov(3,0,1,1),new Ov(1,0,1,1)],this._cubeDirections=[new Lv(1,0,0),new Lv(-1,0,0),new Lv(0,0,1),new Lv(0,0,-1),new Lv(0,1,0),new Lv(0,-1,0)],this._cubeUps=[new Lv(0,1,0),new Lv(0,1,0),new Lv(0,1,0),new Lv(0,1,0),new Lv(0,0,1),new Lv(0,0,-1)]}updateMatrices(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this.camera,i=this.matrix,r=e.distance||n.far;r!==n.far&&(n.far=r,n.updateProjectionMatrix()),VS.setFromMatrixPosition(e.matrixWorld),n.position.copy(VS),HS.copy(n.position),HS.add(this._cubeDirections[t]),n.up.copy(this._cubeUps[t]),n.lookAt(HS),n.updateMatrixWorld(),i.makeTranslation(-VS.x,-VS.y,-VS.z),US.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),this._frustum.setFromProjectionMatrix(US)}},GS=class extends IS{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2;super(e,t),this.isPointLight=!0,this.type="PointLight",this.distance=n,this.decay=i,this.shadow=new WS}get power(){return 4*this.intensity*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}},qS=class extends zS{constructor(){super(new ab(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}},YS=class extends IS{constructor(e,t){super(e,t),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(zy.DEFAULT_UP),this.updateMatrix(),this.target=new zy,this.shadow=new qS}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}},XS=class extends dx{constructor(){super(),this.isInstancedBufferGeometry=!0,this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(e){return super.copy(e),this.instanceCount=e.instanceCount,this}toJSON(){let e=super.toJSON();return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}},QS=class extends AS{constructor(e){super(e)}load(e,t,n,i){let r=this,s=new PS(r.manager);s.setPath(r.path),s.setRequestHeader(r.requestHeader),s.setWithCredentials(r.withCredentials),s.load(e,(function(n){try{t(r.parse(JSON.parse(n)))}catch(s){i?i(s):console.error(s),r.manager.itemError(e)}}),n,i)}parse(e){let t={},n={};function i(e,i){if(void 0!==t[i])return t[i];let r=e.interleavedBuffers[i],s=function(e,t){if(void 0!==n[t])return n[t];let i=e.arrayBuffers[t],r=new Uint32Array(i).buffer;return n[t]=r,r}(e,r.buffer),a=pv(r.type,s),o=new AD(a,r.stride);return o.uuid=r.uuid,t[i]=o,o}let r=e.isInstancedBufferGeometry?new XS:new dx,s=e.data.index;if(void 0!==s){let e=pv(s.type,s.array);r.setIndex(new tx(e,1))}let a=e.data.attributes;for(let c in a){let t,n=a[c];if(n.isInterleavedBufferAttribute){let r=i(e.data,n.data);t=new TD(r,n.itemSize,n.offset,n.normalized)}else{let e=pv(n.type,n.array);t=new(n.isInstancedBufferAttribute?BD:tx)(e,n.itemSize,n.normalized)}void 0!==n.name&&(t.name=n.name),void 0!==n.usage&&t.setUsage(n.usage),void 0!==n.updateRange&&(t.updateRange.offset=n.updateRange.offset,t.updateRange.count=n.updateRange.count),r.setAttribute(c,t)}let o=e.data.morphAttributes;if(o)for(let c in o){let t=o[c],n=[];for(let r=0,s=t.length;r<s;r++){let s,a=t[r];if(a.isInterleavedBufferAttribute){let t=i(e.data,a.data);s=new TD(t,a.itemSize,a.offset,a.normalized)}else{let e=pv(a.type,a.array);s=new tx(e,a.itemSize,a.normalized)}void 0!==a.name&&(s.name=a.name),n.push(s)}r.morphAttributes[c]=n}e.data.morphTargetsRelative&&(r.morphTargetsRelative=!0);let l=e.data.groups||e.data.drawcalls||e.data.offsets;if(void 0!==l)for(let c=0,h=l.length;c!==h;++c){let e=l[c];r.addGroup(e.start,e.count,e.materialIndex)}let u=e.data.boundingSphere;if(void 0!==u){let e=new Lv;void 0!==u.center&&e.fromArray(u.center),r.boundingSphere=new ry(e,u.radius)}return e.name&&(r.name=e.name),e.userData&&(r.userData=e.userData),r}},KS=class{constructor(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=ZS(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){let t=ZS();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}};function ZS(){return(typeof performance>"u"?Date:performance).now()}var JS=class{constructor(e,t,n){let i,r,s;switch(this.binding=e,this.valueSize=n,t){case"quaternion":i=this._slerp,r=this._slerpAdditive,s=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(6*n),this._workIndex=5;break;case"string":case"bool":i=this._select,r=this._select,s=this._setAdditiveIdentityOther,this.buffer=new Array(5*n);break;default:i=this._lerp,r=this._lerpAdditive,s=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(5*n)}this._mixBufferRegion=i,this._mixBufferRegionAdditive=r,this._setIdentity=s,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(e,t){let n=this.buffer,i=this.valueSize,r=e*i+i,s=this.cumulativeWeight;if(0===s){for(let e=0;e!==i;++e)n[r+e]=n[e];s=t}else{s+=t;let e=t/s;this._mixBufferRegion(n,r,0,e,i)}this.cumulativeWeight=s}accumulateAdditive(e){let t=this.buffer,n=this.valueSize,i=n*this._addIndex;0===this.cumulativeWeightAdditive&&this._setIdentity(),this._mixBufferRegionAdditive(t,i,0,e,n),this.cumulativeWeightAdditive+=e}apply(e){let t=this.valueSize,n=this.buffer,i=e*t+t,r=this.cumulativeWeight,s=this.cumulativeWeightAdditive,a=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,r<1){let e=t*this._origIndex;this._mixBufferRegion(n,i,e,1-r,t)}s>0&&this._mixBufferRegionAdditive(n,i,this._addIndex*t,1,t);for(let o=t,l=t+t;o!==l;++o)if(n[o]!==n[o+t]){a.setValue(n,i);break}}saveOriginalState(){let e=this.binding,t=this.buffer,n=this.valueSize,i=n*this._origIndex;e.getValue(t,i);for(let r=n,s=i;r!==s;++r)t[r]=t[i+r%n];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){let e=3*this.valueSize;this.binding.setValue(this.buffer,e)}_setAdditiveIdentityNumeric(){let e=this._addIndex*this.valueSize,t=e+this.valueSize;for(let n=e;n<t;n++)this.buffer[n]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){let e=this._origIndex*this.valueSize,t=this._addIndex*this.valueSize;for(let n=0;n<this.valueSize;n++)this.buffer[t+n]=this.buffer[e+n]}_select(e,t,n,i,r){if(i>=.5)for(let s=0;s!==r;++s)e[t+s]=e[n+s]}_slerp(e,t,n,i){Rv.slerpFlat(e,t,e,t,e,n,i)}_slerpAdditive(e,t,n,i,r){let s=this._workIndex*r;Rv.multiplyQuaternionsFlat(e,s,e,t,e,n),Rv.slerpFlat(e,t,e,t,e,s,i)}_lerp(e,t,n,i,r){let s=1-i;for(let a=0;a!==r;++a){let r=t+a;e[r]=e[r]*s+e[n+a]*i}}_lerpAdditive(e,t,n,i,r){for(let s=0;s!==r;++s){let r=t+s;e[r]=e[r]+e[n+s]*i}}},$S="\\[\\]\\.:\\/",eE=new RegExp("["+$S+"]","g"),tE="[^"+$S+"]",nE="[^"+$S.replace("\\.","")+"]",iE=/((?:WC+[\/:])*)/.source.replace("WC",tE),rE=/(WCOD+)?/.source.replace("WCOD",nE),sE=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",tE),aE=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",tE),oE=new RegExp("^"+iE+rE+sE+aE+"$"),lE=["material","materials","bones","map"],uE=class{constructor(e,t,n){this.path=t,this.parsedPath=n||uE.parseTrackName(t),this.node=uE.findNode(e,this.parsedPath.nodeName)||e,this.rootNode=e,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(e,t,n){return e&&e.isAnimationObjectGroup?new uE.Composite(e,t,n):new uE(e,t,n)}static sanitizeNodeName(e){return e.replace(/\s/g,"_").replace(eE,"")}static parseTrackName(e){let t=oE.exec(e);if(null===t)throw new Error("PropertyBinding: Cannot parse trackName: "+e);let n={nodeName:t[2],objectName:t[3],objectIndex:t[4],propertyName:t[5],propertyIndex:t[6]},i=n.nodeName&&n.nodeName.lastIndexOf(".");if(void 0!==i&&-1!==i){let e=n.nodeName.substring(i+1);-1!==lE.indexOf(e)&&(n.nodeName=n.nodeName.substring(0,i),n.objectName=e)}if(null===n.propertyName||0===n.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return n}static findNode(e,t){if(void 0===t||""===t||"."===t||-1===t||t===e.name||t===e.uuid)return e;if(e.skeleton){let n=e.skeleton.getBoneByName(t);if(void 0!==n)return n}if(e.children){let n=function(e){for(let i=0;i<e.length;i++){let r=e[i];if(r.name===t||r.uuid===t)return r;let s=n(r.children);if(s)return s}return null},i=n(e.children);if(i)return i}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(e,t){e[t]=this.targetObject[this.propertyName]}_getValue_array(e,t){let n=this.resolvedProperty;for(let i=0,r=n.length;i!==r;++i)e[t++]=n[i]}_getValue_arrayElement(e,t){e[t]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(e,t){this.resolvedProperty.toArray(e,t)}_setValue_direct(e,t){this.targetObject[this.propertyName]=e[t]}_setValue_direct_setNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(e,t){let n=this.resolvedProperty;for(let i=0,r=n.length;i!==r;++i)n[i]=e[t++]}_setValue_array_setNeedsUpdate(e,t){let n=this.resolvedProperty;for(let i=0,r=n.length;i!==r;++i)n[i]=e[t++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(e,t){let n=this.resolvedProperty;for(let i=0,r=n.length;i!==r;++i)n[i]=e[t++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(e,t){this.resolvedProperty[this.propertyIndex]=e[t]}_setValue_arrayElement_setNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(e,t){this.resolvedProperty.fromArray(e,t)}_setValue_fromArray_setNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(e,t){this.bind(),this.getValue(e,t)}_setValue_unbound(e,t){this.bind(),this.setValue(e,t)}bind(){let e=this.node,t=this.parsedPath,n=t.objectName,i=t.propertyName,r=t.propertyIndex;if(e||(e=uE.findNode(this.rootNode,t.nodeName)||this.rootNode,this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!e)return void console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.");if(n){let i=t.objectIndex;switch(n){case"materials":if(!e.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!e.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);e=e.material.materials;break;case"bones":if(!e.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);e=e.skeleton.bones;for(let t=0;t<e.length;t++)if(e[t].name===i){i=t;break}break;case"map":if("map"in e){e=e.map;break}if(!e.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!e.material.map)return void console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);e=e.material.map;break;default:if(void 0===e[n])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);e=e[n]}if(void 0!==i){if(void 0===e[i])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);e=e[i]}}let s=e[i];if(void 0===s){let n=t.nodeName;return void console.error("THREE.PropertyBinding: Trying to update property for track: "+n+"."+i+" but it wasn't found.",e)}let a=this.Versioning.None;this.targetObject=e,void 0!==e.needsUpdate?a=this.Versioning.NeedsUpdate:void 0!==e.matrixWorldNeedsUpdate&&(a=this.Versioning.MatrixWorldNeedsUpdate);let o=this.BindingType.Direct;if(void 0!==r){if("morphTargetInfluences"===i){if(!e.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(!e.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);void 0!==e.morphTargetDictionary[r]&&(r=e.morphTargetDictionary[r])}o=this.BindingType.ArrayElement,this.resolvedProperty=s,this.propertyIndex=r}else void 0!==s.fromArray&&void 0!==s.toArray?(o=this.BindingType.HasFromToArray,this.resolvedProperty=s):Array.isArray(s)?(o=this.BindingType.EntireArray,this.resolvedProperty=s):this.propertyName=i;this.getValue=this.GetterByBindingType[o],this.setValue=this.SetterByBindingTypeAndVersioning[o][a]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}};uE.Composite=class{constructor(e,t,n){let i=n||uE.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,i)}getValue(e,t){this.bind();let n=this._targetGroup.nCachedObjects_,i=this._bindings[n];void 0!==i&&i.getValue(e,t)}setValue(e,t){let n=this._bindings;for(let i=this._targetGroup.nCachedObjects_,r=n.length;i!==r;++i)n[i].setValue(e,t)}bind(){let e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].bind()}unbind(){let e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].unbind()}},uE.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},uE.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},uE.prototype.GetterByBindingType=[uE.prototype._getValue_direct,uE.prototype._getValue_array,uE.prototype._getValue_arrayElement,uE.prototype._getValue_toArray],uE.prototype.SetterByBindingTypeAndVersioning=[[uE.prototype._setValue_direct,uE.prototype._setValue_direct_setNeedsUpdate,uE.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[uE.prototype._setValue_array,uE.prototype._setValue_array_setNeedsUpdate,uE.prototype._setValue_array_setMatrixWorldNeedsUpdate],[uE.prototype._setValue_arrayElement,uE.prototype._setValue_arrayElement_setNeedsUpdate,uE.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[uE.prototype._setValue_fromArray,uE.prototype._setValue_fromArray_setNeedsUpdate,uE.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];var cE=class{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:t.blendMode;this._mixer=e,this._clip=t,this._localRoot=n,this.blendMode=i;let r=t.tracks,s=r.length,a=new Array(s),o={endingStart:kg,endingEnd:kg};for(let l=0;l!==s;++l){let e=r[l].createInterpolant(null);a[l]=e,e.settings=o}this._interpolantSettings=o,this._interpolants=a,this._propertyBindings=new Array(s),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=2201,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(e){return this._startTime=e,this}setLoop(e,t){return this.loop=e,this.repetitions=t,this}setEffectiveWeight(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(e){return this._scheduleFading(e,0,1)}fadeOut(e){return this._scheduleFading(e,1,0)}crossFadeFrom(e,t,n){if(e.fadeOut(t),this.fadeIn(t),n){let n=this._clip.duration,i=e._clip.duration,r=i/n,s=n/i;e.warp(1,r,t),this.warp(s,1,t)}return this}crossFadeTo(e,t,n){return e.crossFadeFrom(this,t,n)}stopFading(){let e=this._weightInterpolant;return null!==e&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}setEffectiveTimeScale(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(e){return this.timeScale=this._clip.duration/e,this.stopWarping()}syncWith(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()}halt(e){return this.warp(this._effectiveTimeScale,0,e)}warp(e,t,n){let i=this._mixer,r=i.time,s=this.timeScale,a=this._timeScaleInterpolant;null===a&&(a=i._lendControlInterpolant(),this._timeScaleInterpolant=a);let o=a.parameterPositions,l=a.sampleValues;return o[0]=r,o[1]=r+n,l[0]=e/s,l[1]=t/s,this}stopWarping(){let e=this._timeScaleInterpolant;return null!==e&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(e,t,n,i){if(!this.enabled)return void this._updateWeight(e);let r=this._startTime;if(null!==r){let i=(e-r)*n;i<0||0===n?t=0:(this._startTime=null,t=n*i)}t*=this._updateTimeScale(e);let s=this._updateTime(t),a=this._updateWeight(e);if(a>0){let e=this._interpolants,t=this._propertyBindings;if(2501===this.blendMode)for(let n=0,i=e.length;n!==i;++n)e[n].evaluate(s),t[n].accumulateAdditive(a);else for(let n=0,r=e.length;n!==r;++n)e[n].evaluate(s),t[n].accumulate(i,a)}}_updateWeight(e){let t=0;if(this.enabled){t=this.weight;let n=this._weightInterpolant;if(null!==n){let i=n.evaluate(e)[0];t*=i,e>n.parameterPositions[1]&&(this.stopFading(),0===i&&(this.enabled=!1))}}return this._effectiveWeight=t,t}_updateTimeScale(e){let t=0;if(!this.paused){t=this.timeScale;let n=this._timeScaleInterpolant;if(null!==n){t*=n.evaluate(e)[0],e>n.parameterPositions[1]&&(this.stopWarping(),0===t?this.paused=!0:this.timeScale=t)}}return this._effectiveTimeScale=t,t}_updateTime(e){let t=this._clip.duration,n=this.loop,i=this.time+e,r=this._loopCount,s=n===Pg;if(0===e)return-1===r?i:s&&1===(1&r)?t-i:i;if(2200===n){-1===r&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(i>=t)i=t;else{if(!(i<0)){this.time=i;break e}i=0}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=i,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(-1===r&&(e>=0?(r=0,this._setEndings(!0,0===this.repetitions,s)):this._setEndings(0===this.repetitions,!0,s)),i>=t||i<0){let n=Math.floor(i/t);i-=t*n,r+=Math.abs(n);let a=this.repetitions-r;if(a<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,i=e>0?t:0,this.time=i,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(1===a){let t=e<0;this._setEndings(t,!t,s)}else this._setEndings(!1,!1,s);this._loopCount=r,this.time=i,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:n})}}else this.time=i;if(s&&1===(1&r))return t-i}return i}_setEndings(e,t,n){let i=this._interpolantSettings;n?(i.endingStart=Bg,i.endingEnd=Bg):(i.endingStart=e?this.zeroSlopeAtStart?Bg:kg:Rg,i.endingEnd=t?this.zeroSlopeAtEnd?Bg:kg:Rg)}_scheduleFading(e,t,n){let i=this._mixer,r=i.time,s=this._weightInterpolant;null===s&&(s=i._lendControlInterpolant(),this._weightInterpolant=s);let a=s.parameterPositions,o=s.sampleValues;return a[0]=r,o[0]=t,a[1]=r+e,o[1]=n,this}},hE=new Float32Array(1),dE=class extends Yg{constructor(e){super(),this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(e,t){let n=e._localRoot||this._root,i=e._clip.tracks,r=i.length,s=e._propertyBindings,a=e._interpolants,o=n.uuid,l=this._bindingsByRootAndName,u=l[o];void 0===u&&(u={},l[o]=u);for(let c=0;c!==r;++c){let e=i[c],r=e.name,l=u[r];if(void 0!==l)++l.referenceCount,s[c]=l;else{if(l=s[c],void 0!==l){null===l._cacheIndex&&(++l.referenceCount,this._addInactiveBinding(l,o,r));continue}let i=t&&t._propertyBindings[c].binding.parsedPath;l=new JS(uE.create(n,r,i),e.ValueTypeName,e.getValueSize()),++l.referenceCount,this._addInactiveBinding(l,o,r),s[c]=l}a[c].resultBuffer=l.buffer}}_activateAction(e){if(!this._isActiveAction(e)){if(null===e._cacheIndex){let t=(e._localRoot||this._root).uuid,n=e._clip.uuid,i=this._actionsByClip[n];this._bindAction(e,i&&i.knownActions[0]),this._addInactiveAction(e,n,t)}let t=e._propertyBindings;for(let e=0,n=t.length;e!==n;++e){let n=t[e];0===n.useCount++&&(this._lendBinding(n),n.saveOriginalState())}this._lendAction(e)}}_deactivateAction(e){if(this._isActiveAction(e)){let t=e._propertyBindings;for(let e=0,n=t.length;e!==n;++e){let n=t[e];0===--n.useCount&&(n.restoreOriginalState(),this._takeBackBinding(n))}this._takeBackAction(e)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;let e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}}_isActiveAction(e){let t=e._cacheIndex;return null!==t&&t<this._nActiveActions}_addInactiveAction(e,t,n){let i=this._actions,r=this._actionsByClip,s=r[t];if(void 0===s)s={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,r[t]=s;else{let t=s.knownActions;e._byClipCacheIndex=t.length,t.push(e)}e._cacheIndex=i.length,i.push(e),s.actionByRoot[n]=e}_removeInactiveAction(e){let t=this._actions,n=t[t.length-1],i=e._cacheIndex;n._cacheIndex=i,t[i]=n,t.pop(),e._cacheIndex=null;let r=e._clip.uuid,s=this._actionsByClip,a=s[r],o=a.knownActions,l=o[o.length-1],u=e._byClipCacheIndex;l._byClipCacheIndex=u,o[u]=l,o.pop(),e._byClipCacheIndex=null,delete a.actionByRoot[(e._localRoot||this._root).uuid],0===o.length&&delete s[r],this._removeInactiveBindingsForAction(e)}_removeInactiveBindingsForAction(e){let t=e._propertyBindings;for(let n=0,i=t.length;n!==i;++n){let e=t[n];0===--e.referenceCount&&this._removeInactiveBinding(e)}}_lendAction(e){let t=this._actions,n=e._cacheIndex,i=this._nActiveActions++,r=t[i];e._cacheIndex=i,t[i]=e,r._cacheIndex=n,t[n]=r}_takeBackAction(e){let t=this._actions,n=e._cacheIndex,i=--this._nActiveActions,r=t[i];e._cacheIndex=i,t[i]=e,r._cacheIndex=n,t[n]=r}_addInactiveBinding(e,t,n){let i=this._bindingsByRootAndName,r=this._bindings,s=i[t];void 0===s&&(s={},i[t]=s),s[n]=e,e._cacheIndex=r.length,r.push(e)}_removeInactiveBinding(e){let t=this._bindings,n=e.binding,i=n.rootNode.uuid,r=n.path,s=this._bindingsByRootAndName,a=s[i],o=t[t.length-1],l=e._cacheIndex;o._cacheIndex=l,t[l]=o,t.pop(),delete a[r],0===Object.keys(a).length&&delete s[i]}_lendBinding(e){let t=this._bindings,n=e._cacheIndex,i=this._nActiveBindings++,r=t[i];e._cacheIndex=i,t[i]=e,r._cacheIndex=n,t[n]=r}_takeBackBinding(e){let t=this._bindings,n=e._cacheIndex,i=--this._nActiveBindings,r=t[i];e._cacheIndex=i,t[i]=e,r._cacheIndex=n,t[n]=r}_lendControlInterpolant(){let e=this._controlInterpolants,t=this._nActiveControlInterpolants++,n=e[t];return void 0===n&&(n=new dS(new Float32Array(2),new Float32Array(2),1,hE),n.__cacheIndex=t,e[t]=n),n}_takeBackControlInterpolant(e){let t=this._controlInterpolants,n=e.__cacheIndex,i=--this._nActiveControlInterpolants,r=t[i];e.__cacheIndex=i,t[i]=e,r.__cacheIndex=n,t[n]=r}clipAction(e,t,n){let i=t||this._root,r=i.uuid,s="string"==typeof e?DS.findByName(i,e):e,a=null!==s?s.uuid:e,o=this._actionsByClip[a],l=null;if(void 0===n&&(n=null!==s?s.blendMode:Lg),void 0!==o){let e=o.actionByRoot[r];if(void 0!==e&&e.blendMode===n)return e;l=o.knownActions[0],null===s&&(s=l._clip)}if(null===s)return null;let u=new cE(this,s,t,n);return this._bindAction(u,l),this._addInactiveAction(u,a,r),u}existingAction(e,t){let n=t||this._root,i=n.uuid,r="string"==typeof e?DS.findByName(n,e):e,s=r?r.uuid:e,a=this._actionsByClip[s];return void 0!==a&&a.actionByRoot[i]||null}stopAllAction(){let e=this._actions;for(let t=this._nActiveActions-1;t>=0;--t)e[t].stop();return this}update(e){e*=this.timeScale;let t=this._actions,n=this._nActiveActions,i=this.time+=e,r=Math.sign(e),s=this._accuIndex^=1;for(let l=0;l!==n;++l)t[l]._update(i,e,r,s);let a=this._bindings,o=this._nActiveBindings;for(let l=0;l!==o;++l)a[l].apply(s);return this}setTime(e){this.time=0;for(let t=0;t<this._actions.length;t++)this._actions[t].time=0;return this.update(e)}getRoot(){return this._root}uncacheClip(e){let t=this._actions,n=e.uuid,i=this._actionsByClip,r=i[n];if(void 0!==r){let e=r.knownActions;for(let n=0,i=e.length;n!==i;++n){let i=e[n];this._deactivateAction(i);let r=i._cacheIndex,s=t[t.length-1];i._cacheIndex=null,i._byClipCacheIndex=null,s._cacheIndex=r,t[r]=s,t.pop(),this._removeInactiveBindingsForAction(i)}delete i[n]}}uncacheRoot(e){let t=e.uuid,n=this._actionsByClip;for(let r in n){let e=n[r].actionByRoot[t];void 0!==e&&(this._deactivateAction(e),this._removeInactiveAction(e))}let i=this._bindingsByRootAndName[t];if(void 0!==i)for(let r in i){let e=i[r];e.restoreOriginalState(),this._removeInactiveBinding(e)}}uncacheAction(e,t){let n=this.existingAction(e,t);null!==n&&(this._deactivateAction(n),this._removeInactiveAction(n))}},pE=class{constructor(e){this.value=e}clone(){return new pE(void 0===this.value.clone?this.value:this.value.clone())}},fE=class{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1/0;this.ray=new dy(e,t),this.near=n,this.far=i,this.camera=null,this.layers=new Sy,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,t){this.ray.set(e,t)}setFromCamera(e,t){t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):console.error("THREE.Raycaster: Unsupported camera type: "+t.type)}intersectObject(e){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];return gE(e,this,t,!(arguments.length>1&&void 0!==arguments[1])||arguments[1]),t.sort(mE),t}intersectObjects(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];for(let i=0,r=e.length;i<r;i++)gE(e[i],this,n,t);return n.sort(mE),n}};function mE(e,t){return e.distance-t.distance}function gE(e,t,n,i){if(e.layers.test(t.layers)&&e.raycast(t,n),!0===i){let i=e.children;for(let e=0,r=i.length;e<r;e++)gE(i[e],t,n,!0)}}var vE=class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return this.radius=e,this.phi=t,this.theta=n,this}set(e,t,n){return this.radius=e,this.phi=t,this.theta=n,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,n){return this.radius=Math.sqrt(e*e+t*t+n*n),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,n),this.phi=Math.acos($g(t/this.radius,-1,1))),this}clone(){return(new this.constructor).copy(this)}},yE=new lv,xE=class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new lv(1/0,1/0),t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new lv(-1/0,-1/0);this.isBox2=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromPoints(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){let n=yE.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}clone(){return(new this.constructor).copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(e){return this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y)}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return yE.copy(e).clamp(this.min,this.max).sub(e).length()}intersect(e){return this.min.max(e.min),this.max.min(e.max),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}},bE=new Lv,wE=new Lv,DE=class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Lv,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Lv;this.start=e,this.end=t}set(e,t){return this.start.copy(e),this.end.copy(t),this}copy(e){return this.start.copy(e.start),this.end.copy(e.end),this}getCenter(e){return e.addVectors(this.start,this.end).multiplyScalar(.5)}delta(e){return e.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(e,t){return this.delta(t).multiplyScalar(e).add(this.start)}closestPointToPointParameter(e,t){bE.subVectors(e,this.start),wE.subVectors(this.end,this.start);let n=wE.dot(wE),i=wE.dot(bE)/n;return t&&(i=$g(i,0,1)),i}closestPointToPoint(e,t,n){let i=this.closestPointToPointParameter(e,t);return this.delta(n).multiplyScalar(i).add(this.start)}applyMatrix4(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this}equals(e){return e.start.equals(this.start)&&e.end.equals(this.end)}clone(){return(new this.constructor).copy(this)}},_E=new Lv,SE=class extends zy{constructor(e,t){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=t,this.type="SpotLightHelper";let n=new dx,i=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let s=0,a=1,o=32;s<o;s++,a++){let e=s/o*Math.PI*2,t=a/o*Math.PI*2;i.push(Math.cos(e),Math.sin(e),1,Math.cos(t),Math.sin(t),1)}n.setAttribute("position",new rx(i,3));let r=new VD({fog:!1,toneMapped:!1});this.cone=new ZD(n,r),this.add(this.cone),this.update()}dispose(){this.cone.geometry.dispose(),this.cone.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1);let e=this.light.distance?this.light.distance:1e3,t=e*Math.tan(this.light.angle);this.cone.scale.set(t,t,e),_E.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(_E),void 0!==this.color?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}},EE=class extends Cx{constructor(e,t,n){super(new eS(t,4,2),new Jy({wireframe:!0,fog:!1,toneMapped:!1})),this.light=e,this.color=n,this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}dispose(){this.geometry.dispose(),this.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),void 0!==this.color?this.material.color.set(this.color):this.material.color.copy(this.light.color)}},CE=new Lv,AE=new Lv,ME=new Lv,TE=class extends zy{constructor(e,t,n){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=n,this.type="DirectionalLightHelper",void 0===t&&(t=1);let i=new dx;i.setAttribute("position",new rx([-t,t,0,t,t,0,t,-t,0,-t,-t,0,-t,t,0],3));let r=new VD({fog:!1,toneMapped:!1});this.lightPlane=new XD(i,r),this.add(this.lightPlane),i=new dx,i.setAttribute("position",new rx([0,0,0,0,0,1],3)),this.targetLine=new XD(i,r),this.add(this.targetLine),this.update()}dispose(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),CE.setFromMatrixPosition(this.light.matrixWorld),AE.setFromMatrixPosition(this.light.target.matrixWorld),ME.subVectors(AE,CE),this.lightPlane.lookAt(AE),void 0!==this.color?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(AE),this.targetLine.scale.z=ME.length()}},PE=new Lv,FE=new kx,OE=class extends ZD{constructor(e){let t=new dx,n=new VD({color:16777215,vertexColors:!0,toneMapped:!1}),i=[],r=[],s={};function a(e,t){o(e),o(t)}function o(e){i.push(0,0,0),r.push(0,0,0),void 0===s[e]&&(s[e]=[]),s[e].push(i.length/3-1)}a("n1","n2"),a("n2","n4"),a("n4","n3"),a("n3","n1"),a("f1","f2"),a("f2","f4"),a("f4","f3"),a("f3","f1"),a("n1","f1"),a("n2","f2"),a("n3","f3"),a("n4","f4"),a("p","n1"),a("p","n2"),a("p","n3"),a("p","n4"),a("u1","u2"),a("u2","u3"),a("u3","u1"),a("c","t"),a("p","c"),a("cn1","cn2"),a("cn3","cn4"),a("cf1","cf2"),a("cf3","cf4"),t.setAttribute("position",new rx(i,3)),t.setAttribute("color",new rx(r,3)),super(t,n),this.type="CameraHelper",this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=s,this.update();let l=new Ev(16755200),u=new Ev(16711680),c=new Ev(43775),h=new Ev(16777215),d=new Ev(3355443);this.setColors(l,u,c,h,d)}setColors(e,t,n,i,r){let s=this.geometry.getAttribute("color");s.setXYZ(0,e.r,e.g,e.b),s.setXYZ(1,e.r,e.g,e.b),s.setXYZ(2,e.r,e.g,e.b),s.setXYZ(3,e.r,e.g,e.b),s.setXYZ(4,e.r,e.g,e.b),s.setXYZ(5,e.r,e.g,e.b),s.setXYZ(6,e.r,e.g,e.b),s.setXYZ(7,e.r,e.g,e.b),s.setXYZ(8,e.r,e.g,e.b),s.setXYZ(9,e.r,e.g,e.b),s.setXYZ(10,e.r,e.g,e.b),s.setXYZ(11,e.r,e.g,e.b),s.setXYZ(12,e.r,e.g,e.b),s.setXYZ(13,e.r,e.g,e.b),s.setXYZ(14,e.r,e.g,e.b),s.setXYZ(15,e.r,e.g,e.b),s.setXYZ(16,e.r,e.g,e.b),s.setXYZ(17,e.r,e.g,e.b),s.setXYZ(18,e.r,e.g,e.b),s.setXYZ(19,e.r,e.g,e.b),s.setXYZ(20,e.r,e.g,e.b),s.setXYZ(21,e.r,e.g,e.b),s.setXYZ(22,e.r,e.g,e.b),s.setXYZ(23,e.r,e.g,e.b),s.setXYZ(24,t.r,t.g,t.b),s.setXYZ(25,t.r,t.g,t.b),s.setXYZ(26,t.r,t.g,t.b),s.setXYZ(27,t.r,t.g,t.b),s.setXYZ(28,t.r,t.g,t.b),s.setXYZ(29,t.r,t.g,t.b),s.setXYZ(30,t.r,t.g,t.b),s.setXYZ(31,t.r,t.g,t.b),s.setXYZ(32,n.r,n.g,n.b),s.setXYZ(33,n.r,n.g,n.b),s.setXYZ(34,n.r,n.g,n.b),s.setXYZ(35,n.r,n.g,n.b),s.setXYZ(36,n.r,n.g,n.b),s.setXYZ(37,n.r,n.g,n.b),s.setXYZ(38,i.r,i.g,i.b),s.setXYZ(39,i.r,i.g,i.b),s.setXYZ(40,r.r,r.g,r.b),s.setXYZ(41,r.r,r.g,r.b),s.setXYZ(42,r.r,r.g,r.b),s.setXYZ(43,r.r,r.g,r.b),s.setXYZ(44,r.r,r.g,r.b),s.setXYZ(45,r.r,r.g,r.b),s.setXYZ(46,r.r,r.g,r.b),s.setXYZ(47,r.r,r.g,r.b),s.setXYZ(48,r.r,r.g,r.b),s.setXYZ(49,r.r,r.g,r.b),s.needsUpdate=!0}update(){let e=this.geometry,t=this.pointMap;FE.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),IE("c",t,e,FE,0,0,-1),IE("t",t,e,FE,0,0,1),IE("n1",t,e,FE,-1,-1,-1),IE("n2",t,e,FE,1,-1,-1),IE("n3",t,e,FE,-1,1,-1),IE("n4",t,e,FE,1,1,-1),IE("f1",t,e,FE,-1,-1,1),IE("f2",t,e,FE,1,-1,1),IE("f3",t,e,FE,-1,1,1),IE("f4",t,e,FE,1,1,1),IE("u1",t,e,FE,.7,1.1,-1),IE("u2",t,e,FE,-.7,1.1,-1),IE("u3",t,e,FE,0,2,-1),IE("cf1",t,e,FE,-1,0,1),IE("cf2",t,e,FE,1,0,1),IE("cf3",t,e,FE,0,-1,1),IE("cf4",t,e,FE,0,1,1),IE("cn1",t,e,FE,-1,0,-1),IE("cn2",t,e,FE,1,0,-1),IE("cn3",t,e,FE,0,-1,-1),IE("cn4",t,e,FE,0,1,-1),e.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}};function IE(e,t,n,i,r,s,a){PE.set(r,s,a).unproject(i);let o=t[e];if(void 0!==o){let e=n.getAttribute("position");for(let t=0,n=o.length;t<n;t++)e.setXYZ(o[t],PE.x,PE.y,PE.z)}}var kE=class extends ZD{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:16776960,n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),i=new dx;i.setIndex(new tx(n,1)),i.setAttribute("position",new rx([1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],3)),super(i,new VD({color:t,toneMapped:!1})),this.box=e,this.type="Box3Helper",this.geometry.computeBoundingSphere()}updateMatrixWorld(e){let t=this.box;t.isEmpty()||(t.getCenter(this.position),t.getSize(this.scale),this.scale.multiplyScalar(.5),super.updateMatrixWorld(e))}dispose(){this.geometry.dispose(),this.material.dispose()}},BE=class extends ZD{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=[0,0,0,e,0,0,0,0,0,0,e,0,0,0,0,0,0,e],n=new dx;n.setAttribute("position",new rx(t,3)),n.setAttribute("color",new rx([1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],3)),super(n,new VD({vertexColors:!0,toneMapped:!1})),this.type="AxesHelper"}setColors(e,t,n){let i=new Ev,r=this.geometry.attributes.color.array;return i.set(e),i.toArray(r,0),i.toArray(r,3),i.set(t),i.toArray(r,6),i.toArray(r,9),i.set(n),i.toArray(r,12),i.toArray(r,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}},RE=function(){let e=new ArrayBuffer(4),t=new Float32Array(e),n=new Uint32Array(e),i=new Uint32Array(512),r=new Uint32Array(512);for(let l=0;l<256;++l){let e=l-127;e<-27?(i[l]=0,i[256|l]=32768,r[l]=24,r[256|l]=24):e<-14?(i[l]=1024>>-e-14,i[256|l]=1024>>-e-14|32768,r[l]=-e-1,r[256|l]=-e-1):e<=15?(i[l]=e+15<<10,i[256|l]=e+15<<10|32768,r[l]=13,r[256|l]=13):e<128?(i[l]=31744,i[256|l]=64512,r[l]=24,r[256|l]=24):(i[l]=31744,i[256|l]=64512,r[l]=13,r[256|l]=13)}let s=new Uint32Array(2048),a=new Uint32Array(64),o=new Uint32Array(64);for(let l=1;l<1024;++l){let e=l<<13,t=0;for(;0===(8388608&e);)e<<=1,t-=8388608;e&=-8388609,t+=947912704,s[l]=e|t}for(let l=1024;l<2048;++l)s[l]=939524096+(l-1024<<13);for(let l=1;l<31;++l)a[l]=l<<23;a[31]=1199570944,a[32]=2147483648;for(let l=33;l<63;++l)a[l]=2147483648+(l-32<<23);a[63]=3347054592;for(let l=1;l<64;++l)32!==l&&(o[l]=1024);return{floatView:t,uint32View:n,baseTable:i,shiftTable:r,mantissaTable:s,exponentTable:a,offsetTable:o}}();var LE=Object.freeze({__proto__:null,fromHalfFloat:function(e){let t=e>>10;return RE.uint32View[0]=RE.mantissaTable[RE.offsetTable[t]+(1023&e)]+RE.exponentTable[t],RE.floatView[0]},toHalfFloat:function(e){Math.abs(e)>65504&&console.warn("THREE.DataUtils.toHalfFloat(): Value out of range."),e=$g(e,-65504,65504),RE.floatView[0]=e;let t=RE.uint32View[0],n=t>>23&511;return RE.baseTable[n]+((8388607&t)>>RE.shiftTable[n])}});typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:Bm}})),typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=Bm);var zE=".",NE=Symbol("target"),jE=Symbol("unsubscribe");function UE(e){return e instanceof Date||e instanceof Set||e instanceof Map||e instanceof WeakSet||e instanceof WeakMap||ArrayBuffer.isView(e)}var VE=Array.isArray;function HE(e){return"symbol"==typeof e}var WE={after:(e,t)=>VE(e)?e.slice(t.length):""===t?e:e.slice(t.length+1),concat:(e,t)=>VE(e)?(e=[...e],t&&e.push(t),e):t&&void 0!==t.toString?(""!==e&&(e+=zE),HE(t)?e+t.toString():e+t):e,initial:e=>{if(VE(e))return e.slice(0,-1);if(""===e)return e;let t=e.lastIndexOf(zE);return-1===t?"":e.slice(0,t)},last:e=>{if(VE(e))return e[e.length-1]||"";if(""===e)return e;let t=e.lastIndexOf(zE);return-1===t?e:e.slice(t+1)},walk:(e,t)=>{if(VE(e))for(let n of e)t(n);else if(""!==e){let n=0,i=e.indexOf(zE);if(-1===i)t(e);else for(;n<e.length;)-1===i&&(i=e.length),t(e.slice(n,i)),n=i+1,i=e.indexOf(zE,n)}},get(e,t){return this.walk(t,(t=>{e&&(e=e[t])})),e}},GE=WE;function qE(e,t,n){return e.isUnsubscribed||t.ignoreSymbols&&HE(n)||t.ignoreUnderscores&&"_"===n.charAt(0)||"ignoreKeys"in t&&t.ignoreKeys.includes(n)}var YE=class{constructor(e){this._equals=e,this._proxyCache=new WeakMap,this._pathCache=new WeakMap,this.isUnsubscribed=!1}_getDescriptorCache(){return void 0===this._descriptorCache&&(this._descriptorCache=new WeakMap),this._descriptorCache}_getProperties(e){let t=this._getDescriptorCache(),n=t.get(e);return void 0===n&&(n={},t.set(e,n)),n}_getOwnPropertyDescriptor(e,t){if(this.isUnsubscribed)return Reflect.getOwnPropertyDescriptor(e,t);let n=this._getProperties(e),i=n[t];return void 0===i&&(i=Reflect.getOwnPropertyDescriptor(e,t),n[t]=i),i}getProxy(e,t,n,i){if(this.isUnsubscribed)return e;let r=e[i],s=r||e;this._pathCache.set(s,t);let a=this._proxyCache.get(s);return void 0===a&&(a=void 0===r?new Proxy(e,n):e,this._proxyCache.set(s,a)),a}getPath(e){return this.isUnsubscribed?void 0:this._pathCache.get(e)}isDetached(e,t){return!Object.is(e,GE.get(t,this.getPath(e)))}defineProperty(e,t,n){return!!Reflect.defineProperty(e,t,n)&&(this.isUnsubscribed||(this._getProperties(e)[t]=n),!0)}setProperty(e,t,n,i,r){if(!this._equals(r,n)||!(t in e)){let r=this._getOwnPropertyDescriptor(e,t);return void 0!==r&&"set"in r?Reflect.set(e,t,n,i):Reflect.set(e,t,n)}return!0}deleteProperty(e,t,n){if(Reflect.deleteProperty(e,t)){if(!this.isUnsubscribed){let i=this._getDescriptorCache().get(e);i&&(delete i[t],this._pathCache.delete(n))}return!0}return!1}isSameDescriptor(e,t,n){let i=this._getOwnPropertyDescriptor(t,n);return void 0!==e&&void 0!==i&&Object.is(e.value,i.value)&&(e.writable||!1)===(i.writable||!1)&&(e.enumerable||!1)===(i.enumerable||!1)&&(e.configurable||!1)===(i.configurable||!1)&&e.get===i.get&&e.set===i.set}isGetInvariant(e,t){let n=this._getOwnPropertyDescriptor(e,t);return void 0!==n&&!0!==n.configurable&&!0!==n.writable}unsubscribe(){this._descriptorCache=null,this._pathCache=null,this._proxyCache=null,this.isUnsubscribed=!0}};function XE(e){return"[object Object]"===toString.call(e)}function QE(){return!0}function KE(e,t){return e.length!==t.length||e.some(((e,n)=>t[n]!==e))}var ZE=new Set(["hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]),JE=new Set(["concat","includes","indexOf","join","keys","lastIndexOf"]),$E={push:QE,pop:QE,shift:QE,unshift:QE,copyWithin:KE,reverse:KE,sort:KE,splice:KE,flat:KE,fill:KE},eC=new Set([...ZE,...JE,...Object.keys($E)]);function tC(e,t){if(e.size!==t.size)return!0;for(let n of e)if(!t.has(n))return!0;return!1}var nC=["keys","values","entries"],iC=new Set(["has","toString"]),rC={add:tC,clear:tC,delete:tC,forEach:tC},sC=new Set([...iC,...Object.keys(rC),...nC]);function aC(e,t){if(e.size!==t.size)return!0;let n;for(let[i,r]of e)if(n=t.get(i),n!==r||void 0===n&&!t.has(i))return!0;return!1}var oC=new Set([...iC,"get"]),lC={set:aC,clear:aC,delete:aC,forEach:aC},uC=new Set([...oC,...Object.keys(lC),...nC]),cC=class{constructor(e,t,n,i){this._path=t,this._isChanged=!1,this._clonedCache=new Set,this._hasOnValidate=i,this._changes=i?[]:null,this.clone=void 0===t?e:this._shallowClone(e)}static isHandledMethod(e){return ZE.has(e)}_shallowClone(e){let t=e;if(XE(e))t=d({},e);else if(VE(e))t=[...e];else if(e instanceof Date)t=new Date(e);else if(e instanceof Set)t=new Set([...e].map((e=>this._shallowClone(e))));else if(e instanceof Map){t=new Map;for(let[n,i]of e.entries())t.set(n,this._shallowClone(i))}return this._clonedCache.add(t),t}preferredThisArg(e,t,n,i){return e?(VE(i)?this._onIsChanged=$E[t]:i instanceof Set?this._onIsChanged=rC[t]:i instanceof Map&&(this._onIsChanged=lC[t]),i):n}update(e,t,n){let i=GE.after(e,this._path);if("length"!==t){let e=this.clone;GE.walk(i,(t=>{e&&e[t]&&(this._clonedCache.has(e[t])||(e[t]=this._shallowClone(e[t])),e=e[t])})),this._hasOnValidate&&this._changes.push({path:i,property:t,previous:n}),e&&e[t]&&(e[t]=n)}this._isChanged=!0}undo(e){let t;for(let n=this._changes.length-1;-1!==n;n--)t=this._changes[n],GE.get(e,t.path)[t.property]=t.previous}isChanged(e){return void 0===this._onIsChanged?this._isChanged:this._onIsChanged(this.clone,e)}},hC=class extends cC{static isHandledMethod(e){return eC.has(e)}},dC=class extends cC{undo(e){e.setTime(this.clone.getTime())}isChanged(e,t){return!t(this.clone.valueOf(),e.valueOf())}},pC=class extends cC{static isHandledMethod(e){return sC.has(e)}undo(e){for(let t of this.clone)e.add(t);for(let t of e)this.clone.has(t)||e.delete(t)}},fC=class extends cC{static isHandledMethod(e){return uC.has(e)}undo(e){for(let[t,n]of this.clone.entries())e.set(t,n);for(let t of e.keys())this.clone.has(t)||e.delete(t)}},mC=class extends cC{constructor(e,t,n,i){super(void 0,t,n,i),this._arg1=n[0],this._weakValue=e.has(this._arg1)}isChanged(e){return this._weakValue!==e.has(this._arg1)}undo(e){this._weakValue&&!e.has(this._arg1)?e.add(this._arg1):e.delete(this._arg1)}},gC=class extends cC{constructor(e,t,n,i){super(void 0,t,n,i),this._weakKey=n[0],this._weakHas=e.has(this._weakKey),this._weakValue=e.get(this._weakKey)}isChanged(e){return this._weakValue!==e.get(this._weakKey)}undo(e){let t=e.has(this._weakKey);this._weakHas&&!t?e.set(this._weakKey,this._weakValue):!this._weakHas&&t?e.delete(this._weakKey):this._weakValue!==e.get(this._weakKey)&&e.set(this._weakKey,this._weakValue)}},vC=class{constructor(e){this._stack=[],this._hasOnValidate=e}static isHandledType(e){return XE(e)||VE(e)||UE(e)}static isHandledMethod(e,t){return XE(e)?cC.isHandledMethod(t):VE(e)?hC.isHandledMethod(t):e instanceof Set?pC.isHandledMethod(t):e instanceof Map?fC.isHandledMethod(t):UE(e)}get isCloning(){return this._stack.length>0}start(e,t,n){let i=cC;VE(e)?i=hC:e instanceof Date?i=dC:e instanceof Set?i=pC:e instanceof Map?i=fC:e instanceof WeakSet?i=mC:e instanceof WeakMap&&(i=gC),this._stack.push(new i(e,t,n,this._hasOnValidate))}update(e,t,n){this._stack[this._stack.length-1].update(e,t,n)}preferredThisArg(e,t,n){let{name:i}=e,r=vC.isHandledMethod(n,i);return this._stack[this._stack.length-1].preferredThisArg(r,i,t,n)}isChanged(e,t,n){return this._stack[this._stack.length-1].isChanged(e,t,n)}undo(e){void 0!==this._previousClone&&this._previousClone.undo(e)}stop(){return this._previousClone=this._stack.pop(),this._previousClone.clone}},yC={equals:Object.is,isShallow:!1,pathAsArray:!1,ignoreSymbols:!1,ignoreUnderscores:!1,ignoreDetached:!1,details:!1},xC=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};n=d(d({},yC),n);let i=Symbol("ProxyTarget"),{equals:r,isShallow:s,ignoreDetached:a,details:o}=n,l=new YE(r),u="function"==typeof n.onValidate,c=new vC(u),h=(e,t,i,r,s)=>!u||c.isCloning||!0===n.onValidate(GE.concat(l.getPath(e),t),i,r,s),p=(t,i,r,s)=>{!qE(l,n,i)&&(!a||!l.isDetached(t,e))&&f(l.getPath(t),i,r,s)},f=(e,n,i,r,s)=>{c.isCloning?c.update(e,n,r):t(GE.concat(e,n),i,r,s)},m=e=>e&&(e[i]||e),g=(t,r,o,u)=>function(e){return("object"==typeof e?null===e:"function"!=typeof e)||e instanceof RegExp}(t)||"constructor"===o||s&&!vC.isHandledMethod(r,o)||qE(l,n,o)||l.isGetInvariant(r,o)||a&&l.isDetached(r,e)?t:(void 0===u&&(u=l.getPath(r)),l.getProxy(t,GE.concat(u,o),v,i)),v={get(e,t,n){if(HE(t)){if(t===i||t===NE)return e;if(t===jE&&!l.isUnsubscribed&&0===l.getPath(e).length)return l.unsubscribe(),e}let r=UE(e)?Reflect.get(e,t):Reflect.get(e,t,n);return g(r,e,t)},set(e,t,n,s){n=m(n);let a=e[i]||e,o=a[t];if(r(o,n)&&t in e)return!0;let u=h(e,t,n,o);return u&&l.setProperty(a,t,n,s,o)?(p(e,t,e[t],o),!0):!u},defineProperty(e,t,n){if(!l.isSameDescriptor(n,e,t)){let i=e[t];h(e,t,n.value,i)&&l.defineProperty(e,t,n,i)&&p(e,t,n.value,i)}return!0},deleteProperty(e,t){if(!Reflect.has(e,t))return!0;let n=Reflect.get(e,t),i=h(e,t,void 0,n);return i&&l.deleteProperty(e,t,n)?(p(e,t,void 0,n),!0):!i},apply(t,n,s){let a=n[i]||n;if(l.isUnsubscribed)return Reflect.apply(t,a,s);if((!1===o||!0!==o&&!o.includes(t.name))&&vC.isHandledType(a)){let i=GE.initial(l.getPath(t)),o=vC.isHandledMethod(a,t.name);c.start(a,i,s);let u=Reflect.apply(t,c.preferredThisArg(t,n,a),o?s.map((e=>m(e))):s),d=c.isChanged(a,r),p=c.stop();if(vC.isHandledType(u)&&o&&(n instanceof Map&&"get"===t.name&&(i=GE.concat(i,s[0])),u=l.getProxy(u,i,v)),d){let n={name:t.name,args:s,result:u},r=c.isCloning?GE.initial(i):i,o=c.isCloning?GE.last(i):"";h(GE.get(e,r),o,a,p,n)?f(r,o,a,p,n):c.undo(a)}return(n instanceof Map||n instanceof Set)&&function(e){return"object"==typeof e&&"function"==typeof e.next}(u)?function(e,t,n,i,r){let s=e.next;if("entries"===t.name)e.next=function(){let e=s.call(this);return!1===e.done&&(e.value[0]=r(e.value[0],t,e.value[0],i),e.value[1]=r(e.value[1],t,e.value[0],i)),e};else if("values"===t.name){let a=n[NE].keys();e.next=function(){let e=s.call(this);return!1===e.done&&(e.value=r(e.value,t,a.next().value,i)),e}}else e.next=function(){let e=s.call(this);return!1===e.done&&(e.value=r(e.value,t,e.value,i)),e};return e}(u,t,n,i,g):u}return Reflect.apply(t,n,s)}},y=l.getProxy(e,n.pathAsArray?[]:"",v);return t=t.bind(y),u&&(n.onValidate=n.onValidate.bind(y)),y};xC.target=e=>e&&e[NE]||e,xC.unsubscribe=e=>e[jE]||e;var bC=xC,wC="object"==typeof global&&global&&global.Object===Object&&global,DC="object"==typeof self&&self&&self.Object===Object&&self,_C=wC||DC||Function("return this")(),SC=_C.Symbol,EC=Object.prototype,CC=EC.hasOwnProperty,AC=EC.toString,MC=SC?SC.toStringTag:void 0;var TC=function(e){var t=CC.call(e,MC),n=e[MC];try{e[MC]=void 0;var i=!0}catch(s){}var r=AC.call(e);return i&&(t?e[MC]=n:delete e[MC]),r},PC=Object.prototype.toString;var FC=function(e){return PC.call(e)},OC=SC?SC.toStringTag:void 0;var IC=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":OC&&OC in Object(e)?TC(e):FC(e)};var kC=function(e){return null!=e&&"object"==typeof e};var BC=function(e){return"symbol"==typeof e||kC(e)&&"[object Symbol]"==IC(e)};var RC=function(e,t){for(var n=-1,i=null==e?0:e.length,r=Array(i);++n<i;)r[n]=t(e[n],n,e);return r},LC=Array.isArray,zC=1/0,NC=SC?SC.prototype:void 0,jC=NC?NC.toString:void 0;var UC=function e(t){if("string"==typeof t)return t;if(LC(t))return RC(t,e)+"";if(BC(t))return jC?jC.call(t):"";var n=t+"";return"0"==n&&1/t==-zC?"-0":n},VC=/\s/;var HC=function(e){for(var t=e.length;t--&&VC.test(e.charAt(t)););return t},WC=/^\s+/;var GC=function(e){return e&&e.slice(0,HC(e)+1).replace(WC,"")};var qC=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)},YC=/^[-+]0x[0-9a-f]+$/i,XC=/^0b[01]+$/i,QC=/^0o[0-7]+$/i,KC=parseInt;var ZC=function(e){if("number"==typeof e)return e;if(BC(e))return NaN;if(qC(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=qC(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=GC(e);var n=XC.test(e);return n||QC.test(e)?KC(e.slice(2),n?2:8):YC.test(e)?NaN:+e};var JC=function(e){return e};var $C=function(e){if(!qC(e))return!1;var t=IC(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t},eA=_C["__core-js_shared__"],tA=function(){var e=/[^.]+$/.exec(eA&&eA.keys&&eA.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();var nA=function(e){return!!tA&&tA in e},iA=Function.prototype.toString;var rA=function(e){if(null!=e){try{return iA.call(e)}catch(t){}try{return e+""}catch(n){}}return""},sA=/^\[object .+?Constructor\]$/,aA=Function.prototype,oA=Object.prototype,lA=aA.toString,uA=oA.hasOwnProperty,cA=RegExp("^"+lA.call(uA).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");var hA=function(e){return!(!qC(e)||nA(e))&&($C(e)?cA:sA).test(rA(e))};var dA=function(e,t){return null===e||void 0===e?void 0:e[t]};var pA=function(e,t){var n=dA(e,t);return hA(n)?n:void 0},fA=pA(_C,"WeakMap"),mA=Object.create,gA=function(){function e(){}return function(t){if(!qC(t))return{};if(mA)return mA(t);e.prototype=t;var n=new e;return e.prototype=void 0,n}}(),vA=gA;var yA=function(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)};var xA=function(e,t){var n=-1,i=e.length;for(t||(t=Array(i));++n<i;)t[n]=e[n];return t},bA=Date.now;var wA=function(e){var t=0,n=0;return function(){var i=bA(),r=16-(i-n);if(n=i,r>0){if(++t>=800)return arguments[0]}else t=0;return e.apply(void 0,arguments)}};var DA=function(e){return function(){return e}},_A=function(){try{var e=pA(Object,"defineProperty");return e({},"",{}),e}catch(t){}}(),SA=wA(_A?function(e,t){return _A(e,"toString",{configurable:!0,enumerable:!1,value:DA(t),writable:!0})}:JC);var EA=function(e,t){for(var n=-1,i=null==e?0:e.length;++n<i&&!1!==t(e[n],n,e););return e},CA=/^(?:0|[1-9]\d*)$/;var AA=function(e,t){var n=typeof e;return!!(t=null!==t&&void 0!==t?t:9007199254740991)&&("number"==n||"symbol"!=n&&CA.test(e))&&e>-1&&e%1==0&&e<t};var MA=function(e,t,n){"__proto__"==t&&_A?_A(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n};var TA=function(e,t){return e===t||e!==e&&t!==t},PA=Object.prototype.hasOwnProperty;var FA=function(e,t,n){var i=e[t];(!PA.call(e,t)||!TA(i,n)||void 0===n&&!(t in e))&&MA(e,t,n)};var OA=function(e,t,n,i){var r=!n;n||(n={});for(var s=-1,a=t.length;++s<a;){var o=t[s],l=i?i(n[o],e[o],o,n,e):void 0;void 0===l&&(l=e[o]),r?MA(n,o,l):FA(n,o,l)}return n},IA=Math.max;var kA=function(e,t,n){return t=IA(void 0===t?e.length-1:t,0),function(){for(var i=arguments,r=-1,s=IA(i.length-t,0),a=Array(s);++r<s;)a[r]=i[t+r];r=-1;for(var o=Array(t+1);++r<t;)o[r]=i[r];return o[t]=n(a),yA(e,this,o)}};var BA=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991};var RA=function(e){return null!=e&&BA(e.length)&&!$C(e)},LA=Object.prototype;var zA=function(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||LA)};var NA=function(e,t){for(var n=-1,i=Array(e);++n<e;)i[n]=t(n);return i};var jA=function(e){return kC(e)&&"[object Arguments]"==IC(e)},UA=Object.prototype,VA=UA.hasOwnProperty,HA=UA.propertyIsEnumerable,WA=jA(function(){return arguments}())?jA:function(e){return kC(e)&&VA.call(e,"callee")&&!HA.call(e,"callee")};var GA=function(){return!1},qA="object"==typeof exports&&exports&&!exports.nodeType&&exports,YA=qA&&"object"==typeof module&&module&&!module.nodeType&&module,XA=YA&&YA.exports===qA?_C.Buffer:void 0,QA=(XA?XA.isBuffer:void 0)||GA,KA={};KA["[object Float32Array]"]=KA["[object Float64Array]"]=KA["[object Int8Array]"]=KA["[object Int16Array]"]=KA["[object Int32Array]"]=KA["[object Uint8Array]"]=KA["[object Uint8ClampedArray]"]=KA["[object Uint16Array]"]=KA["[object Uint32Array]"]=!0,KA["[object Arguments]"]=KA["[object Array]"]=KA["[object ArrayBuffer]"]=KA["[object Boolean]"]=KA["[object DataView]"]=KA["[object Date]"]=KA["[object Error]"]=KA["[object Function]"]=KA["[object Map]"]=KA["[object Number]"]=KA["[object Object]"]=KA["[object RegExp]"]=KA["[object Set]"]=KA["[object String]"]=KA["[object WeakMap]"]=!1;var ZA=function(e){return kC(e)&&BA(e.length)&&!!KA[IC(e)]};var JA=function(e){return function(t){return e(t)}},$A="object"==typeof exports&&exports&&!exports.nodeType&&exports,eM=$A&&"object"==typeof module&&module&&!module.nodeType&&module,tM=eM&&eM.exports===$A&&wC.process,nM=function(){try{return eM&&eM.require&&eM.require("util").types||tM&&tM.binding&&tM.binding("util")}catch(e){}}(),iM=nM&&nM.isTypedArray,rM=iM?JA(iM):ZA,sM=Object.prototype.hasOwnProperty;var aM=function(e,t){var n=LC(e),i=!n&&WA(e),r=!n&&!i&&QA(e),s=!n&&!i&&!r&&rM(e),a=n||i||r||s,o=a?NA(e.length,String):[],l=o.length;for(var u in e)(t||sM.call(e,u))&&(!a||!("length"==u||r&&("offset"==u||"parent"==u)||s&&("buffer"==u||"byteLength"==u||"byteOffset"==u)||AA(u,l)))&&o.push(u);return o};var oM=function(e,t){return function(n){return e(t(n))}},lM=oM(Object.keys,Object),uM=Object.prototype.hasOwnProperty;var cM=function(e){if(!zA(e))return lM(e);var t=[];for(var n in Object(e))uM.call(e,n)&&"constructor"!=n&&t.push(n);return t};var hM=function(e){return RA(e)?aM(e):cM(e)};var dM=function(e){var t=[];if(null!=e)for(var n in Object(e))t.push(n);return t},pM=Object.prototype.hasOwnProperty;var fM=function(e){if(!qC(e))return dM(e);var t=zA(e),n=[];for(var i in e)"constructor"==i&&(t||!pM.call(e,i))||n.push(i);return n};var mM=function(e){return RA(e)?aM(e,!0):fM(e)},gM=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,vM=/^\w*$/;var yM=function(e,t){if(LC(e))return!1;var n=typeof e;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=e&&!BC(e))||(vM.test(e)||!gM.test(e)||null!=t&&e in Object(t))},xM=pA(Object,"create");var bM=function(){this.__data__=xM?xM(null):{},this.size=0};var wM=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},DM=Object.prototype.hasOwnProperty;var _M=function(e){var t=this.__data__;if(xM){var n=t[e];return"__lodash_hash_undefined__"===n?void 0:n}return DM.call(t,e)?t[e]:void 0},SM=Object.prototype.hasOwnProperty;var EM=function(e){var t=this.__data__;return xM?void 0!==t[e]:SM.call(t,e)};var CM=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=xM&&void 0===t?"__lodash_hash_undefined__":t,this};function AM(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var i=e[t];this.set(i[0],i[1])}}AM.prototype.clear=bM,AM.prototype.delete=wM,AM.prototype.get=_M,AM.prototype.has=EM,AM.prototype.set=CM;var MM=AM;var TM=function(){this.__data__=[],this.size=0};var PM=function(e,t){for(var n=e.length;n--;)if(TA(e[n][0],t))return n;return-1},FM=Array.prototype.splice;var OM=function(e){var t=this.__data__,n=PM(t,e);return!(n<0)&&(n==t.length-1?t.pop():FM.call(t,n,1),--this.size,!0)};var IM=function(e){var t=this.__data__,n=PM(t,e);return n<0?void 0:t[n][1]};var kM=function(e){return PM(this.__data__,e)>-1};var BM=function(e,t){var n=this.__data__,i=PM(n,e);return i<0?(++this.size,n.push([e,t])):n[i][1]=t,this};function RM(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var i=e[t];this.set(i[0],i[1])}}RM.prototype.clear=TM,RM.prototype.delete=OM,RM.prototype.get=IM,RM.prototype.has=kM,RM.prototype.set=BM;var LM=RM,zM=pA(_C,"Map");var NM=function(){this.size=0,this.__data__={hash:new MM,map:new(zM||LM),string:new MM}};var jM=function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e};var UM=function(e,t){var n=e.__data__;return jM(t)?n["string"==typeof t?"string":"hash"]:n.map};var VM=function(e){var t=UM(this,e).delete(e);return this.size-=t?1:0,t};var HM=function(e){return UM(this,e).get(e)};var WM=function(e){return UM(this,e).has(e)};var GM=function(e,t){var n=UM(this,e),i=n.size;return n.set(e,t),this.size+=n.size==i?0:1,this};function qM(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var i=e[t];this.set(i[0],i[1])}}qM.prototype.clear=NM,qM.prototype.delete=VM,qM.prototype.get=HM,qM.prototype.has=WM,qM.prototype.set=GM;var YM=qM;function XM(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new TypeError("Expected a function");var n=function(){var i=arguments,r=t?t.apply(this,i):i[0],s=n.cache;if(s.has(r))return s.get(r);var a=e.apply(this,i);return n.cache=s.set(r,a)||s,a};return n.cache=new(XM.Cache||YM),n}XM.Cache=YM;var QM=XM;var KM=function(e){var t=QM(e,(function(e){return 500===n.size&&n.clear(),e})),n=t.cache;return t},ZM=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,JM=/\\(\\)?/g,$M=KM((function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(ZM,(function(e,n,i,r){t.push(i?r.replace(JM,"$1"):n||e)})),t})),eT=$M;var tT=function(e){return null==e?"":UC(e)};var nT=function(e,t){return LC(e)?e:yM(e,t)?[e]:eT(tT(e))},iT=1/0;var rT=function(e){if("string"==typeof e||BC(e))return e;var t=e+"";return"0"==t&&1/e==-iT?"-0":t};var sT=function(e,t){for(var n=0,i=(t=nT(t,e)).length;null!=e&&n<i;)e=e[rT(t[n++])];return n&&n==i?e:void 0};var aT=function(e,t){for(var n=-1,i=t.length,r=e.length;++n<i;)e[r+n]=t[n];return e},oT=SC?SC.isConcatSpreadable:void 0;var lT=function(e){return LC(e)||WA(e)||!!(oT&&e&&e[oT])};var uT=function e(t,n,i,r,s){var a=-1,o=t.length;for(i||(i=lT),s||(s=[]);++a<o;){var l=t[a];n>0&&i(l)?n>1?e(l,n-1,i,r,s):aT(s,l):r||(s[s.length]=l)}return s};var cT=function(e){return(null==e?0:e.length)?uT(e,1):[]};var hT=function(e){return SA(kA(e,void 0,cT),e+"")},dT=oM(Object.getPrototypeOf,Object),pT=Function.prototype,fT=Object.prototype,mT=pT.toString,gT=fT.hasOwnProperty,vT=mT.call(Object);var yT=function(e){if(!kC(e)||"[object Object]"!=IC(e))return!1;var t=dT(e);if(null===t)return!0;var n=gT.call(t,"constructor")&&t.constructor;return"function"==typeof n&&n instanceof n&&mT.call(n)==vT};var xT=function(e,t,n){var i=-1,r=e.length;t<0&&(t=-t>r?0:r+t),(n=n>r?r:n)<0&&(n+=r),r=t>n?0:n-t>>>0,t>>>=0;for(var s=Array(r);++i<r;)s[i]=e[i+t];return s};var bT=function(){this.__data__=new LM,this.size=0};var wT=function(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n};var DT=function(e){return this.__data__.get(e)};var _T=function(e){return this.__data__.has(e)};var ST=function(e,t){var n=this.__data__;if(n instanceof LM){var i=n.__data__;if(!zM||i.length<199)return i.push([e,t]),this.size=++n.size,this;n=this.__data__=new YM(i)}return n.set(e,t),this.size=n.size,this};function ET(e){var t=this.__data__=new LM(e);this.size=t.size}ET.prototype.clear=bT,ET.prototype.delete=wT,ET.prototype.get=DT,ET.prototype.has=_T,ET.prototype.set=ST;var CT=ET;var AT=function(e,t){return e&&OA(t,hM(t),e)};var MT=function(e,t){return e&&OA(t,mM(t),e)},TT="object"==typeof exports&&exports&&!exports.nodeType&&exports,PT=TT&&"object"==typeof module&&module&&!module.nodeType&&module,FT=PT&&PT.exports===TT?_C.Buffer:void 0,OT=FT?FT.allocUnsafe:void 0;var IT=function(e,t){if(t)return e.slice();var n=e.length,i=OT?OT(n):new e.constructor(n);return e.copy(i),i};var kT=function(e,t){for(var n=-1,i=null==e?0:e.length,r=0,s=[];++n<i;){var a=e[n];t(a,n,e)&&(s[r++]=a)}return s};var BT=function(){return[]},RT=Object.prototype.propertyIsEnumerable,LT=Object.getOwnPropertySymbols,zT=LT?function(e){return null==e?[]:(e=Object(e),kT(LT(e),(function(t){return RT.call(e,t)})))}:BT;var NT=function(e,t){return OA(e,zT(e),t)},jT=Object.getOwnPropertySymbols?function(e){for(var t=[];e;)aT(t,zT(e)),e=dT(e);return t}:BT;var UT=function(e,t){return OA(e,jT(e),t)};var VT=function(e,t,n){var i=t(e);return LC(e)?i:aT(i,n(e))};var HT=function(e){return VT(e,hM,zT)};var WT=function(e){return VT(e,mM,jT)},GT=pA(_C,"DataView"),qT=pA(_C,"Promise"),YT=pA(_C,"Set"),XT="[object Map]",QT="[object Promise]",KT="[object Set]",ZT="[object WeakMap]",JT="[object DataView]",$T=rA(GT),eP=rA(zM),tP=rA(qT),nP=rA(YT),iP=rA(fA),rP=IC;(GT&&rP(new GT(new ArrayBuffer(1)))!=JT||zM&&rP(new zM)!=XT||qT&&rP(qT.resolve())!=QT||YT&&rP(new YT)!=KT||fA&&rP(new fA)!=ZT)&&(rP=function(e){var t=IC(e),n="[object Object]"==t?e.constructor:void 0,i=n?rA(n):"";if(i)switch(i){case $T:return JT;case eP:return XT;case tP:return QT;case nP:return KT;case iP:return ZT}return t});var sP=rP,aP=Object.prototype.hasOwnProperty;var oP=function(e){var t=e.length,n=new e.constructor(t);return t&&"string"==typeof e[0]&&aP.call(e,"index")&&(n.index=e.index,n.input=e.input),n},lP=_C.Uint8Array;var uP=function(e){var t=new e.constructor(e.byteLength);return new lP(t).set(new lP(e)),t};var cP=function(e,t){var n=t?uP(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.byteLength)},hP=/\w*$/;var dP=function(e){var t=new e.constructor(e.source,hP.exec(e));return t.lastIndex=e.lastIndex,t},pP=SC?SC.prototype:void 0,fP=pP?pP.valueOf:void 0;var mP=function(e){return fP?Object(fP.call(e)):{}};var gP=function(e,t){var n=t?uP(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)};var vP=function(e,t,n){var i=e.constructor;switch(t){case"[object ArrayBuffer]":return uP(e);case"[object Boolean]":case"[object Date]":return new i(+e);case"[object DataView]":return cP(e,n);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return gP(e,n);case"[object Map]":case"[object Set]":return new i;case"[object Number]":case"[object String]":return new i(e);case"[object RegExp]":return dP(e);case"[object Symbol]":return mP(e)}};var yP=function(e){return"function"!=typeof e.constructor||zA(e)?{}:vA(dT(e))};var xP=function(e){return kC(e)&&"[object Map]"==sP(e)},bP=nM&&nM.isMap,wP=bP?JA(bP):xP;var DP=function(e){return kC(e)&&"[object Set]"==sP(e)},_P=nM&&nM.isSet,SP=_P?JA(_P):DP,EP="[object Arguments]",CP="[object Function]",AP="[object Object]",MP={};MP[EP]=MP["[object Array]"]=MP["[object ArrayBuffer]"]=MP["[object DataView]"]=MP["[object Boolean]"]=MP["[object Date]"]=MP["[object Float32Array]"]=MP["[object Float64Array]"]=MP["[object Int8Array]"]=MP["[object Int16Array]"]=MP["[object Int32Array]"]=MP["[object Map]"]=MP["[object Number]"]=MP[AP]=MP["[object RegExp]"]=MP["[object Set]"]=MP["[object String]"]=MP["[object Symbol]"]=MP["[object Uint8Array]"]=MP["[object Uint8ClampedArray]"]=MP["[object Uint16Array]"]=MP["[object Uint32Array]"]=!0,MP["[object Error]"]=MP[CP]=MP["[object WeakMap]"]=!1;var TP=function e(t,n,i,r,s,a){var o,l=1&n,u=2&n,c=4&n;if(i&&(o=s?i(t,r,s,a):i(t)),void 0!==o)return o;if(!qC(t))return t;var h=LC(t);if(h){if(o=oP(t),!l)return xA(t,o)}else{var d=sP(t),p=d==CP||"[object GeneratorFunction]"==d;if(QA(t))return IT(t,l);if(d==AP||d==EP||p&&!s){if(o=u||p?{}:yP(t),!l)return u?UT(t,MT(o,t)):NT(t,AT(o,t))}else{if(!MP[d])return s?t:{};o=vP(t,d,l)}}a||(a=new CT);var f=a.get(t);if(f)return f;a.set(t,o),SP(t)?t.forEach((function(r){o.add(e(r,n,i,r,t,a))})):wP(t)&&t.forEach((function(r,s){o.set(s,e(r,n,i,s,t,a))}));var m=h?void 0:(c?u?WT:HT:u?mM:hM)(t);return EA(m||t,(function(r,s){m&&(r=t[s=r]),FA(o,s,e(r,n,i,s,t,a))})),o};var PP=function(e){return TP(e,5)};var FP=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this};var OP=function(e){return this.__data__.has(e)};function IP(e){var t=-1,n=null==e?0:e.length;for(this.__data__=new YM;++t<n;)this.add(e[t])}IP.prototype.add=IP.prototype.push=FP,IP.prototype.has=OP;var kP=IP;var BP=function(e,t){for(var n=-1,i=null==e?0:e.length;++n<i;)if(t(e[n],n,e))return!0;return!1};var RP=function(e,t){return e.has(t)};var LP=function(e,t,n,i,r,s){var a=1&n,o=e.length,l=t.length;if(o!=l&&!(a&&l>o))return!1;var u=s.get(e),c=s.get(t);if(u&&c)return u==t&&c==e;var h=-1,d=!0,p=2&n?new kP:void 0;for(s.set(e,t),s.set(t,e);++h<o;){var f=e[h],m=t[h];if(i)var g=a?i(m,f,h,t,e,s):i(f,m,h,e,t,s);if(void 0!==g){if(g)continue;d=!1;break}if(p){if(!BP(t,(function(e,t){if(!RP(p,t)&&(f===e||r(f,e,n,i,s)))return p.push(t)}))){d=!1;break}}else if(f!==m&&!r(f,m,n,i,s)){d=!1;break}}return s.delete(e),s.delete(t),d};var zP=function(e){var t=-1,n=Array(e.size);return e.forEach((function(e,i){n[++t]=[i,e]})),n};var NP=function(e){var t=-1,n=Array(e.size);return e.forEach((function(e){n[++t]=e})),n},jP=SC?SC.prototype:void 0,UP=jP?jP.valueOf:void 0;var VP=function(e,t,n,i,r,s,a){switch(n){case"[object DataView]":if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case"[object ArrayBuffer]":return!(e.byteLength!=t.byteLength||!s(new lP(e),new lP(t)));case"[object Boolean]":case"[object Date]":case"[object Number]":return TA(+e,+t);case"[object Error]":return e.name==t.name&&e.message==t.message;case"[object RegExp]":case"[object String]":return e==t+"";case"[object Map]":var o=zP;case"[object Set]":var l=1&i;if(o||(o=NP),e.size!=t.size&&!l)return!1;var u=a.get(e);if(u)return u==t;i|=2,a.set(e,t);var c=LP(o(e),o(t),i,r,s,a);return a.delete(e),c;case"[object Symbol]":if(UP)return UP.call(e)==UP.call(t)}return!1},HP=Object.prototype.hasOwnProperty;var WP=function(e,t,n,i,r,s){var a=1&n,o=HT(e),l=o.length;if(l!=HT(t).length&&!a)return!1;for(var u=l;u--;){var c=o[u];if(!(a?c in t:HP.call(t,c)))return!1}var h=s.get(e),d=s.get(t);if(h&&d)return h==t&&d==e;var p=!0;s.set(e,t),s.set(t,e);for(var f=a;++u<l;){var m=e[c=o[u]],g=t[c];if(i)var v=a?i(g,m,c,t,e,s):i(m,g,c,e,t,s);if(!(void 0===v?m===g||r(m,g,n,i,s):v)){p=!1;break}f||(f="constructor"==c)}if(p&&!f){var y=e.constructor,x=t.constructor;y!=x&&"constructor"in e&&"constructor"in t&&!("function"==typeof y&&y instanceof y&&"function"==typeof x&&x instanceof x)&&(p=!1)}return s.delete(e),s.delete(t),p},GP="[object Arguments]",qP="[object Array]",YP="[object Object]",XP=Object.prototype.hasOwnProperty;var QP=function(e,t,n,i,r,s){var a=LC(e),o=LC(t),l=a?qP:sP(e),u=o?qP:sP(t),c=(l=l==GP?YP:l)==YP,h=(u=u==GP?YP:u)==YP,d=l==u;if(d&&QA(e)){if(!QA(t))return!1;a=!0,c=!1}if(d&&!c)return s||(s=new CT),a||rM(e)?LP(e,t,n,i,r,s):VP(e,t,l,n,i,r,s);if(!(1&n)){var p=c&&XP.call(e,"__wrapped__"),f=h&&XP.call(t,"__wrapped__");if(p||f){var m=p?e.value():e,g=f?t.value():t;return s||(s=new CT),r(m,g,n,i,s)}}return!!d&&(s||(s=new CT),WP(e,t,n,i,r,s))};var KP=function e(t,n,i,r,s){return t===n||(null==t||null==n||!kC(t)&&!kC(n)?t!==t&&n!==n:QP(t,n,i,r,e,s))};var ZP=function(e,t){return null!=e&&t in Object(e)};var JP=function(e,t,n){for(var i=-1,r=(t=nT(t,e)).length,s=!1;++i<r;){var a=rT(t[i]);if(!(s=null!=e&&n(e,a)))break;e=e[a]}return s||++i!=r?s:!!(r=null==e?0:e.length)&&BA(r)&&AA(a,r)&&(LC(e)||WA(e))};var $P=function(e,t){return null!=e&&JP(e,t,ZP)},eF=function(){return _C.Date.now()},tF=Math.max,nF=Math.min;var iF=function(e,t,n){var i,r,s,a,o,l,u=0,c=!1,h=!1,d=!0;if("function"!=typeof e)throw new TypeError("Expected a function");function p(t){var n=i,s=r;return i=r=void 0,u=t,a=e.apply(s,n)}function f(e){var n=e-l;return void 0===l||n>=t||n<0||h&&e-u>=s}function m(){var e=eF();if(f(e))return g(e);o=setTimeout(m,function(e){var n=t-(e-l);return h?nF(n,s-(e-u)):n}(e))}function g(e){return o=void 0,d&&i?p(e):(i=r=void 0,a)}function v(){var e=eF(),n=f(e);if(i=arguments,r=this,l=e,n){if(void 0===o)return function(e){return u=e,o=setTimeout(m,t),c?p(e):a}(l);if(h)return clearTimeout(o),o=setTimeout(m,t),p(l)}return void 0===o&&(o=setTimeout(m,t)),a}return t=ZC(t)||0,qC(n)&&(c=!!n.leading,s=(h="maxWait"in n)?tF(ZC(n.maxWait)||0,t):s,d="trailing"in n?!!n.trailing:d),v.cancel=function(){void 0!==o&&clearTimeout(o),u=0,i=l=r=o=void 0},v.flush=function(){return void 0===o?a:g(eF())},v};var rF=function(e){var t=null==e?0:e.length;return t?e[t-1]:void 0};var sF=function(e,t){return e>t};var aF=function(e,t){return t.length<2?e:sT(e,xT(t,0,-1))};var oF=function(e,t){return KP(e,t)};var lF=function(e,t,n){for(var i=-1,r=e.length;++i<r;){var s=e[i],a=t(s);if(null!=a&&(void 0===o?a===a&&!BC(a):n(a,o)))var o=a,l=s}return l};var uF=function(e){return e&&e.length?lF(e,JC,sF):void 0};var cF=function(e,t){return t=nT(t,e),null==(e=aF(e,t))||delete e[rT(rF(t))]};var hF=function(e){return yT(e)?void 0:e},dF=hT((function(e,t){var n={};if(null==e)return n;var i=!1;t=RC(t,(function(t){return t=nT(t,e),i||(i=t.length>1),t})),OA(e,WT(e),n),i&&(n=TP(n,7,hF));for(var r=t.length;r--;)cF(n,t[r]);return n})),pF=dF;var fF=function(e,t,n,i){if(!qC(e))return e;for(var r=-1,s=(t=nT(t,e)).length,a=s-1,o=e;null!=o&&++r<s;){var l=rT(t[r]),u=n;if("__proto__"===l||"constructor"===l||"prototype"===l)return e;if(r!=a){var c=o[l];void 0===(u=i?i(c,l,o):void 0)&&(u=qC(c)?c:AA(t[r+1])?[]:{})}FA(o,l,u),o=o[l]}return e};var mF=function(e,t,n){for(var i=-1,r=t.length,s={};++i<r;){var a=t[i],o=sT(e,a);n(o,a)&&fF(s,nT(a,e),o)}return s};var gF=function(e,t){return mF(e,t,(function(t,n){return $P(e,n)}))},vF=hT((function(e,t){return null==e?{}:gF(e,t)}));var yF=function(e,t,n){var i=!0,r=!0;if("function"!=typeof e)throw new TypeError("Expected a function");return qC(n)&&(i="leading"in n?!!n.leading:i,r="trailing"in n?!!n.trailing:r),iF(e,t,{leading:i,maxWait:t,trailing:r})};function xF(e){for(let t of Object.keys(e))void 0===e[t]&&delete e[t];return e}function bF(e,t){return Object.setPrototypeOf(e,t),e}var wF=!(typeof window>"u")&&window.navigator.userAgent.toLowerCase().includes(" electron/"),DF=(wF&&(()=>{var e;if(typeof window>"u")return;let t=new URLSearchParams(window.location.search).get("desktop-app-version");t?window.localStorage.setItem("desktop-app-version",t):e=window.localStorage.getItem("desktop-app-version")})(),!(typeof window>"u")&&window.navigator.platform.toUpperCase().includes("MAC")),_F=!(typeof window>"u")&&(/iPad|iPhone|iPod/.test(window.navigator.userAgent)||DF&&"ontouchend"in document),SF=!(typeof window>"u")&&window.navigator.userAgent.toLowerCase().indexOf("firefox")>-1,EF=!(typeof window>"u")&&("ontouchstart"in window||navigator.maxTouchPoints>0),CF=(()=>{if(typeof window>"u")return!1;let e=navigator.userAgent,t=navigator.vendor;return/Safari/i.test(e)&&/Apple Computer/.test(t)})(),AF=Number((()=>{if(typeof window>"u")return null;let e=navigator.userAgent.match(/Version\/(\d+\.\d)/);return e&&e[1]})());function MF(e){return Array.isArray(e)?e:[e]}function TF(e,t){let n=0;for(;n<e.length&&n<t.length;){if(e[n]<t[n])return-1;if(e[n]>t[n])return 1;n+=1}return n!==t.length?-1:n!==e.length?1:0}function PF(e){return DF?e.metaKey:e.ctrlKey}var FF=[],OF={},IF={},kF={};function BF(e){FF.includes(e)||FF.push(e)}function RF(e){delete OF[e.pointerId];for(let t=0;t<FF.length;t++)if(FF[t].pointerId===e.pointerId){FF.splice(t,1);break}}function LF(e){if("touch"!==e.pointerType)return;let t=OF[e.pointerId];void 0===t&&(t={x:0,y:0},OF[e.pointerId]=t),t.x=e.pageX,t.y=e.pageY}function zF(e){let t=e.pointerId===FF[0].pointerId?FF[1]:FF[0];return OF[t.pointerId]}function NF(e){IF[e.key]=!0,kF[e.key]=void 0===kF[e.key]?1:kF[e.key]+1}function jF(e){if(DF&&IF.Meta)for(let t in IF)IF[t]=!1;else IF[e.key]=!1;kF={}}var UF,VF,HF=new Promise((e=>{UF=e}));function WF(){if(VF)return VF;return VF=async function(){let e=n.e(208).then(n.bind(n,208)),[t,i]=await Promise.all([e,fetch("".concat("https://unpkg.com/@splinetool/navmesh-wasm@1.9.59/build","/navmesh.wasm")).then((e=>e.arrayBuffer()))]),r=t.default,s=await r({wasmBinary:i});UF(s)}(),VF}var GF,qF,YF=new Promise((e=>{GF=e}));function XF(){if(qF)return qF;return qF=async function(){let e=await n.e(293).then(n.bind(n,293));await e.init(),GF(e)}(),qF}var QF=class{modifyById(e,t){let n=this;if(void 0===n[e])throw new Error("not expected");{let i=d(d({},n),{},{[e]:t});return Object.setPrototypeOf(i,QF.prototype),i}}add(e,t){var n,i;return null!==(n=null===(i=this.runOp({type:1,id:e,data:t}))||void 0===i?void 0:i.data)&&void 0!==n?n:this}runOp(e){let t=this;if(1===e.type){let n,i=t[e.id];n=void 0===i?{type:2,id:e.id}:{type:1,id:e.id,data:i};let{id:r,data:s}=e,a=d(d({},t),{},{[r]:s});return Object.setPrototypeOf(a,QF.prototype),{data:a,actual:e,reverse:n}}if(2===e.type){let{id:n}=e,i=t[n];if(void 0===i)return null;{let r=d({},t);return Object.setPrototypeOf(r,QF.prototype),delete r[n],{data:r,actual:e,reverse:{type:1,id:n,data:i}}}}return null}};function KF(e){if(void 0!==e.deepFreeze)return void e.deepFreeze(e);let t=Object.getOwnPropertyNames(e);for(let n of t){let t=e[n];t&&"object"==typeof t&&KF(t)}return Object.freeze(e)}var ZF=class extends Error{};function JF(e){let t=d({},e);return Object.setPrototypeOf(t,Object.getPrototypeOf(e)),t}function $F(e,t,n){if(void 0===e?void 0===t?(e=0,t=10):e=t-10:void 0===t&&(t=e+10),e>t){let n=e;e=t,t=n}let i=[],r=1/(n+1);for(let s=0;s<n;s++){let n=e+(t-e)*(s+.75+.5*Math.random())*r;i.push(n)}return i}function eO(e){return e instanceof Uint8Array||e instanceof Uint16Array||e instanceof Uint32Array||e instanceof Int8Array||e instanceof Int16Array||e instanceof Int32Array||e instanceof Float32Array||e instanceof Float64Array}function tO(e,t){for(let n of e)!0!==t(n.id,n.data)&&tO(n.children,t)}function nO(e,t){if(!0!==t(e.id,e.data))for(let n of e.children)nO(n,t)}var iO,rO=class extends Array{constructor(){super(...arguments),Object.setPrototypeOf(this,rO.prototype)}deepFreeze(){let e=0;for(;e<this.length;)KF(this[e]),e++}fillCaches0(e,t){this.objCaches.set(e.id,e),this.parentCaches.set(e.id,t);for(let n of e.children)this.fillCaches0(n,e.id)}fillCaches(){if(void 0===this.objCaches){this.objCaches=new Map,this.parentCaches=new Map;for(let e of this)this.fillCaches0(e,null)}}randomId(){this.fillCaches();let e=Array.from(this.objCaches.keys());if(0!==e.length)return e[Math.max(0,Math.floor(Math.random()*e.length)-1)]}nonExistOrDescendantOf(e,t){if(!this.has(e))return!0;for(;e;){let n=this.parent(e);if(n===t)return!0;e=n}return!1}rootAcestor(e){for(;e;){let t=this.parent(e);if(!t)return e;e=t}return e}isDescendantOf(e,t){for(;e;){let n=this.parent(e);if(n===t)return!0;e=n}return!1}data(e){var t;return null===(t=this.get(e))||void 0===t?void 0:t.data}has(e){return void 0!==this.childrenOf(e)}get(e){return this.fillCaches(),this.objCaches.get(e)}childrenOf(e){var t;return null===e?this:null===(t=this.get(e))||void 0===t?void 0:t.children}traverseFrom(e,t){if(null===e)this.traverse(t);else{let n=this.get(e);n&&nO(n,t)}}traverse(e){tO(this,e)}totalSize(){return this.fillCaches(),this.objCaches.size}parent(e){return this.fillCaches(),this.parentCaches.get(e)}childrenArray(e){return null===e?this:this.get(e).children}modifyById(e,t){if(void 0===this.get(e))throw new Error("not expected");{let n=this.parent(e),i=this.childrenArray(n),r=i.findIndex((t=>t.id===e));if(r<0)throw new Error("not expected");let s=i[r];return i=[...i],i[r]=d(d({},s),{},{data:t}),this.modifyArrayBy(n,i)}}modifyArrayBy(e,t){let n=e,i=t;for(;null!==n;){let e=i,t=n;if(n=this.parent(n),void 0===n)throw new Error;i=this.childrenArray(n);let r=i.findIndex((e=>e.id===t));if(r<0)throw new Error;i=[...i],i[r]=d(d({},i[r]),{},{children:e})}Object.setPrototypeOf(i,rO.prototype);let r=i;return r.fillCaches(),r}runOp(e){switch(e.type){case 7:return this.addOp(e);case 8:return this.deleteOp(e);case 9:return this.moveOp(e)}return null}checkDuplicatedIdRec(e){let{id:t,children:n}=e;if(void 0!==this.get(t))return!0;for(let i of n)if(this.checkDuplicatedIdRec(i))return!0;return!1}addOp(e){let{parent:t,fi:n,id:i,data:r,children:s}=e;if(null!==t&&void 0===this.get(t))return null;if(this.checkDuplicatedIdRec(e))return null;{let a=t,o=this.childrenArray(a),l={fi:n,id:i,data:r,children:s};return o=[...o,l],o.sort(((e,t)=>e.fi-t.fi)),e.localIndex=o.indexOf(l),{data:this.modifyArrayBy(a,o),actual:e,reverse:{type:8,id:i}}}}deleteOp(e){let{id:t}=e;if(null===this.get(t))return null;{let n=this.parent(t);if(void 0===n)return null;let i=this.childrenArray(n),r=i.findIndex((e=>e.id===t));e.localIndex=r,i=[...i];let s=i.splice(r,1)[0];return{data:this.modifyArrayBy(n,i),actual:e,reverse:d(d({type:7},s),{},{parent:n})}}}moveOp(e){let{parent:t,fi:n,id:i}=e;if(null!==t&&void 0===this.get(t))return this.deleteOp({type:8,id:i});if(null!==t){let e=t;for(;null!==e;){if(void 0===e)throw new Error;if(e===i)throw new ZF("cyclic tree");e=this.parent(e)}}let r=this.parent(i);if(void 0===r)return null;let s=r,a=this.childrenArray(r),o=a.findIndex((e=>e.id===i));a=[...a];let l=a.splice(o,1)[0],u=this.modifyArrayBy(r,a);r=t,a=u.childrenArray(r);let c=l.fi;return l=d(d({},l),{},{fi:n}),a=[...a,l],a.sort(((e,t)=>e.fi-t.fi)),e.localIndex=a.indexOf(l),u=u.modifyArrayBy(r,a),{data:u,actual:e,reverse:{type:9,parent:s,fi:c,id:i}}}previous(e,t){if(null===t){let t=this.childrenArray(e);return 0===t.length?null:t[t.length-1].id}let n=null;for(let i of this.childrenArray(e)){if(i.id===t)return n;n=i.id}return null}traverseSortNext(e){let t=this.parent(e);if(void 0!==t){let n=this.childrenArray(t),i=n.findIndex((t=>t.id===e))+1;if(i<n.length)return n[i].id;if(t)return this.traverseSortNext(t)}}sortNext(e){let t=this.childrenArray(e);return t.length>0?t[0].id:this.traverseSortNext(e)}traverseSortPrevious(e){let t=this.childrenArray(e);return t.length>0?this.traverseSortPrevious(t[t.length-1].id):e}sortPrevious(e){let t=this.parent(e);if(void 0!==t){let n=this.childrenArray(t),i=n.findIndex((t=>t.id===e))-1;return i>=0?this.traverseSortPrevious(n[i].id):t}}getAllSorted(e){let t=[];for(let n of e){let e=this.getWithSortKey(n.id);void 0!==e&&t.push(d(d({},n),e))}t.sort(((e,t)=>function(e,t){let n=0;for(;n<e.length&&n<t.length;){if(e[n]<t[n])return-1;if(e[n]>t[n])return 1;n+=1}return n!==t.length?-1:n!==e.length?1:0}(e.sortKey,t.sortKey)));for(let n of t)delete n.sortKey;return t}getWithSortKey(e){var t=e;let n=[],i=this.get(t),r=i;if(void 0!==i){for(;t;)n.splice(0,0,i.fi),null!==(t=this.parent(t))&&(i=this.get(t));return d(d({},r),{},{sortKey:n})}}insertBeforeHelper(e,t,n){return this.insertAfterHelper(e,this.previous(e,t),n)}insertAfterHelper(e,t,n){let i=this.childrenArray(e);if(null===t){if(0===i.length)return $F(0,n,n);{let e=i[0].fi;return $F(e-n,e,n)}}{let r=this.get(t);if(void 0===r||this.parent(t)!==e)throw new Error("illegal args");let s=i.find((e=>e.fi>r.fi));if(void 0===s){let e=i[i.length-1].fi;return $F(e,e+n,n)}return $F(r.fi,s.fi,n)}}};(e=>{e.runOp=function(e,t){if(0!==t.type)return null;if(Array.isArray(e)){let n=t.props,i={},r=[...e],s=!1;if(n)for(let e of Object.keys(n)){let t=parseInt(e);if(isNaN(t))throw new Error("wrong index");i[e]=r[t],r[t]=n[e],s=!0}return s?{data:r,actual:t,reverse:{type:0,props:i}}:null}{let n=t.props,i={},r=d({},e),s=!1;if(n)for(let e of Object.keys(n)){i[e]=r[e];let t=n[e];void 0===t?delete r[e]:r[e]=t,s=!0}return s?{data:r,actual:t,reverse:{type:0,props:i}}:null}}})(iO||(iO={}));var sO=class extends Array{constructor(){super(...arguments),Object.setPrototypeOf(this,sO.prototype)}deepFreeze(){let e=0;for(;e<this.length;)KF(this[e]),e++}fillCaches0(e){this.objCaches.set(e.id,e)}fillCaches(){if(void 0===this.objCaches){this.objCaches=new Map,Object.getOwnPropertyDescriptor(this,"objCaches").enumerable=!1;for(let e of this)this.fillCaches0(e)}}randomId(){this.fillCaches();let e=Array.from(this.objCaches.keys());if(0!==e.length)return e[Math.max(0,Math.floor(Math.random()*e.length)-1)]}data(e){var t;return null===(t=this.get(e))||void 0===t?void 0:t.data}get(e){return this.fillCaches(),this.objCaches.get(e)}modifyById(e,t){if(void 0===this.get(e))throw new Error("not expected");{let n=this,i=n.findIndex((t=>t.id===e));if(i<0)throw new Error("not expected");let r=n[i];return n=[...n],n[i]=d(d({},r),{},{data:t}),this.modifyArrayBy(n)}}modifyArrayBy(e){Object.setPrototypeOf(e,sO.prototype);let t=e;return typeof process<"u"||t.fillCaches(),t}runOp(e){switch(e.type){case 4:return this.addOp(e);case 5:return this.deleteOp(e);case 6:return this.moveOp(e)}return null}addOp(e){let{fi:t,id:n,data:i}=e,r=this,s={fi:t,id:n,data:i};return r=[...r,s],r.sort(((e,t)=>e.fi-t.fi)),e.localIndex=r.indexOf(s),{data:this.modifyArrayBy(r),actual:e,reverse:{type:5,id:n}}}deleteOp(e){let{id:t}=e,n=this,i=n.findIndex((e=>e.id===t));if(-1===i)return null;e.localIndex=i,n=[...n];let r=n.splice(i,1)[0];return{data:this.modifyArrayBy(n),actual:e,reverse:d({type:4},r)}}moveOp(e){let{fi:t,id:n}=e,i=this;i=[...i];let r=i.findIndex((e=>e.id===n));if(-1===r)return null;let s=i[r].fi,a=d(d({},i[r]),{},{fi:t});return i[r]=a,i.sort(((e,t)=>e.fi-t.fi)),e.localIndex=i.indexOf(a),{data:this.modifyArrayBy(i),actual:e,reverse:{type:6,fi:s,id:n}}}previous(e){if(null===e)return 0===this.length?null:this[this.length-1].id;let t=null;for(let n of this){if(n.id===e)return t;t=n.id}return null}insertBeforeHelper(e,t){return this.insertAfterHelper(this.previous(e),t)}insertAfterHelper(e,t){let n=this;if(null===e){if(0===n.length)return $F(0,t,t);{let e=n[0].fi;return $F(e-t,e,t)}}{let i=this.get(e);if(void 0===i)throw new Error("illegal args");let r=n.find((e=>e.fi>i.fi));if(void 0===r){let e=n[n.length-1].fi;return $F(e,e+t,t)}return $F(i.fi,r.fi,t)}}};function aO(e){return e&&"object"==typeof e&&e instanceof hO}var oO,lO,uO,cO,hO=class{unusedFunOverridesTable(e){}runOp(e){let t=[],n=this,i=0,r={};for(;i<e.path.length;){if(t.push(n),n=void 0===n?void 0:n[e.path[i]],void 0!==n&&!aO(n))return null;i+=1}n=n?JF(n):new hO;for(let[s,a]of Object.entries(e.props)){let e=n[s];r[s]=e,void 0===a?delete n[s]:n[s]=a}for(;i>0;){if(0===Object.keys(n).length){let r=t[i-1];r&&(n=JF(r),delete n[e.path[i-1]])}else{let r=t[i-1];if(r){let t=JF(r);t[e.path[i-1]]=n,n=t}else{let t=new hO;t[e.path[i-1]]=n,n=t}}i-=1}return{data:Object.setPrototypeOf(n,hO.prototype),actual:e,reverse:d(d({},e),{},{props:r})}}};function dO(e,t){if(void 0===t)return;let n=!1,i=e.map((e=>{let i=e.id,r=pO(e.data,t[i]);if(n=n||void 0!==r,void 0===r&&(r=e.data),e.children){let s=dO(e.children,t);return void 0!==s?n=!0:s=e.children,d(d({},e),{},{id:i,data:r,children:s})}return d(d({},e),{},{id:i,data:r})}));return n?i:void 0}function pO(e,t){if(!aO(t))return t;if(e instanceof rO){let n=dO(e,t);return void 0!==n&&Object.setPrototypeOf(n,Object.getPrototypeOf(e)),n}if(e instanceof sO)return function(e,t){if(void 0===t)return;let n=!1,i=e.map((e=>{let i=e.id,r=pO(e.data,t[i]);return n=n||void 0!==r,void 0===r&&(r=e.data),d(d({},e),{},{id:i,data:r})}));return n?(Object.setPrototypeOf(i,Object.getPrototypeOf(e)),i):void 0}(e,t);if(Array.isArray(e)){let n=!1,i=e.map(((e,i)=>{let r=pO(e,t[i]);return n=n||void 0!==r,void 0===r&&(r=e),r}));return n?(Object.setPrototypeOf(i,Object.getPrototypeOf(e)),i):void 0}if(e instanceof hO)return fO(e,t);if(e&&"object"==typeof e){let n={},i=!1;for(let[r,s]of Object.entries(e)){let e=pO(s,t[r]);i=i||void 0!==e,void 0===e&&(e=s),n[r]=e}return i?(Object.setPrototypeOf(n,Object.getPrototypeOf(e)),n):void 0}}function fO(e,t){if(void 0===e)return t;if(void 0===t)return e;if(!aO(t))return t;if(!aO(e))return oO.apply(e,t);let n=new Set;for(let r of Object.keys(e))n.add(r);for(let r of Object.keys(t))n.add(r);let i=new hO;for(let r of n){let n=fO(void 0===e?void 0:e[r],void 0===t?void 0:t[r]);i[r]=n}return i}function mO(e,t){var n;let i={cur:[],result:[],len:0};return[e=null!==(n=xO(e,t,i))&&void 0!==n?n:e,i.result]}function gO(e,t){return null===e?null:(e.cur[e.len]=t,e.len+=1,e)}function vO(e){e&&(e.len-=1)}function yO(e,t,n){let i=!1,r=e.map((e=>{let r=e.id,s=t[r];if(void 0!==s&&"string"==typeof s&&(i=!0,r=s,null!==n))throw new Error("not supported");let a=xO(e.data,t,gO(n,r));vO(n),i=i||void 0!==a,void 0===a&&(a=e.data);let o=yO(e.children,t,n);return void 0!==o?i=!0:o=e.children,d(d({},e),{},{id:r,data:a,children:o})}));if(i)return r}function xO(e,t,n){if(e instanceof rO){let i=yO(e,t,n);return void 0!==i&&Object.setPrototypeOf(i,Object.getPrototypeOf(e)),i}if(e instanceof sO)return function(e,t,n){let i=!1,r=e.map((e=>{let r=e.id,s=t[r];if(void 0!==s&&"string"==typeof s&&(i=!0,r=s,null!==n))throw new Error("not supported");let a=xO(e.data,t,gO(n,r));return vO(n),i=i||void 0!==a,void 0===a&&(a=e.data),d(d({},e),{},{id:r,data:a})}));if(i)return Object.setPrototypeOf(r,Object.getPrototypeOf(e)),r}(e,t,n);if(Array.isArray(e)){let i=!1,r=e.map(((e,r)=>{let s=xO(e,t,gO(n,r));return vO(n),i=i||void 0!==s,void 0===s&&(s=e),s}));return i?(Object.setPrototypeOf(r,Object.getPrototypeOf(e)),r):void 0}if(e&&"object"==typeof e&&!eO(e)){let i={},r=!1;for(let[s,a]of Object.entries(e))if("name"!==s&&"variableId"!==s){let e=t[s];if("string"==typeof e){if(null!==n)throw new Error("not supported");r=!0,s=e}let o=xO(a,t,gO(n,s));vO(n),r=r||void 0!==o,void 0===o&&(o=a),i[s]=o}else i[s]=a;return r?(Object.setPrototypeOf(i,Object.getPrototypeOf(e)),i):void 0}if("string"==typeof e){let i=t[e];return void 0!==i&&function(e){if(null===e)return null;e.result.push(e.cur.slice(0,e.len))}(n),i}}(e=>{e.apply=function(e,t){var n;return null!==(n=pO(e,t))&&void 0!==n?n:e},e.merge=function(e,t){return fO(e,t)},e.filterOp=function(e,t){let n=0,i=t.path,r=e;for(;n<i.length&&void 0!==r;){if(r=OO.zoomOnce(r,i[n]),void 0===r)return t;if(!aO(r))return;n+=1}if(void 0===r)return t;if(aO(r)){if(0===t.type){let e=d({},t.props);for(let t of Object.keys(r))delete e[t];return d(d({},t),{},{props:e})}if(1===t.type||4===t.type||7===t.type){let e=dO([t],r);return e?(console.log(e),e):t}return t}}})(oO||(oO={})),(e=>{e.replaceProps=function(e,t){let n=OO.zoom(t,e.path);if("object"==typeof n){let t={};for(let i of Object.keys(e.props))t[i]=n[i];return d(d({},e),{},{props:t})}return d(d({},e),{},{props:{}})}})(lO||(lO={})),(e=>{function t(e,t){let n=t.path;for(var i=[];;){let a;if(e instanceof hO&&0===t.type&&(a=e.runOp(d(d({},t),{},{path:n.slice(i.length)})),null===a&&(a=void 0)),void 0===a&&i.length===n.length&&(a=e instanceof rO||e instanceof sO||e instanceof QF?e.runOp(t):iO.runOp(e,t)),void 0!==a){if(null!==a){let e=a.data;for(let t=i.length-1;t>=0;t--){let r=n[t],s=i[t];if(s instanceof rO){if("number"==typeof r)throw new Error("illegal arg");e=s.modifyById(r,e)}else if(s instanceof sO){if("number"==typeof r)throw new Error("illegal arg");e=s.modifyById(r,e)}else if(s instanceof QF){if("number"==typeof r)throw new Error("illegal arg");e=s.modifyById(r,e)}else if(s instanceof hO){let t=d(d({},s),{},{[r]:e});e=Object.setPrototypeOf(t,hO.prototype)}else{if("object"!=typeof s)return null;if(Array.isArray(s)){if("string"==typeof r&&(r=parseInt(r),isNaN(r)))throw new Error("Invalid path");let t=e;e=[...s],e[r]=t}else e=d(d({},s),{},{[r]:e})}}return{data:e,actual:d(d({},a.actual),{},{path:n}),reverse:d(d({},a.reverse),{},{path:n})}}return null}let o,l=n[i.length];if(e instanceof rO){var r;if("number"==typeof l)throw new Error("");o=null===(r=e.get(l))||void 0===r?void 0:r.data}else if(e instanceof sO){var s;if("number"==typeof l)throw new Error("");o=null===(s=e.get(l))||void 0===s?void 0:s.data}else null!==e&&(o=e[l]);if(void 0===o)return null;i.push(e),e=o}}function n(e,t){for(let n=0;n<e.length&&n<t.length;n++)if(e[n]!==t[n])return!0;return!1}function i(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}e.drop=function(e,t){return d(d({},e),{},{path:e.path.slice(t)})},e.applySimple=function(e,n){var i,r;return null!==(i=null===(r=t(e,n))||void 0===r?void 0:r.data)&&void 0!==i?i:e},e.apply=t,e.pathDisjoint=n,e.pathEq=i,e.commutative=function(e,t){return n(e.path,t.path)},e.subsumed=function(e,t){return!(0!==e.type||0!==t.type||!i(e.path,t.path))&&Object.keys(e.props).every((e=>void 0!==t.props[e]))}})(uO||(uO={})),(e=>{function t(e,t){var n=e;let i=[],r=[];for(let s of t)try{if(3===s.type||5===s.type&&"variables"===s.path[s.path.length-1]){let e,t,a;if(3===s.type?(e=OO.zoom(n,[...s.path,s.id]),a=uO.apply(n,d(d({},s),{},{type:2}))):(e=OO.zoom(n,[...s.path,s.id,"value"]),a=uO.apply(n,s)),null!==a){n=a.data;let[o,l]=mO(n,{[s.id]:e});n=o;for(let a=0;a<l.length;a++){let o=l[a],u=o.pop();if("number"==typeof u){let i=[u];for(let e=a+1;e<l.length;e++){let t=l[e],n=t[t.length-1];if("number"!=typeof n||!OO.equal(o,t.slice(0,t.length-1)))break;i.push(n),l.splice(e,1)}let r=OO.zoom(n,o);t=r.map(((e,t)=>i.includes(t)?s.id:e)),e=r,u=o.pop()}else{if("alphaOverride"===u||"alpha"===u){e/=100;let t=e,i=OO.zoom(n,o.slice(0,o.length-2)),r=i.layers.map((e=>e.id===o[o.length-1]?d(d({},e),{},{data:d(d({},e.data),{},{[u]:t})}):e));Object.setPrototypeOf(r,Object.getPrototypeOf(i.layers)),i.layers=r}t=s.id}i.push({type:0,path:o,props:{[u]:e}}),r.push({type:0,path:o,props:{[u]:t}})}r.push(a.reverse),i.push(a.actual)}}else{let e=uO.apply(n,s);null!==e&&(i.push(e.actual),n=e.data,r.push(e.reverse))}}catch(Kn){if(Kn instanceof ZF)return null;throw Kn}return{data:n,actual:i,reverse:r.reverse()}}e.empty=function(){return[]},e.removePrefix=function(e,t){let n=[];for(let i of e){let[e,...r]=i.path;e===t&&n.push(d(d({},i),{},{path:r}))}return n},e.addPrefix=function(e,t){return e.map((e=>d(d({},e),{},{path:[t,...e.path]})))},e.concat=function(e,t){return[...e,...t]},e.compress=function(e,t){return[...e.filter((e=>!t.some((t=>uO.subsumed(e,t))))),...t]},e.commutative=function(e,t){return e.every((e=>t.every((t=>uO.commutative(e,t)))))},e.applyAll=function(e,n){for(let i of n){let n=t(e,i);null!==n&&(e=n.data)}return e},e.apply=t})(cO||(cO={}));var bO=Symbol(),wO=Symbol(),DO=Symbol(),_O=class{reportOp(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],i=this;if(null===t)return;i._current=t.data;let r=n;for(;!(i instanceof IO);){let e=i._path,t=i._current;if(""!==e&&r.splice(0,0,e),i=i._parent,null===i)return;i.update(e,t)}i.push(r,e,t.actual,t.reverse)}deleteChildren(e){if(this._children){let t=this._children[e];if(t){let n=t[DO];n&&n(),delete this._children[e]}}}},SO=class extends _O{constructor(e,t,n){super(),this._parent=e,this._path=t,this._current=n}update(e,t){if(Array.isArray(this._current)){if("string"==typeof e&&(e=parseInt(e),isNaN(e)))throw new Error("Invalid path");this._current=[...this._current],this._current[e]=t}else this._current=d(d({},this._current),{},{[e]:t})}runOp(e){this.reportOp(e,iO.runOp(this._current,e),e.path)}},EO=class extends _O{constructor(e,t,n){super(),this._parent=e,this._path=t,this._current=n}update(e,t){this._current=d(d({},this._current),{},{[e]:t}),Object.setPrototypeOf(this._current,QF.prototype)}runOp(e){this.reportOp(e,this._current.runOp(e))}},CO={get(e,t){if(t===DO)return()=>{e._parent=null};if(t===bO)return e._current;if(t===wO)return e;let{_current:n,_children:i}=e;if("push"===t&&Array.isArray(n))throw new Error("not supported to expand array");let r=void 0===i?void 0:i[t];if(void 0!==r)return r;let s=n[t],a=kO(e,t,s);return a!==s?(void 0===i&&(i={},e._children=i),i[t]=a,a):s},has:(e,t)=>t in e._current,ownKeys:e=>Reflect.ownKeys(e._current),defineProperty(){throw Error("not supported")},getPrototypeOf:e=>Object.getPrototypeOf(e._current),setPrototypeOf(){throw Error("not supported")},getOwnPropertyDescriptor(e,t){let n=e._current,i=Reflect.getOwnPropertyDescriptor(n,t);return i&&{writable:!0,configurable:!0,enumerable:i.enumerable,value:n[t]}}},AO=d(d({},CO),{},{set(e,t,n){var i;let r={type:0,props:{[t]:null!==(i=LO(n))&&void 0!==i?i:n}};return e.deleteChildren(t),e.runOp(r),!0},deleteProperty(e,t){let n={type:0,props:{[t]:void 0}};return e.deleteChildren(t),e.runOp(n),!0}}),MO=d(d({},CO),{},{set(e,t,n){return void 0===n?this.deleteProperty(e,t):(e.deleteChildren(t),e.runOp({type:1,id:t,data:n})),!0},deleteProperty:(e,t)=>(e.runOp({type:2,id:t}),!0)}),TO=class extends _O{constructor(e,t,n){super(),this._children={},this._parent=e,this._path=t,this._current=n,this[DO]=()=>{this._parent=null}}unproxy(){return this._current}update(e,t){this._current=this._current.modifyById(e,t)}runOp(e){this.reportOp(e,this._current.runOp(e))}randomId(){return this._current.randomId()}isDescendantOf(e,t){return this._current.isDescendantOf(e,t)}childrenOf(e){return this._current.childrenOf(e)}traverse(e){return this._current.traverse(e)}get(e){return this._current.get(e)}parent(e){return this._current.parent(e)}traverse(e){this._current.traverse(((t,n)=>{e(t,this.data(t))}))}data(e){var t;let{_current:n,_children:i}=this,r=void 0===i?void 0:i[e];if(void 0!==r)return r;let s=null===(t=n.get(e))||void 0===t?void 0:t.data,a=kO(this,e,s);return a!==s?(void 0===i&&(i={},this._children=i),i[e]=a,a):s}add(e,t,n,i,r){this.runOp({type:7,parent:e,fi:t,id:n,data:i,children:r})}move(e,t,n){this.runOp({type:9,parent:e,fi:t,id:n})}insertAfter(e,t,n){let i=this._current.insertAfterHelper(e,t,n.length);for(let r=0;r<n.length;r++){let t=n[r];this.add(e,i[r],t.id,t.data,t.children)}}insertBefore(e,t,n){let i=this._current.insertBeforeHelper(e,t,n.length);for(let r=0;r<n.length;r++){let t=n[r];this.add(e,i[r],t.id,t.data,t.children)}}moveAfter(e,t,n){let i=this._current.insertAfterHelper(e,t,n.length);for(let r=0;r<n.length;r++){let t=n[r];this.move(e,i[r],t)}}moveBefore(e,t,n){let i=this._current.insertBeforeHelper(e,t,n.length);for(let r=0;r<n.length;r++){let t=n[r];this.move(e,i[r],t)}}delete(e){this.deleteChildren(e),this.runOp({type:8,id:e})}sortNext(e){return this._current.sortNext(e)}sortPrevious(e){return this._current.sortPrevious(e)}getAllSorted(e){return this._current.getAllSorted(e)}},PO=class extends _O{constructor(e,t,n){super(),this._children={},this._parent=e,this._path=t,this._current=n,this[DO]=()=>{this._parent=null}}unproxy(){return this._current}get length(){return this._current.length}forEach(e){let t=this.length;for(let n=0;n<t;n++){let t=this._current[n].id,i=this._current[n].fi;e(this.data(this._current[n].id),t,i)}}find(e){let t=this.length;for(let n=0;n<t;n++){let t=this._current[n].id;if(e(this.data(t),t))return this.get(t)}}update(e,t){this._current=this._current.modifyById(e,t)}randomId(){return this._current.randomId()}get(e){return d(d({},this._current.get(e)),{},{data:this.data(e)})}data(e){var t;let{_current:n,_children:i}=this,r=void 0===i?void 0:i[e];if(void 0!==r)return r;let s=null===(t=n.get(e))||void 0===t?void 0:t.data,a=kO(this,e,s);return a!==s?(void 0===i&&(i={},this._children=i),i[e]=a,a):s}runOp(e){this.reportOp(e,this._current.runOp(e))}add(e,t,n){this.runOp({type:4,fi:e,id:t,data:n})}move(e,t){this.runOp({type:6,fi:e,id:t})}insertAfter(e,t){let n=this._current.insertAfterHelper(e,t.length);for(let i=0;i<t.length;i++){let e=t[i];this.add(n[i],e.id,e.data)}}insertBefore(e,t){let n=this._current.insertBeforeHelper(e,t.length);for(let i=0;i<t.length;i++){let e=t[i];this.add(n[i],e.id,e.data)}}moveAfter(e,t){let n=this._current.insertAfterHelper(e,t.length);for(let i=0;i<t.length;i++){let e=t[i];this.move(n[i],e)}}moveBefore(e,t){let n=this._current.insertBeforeHelper(e,t.length);for(let i=0;i<t.length;i++){let e=t[i];this.move(n[i],e)}}delete(e){this.deleteChildren(e),this.runOp({type:5,id:e})}};function FO(e,t,n){if(e.length>0){let i=e[e.length-1];if(0===i.type&&0===t.type&&OO.equal(i.path,n))return void Object.assign(i.props,t.props)}e.push(d(d({},t),{},{path:n}))}var OO,IO=class extends _O{constructor(e){super(),this.ts=[],this.actual=[],this.reverse=[],this._current=e}update(e,t){if(""!==e)throw new Error("");this._current=t}push(e,t,n,i){FO(this.ts,t,e),FO(this.actual,n,e),FO(this.reverse,i,e)}result(){return{data:this._current,ts:this.ts,actual:this.actual,reverse:this.reverse.reverse()}}};function kO(e,t,n){return n instanceof rO?new TO(e,t,n):n instanceof sO?new PO(e,t,n):n instanceof QF?new Proxy(new EO(e,t,n),MO):null!==n&&"object"==typeof n?eO(n)?n:new Proxy(new SO(e,t,n),AO):n}function BO(e){let t=new IO(e);return[kO(t,"",e),t]}function RO(e,t){let[n,i]=BO(e);return t(n),i.result()}function LO(e){return e instanceof TO||e instanceof PO?e._current:null!==e&&"object"==typeof e?e[bO]:e}function zO(e,t){let n=[];if(!(t.length<=e.length))return null;for(var i=0;i<t.length;){if("*"===t[i])n.push(e[i]);else if(e[i]!==t[i])return null;i+=1}return n}(e=>{function t(e,t){return(e instanceof rO||e instanceof TO)&&"string"==typeof t||(e instanceof sO||e instanceof PO)&&"string"==typeof t?e.data(t):"number"==typeof t&&Array.isArray(e)||"string"==typeof t&&"object"==typeof e&&null!==e?e[t]:void 0}function n(e,n){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;for(;i<n.length&&void 0!==e;)e=t(e,n[i]),i+=1;return e}e.equal=function(e,t){if(t.length!==e.length)return!1;for(var n=0;n<e.length;){if(e[n]!==t[n])return!1;n+=1}return!0},e.removeOverridden=function(e,t,i){let r=n(i,e);if(void 0!==r&&"object"==typeof r&&null!==r){let e=d({},t);return Object.keys(r).forEach((t=>{delete e[t]})),e}return t},e.zoomOnce=t,e.zoom=n})(OO||(OO={}));var NO,jO=class{},UO=class extends jO{constructor(e){super(),this.id=e}},VO=class extends jO{constructor(e){super(),this.data=e}};try{NO=new TextDecoder}catch(Ahe){}var HO,WO,GO,qO,YO,XO,QO,KO=0,ZO=[],JO=ZO,$O=0,eI={},tI=0,nI=0,iI=[],rI={useRecords:!1,mapsAsObjects:!0},sI=class{},aI=new sI;aI.name="MessagePack 0xC1";var oI=!1,lI=class{constructor(e){e&&(!1===e.useRecords&&void 0===e.mapsAsObjects&&(e.mapsAsObjects=!0),e.structures?e.structures.sharedLength=e.structures.length:e.getStructures&&((e.structures=[]).uninitialized=!0,e.structures.sharedLength=0)),Object.assign(this,e)}unpack(e,t){if(HO)return II((()=>(kI(),this?this.unpack(e,t):lI.prototype.unpack.call(rI,e,t))));WO=t>-1?t:e.length,KO=0,$O=0,nI=0,qO=null,JO=ZO,YO=null,HO=e;try{QO=e.dataView||(e.dataView=new DataView(e.buffer,e.byteOffset,e.byteLength))}catch(un){throw HO=null,e instanceof Uint8Array?un:new Error("Source must be a Uint8Array or Buffer but was a "+(e&&"object"==typeof e?e.constructor.name:typeof e))}if(this instanceof lI){if(eI=this,this.structures)return GO=this.structures,uI();(!GO||GO.length>0)&&(GO=[])}else eI=rI,(!GO||GO.length>0)&&(GO=[]);return uI()}unpackMultiple(e,t){let n,i=0;try{oI=!0;let r=e.length,s=this?this.unpack(e,r):LI.unpack(e,r);if(!t){for(n=[s];KO<r;)i=KO,n.push(uI());return n}for(t(s);KO<r;)if(i=KO,!1===t(uI()))return}catch(r){throw r.lastPosition=i,r.values=n,r}finally{oI=!1,kI()}}_mergeStructures(e,t){for(let n=0,i=(e=e||[]).length;n<i;n++){let t=e[n];t&&(t.isShared=!0,n>=32&&(t.highByte=n-32>>5))}e.sharedLength=e.length;for(let n in t||[])if(n>=0){let i=e[n],r=t[n];r&&(i&&((e.restoreStructures||(e.restoreStructures=[]))[n]=i),e[n]=r)}return this.structures=e}decode(e,t){return this.unpack(e,t)}};function uI(){try{if(!eI.trusted&&!oI){let e=GO.sharedLength||0;e<GO.length&&(GO.length=e)}let e=hI();if(KO==WO)GO.restoreStructures&&cI(),GO=null,HO=null,XO&&(XO=null);else{if(KO>WO){let e=new Error("Unexpected end of MessagePack data");throw e.incomplete=!0,e}if(!oI)throw new Error("Data read, but end of buffer not reached")}return e}catch(e){throw GO.restoreStructures&&cI(),kI(),(e instanceof RangeError||e.message.startsWith("Unexpected end of buffer"))&&(e.incomplete=!0),e}}function cI(){for(let e in GO.restoreStructures)GO[e]=GO.restoreStructures[e];GO.restoreStructures=null}function hI(){let e=HO[KO++];if(e<160){if(e<128){if(e<64)return e;{let t=GO[63&e]||eI.getStructures&&mI()[63&e];return t?(t.read||(t.read=pI(t,63&e)),t.read()):e}}if(e<144){if(e-=128,eI.mapsAsObjects){let t={};for(let n=0;n<e;n++)t[TI()]=hI();return t}{let t=new Map;for(let n=0;n<e;n++)t.set(hI(),hI());return t}}{e-=144;let t=new Array(e);for(let n=0;n<e;n++)t[n]=hI();return t}}if(e<192){let t=e-160;if(nI>=KO)return qO.slice(KO-tI,(KO+=t)-tI);if(0==nI&&WO<140){let e=t<16?EI(t):SI(t);if(null!=e)return e}return gI(t)}{let t;switch(e){case 192:return null;case 193:return YO?(t=hI(),t>0?YO[1].slice(YO.position1,YO.position1+=t):YO[0].slice(YO.position0,YO.position0-=t)):aI;case 194:return!1;case 195:return!0;case 196:return CI(HO[KO++]);case 197:return t=QO.getUint16(KO),KO+=2,CI(t);case 198:return t=QO.getUint32(KO),KO+=4,CI(t);case 199:return AI(HO[KO++]);case 200:return t=QO.getUint16(KO),KO+=2,AI(t);case 201:return t=QO.getUint32(KO),KO+=4,AI(t);case 202:if(t=QO.getFloat32(KO),eI.useFloat32>2){let e=BI[(127&HO[KO])<<1|HO[KO+1]>>7];return KO+=4,(e*t+(t>0?.5:-.5)|0)/e}return KO+=4,t;case 203:return t=QO.getFloat64(KO),KO+=8,t;case 204:return HO[KO++];case 205:return t=QO.getUint16(KO),KO+=2,t;case 206:return t=QO.getUint32(KO),KO+=4,t;case 207:return eI.int64AsNumber?(t=4294967296*QO.getUint32(KO),t+=QO.getUint32(KO+4)):t=QO.getBigUint64(KO),KO+=8,t;case 208:return QO.getInt8(KO++);case 209:return t=QO.getInt16(KO),KO+=2,t;case 210:return t=QO.getInt32(KO),KO+=4,t;case 211:return eI.int64AsNumber?(t=4294967296*QO.getInt32(KO),t+=QO.getUint32(KO+4)):t=QO.getBigInt64(KO),KO+=8,t;case 212:if(t=HO[KO++],114==t)return PI(63&HO[KO++]);{let e=iI[t];if(e)return e.read?(KO++,e.read(hI())):e.noBuffer?(KO++,e()):e(HO.subarray(KO,++KO));throw new Error("Unknown extension "+t)}case 213:return t=HO[KO],114==t?(KO++,PI(63&HO[KO++],HO[KO++])):AI(2);case 214:return AI(4);case 215:return AI(8);case 216:return AI(16);case 217:return t=HO[KO++],nI>=KO?qO.slice(KO-tI,(KO+=t)-tI):vI(t);case 218:return t=QO.getUint16(KO),nI>=(KO+=2)?qO.slice(KO-tI,(KO+=t)-tI):yI(t);case 219:return t=QO.getUint32(KO),nI>=(KO+=4)?qO.slice(KO-tI,(KO+=t)-tI):xI(t);case 220:return t=QO.getUint16(KO),KO+=2,wI(t);case 221:return t=QO.getUint32(KO),KO+=4,wI(t);case 222:return t=QO.getUint16(KO),KO+=2,DI(t);case 223:return t=QO.getUint32(KO),KO+=4,DI(t);default:if(e>=224)return e-256;if(void 0===e){let e=new Error("Unexpected end of MessagePack data");throw e.incomplete=!0,e}throw new Error("Unknown MessagePack token "+e)}}}var dI=/^[a-zA-Z_$][a-zA-Z\d_$]*$/;function pI(e,t){function n(){if(n.count++>2){let n=e.read=new Function("r","return function(){return {"+e.map((e=>dI.test(e)?e+":r()":"["+JSON.stringify(e)+"]:r()")).join(",")+"}}")(hI);return 0===e.highByte&&(e.read=fI(t,e.read)),n()}let i={};for(let t=0,n=e.length;t<n;t++){i[e[t]]=hI()}return i}return n.count=0,0===e.highByte?fI(t,n):n}var fI=(e,t)=>function(){let n=HO[KO++];if(0===n)return t();let i=e<32?-(e+(n<<5)):e+(n<<5),r=GO[i]||mI()[i];if(!r)throw new Error("Record id is not defined for "+i);return r.read||(r.read=pI(r,e)),r.read()};function mI(){let e=II((()=>(HO=null,eI.getStructures())));return GO=eI._mergeStructures(e,GO)}var gI=bI,vI=bI,yI=bI,xI=bI;function bI(e){let t;if(e<16&&(t=EI(e)))return t;if(e>64&&NO)return NO.decode(HO.subarray(KO,KO+=e));let n=KO+e,i=[];for(t="";KO<n;){let e=HO[KO++];if(0===(128&e))i.push(e);else if(192===(224&e)){let t=63&HO[KO++];i.push((31&e)<<6|t)}else if(224===(240&e)){let t=63&HO[KO++],n=63&HO[KO++];i.push((31&e)<<12|t<<6|n)}else if(240===(248&e)){let t=(7&e)<<18|(63&HO[KO++])<<12|(63&HO[KO++])<<6|63&HO[KO++];t>65535&&(t-=65536,i.push(t>>>10&1023|55296),t=56320|1023&t),i.push(t)}else i.push(e);i.length>=4096&&(t+=_I.apply(String,i),i.length=0)}return i.length>0&&(t+=_I.apply(String,i)),t}function wI(e){let t=new Array(e);for(let n=0;n<e;n++)t[n]=hI();return t}function DI(e){if(eI.mapsAsObjects){let t={};for(let n=0;n<e;n++)t[TI()]=hI();return t}{let t=new Map;for(let n=0;n<e;n++)t.set(hI(),hI());return t}}var _I=String.fromCharCode;function SI(e){let t=KO,n=new Array(e);for(let i=0;i<e;i++){let e=HO[KO++];if((128&e)>0)return void(KO=t);n[i]=e}return _I.apply(String,n)}function EI(e){if(e<4){if(e<2){if(0===e)return"";{let e=HO[KO++];return(128&e)>1?void(KO-=1):_I(e)}}{let t=HO[KO++],n=HO[KO++];if((128&t)>0||(128&n)>0)return void(KO-=2);if(e<3)return _I(t,n);let i=HO[KO++];return(128&i)>0?void(KO-=3):_I(t,n,i)}}{let t=HO[KO++],n=HO[KO++],i=HO[KO++],r=HO[KO++];if((128&t)>0||(128&n)>0||(128&i)>0||(128&r)>0)return void(KO-=4);if(e<6){if(4===e)return _I(t,n,i,r);{let e=HO[KO++];return(128&e)>0?void(KO-=5):_I(t,n,i,r,e)}}if(e<8){let s=HO[KO++],a=HO[KO++];if((128&s)>0||(128&a)>0)return void(KO-=6);if(e<7)return _I(t,n,i,r,s,a);let o=HO[KO++];return(128&o)>0?void(KO-=7):_I(t,n,i,r,s,a,o)}{let s=HO[KO++],a=HO[KO++],o=HO[KO++],l=HO[KO++];if((128&s)>0||(128&a)>0||(128&o)>0||(128&l)>0)return void(KO-=8);if(e<10){if(8===e)return _I(t,n,i,r,s,a,o,l);{let e=HO[KO++];return(128&e)>0?void(KO-=9):_I(t,n,i,r,s,a,o,l,e)}}if(e<12){let u=HO[KO++],c=HO[KO++];if((128&u)>0||(128&c)>0)return void(KO-=10);if(e<11)return _I(t,n,i,r,s,a,o,l,u,c);let h=HO[KO++];return(128&h)>0?void(KO-=11):_I(t,n,i,r,s,a,o,l,u,c,h)}{let u=HO[KO++],c=HO[KO++],h=HO[KO++],d=HO[KO++];if((128&u)>0||(128&c)>0||(128&h)>0||(128&d)>0)return void(KO-=12);if(e<14){if(12===e)return _I(t,n,i,r,s,a,o,l,u,c,h,d);{let e=HO[KO++];return(128&e)>0?void(KO-=13):_I(t,n,i,r,s,a,o,l,u,c,h,d,e)}}{let p=HO[KO++],f=HO[KO++];if((128&p)>0||(128&f)>0)return void(KO-=14);if(e<15)return _I(t,n,i,r,s,a,o,l,u,c,h,d,p,f);let m=HO[KO++];return(128&m)>0?void(KO-=15):_I(t,n,i,r,s,a,o,l,u,c,h,d,p,f,m)}}}}}function CI(e){return eI.copyBuffers?Uint8Array.prototype.slice.call(HO,KO,KO+=e):HO.subarray(KO,KO+=e)}function AI(e){let t=HO[KO++];if(iI[t])return iI[t](HO.subarray(KO,KO+=e));throw new Error("Unknown extension type "+t)}var MI=new Array(4096);function TI(){let e=HO[KO++];if(!(e>=160&&e<192))return KO--,hI();if(e-=160,nI>=KO)return qO.slice(KO-tI,(KO+=e)-tI);if(!(0==nI&&WO<180))return gI(e);let t,n=4095&(e<<5^(e>1?QO.getUint16(KO):e>0?HO[KO]:0)),i=MI[n],r=KO,s=KO+e-3,a=0;if(i&&i.bytes==e){for(;r<s;){if(t=QO.getUint32(r),t!=i[a++]){r=1879048192;break}r+=4}for(s+=3;r<s;)if(t=HO[r++],t!=i[a++]){r=1879048192;break}if(r===s)return KO=r,i.string;s-=3,r=KO}for(i=[],MI[n]=i,i.bytes=e;r<s;)t=QO.getUint32(r),i.push(t),r+=4;for(s+=3;r<s;)t=HO[r++],i.push(t);let o=e<16?EI(e):SI(e);return i.string=null!=o?o:gI(e)}var PI=(e,t)=>{var n=hI();let i=e;void 0!==t&&(e=e<32?-((t<<5)+e):(t<<5)+e,n.highByte=t);let r=GO[e];return r&&r.isShared&&((GO.restoreStructures||(GO.restoreStructures=[]))[e]=r),GO[e]=n,n.read=pI(n,i),n.read()},FI="object"==typeof self?self:global;iI[0]=()=>{},iI[0].noBuffer=!0,iI[101]=()=>{let e=hI();return(FI[e[0]]||Error)(e[1])},iI[105]=e=>{let t=QO.getUint32(KO-4);XO||(XO=new Map);let n,i=HO[KO];n=i>=144&&i<160||220==i||221==i?[]:{};let r={target:n};XO.set(t,r);let s=hI();return r.used?Object.assign(n,s):(r.target=s,s)},iI[112]=e=>{let t=QO.getUint32(KO-4),n=XO.get(t);return n.used=!0,n.target},iI[115]=()=>new Set(hI());var OI=["Int8","Uint8","Uint8Clamped","Int16","Uint16","Int32","Uint32","Float32","Float64","BigInt64","BigUint64"].map((e=>e+"Array"));function II(e){let t=WO,n=KO,i=$O,r=tI,s=nI,a=qO,o=JO,l=XO,u=YO,c=new Uint8Array(HO.slice(0,WO)),h=GO,d=GO.slice(0,GO.length),p=eI,f=oI,m=e();return WO=t,KO=n,$O=i,tI=r,nI=s,qO=a,JO=o,XO=l,YO=u,HO=c,oI=f,(GO=h).splice(0,GO.length,...d),eI=p,QO=new DataView(HO.buffer,HO.byteOffset,HO.byteLength),m}function kI(){HO=null,XO=null,GO=null}iI[116]=e=>{let t=e[0],n=OI[t];if(!n)throw new Error("Could not find typed array for code "+t);return new FI[n](Uint8Array.prototype.slice.call(e,1).buffer)},iI[120]=()=>{let e=hI();return new RegExp(e[0],e[1])},iI[98]=e=>{let t=(e[0]<<24)+(e[1]<<16)+(e[2]<<8)+e[3],n=KO;KO+=t-4,(YO=[hI(),hI()]).position0=0,YO.position1=0;let i=KO;KO=n;try{return hI()}finally{KO=i}},iI[255]=e=>4==e.length?new Date(1e3*(16777216*e[0]+(e[1]<<16)+(e[2]<<8)+e[3])):8==e.length?new Date(((e[0]<<22)+(e[1]<<14)+(e[2]<<6)+(e[3]>>2))/1e6+1e3*(4294967296*(3&e[3])+16777216*e[4]+(e[5]<<16)+(e[6]<<8)+e[7])):12==e.length?new Date(((e[0]<<24)+(e[1]<<16)+(e[2]<<8)+e[3])/1e6+1e3*((128&e[4]?-281474976710656:0)+1099511627776*e[6]+4294967296*e[7]+16777216*e[8]+(e[9]<<16)+(e[10]<<8)+e[11])):new Date("invalid");var BI=new Array(147);for(let n=0;n<256;n++)BI[n]=+("1e"+Math.floor(45.15-.30103*n));var RI,LI=new lI({useRecords:!1}),zI=(LI.unpack,LI.unpackMultiple,LI.unpack,new Float32Array(1));new Uint8Array(zI.buffer,0,4);try{RI=new TextEncoder}catch(Mhe){}var NI,jI,UI,VI,HI,WI=typeof Buffer<"u",GI=WI?Buffer.allocUnsafeSlow:Uint8Array,qI=WI?Buffer:Uint8Array,YI=WI?4294967296:2144337920,XI=0,QI=null,KI=/[\u0080-\uFFFF]/,ZI=Symbol("record-id"),JI=class extends lI{constructor(e){super(e),this.offset=0;let t,n,i,r,s,a=0,o=qI.prototype.utf8Write?function(e,t,n){return UI.utf8Write(e,t,n)}:!(!RI||!RI.encodeInto)&&function(e,t){return RI.encodeInto(e,UI.subarray(t)).written},l=this;e||(e={});let u=e&&e.sequential,c=e.structures||e.saveStructures,h=e.maxSharedStructures;if(null==h&&(h=c?32:0),h>8160)throw new Error("Maximum maxSharedStructure is 8160");let d=e.maxOwnStructures;null==d&&(d=c?32:64),u&&!e.saveStructures&&(this.structures=[]);let p=h>32||d+h>64,f=h+64,m=h+d+64;if(m>8256)throw new Error("Maximum maxSharedStructure + maxOwnStructure is 8192");let g=[],v=0,y=0;this.pack=this.encode=function(e,o){if(UI||(UI=new GI(8192),VI=new DataView(UI.buffer,0,8192),XI=0),(HI=UI.length-10)-XI<2048?(UI=new GI(UI.length),VI=new DataView(UI.buffer,0,UI.length),HI=UI.length-10,XI=0):XI=XI+7&2147483640,t=XI,s=l.structuredClone?new Map:null,l.bundleStrings?(QI=["",""],UI[XI++]=214,UI[XI++]=98,QI.position=XI-t,XI+=4):QI=null,n=l.structures,n){n.uninitialized&&(n=l._mergeStructures(l.getStructures()));let e=n.sharedLength||0;if(e>h)throw new Error("Shared structures is larger than maximum shared structures, try increasing maxSharedStructures to "+n.sharedLength);if(!n.transitions){n.transitions=Object.create(null);for(let t=0;t<e;t++){let e=n[t];if(!e)continue;let i,r=n.transitions;for(let t=0,n=e.length;t<n;t++){let n=e[t];i=r[n],i||(i=r[n]=Object.create(null)),r=i}r[ZI]=t+64}a=e}u||(n.nextId=e+64)}i&&(i=!1),r=n||[];try{if(x(e),QI){VI.setUint32(QI.position+t,XI-QI.position-t);let e=QI;QI=null,x(e[0]),x(e[1])}if(l.offset=XI,s&&s.idsToInsert){(XI+=6*s.idsToInsert.length)>HI&&w(XI),l.offset=XI;let e=function(e,t){let n,i=6*t.length,r=e.length-i;for(t.sort(((e,t)=>e.offset>t.offset?1:-1));n=t.pop();){let t=n.offset,s=n.id;e.copyWithin(t+i,t,r),i-=6;let a=t+i;e[a++]=214,e[a++]=105,e[a++]=s>>24,e[a++]=s>>16&255,e[a++]=s>>8&255,e[a++]=255&s,r=t}return e}(UI.subarray(t,XI),s.idsToInsert);return s=null,e}return o&ck?(UI.start=t,UI.end=XI,UI):UI.subarray(t,XI)}finally{if(n){if(y<10&&y++,v>1e4)n.transitions=null,y=0,v=0,g.length>0&&(g=[]);else if(g.length>0&&!u){for(let e=0,t=g.length;e<t;e++)g[e][ZI]=0;g=[]}if(i&&l.saveStructures){let i=n.sharedLength||h;n.length>i&&(n=n.slice(0,i));let r=UI.subarray(t,XI);return!1===l.saveStructures(n,a)?(l._mergeStructures(l.getStructures()),l.pack(e)):(a=i,r)}}o&hk&&(XI=t)}};let x=e=>{XI>HI&&(UI=w(XI));var n,i=typeof e;if("string"===i){let t,i=e.length;if(QI&&i>=8&&i<4096){let t=KI.test(e);return QI[t?0:1]+=e,UI[XI++]=193,void x(t?-i:i)}t=i<32?1:i<256?2:i<65536?3:5;let r=3*i;if(XI+r>HI&&(UI=w(XI+r)),i<64||!o){let r,s,a,o=XI+t;for(r=0;r<i;r++)s=e.charCodeAt(r),s<128?UI[o++]=s:s<2048?(UI[o++]=s>>6|192,UI[o++]=63&s|128):55296===(64512&s)&&56320===(64512&(a=e.charCodeAt(r+1)))?(s=65536+((1023&s)<<10)+(1023&a),r++,UI[o++]=s>>18|240,UI[o++]=s>>12&63|128,UI[o++]=s>>6&63|128,UI[o++]=63&s|128):(UI[o++]=s>>12|224,UI[o++]=s>>6&63|128,UI[o++]=63&s|128);n=o-XI-t}else n=o(e,XI+t,r);n<32?UI[XI++]=160|n:n<256?(t<2&&UI.copyWithin(XI+2,XI+1,XI+1+n),UI[XI++]=217,UI[XI++]=n):n<65536?(t<3&&UI.copyWithin(XI+3,XI+2,XI+2+n),UI[XI++]=218,UI[XI++]=n>>8,UI[XI++]=255&n):(t<5&&UI.copyWithin(XI+5,XI+3,XI+3+n),UI[XI++]=219,VI.setUint32(XI,n),XI+=4),XI+=n}else if("number"===i)if(e>>>0===e)e<64?UI[XI++]=e:e<256?(UI[XI++]=204,UI[XI++]=e):e<65536?(UI[XI++]=205,UI[XI++]=e>>8,UI[XI++]=255&e):(UI[XI++]=206,VI.setUint32(XI,e),XI+=4);else if((e|0)===e)e>=-32?UI[XI++]=256+e:e>=-128?(UI[XI++]=208,UI[XI++]=e+256):e>=-32768?(UI[XI++]=209,VI.setInt16(XI,e),XI+=2):(UI[XI++]=210,VI.setInt32(XI,e),XI+=4);else{let t;if((t=this.useFloat32)>0&&e<4294967296&&e>=-2147483648){let n;if(UI[XI++]=202,VI.setFloat32(XI,e),t<4||((n=e*BI[(127&UI[XI])<<1|UI[XI+1]>>7])|0)===n)return void(XI+=4);XI--}UI[XI++]=203,VI.setFloat64(XI,e),XI+=8}else if("object"===i)if(e){if(s){let n=s.get(e);if(n){if(!n.id){let e=s.idsToInsert||(s.idsToInsert=[]);n.id=e.push(n)}return UI[XI++]=214,UI[XI++]=112,VI.setUint32(XI,n.id),void(XI+=4)}s.set(e,{offset:XI-t})}let i=e.constructor;if(i===Object)b(e,!0);else if(i===Array){(n=e.length)<16?UI[XI++]=144|n:n<65536?(UI[XI++]=220,UI[XI++]=n>>8,UI[XI++]=255&n):(UI[XI++]=221,VI.setUint32(XI,n),XI+=4);for(let t=0;t<n;t++)x(e[t])}else if(i===Map){(n=e.size)<16?UI[XI++]=128|n:n<65536?(UI[XI++]=222,UI[XI++]=n>>8,UI[XI++]=255&n):(UI[XI++]=223,VI.setUint32(XI,n),XI+=4);for(let[t,n]of e)x(t),x(n)}else{for(let t=0,n=NI.length;t<n;t++){if(e instanceof jI[t]){let n=NI[t];if(n.write)return n.type&&(UI[XI++]=212,UI[XI++]=n.type,UI[XI++]=0),void x(n.write.call(this,e));let i,r=UI,s=VI,a=XI;UI=null;try{i=n.pack.call(this,e,(e=>(UI=r,r=null,(XI+=e)>HI&&w(XI),{target:UI,targetView:VI,position:XI-e})),x)}finally{r&&(VI=s,XI=a,HI=(UI=r).length-10)}return void(i&&(i.length+XI>HI&&w(i.length+XI),XI=tk(i,UI,XI,n.type)))}}b(e,!e.hasOwnProperty)}}else UI[XI++]=192;else if("boolean"===i)UI[XI++]=e?195:194;else if("bigint"===i){if(e<BigInt(1)<<BigInt(63)&&e>=-(BigInt(1)<<BigInt(63)))UI[XI++]=211,VI.setBigInt64(XI,e);else if(e<BigInt(1)<<BigInt(64)&&e>0)UI[XI++]=207,VI.setBigUint64(XI,e);else{if(!this.largeBigIntToFloat)throw new RangeError(e+" was too large to fit in MessagePack 64-bit integer format, set largeBigIntToFloat to convert to float-64");UI[XI++]=203,VI.setFloat64(XI,Number(e))}XI+=8}else if("undefined"===i)this.encodeUndefinedAsNil?UI[XI++]=192:(UI[XI++]=212,UI[XI++]=0,UI[XI++]=0);else{if("function"!==i)throw new Error("Unknown type: "+i);x(this.writeFunction&&this.writeFunction())}},b=!1===this.useRecords?this.variableMapSize?e=>{let t,n=Object.keys(e),i=n.length;i<16?UI[XI++]=128|i:i<65536?(UI[XI++]=222,UI[XI++]=i>>8,UI[XI++]=255&i):(UI[XI++]=223,VI.setUint32(XI,i),XI+=4);for(let r=0;r<i;r++)x(t=n[r]),x(e[t])}:(e,n)=>{UI[XI++]=222;let i=XI-t;XI+=2;let r=0;for(let t in e)(n||e.hasOwnProperty(t))&&(x(t),x(e[t]),r++);UI[i+++t]=r>>8,UI[i+t]=255&r}:e=>{let t,n=Object.keys(e),s=r.transitions||(r.transitions=Object.create(null)),a=0;for(let i=0,r=n.length;i<r;i++){let e=n[i];t=s[e],t||(t=s[e]=Object.create(null),a++),s=t}let o=s[ZI];if(o)o>=96&&p?(UI[XI++]=96+(31&(o-=96)),UI[XI++]=o>>5):UI[XI++]=o;else{o=r.nextId,o||(o=64),o<f&&this.shouldShareStructure&&!this.shouldShareStructure(n)?(o=r.nextOwnId,o<m||(o=f),r.nextOwnId=o+1):(o>=m&&(o=f),r.nextId=o+1);let e=n.highByte=o>=96&&p?o-96>>5:-1;s[ZI]=o,r[o-64]=n,o<f?(n.isShared=!0,r.sharedLength=o-63,i=!0,e>=0?(UI[XI++]=96+(31&o),UI[XI++]=e):UI[XI++]=o):(e>=0?(UI[XI++]=213,UI[XI++]=114,UI[XI++]=96+(31&o),UI[XI++]=e):(UI[XI++]=212,UI[XI++]=114,UI[XI++]=o),a&&(v+=y*a),g.length>=d&&(g.shift()[ZI]=0),g.push(s),x(n))}for(let i=0,r=n.length;i<r;i++)x(e[n[i]])},w=e=>{let n;if(e>16777216){if(e-t>YI)throw new Error("Packed buffer would be larger than maximum buffer size");n=Math.min(YI,4096*Math.round(Math.max((e-t)*(e>67108864?1.25:2),4194304)/4096))}else n=1+(Math.max(e-t<<2,UI.length-1)>>12)<<12;let i=new GI(n);return VI=new DataView(i.buffer,0,n),UI.copy?UI.copy(i,0,t,e):i.set(UI.slice(t,e)),XI-=t,t=0,HI=i.length-10,UI=i}}useBuffer(e){UI=e,VI=new DataView(UI.buffer,UI.byteOffset,UI.byteLength),XI=0}};function $I(e,t,n,i){let r=e.byteLength;if(r+1<256){var{target:s,position:a}=n(4+r);s[a++]=199,s[a++]=r+1}else if(r+1<65536){var{target:s,position:a}=n(5+r);s[a++]=200,s[a++]=r+1>>8,s[a++]=r+1&255}else{var{target:s,position:a,targetView:o}=n(7+r);s[a++]=201,o.setUint32(a,r+1),a+=4}s[a++]=116,s[a++]=t,s.set(new Uint8Array(e.buffer,e.byteOffset,e.byteLength),a)}function ek(e,t){let n=e.byteLength;var i,r;if(n<256){var{target:i,position:r}=t(n+2);i[r++]=196,i[r++]=n}else if(n<65536){var{target:i,position:r}=t(n+3);i[r++]=197,i[r++]=n>>8,i[r++]=255&n}else{var{target:i,position:r,targetView:s}=t(n+5);i[r++]=198,s.setUint32(r,n),r+=4}i.set(e,r)}function tk(e,t,n,i){let r=e.length;switch(r){case 1:t[n++]=212;break;case 2:t[n++]=213;break;case 4:t[n++]=214;break;case 8:t[n++]=215;break;case 16:t[n++]=216;break;default:r<256?(t[n++]=199,t[n++]=r):r<65536?(t[n++]=200,t[n++]=r>>8,t[n++]=255&r):(t[n++]=201,t[n++]=r>>24,t[n++]=r>>16&255,t[n++]=r>>8&255,t[n++]=255&r)}return t[n++]=i,t.set(e,n),n+=r}function nk(e){if(e.Class){if(!e.pack&&!e.write)throw new Error("Extension has no pack or write function");if(e.pack&&!e.type)throw new Error("Extension has no type (numeric code to identify the extension)");jI.unshift(e.Class),NI.unshift(e)}!function(e){e.unpack?iI[e.type]=e.unpack:iI[e.type]=e}(e)}jI=[Date,Set,Error,RegExp,ArrayBuffer,Object.getPrototypeOf(Uint8Array.prototype).constructor,sI],NI=[{pack(e,t,n){let i=e.getTime()/1e3;if((this.useTimestamp32||0===e.getMilliseconds())&&i>=0&&i<4294967296){let{target:e,targetView:n,position:r}=t(6);e[r++]=214,e[r++]=255,n.setUint32(r,i)}else if(i>0&&i<17179869184){let{target:n,targetView:r,position:s}=t(10);n[s++]=215,n[s++]=255,r.setUint32(s,4e6*e.getMilliseconds()+(i/1e3/4294967296|0)),r.setUint32(s+4,i)}else if(isNaN(i)){if(this.onInvalidDate)return t(0),n(this.onInvalidDate());let{target:e,targetView:i,position:r}=t(3);e[r++]=212,e[r++]=255,e[r++]=255}else{let{target:n,targetView:r,position:s}=t(15);n[s++]=199,n[s++]=12,n[s++]=255,r.setUint32(s,1e6*e.getMilliseconds()),r.setBigInt64(s+4,BigInt(Math.floor(i)))}}},{pack(e,t,n){let i=Array.from(e),{target:r,position:s}=t(this.structuredClone?3:0);this.structuredClone&&(r[s++]=212,r[s++]=115,r[s++]=0),n(i)}},{pack(e,t,n){let{target:i,position:r}=t(this.structuredClone?3:0);this.structuredClone&&(i[r++]=212,i[r++]=101,i[r++]=0),n([e.name,e.message])}},{pack(e,t,n){let{target:i,position:r}=t(this.structuredClone?3:0);this.structuredClone&&(i[r++]=212,i[r++]=120,i[r++]=0),n([e.source,e.flags])}},{pack(e,t){this.structuredClone?$I(e,16,t):ek(WI?Buffer.from(e):new Uint8Array(e),t)}},{pack(e,t){let n=e.constructor;n!==qI&&this.structuredClone?$I(e,OI.indexOf(n.name),t):ek(e,t)}},{pack(e,t){let{target:n,position:i}=t(1);n[i]=193}}];var ik,rk,sk=new JI({useRecords:!1}),{NEVER:ak,ALWAYS:ok,DECIMAL_ROUND:lk,DECIMAL_FIT:uk}=(sk.pack,sk.pack,{NEVER:0,ALWAYS:1,DECIMAL_ROUND:3,DECIMAL_FIT:4}),ck=512,hk=1024,dk=new JI({structuredClone:!0});function pk(e){if(eO(e))return e;if(Array.isArray(e))return e.map(pk);if("object"==typeof e&&null!==e){let t={};for(let n of Object.keys(e).sort())t[n]=pk(e[n]);return Object.setPrototypeOf(t,Object.getPrototypeOf(e)),t}return e}function fk(e){return"MouseDown"===e||"MouseUp"===e||"KeyDown"===e||"KeyUp"===e||"Collision"===e||"Trigger"===e}nk({Class:QF.prototype.constructor,type:1,write:e=>d({},e),read:e=>(Object.setPrototypeOf(e,QF.prototype),e)}),nk({Class:sO.prototype.constructor,type:2,write:e=>[...e],read:e=>(Object.setPrototypeOf(e,sO.prototype),e)}),nk({Class:rO.prototype.constructor,type:3,write:e=>[...e],read:e=>(Object.setPrototypeOf(e,rO.prototype),e)}),nk({Class:UO.prototype.constructor,type:4,write:e=>e.id,read:e=>new UO(e)}),nk({Class:VO.prototype.constructor,type:5,write:e=>e.data,read:e=>new VO(e)}),nk({Class:hO.prototype.constructor,type:6,write:e=>d({},e),read:e=>(Object.setPrototypeOf(e,hO.prototype),e)}),(e=>{function t(e){return dk.pack(e)}e.serialize=t,e.deserialize=function(e){return dk.unpack(e)},e.checksum=function(e){return function(e){var t=0;if(0===e.length)return t;for(let n=0;n<e.length;n++)t=(t<<5)-t+e[n],t|=0;return t}(t(pk(e))).toString()}})(ik||(ik={})),(e=>{e.toEventUIType=function(e){return"Conditional"===e.type?"Distance"===e.condition.type?"Distance":"StateChange":e.type},e.fromEventUIType=function(e){return"Distance"===e||"StateChange"===e?"Conditional":e}})(rk||(rk={}));var mk,gk,vk,yk,xk,bk,wk,Dk,_k,Sk,Ek,Ck,Ak,Mk,Tk,Pk,Fk,Ok,Ik,kk={LookAt:[],Follow:["Create"],DragDrop:["Transition","Animation","Audio","Particles","Create","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"],MouseHover:["Transition","Animation","Particles","Create","Destroy","SwitchCamera","SceneTransition","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"],Scroll:["Transition","Animation","Create","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"],Start:["Transition","Animation","Audio","Particles","Video","Create","Destroy","SwitchCamera","SceneTransition","Reset","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"],Conditional:["Transition","Animation","Audio","Particles","Video","Link","Create","Destroy","SwitchCamera","SceneTransition","Reset","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"],MouseDown:["Transition","Animation","Audio","Particles","Video","Link","Create","Destroy","SwitchCamera","SceneTransition","Reset","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"],MouseUp:["Transition","Animation","Audio","Particles","Video","Link","Create","Destroy","SwitchCamera","SceneTransition","Reset","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"],MousePress:["Transition","Animation","Audio","Particles","Video","Link","Create","SwitchCamera","SceneTransition","Reset","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"],KeyDown:["Transition","Animation","Audio","Particles","Video","Link","Create","Destroy","SwitchCamera","SceneTransition","Reset","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"],KeyUp:["Transition","Animation","Audio","Particles","Video","Link","Create","Destroy","SwitchCamera","SceneTransition","Reset","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"],KeyPress:["Transition","Animation","Audio","Particles","Video","Link","Create","SwitchCamera","Reset","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"],GameControl:["Transition","Animation","Audio","Particles","Create","Conditional"],Collision:["Transition","Animation","Audio","Particles","Video","Create","Destroy","Reset","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"],Trigger:["Transition","Audio","Particles","Video","Link","Create","Destroy","SwitchCamera","SceneTransition","Reset","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"],Resize:["Transition","Animation","Audio","Particles","Video","Create","Destroy","SwitchCamera","SceneTransition","Reset","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"],VariableChange:["Transition","Animation","Audio","Particles","Video","Link","Create","Destroy","SwitchCamera","SceneTransition","Reset","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"],API:["Transition","Animation","Audio","Particles","Video","Link","Create","Destroy","SwitchCamera","SceneTransition","Reset","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"],WEBHOOK:["Transition","Animation","Audio","Particles","Video","Link","Create","Destroy","SwitchCamera","SceneTransition","Reset","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"],AIAssistantListener:["SetVariable"],AIAssistantTrigger:["Transition","Animation","Audio","Particles","Video","Link","Create","Destroy","SwitchCamera","SceneTransition","Reset","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"]};(e=>{e.is=function(e){return"MouseDown"===e.type||"MouseUp"===e.type||"MousePress"===e.type||"KeyDown"===e.type||"KeyUp"===e.type||"KeyPress"===e.type},e.defaultData=function(e){return"MouseDown"===e||"MouseUp"===e||"MousePress"===e?{type:e,mode:"Object",disabled:!1,actions:new sO}:{type:e,disabled:!1,key:void 0,actions:new sO}}})(mk||(mk={})),(e=>{e.propertyDefaultData=function(e){return{type:"Property",value:[null!==e&&void 0!==e?e:null,"position","x"]}},e.valueDefaultData={type:"Literal",value:0}})(gk||(gk={})),(e=>{e.comparisonDefaultData=function(e){return{type:"Comparison",operator:"==",lOperand:gk.propertyDefaultData(e),rOperand:d({},gk.valueDefaultData)}},e.distanceDefaultData=function(e){return{type:"Distance",toObject:null!==e&&void 0!==e?e:null,fromObject:null!==e&&void 0!==e?e:null,distance:200}},e.stateDefaultData=function(e,t){return{type:"State",object:null!==e&&void 0!==e?e:null,state:null!==t&&void 0!==t?t:null}}})(vk||(vk={})),(e=>{e.isConditionalSubActions=function(e){return void 0!==e.find((e=>"ifActions"===e||"elseActions"===e))}})(yk||(yk={})),(e=>{e.is=function(e){return"Conditional"===e.type},e.defaultData=function(e){return{type:"Conditional",disabled:!1,inActions:new sO,outActions:new sO,condition:vk.distanceDefaultData(e)}}})(xk||(xk={})),(e=>{e.defaultData={type:"DragDrop",cursor:"hand",disabled:!1,dampingFactor:1,objects:[],snapTo:"center",snapSurfaceMode:"bbox",snapSurfaceOffset:0,dropOn:"all",autoOrient:!0,dropDestinations:[],plane:"adaptive",planeMode:"locked",referenceFrame:"global",limits:[-1/0,1/0,-1/0,1/0,-1/0,1/0],drop:!1,resetOnSnapFail:!1,snapSpeed:20,resetSpeed:20,dragDropActions:{drag:new sO,drop:new sO}}})(bk||(bk={})),(e=>{e.defaultData={type:"Follow",disabled:!1,maxDelta:0,dampingFactor:1,target:"cursor",plane:"custom",resetOnPointerLeave:!0,resetAfterDistanceLimit:!0,enabledTranslation:[!0,!0,!0],limitDistanceEnabled:!1,limitDistance:1e3,snapDelay:0,resetSpeed:5,actions:new sO}})(wk||(wk={})),(e=>{e.defaultData={type:"LookAt",disabled:!1,distance:1e3,dampingFactor:1,target:"cursor",tilt:"up",axis:"z",plane:"custom",resetOnPointerLeave:!0,resetAfterDistanceLimit:!0,enabledRotation:[!0,!0,!0],limitDistanceEnabled:!1,limitDistance:1e3,snapDelay:0,resetSpeed:5}})(Dk||(Dk={})),(e=>{e.is=function(e){return"MouseHover"===e.type},e.defaultData=function(){return{type:"MouseHover",disabled:!1,actions:new sO}}})(_k||(_k={})),(e=>{e.is=function(e){return"Scroll"===e.type},e.defaultData=function(){return{type:"Scroll",disabled:!1,steps:100,trigger:"load",startFrom:"enter",enterAnchor:"top",startOffset:0,endAfter:400,actions:new sO}}})(Sk||(Sk={})),(e=>{e.is=function(e){return"Start"===e.type},e.defaultData=function(){return{type:"Start",disabled:!1,actions:new sO}}})(Ek||(Ek={})),(e=>{e.is=function(e){return"Collision"===e.type},e.defaultData=function(){return{type:"Collision",disabled:!1,target:"character",actions:new sO}}})(Ck||(Ck={})),(e=>{e.is=function(e){return"Trigger"===e.type},e.defaultData=function(e,t){return{type:"Trigger",disabled:!1,target:"all",triggeringObjects:[],actions:new sO,triggerZone:"box",position:t.toArray(),rotation:[0,0,0],size:e.toArray(),radius:e.length()/2,helperVisible:!0}}})(Ak||(Ak={})),(e=>{e.defaultSizes={mobile:[480,480],tablet:[768,768],desktop:[1200,1200],custom:[769,1200]},e.is=function(e){return"Resize"===e.type},e.sizeToDevice=function(e){return"string"==typeof e?e:"custom"},e.deviceToSize=function(t){return"string"==typeof t?[...e.defaultSizes[t]]:[...t]},e.defaultData=function(){let t={size:"mobile",operator:"<",actions:new sO},n={size:"tablet",operator:"<",actions:new sO},i={size:[...e.defaultSizes.custom],operator:"<>",actions:new sO},r=new sO;return r.push({id:ov.generateUUID(),fi:0,data:t},{id:ov.generateUUID(),fi:1,data:n},{id:ov.generateUUID(),fi:2,data:i}),{type:"Resize",disabled:!1,orientation:"horizontal",breakpoints:r}},e.defaultBreakpointData=function(){return{size:[...e.defaultSizes.custom],operator:"<>",actions:new sO}}})(Mk||(Mk={})),(e=>{e.propertyPaths={Position:["position"],"Position X":["position","x"],"Position Y":["position","y"],"Position Z":["position","z"],Rotation:["rotation"],"Rotation X":["rotation","x"],"Rotation Y":["rotation","y"],"Rotation Z":["rotation","z"],Scale:["scale"],"Scale X":["scale","x"],"Scale Y":["scale","y"],"Scale Z":["scale","z"],Width:["width"],Height:["height"],Depth:["depth"],"Mouse Position X":["mouse","x"],"Mouse Position Y":["mouse","y"],"Mouse Pressed":["mouse","pressed"],"Screen Width":["mouse","width"],"Screen Height":["mouse","height"],"Hit Position X":["raycast","x"],"Hit Position Y":["raycast","y"],"Hit Position Z":["raycast","z"],"Hit Object Position X":["raycast","objX"],"Hit Object Position Y":["raycast","objY"],"Hit Object Position Z":["raycast","objZ"]},e.is=function(e){return"VariableChange"===e.type},e.defaultData=function(){return{disabled:!1,type:"VariableChange",actions:new sO,variableId:"",objectId:null,property:"Position X"}}})(Tk||(Tk={})),(e=>{e.is=function(e){return"API"===e.type},e.defaultData=function(){return{disabled:!1,type:"API",successActions:new sO,errorActions:new sO,userAPIId:""}}})(Pk||(Pk={})),(e=>{e.is=function(e){return"WEBHOOK"===e.type},e.defaultData=function(){return{disabled:!1,type:"WEBHOOK",actions:new sO,userWebhookId:""}}})(Fk||(Fk={})),(e=>{e.is=function(e){return"AIAssistantListener"===e.type},e.defaultData=function(){return{disabled:!1,type:"AIAssistantListener",actions:new sO,analysis:"average",analysisRange:[0,71],analysisSingle:0}}})(Ok||(Ok={})),(e=>{e.is=function(e){return"AIAssistantTrigger"===e.type},e.defaultData=function(){return{disabled:!1,description:"",type:"AIAssistantTrigger",actions:new sO}}})(Ik||(Ik={}));var Bk,Rk,Lk,zk,Nk,jk,Uk,Vk,Hk,Wk,Gk,qk,Yk,Xk,Qk,Kk="personal camera",Zk="a218fcc3-276b-49b9-b485-49037fd14f5f",Jk=5526619;function $k(e){return"string"==typeof e&&36===e.length&&/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(e)}(e=>{function t(e,t){return Math.pow(t[0]-e[0],2)+Math.pow(t[1]-e[1],2)}function n(e,n){return Math.sqrt(t(e,n))}function i(t,n,i){let r=e.sub(n,t),s=e.sub(i,t),a=e.dot(r,s)/e.dot(r,r),o=e.scalarMultiply(r,a);return e.add(t,o)}e.isEqual=function(e,t){return e[0]===t[0]&&e[1]===t[1]},e.lerp=function(e,t,n){return[e[0]+(t[0]-e[0])*n,e[1]+(t[1]-e[1])*n]},e.add=function(e,t){return[e[0]+t[0],e[1]+t[1]]},e.sub=function(e,t){return[e[0]-t[0],e[1]-t[1]]},e.multiply=function(e,t){return[e[0]*t[0],e[1]*t[1]]},e.divide=function(e,t){return[e[0]/t[0],e[1]/t[1]]},e.distanceSquared=t,e.distance=n,e.dot=function(e,t){return e[0]*t[0]+e[1]*t[1]},e.scalarMultiply=function(e,t){return[e[0]*t,e[1]*t]},e.projectionOnto=i,e.projectionOntoDistance=function(e,t,r){return n(e,i(e,t,r))},e.center=function(e,t){return[.5*(e[0]+t[0]),.5*(e[1]+t[1])]}})(Bk||(Bk={})),(e=>{e.isEqual=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]},e.add=function(e,t){return[e[0]+t[0],e[1]+t[1],e[2]+t[2]]},e.sub=function(e,t){return[e[0]-t[0],e[1]-t[1],e[2]-t[2]]},e.div=function(e,t){return[e[0]/t[0],e[1]/t[1],e[2]/t[2]]},e.mul=function(e,t){return[e[0]*t[0],e[1]*t[1],e[2]*t[2]]},e.dist=function(e,t){return Math.hypot(e[0]-t[0],e[1]-t[1],e[2]-t[2])},e.lerp=function(e,t,n){return[e[0]+(t[0]-e[0])*n,e[1]+(t[1]-e[1])*n,e[2]+(t[2]-e[2])*n]}})(Rk||(Rk={})),(e=>{e.isEqual=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]},e.lerp=function(e,t,n){return[e[0]+(t[0]-e[0])*n,e[1]+(t[1]-e[1])*n,e[2]+(t[2]-e[2])*n,e[3]+(t[3]-e[3])*n]}})(Lk||(Lk={})),(e=>{let t=180/Math.PI,n=Math.PI/180;function i(e){return"number"==typeof e?e*t:e}function r(e){return"number"==typeof e?e*n:e}e.radToDeg=function(e){return[i(e[0]),i(e[1]),i(e[2])]},e.degToRad=function(e){return[r(e[0]),r(e[1]),r(e[2])]}})(zk||(zk={})),(e=>{e.identity=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],e.isEqual=function(e,t){for(let n=0;n<16;n++)if(e[n]!==t[n])return!1;return!0},e.simplify=function(t){return null!==t&&void 0!==t?t:e.identity},e.applyMatrix4=function(e,t){let n=t.slice(0);for(var i=0,r=t.length;i<r;i+=3){let r=e[3]*t[i]+e[7]*t[i+1]+e[11]*t[i+2]+e[15];n[i]=(e[0]*t[i]+e[4]*t[i+1]+e[8]*t[i+2]+e[12])/r,n[i+1]=(e[1]*t[i]+e[5]*t[i+1]+e[9]*t[i+2]+e[13])/r,n[i+2]=(e[2]*t[i]+e[6]*t[i+1]+e[10]*t[i+2]+e[14])/r}return n}})(Nk||(Nk={})),(e=>{e.isRGB=function(e){return"object"==typeof e&&"number"==typeof e.r&&"number"==typeof e.g&&"number"==typeof e.b},e.white={r:1,g:1,b:1},e.red={r:1,g:0,b:0},e.black={r:0,g:0,b:0},e.toRgb255a1=function(e){return{r:Math.round(255*e.r),g:Math.round(255*e.g),b:Math.round(255*e.b),a:1}},e.clone=function(e){return{r:e.r,g:e.g,b:e.b}},e.fromHex=function(e){return{r:((e=Math.floor(e))>>16&255)/255,g:(e>>8&255)/255,b:(255&e)/255}},e.toHex=function(e){return 65536*Math.round(255*e.r)+256*Math.round(255*e.g)+Math.round(255*e.b)},e.equals=function(e,t){return e.r===t.r&&e.g===t.g&&e.b===t.b},e.equalsFixed=function(e,t){return e.r.toFixed(2)===t.r.toFixed(2)&&e.g.toFixed(2)===t.g.toFixed(2)&&e.b.toFixed(2)===t.b.toFixed(2)},e.lerp=function(e,t,n){return{r:e.r+(t.r-e.r)*n,g:e.g+(t.g-e.g)*n,b:e.b+(t.b-e.b)*n}}})(jk||(jk={})),(e=>{e.white=d(d({},jk.white),{},{a:1}),e.transparent=d(d({},jk.white),{},{a:0}),e.from0to1=function(e){return{r:e[0],g:e[1],b:e[2],a:e[3]}},e.fromHexAndA=function(e,t){return d(d({},jk.fromHex(e)),{},{a:t})},e.toRgb255a1=function(e){return{r:Math.round(255*e.r),g:Math.round(255*e.g),b:Math.round(255*e.b),a:e.a}},e.equals=function(e,t){return jk.equals(e,t)&&e.a===t.a},e.equalsFixed=function(e,t){return jk.equalsFixed(e,t)&&e.a.toFixed(2)===t.a.toFixed(2)},e.lerp=function(e,t,n){return{r:e.r+(t.r-e.r)*n,g:e.g+(t.g-e.g)*n,b:e.b+(t.b-e.b)*n,a:e.a+(t.a-e.a)*n}},e.toStyle=function(){let{r:t,g:n,b:i,a:r}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e.white;return"rgba(".concat(255*t,", ").concat(255*n,", ").concat(255*i,", ").concat(r,")")}})(Uk||(Uk={})),(e=>{e.identity={position:[0,0,0],rotation:[0,0,0],scale:[1,1,1]}})(Vk||(Vk={})),(e=>{e.defaultData={mass:1,stiffness:80,damping:10,velocity:0}})(Hk||(Hk={})),(e=>{e.defaultData={control1:[.5,0],control2:[.5,1]}})(Wk||(Wk={})),(e=>{e.linear=[0,0,1,1],e.ease=[.25,.1,.25,1],e.easeIn=[.42,0,1,1],e.easeOut=[0,0,.58,1],e.easeInOut=[.42,0,.58,1]})(Gk||(Gk={})),(e=>{e.all=["PerspectiveCamera","OrthographicCamera"],e.is=function(t){return e.all.includes(t)}})(qk||(qk={})),(e=>{e.DefaultUp=[0,1,0],e.DefaultTargetOffset=1e3,e.defaultData={far:1e5,type:"OrthographicCamera",perspective:{near:70,fov:45,zoom:1},orthographic:{near:-1e5,zoom:1},up:e.DefaultUp,isUpVectorFlipped:!1,targetOffset:e.DefaultTargetOffset},e.getZoom=function(e){var t,n,i,r;return"PerspectiveCamera"===e.type?null!==(t=null===(n=e.perspective)||void 0===n?void 0:n.zoom)&&void 0!==t?t:1:null!==(i=null===(r=e.orthographic)||void 0===r?void 0:r.zoom)&&void 0!==i?i:1}})(Yk||(Yk={})),(e=>{e.defaultData=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.1;return{disabled:!1,type:"linear",hideBase:!1,count:3,radial:{radius:2*Math.max(e[0],e[1]),start:0,end:360,alignment:!1,axis:"y",scale:[1,1,1],rotation:[0,0,0],position:[0,0,0]},toObject:{object:"",spreadType:"random",scale:[0,0,0],rotation:[0,0,0],position:[0,0,0],axis:"x",seed:0,count:99,align:"normal"},linear:{scale:[1,1,1],rotation:[0,0,0],position:[e[0]+e[0]*t,0,0]},grid:{count:[2,2,2],size:e.map((e=>e*(1+t))),useCenter:!0},randomness:!1,randomnessObject:{strength:100,scale:[0,0,0],rotation:[0,0,0],position:[0,0,0],movement:1,seed:0,freqScale:10,noiseType:"perlin"}}},e.merge=function(e,t){let n=d({},e);if(hB.forEach((i=>{var r;Object.assign(n,{[i]:null!==(r=t[i])&&void 0!==r?r:e[i]})})),n.radial=d({},e.radial),t.radial){let i=e.radial,r=t.radial;dB.forEach((e=>{var t;Object.assign(n.radial,{[e]:null!==(t=r[e])&&void 0!==t?t:i[e]})}))}if(n.linear=d({},e.linear),t.linear){let i=e.linear,r=t.linear;pB.forEach((e=>{var t;Object.assign(n.linear,{[e]:null!==(t=r[e])&&void 0!==t?t:i[e]})}))}if(n.grid=d({},e.grid),t.grid){let i=e.grid,r=t.grid;fB.forEach((e=>{var t;Object.assign(n.grid,{[e]:null!==(t=r[e])&&void 0!==t?t:i[e]})}))}if(n.toObject=d({},e.toObject),t.toObject){let i=e.toObject,r=t.toObject;mB.forEach((e=>{var t;Object.assign(n.toObject,{[e]:null!==(t=r[e])&&void 0!==t?t:i[e]})}))}if(n.randomnessObject=d({},e.randomnessObject),t.randomnessObject){let i=e.randomnessObject,r=t.randomnessObject;gB.forEach((e=>{var t;Object.assign(n.randomnessObject,{[e]:null!==(t=r[e])&&void 0!==t?t:i[e]})}))}return n}})(Xk||(Xk={})),(e=>{e.defaultData={radial:{},linear:{},grid:{},toObject:{},randomnessObject:{}};let t=["radial","linear","grid","toObject","randomnessObject"];e.toOps=function(e,n){let i=[];void 0!==e.count&&i.push({type:0,path:n,props:{count:e.count}});for(let r of t){let t=e[r];t&&Object.keys(t).length>0&&i.push({type:0,path:[...n,r],props:t})}return i}})(Qk||(Qk={}));var eB,tB,nB,iB,rB,sB,aB,oB,lB,uB,cB,hB=["count"],dB=["radius","start","end","position","scale","rotation"],pB=["position","scale","rotation"],fB=["count","size"],mB=["count","position","scale","rotation"],gB=["strength","scale","rotation","position","movement","seed","freqScale"];(e=>{e.all=["PointLight","SpotLight","DirectionalLight","HemisphereLight"],e.is=function(t){return e.all.includes(t)}})(eB||(eB={})),(e=>{e.defaultData=function(e){return function(e){if("PointLight"===e)return{type:e,color:Uk.white,intensity:1,distance:2e3,decay:1,shadows:!0,shadowResolution:1024,shadowRadius:1,penumbraSize:.5,depth:1e5};if("SpotLight"===e)return{type:e,color:Uk.white,intensity:1,distance:2e3,decay:1,shadows:!0,penumbra:0,angle:30/180*Math.PI,depth:1e5,penumbraSize:.5,shadowResolution:1024,shadowRadius:1};if("DirectionalLight"===e)return{type:e,color:Uk.white,intensity:1,shadows:!0,size:2e3,depth:1e5,penumbraSize:.5,shadowResolution:1024,shadowRadius:1};throw new Error("not implemented")}(e)}})(tB||(tB={})),(e=>{e.defaultShapeData={type:"PlaneEmitterShape",size:[100,100,100]},e.defaultCollisionData={colliderEntityId:null,collisionBounce:.75},e.defaultData=d({renderMaterial:{type:"particleMaterial",color:{r:1,g:.2,b:.545,a:1},color2:{r:.945,g:.714,b:.184,a:1},coloring:"gradient",ease:"linearFadeOut",easeSize:"linearFadeOut",transparent:!0,size:[40,40],texture:"pt_default_particle",spriteRotation:[0,0]},birthRatePerSec:50,gravity:1,noiseStrength:0,noiseScale:0,noiseSeed:1,noiseType:"curl",randomRotation:0,randomScale:.2,randomMass:.5,rootObjectType:"instancedMesh",life:1,direction:[0,0,0],directionMode:"axis",speed:10,shape:e.defaultShapeData,autoPlay:!0,emitTimeDelay:0,emitTimeCycle:"infinity",emitTimeDuration:1},e.defaultCollisionData)})(nB||(nB={})),(e=>{e.defaultData={enabled:"visibility",fusedBody:!0,rigidBody:"positioned",density:1,pointMass:0,gravityScale:1,friction:.5,damping:0,restitution:.2,colliderType:"convex",enabledRotation:[!0,!0,!0],enabledTranslation:[!0,!0,!0]}})(iB||(iB={})),(e=>{e.defaultData={castShadow:!0,receiveShadow:!0},e.equals=function(e,t){return e.castShadow===t.castShadow&&e.receiveShadow===t.receiveShadow}})(rB||(rB={})),(e=>{e.defaultData={flatShading:!1,wireframe:!1,side:0},e.equals=function(e,t){return e.flatShading===t.flatShading&&e.side===t.side&&e.wireframe===t.wireframe}})(sB||(sB={})),(e=>{e.defaultData=d(d({},sB.defaultData),rB.defaultData)})(aB||(aB={})),(e=>{e.getMaterialData=function(e,t){let n=[];if("material"in e){var i,r;let s="string"==typeof e.material?null!==(i=t.materials[e.material])&&void 0!==i?i:null===(r=t.lib.materials[e.material])||void 0===r?void 0:r.asset:e.material;s&&n.push(s)}else if("materials"in e)for(let o of e.materials){var s,a;let e="string"==typeof o?null!==(s=t.materials[o])&&void 0!==s?s:null===(a=t.lib.materials[o])||void 0===a?void 0:a.asset:o;e&&n.push(e)}return n}})(oB||(oB={})),(e=>{e.defaultVideo={data:"",thumb:"/_assets/_videos/catThumb.png",type:"video",name:"Cat video"},e.maxSize=3e7})(lB||(lB={})),(e=>{e.is=function(e){return"texture"===e||"video"===e||"color"===e||"depth"===e||"normal"===e||"gradient"===e||"noise"===e||"fresnel"===e||"rainbow"===e||"toon"===e||"outline"===e||"particle"===e||"transmission"===e||"matcap"===e||"displace"===e||"pattern"===e||"light"===e}})(uB||(uB={})),(e=>{e.is=function(e){return"phong"===e||"toon"===e||"lambert"===e||"physical"===e}})(cB||(cB={}));var vB,yB,xB,bB,wB=["mode","gradientType","noiseType","displacementType","projection","cnormal","crop","axis","side"],DB=["wrapping","image","video","name","minFilter","magFilter"];(e=>{e.patch=function(e,t){let{texture:n}=t,i=o(t,pm);if(Object.assign(e,i),n){let t=e.texture;t&&Object.assign(t,n)}},e.defaultData=function(e,t){return"light"===e&&t?function(e){let t={mode:0,isMask:!1,visible:!0,bumpMap:void 0,bumpMapIntensity:5,roughnessMap:void 0,alphaOverride:1};switch(e){case"phong":return d(d({},t),{},{category:"phong",specular:{r:.2,g:.2,b:.2},shininess:5,type:"light",visible:!0,mode:0,occlusion:!0,alpha:.6});case"toon":return d(d({},t),{},{category:"toon",specular:{r:.2,g:.2,b:.2},shininess:10,type:"light",alpha:1});case"lambert":return d(d({},t),{},{category:"lambert",emissive:{r:0,g:0,b:0},type:"light",alpha:1,visible:!0,mode:0,occlusion:!0});case"physical":return d(d({},t),{},{category:"physical",roughness:.2,metalness:.2,reflectivity:.2,type:"light",alpha:1,visible:!0,mode:0,occlusion:!0})}}(t):function(e){let t={alpha:1,mode:0,isMask:!1,visible:!0};switch(e){case"texture":return d(d({},t),{},{type:"texture",size:[128,128],blending:0,axis:"x",side:2,projection:0,texture:{image:"image_0",wrapping:1e3,repeat:[1,1],offset:[0,0],rotation:0,minFilter:1008,magFilter:1006},crop:!1});case"video":return d(d({},t),{},{type:"video",size:[128,128],blending:0,axis:"x",side:2,projection:0,texture:{video:lB.defaultVideo,wrapping:1001,repeat:[1,1],offset:[0,0],rotation:0,minFilter:1008,magFilter:1006},crop:!1});case"color":return d(d({},t),{},{type:"color",color:jk.fromHex(Jk)});case"depth":return d(d({},t),{},{type:"depth",gradientType:1,smooth:!1,isVector:!0,isWorldSpace:!1,origin:[0,0,0],direction:[1,0,0],colors:[[1,1,1,1],[0,0,0,1]],steps:[0,1],near:50,far:200});case"normal":return d(d({},t),{},{type:"normal",cnormal:[1,1,1]});case"gradient":return d(d({},t),{},{type:"gradient",gradientType:0,smooth:!1,colors:[[0,0,0,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1]],steps:[0,1,1,1,1,1,1,1,1,1],num:2,angle:0,offset:[0,0],morph:[0,0]});case"noise":return d(d({},t),{},{type:"noise",size:[100,100,100],noiseType:0,scale:1,move:1,colorA:d(d({},jk.fromHex(6710886)),{},{a:1}),colorB:d(d({},jk.fromHex(6710886)),{},{a:1}),colorC:d(d({},jk.fromHex(16777215)),{},{a:1}),colorD:d(d({},jk.fromHex(16777215)),{},{a:1}),distortion:[1,1],fA:[1.7,9.2],fB:[8.3,2.8],voronoiStyle:0,highCut:1,lowCut:0,smoothness:.3,seed:0,quality:1});case"fresnel":return d(d({},t),{},{type:"fresnel",color:Uk.fromHexAndA(16777215,1),bias:.1,scale:1,intensity:2,factor:1});case"rainbow":return d(d({},t),{},{type:"rainbow",filmThickness:30,movement:0,wavelengths:[0,0,0],noiseStrength:0,noiseScale:1,offset:[0,0,0]});case"toon":return d(d({},t),{},{type:"toon",positioning:2,colors:[[0,0,0,1],[.5,.5,.5,1],[.5,.5,.5,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1]],steps:[0,.475,.525,1,1,1,1,1,1,1],num:4,source:[0,1e3,0],isWorldSpace:!0,noiseStrength:0,noiseScale:1,shadowColor:Uk.fromHexAndA(0,0),offset:[0,0,0]});case"outline":return d(d({},t),{},{type:"outline",outlineColor:Uk.fromHexAndA(0,1),contourColor:Uk.fromHexAndA(0,1),outlineWidth:2,contourWidth:5,outlineThreshold:.4,contourThreshold:0,outlineSmoothing:0,contourFrequency:10,contourDirection:[0,1,0],positionalLines:!1,compensation:!0});case"matcap":return d(d({},t),{},{type:"matcap",texture:{image:"matcap_0",wrapping:1001,repeat:[1,1],offset:[0,0],rotation:0,minFilter:1008,magFilter:1006}});case"transmission":return d(d({},t),{},{type:"transmission",thickness:10,ior:1.5,roughness:1});case"displace":return{visible:!0,type:"displace",displacementType:"noise",noiseType:0,scale:10,movement:1,offset:[0,0,0],intensity:8,voronoiStyle:0,smoothness:.3,seed:0,highCut:1,lowCut:0,quality:1};case"pattern":return d(d({},t),{},{type:"pattern",style:0,projection:0,axis:"y",blending:0,offset:[0,0],colorA:d(d({},jk.fromHex(0)),{},{a:1}),colorB:d(d({},jk.fromHex(16777215)),{},{a:1}),frequency:[10,10],size:.5,variation:0,smoothness:.5,zigzag:0,rotation:0,vertical:[0,1],horizontal:[0,1],sides:6})}}(e)}})(vB||(vB={})),(e=>{function t(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"layer1",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"layer2",i=new sO;return i.push({fi:0,data:vB.defaultData("light",e),id:t}),i.push({fi:1,data:vB.defaultData("color"),id:n}),{layers:i}}e.isMergable=function(e){return!e.layers.some((e=>"texture"===e.data.type&&0!==e.data.projection||"depth"===e.data.type&&!e.data.isWorldSpace||"noise"===e.data.type||"displace"===e.data.type))},e.getHash=function(e){let t="";return e.layers.forEach((e=>{Object.entries(e.data).forEach((e=>{let[n,i]=e;t+="".concat(n).concat(i),Array.isArray(i)?i.forEach((e=>t+="".concat(e))):"object"==typeof i?Object.values(i).forEach((e=>{t+="".concat("number"==typeof e?e.toFixed(4):e)})):t+="".concat(i)}))})),t},e.defaultEmptyData=function(){return{layers:new sO}},e.defaultData=function(){return t("phong",arguments.length>0&&void 0!==arguments[0]?arguments[0]:"layer1",arguments.length>1&&void 0!==arguments[1]?arguments[1]:"layer2")},e.withName=function(e,t){return d(d({},e),{},{name:t})},e.defaultTwoLayerData=t,e.defaultUIObjectMaterial=function(e){let t=vB.defaultData("texture");e&&Object.assign(t.texture,{image:e});let n=new sO;return n.push({fi:0,data:t,id:"layer1"}),n.push({fi:1,data:d(d({},vB.defaultData("transmission")),{},{alpha:1}),id:"layer2"}),n.push({fi:2,data:d(d({},vB.defaultData("light","lambert")),{},{alpha:0}),id:"layer3"}),{layers:n}},e.defaultTwoLayerTextureData=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"phong",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"layer1",i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"layer2",r=vB.defaultData("texture");Object.assign(r.texture,{image:e});let s=new sO;return s.push({fi:0,data:r,id:n}),s.push({fi:1,data:vB.defaultData("light",t),id:i}),{layers:s}},e.defaultTwoLayerVideoTextureData=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"phong",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"layer1",i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"layer2",r=vB.defaultData("video");Object.assign(r.texture,{video:e});let s=new sO;return s.push({fi:0,data:r,id:n}),s.push({fi:1,data:vB.defaultData("light",t),id:i}),{layers:s}}})(yB||(yB={})),(e=>{e.defaultData=function(){return{points:new sO,roundness:0,shapeHoles:[],isClosed:!1}}})(xB||(xB={})),(e=>{e.defaultData=function(){return{points:new sO,lastInsertionPlane:null,subdivisions:12,isClosed:!1}}})(bB||(bB={}));var _B,SB={type:"Ellipse",width:50,height:50,spikes:16,angle:360,innerRadius:0};(e=>{e.merge=function(e,t){let n=d({},e);return TB.forEach((i=>{var r;Object.assign(n,{[i]:null!==(r=t[i])&&void 0!==r?r:e[i]})})),n}})(_B||(_B={}));var EB,CB,AB,MB={shape:SB,depth:1,offset:0,bevel:50,bevelSides:6,angle:0,twist:0,startScale:1,endScale:1,capType:"flat"},TB=["depth","offset","angle","twist","startScale","endScale"];(e=>{e.is2DParametricMesh=function(e){return"PolygonGeometry"===e||"RectangleGeometry"===e||"StarGeometry"===e||"TriangleGeometry"===e||"EllipseGeometry"===e||"UIGeometry"===e},e.isParametricMesh=function(e){return"PolygonGeometry"===e||"PolygonGeometry"===e||"RectangleGeometry"===e||"StarGeometry"===e||"TriangleGeometry"===e||"EllipseGeometry"===e||"PathGeometry"===e||"VectorGeometry"===e||"ConeGeometry"===e||"CubeGeometry"===e||"CylinderGeometry"===e||"DodecahedronGeometry"===e||"HelixGeometry"===e||"IcosahedronGeometry"===e||"LatheGeometry"===e||"PyramidGeometry"===e||"SphereGeometry"===e||"PlaneGeometry"===e||"BackdropGeometry"===e||"TorusGeometry"===e||"TorusKnotGeometry"===e||"BooleanGeometry"===e||"TextGeometry"===e||"InputGeometry"===e}})(EB||(EB={})),(e=>{e.merge=function(e,t){let n=d({},e);return Object.assign(n,t),"PathGeometry"===n.type&&"extrusion"in t&&t.extrusion&&(n.extrusion=d({},e.extrusion),Object.assign(n.extrusion,_B.merge(n.extrusion,t.extrusion))),n}})(CB||(CB={})),(e=>{e.defaultData=function(t){if("RectangleGeometry"===t)return{width:320,height:320,type:t,cornerRadius:[0,0,0,0],cornerType:0,depth:0,extrudeBevelSize:0,extrudeBevelSegments:1};if("UIGeometry"===t)return{type:t,frame:"",cornerRadius:[0,0,0,0],cornerType:0,width:1,height:1};if("PathGeometry"===t)return{type:t,width:1,height:1,depth:1,path:bB.defaultData(),extrusion:MB};if("VectorGeometry"===t)return{width:1,height:1,type:t,subdivisions:12,shape:xB.defaultData(),depth:0,extrudeBevelSize:0,extrudeBevelSegments:1};if("BooleanGeometry"===t)return{type:t,operation:2,width:0,height:0,depth:0,phongAngle:35};if("ShapeBlendGeometry"===t)return{type:t,width:0,height:0,depth:0,resolutionLevel:6,blendRange:100,useChildrenColors:!1};if("TextGeometry"===t)return{type:t,width:100,height:100,depth:0,horizontalAlign:1,verticalAlign:1,fontSize:16,lineHeight:1.2,letterSpacing:0,text:{textValue:""},textTransform:1,font:"Roboto_regular",editable:!1,extrudeBevelSize:0,extrudeBevelSegments:1};if("InputGeometry"===t)return d(d({},e.defaultData("TextGeometry")),{},{type:t,editable:!0});if("SphereGeometry"===t)return{type:"SphereGeometry",width:100,height:100,depth:100,widthSegments:64,heightSegments:64,phiStart:0,phiLength:2*Math.PI,thetaStart:0,thetaLength:180};throw new Error("not implemented")}})(AB||(AB={}));var PB,FB,OB,IB,kB,BB,RB,LB,zB,NB,jB,UB,VB,HB,WB,GB,qB,YB,XB,QB,KB,ZB,JB,$B,eR,tR,nR,iR,rR,sR,aR,oR,lR,uR,cR,hR,dR,pR,fR,mR,gR,vR,yR=["width","height","depth"];function xR(e){e.layers.forEach((e=>{if("depth"===e.type&&void 0!==e.colorA){let t=e.colorA,n=e.colorB,i=[[t.r,t.g,t.b,t.a],[n.r,n.g,n.b,n.a]],r=[0,1];for(let e=2;e<10;e++)i.push(i[1]),r.push(1);let s=d(d({},vF(LO(e),"type","visible","isVector","isWorldSpace","origin","alpha","mode")),{},{near:Math.max(0,e.near),far:Math.max(0,e.far),colors:i,steps:r,num:2,direction:[1,0,0],smooth:!1,gradientType:1});Object.assign(e,s)}else if("depth"===e.type&&1===e.gradientType&&(e.near<0||e.far<0)){let t=d(d({},LO(e)),{},{near:Math.max(e.near,0),far:Math.max(e.far,0)});Object.assign(e,t)}}))}function bR(e,t){Object.values(e.shared.materials).forEach((e=>t(e)))}function wR(e,t){e.scene.objects.traverse(((e,n)=>{"materials"in n?n.materials.forEach(((e,i)=>{void 0===e&&(n.materials[i]=yB.defaultData(),e=n.materials[i]),"string"!=typeof e&&t(e)})):"material"in n?"string"!=typeof n.material&&(void 0===n.material&&(n.material=yB.defaultData()),t(n.material)):"Mesh"===n.type&&(void 0===n.material&&(n.material=yB.defaultData()),t(n.material)),"overrides"in n&&Object.values(n.overrides).forEach((e=>{e.material&&"string"!=typeof e.material&&Object.getPrototypeOf(e.material)!==hO.prototype&&t(e.material)}))}))}function DR(e){void 0===e.layers&&Object.assign(e,yB.defaultTwoLayerData("lambert"))}function _R(e){!e.layers||e.layers.forEach((e=>{if("depth"===e.type&&10===e.colors.length){let t=[...e.colors];t.push(e.colors[9]);let n=[...e.steps];n.push(e.steps[9]);let i=d(d({},LO(e)),{},{colors:t,steps:n});Object.assign(e,i)}}))}function SR(e){e.scene.objects.traverse(((e,t)=>{"materials"in t?t.materials.forEach((e=>{"string"!=typeof e&&_R(e)})):"material"in t&&"string"!=typeof t.material&&_R(t.material)})),Object.values(e.shared.materials).forEach((e=>_R(e)))}function ER(e){e.layers&&e.layers.forEach((e=>{"depth"===e.type&&void 0!==e.num&&(e.colors=e.colors.slice(0,e.num),e.steps=e.steps.slice(0,e.num),delete e.num)}))}function CR(e){e.layers&&e.layers.forEach((e=>{(function(e){return"displace"!==e.type})(e)&&void 0===e.isMask&&(e.isMask=!1),("texture"===e.type||"video"===e.type)&&void 0===e.blending&&(e.blending=0),("noise"===e.type||"displace"===e.type&&"noise"===e.displacementType)&&(void 0===e.voronoiStyle&&(e.voronoiStyle=0),void 0===e.highCut&&(e.highCut=1),void 0===e.lowCut&&(e.lowCut=0),void 0===e.smoothness&&(e.smoothness=.3),void 0===e.seed&&(e.seed=0),void 0===e.quality&&(e.quality=1))}))}function AR(e){var t;let n=null===(t=e.layers.find((e=>"light"===e.type)))||void 0===t?void 0:t.data;if("basic"===(null===n||void 0===n?void 0:n.category)){let e=vB.defaultData("light","phong"),t=n;Object.assign(t,e),t.visible=!1}}function MR(e){bR(e,AR),wR(e,AR)}function TR(e){e.layers.forEach((e=>{"light"===e.type&&"toon"!==e.category&&void 0===e.occlusion&&(e.occlusion=!0)}))}function PR(e){e.layers&&e.layers.forEach((e=>{"light"===e.type&&void 0===e.bumpMapIntensity&&(e.bumpMapIntensity=5)}))}function FR(e,t){if(t<1&&(wR(e,xR),bR(e,xR),e.schema=1),t<2&&(function(e){Object.assign(e.scene.publish,{orbitControls:d(d({},eR.defaultData),LO(e.scene.publish.orbitControls))})}(e),e.schema=2),t<3&&(function(e){function t(e){if(e.layers)for(let t of Object.values(e.layers))if(t)for(let[e,n]of Object.entries(t))if((wB.includes(e)||"boolean"==typeof n)&&delete t[e],"texture"===e)for(let[t,i]of Object.entries(n))(DB.includes(t)||"boolean"==typeof i)&&delete n[t]}e.scene.objects.traverse(((e,n)=>{n.states.forEach((e=>{let n=e;n.material?t(n.material):n.materials&&n.materials.forEach((e=>{t(e)}))}))}))}(e),e.schema=3),t<4&&(function(e){e.scene.publish.withBackground=!0}(e),e.schema=4),t<5&&(function(e){e.scene.publish.settings.web={compress:!0,preload:!0,preset:1,logo:!0,hint:!1}}(e),e.schema=5),t<6&&(function(e){e.scene.objects.traverse(((e,t)=>{let n=t.cloner;n&&(n.radial.scale=n.radial.scale.map((e=>e+1)),n.linear.scale=n.linear.scale.map((e=>e+1)))}))}(e),e.schema=6),t<7&&(function(e){e.scene.objects.traverse(((e,t)=>{let n=t.geometry;n&&("DodecahedronGeometry"===n.type||"IcosahedronGeometry"===n.type)&&(n.detail=Math.round(n.detail))}))}(e),e.schema=7),t<8&&(e.schema=8),t<9&&(SR(e),e.schema=9),t<10&&(function(e){e.scene.objects.traverse(((e,t)=>{"Mesh"===t.type&&("BooleanGeometry"===t.geometry.type||"SubdivGeometry"===t.geometry.type)&&(t.geometry.phongAngle=35)}))}(e),e.schema=10),t<11&&(function(e){e.scene.environment.ambientLight.softShadows=!1,e.scene.environment.ambientLight.softShadowQuality="low",e.scene.objects.traverse(((e,t)=>{("DirectionalLight"===t.type||"SpotLight"===t.type)&&(t.shadowResolution=1024,t.shadowRadius=1,t.depth=1e5)})),e.shared.penumbraSize=new Array(5).fill(.5)}(e),e.schema=11),t<12&&(SR(e),e.schema=12),t<13&&(function(e){e.shared.audios=bF({},QF.prototype)}(e),e.schema=13),t<14&&(function(e){let t=e.shared.materials;Object.entries(t).forEach((e=>{let[n,i]=e;if(!i.layers){let e={name:"Untitled Material",layers:[{fi:0,data:{type:"light",category:"phong",alpha:.6,visible:!0,mode:0,specular:{r:.2,g:.2,b:.2},shininess:5},id:"layer1"},{fi:1,data:{type:"color",alpha:1,visible:!0,mode:0,color:{r:.2823529411764706,g:.2823529411764706,b:.30196078431372547}},id:"layer2"}]};Object.assign(t,{[n]:e})}}))}(e),e.schema=14),t<15&&(function(e){Object.entries(LO(e.shared.images)).filter((e=>!1===e[1].asset)).map((e=>e[0])).forEach((t=>{delete e.shared.images[t]})),Object.entries(LO(e.shared.audios)).filter((e=>!1===e[1].asset)).map((e=>e[0])).forEach((t=>{delete e.shared.audios[t]}))}(e),e.schema=15),t<16&&(function(e){e.scene.publish.settings.web.preload=!1}(e),e.schema=16),t<17&&(wR(e,ER),bR(e,ER),e.schema=17),t<18&&(wR(e,DR),bR(e,DR),e.schema=18),t<19&&(function(e){Object.assign(e.scene.publish.settings,{video:d(d({},tR.defaultData.settings.video),LO(e.scene.publish.settings.video))})}(e),e.schema=19),t<20&&(function(e){e.shared.fonts=bF({},QF.prototype)}(e),function(e){let t=[];e.scene.objects.traverse(((n,i)=>{let r=i;if("TextFrame"===r.type){let i=yB.defaultTwoLayerData("phong"),s="string"==typeof r.color?e.shared.colors[r.color]:r.color;i.layers[1].data.color={r:s.r,g:s.g,b:s.b},i.layers[1].data.alpha=r.alpha;let a=function(e){return e.replace(".typeface","").replace(/optimer/gi,"open sans").replace("space_mono","space mono").replace(/alma_mono/gi,"varela round").replace(/droid_sans_mono/gi,"noto sans mono").replace(/droid_sans|gentilis|gnomon_(simple|foreground)|helvetiker/gi,"roboto").replace(/droid_serif/gi,"roboto slab").replace("_sans"," sans").replace("crimson_text","crimson text").replace("medium_medium","medium").replace("fatface_fatface","fatface").replace("100hairline","thin").replace("200thin","extralight").replace("300light","light").replace("500medium","medium").replace("600semi","semibold").replace("800heavy","extrabold").replace("900black","black").replace(/bodoni_(11|16|24|36|48|72|96)([^_])/gi,"bodoni_$1_$2").replace(/bodoni_(11|16|24|36|48|72|96)/gi,"bodoni moda").replace(/(thin|hairline)(_regular)?/gi,"100").replace(/(extra|ultra)light(_regular)?/gi,"200").replace(/light(_regular)?/gi,"300").replace(/_book|_normal|_roman/gi,"_regular").replace(/medium(_regular)?/gi,"500").replace(/(semi|demi)bold(_regular)?/gi,"600").replace(/(extra|ultra)bold(_regular)?/gi,"800").replace(/bold(_regular)?/gi,"700").replace(/(black|heavy|fatface)(_regular)?/gi,"900").replace(/([1-9]00)_italic/gi,"$1italic").replace(/regularitalic/gi,"italic").replace(/regularitalic/gi,"italic").split(" ").map((e=>e.charAt(0).toUpperCase()+e.slice(1))).join(" ")}(r.font);void 0===e.shared.fonts[a]&&(e.shared.fonts[a]={name:a});let o=d(d(d({name:r.name},UB.defaultData),qB.defaultData),{},{flatShading:!1,wireframe:!1,geometry:d(d({},AB.defaultData("TextGeometry")),{},{width:r.width,height:r.height,font:a,depth:0,horizontalAlign:r.horizontalAlign,verticalAlign:r.verticalAlign,fontSize:1.40625*r.fontSize,lineHeight:r.lineHeight/1.40625,letterSpacing:r.letterSpacing-1,text:r.text,textTransform:r.textTransform,extrudeBevelSize:0,extrudeBevelSegments:1}),material:i,states:LO(r.states),events:LO(r.events),visible:r.visible,raycastLock:r.raycastLock,position:r.position,rotation:r.rotation,scale:r.scale,hiddenMatrix:r.hiddenMatrix}),l=LO(e.scene.objects).parent(n);e.scene.objects.insertAfter(null!==l&&void 0!==l?l:null,n,[{id:n+"new",data:o,children:[]}]),t.push(n)}})),t.forEach((t=>{e.scene.objects.delete(t)}))}(e),e.schema=20),t<21&&(function(e){let t={0:"MouseDown",1:"MouseUp",2:"MouseHover",5:"KeyDown",6:"KeyUp",7:"Start",9:"LookAt",10:"Follow",11:"Scroll",12:"Audio",13:"GameControl"};e.scene.objects.traverse(((e,n)=>{n.events.forEach((e=>{if(t[Number(e.type)])if(Object.assign(e,{type:t[Number(e.type)]}),"Audio"===e.type&&"audioEvent"in e&&(Object.assign(e,{playAudio:e.audioEvent}),delete e.audioEvent),"GameControl"===e.type)Object.assign(e,{gameActions:{idle:new sO,move:new sO,jump:new sO}});else{let t=new sO;Object.assign(e,{actions:t}),("MouseDown"===e.type||"MouseUp"===e.type||"KeyDown"===e.type||"KeyUp"===e.type)&&"url"in e&&t.push({fi:0,id:ov.generateUUID(),data:{type:"Link",url:e.url,delay:0}}),"targets"in e&&(e.targets.forEach(((e,n,i)=>{let r={easing:e.easing,duration:e.duration};6===e.easing?Object.assign(r,vF(e,"mass","stiffness","damping","velocity")):5===e.easing&&Object.assign(r,{control1:d({},e.control1),control2:d({},e.control2)});let s={repeat:e.repeat?-1:0,delay:e.delay,delayDirection:e.delayDirection,direction:e.cycle&&e.rewind?"pingpong-rewind":e.cycle?"pingpong":"normal"},a=d(d({state:e.state},s),r),o={allowSlerp:!0,type:"Transition",object:e.object,repeat:0,delay:0,delayDirection:void 0,direction:"normal",tweens:new sO({fi:0,id:ov.generateUUID(),data:{state:void 0,repeat:0,delay:0,delayDirection:void 0,direction:"normal",duration:0,easing:4}},{fi:1,id:ov.generateUUID(),data:a})};t.push({fi:i,id:n,data:o})})),delete e.targets)}}))}))}(e),function(e){e.scene.objects.traverse(((e,t)=>{function n(e,n){let i=new sO,r=[];if(t.events.forEach(((e,t,s)=>{if("Audio"===e.type&&e.trigger===n){let n;r.push(t),"play"===e.interaction?n=d(d({},vF(e,"interaction","audio","delay","volume","loop")),{},{triggerAfter:"after"in e?e.after:void 0,toggle:"after"in e?e.toggle:void 0,type:"Audio"}):("pause"===e.interaction||"stop"===e.interaction)&&(n=d(d({},vF(e,"interaction","delay","object","playAudio")),{},{type:"Audio"})),n&&i.push({fi:s,id:t,data:n})}})),r.forEach((e=>t.events.delete(e))),i.length){var s;let n=null===(s=t.events.find((t=>t.type===e)))||void 0===s?void 0:s.data;n?"actions"in n&&n.actions.insertBefore(null,i):t.events.insertBefore(null,[{id:ov.generateUUID(),data:{type:e,actions:i}}])}}n("Start","start"),n("MouseDown","mouseDown"),n("MouseUp","mouseUp"),n("KeyDown","keyDown"),n("KeyUp","keyUp")}))}(e),e.schema=21),t<22&&(MR(e),e.schema=22),t<23&&(function(e){e.scene.objects.traverse(((e,t)=>{"Mesh"===t.type&&"SubdivGeometry"===t.geometry.type&&(t.geometry.scaleBaked||(t.geometry.scaleBaked=[1,1,1]))}))}(e),e.schema=23),t<24&&(function(e){e.scene.objects.traverse(((e,t)=>{("Empty"===t.type||"Mesh"===t.type)&&t.cloner&&!t.cloner.randomnessObject&&!t.cloner.toObject&&!t.cloner.randomness&&(t.cloner=d(d({},t.cloner),{},{toObject:{object:"",spreadType:"random",scale:[0,0,0],rotation:[0,0,0],position:[0,0,0],axis:"x",seed:0,count:99,align:"normal"},randomness:!1,randomnessObject:{strength:100,scale:[0,0,0],rotation:[0,0,0],position:[0,0,0],movement:1,seed:0,freqScale:10,noiseType:"perlin"}}))}))}(e),e.schema=24),(t<25||void 0===e.shared.videos)&&(function(e){e.shared.videos=bF({},QF.prototype)}(e),t<25&&(e.schema=25)),t<26&&(function(e){e.scene.objects.traverse(((t,n)=>{let i=e.scene.objects.unproxy().parent(t);if(i){let t=LO(e.scene.objects.data(i));t&&"Mesh"===t.type&&"BooleanGeometry"===t.geometry.type&&"Mesh"===n.type&&(n.visible=!0!==LO(n).booleanExclude)}}))}(e),e.schema=26),t<27&&(function(e){e.scene.objects.traverse(((e,t)=>{if("Mesh"===t.type){let e=t;"NonParametricGeometry"===t.geometry.type?void 0!==e.material&&delete e.material:void 0!==e.materials&&delete e.materials}}))}(e),e.schema=27),t<28&&(MR(e),e.schema=28),t<29&&(function(e){function t(e){Object.setPrototypeOf(e,hO.prototype),e.texture&&Object.setPrototypeOf(e.texture,hO.prototype)}function n(e){Object.setPrototypeOf(e,hO.prototype);for(let n in e)t(e[n])}e.scene.objects.traverse(((e,t)=>{t.states.forEach((e=>{let t=e;if(t.material){let e=LO(t.material).layers;n(e),t.material.layers=e}if(t.materials)for(let i=0;i<t.materials.length;i++){let e=t.materials[i],r=LO(e).layers;n(r),e.layers=r}}))}))}(e),e.schema=29),t<30&&(function(e){e.scene.objects.traverse(((e,t)=>{"Mesh"===t.type&&"NonParametricGeometry"===t.geometry.type&&!("material"in t)&&!("materials"in t)&&(t.material=yB.defaultTwoLayerData("phong"))}))}(e),e.schema=30),t<31&&(function(e){void 0===e.scene.publish.orbitControls.autoZoom&&(e.scene.publish.orbitControls.autoZoom=!1),e.scene.objects.traverse(((e,t)=>{("OrthographicCamera"===t.type||"PerspectiveCamera"===t.type)&&(void 0===t.orthographic.autoZoom&&(t.orthographic.autoZoom=!1),void 0===t.orthographic.autoZoomFrustumSize&&(t.orthographic.autoZoomFrustumSize=790))}))}(e),e.schema=31),t<33&&(function(e){e.scene.objects.traverse(((e,t)=>{void 0===t.pathSnapping&&(t.pathSnapping={pathId:null,slide:0,offset:0,orientation:"tangential"}),void 0===t.pathSnapping.offset&&(t.pathSnapping.offset=0)}))}(e),e.schema=33),t<34&&(function(e){void 0===e.scene.publish.mouseEventTarget&&(e.scene.publish.mouseEventTarget="canvas"),void 0===e.scene.publish.settings.web.hint&&(e.scene.publish.settings.web.hint=!1)}(e),e.schema=34),t<35&&(function(e){let{video:t}=e.scene.publish.settings;"gif"===t.format&&t.fps>48&&(t.fps=15)}(e),e.schema=35),t<36&&(function(e){e.scene.objects.traverse(((e,t)=>{t.events.forEach((e=>{"GameControl"===e.type&&(e.resetYPosition=Math.abs(e.resetYPosition-t.position[1]))}))}))}(e),e.schema=36),t<37&&(function(e){let t=e.scene.environment.usePhysics;e.scene.objects.traverse(((e,n)=>{t&&null===n.physics?n.collision=!1:n.collision="visibility"}))}(e),e.schema=37),t<38&&(wR(e,CR),bR(e,CR),e.schema=38),t<39&&(function(e){e.scene.objects.traverse(((e,t)=>{t.events.forEach((e=>{"GameControl"===e.type&&(e.navmesh=vR.defaultDataThirdPerson.navmesh)}))}))}(e),e.schema=39),t<40&&(function(e){e.scene.styles||(e.scene.styles=rR.defaultData())}(e),e.schema=40),t<41&&(function(e){void 0===e.scene.environment.ambientLight.occlusion&&(e.scene.environment.ambientLight.occlusion=!1),void 0===e.scene.environment.ambientLight.aoFullRes&&(e.scene.environment.ambientLight.aoFullRes=!1),void 0===e.scene.environment.ambientLight.radius&&(e.scene.environment.ambientLight.radius=256),void 0===e.scene.environment.ambientLight.bias&&(e.scene.environment.ambientLight.bias=.5),void 0===e.scene.environment.ambientLight.aoColor&&(e.scene.environment.ambientLight.aoColor={r:.19607843137254902,g:.19607843137254902,b:.19607843137254902}),wR(e,TR),bR(e,TR)}(e),e.schema=41),t<42&&(function(e){e.scene.objects.traverse(((e,t)=>{t.events.forEach((e=>{"GameControl"===e.type&&Object.assign(e.gameActions,{run:new sO})}))}))}(e),e.schema=42),t<43&&(function(e){e.scene.objects.traverse(((e,t)=>{t.events.forEach((e=>{"GameControl"===e.type&&(e.keyAssignments=[...e.keyAssignments,["run","\u21e7"],["none","Ctrl"]])}))}))}(e),e.schema=43),t<99){var n;wR(e,PR),bR(e,PR),null===e.scene.publish.playCamera&&(e.scene.publish.playCamera=Kk);let t=LO(e.scene.objects),i=e.scene.objects;e.scene.publish.playPage=Zk,i.insertBefore(null,null,[{id:Zk,data:d(d({},ZB.defaultData),{},{backgroundColor:e.scene.backgroundColor,fog:e.scene.fog,postprocessing:e.scene.postprocessing,ao:vF(e.scene.environment.ambientLight,"occlusion","aoFullRes","radius","bias","aoColor"),publish:{playCamera:e.scene.publish.playCamera,gameControlObject:e.scene.publish.gameControlObject},shadow:vF(e.scene.environment.ambientLight,"softShadowQuality"),globalPhysics:d(d({},BB.defaultData),vF(e.scene.environment,"usePhysics","gravity")),camera:null!==(n=LO(e.scene.ownerCamera))&&void 0!==n?n:ZB.defaultData.camera,name:"Scene"}),children:[]}]);for(let e of t)e.id!==aR.TRASH_CAN_ID&&i.move(Zk,e.fi,e.id);let r=0,s=0;e.shared.penumbraSize&&e.scene.objects.traverse(((t,n)=>{var i;"DirectionalLight"===n.type?(n.penumbraSize=e.shared.penumbraSize[Math.min(r,2)],r+=1):"SpotLight"===n.type&&(n.penumbraSize=e.shared.penumbraSize[3+Math.min(s,1)],s+=1),(void 0===n.physics||null===n.physics)&&"Instance"!==n.type&&(n.physics={},Object.assign(n.physics,iB.defaultData)),void 0!==n.physics&&null!==n.physics&&(n.physics.enabled=null!==(i=n.collision)&&void 0!==i?i:"visibility",delete n.collision)})),e.schema=99}}function OR(e){e.layers&&e.layers.forEach((e=>{"light"===e.type&&void 0===e.alphaOverride&&(e.alphaOverride=1)}))}(e=>{e.defaultData={enabled:!1,useBackgroundColor:!1,color:jk.white,near:.1,far:2e3}})(PB||(PB={})),(e=>{let t={opacity:1,blendFunction:13,enabled:!1};e.defaultData={enabled:!1,pixelation:d(d({},t),{},{blendFunction:16,granularity:15}),bloom:d(d({},t),{},{blendFunction:16,intensity:1,blurScale:1,luminanceThreshold:.25,luminanceSmoothing:.025,kernelSize:3}),chromaticAberration:d(d({},t),{},{offset:[2,2]}),vignette:d(d({},t),{},{darkness:1,offset:0}),hueSaturation:d(d({},t),{},{hue:3,saturation:0}),brightnessContrast:d(d({},t),{},{brightness:.25,contrast:0}),depthOfField:d(d({},t),{},{focusDistance:100,focalLength:20,bokehScale:5}),noise:d(d({},t),{},{blendFunction:16})}})(FB||(FB={})),(e=>{e.defaultData={softShadowQuality:"low"}})(OB||(OB={})),(e=>{e.defaultData={enabled:!0,color:{r:.8274509803921568,g:.8274509803921568,b:.8274509803921568},intensity:.75}})(IB||(IB={})),(e=>{e.defaultData={occlusion:!1,aoFullRes:!1,radius:256,bias:.5,aoColor:{r:.19607843137254902,g:.19607843137254902,b:.19607843137254902}}})(kB||(kB={})),(e=>{e.defaultData={usePhysics:!1,gravity:-10}})(BB||(BB={})),(e=>{e.defaultData={playCamera:Kk,gameControlObject:null}})(RB||(RB={})),(e=>{e.defaultData={backgroundColor:Uk.fromHexAndA(2960946,1),postprocessing:FB.defaultData,fog:PB.defaultData,globalPhysics:BB.defaultData,ambient:IB.defaultData,ao:kB.defaultData,shadow:OB.defaultData,publish:RB.defaultData}})(LB||(LB={})),(e=>{e.defaultData={colliderType:"box",size:[100,100,100],colliderHelperVisible:!0,forceType:"collider",forceRange:"global",forceIntensity:.5,forceDambing:.95}})(zB||(zB={})),(e=>{e.isComponentRelated=function(e){return"Component"===e||"Instance"===e},e.isEmptyOrComponent=function(e){return"Empty"===e||"Instance"===e}})(NB||(NB={})),(e=>{e.identity=d(d({},Vk.identity),{},{hiddenMatrix:Nk.identity}),e.fromObject=function(e){return{position:e.position,rotation:e.rotation,scale:e.scale,hiddenMatrix:e.hiddenMatrix}},e.merge=function(e,t){return{position:(null===t||void 0===t?void 0:t.position)||e.position,rotation:(null===t||void 0===t?void 0:t.rotation)||e.rotation,scale:(null===t||void 0===t?void 0:t.scale)||e.scale,hiddenMatrix:(null===t||void 0===t?void 0:t.hiddenMatrix)||e.hiddenMatrix}},e.diff=function(e,t){return xF({position:Rk.isEqual(e.position,t.position)?void 0:t.position,rotation:Rk.isEqual(e.rotation,t.rotation)?void 0:t.rotation,scale:Rk.isEqual(e.scale,t.scale)?null:t.scale,hiddenMatrix:Nk.isEqual(e.hiddenMatrix,t.hiddenMatrix)?void 0:t.hiddenMatrix})}})(jB||(jB={})),(e=>{e.defaultData=d(d({states:new sO,events:new sO,visible:!0,raycastLock:!1,physics:iB.defaultData,pathSnapping:{pathId:null,slide:0,offset:0,orientation:"tangential"}},jB.identity),{},{cloner:null})})(UB||(UB={})),(e=>{e.defaultData=d({type:"Empty"},UB.defaultData)})(VB||(VB={})),(e=>{e.defaultData=d(d({type:"ParticleCollider"},zB.defaultData),UB.defaultData)})(HB||(HB={})),(e=>{e.defaultData=d({type:"Component"},UB.defaultData)})(WB||(WB={})),(e=>{e.defaultData=d(d({type:"Particle"},UB.defaultData),nB.defaultData)})(GB||(GB={})),(e=>{e.defaultData=d(d({type:"Mesh"},UB.defaultData),aB.defaultData)})(qB||(qB={})),(e=>{e.defaultData=d(d(d({},UB.defaultData),jB.identity),{},{position:[0,0,Yk.DefaultTargetOffset]},Yk.defaultData)})(YB||(YB={})),(e=>{e.defaultData=function(e){return d(d({},UB.defaultData),tB.defaultData(e))},e.defaultDirectionalLightData=d(d({},e.defaultData("DirectionalLight")),{},{position:[200,300,300],name:"Directional Light",intensity:.7})})(XB||(XB={})),(e=>{function t(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;for(;n<t.length;){let i=e?e[t[n]]:void 0;if(t.length===n+1)return i;if(!i)return;e=i.descendants,n+=1}}e.resolveWithDes=t,e.resolve=function(e,n){let i=t(e,n,arguments.length>2&&void 0!==arguments[2]?arguments[2]:0);if(i){let e=Object.keys(i);if(1===e.length&&"descendants"===e[0])return}return i}})(QB||(QB={})),(e=>{function t(e,t){return d(d(d({},UB.defaultData),t),{},{component:e,overrides:new hO,physics:void 0,events:void 0,type:"Instance"})}e.rootOverrideProps=["physics","events"],e.compositeNonOptionalOverrideProps=["geometry"],e.compositeEntireOverrideOverrideProps=["material"],e.ofComponent=t,e.fromComponentData=function(e){let n=jB.fromObject(e.data);return t(e.id,n)}})(KB||(KB={})),(e=>{e.defaultData=d(d(d({type:"Page"},UB.defaultData),{},{physics:d(d({},iB.defaultData),{},{fusedBody:!1})},LB.defaultData),{},{camera:YB.defaultData}),e.isUIPage=function(e){return void 0!==e.uiScene}})(ZB||(ZB={})),(e=>{e.defaultCamera=d({position:[0,0,1e3],scale:[1,1,1],rotation:[0,0,0],hiddenMatrix:Nk.identity,name:"Play Camera",visible:!0,raycastLock:!1,physics:iB.defaultData,states:new sO,events:new sO,cloner:null,pathSnapping:{pathId:null,orientation:"tangential",slide:0,offset:0}},Yk.defaultData),e.KeysByResetCategory={States:["states"],Events:["events"],Material:["material","materials"],Geometry:["geometry"],Position:["position"],Rotation:["rotation"],Scale:["scale"],Transform:["position","scale","rotation","hiddenMatrix"],Name:["name"],Visibility:["visible","raycastLock","flatShading","wireframe","side"],Shadows:["castShadow","receiveShadow"],Cloner:["cloner"],Physics:["physics"]},e.defaultMeshObject=d(d(d({name:"Rectangle"},UB.defaultData),qB.defaultData),{},{geometry:AB.defaultData("RectangleGeometry"),material:yB.defaultTwoLayerData("phong","layer1","layer2")}),e.defaultBooleanObject=d(d(d({name:"Boolean"},UB.defaultData),qB.defaultData),{},{geometry:AB.defaultData("BooleanGeometry"),material:yB.defaultTwoLayerData("phong","layer1","layer2")}),e.defaultShapeBlendObject=d(d(d({name:"Shape Blend"},UB.defaultData),qB.defaultData),{},{geometry:AB.defaultData("ShapeBlendGeometry"),material:yB.defaultTwoLayerData("phong","layer1","layer2")}),e.defaultTextObject=d(d(d({name:"Text"},UB.defaultData),qB.defaultData),{},{geometry:AB.defaultData("TextGeometry"),material:yB.defaultTwoLayerData("phong","layer1","layer2")}),e.defaultInputObject=d(d(d({name:"Input"},UB.defaultData),qB.defaultData),{},{geometry:AB.defaultData("InputGeometry"),material:yB.defaultTwoLayerData("phong","layer1","layer2")})})(JB||(JB={})),(e=>{e.newEmpty=function(e,t){let n={name:t};return"Mesh"===e.type?(n.geometry={},"material"in e&&(n.material={layers:new hO}),"materials"in e&&(n.materials=e.materials.map((e=>({layers:new hO}))))):qk.is(e.type)&&(n.perspective={},n.orthographic={}),n},e.toOps=function(e,t){let n,i=[],r={orthographic:0,perspective:0,geometry:0};function s(e,t){for(let[n,r]of Object.entries(t.layers)){let{texture:t}=r,s=o(r,fm);if(void 0!==t&&Object.keys(t).length>0){let r={path:[...e,"layers",n,"texture"],props:t,type:0};i.push(r)}if(Object.keys(s).length>0){let t={path:[...e,"layers",n],props:s,type:0};i.push(t)}}}for(let[a,o]of Object.entries(t))if("name"!==a)if("cloner"===a)i.push(...Qk.toOps(o,["cloner"]));else if("pathSnapping"===a)i.push({path:[a],props:{slide:o.slide,offset:o.offset},type:0});else if("material"===a)s(["material"],o);else if("materials"===a)for(let[e,t]of Object.entries(o))s(["materials",e],t);else if(0===r[a]){if("geometry"===a&&void 0!==o.extrusion){let e={path:[a,"extrusion"],props:o.extrusion,type:0};i.push(e),o=d({},o),delete o.extrusion}if(Object.keys(o).length>0){let e={path:[a],props:o,type:0};i.push(e)}}else void 0===n&&(n={path:[],props:{},type:0},i.push(n)),n.props[a]=o;return i},e.patch=function(e,t){var n,i,r,s,a,o,l,u;if(void 0===t)return e;let c=d({},e);if(Object.assign(c,jB.merge(c,t)),Object.assign(c,{pathSnapping:Object.assign({},c.pathSnapping,{slide:null!==(n=null!==(i=null===(r=t.pathSnapping)||void 0===r?void 0:r.slide)&&void 0!==i?i:null===(s=c.pathSnapping)||void 0===s?void 0:s.slide)&&void 0!==n?n:0,offset:null!==(a=null!==(o=null===(l=t.pathSnapping)||void 0===l?void 0:l.offset)&&void 0!==o?o:null===(u=c.pathSnapping)||void 0===u?void 0:u.offset)&&void 0!==a?a:0})}),qk.is(e.type)){var h,p;c.orthographic=d({},c.orthographic),c.perspective=d({},c.perspective);let e=t;void 0!==(null===(h=e.orthographic)||void 0===h?void 0:h.zoom)&&(c.orthographic.zoom=e.orthographic.zoom),void 0!==(null===(p=e.perspective)||void 0===p?void 0:p.zoom)&&(c.perspective.zoom=e.perspective.zoom),void 0!==e.isUpVectorFlipped&&(c.isUpVectorFlipped=e.isUpVectorFlipped),void 0!==e.targetOffset&&(c.targetOffset=e.targetOffset)}else if("Mesh"===e.type)"geometry"in t&&Object.assign(c,{geometry:CB.merge(c.geometry,t.geometry)}),(t.material||t.materials)&&(c=function(e,t){if(void 0===t)return e;let n=d({},e);return"material"in n&&"material"in t&&t.material&&(n.material=RO(n.material,(e=>{if("string"!=typeof e)for(let[n,i]of Object.entries(t.material.layers)){let t=e.layers.data(n);t&&vB.patch(t,i)}})).data),n.materials&&t.materials&&(n.materials=RO(n.materials,(e=>{for(let r=0;r<n.materials.length;r++){let n=t.materials[r];if("string"!=typeof n)for(let[t,s]of Object.entries(n.layers)){var i;let n=null===(i=e[r])||void 0===i||null===(i=i.layers)||void 0===i?void 0:i.data(t);n&&vB.patch(n,s)}}})).data),n}(c,t)),c.cloner&&"cloner"in t&&Object.assign(c,{cloner:Xk.merge(c.cloner,t.cloner)});else if("Empty"===e.type)c.cloner&&"cloner"in t&&Object.assign(c,{cloner:Xk.merge(c.cloner,t.cloner)});else if(eB.is(e.type)){let e=t;void 0!==e.intensity&&(c.intensity=e.intensity),void 0!==e.color&&("string"==typeof e.color?c.color=e.color:c.color=jk.clone(e.color))}return c}})($B||($B={})),(e=>{e.defaultData={enablePan:!0,enableZoom:!0,enableRotate:!0,enableDamping:!0,rotationLimitsMode:0,rotationVerticalOffset:{min:Math.PI/4,max:Math.PI/4},rotationHorizontalOffset:{min:Math.PI/4,max:Math.PI/4},rotationSoftLimit:2,panLimitsMode:0,panVerticalOffset:{min:250,max:250},panHorizontalOffset:{min:250,max:250},panSoftLimit:2,zoomLimitsEnabled:!1,zoomLimits:{min:.1,max:2},autoRotate:!1,autoRotateSpeed:2,autoRotateClockwise:!0,hoverRotatePanMode:0,hoverRotatePanStrength:20,hoverRotateDamping:.125,isTouchZoom:!0,orbitTouches:2,panTouches:3,resetHoverEffectOnPointerLeave:!0}})(eR||(eR={})),(e=>{e.defaultData={orbitControls:eR.defaultData,playPage:Zk,withBackground:!0,preventScroll:!1,preventTouchScroll:!1,hideCursor:!1,mouseEventTarget:"canvas",joystickSizeAndXYOffset:Array(12).fill(0).map(((e,t)=>{let n=0,i=0;return t<5?i=-30:t<10&&(i=30),0===t||10===t||5===t?n=30:(4===t||11===t||9===t)&&(n=-30),[120,[n,i],"show"]})),settings:{image:{format:"jpg",ratio:1},video:{format:"mp4",imageFormat:"jpg",fps:30,mbps:80,ratio:Math.max(1,typeof window<"u"?Math.floor(window.devicePixelRatio):1),stopMode:"manual",duration:5e3},web:{logo:!0,compress:!0,preset:1,preload:!0,hint:!1,imageQuality:70}},stopRaycast:!0,hdTransmission:!1}})(tR||(tR={})),(e=>{e.defaultData={id:"basic",label:"Basic",style:"None",prompt:""}})(nR||(nR={})),(e=>{e.defaultData={weather:0,shadows:0,lightOrigin:0,temperature:0,sun:0,camera:0,environment:0,particles:0,nature:0,floor:0}})(iR||(iR={})),(e=>{e.defaultData=()=>({mode:"line-art-both",prompt:"",negativePrompt:"",style:d({},nR.defaultData),isRandomSeed:!0,seed:e.generateSeed(),guessMode:!1,advanced:!1,steps:20,guidanceScale:7.5,controlNetScale:1,modifiers:iR.defaultData}),e.generateSeed=()=>Math.round(1e5*Math.random())})(rR||(rR={})),(e=>{e.physicsEnabled=function(e){return void 0!==e.find((e=>"Page"===e.data.type&&e.data.globalPhysics.usePhysics))},e.traverseModuleInstances=function(e,t,n){e.scene.objects.traverseFrom(t,((t,i)=>{if("Instance"===i.type){var r;let s=null===(r=RR.getComponentData(e,i.component))||void 0===r?void 0:r.data;s&&n(t,i,s.events)}else n(t,i,i.events)}))}})(sR||(sR={})),(e=>{function t(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],i=[],r=JB.defaultMeshObject;t&&(i.push(d({},e.defaultLight)),i.push({fi:1,id:"7ba78968-2a55-48f2-b14c-5191da3e075e",data:r,children:[]})),i.push(...n);let s=new rO;return s.push({fi:1,id:Zk,data:d(d({},ZB.defaultData),{},{name:"Scene 1"}),children:i}),s}function n(t){return d(d({},e.defaultData),{},{objects:bF(t,rO.prototype)})}e.TRASH_CAN_ID="830a2708-8ed9-49cf-a68e-085299892222",e.defaultLight={fi:-1,data:XB.defaultDirectionalLightData,id:"830a2708-8ed9-49cf-a68e-085299899103",children:[]},e.createDefaultObjectTreeWithPage=t,e.defaultData={objects:t(),publish:tR.defaultData,styles:rR.defaultData()},e.emptyDataWithoutPage=function(){return{objects:new rO,publish:tR.defaultData,styles:rR.defaultData()}},e.emptyDataWithPage=function(){return{objects:t(!(arguments.length>0&&void 0!==arguments[0])||arguments[0]),publish:tR.defaultData,styles:rR.defaultData()}},e.emptyData=function(){return{objects:new rO,publish:d({},tR.defaultData),styles:rR.defaultData()}},e.withObjs=n,e.withObj=function(e,t){return n([{id:e,data:t,children:[],fi:0}])}})(aR||(aR={})),(e=>{e.defaultData={preset:"fullscreen",allowResponsive:!1,size:[512,512],coords:[0,0],sceneScale:1,color:{r:0,g:0,b:0,a:.5}}})(oR||(oR={})),(e=>{e.defaultData=e=>({url:e,name:"New Webhook",parametersSchemas:new sO}),e.defaultParameterValueByType=e=>"number"===e?0:"boolean"!==e&&""})(lR||(lR={})),(e=>{e.defaultData=function(e){return{url:e,method:arguments.length>1&&void 0!==arguments[1]?arguments[1]:"GET",name:"New API",headers:new sO,queries:new sO,autoStart:!0}}})(uR||(uR={})),(e=>{function t(e){return void 0!==e.textValue}function n(e){return"boolean"==typeof e}e.isTextValue=t,e.isNumber=function(e){return"number"==typeof e},e.isBoolean=n,e.typeOfVariable=function(e){return t(e)?"string":n(e)?"boolean":"number"},e.getDisplayedValue=function(t){var n;return e.isTextValue(t)?Array.isArray(t.textValue)?t.textValue.map((e=>{var n;return e.toString().padStart(null!==(n=t.padding)&&void 0!==n?n:2,"0")})).join(null!==(n=t.deliminator)&&void 0!==n?n:":")+(void 0!==t.suffix?" "+t.suffix:""):t.textValue.toString():e.isBoolean(t)?t?"True":"False":e.isNumber(t)?parseFloat(t.toFixed(3)).toString():t.toString()}})(cR||(cR={})),(e=>{e.all=["images","videos","colors","audios","particles","fonts","materials","variables"]})(hR||(hR={})),(e=>{e.all=[...hR.all,"components"]})(dR||(dR={})),(e=>{e.defaultData=function(){return{images:new QF,videos:new QF,colors:new QF,audios:new QF,particles:new QF,fonts:new QF,materials:new QF,components:new QF,variables:new QF,userAPIs:new QF,userWebhooks:new QF}}})(pR||(pR={})),(e=>{e.defaultData=function(){return{images:new QF,videos:new QF,colors:new QF,audios:new QF,particles:new QF,fonts:new QF,materials:new QF,components:new QF,variables:new QF,userAPIs:new QF,userWebhooks:new QF}}})(fR||(fR={})),(e=>{e.defaultColors=function(){let e={"89b10010-844c-11ec-a8a3-0242ac120002":{r:.5,g:.5,b:.5,a:1,name:"Default Color"}};return bF(e,QF.prototype)},e.defaultImages=function(){return bF({},QF.prototype)},e.emptyData=function(){return{catelogs:new QF,materials:new QF,images:new QF,videos:new QF,colors:new QF,audios:new QF,particles:new QF,fonts:new QF,variables:new sO,userAPIs:new QF,userWebhooks:new QF,lib:fR.defaultData()}},e.defaultVariables=function(e){switch(e){case"number":return{value:0,name:"Number"};case"boolean":return{value:!1,name:"Boolean"};case"string":return{value:{textValue:"String value"},name:"String"};case"time":let t=[0,0,0];return{name:"Time",value:{textValue:t,deliminator:":",padding:2,suffix:"AM"},dynamicVariableType:"time",format:"HH:mm:ss",format12h24h:"12ampm",timeZone:null,hasEnd:!1,endValue:{textValue:t,deliminator:":",padding:2,suffix:"AM"},autoStart:!0,repeat:!1};case"counter":return{name:"Counter",value:0,dynamicVariableType:"counter",updateInterval:1e3,increment:1,autoStart:!0,hasEnd:!0,endValue:60,repeat:!0,randomStart:!1,range:[0,100],decimals:0};case"random":return{name:"Random",value:0,dynamicVariableType:"random",updateInterval:1e3,increment:1,autoStart:!0,isStatic:!1,hasEnd:!0,endValue:60,repeat:!0,min:0,max:100,decimals:0};default:console.error("Unknown variable type",e)}},e.getFormattedTimerTime=function(e,t){if("HH:mm:ss"===t.format){let t=Math.floor(e/3600),n=Math.floor((e-3600*t)/60);return{textValue:[t,n,Math.round(e-3600*t-60*n)]}}if("mm:ss"===t.format){let t=Math.floor(e/60);return{textValue:[t,Math.round(e-60*t)]}}return e="number"===t.format?Math.round(e):Math.round(1e3*e)/1e3}})(mR||(mR={})),(e=>{e.list=["idle","move","jump","run"]})(gR||(gR={})),(e=>{e.defaultColliderData={type:"capsule",height:200,radius:50,position:[0,0,0],rotation:[0,0,0]},e.defaultDataThirdPerson={moveMode:"walk",forwardDirection:"+z",speedTranslate:1e3,speedRotate:100,runMultiplier:2,rotationMode:"normal",rotBy:"keys",rotByTouch:"drag",delayPos:[.3,.3],delayRot:[.3,.3],keyAssignments:[["moveNegZ","W"],["moveNegX","A"],["movePosZ","S"],["movePosX","D"],["rotPosX","\u25b2"],["rotPosY","\u25c0"],["rotNegX","\u25bc"],["rotNegY","\u25b6"],["jump","Space"],["run","\u21e7"],["none","Ctrl"]],touchControl:!0,joystickPosLoc:5,joystickRotLoc:11,jumpTouchButtonLoc:9,collider:e.defaultColliderData,colliderHelperVisible:!0,collisionEnabled:!0,jumpPower:100,resetYPosition:3e3,alignToGround:!1,autoOrientMove:!0,orientWith:"camera",orientMode:"radial",delayPosCamera:.3,delayRotCamera:.3,camera:"",cameraXAxis:"Limit",cameraYAxis:"Free",cameraRotXLimits:[0,Math.PI/2],cameraRotYLimits:[-Math.PI/2,Math.PI/2],gameActions:{idle:new sO,move:new sO,jump:new sO,run:new sO},navmesh:{enabled:!1,ch:6,cs:6,walkableClimb:5,walkableHeight:1,walkableRadius:0,zones:"all",objects:[],helperVisible:!0,destinationHelperRadius:0,destinationHelperColor:Uk.fromHexAndA(3728051,1)}}})(vR||(vR={}));var IR=180/Math.PI;function kR(e){e.rotation=e.rotation.slice(0,3).map((e=>e*IR))}function BR(e){var t,n,i;kR(e),"Page"===e.type&&kR(e.camera),null===(t=e.states)||void 0===t||t.forEach((e=>{void 0===e.rotation||null===e.rotation||(e.rotation=e.rotation.slice(0,3).map((e=>e*IR)))}));let r=e.geometry;r&&"SphereGeometry"===r.type&&(r.thetaLength=(null!==(n=r.thetaLength)&&void 0!==n?n:180)*IR),r&&"TorusGeometry"===r.type&&(r.arc=r.arc*IR),r&&"PathGeometry"===r.type&&(r.extrusion.angle*=IR,r.extrusion.twist*=IR),"Mesh"===e.type&&"TextGeometry"===e.geometry.type&&(e.geometry.text={textValue:e.geometry.text}),Array.isArray(LO(e.events))&&(null===(i=e.events)||void 0===i||i.forEach((e=>{("MouseDown"===e.type||"MouseUp"===e.type||"MousePress"===e.type||"KeyDown"===e.type||"KeyUp"===e.type||"KeyPress"===e.type||"Collision"===e.type||"Trigger"===e.type)&&(e.runMode=e.toggle?"Toggle":"Repeat")})))}var RR,LR,zR,NR,jR,UR,VR,HR,WR,GR,qR,YR,XR,QR,KR,ZR,JR,$R,eL,tL,nL=115;function iL(e,t){t(e.data);for(let n of e.children)iL(n,t)}function rL(e){var t;let n=null!==(t=e.schema)&&void 0!==t?t:104;n!==nL&&n<105&&(iL(e.asset,BR),e.schema=105)}function sL(e){var t;let n=null!==(t=e.schema)&&void 0!==t?t:0;if(n!==nL){console.warn("updating from ",n,"to ",nL),FR(e,n),n<100&&(void 0===e.scene.publish.joystickSizeAndXYOffset&&(e.scene.publish.joystickSizeAndXYOffset=tR.defaultData.joystickSizeAndXYOffset),e.schema=100),n<101&&(wR(e,OR),bR(e,OR),e.schema=101),n<102&&(function(e){e.scene.objects.traverse(((e,t)=>{let n=t.geometry;n&&"PathGeometry"===n.type&&(n.extrusion.capType="flat",n.extrusion.bevel=50,n.extrusion.bevelSides=6,"Custom"===n.extrusion.shape.type&&(n.extrusion.shape.shapeQuality="low"))}))}(e),e.schema=102),n<104&&(e.shared.catelogs=new QF,e.shared.lib=fR.defaultData(),e.schema=104),n<105&&(function(e){e.shared.variables=bF({},QF.prototype)}(e),e.scene.objects.traverse(((e,t)=>{BR(t)})),e.schema=105);for(let t of Object.values(e.shared.lib.components))rL(t);n<106&&(function(e){let t=LO(e.shared.variables);e.shared.variables=bF(Object.entries(null!==t&&void 0!==t?t:{}).map(((e,t)=>{let[n,i]=e;return{fi:t,id:n,data:i}})),sO.prototype)}(e),e.schema=106),n<107&&(e.shared.lib.variables=fR.defaultData().variables,e.schema=107),n<109&&(function(e){e.shared.particles=bF({},QF.prototype),e.shared.lib&&(e.shared.lib.particles=fR.defaultData().particles)}(e),e.schema=109),n<110&&(function(e){e.scene.objects.traverse(((e,t)=>{"Particle"===t.type&&"number"==typeof t.renderMaterial.size&&Object.assign(t.renderMaterial,{size:[t.renderMaterial.size,t.renderMaterial.size]})}))}(e),e.schema=110),n<111&&(e.scene.objects.traverse(((e,t)=>{!function(e){var t;Array.isArray(LO(e.events))&&(null===(t=e.events)||void 0===t||t.forEach((e=>{"disabled"in e||(e.disabled=!1),("MouseDown"===e.type||"MouseUp"===e.type||"MousePress"===e.type)&&(e.mode=e.mode||"Object")})))}(t)})),e.schema=111),n<112&&(function(e){e.scene.objects.traverse(((e,t)=>{"Page"===t.type&&(t.postprocessing.depthOfField.focusDistance=100,t.postprocessing.depthOfField.focalLength=20,t.postprocessing.depthOfField.bokehScale=5)}))}(e),e.schema=112),n<113&&(function(e){e.scene.objects.traverse(((e,t)=>{var n;!1!==Array.isArray(LO(t.events))&&(null===(n=t.events)||void 0===n||n.forEach((e=>{var t,n,i,r,s,a,o,l,u;let c=e.runMode;"MouseDown"===e.type||"MouseUp"===e.type||"KeyDown"===e.type||"KeyUp"===e.type||"Collision"===e.type||"Trigger"===e.type?null===(t=e.actions)||void 0===t||t.forEach((e=>{"Transition"===e.type&&(e.runMode=null!==c&&void 0!==c?c:"Repeat"),("Animation"===e.type||"SwitchCamera"===e.type)&&(e.runMode="Toggle"===c?"Toggle":"Normal")})):"MouseHover"===e.type||"MousePress"===e.type||"KeyPress"===e.type?null===(n=e.actions)||void 0===n||n.forEach((e=>{("Transition"===e.type||"Animation"===e.type||"SwitchCamera"===e.type)&&(e.runMode="Toggle")})):"GameControl"===e.type?(delete e.actions,Object.keys(e.gameActions).forEach((t=>{var n;null===(n=e.gameActions[t])||void 0===n||n.forEach((e=>{"Transition"===e.type&&(e.runMode="Repeat"),"Animation"===e.type&&(e.runMode="Normal")}))}))):"DragDrop"===e.type?(delete e.actions,null!==(i=e.dragDropActions)&&void 0!==i&&null!==(i=i.drag)&&void 0!==i&&i.forEach((e=>{("Transition"===e.type||"Animation"===e.type||"SwitchCamera"===e.type)&&(e.runMode="Toggle")})),null===(r=e.dragDropActions)||void 0===r||null===(r=r.drop)||void 0===r||r.forEach((e=>{("Transition"===e.type||"Animation"===e.type||"SwitchCamera"===e.type)&&(e.runMode="Toggle")}))):"Resize"===e.type?(delete e.actions,null===(s=e.breakpoints)||void 0===s||s.forEach((e=>{var t;null===(t=e.actions)||void 0===t||t.forEach((e=>{("Transition"===e.type||"Animation"===e.type||"SwitchCamera"===e.type)&&(e.runMode="Toggle")}))}))):"Start"===e.type?null===(a=e.actions)||void 0===a||a.forEach((e=>{"Transition"===e.type&&(e.runMode="Once"),("Animation"===e.type||"SwitchCamera"===e.type)&&(e.runMode="Normal")})):"VariableChange"===e.type||"Scroll"===e.type?null===(o=e.actions)||void 0===o||o.forEach((e=>{"Transition"===e.type&&(e.runMode="Repeat"),("Animation"===e.type||"SwitchCamera"===e.type)&&(e.runMode="Normal")})):"Conditional"===e.type&&(delete e.actions,null!==(l=e.inActions)&&void 0!==l&&l.forEach((e=>{"Transition"===e.type&&(e.runMode="Repeat"),("Animation"===e.type||"SwitchCamera"===e.type)&&(e.runMode="Normal")})),null===(u=e.outActions)||void 0===u||u.forEach((e=>{"Transition"===e.type&&(e.runMode="Repeat"),("Animation"===e.type||"SwitchCamera"===e.type)&&(e.runMode="Normal")})))})))}))}(e),e.schema=113),n<114&&(void 0===e.scene.publish.settings.web.imageQuality&&(e.scene.publish.settings.web.imageQuality=70),e.schema=114),n<115&&(function(e){e.shared.userAPIs=bF({},QF.prototype),e.shared.userWebhooks=bF({},QF.prototype),e.shared.lib&&(e.shared.lib.userAPIs=fR.defaultData().userAPIs,e.shared.lib.userWebhooks=fR.defaultData().userWebhooks)}(e),e.schema=115)}}function aL(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=null!==e[0].index,i=new Set(Object.keys(e[0].attributes)),r=new Set(Object.keys(e[0].morphAttributes)),s={},a={},o=e[0].morphTargetsRelative,l=new dx,u=0;for(let c=0;c<e.length;++c){let h=e[c],d=0;if(n!==(null!==h.index))return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+c+". All geometries must have compatible attributes; make sure index attribute exists among all geometries, or in none of them."),null;for(let e in h.attributes){if(!i.has(e))return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+c+'. All geometries must have compatible attributes; make sure "'+e+'" attribute exists among all geometries, or in none of them.'),null;void 0===s[e]&&(s[e]=[]),s[e].push(h.attributes[e]),d++}if(d!==i.size)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+c+". Make sure all geometries have the same number of attributes."),null;if(o!==h.morphTargetsRelative)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+c+". .morphTargetsRelative must be consistent throughout all geometries."),null;for(let e in h.morphAttributes){if(!r.has(e))return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+c+".  .morphAttributes must be consistent throughout all geometries."),null;void 0===a[e]&&(a[e]=[]),a[e].push(h.morphAttributes[e])}if(t){let e;if(n)e=h.index.count;else{if(void 0===h.attributes.position)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+c+". The geometry must have either an index or a position attribute"),null;e=h.attributes.position.count}l.addGroup(u,e,c),u+=e}}if(n){let t=0,n=[];for(let i=0;i<e.length;++i){let r=e[i].index;for(let e=0;e<r.count;++e)n.push(r.getX(e)+t);t+=e[i].attributes.position.count}l.setIndex(n)}for(let c in s){let e=oL(s[c]);if(!e)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed while trying to merge the "+c+" attribute."),null;l.setAttribute(c,e)}for(let c in a){let e=a[c][0].length;if(0===e)break;l.morphAttributes=l.morphAttributes||{},l.morphAttributes[c]=[];for(let t=0;t<e;++t){let e=[];for(let i=0;i<a[c].length;++i)e.push(a[c][i][t]);let n=oL(e);if(!n)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed while trying to merge the "+c+" morphAttribute."),null;l.morphAttributes[c].push(n)}}return l}function oL(e){let t,n,i,r=0;for(let o=0;o<e.length;++o){let s=e[o];if(s.isInterleavedBufferAttribute)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. InterleavedBufferAttributes are not supported."),null;if(void 0===t&&(t=s.array.constructor),t!==s.array.constructor)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. BufferAttribute.array must be of consistent array types across matching attributes."),null;if(void 0===n&&(n=s.itemSize),n!==s.itemSize)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. BufferAttribute.itemSize must be consistent across matching attributes."),null;if(void 0===i&&(i=s.normalized),i!==s.normalized)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. BufferAttribute.normalized must be consistent across matching attributes."),null;r+=s.array.length}let s=new t(r),a=0;for(let o=0;o<e.length;++o)s.set(e[o].array,a),a+=e[o].array.length;return new tx(s,n,i)}(e=>{e.defaultData={schema:nL,scene:aR.defaultData,frames:(new QF).add("72fc2993-2da3-4b6b-96ac-2879db3a28bd",oR.defaultData),shared:d(d({},mR.emptyData()),{},{colors:mR.defaultColors()})},e.emptyDataForImports=function(){let e=aR.emptyDataWithPage();return{schema:nL,scene:e,frames:(new QF).add("72fc2993-2da3-4b6b-96ac-2879db3a28bd",oR.defaultData),shared:d(d({},mR.emptyData()),{},{colors:mR.defaultColors(),images:mR.defaultImages()})}},e.emptyData=function(){return{schema:nL,scene:aR.emptyDataWithPage(),frames:(new QF).add("72fc2993-2da3-4b6b-96ac-2879db3a28bd",oR.defaultData),shared:mR.emptyData()}},e.clipboard2dData=function(){return{schema:nL,scene:aR.emptyData(),frames:new QF,shared:mR.emptyData()}},e.collabHelper=d(d({},cO),{},{updateSchema(e){var t,n;return(null!==(t=e.schema)&&void 0!==t?t:0)<nL?RO(e,sL):(null!==(n=e.schema)&&void 0!==n?n:0)-nL}}),e.updateSchemaDirectly=function(t){let n=e.collabHelper.updateSchema(t);return"number"==typeof n?0===n?t:null:n.data},e.withoutLib=function(e){return d(d({},e),{},{shared:d(d({},e.shared),{},{lib:fR.defaultData()})})},e.getComponentData=function(e,t){let n=e.scene.objects.get(t);if(n&&"Component"===n.data.type)return n;{let n=e.shared.lib.components[t];if(n)return n.asset}},e.hasSensitiveData=function(e){let t=Object.values(e.shared.userAPIs);for(let n of t){let e=n.headers;for(let t of e)if("authorization"===t.data.key.toLowerCase()&&""!==t.data.value)return!0}return!1}})(RR||(RR={})),(e=>{e.emptyImage={data:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVQYV2NgYAAAAAMAAWgmWQ0AAAAASUVORK5CYII=",name:"empty"}})(LR||(LR={})),(e=>{e.is=function(e){return!0}})(zR||(zR={})),(e=>{e.defaultData={position:[0,0],scale:[1,1],rotation:0,shear:[0,0]},e.merge=function(e,t){var n,i,r,s;return{position:null!==(n=null===t||void 0===t?void 0:t.position)&&void 0!==n?n:e.position,rotation:null!==(i=null===t||void 0===t?void 0:t.rotation)&&void 0!==i?i:e.rotation,scale:null!==(r=null===t||void 0===t?void 0:t.scale)&&void 0!==r?r:e.scale,shear:null!==(s=null===t||void 0===t?void 0:t.shear)&&void 0!==s?s:e.shear}},e.diff=function(e,t){return xF({position:Bk.isEqual(e.position,t.position)?void 0:t.position,rotation:e.rotation===t.rotation?void 0:t.rotation,scale:Bk.isEqual(e.scale,t.scale)?void 0:t.scale,shear:e.shear&&t.shear&&Bk.isEqual(e.shear,t.shear)?void 0:t.shear})}})(NR||(NR={})),(e=>{e.defaultData={horizontalConstraint:0,verticalConstraint:0}})(jR||(jR={})),(e=>{e.defaultData={direction:"row",wrap:"unwrap",align:"top-left",gap:10,rowGap:10,autoGap:!1,autoRowGap:!1,leftPadding:8,rightPadding:8,topPadding:8,bottomPadding:8}})(UR||(UR={})),(e=>{e.defaultData={opacity:1,fill:{color:Uk.fromHexAndA(Jk,1),enabled:!0},stroke:{color:Uk.from0to1([0,0,0,1]),thickness:1,enabled:!1,mode:"inside"},layerBlur:{radius:2,enabled:!1},backgroundBlur:{radius:2,enabled:!1},dropShadow:{offset:[10,10],blurRadius:10,color:Uk.from0to1([0,0,0,1]),enabled:!1,spread:0},innerShadow:{offset:[10,10],blurRadius:10,color:Uk.from0to1([0,0,0,1]),enabled:!1,spread:0}}})(VR||(VR={})),(e=>{e.newEmpty=function(e,t){return{name:t}},e.patch=function(e,t){if(void 0===t)return e;let n=d({},e);return Object.assign(n,NR.merge(n,t)),n=function(e,t){if(void 0===t)return e;let n=d({},e),i=["width","height","cornerRadius"];for(let r of i)r in n&&r in t&&void 0!==t[r]&&Object.assign(n,{[r]:t[r]});return n}(n,t),n=function(e,t){if(void 0===t)return e;let n=d({},e);return"fill"in n&&"fill"in t&&void 0!==t.fill&&Object.assign(n,{fill:d(d({},n.fill),t.fill)}),"stroke"in n&&"stroke"in t&&void 0!==t.stroke&&Object.assign(n,{stroke:d(d({},n.stroke),t.stroke)}),"layerBlur"in n&&"layerBlur"in t&&void 0!==t.layerBlur&&Object.assign(n,{layerBlur:d(d({},n.layerBlur),t.layerBlur)}),"backgroundBlur"in n&&"backgroundBlur"in t&&void 0!==t.backgroundBlur&&Object.assign(n,{backgroundBlur:d(d({},n.backgroundBlur),t.backgroundBlur)}),"dropShadow"in n&&"dropShadow"in t&&void 0!==t.dropShadow&&Object.assign(n,{dropShadow:d(d({},n.dropShadow),t.dropShadow)}),"innerShadow"in n&&"innerShadow"in t&&void 0!==t.innerShadow&&Object.assign(n,{innerShadow:d(d({},n.innerShadow),t.innerShadow)}),n}(n,t),n},e.toOps=function(e,t){let n,i=[];for(let[r,s]of Object.entries(t))"name"!==r&&(void 0===n&&(n={path:[],props:{},type:0},i.push(n)),n.props[r]=s);return i}})(HR||(HR={})),(e=>{e.defaultData=d(d(d({},NR.defaultData),jR.defaultData),{},{states:new sO,events:new sO,visible:!0,raycastLock:!1})})(WR||(WR={})),(e=>{e.defaultData=d(d({},WR.defaultData),VR.defaultData)})(GR||(GR={})),(e=>{e.defaultData={cornerRadius:[0,0,0,0]}})(qR||(qR={})),(e=>{e.defaultData=d(d({},GR.defaultData),{},{type:"ellipse2d",width:100,height:100,name:"Ellipse"})})(YR||(YR={})),(e=>{e.defaultData=d(d(d({},GR.defaultData),qR.defaultData),{},{type:"rectangle2d",width:100,height:100,name:"Rectangle"})})(XR||(XR={})),(e=>{e.defaultData=d(d({},GR.defaultData),{},{type:"text2d",width:100,height:100,fontSize:12,lineHeight:1.2,letterSpacing:0,text:{textValue:"Hello world"},horizontalAlign:1,verticalAlign:1,textTransform:1,font:"Roboto_regular",name:"Text"})})(QR||(QR={})),(e=>{e.defaultData=d(d({},GR.defaultData),{},{type:"path2d",path:"",name:"Path"})})(KR||(KR={})),(e=>{e.is=function(e){return"ellipse2d"===e.type||"rectangle2d"===e.type||"text2d"===e.type||"vector2d"===e.type||"path2d"===e.type}})(ZR||(ZR={})),(e=>{e.defaultData=d(d({},WR.defaultData),{},{name:"Group",type:"group2d"})})(JR||(JR={})),(e=>{e.defaultData=()=>d(d(d(d({},WR.defaultData),qR.defaultData),VR.defaultData),{},{name:"Frame",type:"frame2d",clipped:!0,width:200,height:200,fill:{color:Uk.fromHexAndA(4737101,1),enabled:!0},stroke:{color:Uk.fromHexAndA(0,1),thickness:1,enabled:!1,mode:"inside"},backgroundBlur:{radius:2,enabled:!1},layerBlur:{radius:2,enabled:!1}})})($R||($R={})),(e=>{e.defaultData=function(e){switch(e){case"rectangle2d":case"vector2d":return d({},XR.defaultData);case"ellipse2d":return d({},YR.defaultData);case"text2d":return d({},QR.defaultData);case"path2d":return d({},KR.defaultData);case"frame2d":return d({},$R.defaultData());case"group2d":return d({},JR.defaultData)}},e.getPivot=function(e){return"width"in e&&"height"in e?["number"==typeof e.width?.5*e.width:0,"number"==typeof e.height?.5*e.height:0]:[0,0]},e.isResizeable=function(e){return"rectangle2d"===e.type||"ellipse2d"===e.type||"text2d"===e.type||"frame2d"===e.type},e.isAutoLayoutable=function(e){return"frame2d"===e.type&&void 0!==e.autoLayout},e.hasCorners=function(e){return"rectangle2d"===e.type||"frame2d"===e.type}})(eL||(eL={})),(e=>{e.defaultData={name:"UI",type:"scene2d",objects:new rO},e.emptyData=function(){return{type:"scene2d",objects:new rO}}})(tL||(tL={}));var lL=Math.pow(2,-24),uL=class{constructor(){}};function cL(e,t,n){return n.min.x=t[e],n.min.y=t[e+1],n.min.z=t[e+2],n.max.x=t[e+3],n.max.y=t[e+4],n.max.z=t[e+5],n}function hL(e){let t=-1,n=-1/0;for(let i=0;i<3;i++){let r=e[i+3]-e[i];r>n&&(n=r,t=i)}return t}function dL(e,t){t.set(e)}function pL(e,t,n){let i,r;for(let s=0;s<3;s++){let a=s+3;i=e[s],r=t[s],n[s]=i<r?i:r,i=e[a],r=t[a],n[a]=i>r?i:r}}function fL(e,t,n){for(let i=0;i<3;i++){let r=t[e+2*i],s=t[e+2*i+1],a=r-s,o=r+s;a<n[i]&&(n[i]=a),o>n[i+3]&&(n[i+3]=o)}}function mL(e){let t=e[3]-e[0],n=e[4]-e[1],i=e[5]-e[2];return 2*(t*n+n*i+i*t)}function gL(e,t,n,i){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,s=1/0,a=1/0,o=1/0,l=-1/0,u=-1/0,c=-1/0,h=1/0,d=1/0,p=1/0,f=-1/0,m=-1/0,g=-1/0,v=null!==r;for(let y=6*t,x=6*(t+n);y<x;y+=6){let t=e[y+0],n=e[y+1],i=t-n,r=t+n;i<s&&(s=i),r>l&&(l=r),v&&t<h&&(h=t),v&&t>f&&(f=t);let x=e[y+2],b=e[y+3],w=x-b,D=x+b;w<a&&(a=w),D>u&&(u=D),v&&x<d&&(d=x),v&&x>m&&(m=x);let _=e[y+4],S=e[y+5],E=_-S,C=_+S;E<o&&(o=E),C>c&&(c=C),v&&_<p&&(p=_),v&&_>g&&(g=_)}i[0]=s,i[1]=a,i[2]=o,i[3]=l,i[4]=u,i[5]=c,v&&(r[0]=h,r[1]=d,r[2]=p,r[3]=f,r[4]=m,r[5]=g)}var vL=32,yL=(e,t)=>e.candidate-t.candidate,xL=new Array(vL).fill().map((()=>({count:0,bounds:new Float32Array(6),rightCacheBounds:new Float32Array(6),leftCacheBounds:new Float32Array(6),candidate:0}))),bL=new Float32Array(6);function wL(e,t){function n(e){d&&d(e/p)}function i(t,r,d){let p=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,m=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;if(!f&&m>=l&&(f=!0,u&&(console.warn("MeshBVH: Max depth of ".concat(l," reached when generating BVH. Consider increasing maxDepth.")),console.warn(e))),d<=c||m>=l)return n(r+d),t.offset=r,t.count=d,t;let g=function(e,t,n,i,r,s){let a=-1,o=0;if(0===s)a=hL(t),-1!==a&&(o=(t[a]+t[a+3])/2);else if(1===s)a=hL(e),-1!==a&&(o=function(e,t,n,i){let r=0;for(let s=t,a=t+n;s<a;s++)r+=e[6*s+2*i];return r/n}(n,i,r,a));else if(2===s){let s=mL(e),l=1.25*r,u=6*i,c=6*(i+r);for(let e=0;e<3;e++){let i=t[e],h=(t[e+3]-i)/vL;if(r<8){let t=[...xL];t.length=r;let i=0;for(let r=u;r<c;r+=6,i++){let s=t[i];s.candidate=n[r+2*e],s.count=0;let{bounds:a,leftCacheBounds:o,rightCacheBounds:l}=s;for(let e=0;e<3;e++)l[e]=1/0,l[e+3]=-1/0,o[e]=1/0,o[e+3]=-1/0,a[e]=1/0,a[e+3]=-1/0;fL(r,n,a)}t.sort(yL);let h=r;for(let e=0;e<h;e++){let n=t[e];for(;e+1<h&&t[e+1].candidate===n.candidate;)t.splice(e+1,1),h--}for(let r=u;r<c;r+=6){let i=n[r+2*e];for(let e=0;e<h;e++){let s=t[e];i>=s.candidate?fL(r,n,s.rightCacheBounds):(fL(r,n,s.leftCacheBounds),s.count++)}}for(let n=0;n<h;n++){let i=t[n],u=i.count,c=r-i.count,h=i.leftCacheBounds,d=i.rightCacheBounds,p=0;0!==u&&(p=mL(h)/s);let f=0;0!==c&&(f=mL(d)/s);let m=1+1.25*(p*u+f*c);m<l&&(a=e,l=m,o=i.candidate)}}else{for(let e=0;e<vL;e++){let t=xL[e];t.count=0,t.candidate=i+h+e*h;let n=t.bounds;for(let e=0;e<3;e++)n[e]=1/0,n[e+3]=-1/0}for(let r=u;r<c;r+=6){let t=~~((n[r+2*e]-i)/h);t>=vL&&(t=31);let s=xL[t];s.count++,fL(r,n,s.bounds)}let t=xL[31];dL(t.bounds,t.rightCacheBounds);for(let e=30;e>=0;e--){let t=xL[e],n=xL[e+1];pL(t.bounds,n.rightCacheBounds,t.rightCacheBounds)}let d=0;for(let n=0;n<31;n++){let t=xL[n],i=t.count,u=t.bounds,c=xL[n+1].rightCacheBounds;0!==i&&(0===d?dL(u,bL):pL(u,bL,bL)),d+=i;let h=0,p=0;0!==d&&(h=mL(bL)/s);let f=r-d;0!==f&&(p=mL(c)/s);let m=1+1.25*(h*d+p*f);m<l&&(a=e,l=m,o=t.candidate)}}}}else console.warn("MeshBVH: Invalid build strategy value ".concat(s," used."));return{axis:a,pos:o}}(t.boundingData,p,a,r,d,h);if(-1===g.axis)return n(r+d),t.offset=r,t.count=d,t;let v=function(e,t,n,i,r){let s=n,a=n+i-1,o=r.pos,l=2*r.axis;for(;;){for(;s<=a&&t[6*s+l]<o;)s++;for(;s<=a&&t[6*a+l]>=o;)a--;if(!(s<a))return s;for(let n=0;n<3;n++){let i=e[3*s+n];e[3*s+n]=e[3*a+n],e[3*a+n]=i;let r=t[6*s+2*n+0];t[6*s+2*n+0]=t[6*a+2*n+0],t[6*a+2*n+0]=r;let o=t[6*s+2*n+1];t[6*s+2*n+1]=t[6*a+2*n+1],t[6*a+2*n+1]=o}s++,a--}}(o,a,r,d,g);if(v===r||v===r+d)n(r+d),t.offset=r,t.count=d;else{t.splitAxis=g.axis;let e=new uL,n=r,o=v-r;t.left=e,e.boundingData=new Float32Array(6),gL(a,n,o,e.boundingData,s),i(e,n,o,s,m+1);let l=new uL,u=v,c=d-o;t.right=l,l.boundingData=new Float32Array(6),gL(a,u,c,l.boundingData,s),i(l,u,c,s,m+1)}return t}!function(e,t){if(!e.index){let n,i=e.attributes.position.count,r=t.useSharedArrayBuffer?SharedArrayBuffer:ArrayBuffer;n=i>65535?new Uint32Array(new r(4*i)):new Uint16Array(new r(2*i)),e.setIndex(new tx(n,1));for(let e=0;e<i;e++)n[e]=e}}(e,t);let r=new Float32Array(6),s=new Float32Array(6),a=function(e,t){let n=e.attributes.position,i=e.index.array,r=i.length/3,s=new Float32Array(6*r),a=n.normalized,o=n.array,l=n.offset||0,u=3;n.isInterleavedBufferAttribute&&(u=n.data.stride);let c=["getX","getY","getZ"];for(let h=0;h<r;h++){let e,r,d,p=3*h,f=6*h;a?(e=i[p+0],r=i[p+1],d=i[p+2]):(e=i[p+0]*u+l,r=i[p+1]*u+l,d=i[p+2]*u+l);for(let i=0;i<3;i++){let l,u,h;a?(l=n[c[i]](e),u=n[c[i]](r),h=n[c[i]](d)):(l=o[e+i],u=o[r+i],h=o[d+i]);let p=l;u<p&&(p=u),h<p&&(p=h);let m=l;u>m&&(m=u),h>m&&(m=h);let g=(m-p)/2,v=2*i;s[f+v+0]=p+g,s[f+v+1]=g+(Math.abs(p)+g)*lL,p<t[i]&&(t[i]=p),m>t[i+3]&&(t[i+3]=m)}}return s}(e,r),o=e.index.array,l=t.maxDepth,u=t.verbose,c=t.maxLeafTris,h=t.strategy,d=t.onProgress,p=e.index.count/3,f=!1,m=[],g=function(e){if(!e.groups||!e.groups.length)return[{offset:0,count:e.index.count/3}];let t=[],n=new Set;for(let r of e.groups)n.add(r.start),n.add(r.start+r.count);let i=Array.from(n.values()).sort(((e,t)=>e-t));for(let r=0;r<i.length-1;r++){let e=i[r],n=i[r+1];t.push({offset:e/3,count:(n-e)/3})}return t}(e);if(1===g.length){let e=g[0],t=new uL;t.boundingData=r,function(e,t,n,i){let r=1/0,s=1/0,a=1/0,o=-1/0,l=-1/0,u=-1/0;for(let c=6*t,h=6*(t+n);c<h;c+=6){let t=e[c+0];t<r&&(r=t),t>o&&(o=t);let n=e[c+2];n<s&&(s=n),n>l&&(l=n);let i=e[c+4];i<a&&(a=i),i>u&&(u=i)}i[0]=r,i[1]=s,i[2]=a,i[3]=o,i[4]=l,i[5]=u}(a,e.offset,e.count,s),i(t,e.offset,e.count,s),m.push(t)}else for(let v of g){let e=new uL;e.boundingData=new Float32Array(6),gL(a,v.offset,v.count,e.boundingData,s),i(e,v.offset,v.count,s),m.push(e)}return m}var DL=class{constructor(){this.min=1/0,this.max=-1/0}setFromPointsField(e,t){let n=1/0,i=-1/0;for(let r=0,s=e.length;r<s;r++){let s=e[r][t];n=s<n?s:n,i=s>i?s:i}this.min=n,this.max=i}setFromPoints(e,t){let n=1/0,i=-1/0;for(let r=0,s=t.length;r<s;r++){let s=t[r],a=e.dot(s);n=a<n?a:n,i=a>i?a:i}this.min=n,this.max=i}isSeparated(e){return this.min>e.max||e.min>this.max}};DL.prototype.setFromBox=function(){let e=new Lv;return function(t,n){let i=n.min,r=n.max,s=1/0,a=-1/0;for(let o=0;o<=1;o++)for(let n=0;n<=1;n++)for(let l=0;l<=1;l++){e.x=i.x*o+r.x*(1-o),e.y=i.y*n+r.y*(1-n),e.z=i.z*l+r.z*(1-l);let u=t.dot(e);s=Math.min(u,s),a=Math.max(u,a)}this.min=s,this.max=a}}();!function(){let e=new DL}();var _L=function(){let e=new Lv,t=new Lv,n=new Lv;return function(i,r,s){let a=i.start,o=e,l=r.start,u=t;n.subVectors(a,l),e.subVectors(i.end,i.start),t.subVectors(r.end,r.start);let c,h,d=n.dot(u),p=u.dot(o),f=u.dot(u),m=n.dot(o),g=o.dot(o)*f-p*p;c=0!==g?(d*p-m*f)/g:0,h=(d+c*p)/f,s.x=c,s.y=h}}(),SL=function(){let e=new lv,t=new Lv,n=new Lv;return function(i,r,s,a){_L(i,r,e);let o=e.x,l=e.y;if(o>=0&&o<=1&&l>=0&&l<=1)return i.at(o,s),void r.at(l,a);if(o>=0&&o<=1)return l<0?r.at(0,a):r.at(1,a),void i.closestPointToPoint(a,!0,s);if(l>=0&&l<=1)return o<0?i.at(0,s):i.at(1,s),void r.closestPointToPoint(s,!0,a);{let e,u;e=o<0?i.start:i.end,u=l<0?r.start:r.end;let c=t,h=n;return i.closestPointToPoint(u,!0,t),r.closestPointToPoint(e,!0,n),c.distanceToSquared(u)<=h.distanceToSquared(e)?(s.copy(c),void a.copy(u)):(s.copy(e),void a.copy(h))}}}(),EL=function(){let e=new Lv,t=new Lv,n=new Hx,i=new DE;return function(r,s){let{radius:a,center:o}=r,{a:l,b:u,c:c}=s;if(i.start=l,i.end=u,i.closestPointToPoint(o,!0,e).distanceTo(o)<=a||(i.start=l,i.end=c,i.closestPointToPoint(o,!0,e).distanceTo(o)<=a)||(i.start=u,i.end=c,i.closestPointToPoint(o,!0,e).distanceTo(o)<=a))return!0;let h=s.getPlane(n);if(Math.abs(h.distanceToPoint(o))<=a){let e=h.projectPoint(o,t);if(s.containsPoint(e))return!0}return!1}}();function CL(e){return Math.abs(e)<1e-15}var AL=class extends Qy{constructor(){super(...arguments),this.isExtendedTriangle=!0,this.satAxes=new Array(4).fill().map((()=>new Lv)),this.satBounds=new Array(4).fill().map((()=>new DL)),this.points=[this.a,this.b,this.c],this.sphere=new ry,this.plane=new Hx,this.needsUpdate=!0}intersectsSphere(e){return EL(e,this)}update(){let e=this.a,t=this.b,n=this.c,i=this.points,r=this.satAxes,s=this.satBounds,a=r[0],o=s[0];this.getNormal(a),o.setFromPoints(a,i);let l=r[1],u=s[1];l.subVectors(e,t),u.setFromPoints(l,i);let c=r[2],h=s[2];c.subVectors(t,n),h.setFromPoints(c,i);let d=r[3],p=s[3];d.subVectors(n,e),p.setFromPoints(d,i),this.sphere.setFromPoints(this.points),this.plane.setFromNormalAndCoplanarPoint(a,e),this.needsUpdate=!1}};AL.prototype.closestPointToSegment=function(){let e=new Lv,t=new Lv,n=new DE;return function(i){let r,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,{start:o,end:l}=i,u=this.points,c=1/0;for(let h=0;h<3;h++){let o=(h+1)%3;n.start.copy(u[h]),n.end.copy(u[o]),SL(n,i,e,t),r=e.distanceToSquared(t),r<c&&(c=r,s&&s.copy(e),a&&a.copy(t))}return this.closestPointToPoint(o,e),r=o.distanceToSquared(e),r<c&&(c=r,s&&s.copy(e),a&&a.copy(o)),this.closestPointToPoint(l,e),r=l.distanceToSquared(e),r<c&&(c=r,s&&s.copy(e),a&&a.copy(l)),Math.sqrt(c)}}(),AL.prototype.intersectsTriangle=function(){let e=new AL,t=new Array(3),n=new Array(3),i=new DL,r=new DL,s=new Lv,a=new Lv,o=new Lv,l=new Lv,u=new DE,c=new DE,h=new DE;return function(d){let p=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,f=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.needsUpdate&&this.update(),d.isExtendedTriangle?d.needsUpdate&&d.update():(e.copy(d),e.update(),d=e);let m=this.plane,g=d.plane;if(Math.abs(m.normal.dot(g.normal))>1-1e-10){let e=this.satBounds,a=this.satAxes;n[0]=d.a,n[1]=d.b,n[2]=d.c;for(let t=0;t<4;t++){let r=e[t],s=a[t];if(i.setFromPoints(s,n),r.isSeparated(i))return!1}let o=d.satBounds,l=d.satAxes;t[0]=this.a,t[1]=this.b,t[2]=this.c;for(let n=0;n<4;n++){let e=o[n],r=l[n];if(i.setFromPoints(r,t),e.isSeparated(i))return!1}for(let u=0;u<4;u++){let e=a[u];for(let a=0;a<4;a++){let o=l[a];if(s.crossVectors(e,o),i.setFromPoints(s,t),r.setFromPoints(s,n),i.isSeparated(r))return!1}}return p&&(f||console.warn("ExtendedTriangle.intersectsTriangle: Triangles are coplanar which does not support an output edge. Setting edge to 0, 0, 0."),p.start.set(0,0,0),p.end.set(0,0,0)),!0}{let e=this.points,t=!1,n=0;for(let o=0;o<3;o++){let i=e[o],r=e[(o+1)%3];u.start.copy(i),u.end.copy(r),u.delta(a);let s=t?c.start:c.end,l=CL(g.distanceToPoint(i));if(CL(g.normal.dot(a))&&l){c.copy(u),n=2;break}if((g.intersectLine(u,s)||l)&&!CL(s.distanceTo(r))){if(n++,t)break;t=!0}}if(1===n&&d.containsPoint(c.end))return p&&(p.start.copy(c.end),p.end.copy(c.end)),!0;if(2!==n)return!1;let i=d.points,r=!1,s=0;for(let a=0;a<3;a++){let e=i[a],t=i[(a+1)%3];u.start.copy(e),u.end.copy(t),u.delta(o);let n=r?h.start:h.end,l=CL(m.distanceToPoint(e));if(CL(m.normal.dot(o))&&l){h.copy(u),s=2;break}if((m.intersectLine(u,n)||l)&&!CL(n.distanceTo(t))){if(s++,r)break;r=!0}}if(1===s&&this.containsPoint(h.end))return p&&(p.start.copy(h.end),p.end.copy(h.end)),!0;if(2!==s)return!1;if(c.delta(a),h.delta(o),a.dot(o)<0){let e=h.start;h.start=h.end,h.end=e}let f=c.start.dot(a),v=c.end.dot(a),y=h.start.dot(a),x=h.end.dot(a);return(f===x||y===v||v<y!==f<x)&&(p&&(l.subVectors(c.start,h.start),l.dot(a)>0?p.start.copy(c.start):p.start.copy(h.start),l.subVectors(c.end,h.end),l.dot(a)<0?p.end.copy(c.end):p.end.copy(h.end)),!0)}}}(),AL.prototype.distanceToPoint=function(){let e=new Lv;return function(t){return this.closestPointToPoint(t,e),t.distanceTo(e)}}(),AL.prototype.distanceToTriangle=function(){let e=new Lv,t=new Lv,n=["a","b","c"],i=new DE,r=new DE;return function(s){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,l=a||o?i:null;if(this.intersectsTriangle(s,l))return(a||o)&&(a&&l.getCenter(a),o&&l.getCenter(o)),0;let u=1/0;for(let t=0;t<3;t++){let i,r=n[t],l=s[r];this.closestPointToPoint(l,e),i=l.distanceToSquared(e),i<u&&(u=i,a&&a.copy(e),o&&o.copy(l));let c=this[r];s.closestPointToPoint(c,e),i=c.distanceToSquared(e),i<u&&(u=i,a&&a.copy(c),o&&o.copy(e))}for(let c=0;c<3;c++){let l=n[c],h=n[(c+1)%3];i.set(this[l],this[h]);for(let c=0;c<3;c++){let l=n[c],h=n[(c+1)%3];r.set(s[l],s[h]),SL(i,r,e,t);let d=e.distanceToSquared(t);d<u&&(u=d,a&&a.copy(e),o&&o.copy(t))}}return Math.sqrt(u)}}();var ML=class{constructor(e,t,n){this.isOrientedBox=!0,this.min=new Lv,this.max=new Lv,this.matrix=new py,this.invMatrix=new py,this.points=new Array(8).fill().map((()=>new Lv)),this.satAxes=new Array(3).fill().map((()=>new Lv)),this.satBounds=new Array(3).fill().map((()=>new DL)),this.alignedSatBounds=new Array(3).fill().map((()=>new DL)),this.needsUpdate=!1,e&&this.min.copy(e),t&&this.max.copy(t),n&&this.matrix.copy(n)}set(e,t,n){this.min.copy(e),this.max.copy(t),this.matrix.copy(n),this.needsUpdate=!0}copy(e){this.min.copy(e.min),this.max.copy(e.max),this.matrix.copy(e.matrix),this.needsUpdate=!0}};ML.prototype.update=function(){let e=this.matrix,t=this.min,n=this.max,i=this.points;for(let l=0;l<=1;l++)for(let r=0;r<=1;r++)for(let s=0;s<=1;s++){let a=i[1*l|2*r|4*s];a.x=l?n.x:t.x,a.y=r?n.y:t.y,a.z=s?n.z:t.z,a.applyMatrix4(e)}let r=this.satBounds,s=this.satAxes,a=i[0];for(let l=0;l<3;l++){let e=s[l],t=r[l],n=i[1<<l];e.subVectors(a,n),t.setFromPoints(e,i)}let o=this.alignedSatBounds;o[0].setFromPointsField(i,"x"),o[1].setFromPointsField(i,"y"),o[2].setFromPointsField(i,"z"),this.invMatrix.copy(this.matrix).invert(),this.needsUpdate=!1},ML.prototype.intersectsBox=function(){let e=new DL;return function(t){this.needsUpdate&&this.update();let n=t.min,i=t.max,r=this.satBounds,s=this.satAxes,a=this.alignedSatBounds;if(e.min=n.x,e.max=i.x,a[0].isSeparated(e)||(e.min=n.y,e.max=i.y,a[1].isSeparated(e))||(e.min=n.z,e.max=i.z,a[2].isSeparated(e)))return!1;for(let o=0;o<3;o++){let n=s[o],i=r[o];if(e.setFromBox(n,t),i.isSeparated(e))return!1}return!0}}(),ML.prototype.intersectsTriangle=function(){let e=new AL,t=new Array(3),n=new DL,i=new DL,r=new Lv;return function(s){this.needsUpdate&&this.update(),s.isExtendedTriangle?s.needsUpdate&&s.update():(e.copy(s),e.update(),s=e);let a=this.satBounds,o=this.satAxes;t[0]=s.a,t[1]=s.b,t[2]=s.c;for(let e=0;e<3;e++){let i=a[e],r=o[e];if(n.setFromPoints(r,t),i.isSeparated(n))return!1}let l=s.satBounds,u=s.satAxes,c=this.points;for(let e=0;e<3;e++){let t=l[e],i=u[e];if(n.setFromPoints(i,c),t.isSeparated(n))return!1}for(let e=0;e<3;e++){let s=o[e];for(let e=0;e<4;e++){let a=u[e];if(r.crossVectors(s,a),n.setFromPoints(r,t),i.setFromPoints(r,c),n.isSeparated(i))return!1}}return!0}}(),ML.prototype.closestPointToPoint=function(e,t){return this.needsUpdate&&this.update(),t.copy(e).applyMatrix4(this.invMatrix).clamp(this.min,this.max).applyMatrix4(this.matrix),t},ML.prototype.distanceToPoint=function(){let e=new Lv;return function(t){return this.closestPointToPoint(t,e),t.distanceTo(e)}}(),ML.prototype.distanceToBox=function(){let e=["x","y","z"],t=new Array(12).fill().map((()=>new DE)),n=new Array(12).fill().map((()=>new DE)),i=new Lv,r=new Lv;return function(s){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(this.needsUpdate&&this.update(),this.intersectsBox(s))return(o||l)&&(s.getCenter(r),this.closestPointToPoint(r,i),s.closestPointToPoint(i,r),o&&o.copy(i),l&&l.copy(r)),0;let u=a*a,c=s.min,h=s.max,d=this.points,p=1/0;for(let e=0;e<8;e++){let t=d[e];r.copy(t).clamp(c,h);let n=t.distanceToSquared(r);if(n<p&&(p=n,o&&o.copy(t),l&&l.copy(r),n<u))return Math.sqrt(n)}let f=0;for(let i=0;i<3;i++)for(let r=0;r<=1;r++)for(let s=0;s<=1;s++){let a=(i+1)%3,o=(i+2)%3,l=1<<i|r<<a|s<<o,u=d[r<<a|s<<o],p=d[l];t[f].set(u,p);let m=e[i],g=e[a],v=e[o],y=n[f],x=y.start,b=y.end;x[m]=c[m],x[g]=r?c[g]:h[g],x[v]=s?c[v]:h[g],b[m]=h[m],b[g]=r?c[g]:h[g],b[v]=s?c[v]:h[g],f++}for(let e=0;e<=1;e++)for(let t=0;t<=1;t++)for(let n=0;n<=1;n++){r.x=e?h.x:c.x,r.y=t?h.y:c.y,r.z=n?h.z:c.z,this.closestPointToPoint(r,i);let s=r.distanceToSquared(i);if(s<p&&(p=s,o&&o.copy(i),l&&l.copy(r),s<u))return Math.sqrt(s)}for(let e=0;e<12;e++){let s=t[e];for(let e=0;e<12;e++){let t=n[e];SL(s,t,i,r);let a=i.distanceToSquared(r);if(a<p&&(p=a,o&&o.copy(i),l&&l.copy(r),a<u))return Math.sqrt(a)}}return Math.sqrt(p)}}();var TL=new Lv,PL=new Lv,FL=new Lv,OL=new lv,IL=new lv,kL=new lv,BL=new Lv,RL=new Lv,LL=new Lv,zL=new Lv;function NL(e,t,n,i,r){let s=3*i,a=e.index.getX(s),o=e.index.getX(s+1),l=e.index.getX(s+2),{position:u,normal:c,uv:h,uv1:d}=e.attributes,p=function(e,t,n,i,r,s,a,o,l){TL.fromBufferAttribute(t,s),PL.fromBufferAttribute(t,a),FL.fromBufferAttribute(t,o);let u=function(e,t,n,i,r,s){let a;return a=1===s?e.intersectTriangle(i,n,t,!0,r):e.intersectTriangle(t,n,i,2!==s,r),null===a?null:{distance:e.origin.distanceTo(r),point:r.clone()}}(e,TL,PL,FL,zL,l);if(u){i&&(OL.fromBufferAttribute(i,s),IL.fromBufferAttribute(i,a),kL.fromBufferAttribute(i,o),u.uv=Qy.getInterpolation(zL,TL,PL,FL,OL,IL,kL,new lv)),r&&(OL.fromBufferAttribute(r,s),IL.fromBufferAttribute(r,a),kL.fromBufferAttribute(r,o),u.uv1=Qy.getInterpolation(zL,TL,PL,FL,OL,IL,kL,new lv)),n&&(BL.fromBufferAttribute(n,s),RL.fromBufferAttribute(n,a),LL.fromBufferAttribute(n,o),u.normal=Qy.getInterpolation(zL,TL,PL,FL,BL,RL,LL,new Lv),u.normal.dot(e.direction)>0&&u.normal.multiplyScalar(-1));let t={a:s,b:a,c:o,normal:new Lv,materialIndex:0};Qy.getNormal(TL,PL,FL,t.normal),u.face=t,u.faceIndex=s}return u}(n,u,c,h,d,a,o,l,t);return p?(p.faceIndex=i,r&&r.push(p),p):null}function jL(e,t,n,i){let r=e.a,s=e.b,a=e.c,o=t,l=t+1,u=t+2;n&&(o=n.getX(t),l=n.getX(t+1),u=n.getX(t+2)),r.x=i.getX(o),r.y=i.getY(o),r.z=i.getZ(o),s.x=i.getX(l),s.y=i.getY(l),s.z=i.getZ(l),a.x=i.getX(u),a.y=i.getY(u),a.z=i.getZ(u)}function UL(e,t,n,i,r,s,a){let o=n.index,l=n.attributes.position;for(let u=e,c=t+e;u<c;u++)if(jL(a,3*u,o,l),a.needsUpdate=!0,i(a,u,r,s))return!0;return!1}var VL=class{constructor(e){this._getNewPrimitive=e,this._primitives=[]}getPrimitive(){let e=this._primitives;return 0===e.length?this._getNewPrimitive():e.pop()}releasePrimitive(e){this._primitives.push(e)}};function HL(e,t){return 65535===t[e+15]}function WL(e,t){return t[e+6]}function GL(e,t){return t[e+14]}function qL(e){return e+8}function YL(e,t){return t[e+6]}var XL=new jv,QL=new Lv,KL=["x","y","z"];function ZL(e,t,n,i,r){let s=2*e,a=iz,o=rz,l=sz;if(HL(s,o)){!function(e,t,n,i,r,s){for(let a=i,o=i+r;a<o;a++)NL(e,t,n,a,s)}(t,n,i,WL(e,l),GL(s,o),r)}else{let s=qL(e);tz(s,a,i,QL)&&ZL(s,t,n,i,r);let o=YL(e,l);tz(o,a,i,QL)&&ZL(o,t,n,i,r)}}function JL(e,t,n,i){let r=2*e,s=iz,a=rz,o=sz;if(HL(r,a)){return function(e,t,n,i,r){let s=1/0,a=null;for(let o=i,l=i+r;o<l;o++){let i=NL(e,t,n,o);i&&i.distance<s&&(a=i,s=i.distance)}return a}(t,n,i,WL(e,o),GL(r,a))}{let r,a,l=function(e,t){return t[e+7]}(e,o),u=KL[l],c=i.direction[u]>=0;c?(r=qL(e),a=YL(e,o)):(r=YL(e,o),a=qL(e));let h=tz(r,s,i,QL)?JL(r,t,n,i):null;if(h){let e=h.point[u];if(c?e<=s[a+l]:e>=s[a+l+3])return h}let d=tz(a,s,i,QL)?JL(a,t,n,i):null;return h&&d?h.distance<=d.distance?h:d:h||d||null}}var $L=function(){let e,t,n=[],i=new VL((()=>new jv));return function(){e=i.getPrimitive(),t=i.getPrimitive(),n.push(e,t);let s=r(...arguments);i.releasePrimitive(e),i.releasePrimitive(t),n.pop(),n.pop();let a=n.length;return a>0&&(t=n[a-1],e=n[a-2]),s};function r(n,i,s,a){let o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,u=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0;function c(e){let t=2*e,n=rz,i=sz;for(;!HL(t,n);)t=2*(e=qL(e));return WL(e,i)}function h(e){let t=2*e,n=rz,i=sz;for(;!HL(t,n);)t=2*(e=YL(e,i));return WL(e,i)+GL(t,n)}let d=2*n,p=iz,f=rz,m=sz;if(HL(d,f)){let t=WL(n,m),i=GL(d,f);return cL(n,p,e),a(t,i,!1,u,l+n,e)}{let d,g,v,y,x=qL(n),b=YL(n,m),w=x,D=b;if(o&&(v=e,y=t,cL(w,p,v),cL(D,p,y),d=o(v),g=o(y),g<d)){w=b,D=x;let e=d;d=g,g=e,v=y}v||(v=e,cL(w,p,v));let _,S=s(v,HL(2*w,f),d,u+1,l+w);if(2===S){let e=c(w);_=a(e,h(w)-e,!0,u+1,l+w,v)}else _=S&&r(w,i,s,a,o,l,u+1);if(_)return!0;y=t,cL(D,p,y);let E,C=s(y,HL(2*D,f),g,u+1,l+D);if(2===C){let e=c(D);E=a(e,h(D)-e,!0,u+1,l+D,y)}else E=C&&r(D,i,s,a,o,l,u+1);return!!E}}}(),ez=function(){let e=new AL,t=new AL,n=new py,i=new ML,r=new ML;return function s(a,o,l,u){let c=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,h=2*a,d=iz,p=rz,f=sz;if(null===c&&(l.boundingBox||l.computeBoundingBox(),i.set(l.boundingBox.min,l.boundingBox.max,u),c=i),!HL(h,p)){let e=a+8,t=f[a+6];return cL(e,d,XL),!!(c.intersectsBox(XL)&&s(e,o,l,u,c)||(cL(t,d,XL),c.intersectsBox(XL)&&s(t,o,l,u,c)))}{let i=o,s=i.index,c=i.attributes.position,m=l.index,g=l.attributes.position,v=WL(a,f),y=GL(h,p);if(n.copy(u).invert(),l.boundsTree)return cL(a,d,r),r.matrix.copy(n),r.needsUpdate=!0,l.boundsTree.shapecast({intersectsBounds:e=>r.intersectsBox(e),intersectsTriangle:e=>{e.a.applyMatrix4(u),e.b.applyMatrix4(u),e.c.applyMatrix4(u),e.needsUpdate=!0;for(let n=3*v,i=3*(y+v);n<i;n+=3)if(jL(t,n,s,c),t.needsUpdate=!0,e.intersectsTriangle(t))return!0;return!1}});for(let r=3*v,a=y+3*v;r<a;r+=3){jL(e,r,s,c),e.a.applyMatrix4(n),e.b.applyMatrix4(n),e.c.applyMatrix4(n),e.needsUpdate=!0;for(let n=0,i=m.count;n<i;n+=3)if(jL(t,n,m,g),t.needsUpdate=!0,e.intersectsTriangle(t))return!0}}}}();function tz(e,t,n,i){return cL(e,t,XL),n.intersectBox(XL,i)}var nz,iz,rz,sz,az=[];function oz(e){nz&&az.push(nz),nz=e,iz=new Float32Array(e),rz=new Uint16Array(e),sz=new Uint32Array(e)}function lz(){nz=null,iz=null,rz=null,sz=null,az.length&&oz(az.pop())}var uz=Symbol("skip tree generation"),cz=new jv,hz=new jv,dz=new py,pz=new ML,fz=new ML,mz=new Lv,gz=new Lv,vz=new Lv,yz=new Lv,xz=new Lv,bz=new jv,wz=new VL((()=>new AL)),Dz=class{static serialize(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(t.isBufferGeometry)return console.warn("MeshBVH.serialize: The arguments for the function have changed. See documentation for new signature."),Dz.serialize(arguments[0],{cloneBuffers:void 0===arguments[2]||arguments[2]});t=d({cloneBuffers:!0},t);let n,i=e.geometry,r=e._roots,s=i.getIndex();return n=t.cloneBuffers?{roots:r.map((e=>e.slice())),index:s.array.slice()}:{roots:r,index:s.array},n}static deserialize(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if("boolean"==typeof n)return console.warn("MeshBVH.deserialize: The arguments for the function have changed. See documentation for new signature."),Dz.deserialize(arguments[0],arguments[1],{setIndex:void 0===arguments[2]||arguments[2]});n=d({setIndex:!0},n);let{index:i,roots:r}=e,s=new Dz(t,d(d({},n),{},{[uz]:!0}));if(s._roots=r,n.setIndex){let n=t.getIndex();if(null===n){let n=new tx(e.index,1,!1);t.setIndex(n)}else n.array!==i&&(n.array.set(i),n.needsUpdate=!0)}return s}constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!e.isBufferGeometry)throw new Error("MeshBVH: Only BufferGeometries are supported.");if(e.index&&e.index.isInterleavedBufferAttribute)throw new Error("MeshBVH: InterleavedBufferAttribute is not supported for the index attribute.");if(t=Object.assign({strategy:0,maxDepth:40,maxLeafTris:10,verbose:!0,useSharedArrayBuffer:!1,setBoundingBox:!0,onProgress:null,[uz]:!1},t),t.useSharedArrayBuffer&&typeof SharedArrayBuffer>"u")throw new Error("MeshBVH: SharedArrayBuffer is not available.");this._roots=null,t[uz]||(this._roots=function(e,t){let n,i,r,s=wL(e,t),a=[],o=t.useSharedArrayBuffer?SharedArrayBuffer:ArrayBuffer;for(let c=0;c<s.length;c++){let e=s[c],t=new o(32*l(e));n=new Float32Array(t),i=new Uint32Array(t),r=new Uint16Array(t),u(0,e),a.push(t)}return a;function l(e){return e.count?1:1+l(e.left)+l(e.right)}function u(e,t){let s=e/4,a=e/2,o=!!t.count,l=t.boundingData;for(let i=0;i<6;i++)n[s+i]=l[i];if(o){let n=t.offset,o=t.count;return i[s+6]=n,r[a+14]=o,r[a+15]=65535,e+32}{let n,r=t.left,a=t.right,o=t.splitAxis;if(n=u(e+32,r),n/4>Math.pow(2,32))throw new Error("MeshBVH: Cannot store child pointer greater than 32 bits.");return i[s+6]=n/4,n=u(n,a),i[s+7]=o,n}}}(e,t),!e.boundingBox&&t.setBoundingBox&&(e.boundingBox=this.getBoundingBox(new jv))),this.geometry=e}refit(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;e&&Array.isArray(e)&&(e=new Set(e));let t,n,i,r,s=this.geometry,a=s.index.array,o=s.attributes.position,l=0,u=this._roots;for(let h=0,d=u.length;h<d;h++)t=u[h],n=new Uint32Array(t),i=new Uint16Array(t),r=new Float32Array(t),c(0,l),l+=t.byteLength;function c(t,s){let l=arguments.length>2&&void 0!==arguments[2]&&arguments[2],u=2*t;if(65535===i[u+15]){let e=n[t+6],s=1/0,l=1/0,c=1/0,h=-1/0,d=-1/0,p=-1/0;for(let t=3*e,n=3*(e+i[u+14]);t<n;t++){let e=a[t],n=o.getX(e),i=o.getY(e),r=o.getZ(e);n<s&&(s=n),n>h&&(h=n),i<l&&(l=i),i>d&&(d=i),r<c&&(c=r),r>p&&(p=r)}return(r[t+0]!==s||r[t+1]!==l||r[t+2]!==c||r[t+3]!==h||r[t+4]!==d||r[t+5]!==p)&&(r[t+0]=s,r[t+1]=l,r[t+2]=c,r[t+3]=h,r[t+4]=d,r[t+5]=p,!0)}{let i=t+8,a=n[t+6],o=i+s,u=a+s,h=l,d=!1,p=!1;e?h||(d=e.has(o),p=e.has(u),h=!d&&!p):(d=!0,p=!0);let f=h||p,m=!1;(h||d)&&(m=c(i,s,h));let g=!1;f&&(g=c(a,s,h));let v=m||g;if(v)for(let e=0;e<3;e++){let n=i+e,s=a+e,o=r[n],l=r[n+3],u=r[s],c=r[s+3];r[t+e]=o<u?o:u,r[t+e+3]=l>c?l:c}return v}}}traverse(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this._roots[t],i=new Uint32Array(n),r=new Uint16Array(n);!function t(s){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=2*s,l=65535===r[o+15];if(l){let t=i[s+6],u=r[o+14];e(a,l,new Float32Array(n,4*s,6),t,u)}else{let r=s+8,o=i[s+6],u=i[s+7];e(a,l,new Float32Array(n,4*s,6),u)||(t(r,a+1),t(o,a+1))}}(0)}raycast(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this._roots,i=this.geometry,r=[],s=t.isMaterial,a=Array.isArray(t),o=i.groups,l=s?t.side:t;for(let u=0,c=n.length;u<c;u++){let s=a?t[o[u].materialIndex].side:l,c=r.length;if(oz(n[u]),ZL(0,i,s,e,r),lz(),a){let e=o[u].materialIndex;for(let t=c,n=r.length;t<n;t++)r[t].face.materialIndex=e}}return r}raycastFirst(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this._roots,i=this.geometry,r=t.isMaterial,s=Array.isArray(t),a=null,o=i.groups,l=r?t.side:t;for(let u=0,c=n.length;u<c;u++){let r=s?t[o[u].materialIndex].side:l;oz(n[u]);let c=JL(0,i,r,e);lz(),null!=c&&(null==a||c.distance<a.distance)&&(a=c,s&&(c.face.materialIndex=o[u].materialIndex))}return a}intersectsGeometry(e,t){let n=this.geometry,i=!1;for(let r of this._roots)if(oz(r),i=ez(0,n,e,t),lz(),i)break;return i}shapecast(e,t,n){let i=this.geometry;if(e instanceof Function){if(t){let e=t;t=(t,n,i,r)=>{let s=3*n;return e(t,s,s+1,s+2,i,r)}}e={boundsTraverseOrder:n,intersectsBounds:e,intersectsTriangle:t,intersectsRange:null},console.warn("MeshBVH: Shapecast function signature has changed and now takes an object of callbacks as a second argument. See docs for new signature.")}let r=wz.getPrimitive(),{boundsTraverseOrder:s,intersectsBounds:a,intersectsRange:o,intersectsTriangle:l}=e;if(o&&l){let e=o;o=(t,n,s,a,o)=>!!e(t,n,s,a,o)||UL(t,n,i,l,s,a,r)}else o||(o=l?(e,t,n,s)=>UL(e,t,i,l,n,s,r):(e,t,n)=>n);let u=!1,c=0;for(let h of this._roots){if(oz(h),u=$L(0,i,a,o,s,c),lz(),u)break;c+=h.byteLength}return wz.releasePrimitive(r),u}bvhcast(e,t,n){let{intersectsRanges:i,intersectsTriangles:r}=n,s=this.geometry.index,a=this.geometry.attributes.position,o=e.geometry.index,l=e.geometry.attributes.position;dz.copy(t).invert();let u=wz.getPrimitive(),c=wz.getPrimitive();if(r){let e=function(e,n,i,h,d,p,f,m){for(let g=i,v=i+h;g<v;g++){jL(c,3*g,o,l),c.a.applyMatrix4(t),c.b.applyMatrix4(t),c.c.applyMatrix4(t),c.needsUpdate=!0;for(let t=e,i=e+n;t<i;t++)if(jL(u,3*t,s,a),u.needsUpdate=!0,r(u,c,t,g,d,p,f,m))return!0}return!1};if(i){let t=i;i=function(n,i,r,s,a,o,l,u){return!!t(n,i,r,s,a,o,l,u)||e(n,i,r,s,a,o,l,u)}}else i=e}e.getBoundingBox(hz),hz.applyMatrix4(t);let h=this.shapecast({intersectsBounds:e=>hz.intersectsBox(e),intersectsRange:(t,n,r,s,a,o)=>(cz.copy(o),cz.applyMatrix4(dz),e.shapecast({intersectsBounds:e=>cz.intersectsBox(e),intersectsRange:(e,r,o,l,u)=>i(t,n,e,r,s,a,l,u)}))});return wz.releasePrimitive(u),wz.releasePrimitive(c),h}intersectsBox(e,t){return pz.set(e.min,e.max,t),pz.needsUpdate=!0,this.shapecast({intersectsBounds:e=>pz.intersectsBox(e),intersectsTriangle:e=>pz.intersectsTriangle(e)})}intersectsSphere(e){return this.shapecast({intersectsBounds:t=>e.intersectsBox(t),intersectsTriangle:t=>t.intersectsSphere(e)})}closestPointToGeometry(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1/0;e.boundingBox||e.computeBoundingBox(),pz.set(e.boundingBox.min,e.boundingBox.max,t),pz.needsUpdate=!0;let a=this.geometry,o=a.attributes.position,l=a.index,u=e.attributes.position,c=e.index,h=wz.getPrimitive(),d=wz.getPrimitive(),p=gz,f=vz,m=null,g=null;i&&(m=yz,g=xz);let v=1/0,y=null,x=null;return dz.copy(t).invert(),fz.matrix.copy(dz),this.shapecast({boundsTraverseOrder:e=>pz.distanceToBox(e),intersectsBounds:(e,t,n)=>n<v&&n<s&&(t&&(fz.min.copy(e.min),fz.max.copy(e.max),fz.needsUpdate=!0),!0),intersectsRange:(n,i)=>{if(e.boundsTree)return e.boundsTree.shapecast({boundsTraverseOrder:e=>fz.distanceToBox(e),intersectsBounds:(e,t,n)=>n<v&&n<s,intersectsRange:(e,s)=>{for(let a=3*e,b=3*(e+s);a<b;a+=3){jL(d,a,c,u),d.a.applyMatrix4(t),d.b.applyMatrix4(t),d.c.applyMatrix4(t),d.needsUpdate=!0;for(let e=3*n,t=3*(n+i);e<t;e+=3){jL(h,e,l,o),h.needsUpdate=!0;let t=h.distanceToTriangle(d,p,m);if(t<v&&(f.copy(p),g&&g.copy(m),v=t,y=e/3,x=a/3),t<r)return!0}}}});for(let e=0,s=c?c.count:u.count;e<s;e+=3){jL(d,e,c,u),d.a.applyMatrix4(t),d.b.applyMatrix4(t),d.c.applyMatrix4(t),d.needsUpdate=!0;for(let t=3*n,s=3*(n+i);t<s;t+=3){jL(h,t,l,o),h.needsUpdate=!0;let n=h.distanceToTriangle(d,p,m);if(n<v&&(f.copy(p),g&&g.copy(m),v=n,y=t/3,x=e/3),n<r)return!0}}}}),wz.releasePrimitive(h),wz.releasePrimitive(d),v===1/0?null:(n.point?n.point.copy(f):n.point=f.clone(),n.distance=v,n.faceIndex=y,i&&(i.point?i.point.copy(g):i.point=g.clone(),i.point.applyMatrix4(dz),f.applyMatrix4(dz),i.distance=f.sub(i.point).length(),i.faceIndex=x),n)}closestPointToPoint(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1/0,r=n*n,s=i*i,a=1/0,o=null;if(this.shapecast({boundsTraverseOrder:t=>(mz.copy(e).clamp(t.min,t.max),mz.distanceToSquared(e)),intersectsBounds:(e,t,n)=>n<a&&n<s,intersectsTriangle:(t,n)=>{t.closestPointToPoint(e,mz);let i=e.distanceToSquared(mz);return i<a&&(gz.copy(mz),a=i,o=n),i<r}}),a===1/0)return null;let l=Math.sqrt(a);return t.point?t.point.copy(gz):t.point=gz.clone(),t.distance=l,t.faceIndex=o,t}getBoundingBox(e){return e.makeEmpty(),this._roots.forEach((t=>{cL(0,new Float32Array(t),bz),e.union(bz)})),e}},_z=Cm(Mm()),Sz=.5*(Math.sqrt(3)-1),Ez=(3-Math.sqrt(3))/6,Cz=1/3,Az=1/6,Mz=(Math.sqrt(5),Math.sqrt(5),e=>0|Math.floor(e)),Tz=new Float64Array([1,1,-1,1,1,-1,-1,-1,1,0,-1,0,1,0,-1,0,0,1,0,-1,0,1,0,-1]),Pz=new Float64Array([1,1,0,-1,1,0,1,-1,0,-1,-1,0,1,0,1,-1,0,1,1,0,-1,-1,0,-1,0,1,1,0,-1,1,0,1,-1,0,-1,-1]);function Fz(e){let t=new Uint8Array(512);for(let n=0;n<256;n++)t[n]=n;for(let n=0;n<255;n++){let i=n+~~(e()*(256-n)),r=t[n];t[n]=t[i],t[i]=r}for(let n=256;n<512;n++)t[n]=t[n-256];return t}var Oz,Iz=new Qy,kz=class{constructor(e){this.weightAttribute=null;let t=e.geometry;if(!t.isBufferGeometry||3!==t.attributes.position.itemSize)throw new Error("THREE.MeshSurfaceSampler: Requires BufferGeometry triangle mesh.");t.index&&(t=t.toNonIndexed()),this.geometry=t,this.randomFunction=Math.random,this.positionAttribute=this.geometry.getAttribute("position"),this.distribution=null}build(){let e=this.positionAttribute,t=new Float32Array(e.count/3);for(let i=0;i<e.count;i+=3){let n=1;Iz.a.fromBufferAttribute(e,i),Iz.b.fromBufferAttribute(e,i+1),Iz.c.fromBufferAttribute(e,i+2),n*=Iz.getArea(),t[i/3]=n}this.distribution=new Float32Array(e.count/3);let n=0;for(let i=0;i<t.length;i++)n+=t[i],this.distribution[i]=n;return this}setRandomGenerator(e){return this.randomFunction=e,this}sample(e,t){if(this.distribution){let n=this.distribution[this.distribution.length-1],i=this.binarySearch(this.randomFunction()*n);return this.sampleFace(i,e,t)}}binarySearch(e){if(!this.distribution)return 0;let t=this.distribution,n=0,i=t.length-1,r=-1;for(;n<=i;){let s=Math.ceil((n+i)/2);if(0===s||t[s-1]<=e&&t[s]>e){r=s;break}e<t[s]?i=s-1:n=s+1}return r}sampleFace(e,t,n){let i=this.randomFunction(),r=this.randomFunction();return i+r>1&&(i=1-i,r=1-r),Iz.a.fromBufferAttribute(this.positionAttribute,3*e),Iz.b.fromBufferAttribute(this.positionAttribute,3*e+1),Iz.c.fromBufferAttribute(this.positionAttribute,3*e+2),t.set(0,0,0).addScaledVector(Iz.a,i).addScaledVector(Iz.b,r).addScaledVector(Iz.c,1-(i+r)),Iz.getNormal(n),this}},Bz=Cm(Tm()),Rz=new py,Lz=new py,zz=new py;(e=>{e.is=function(e){return e&&e.__isSPEObject}})(Oz||(Oz={}));var Nz,jz=e=>class extends e{constructor(){super(...arguments),this.previousModelViewMatrix=new py,this.copyPreviousMatrix=!0,this.hiddenMatrix=new py,this.matrixWorldRigid=new py,this.shearScale=new py,this.shearScaleInv=new py}get __isSPEObject(){return!0}isDescendantOf(e){e instanceof zy&&(e=e.uuid);let t=this;for(;t.parent;){if(t.parent.uuid===e)return!0;t=t.parent}return!1}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(null===this.parent?this.matrixWorld.multiplyMatrices(this.hiddenMatrix,this.matrix):(this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.hiddenMatrix),this.matrixWorld.multiplyMatrices(this.matrixWorld,this.matrix)),this.matrixWorldNeedsUpdate=!1,e=!0);for(let t of this.children)t.updateMatrixWorld(e)}updateWorldMatrix(e,t){let n=this.parent;if(e&&null!==n&&n.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.multiplyMatrices(this.hiddenMatrix,this.matrix):(this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.hiddenMatrix),this.matrixWorld.multiplyMatrices(this.matrixWorld,this.matrix)),t)for(let i of this.children)i.updateWorldMatrix(!1,!0)}traverseChildren(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;for(let n of this.children)Oz.is(n)&&n.traverseObject(e,t+1)}traverseObject(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(!0!==e(this,t))for(let n of this.children)Oz.is(n)&&n.traverseObject(e,t+1)}updateMatrixWorldSVD(){let e=this.matrixWorld.elements,t=[[e[0],e[4],e[8]],[e[1],e[5],e[9]],[e[2],e[6],e[10]]],{u:n,v:i,q:r}=(0,Bz.SVD)(t),s=Rz.set(n[0][0],n[0][1],n[0][2],0,n[1][0],n[1][1],n[1][2],0,n[2][0],n[2][1],n[2][2],0,0,0,0,1),a=Lz.set(i[0][0],i[0][1],i[0][2],0,i[1][0],i[1][1],i[1][2],0,i[2][0],i[2][1],i[2][2],0,0,0,0,1),o=zz.copy(a).transpose();this.shearScale.makeScale(r[0],r[1],r[2]).multiply(o).premultiply(a),this.shearScaleInv.copy(this.shearScale).invert(),this.matrixWorldRigid.multiplyMatrices(s,o).copyPosition(this.matrixWorld),r.every((e=>Math.abs(r[0]-e)<.01))?this.hasNonUniformScale=!1:this.hasNonUniformScale=!0}attach(e,t){this.updateWorldMatrix(!0,!1);let n=(new py).copy(this.matrixWorld).invert();return null!==e.parent&&(e.parent.updateWorldMatrix(!0,!1),n.multiply(e.parent.matrixWorld)),"hiddenMatrix"in e&&e.hiddenMatrix instanceof py?e.hiddenMatrix.premultiply(n):e.applyMatrix4(n),e.updateWorldMatrix(!1,!1),this.add(e),void 0!==t&&(this.children.pop(),this.children.splice(t,0,e)),this}copy(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return super.copy(e,t),this.hasNonUniformScale=e.hasNonUniformScale,this}onAfterRender(e,t,n,i,r,s){this.copyPreviousMatrix&&this.previousModelViewMatrix.copy(this.modelViewMatrix)}},Uz=class extends(jz(zy)){},Vz=class extends Uz{constructor(e){super(),this.object=e,this.matrixAutoUpdate=!1,this.hasNonUniformScale=e.hasNonUniformScale}raycast(e,t){}expand(){let e=0,t=this.object.entityChildren(e);for(;t;){var n;let i=this.children[e];(null===(n=i)||void 0===n?void 0:n.object)!==t&&(i&&this.remove(i),i=new Vz(t),this.add(i),this.children.splice(e,0,this.children.pop()),i.matrixWorldNeedsUpdate=!0,i.matrixAutoUpdate=!1,i.matrix=t.matrix,i.hiddenMatrix=t.hiddenMatrix),i.expand(),e+=1,t=this.object.entityChildren(e)}for(;this.children.length>e;)this.remove(this.children[e])}get visible(){var e;return void 0!==this.playModeVisible?this.playModeVisible:this.object.visible||this.object.dataPatched.visible&&!0===(null===(e=this.object.dataPatched.cloner)||void 0===e?void 0:e.hideBase)}set visible(e){}get castShadow(){return this.object.castShadow}set castShadow(e){}get receiveShadow(){return this.object.receiveShadow}set receiveShadow(e){}get isMesh(){return(e=>"Mesh"===e.type)(this.object)}get isLight(){return this.object.isLight}get layers(){return this.object.layers}set layers(e){}get isCamera(){return!1}get geometry(){if(this.object.geometry)return this.object.geometry}get material(){if(this.object.material)return this.object.material}},Hz=new Lv,Wz=new Lv,Gz=new py,qz=[new Lv(-1,1,1),new Lv(-1,-1,1),new Lv(1,-1,1),new Lv(1,1,1),new Lv(-1,1,-1),new Lv(-1,-1,-1),new Lv(1,-1,-1),new Lv(1,1,-1)],Yz=[[0,3],[1,2],[5,6],[4,7],[0,1],[3,2],[7,6],[4,5],[0,4],[1,5],[2,6],[3,7]],Xz=[[0,2],[7,5],[4,1],[3,6],[4,3],[1,6]],Qz=(e,t,n)=>{e.updateEntityBoxSize(Hz,Wz),Gz.copy(t).multiply(e.matrixWorld),0===Wz.x&&0===Wz.y&&0===Wz.z?n.push(new Lv(Hz.x,Hz.y,Hz.z).applyMatrix4(Gz)):qz.forEach((e=>{n.push(e.clone().multiply(Wz).add(Hz).applyMatrix4(Gz))}))},Kz=class extends jv{constructor(){super(...arguments),this.matrix=new py,this.vertices=[],this.faces=[],this.edges=[],this.centerEdges=[]}copy(e){return super.copy(e),this.matrix.copy(e.matrix),this.vertices=e.vertices.map((e=>e.clone())),this.faces=e.faces.map((e=>e.clone())),this.edges=e.edges.map((e=>e.clone())),this.centerEdges=e.centerEdges.map((e=>e.clone())),this}setFromObjectSize(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];e.updateWorldMatrix(!1,t),this.makeEmpty(),this.matrix.copy(e.matrixWorld);let n=(new py).copy(e.matrixWorld).invert();return this.expandByObjectSize(e,n,t)}expandByObjectSize(e,t){let n=[];return!0===(arguments.length>2&&void 0!==arguments[2]&&arguments[2])?e.traverseEntity((e=>{if(e.visible||e.cloner&&e.data.visible){if(!("geometry"in e))return void n.push(new Lv);Qz(e,t,n)}})):Qz(e,t,n),this.setFromPoints(n)}getCenter(e){return(e=super.getCenter(e)).applyMatrix4(this.matrix),e}getPositionToCenter(e){return(e=super.getCenter(e)).applyMatrix4(Gz.copy(this.matrix).setPosition(0,0,0)),e}computeVertices(){this.getSize(Wz).multiplyScalar(.5),this.getCenter(Hz),Gz.copy(this.matrix).setPosition(Hz),this.vertices=qz.map((e=>e.clone().multiply(Wz).applyMatrix4(Gz)))}computeEdges(){this.vertices.length>0&&this.computeVertices(),this.edges=Yz.map((e=>{let[t,n]=e;return new DE(this.vertices[t],this.vertices[n])})),this.centerEdges=this.edges.map((e=>e.getCenter(new Lv)))}computeFaces(){this.vertices.length>0&&this.computeVertices(),this.faces=Xz.map((e=>{let[t,n]=e;return this.vertices[t].clone().add(this.vertices[n]).multiplyScalar(.5)}))}},Zz={Cloner:()=>{},changeEntityProptotype:()=>{},createEntity:()=>{}},Jz=class extends v_{constructor(){super()}getPoints(){let e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:12,n=[],i=this.getCurveLengths(),r=i[i.length-1]/i.length;for(let s=0,a=this.curves;s<a.length;s++){let o=a[s],l=0===s?i[s]:i[s]-i[s-1],u=Math.ceil(t*l/r),c=o.getPoints(u);for(let t=0;t<c.length;t++){let i=c[t];e&&e.equals(i)||(n.push(i),e=i)}}return this.autoClose&&n.length>1&&!n[n.length-1].equals(n[0])&&n.push(n[0]),n}},$z=.001;function eN(e,t,n){return t.clone().sub(e).cross(t.clone().sub(n)).length()<=$z}function tN(e,t){let n=new Lv(...e.position),i=new Lv(...e.controlNext.position),r=new Lv(...t.controlPrevious.position),s=new Lv(...t.position);return eN(n,i,s)&&eN(n,r,s)}function nN(e){let t=e.points.map((e=>new Lv(...e.data.position))),n=[e.points[0]],i=new Lv(...n[0].data.position);for(let c=0;c<e.points.length-1;c++)eN(i,t[c],t[c+1])||(n.push(e.points[c]),i=t[c]);n.push(e.points[e.points.length-1]);let r=e.isClosed,s=n.length-(r?0:1),a=n.length,o=[];for(let c=0;c<a;c++){let t=n[c].data,i=new Lv(...t.position),s=new Lv(...t.controlPrevious.position),l=new Lv(...t.controlNext.position),u={position:i,baseRoundness:t.roundness,controlPrevious:s,controlNext:l};if(0===t.roundness||!e.isClosed&&(0===c||c===a-1)){o[c]=d(d({},u),{},{removedLength:0});continue}let h=r&&c==a-1?0:c+1,p=n[r&&0==c?a-1:c-1].data,f=n[h].data,m=new Lv(...p.position),g=new Lv(...f.position),v=m.clone().sub(i).normalize(),y=g.clone().sub(i).normalize();Object.assign(u,{prevDir:v,nextDir:y});let x=tN(p,t),b=tN(t,f);if(x&&b){let e=v.clone().add(y).normalize(),n=e.clone().cross(v).length()/v.dot(e);o[c]=d(d({},u),{},{tan:n,removedLength:t.roundness/n})}else o[c]=d(d({},u),{},{removedLength:0})}for(let c=0;c<s;c++){let e=r&&c===a-1?0:c+1,t=o[c],n=o[e];if(0!==t.removedLength||0!==n.removedLength){let e=t.position.distanceTo(n.position);t.removedLength=Math.min(t.removedLength,e/2),n.removedLength=Math.min(n.removedLength,e/2)}}let l=[];for(let c=0;c<s;c++){let e=c,t=r&&c===a-1?0:c+1,i=o[e],s=o[t],u=null;if(tN(n[e].data,n[t].data)){let e=i.position.clone(),t=s.position.clone();(0!==i.removedLength||0!==s.removedLength)&&(i.nextDir&&e.add(i.nextDir.clone().setLength(i.removedLength)),s.prevDir&&t.add(s.prevDir.clone().setLength(s.removedLength))),e.distanceTo(t)>$z&&(u=new h_(e,e.clone().lerp(t,.3),t.clone().lerp(e,.3),t))}else i.position.distanceTo(s.position)>$z&&(u=new h_(i.position,i.controlNext,s.controlPrevious,s.position));l[2*c+1]=u}for(let c=0;c<a;c++){let e=o[c];if(0===e.removedLength){l[2*c]=null;continue}let t=e.position,n=e.prevDir.clone().multiplyScalar(e.removedLength).add(t),i=e.nextDir.clone().multiplyScalar(e.removedLength).add(t),r=e.tan*e.removedLength,s=e.prevDir.clone().add(e.nextDir).normalize(),a=n.clone().lerp(i,.5),u=n.distanceTo(i)/2,h=s.clone().multiplyScalar(Math.sqrt(Math.pow(r,2)-Math.pow(u,2))).add(a),d=s.clone().multiplyScalar(-r).add(h),p=t.distanceTo(d)/t.distanceTo(a),f=e.prevDir.clone().multiplyScalar(p*t.distanceTo(n)).add(t),m=f.clone().lerp(d,2),g=n.clone().lerp(f,4/3),v=i.clone().lerp(m,4/3);l[2*c]=new h_(n,g,v,i)}let u=new Jz;return l.forEach((e=>{e&&u.add(e)})),u}(e=>{e.is=function(e){return e&&e.__isEntity}})(Nz||(Nz={}));var iN=e=>Nz.is(e),rN={type:"completeState",isfromEntity:!0},sN=["x","y","z"],aN=new Lv,oN=(new Lv).set(0,1,0),lN=e=>class extends(jz(e)){constructor(){super(...arguments),this.raycastLock=!1,this.scaleLock=!1,this.disposed=!1,this.stateSelection=null,this.destroyedInAction=!1,this.instances=[],this.prevState=null,this.currentState=null,this.reversibleToState=null,this.currentTransitionEvent=null,this.previousAction=null,this._singleBBox=new Kz,this._recursiveBBox=new Kz,this.singleBBoxNeedsUpdate=!0,this.recursiveBBoxNeedsUpdate=!0,this._needApplyPathSnapping=!0,this.attachedPaths=new Set}get __isEntity(){return!0}entityChildren(e){let t=this.children[e];if(Nz.is(t))return t}entityChildrenCount(){let e=this.children.length;for(;e--;)if(Nz.is(this.children[e]))return e+1;return 0}get isConcreteEntity(){return"string"==typeof this.identity}get isVirtualEntity(){return"string"!=typeof this.identity}get isInstanceRoot(){return this.isConcreteEntity&&"Instance"===this.data.type}nearestInstanceSelfOrParent(){let e=this;for(;"Instance"!==e.data.type;){let t=e.parent;if(!Nz.is(t))return;e=t}return e}forInstancesRec(e){this.instances.forEach((t=>{t.disposed||e(t),t.forInstancesRec(e)}))}super_Entity(e,t){"string"==typeof e&&(this.uuid=e),this.identity=e,this.data=t,this.matrixAutoUpdate=!1,this.dataPatched=this.data}changeSelectedState(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(0!==this.data.states.length||n){for(let e of this.data.states)$B.toOps(this.data,e.data).forEach((e=>{let n=lO.replaceProps(e,this.data);this.dataPatched=this.data,this.updateByPatchedOp(n,this.data,t)}));if(null!==e){let n=this.data.states.data(e);n&&(this.dataPatched=$B.patch(this.data,n),$B.toOps(this.data,n).forEach((e=>{this.updateByPatchedOp(e,this.dataPatched,t)})))}n&&this.updateTransformState(this.dataPatched,t),this.stateSelection=e,this.updatePathSnapping(this.dataPatched.pathSnapping)}}get singleBBox(){return this.singleBBoxNeedsUpdate&&(this.singleBBoxNeedsUpdate=!1,this._singleBBox.setFromObjectSize(this,!1),this._singleBBox.computeVertices(),this._singleBBox.computeEdges(),this._singleBBox.computeFaces()),this._singleBBox}get recursiveBBox(){return this.recursiveBBoxNeedsUpdate&&(this.recursiveBBoxNeedsUpdate=!1,this._recursiveBBox.setFromObjectSize(this,!0),this._recursiveBBox.computeVertices(),this._recursiveBBox.computeEdges(),this._recursiveBBox.computeFaces()),this._recursiveBBox}updateEntityBoxSize(e,t){e.setScalar(0),t.setScalar(0)}resetBBoxNeedsUpdateSelf(){this.singleBBoxNeedsUpdate=!0,this.recursiveBBoxNeedsUpdate=!0}resetBBoxNeedsUpdate(){this.resetBBoxNeedsUpdateSelf(),this.traverseAncestors((e=>{iN(e)&&e.resetBBoxNeedsUpdateSelf()})),this.traverseEntity((e=>{e.resetBBoxNeedsUpdateSelf()}))}find(e){let t;return this.traverseEntity((n=>{n.uuid===e&&(t=n)})),t}traverseSortNextHelper(){let e=this.parent;if(e){let t=e.children,n=t.indexOf(this)+1;if(Nz.is(t[n]))return t[n];if(Nz.is(e))return e.traverseSortNextHelper()}}sortNext(){let e=this.children;return this.children.length>0&&Nz.is(this.children[0])?e[0]:this.traverseSortNextHelper()}goUp(e){let t=this;for(;e>0&&null!==t;)t=t.parent,e-=1;return t}hasAnccestorOrSelf(e){return this===e||this.hasAnccestor(e)}hasAnccestor(e){let t=this.parent;for(;t;){if(e===t)return!0;t=t.parent}return!1}countToAccestor(e){let t=0,n=this;for(;n!==e;){if(null===n)return-1;n=n.parent,t+=1}return t}forEachEntity(e){for(let t of this.children)iN(t)&&e(t)}traverseEntityAncestors(e){this.traverseAncestors((t=>{Nz.is(t)&&e(t)}))}traverseConcreteEntity(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(!0!==e(this,t))for(let n of this.children)iN(n)&&n.isConcreteEntity&&n.traverseEntity(e,t+1)}traverseEntity(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(!0!==e(this,t))for(let n of this.children)iN(n)&&n.traverseEntity(e,t+1)}traverseVisibleEntity(e){e(this);for(let t of this.children)iN(t)&&t.visible&&t.traverseVisibleEntity(e)}updateMatrix(){super.updateMatrix(),this.cloner&&this.cloner.onObjUpdateMatrix(),this.dispatchEvent({type:"updateMatrix"})}updateMatrixWorld(e){super.updateMatrixWorld(e),this.dispatchEvent({type:"updateMatrixWorld"})}copy(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return super.copy(e,t),this.dataPatched=e.dataPatched,this.raycastLock=e.raycastLock,this.scaleLock=e.scaleLock,this.hiddenMatrix.copy(e.hiddenMatrix),this}hasEntityChild(){return this.children.some((e=>iN(e)))}isAncestorOf(e){if(this.uuid===e)return!1;let t=!1;return this.traverseEntity((n=>{n.uuid===e&&(t=!0)})),t}toObjectTransformState(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.updateWorldMatrix(!0,!1);let t={position:this.position.toArray(),rotation:[this.rotation.x*ov.RAD2DEG,this.rotation.y*ov.RAD2DEG,this.rotation.z*ov.RAD2DEG],scale:this.scale.toArray(),hiddenMatrix:this.hiddenMatrix.toArray()};return pF(t,e)}getTransformValues(e,t,n){return t[e].map(((t,i)=>{var r;return null!==(r=null===n||void 0===n?void 0:n.shared.getVariable(t,[this.uuid,e,sN[i]]))&&void 0!==r?r:t}))}updateTransformState(e,t){var n;let i=!1;return e.position&&(this.position.fromArray(this.getTransformValues("position",e,t)),i=!0),e.rotation&&(aN.fromArray(this.getTransformValues("rotation",e,t)).multiplyScalar(ov.DEG2RAD),this.rotation.setFromVector3(aN),i=!0),e.scale&&(this.scale.fromArray(this.getTransformValues("scale",e,t)),i=!0),void 0!==e.hiddenMatrix&&(i=!0,this.hiddenMatrix.fromArray(null!==(n=e.hiddenMatrix)&&void 0!==n?n:Nk.identity)),i&&(this.updateMatrix(),this.resetBBoxNeedsUpdate(),this.invalidateClonerTransform(this),this.traverseEntityAncestors((e=>{e.invalidateClonerTransform(this)}))),e.position&&e.rotation&&e.scale&&void 0!==e.hiddenMatrix&&this.updateWorldMatrix(!1,!0),i}onVariableUpdate(){arguments.length>0&&void 0!==arguments[0]&&arguments[0]?this.resetBBoxNeedsUpdate():(this.updateMatrix(),this.resetBBoxNeedsUpdate(),this.invalidateClonerTransform(this),this.traverseEntityAncestors((e=>{e.invalidateClonerTransform(this)})))}dispose(){this.disposed=!0,this.cloner&&(this.cloner.removeFromParent(),this.cloner=void 0)}disposeChildrenRecursively(){for(let e of this.children)Nz.is(e)&&e.disposeRecursively()}disposeRecursively(){this.dispose(),this.children.forEach((e=>{Nz.is(e)&&e.disposeRecursively()}))}toState(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=d({name:this.name,visible:this.visible,raycastLock:this.raycastLock},this.toObjectTransformState(e));return pF(t,e)}updateByObjUpdateOp(e,t){void 0!==e&&this.updateByOp({type:0,props:e,path:[]},d(d({},this.data),e),t,!1)}updateByOp(e,t,n,i){let r=this.data;this.data=t;let s=e,a=zO(e.path,["states","*"]);if(null!==a){if(0===e.type){let[t]=a;if((null===this||void 0===this?void 0:this.stateSelection)===t){let t=d({},e.props);if(delete t.name,Object.values(e.props).some((e=>void 0===e))){let n=this.data;if(void 0!==n){let i=OO.zoom(n,e.path.slice(2));if(i)for(let n in e.props)void 0===e.props[n]&&n in i&&(t[n]=i[n])}}s=d(d({},e),{},{props:t,path:e.path.slice(2)})}}}else if(0===e.type){let t=this.stateSelection?this.data.states.data(this.stateSelection):void 0;if(void 0!==t){if(void 0!==e.props.name&&t.name){let{name:e}=t;t=o(t,mm)}if(void 0!==e.props.material&&"material"in t){let{material:e}=t;t=o(t,gm)}let n=OO.removeOverridden(e.path,e.props,t);s=d(d({},e),{},{props:n})}}if(this.updateByPatchedOpBase(s,$B.patch(this.data,this.stateSelection?this.data.states.data(this.stateSelection):void 0),n),zO(e.path,["overrides"])){let i=[],r=[...e.path];for(i.push(r[1]),r.splice(0,2);r.length>0&&"descendants"===r[0];)i.push(r[1]),r.splice(0,2);if(void 0===i[i.length-1]){if(0===e.type)for(let t of Object.keys(e.props)){i[i.length-1]=t;let r=n.scene.findInstance([this.uuid,...i]);r&&(r.overrideData=e.props[t],r.updateState(oO.apply(r.component.data,r.overrideData),n))}}else{let s=n.scene.findInstance([this.uuid,...i]);if(s){let a=OO.zoom(s.component.data,r);if(0===(e=d(d({},e),{},{path:r})).type){let t=e.props;if(a)for(let[n,i]of Object.entries(e.props))void 0===i&&(t===e.props&&(t=d({},e.props)),t[n]=a[n]);e=d(d({},e),{},{props:t})}s.overrideData=QB.resolve(t.overrides,i),s.updateByOp(e,uO.applySimple(s.data,e),n,!1)}}}else if(this.instances.length>0){let i;if(0===e.path.length&&0===e.type){let t;for(let n of KB.rootOverrideProps)n in e.props&&(void 0===t&&(t={}),t[n]=e.props[n]);t&&(i=d(d({},e),{},{props:t}))}else for(let t of KB.rootOverrideProps)if(zO(e.path,[t])){i=e;break}void 0!==i&&this.instances.forEach((e=>{if(e.isInstanceRoot){let t=oO.filterOp(e.overrideData,i);t&&e.updateByOp(t,uO.applySimple(e.data,t),n,!0)}})),this.instances.forEach((i=>{if(!i.isInstanceRoot){let s=oO.filterOp(i.overrideData,e);if(s){let a;a=r===i.data&&e===s?t:uO.applySimple(i.data,s),i.updateByOp(s,a,n,!0)}}}))}}updateByPatchedOpBase(e,t,n){if(this.dataPatched=t,0===e.path.length&&0===e.type)void 0!==e.props.type&&!qk.is(e.props.type)&&Zz.changeEntityProptotype(this,t,n);else if(1===e.path.length&&"geometry"===e.path[0]&&0===e.type&&"type"in e.props){Zz.changeEntityProptotype(this,t,n);for(let e of this.children)Nz.is(e)&&e.updateVisible(n.scene)}this.updateByPatchedOp(e,t,n)}updateByPatchedOp(e,t,n){if(0===e.path.length&&0===e.type?this.updateState(e.props,n):0===e.type&&("resolutionLevel"in e.props||"useChildrenColors"in e.props)&&this.updateState(t,n),"morphTargetInfluences"===e.path[0]&&0===e.type){var i;let r=null===(i=t.morphTargetInfluences.get(e.path[1]))||void 0===i?void 0:i.data.name;r&&this.updateMorphInfluences(r,n.shared.getVariable(e.props.value,[this.uuid,"morphTargetInfluences",r]))}if(null!==zO(e.path,["pathSnapping"])&&this.updatePathSnapping(t.pathSnapping),null!==zO(e.path,["cloner"])){let i=uO.drop(e,1);0===i.path.length&&0===i.type&&!0===i.props.disabled?this.setFromClonerState(null,n):this.cloner?this.cloner.updateState(t.cloner,n.scene):(this.setFromClonerState(t.cloner,n),this.expandCloner(n.scene)),this.updateVisible(n.scene)}}updatePathSnapping(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.dataPatched.pathSnapping;this._updatedPathSnapping=e,this._needApplyPathSnapping=!0}get updatedPathSnapping(){return this._updatedPathSnapping}applyPathSnapping(e){var t,n,i,r,s,a,o,l,u,c,h;let p=null!==(t=null===(n=this._updatedPathSnapping)||void 0===n?void 0:n.pathId)&&void 0!==t?t:this.dataPatched.pathSnapping.pathId,f=null!==(i=null!==(r=null===(s=this._updatedPathSnapping)||void 0===s?void 0:s.slide)&&void 0!==r?r:this.dataPatched.pathSnapping.slide)&&void 0!==i?i:0,m=null!==(a=null!==(o=null===(l=this._updatedPathSnapping)||void 0===l?void 0:l.offset)&&void 0!==o?o:this.dataPatched.pathSnapping.offset)&&void 0!==a?a:0,g=null!==(u=null===(c=this._updatedPathSnapping)||void 0===c?void 0:c.orientation)&&void 0!==u?u:this.dataPatched.pathSnapping.orientation;if(null===p)return;let v=e.find(p);if(!v||!1===this._needApplyPathSnapping)return;this._needApplyPathSnapping=!1;let y=v.data;if(y.geometry.path.points.length<=1)return;let x=nN(y.geometry.path),b=(f+m)%1;f+m===1&&0===b&&(b=1);let w=null;try{w=x.curves.length?x.getPointAt(b):null}catch(E){}if(null===w)return;let D=this.parent?null===(h=this.parent)||void 0===h?void 0:h.matrixWorld:new py;v.updateMatrixWorld();let _=(new py).multiplyMatrices(D.clone().invert(),v.matrixWorld);w.applyMatrix4(_);let S={position:w.toArray(),rotation:y.rotation};if("tangential"===g){let e=(new py).extractRotation(v.matrixWorld),t=x.getTangentAt(b).applyMatrix4(e).add(w),n=(new py).lookAt(w,t,oN),i=aN.setFromEuler((new _y).setFromRotationMatrix(n)).multiplyScalar(ov.RAD2DEG);S=d(d({},S),{},{rotation:i.toArray()})}this.updateTransformState(S),this.traverseEntity((e=>{e._cameraType&&e.dispatchEvent(rN)}))}updateVisible(e){var t,n;if(this.visible=this.dataPatched.visible&&(!this.dataPatched.cloner||null!==(t=this.dataPatched.cloner.disabled)&&void 0!==t&&t||!0!==(null===(n=this.dataPatched.cloner)||void 0===n?void 0:n.hideBase)),!e)return;let i=!1;this.traverseEntity((e=>{if("Splat"===e.data.type)return i=!0,!0})),i&&e.reloadSplats()}updateState_Entity(e,t){void 0!==e.name&&(this.name=e.name),void 0!==e.raycastLock&&(this.raycastLock=e.raycastLock),void 0!==e.visible&&(this.updateVisible(null===t||void 0===t?void 0:t.scene),this.resetBBoxNeedsUpdate()),t&&"cloner"in e&&void 0!==e.cloner&&(this.setFromClonerState(e.cloner,t),this.updateVisible(t.scene)),this.updateTransformState(e,t)}get attachedSurfaceCloners(){return this.children.filter((e=>e instanceof Zz.Cloner&&"toObject"===e.parameters.type))}setFromClonerState(e,t){this.disposed||(null===e||e.disabled?(this.cloner&&this.cloner.removeFromParent(),this.cloner=void 0):void 0===this.cloner?(this.cloner=new Zz.Cloner(this,e),t.scene.addPendingExpandCloner(this)):this.cloner.updateState(e,t.scene))}expandCloner(e){!this.disposed&&this.cloner&&this.cloner.expandClones(e)}invalidateClonerTransform(e){this.cloner&&this.cloner.invalidateTransform(e)}requestRender(){this.dispatchEvent({type:"requestRender"})}},uN=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){var n,i,r,s,a,o,l;let u=null===(n=e.parameters)||void 0===n?void 0:n.radiusTop,c=null===(i=e.parameters)||void 0===i?void 0:i.radiusBottom,h=Object.assign({},null!==(r=null===t||void 0===t?void 0:t.parameters)&&void 0!==r?r:{width:100,radialSegments:64,heightSegments:1,openEnded:!1,thetaStart:0,thetaLength:360,cornerRadius:8,cornerSegments:8,hollow:0},e.parameters);h.thetaLength=ov.clamp(h.thetaLength,0,360);let d=h.width/2,p=null!==(s=h.radiusTop)&&void 0!==s?s:d,f=null!==(a=h.radiusBottom)&&void 0!==a?a:d;if(p===f?(p=d,f=d):p>f?(p=d,f=f*d/p):(p=p*d/f,f=d),h.shapeBlendNode){p=null!==u&&void 0!==u?u:d,f=null!==c&&void 0!==c?c:d;let e=2*Math.max(p,f);h.width=e,h.depth=e}return{parameters:Object.assign(h,{width:Math.abs(h.width),height:Math.abs(null!==(o=h.height)&&void 0!==o?o:h.width),depth:Math.abs(null!==(l=h.depth)&&void 0!==l?l:h.width),radiusTop:p,radiusBottom:f})}}static build(e){let t,{width:n,depth:i,height:r,radialSegments:s,heightSegments:a,openEnded:o,thetaStart:l,thetaLength:u,radiusTop:c,radiusBottom:h,cornerRadius:p,cornerSegments:f,hollow:m}=e.parameters;return 0===u?(t=new dx,t.setAttribute("position",new rx([],3))):t=p||m?new dN(c,h,r,s,a,o,l,u*Math.PI/180,p,p,f,m):new b_(c,h,r,s,a,o,l,u*Math.PI/180),t.scale(1,1,i/n),Object.assign(t,{userData:d(d({},e),{},{type:"CylinderGeometry"})})}};function cN(e,t,n){n.x=e.x*t.x,n.y=e.y,n.z=e.x*t.y}function hN(e){return new lv(e.y,-e.x)}var dN=class extends dx{constructor(e,t,n,i,r,s,a,o,l,u,c,h){let d=arguments.length>12&&void 0!==arguments[12]&&arguments[12];super(),this.type="RoundedCylinderBufferGeometry",e=void 0!==e?e:1,t=void 0!==t?t:1,n=n||1,i=Math.floor(i)||8,r=Math.floor(r)||1,s=void 0!==s&&s,a=void 0!==a?a:0,o=void 0!==o?o:2*Math.PI,s&&(l=0,u=0);let p=[],f=[],m=[],g=[],v=0,y=n/2,x=new Lv,b=new Lv;d&&0==e&&(e=l),d&&0==t&&(t=u);let w=new lv(e,y),D=new lv(t,-y),_=null,S=null,E=null,C=null,A=w.clone().sub(D),M=0,T=0,P=0;h>0&&(M=Math.min(e,t)*(1-h),T=e-M,P=t-M);let F=w.clone();F.x-=M;let O=Math.PI-A.angle(),I=A.angle(),k=Math.tan(I/2),B=Math.tan(O/2),R=k+B,L=h?R:B,z=h?R:k;if(l=Math.min(l,(e-T)/L,A.length()/R),u=Math.min(u,(t-P)/z,A.length()/R),l>0){let e=l/k;_=w.clone().sub(new lv(e,l)),h&&(E=_.clone(),E.x-=M-R*l),w.sub(A.clone().setLength(e))}if(u>0){let e=u/B;S=D.clone().sub(new lv(e,-u)),D.add(A.clone().setLength(e)),h&&(C=S.clone(),C.x-=M-R*u,F.sub(A.clone().setLength(e)))}A=w.clone().sub(D);let N=A.length()<.5,j=[];for(let W=0;W<=i;W++){let c=[],d=W/i,p=d*o+a,y=new lv(Math.sin(p),Math.cos(p));if(C&&S?(U(c,d,y,O,u,C,-1,!0),U(c,d,y,I,u,S,-1,!1)):S?(V(c,y,S.x,0,-1),U(c,d,y,I,u,S,-1,!1)):s||V(c,y,t,P,-1),cN(hN(A).normalize(),y,x),!N)for(let e=0;e<=r;e++){let t=e/r;cN(A.clone().multiplyScalar(t).add(D),y,b),f.push(b.x,b.y,b.z),m.push(x.x,x.y,x.z),g.push(d,.5+b.y/n),c.push(v++)}if(E&&_?(U(c,d,y,O,l,_,1,!1),U(c,d,y,I,l,E,1,!0)):_?(U(c,d,y,O,l,_,1,!1),V(c,y,_.x,0,1)):s||V(c,y,e,T,1),h&&!N){cN(hN(A).multiplyScalar(-1).normalize(),y,x);for(let e=0;e<=r;e++){let t=e/r;cN(A.clone().multiplyScalar(-t).add(F),y,b),f.push(b.x,b.y,b.z),m.push(x.x,x.y,x.z),g.push(d,.5+b.y/n),c.push(v++)}}h&&!s&&c.push(c[0]),j.push(c)}for(let W=0;W<j.length-1;W++)for(let e=0;e<j[0].length-1;e++){if(s&&h&&e==r)continue;let t=j[W][e],n=j[W+1][e],i=j[W+1][e+1],a=j[W][e+1],o=f[3*i+0],l=f[3*i+2];p.push(t,n,a),(0!=o||0!=l)&&p.push(n,i,a)}function U(e,t,i,r,s,a,o,l){for(let u=0;u<c+1;u++){let h=u/c,d=o<0?h:1-h;l&&(d-=1),d*=r;let p=new lv(Math.sin(d),Math.cos(d)*o);cN(p.clone().multiplyScalar(s).add(a),i,b),f.push(b.x,b.y,b.z),cN(p,i,x),m.push(x.x,x.y,x.z),g.push(t,.5+b.y/n),e.push(v++)}}function V(e,t,n,i,r){let s=new Lv,a=new lv,o=[n,i];r<0&&o.reverse();for(let l of o)a.set(l,y*r),cN(a,t,s),f.push(s.x,s.y,s.z),m.push(0,r,0),g.push(.5,.5),e.push(v++)}function H(n,i,r){let s=new lv(Math.sin(r),Math.cos(r)),a=new lv(-Math.cos(r),Math.sin(r)),o=new Lv,l=n<0?(e,t,n)=>p.push(e,t,n):(e,t,n)=>p.push(e,n,t);cN(new lv((e+t+T+P)/4,0),s,o),f.push(o.x,o.y,o.z),m.push(a.x,0,a.y),g.push(.5,.5);let u=v++;for(let e of i){let t=f.slice(3*e,3*e+3);f.push(...t),m.push(a.x,0,a.y);let n=g.slice(2*e,2*e+2);g.push(...n),v++}for(let e=u+1;e<v-1;e++)l(u,e,e+1);l(u,v-1,u+1)}o<2*Math.PI&&(H(-1,j[0],a),H(1,j[j.length-1],a+o)),this.setIndex(p),this.setAttribute("position",new rx(f,3)),this.setAttribute("normal",new rx(m,3)),this.setAttribute("uv",new rx(g,2))}},pN=Math.PI/2,fN=class extends dx{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:4;super(),this.type="BoxGeometry",i=Math.floor(i),r=Math.floor(r),s=Math.floor(s),o=Math.floor(o),a=Math.min(a,e/2,t/2,n/2);let l=[],u=[],c=[],h=[],d=0;function p(e,t,n,i,r,s,o,p,f,m){let g=(s-2*a)/f,v=(o-2*a)/m,y=s/2-a,x=o/2-a,b=p/2,w=f+1,D=m+1,_=0,S=new Lv;for(let a=0;a<D;a++){let s=a*v-x;for(let o=0;o<w;o++){let l=o*g-y;S[e]=l*i,S[t]=s*r,S[n]=b,u.push(S.x,S.y,S.z),S[e]=0,S[t]=0,S[n]=p>0?1:-1,c.push(S.x,S.y,S.z),h.push(o/f),h.push(1-a/m),_+=1}}for(let a=0;a<m;a++)for(let e=0;e<f;e++){let t=d+e+w*a,n=d+e+w*(a+1),i=d+(e+1)+w*(a+1),r=d+(e+1)+w*a;l.push(t,n,r),l.push(n,i,r)}d+=_}function f(e,t,n,i,r,s,p,f,m,g){let v=(p-2*a)/g,y=p/2-a,x=f/2-a,b=m/2,w=g+1,D=0,_=new Lv,S=new Lv;for(let l=0;l<o+1;l++){let d=l/o*pN,p=Math.sin(d)*a,f=(1-Math.cos(d))*a,m=Math.sin(d),E=Math.cos(d);_[t]=(x+p)*r,_[n]=(b-f)*s,S[e]=0,S[t]=m*Math.sign(_[t]),S[n]=E*Math.sign(_[n]);for(let t=0;t<w;t++){let n=t*v-y;_[e]=n*i,u.push(_.x,_.y,_.z),c.push(S.x,S.y,S.z),h.push(t/g),h.push(0),D+=1}}for(let a=0;a<o;a++)for(let e=0;e<g;e++){let t=d+e+w*a,n=d+e+w*(a+1),i=d+(e+1)+w*(a+1),r=d+(e+1)+w*a;l.push(t,n,r),l.push(n,i,r)}d+=D}function m(i,r,s){let p=new Lv,f=new Lv(e/2,t/2,n/2);f.subScalar(a);let m=[],g=i*r*s>0?(e,t,n)=>l.push(e,t,n):(e,t,n)=>l.push(e,n,t);for(let e=0;e<=o;e++){let t=[],n=pN*(1-e/o),l=Math.cos(n),g=Math.sin(n),v=0;for(let o=0;o<=e;o++){let n=Math.cos(v),o=Math.sin(v);p.x=l*n,p.y=g,p.z=l*o;let m=f.clone().addScaledVector(p,a);u.push(i*m.x,r*m.y,s*m.z),c.push(i*p.x,r*p.y,s*p.z),h.push(0,0),t.push(d++),v+=pN/e}m.push(t)}let v=m.length-1;for(let e=0;e<v;e++){let t=m[e],n=m[e+1],i=t.length-1;g(t[0],n[1],n[0]);for(let e=1;e<=i;e++)g(t[e-1],t[e],n[e]),g(t[e],n[e+1],n[e])}}p("z","y","x",-1,-1,n,t,e,s,r),p("z","y","x",1,-1,n,t,-e,s,r),p("x","z","y",1,1,e,n,t,i,s),p("x","z","y",1,-1,e,n,-t,i,s),p("x","y","z",1,-1,e,t,n,i,r),p("x","y","z",-1,-1,e,t,-n,i,r),a>0&&(f("z","y","x",-1,-1,1,n,t,e,s),f("z","y","x",1,-1,-1,n,t,e,s),f("z","y","x",-1,1,-1,n,t,e,s),f("z","y","x",1,1,1,n,t,e,s),f("x","y","z",-1,-1,-1,e,t,n,i),f("x","y","z",1,-1,1,e,t,n,i),f("x","y","z",-1,1,1,e,t,n,i),f("x","y","z",1,1,-1,e,t,n,i),f("y","x","z",-1,-1,1,t,e,n,r),f("y","x","z",1,-1,-1,t,e,n,r),f("y","x","z",1,1,1,t,e,n,r),f("y","x","z",-1,1,-1,t,e,n,r),m(1,1,1),m(-1,1,1),m(1,-1,1),m(-1,-1,1),m(1,1,-1),m(-1,1,-1),m(1,-1,-1),m(-1,-1,-1)),this.setIndex(l),this.setAttribute("position",new rx(u,3)),this.setAttribute("normal",new rx(c,3)),this.setAttribute("uv",new rx(h,2))}},mN=class extends dx{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.2,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:4;super(),this.type="PolyhedronGeometryRound";let a=[],o=[],l=[];return function(){r=Math.min(.99999,r),0==r&&(s=0);let o={IcosahedronGeometry:5,DodecahedronGeometry:3,HexahedronGeometry:3,OctahedronGeometry:4,TetrahedronGeometry:3}[n],u=new Lv,c=u.clone(),h=new Qy,d=r*i,p=i-d,f=s+1,m=new Lv,g=(e,t)=>m.subVectors(e,t).normalize(),v=(e,t)=>Array(e).fill(void 0).map(t),y=v(e.length/3,((t,n)=>(new Lv).fromArray(e,3*n).setLength(i))),x=[],b=1e6;for(let e=0;e<y.length;e++){let n,i,r,s=y[e],a=[],o=1e10,l=-1;for(;-1!=(l=t.indexOf(e,l+1));){let e=l-l%3;n=t[e+(l+1)%3],i=t[e+(l+2)%3],r=s.distanceToSquared(y[n]),o=Math.min(o,r),a.push([n,i,r])}o+=1e-6;let u=[],c=0,h=a.length;for(let t=0;t<h;t++){var w;[n,i,r]=a[c];let t=1==(null===(w=x[n])||void 0===w?void 0:w.includes(e));r<=o&&u.push(n+ +t*b),c=a.findIndex((e=>e[0]==i))}x.push(u)}let D=[];{let e,t,n=0,i=0,r=3==o;for(let a=0;a<=s;a++){e=a*(a+1)/2,t=(a+1)*(a+2)/2;for(let o=0;o<s-a;o++)[n,i]=[e+o+a+2,t+o+a+3],D.push(e,t,...r?[i,e]:[n,t],i,n),[e,t]=[n,i];D.push(e,t,e+s+2)}}let _=u.clone(),S=u.clone(),E=u.clone(),C=u.clone(),A=u.clone(),M=[],T=v(y.length,(()=>v(o,(()=>u.clone()))));for(let e=0;e<y.length;e++){u.copy(y[e]).normalize(),_.copy(u).multiplyScalar(p);let t=x[e];for(let s=0;s<t.length;s++){let n=t[s],i=t[(s+1)%o];h.setFromPointsAndIndices(y,e,n%b,i%b),h.b.sub(h.a).setLength(1e10).add(h.a),h.c.sub(h.a).setLength(1e10).add(h.a),h.closestPointToPoint(_,T[e][s])}let n=[],i=[],r=[],v=new Lv;0==s&&[...T[e]].reduce(((e,t)=>e.add(t)),v).multiplyScalar(1/o);for(let a=0;a<o;a++){let t=[],l=(a-1+o)%o,h=T[e][l],y=T[e][a];u.copy(h).sub(_),c.copy(y).sub(_);let x=_.angleTo(u),b=u.angleTo(c),w=Math.cos(x)*d;0==s?S.copy(v):S.copy(_).setLength(p+w),i.push(w);let D=[S,h,y];for(let e=0;e<2;e++){let i=D[e],r=D[e+1];C.subVectors(i,_),A.subVectors(r,_),E.crossVectors(C,A).normalize();for(let s=0;s<f;s++){let r=[x,b][e]*s/f;u.copy(C).applyAxisAngle(E,r).add(_),n.push(u.clone()),e&&(g(u,_),t.push([0==s?i:u.clone(),m.clone()]))}e&&(g(r,_),t.push([r,m.clone()]))}r.push(t)}M.push(r);let w=2*f,P=2;for(let e=0;e<o;e++){let t=w*e,r=w*((e+1)%o),s=[n[t]];for(let a=1;a<f;a++){C=n[t+a],A=n[r+a],s.push(C);for(let t=1,n=a-P+1;t<=n;t++)u.lerpVectors(C,A,t/(n+1)),u.sub(_).setLength(i[e]).add(_),s.push(u.clone());s.push(A)}for(let e=0;e<f;e++)s.push(n[e+f+t]);s.push(n[r+f]);let c=D.map((e=>s[e]));a.push(...c.map((e=>[e.x,e.y,e.z])).flat()),l.push(...c.map((e=>(g(e,_),[m.x,m.y,m.z]))).flat())}}let P=[];for(let e=0;e<x.length;e++)for(let t=0;t<o;t++){let n=x[e][t];if(n<b){let i=x[n].findIndex((t=>t%b==e)),r=M[e][t],s=M[n][i];for(let e=0;e<f;e++){let t=r[e],n=s[f-e],i=r[e+1];[t,n,i,i,n,s[f-(e+1)]].forEach((e=>{a.push(e[0].x,e[0].y,e[0].z),l.push(e[1].x,e[1].y,e[1].z)}))}P.push(r[0][0],s[f][0],r[f][0],s[0][0])}}for(;P.length;){let e,t,n,i;[e,t]=P.splice(0,2);let r=[e];for(;e!=t;)r.push(t),n=P.indexOf(t),i=n%2,t=P.splice(n-i,2)[1-i];m.subVectors(r[0],r[1]).cross(u.subVectors(r[0],r[2])).normalize();let s=m.dot(r[0])<0;s&&m.negate();for(let o=1;o<=r.length-2;o++)[r[o+ +s],r[o+1-+s],r[0]].forEach((e=>{a.push(e.x,e.y,e.z),l.push(m.x,m.y,m.z)}))}}(),function(){let e=new Lv;for(let p=0;p<a.length;p+=3){e.x=a[p+0],e.y=a[p+1],e.z=a[p+2];let t=h(e)/2/Math.PI+.5,n=d(e)/Math.PI+.5;o.push(t,1-n)}let t=new Lv,n=new Lv,i=new Lv,r=new Lv,s=new lv,l=new lv,u=new lv,c=(e,t,n,i)=>{i<0&&1===e.x&&(o[t]=e.x-1),0===n.x&&0===n.z&&(o[t]=i/2/Math.PI+.5)};for(let p=0,f=0;p<a.length;p+=9,f+=6){t.set(a[p+0],a[p+1],a[p+2]),n.set(a[p+3],a[p+4],a[p+5]),i.set(a[p+6],a[p+7],a[p+8]),s.set(o[f+0],o[f+1]),l.set(o[f+2],o[f+3]),u.set(o[f+4],o[f+5]),r.copy(t).add(n).add(i).divideScalar(3);let e=h(r);c(s,f+0,t,e),c(l,f+2,n,e),c(u,f+4,i,e)}for(let a=0;a<o.length;a+=6){let e=o[a+0],t=o[a+2],n=o[a+4],i=Math.max(e,t,n),r=Math.min(e,t,n);i>.9&&r<.1&&(e<.2&&(o[a+0]+=1),t<.2&&(o[a+2]+=1),n<.2&&(o[a+4]+=1))}function h(e){return Math.atan2(e.z,-e.x)}function d(e){return Math.atan2(-e.y,Math.sqrt(e.x*e.x+e.z*e.z))}}(),this.setAttribute("position",new rx(a,3)),this.setAttribute("normal",new rx(l,3)),void this.setAttribute("uv",new rx(o,2))}static fromJSON(e){return new mN(e.vertices,e.indices,e.radius,e.corner,e.cornerSides)}},gN=class extends mN{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.2,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:4,i=(1+Math.sqrt(5))/2,r=1/i,s="DodecahedronGeometry";super([-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-r,-i,0,-r,i,0,r,-i,0,r,i,-r,-i,0,-r,i,0,r,-i,0,r,i,0,-i,0,-r,i,0,-r,-i,0,r,i,0,r],[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],s,e,t,n),this.type=s}static fromJSON(e){return new gN(e.radius,e.corner,e.cornerSides)}},vN=1e-12,yN=class{constructor(e){this.position=new lv,this.startPosition=new lv,this.uuid=ov.generateUUID(),this.position=e.clone()}start(){this.reset()}reset(){this.startPosition.copy(this.position)}applyOffset(e){this.position.copy(this.startPosition).add(e)}copy(e){return this.position.copy(e.position),this.startPosition.copy(e.startPosition),this}clone(){return new yN(this.position).copy(this)}toJSON(){return[this.position.x,this.position.y]}},xN=class extends yN{constructor(e){super(e.position),this.parent=e}copy(e){return super.copy(e),this}clone(){return new xN(this.parent).copy(this)}},bN=class extends yN{constructor(e,t){super(t),this.controls=[],this.roundness=0,this.areControlsDirectionsMirrored=!0,this.uuid=e,this.controls.push(new xN(this),new xN(this))}static create(e,t){let n=new bN(e,new lv(...t.position));return n.controls[0].position.set(...t.controlPrevious.position),n.controls[1].position.set(...t.controlNext.position),n.roundness=t.roundness,n.areControlsDirectionsMirrored=t.areControlsDirectionsMirrored,n}getOppositeControl(e){let t=this.controls.indexOf(e);return 0===t?this.controls[1]:1===t?this.controls[0]:null}applyOffsetToControls(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;for(let n=0,i=this.controls.length;n<i;n++){let i=this.controls[n];this.position.distanceTo(i.position)<=t?i.position.copy(this.position):i.applyOffset(e)}}controlsMoved(){return!(this.position.equals(this.controls[0].position)&&this.position.equals(this.controls[1].position))}copy(e){return super.copy(e),this.controls[0].copy(e.controls[0]),this.controls[1].copy(e.controls[1]),this.roundness=e.roundness,this.uuid=e.uuid,this}clone(){return new bN(this.uuid,this.position).copy(this)}toJSON(){return super.toJSON().concat(this.controls[0].toJSON(),this.controls[1].toJSON(),[this.roundness])}computeTangents(){var e,t;return[null===(e=this.curveBefore)||void 0===e?void 0:e.getTangentAt(1),null===(t=this.curveAfter)||void 0===t?void 0:t.getTangentAt(0)]}computeNormals(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new lv,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new lv,[n,i]=this.computeTangents();return n&&i&&(wN(n,e),wN(i,t)),[e,t]}computeTangent(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new lv,[t,n]=this.computeTangents();return t&&n&&e.copy(t).add(n).normalize(),e}computeNormal(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new lv,[t,n]=this.computeNormals();return e.copy(t).add(n).normalize(),e}};function wN(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new lv,n=e.length();return t.set(-e.y/n,e.x/n)}var DN=new lv,_N=new lv,SN=new lv,EN=new lv,CN=new lv,AN=new lv,MN=new Lv,TN=new Lv;function PN(e){let t=new lv;t.addVectors(e.v0,DN.subVectors(e.v1,e.v0).multiplyScalar(2/3));let n=new lv;return n.addVectors(e.v2,_N.subVectors(e.v1,e.v2).multiplyScalar(2/3)),new c_(e.v0,t,n,e.v2)}function FN(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Number.EPSILON;return Math.abs(e-t)<n}function ON(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Number.EPSILON;return e.distanceTo(t)<n}function IN(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Number.EPSILON;return e.distanceTo(t)<n}function kN(e,t,n){let i=Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2)),r=Math.sqrt(Math.pow(t.x-n.x,2)+Math.pow(t.y-n.y,2)),s=Math.sqrt(Math.pow(n.x-e.x,2)+Math.pow(n.y-e.y,2));return Math.acos((r*r+i*i-s*s)/(2*r*i))}function BN(e,t,n){return UN(e,t)&&UN(t,n)&&RN(e.position,t.position,n.position)}function RN(e,t,n){return 0===DN.copy(t).sub(e).cross(_N.copy(n).sub(e))}function LN(e,t,n,i,r){let s=Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2)),a=(e.y+t.y)/2,o=(e.x+t.x)/2,l=Math.sqrt(Math.pow(n,2)-Math.pow(s/2,2))*(e.y-t.y)/s,u=Math.sqrt(Math.pow(n,2)-Math.pow(s/2,2))*(t.x-e.x)/s;return i.set(o+l,a+u),r.set(o-l,a-u),[i,r]}function zN(e,t,n){return e.distanceTo(n)<t.distanceTo(n)?t:e}function NN(e,t,n,i,r,s){let a,o=t.x-e.x,l=t.y-e.y,u=n.x-e.x,c=n.y-e.y,h=Math.sqrt((o+u)*(o+u)+(l+c)*(l+c));return kN(t,e,n)>Math.PI&&(h*=-1),a=FN(c,l)?(l+c)*(i/h-.5)*8/3/(o-u):(o+u)*(i/h-.5)*8/3/(c-l),r.set(t.x-a*l,t.y+a*o),s.set(n.x+a*c,n.y-a*u),[r,s]}function jN(e,t){return e.position.equals(e.controls[1].position)&&t.position.equals(t.controls[0].position)}function UN(e,t){return RN(e.position,e.controls[1].position,t.position)&&RN(e.position,t.controls[0].position,t.position)}function VN(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:12,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=[];for(let r=0,s=e.length;r<s;r++){let s=e[r],a=0;if(n&&void 0!==s.roundedCurveCorner){let e=.5*HN(s.roundedCurveCorner,t);r>0&&(i[r-1]+=e),a+=e}void 0!==s.curveAfter&&(a+=HN(s.curveAfter,t)),i.push(a)}return e.length>0&&n&&void 0!==e[0].roundedCurveCorner&&(i[e.length-1]+=.5*HN(e[0].roundedCurveCorner,t)),i}function HN(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:12;return e&&e instanceof t_?2*t:e&&(e instanceof d_||e instanceof p_)?1:e&&e instanceof m_?t*e.points.length:t}var WN,GN,qN=new lv,YN=new lv,XN=new lv,QN=new lv,KN=new lv,ZN=new lv,JN=class extends S_{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100;super(),this.points=[],this.shapeHoles=[],this.plane=new Hx(new Lv(0,0,-1)),this.subdivision=0,this.controlSnapDistance=4,this.pointIDs=0,this.isMesh2D=!1,this.isText=!1,this._roundness=0,this.isClosed=!1,this.useCubicForRoundedCorners=!0,this.uuid=ov.generateUUID(),this.needsUpdate=!1,this.roundedCurves=[],this._width=e,this._height=t}static createFromState(e,t,n){let i=new JN;return i.isClosed=e.isClosed,i.points=e.points.map((e=>bN.create(e.id,e.data))),"number"==typeof e.roundness&&(i.roundness=e.roundness),i.shapeHoles=e.shapeHoles.map((e=>JN.createFromState(e))),void 0!==t&&void 0!==n&&i.applySize(t,n),i.update(),i}get width(){return this._width}get height(){return this._height}get roundness(){return this._roundness}set roundness(e){if(this._roundness!==e){this._roundness=e;for(let t=0,n=this.points.length;t<n;t++)this.points[t].roundness=e;this.needsUpdate=!0}}getPointsIndexesByIds(e){return e.map((e=>this.getPointIndexById(e))).filter((e=>e>=0))}getPointIndexById(e){let t=this.points.length,n=this.points.findIndex((t=>t.uuid===e));if(n<0){let n=t;for(let t=0,i=this.shapeHoles.length;t<i;t++){let i=this.shapeHoles[t],r=i.points.length,s=i.getPointIndexById(e);if(!(s<0))return s+n;n+=r}}return n}getLineIndexById(e){return this.getPointIndexById(e)}getBezierPoint(e){if(e<=this.points.length-1)return this.points[e];if(this.shapeHoles.length>0){let t=this.points.length;for(let n=0,i=this.shapeHoles.length;n<i;n++){let i=this.shapeHoles[n],r=e-t;if(r<=i.points.length-1)return i.points[r];t+=i.points.length}}throw new Error("This shape does not have a point for this index: "+e)}getBezierPointIndex(e){let t=this.points.indexOf(e);if(t>=0)return t;if(t=this.points.length,this.shapeHoles.length>0)for(let n=0,i=this.shapeHoles.length;n<i;n++){let i=this.shapeHoles[n],r=i.points.indexOf(e);if(r>=0)return t+r;t+=i.points.length}return-1}getAllPoints(){let e=[].concat(...this.shapeHoles.map((e=>e.points)));return[...this.points,...e]}applySize(e,t){0===e&&(e=.001),0===t&&(t=.001),this._width=e,this._height=t}applyScale(e,t){let n=qN.set(e,t);for(let i=0,r=this.points.length;i<r;i++){let e=this.points[i];e.position.multiply(n),e.controls[0].position.multiply(n),e.controls[1].position.multiply(n)}for(let i=0,r=this.shapeHoles.length;i<r;i++)this.shapeHoles[i].applyScale(e,t);this._update()}createPoint(e){let t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:ov.generateUUID();t=e instanceof lv?e:new lv(e,n);let r=new bN(i,t);return r.roundness=this.roundness,r}addPoint(e){this.points.push(e),this.needsUpdate=!0}addPointAt(e,t){this.points.splice(t,0,e),this.needsUpdate=!0}getPointByUuid(e){for(let t=0,n=this.points.length;t<n;t++){let n=this.points[t];if(n.uuid===e)return n}for(let t=0,n=this.shapeHoles.length;t<n;t++){let n=this.shapeHoles[t].getPointByUuid(e);if(n)return n}}getFirstPoint(){return this.points[0]}getLastPoint(){return this.points[this.points.length-1]}removePoint(e){let t=this.points.indexOf(e);t>=0&&this.points.splice(t,1),this.needsUpdate=!0}removePointById(e){let t=this.points.find((t=>t.uuid===e));t&&this.removePoint(t)}update(){for(let e=0,t=this.shapeHoles.length;e<t;e++)this.shapeHoles[e].update();this._update()}extractShapePointsToBuffer(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:12,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.subdivision=t,void 0===this.curveDivisions&&this.computeCurveDivisions(t);let i=n?this.roundedCurveDivisions:this.curveDivisions;return function(e,t){let n,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:12,r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],s=TN.set(0,0,0),a=0,o=[];for(let l=0;l<t.length;l++){let r=t[l],u=DN,c=HN(r,i);o.push(c);for(let t=0;t<=c;t++)if(r instanceof c_||r instanceof f_||r instanceof d_){if(r.getPoint(t/c,u),s.set(u.x,u.y,0),void 0!==n&&IN(n,s))continue;void 0===n&&(n=MN),n.copy(s),e.setXYZ(a,s.x,s.y,s.z),a++}}r&&a>1&&!(e.getX(a-1)===e.getX(0)&&e.getY(a-1)===e.getY(0)&&e.getZ(a-1)===e.getZ(0))&&(e.setXYZ(a,e.getX(0),e.getY(0),e.getZ(0)),a++)}(e,n?this.roundedCurves:this.curves,t,this.autoClose),i.reduce(((e,t)=>e+t),0)+1}computeCurveDivisions(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:12;return this.curveDivisions=VN(this.points,e,!1),this.roundedCurveDivisions=VN(this.points,e,!0),this.curveDivisions}extractFilteredShapePointsToBuffer(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:12;return 2*function(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:12,r=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],s=TN.set(0,0,0),a=0,o=[];for(let u=0;u<t.length;u++){if(!1===n[u])continue;let r,c=t[u],h=DN,d=HN(c,i);o.push(d);for(let t=0;t<=d;t++)if(c instanceof c_||c instanceof f_||c instanceof d_){var l;if(c.getPoint(t/d,h),s.set(h.x,h.y,0),null!==(l=r)&&void 0!==l&&l.equals(s))continue;void 0===r?r=MN:(e.setXYZ(a,r.x,r.y,r.z),a++,e.setXYZ(a,s.x,s.y,s.z),a++),r.copy(s)}}return r&&a>1&&!(e.getX(a-1)===e.getX(0)&&e.getY(a-1)===e.getY(0)&&e.getZ(a-1)===e.getZ(0))&&(e.setXYZ(a,e.getX(0),e.getY(0),e.getZ(0)),a++),o}(e,this.curves,t,n,this.autoClose).reduce(((e,t)=>e+t),0)}extractShapePointsToFlatArray(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:12;return this.subdivision=t,void 0===this.curveDivisions&&this.computeCurveDivisions(t),function(e,t){let n,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:12,r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],s=0;for(let a=0;a<t.length;a++){let r=t[a],o=HN(r,i),l=DN;for(let t=0;t<=o;t++)if(r instanceof c_||r instanceof f_||r instanceof d_){if(r.getPoint(t/o,l),void 0!==n&&ON(n,l,vN))continue;void 0===n&&(n=_N),n.copy(l),e.push(l.x,l.y),s++}}return FN(e[0],e[e.length-2],vN)&&FN(e[1],e[e.length-1],vN)&&(e.pop(),e.pop()),r&&s>1&&!(FN(e[s-1],e[1],vN)&&FN(e[s-2],e[0],vN))&&(e.push(e[0],e[1]),s++),e}(e,this.roundedCurves,t,this.autoClose)}getCurveIndexFromVertexId(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=0;void 0===this.curveDivisions&&this.computeCurveDivisions(this.subdivision);let i=t?this.roundedCurveDivisions:this.curveDivisions,r=0;t&&void 0!==this.points[0].roundedCurveCorner&&(r=.5*HN(this.points[0].roundedCurveCorner,this.subdivision));let s=e-r;s<0&&(s+=i.reduce(((e,t)=>e+t),0));for(let a=0,o=i.length;a<o;a++){let e=i[a];if(s<n+e)return[a,(s-n+1)/e];n+=e}return[0,1]}getCurveT(e,t,n){let i=this.points[e],r=this.points[e>=this.points.length-1?0:e+1],s=this.curveDivisions,a=s[e];if(jN(i,r)){let e=i.position.distanceTo(r.position);return i.position.distanceTo(qN.set(n.x,n.y))/e}let o=0;for(let l=0;l<e;l++)o+=s[l];return(t-o)/a}dispose(){}_applyCurveForPoint(e,t){jN(t,e)?this.lineTo(e.position.x,e.position.y):this.bezierCurveTo(t.controls[1].position.x,t.controls[1].position.y,e.controls[0].position.x,e.controls[0].position.y,e.position.x,e.position.y);let n=this.curves[this.curves.length-1];e.curveBefore=n,t.curveAfter=n;let i=n.clone();e.roundedCurveBefore=i,t.roundedCurveAfter=i,e.roundedCurveCorner=void 0,this.roundedCurves.push(i)}_update(){if(this.curves=[],this.roundedCurves=[],!this.points.length)return;for(let i=0,r=this.points.length;i<r;i++){let e=this.points[i];if(0===i)this.moveTo(e.position.x,e.position.y);else{let t=this.points[i-1];this._applyCurveForPoint(e,t)}}let e=this.getLastPoint();if(null!==e&&void 0!==e&&e.curveAfter&&(e.curveAfter=void 0),this.isClosed){let e=this.points[0],t=this.points[this.points.length-1];this._applyCurveForPoint(e,t)}if(this.points.length>2){let e=0;for(let i=0,r=this.points.length;i<r;i++){var t,n;let r=this.points[i],s=null!==(t=this.points[i-1])&&void 0!==t?t:this.points[this.points.length-1],a=null!==(n=this.points[i+1])&&void 0!==n?n:this.points[0],o=r.roundness,l=s&&a&&BN(s,r,a);if(!r.controlsMoved()&&o>0&&!l){let t=r.curveBefore,n=r.curveAfter;if(void 0===t||void 0===n)continue;let s,a=r.roundedCurveBefore,l=r.roundedCurveAfter,u=t.getLength(),c=n.getLength(),h=Math.min(o,.499*u),d=Math.min(o,.499*c),p=Math.min(h,d),f=1-p/u,m=p/c,g=t.getPointAt(f,qN),v=n.getPointAt(m,YN);if(this._subSplitCurve(t,a,f,g,void 0),this._subSplitCurve(n,l,m,void 0,v),this.useCubicForRoundedCorners){let e=kN(g,r.position,v)/2,t=Math.tan(e)*g.distanceTo(r.position),[n,i]=LN(g,v,t,XN,QN),a=zN(n,i,r.position),[o,l]=NN(a,g,v,t,KN,ZN);s=new c_(g.clone(),o.clone(),l.clone(),v.clone())}else s=new f_(g.clone(),r.position.clone(),v.clone());r.roundedCurveCorner=s,this.roundedCurves.splice(i+e,0,s),e++}}}}_subSplitCurve(e,t,n,i,r){if(!(e instanceof d_)){let s=e,a=t,o=s.getUtoTmapping(n,0),l=function(e,t,n,i){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.5,s=DN.subVectors(t,e).multiplyScalar(r).add(e),a=_N.subVectors(n,t).multiplyScalar(r).add(t),o=SN.subVectors(i,n).multiplyScalar(r).add(n),l=s,u=EN.subVectors(a,s).multiplyScalar(r).add(s),c=CN.subVectors(o,a).multiplyScalar(r).add(a),h=o,d=AN.subVectors(c,u).multiplyScalar(r).add(u);return[e.x,e.y,l.x,l.y,u.x,u.y,d.x,d.y,c.x,c.y,h.x,h.y,i.x,i.y]}(s.v0,s.v1,s.v2,s.v3,o);return void 0!==i&&(a.v0.set(l[0],l[1]),a.v1.set(l[2],l[3]),a.v2.set(l[4],l[5]),a.v3.set(l[6],l[7])),void 0!==r&&(a.v0.set(l[6],l[7]),a.v1.set(l[8],l[9]),a.v2.set(l[10],l[11]),a.v3.set(l[12],l[13])),a}return void 0!==i&&t.v2.copy(i),void 0!==r&&t.v1.copy(r),t}clone(){let e=new JN(this._width,this._height);return e.points=this.points.map((e=>e.clone())),e.isClosed=this.isClosed,e.roundness=this.roundness,e.isMesh2D=this.isMesh2D,e.shapeHoles=this.shapeHoles.map((e=>e.clone())),e}toJSON(){return{points:this.points.reduce(((e,t)=>e.concat(t.toJSON())),[]),shapeHoles:this.shapeHoles.map((e=>e.toJSON())),isClosed:this.isClosed,roundness:this.roundness}}fromJSON(e){var t;this.points=[],this.pointIDs=0;let n=e.points.length/7;for(let i=0;i<n;i++){let t=7*i,n=e.points[t+0],r=e.points[t+1],s=e.points[t+2],a=e.points[t+3],o=e.points[t+4],l=e.points[t+5],u=e.points[t+6],c=new bN(ov.generateUUID(),new lv(n,r));c.controls[0].position.set(s,a),c.controls[1].position.set(o,l),c.roundness=u,this.points.push(c)}return this.shapeHoles=null!==(t=e.shapeHoles)&&void 0!==t&&t.length?e.shapeHoles.map((e=>{let t=new JN;return t.fromJSON(e),t})):[],this.isClosed=e.isClosed,this._roundness=e.roundness,this._update(),this}fromShape(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.isText=t;let n=(e,t)=>{t instanceof c_&&t.v3.equals(e.position)&&e.controls[0].position.copy(t.v2)};return this.points=(e=>{let t,i,r=[];for(t=0,i=e.length;t<i;t++)e[t]instanceof f_&&(e[t]=PN(e[t]));for(t=0,i=e.length;t<i;t++){let i,s=e[t],a=t>0?e[t-1]:null;s instanceof c_?(i=this.createPoint(s.v0),i.controls[1].position.copy(s.v1)):s instanceof d_&&(i=this.createPoint(s.v1)),void 0!==i&&(null!==a&&n(i,a),r.push(i))}let s=e[e.length-1],a=!1;return s instanceof c_?s.v3.equals(r[0].position)&&(r[0].controls[0].position.copy(s.v2),a=!0):s instanceof d_&&s.v2.equals(r[0].position)&&(a=!0),this.isClosed=a,r})(e.curves),e instanceof S_&&(this.shapeHoles=e.holes.map((e=>{let t=new JN;return t.fromShape(e),t}))),this.update(),this}updatePoint(e,t){let n=this.getPointByUuid(e);n&&(void 0!==t.position&&n.position.fromArray(t.position),void 0!==t.roundness&&(n.roundness=t.roundness),void 0!==t.areControlsDirectionsMirrored&&(n.areControlsDirectionsMirrored=t.areControlsDirectionsMirrored),this.needsUpdate=!0)}updatePreviousControl(e,t){var n;let i=null===(n=this.getPointByUuid(e))||void 0===n?void 0:n.controls[0];i&&(t.position&&i.position.fromArray(t.position),this.needsUpdate=!0)}updateNextControl(e,t){var n;let i=null===(n=this.getPointByUuid(e))||void 0===n?void 0:n.controls[1];i&&(t.position&&i.position.fromArray(t.position),this.needsUpdate=!0)}},$N=2*Math.PI;function ej(e,t,n,i,r){let{x:s,y:a}=e;return{x:s*t+i,y:a*n+r}}function tj(e,t){let n=1.5707963267948966===t?.551915024494:-1.5707963267948966===t?-.551915024494:1.3333333333333333*Math.tan(t/4),i=Math.cos(e),r=Math.sin(e),s=Math.cos(e+t),a=Math.sin(e+t);return[{x:i-r*n,y:r+i*n},{x:s+a*n,y:a-s*n},{x:s,y:a}]}function nj(e,t,n,i){let r=e*i-t*n<0?-1:1,s=Math.min(1,Math.max(-1,e*n+t*i));return r*Math.acos(s)}function ij(e){let{px:t,py:n,cx:i,cy:r,rx:s,ry:a,largeArcFlag:o,sweepFlag:l}=e,u=[];if(0===s||0===a)return[];let c=(t-i)/2,h=(n-r)/2;if(0===c&&0===h)return[];s=Math.abs(s),a=Math.abs(a);let d=Math.pow(c,2)/Math.pow(s,2)+Math.pow(h,2)/Math.pow(a,2);d>1&&(s*=Math.sqrt(d),a*=Math.sqrt(d));let p=function(e,t,n,i,r,s,a,o,l,u){let c=Math.pow(r,2),h=Math.pow(s,2),d=Math.pow(a,2),p=Math.pow(o,2),f=c*h-c*p-h*d;f<0&&(f=0),f/=c*p+h*d,f=Math.sqrt(f)*(l===u?-1:1);let m=f*r/s*o,g=f*-s/r*a,v=m+(e+n)/2,y=g+(t+i)/2,x=(a-m)/r,b=(o-g)/s,w=(-a-m)/r,D=(-o-g)/s,_=nj(1,0,x,b),S=nj(x,b,w,D);return!u&&S>0&&(S-=$N),u&&S<0&&(S+=$N),{centerx:v,centery:y,ang1:_,ang2:S}}(t,n,i,r,s,a,c,h,o,l),{ang1:f,ang2:m}=p,{centerx:g,centery:v}=p,y=Math.abs(m)/($N/4);Math.abs(1-y)<1e-7&&(y=1);let x=Math.max(Math.ceil(y),1);m/=x;for(let b=0;b<x;b++)u.push(tj(f,m)),f+=m;return u.map((e=>{let{x:t,y:n}=ej(e[0],s,a,g,v),{x:i,y:r}=ej(e[1],s,a,g,v),{x:o,y:l}=ej(e[2],s,a,g,v);return{x1:t,y1:n,x2:i,y2:r,x:o,y:l}}))}function rj(e,t){if(!e)throw t||"Assertion Failed!"}!function(e){e[e.ODD=0]="ODD",e[e.NONZERO=1]="NONZERO",e[e.POSITIVE=2]="POSITIVE",e[e.NEGATIVE=3]="NEGATIVE",e[e.ABS_GEQ_TWO=4]="ABS_GEQ_TWO"}(WN||(WN={})),function(e){e[e.POLYGONS=0]="POLYGONS",e[e.CONNECTED_POLYGONS=1]="CONNECTED_POLYGONS",e[e.BOUNDARY_CONTOURS=2]="BOUNDARY_CONTOURS"}(GN||(GN={}));var sj=function(){function e(){}return e.vertEq=function(e,t){return e.s===t.s&&e.t===t.t},e.vertLeq=function(e,t){return e.s<t.s||e.s===t.s&&e.t<=t.t},e.transLeq=function(e,t){return e.t<t.t||e.t===t.t&&e.s<=t.s},e.edgeGoesLeft=function(t){return e.vertLeq(t.Dst,t.Org)},e.edgeGoesRight=function(t){return e.vertLeq(t.Org,t.Dst)},e.vertL1dist=function(e,t){return Math.abs(e.s-t.s)+Math.abs(e.t-t.t)},e.edgeEval=function(t,n,i){rj(e.vertLeq(t,n)&&e.vertLeq(n,i));var r=n.s-t.s,s=i.s-n.s;return r+s>0?r<s?n.t-t.t+(t.t-i.t)*(r/(r+s)):n.t-i.t+(i.t-t.t)*(s/(r+s)):0},e.edgeSign=function(t,n,i){rj(e.vertLeq(t,n)&&e.vertLeq(n,i));var r=n.s-t.s,s=i.s-n.s;return r+s>0?(n.t-i.t)*r+(n.t-t.t)*s:0},e.transEval=function(t,n,i){rj(e.transLeq(t,n)&&e.transLeq(n,i));var r=n.t-t.t,s=i.t-n.t;return r+s>0?r<s?n.s-t.s+(t.s-i.s)*(r/(r+s)):n.s-i.s+(i.s-t.s)*(s/(r+s)):0},e.transSign=function(t,n,i){rj(e.transLeq(t,n)&&e.transLeq(n,i));var r=n.t-t.t,s=i.t-n.t;return r+s>0?(n.s-i.s)*r+(n.s-t.s)*s:0},e.vertCCW=function(e,t,n){return e.s*(t.t-n.t)+t.s*(n.t-e.t)+n.s*(e.t-t.t)>=0},e.interpolate=function(e,t,n,i){return(e=e<0?0:e)<=(n=n<0?0:n)?0===n?(t+i)/2:t+e/(e+n)*(i-t):i+n/(e+n)*(t-i)},e.intersect=function(t,n,i,r,s){var a,o,l;e.vertLeq(t,n)||(l=t,t=n,n=l),e.vertLeq(i,r)||(l=i,i=r,r=l),e.vertLeq(t,i)||(l=t,t=i,i=l,l=n,n=r,r=l),e.vertLeq(i,n)?e.vertLeq(n,r)?((a=e.edgeEval(t,i,n))+(o=e.edgeEval(i,n,r))<0&&(a=-a,o=-o),s.s=e.interpolate(a,i.s,o,n.s)):((a=e.edgeSign(t,i,n))+(o=-e.edgeSign(t,r,n))<0&&(a=-a,o=-o),s.s=e.interpolate(a,i.s,o,r.s)):s.s=(i.s+n.s)/2,e.transLeq(t,n)||(l=t,t=n,n=l),e.transLeq(i,r)||(l=i,i=r,r=l),e.transLeq(t,i)||(l=t,t=i,i=l,l=n,n=r,r=l),e.transLeq(i,n)?e.transLeq(n,r)?((a=e.transEval(t,i,n))+(o=e.transEval(i,n,r))<0&&(a=-a,o=-o),s.t=e.interpolate(a,i.t,o,n.t)):((a=e.transSign(t,i,n))+(o=-e.transSign(t,r,n))<0&&(a=-a,o=-o),s.t=e.interpolate(a,i.t,o,r.t)):s.t=(i.t+n.t)/2},e}(),aj=function(){this.next=null,this.prev=null,this.anEdge=null,this.trail=null,this.n=0,this.marked=!1,this.inside=!1},oj=function(){function e(e){this.side=e,this.next=null,this.Org=null,this.Sym=null,this.Onext=null,this.Lnext=null,this.Lface=null,this.activeRegion=null,this.winding=0}return Object.defineProperty(e.prototype,"Rface",{get:function(){return this.Sym.Lface},set:function(e){this.Sym.Lface=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Dst",{get:function(){return this.Sym.Org},set:function(e){this.Sym.Org=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Oprev",{get:function(){return this.Sym.Lnext},set:function(e){this.Sym.Lnext=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Lprev",{get:function(){return this.Onext.Sym},set:function(e){this.Onext.Sym=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Dprev",{get:function(){return this.Lnext.Sym},set:function(e){this.Lnext.Sym=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Rprev",{get:function(){return this.Sym.Onext},set:function(e){this.Sym.Onext=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Dnext",{get:function(){return this.Sym.Onext.Sym},set:function(e){this.Sym.Onext.Sym=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Rnext",{get:function(){return this.Sym.Lnext.Sym},set:function(e){this.Sym.Lnext.Sym=e},enumerable:!0,configurable:!0}),e}(),lj=function(){this.next=null,this.prev=null,this.anEdge=null,this.coords=[0,0,0],this.s=0,this.t=0,this.pqHandle=0,this.n=0,this.idx=0},uj=function(){function e(){var e=new lj,t=new aj,n=new oj(0),i=new oj(1);e.next=e.prev=e,e.anEdge=null,t.next=t.prev=t,n.next=n,n.Sym=i,i.next=i,i.Sym=n,this.vHead=e,this.fHead=t,this.eHead=n,this.eHeadSym=i}return e.prototype.makeEdge_=function(e){var t=new oj(0),n=new oj(1);e.Sym.side<e.side&&(e=e.Sym);var i=e.Sym.next;return n.next=i,i.Sym.next=t,t.next=e,e.Sym.next=n,t.Sym=n,t.Onext=t,t.Lnext=n,t.Org=null,t.Lface=null,t.winding=0,t.activeRegion=null,n.Sym=t,n.Onext=n,n.Lnext=t,n.Org=null,n.Lface=null,n.winding=0,n.activeRegion=null,t},e.prototype.splice_=function(e,t){var n=e.Onext,i=t.Onext;n.Sym.Lnext=t,i.Sym.Lnext=e,e.Onext=i,t.Onext=n},e.prototype.makeVertex_=function(e,t,n){var i=e;rj(i,"Vertex can't be null!");var r=n.prev;i.prev=r,r.next=i,i.next=n,n.prev=i,i.anEdge=t;var s=t;do{s.Org=i,s=s.Onext}while(s!==t)},e.prototype.makeFace_=function(e,t,n){var i=e;rj(i,"Face can't be null");var r=n.prev;i.prev=r,r.next=i,i.next=n,n.prev=i,i.anEdge=t,i.trail=null,i.marked=!1,i.inside=n.inside;var s=t;do{s.Lface=i,s=s.Lnext}while(s!==t)},e.prototype.killEdge_=function(e){e.Sym.side<e.side&&(e=e.Sym);var t=e.next,n=e.Sym.next;t.Sym.next=n,n.Sym.next=t},e.prototype.killVertex_=function(e,t){var n=e.anEdge,i=n;do{i.Org=t,i=i.Onext}while(i!==n);var r=e.prev,s=e.next;s.prev=r,r.next=s},e.prototype.killFace_=function(e,t){var n=e.anEdge,i=n;do{i.Lface=t,i=i.Lnext}while(i!==n);var r=e.prev,s=e.next;s.prev=r,r.next=s},e.prototype.makeEdge=function(){var e=new lj,t=new lj,n=new aj,i=this.makeEdge_(this.eHead);return this.makeVertex_(e,i,this.vHead),this.makeVertex_(t,i.Sym,this.vHead),this.makeFace_(n,i,this.fHead),i},e.prototype.splice=function(e,t){var n=!1,i=!1;if(e!==t){if(t.Org!==e.Org&&(i=!0,this.killVertex_(t.Org,e.Org)),t.Lface!==e.Lface&&(n=!0,this.killFace_(t.Lface,e.Lface)),this.splice_(t,e),!i){var r=new lj;this.makeVertex_(r,t,e.Org),e.Org.anEdge=e}if(!n){var s=new aj;this.makeFace_(s,t,e.Lface),e.Lface.anEdge=e}}},e.prototype.delete=function(e){var t=e.Sym,n=!1;if(e.Lface!==e.Rface&&(n=!0,this.killFace_(e.Lface,e.Rface)),e.Onext===e)this.killVertex_(e.Org,null);else if(e.Rface.anEdge=e.Oprev,e.Org.anEdge=e.Onext,this.splice_(e,e.Oprev),!n){var i=new aj;this.makeFace_(i,e,e.Lface)}t.Onext===t?(this.killVertex_(t.Org,null),this.killFace_(t.Lface,null)):(e.Lface.anEdge=t.Oprev,t.Org.anEdge=t.Onext,this.splice_(t,t.Oprev)),this.killEdge_(e)},e.prototype.addEdgeVertex=function(e){var t=this.makeEdge_(e),n=t.Sym;this.splice_(t,e.Lnext),t.Org=e.Dst;var i=new lj;return this.makeVertex_(i,n,t.Org),t.Lface=n.Lface=e.Lface,t},e.prototype.splitEdge=function(e){var t=this.addEdgeVertex(e).Sym;return this.splice_(e.Sym,e.Sym.Oprev),this.splice_(e.Sym,t),e.Dst=t.Org,t.Dst.anEdge=t.Sym,t.Rface=e.Rface,t.winding=e.winding,t.Sym.winding=e.Sym.winding,t.idx=e.idx,t.Sym.idx=e.Sym.idx,t},e.prototype.connect=function(e,t){var n=!1,i=this.makeEdge_(e),r=i.Sym;if(t.Lface!==e.Lface&&(n=!0,this.killFace_(t.Lface,e.Lface)),this.splice_(i,e.Lnext),this.splice_(r,t),i.Org=e.Dst,r.Org=t.Org,i.Lface=r.Lface=e.Lface,e.Lface.anEdge=r,!n){var s=new aj;this.makeFace_(s,i,e.Lface)}return i},e.prototype.zapFace=function(e){var t,n,i,r,s,a=e.anEdge;n=a.Lnext;do{n=(t=n).Lnext,t.Lface=null,null===t.Rface&&(t.Onext===t?this.killVertex_(t.Org,null):(t.Org.anEdge=t.Onext,this.splice_(t,t.Oprev)),(i=t.Sym).Onext===i?this.killVertex_(i.Org,null):(i.Org.anEdge=i.Onext,this.splice_(i,i.Oprev)),this.killEdge_(t))}while(t!=a);r=e.prev,(s=e.next).prev=r,r.next=s},e.prototype.countFaceVerts_=function(e){var t=e.anEdge,n=0;do{n++,t=t.Lnext}while(t!==e.anEdge);return n},e.prototype.mergeConvexFaces=function(e){var t,n,i,r,s;for(t=this.fHead.next;t!==this.fHead;t=t.next)if(t.inside)for(s=(n=t.anEdge).Org;i=n.Lnext,(r=n.Sym)&&r.Lface&&r.Lface.inside&&(this.countFaceVerts_(t)+this.countFaceVerts_(r.Lface)-2<=e&&sj.vertCCW(n.Lprev.Org,n.Org,r.Lnext.Lnext.Org)&&sj.vertCCW(r.Lprev.Org,r.Org,n.Lnext.Lnext.Org)&&(i=r.Lnext,this.delete(r),n=null,r=null)),!n||n.Lnext.Org!==s;)n=i;return!0},e.prototype.check=function(){var e,t,n,i,r,s,a=this.fHead,o=this.vHead,l=this.eHead;for(t=a,t=a;(e=t.next)!==a;t=e){rj(e.prev===t),r=e.anEdge;do{rj(r.Sym!==r),rj(r.Sym.Sym===r),rj(r.Lnext.Onext.Sym===r),rj(r.Onext.Sym.Lnext===r),rj(r.Lface===e),r=r.Lnext}while(r!==e.anEdge)}for(rj(e.prev===t&&null===e.anEdge),i=o,i=o;(n=i.next)!==o;i=n){rj(n.prev===i),r=n.anEdge;do{rj(r.Sym!==r),rj(r.Sym.Sym===r),rj(r.Lnext.Onext.Sym===r),rj(r.Onext.Sym.Lnext===r),rj(r.Org===n),r=r.Onext}while(r!==n.anEdge)}for(rj(n.prev===i&&null===n.anEdge),s=l,s=l;(r=s.next)!==l;s=r)rj(r.Sym.next===s.Sym),rj(r.Sym!==r),rj(r.Sym.Sym===r),rj(null!==r.Org),rj(null!==r.Dst),rj(r.Lnext.Onext.Sym===r),rj(r.Onext.Sym.Lnext===r);rj(r.Sym.next===s.Sym&&r.Sym===this.eHeadSym&&r.Sym.Sym===r&&null===r.Org&&null===r.Dst&&null===r.Lface&&null===r.Rface)},e}(),cj=function(){this.handle=null},hj=function(){this.key=null,this.node=0},dj=function(){function e(e,t){this.leq=t,this.max=0,this.nodes=[],this.handles=[],this.initialized=!1,this.freeList=0,this.size=0,this.max=e,this.nodes=[],this.handles=[];for(var n=0;n<e+1;n++)this.nodes[n]=new cj,this.handles[n]=new hj;this.initialized=!1,this.nodes[1].handle=1,this.handles[1].key=null}return e.prototype.floatDown_=function(e){var t,n,i,r=this.nodes,s=this.handles;for(t=r[e].handle;;){if((i=e<<1)<this.size&&this.leq(s[r[i+1].handle].key,s[r[i].handle].key)&&++i,rj(i<=this.max),n=r[i].handle,i>this.size||this.leq(s[t].key,s[n].key)){r[e].handle=t,s[t].node=e;break}r[e].handle=n,s[n].node=e,e=i}},e.prototype.floatUp_=function(e){var t,n,i,r=this.nodes,s=this.handles;for(t=r[e].handle;;){if(n=r[i=e>>1].handle,0===i||this.leq(s[n].key,s[t].key)){r[e].handle=t,s[t].node=e;break}r[e].handle=n,s[n].node=e,e=i}},e.prototype.init=function(){for(var e=this.size;e>=1;--e)this.floatDown_(e);this.initialized=!0},e.prototype.min=function(){return this.handles[this.nodes[1].handle].key},e.prototype.insert=function(e){var t,n;if(2*(t=++this.size)>this.max){var i,r;for(this.max*=2,r=this.nodes.length,this.nodes.length=this.max+1,i=r;i<this.nodes.length;i++)this.nodes[i]=new cj;for(r=this.handles.length,this.handles.length=this.max+1,i=r;i<this.handles.length;i++)this.handles[i]=new hj}return 0===this.freeList?n=t:(n=this.freeList,this.freeList=this.handles[n].node),this.nodes[t].handle=n,this.handles[n].node=t,this.handles[n].key=e,this.initialized&&this.floatUp_(t),n},e.prototype.extractMin=function(){var e=this.nodes,t=this.handles,n=e[1].handle,i=t[n].key;return this.size>0&&(e[1].handle=e[this.size].handle,t[e[1].handle].node=1,t[n].key=null,t[n].node=this.freeList,this.freeList=n,--this.size,this.size>0&&this.floatDown_(1)),i},e.prototype.delete=function(e){var t,n=this.nodes,i=this.handles;rj(e>=1&&e<=this.max&&null!==i[e].key),n[t=i[e].node].handle=n[this.size].handle,i[n[t].handle].node=t,--this.size,t<=this.size&&(t<=1||this.leq(i[n[t>>1].handle].key,i[n[t].handle].key)?this.floatDown_(t):this.floatUp_(t)),i[e].key=null,i[e].node=this.freeList,this.freeList=e},e}(),pj=function(){this.eUp=null,this.nodeUp=null,this.windingNumber=0,this.inside=!1,this.sentinel=!1,this.dirty=!1,this.fixUpperEdge=!1},fj=function(){this.key=null,this.next=null,this.prev=null},mj=function(){function e(e,t){this.frame=e,this.leq=t,this.head=new fj,this.head.next=this.head,this.head.prev=this.head}return e.prototype.min=function(){return this.head.next},e.prototype.max=function(){return this.head.prev},e.prototype.insert=function(e){return this.insertBefore(this.head,e)},e.prototype.search=function(e){var t=this.head;do{t=t.next}while(null!==t.key&&!this.leq(this.frame,e,t.key));return t},e.prototype.insertBefore=function(e,t){do{e=e.prev}while(null!==e.key&&!this.leq(this.frame,e.key,t));var n=new fj;return n.key=t,n.next=e.next,e.next.prev=n,n.prev=e,e.next=n,n},e.prototype.delete=function(e){e.next.prev=e.prev,e.prev.next=e.next},e}(),gj=function(){function e(){}return e.regionBelow=function(e){return e.nodeUp.prev.key},e.regionAbove=function(e){return e.nodeUp.next.key},e.debugEvent=function(e){},e.addWinding=function(e,t){e.winding+=t.winding,e.Sym.winding+=t.Sym.winding},e.edgeLeq=function(e,t,n){var i=e.event,r=t.eUp,s=n.eUp;return r.Dst===i?s.Dst===i?sj.vertLeq(r.Org,s.Org)?sj.edgeSign(s.Dst,r.Org,s.Org)<=0:sj.edgeSign(r.Dst,s.Org,r.Org)>=0:sj.edgeSign(s.Dst,i,s.Org)<=0:s.Dst===i?sj.edgeSign(r.Dst,i,r.Org)>=0:sj.edgeEval(r.Dst,i,r.Org)>=sj.edgeEval(s.Dst,i,s.Org)},e.deleteRegion=function(e,t){t.fixUpperEdge&&rj(0===t.eUp.winding),t.eUp.activeRegion=null,e.dict.delete(t.nodeUp)},e.fixUpperEdge=function(e,t,n){rj(t.fixUpperEdge),e.mesh.delete(t.eUp),t.fixUpperEdge=!1,t.eUp=n,n.activeRegion=t},e.topLeftRegion=function(t,n){var i,r=n.eUp.Org;do{n=e.regionAbove(n)}while(n.eUp.Org===r);if(n.fixUpperEdge){if(null===(i=t.mesh.connect(e.regionBelow(n).eUp.Sym,n.eUp.Lnext)))return null;e.fixUpperEdge(t,n,i),n=e.regionAbove(n)}return n},e.topRightRegion=function(t){var n=t.eUp.Dst;do{t=e.regionAbove(t)}while(t.eUp.Dst===n);return t},e.addRegionBelow=function(e,t,n){var i=new pj;return i.eUp=n,i.nodeUp=e.dict.insertBefore(t.nodeUp,i),i.fixUpperEdge=!1,i.sentinel=!1,i.dirty=!1,n.activeRegion=i,i},e.isWindingInside=function(e,t){switch(e.windingRule){case WN.ODD:return 0!==(1&t);case WN.NONZERO:return 0!==t;case WN.POSITIVE:return t>0;case WN.NEGATIVE:return t<0;case WN.ABS_GEQ_TWO:return t>=2||t<=-2}throw new Error("Invalid winding rulle")},e.computeWinding=function(t,n){n.windingNumber=e.regionAbove(n).windingNumber+n.eUp.winding,n.inside=e.isWindingInside(t,n.windingNumber)},e.finishRegion=function(t,n){var i=n.eUp,r=i.Lface;r.inside=n.inside,r.anEdge=i,e.deleteRegion(t,n)},e.finishLeftRegions=function(t,n,i){for(var r,s=null,a=n,o=n.eUp;a!==i;){if(a.fixUpperEdge=!1,(r=(s=e.regionBelow(a)).eUp).Org!=o.Org){if(!s.fixUpperEdge){e.finishRegion(t,a);break}r=t.mesh.connect(o.Lprev,r.Sym),e.fixUpperEdge(t,s,r)}o.Onext!==r&&(t.mesh.splice(r.Oprev,r),t.mesh.splice(o,r)),e.finishRegion(t,a),o=s.eUp,a=s}return o},e.addRightEdges=function(t,n,i,r,s,a){var o,l,u,c,h=!0;u=i;do{rj(sj.vertLeq(u.Org,u.Dst)),e.addRegionBelow(t,n,u.Sym),u=u.Onext}while(u!==r);for(null===s&&(s=e.regionBelow(n).eUp.Rprev),l=n,c=s;(u=(o=e.regionBelow(l)).eUp.Sym).Org===c.Org;)u.Onext!==c&&(t.mesh.splice(u.Oprev,u),t.mesh.splice(c.Oprev,u)),o.windingNumber=l.windingNumber-u.winding,o.inside=e.isWindingInside(t,o.windingNumber),l.dirty=!0,!h&&e.checkForRightSplice(t,l)&&(e.addWinding(u,c),e.deleteRegion(t,l),t.mesh.delete(c)),h=!1,l=o,c=u;l.dirty=!0,rj(l.windingNumber-u.winding===o.windingNumber),a&&e.walkDirtyRegions(t,l)},e.spliceMergeVertices=function(e,t,n){e.mesh.splice(t,n)},e.vertexWeights=function(e,t,n){var i=sj.vertL1dist(t,e),r=sj.vertL1dist(n,e),s=.5*r/(i+r),a=.5*i/(i+r);e.coords[0]+=s*t.coords[0]+a*n.coords[0],e.coords[1]+=s*t.coords[1]+a*n.coords[1],e.coords[2]+=s*t.coords[2]+a*n.coords[2]},e.getIntersectData=function(t,n,i,r,s,a){n.coords[0]=n.coords[1]=n.coords[2]=0,n.idx=-1,e.vertexWeights(n,i,r),e.vertexWeights(n,s,a)},e.checkForRightSplice=function(t,n){var i=e.regionBelow(n),r=n.eUp,s=i.eUp;if(sj.vertLeq(r.Org,s.Org)){if(sj.edgeSign(s.Dst,r.Org,s.Org)>0)return!1;sj.vertEq(r.Org,s.Org)?r.Org!==s.Org&&(t.pq.delete(r.Org.pqHandle),e.spliceMergeVertices(t,s.Oprev,r)):(t.mesh.splitEdge(s.Sym),t.mesh.splice(r,s.Oprev),n.dirty=i.dirty=!0)}else{if(sj.edgeSign(r.Dst,s.Org,r.Org)<0)return!1;e.regionAbove(n).dirty=n.dirty=!0,t.mesh.splitEdge(r.Sym),t.mesh.splice(s.Oprev,r)}return!0},e.checkForLeftSplice=function(t,n){var i,r=e.regionBelow(n),s=n.eUp,a=r.eUp;if(rj(!sj.vertEq(s.Dst,a.Dst)),sj.vertLeq(s.Dst,a.Dst)){if(sj.edgeSign(s.Dst,a.Dst,s.Org)<0)return!1;e.regionAbove(n).dirty=n.dirty=!0,i=t.mesh.splitEdge(s),t.mesh.splice(a.Sym,i),i.Lface.inside=n.inside}else{if(sj.edgeSign(a.Dst,s.Dst,a.Org)>0)return!1;n.dirty=r.dirty=!0,i=t.mesh.splitEdge(a),t.mesh.splice(s.Lnext,a.Sym),i.Rface.inside=n.inside}return!0},e.checkForIntersect=function(t,n){var i,r,s=e.regionBelow(n),a=n.eUp,o=s.eUp,l=a.Org,u=o.Org,c=a.Dst,h=o.Dst,d=new lj;if(rj(!sj.vertEq(h,c)),rj(sj.edgeSign(c,t.event,l)<=0),rj(sj.edgeSign(h,t.event,u)>=0),rj(l!==t.event&&u!==t.event),rj(!n.fixUpperEdge&&!s.fixUpperEdge),l===u||Math.min(l.t,c.t)>Math.max(u.t,h.t))return!1;if(sj.vertLeq(l,u)){if(sj.edgeSign(h,l,u)>0)return!1}else if(sj.edgeSign(c,u,l)<0)return!1;return e.debugEvent(t),sj.intersect(c,l,h,u,d),rj(Math.min(l.t,c.t)<=d.t),rj(d.t<=Math.max(u.t,h.t)),rj(Math.min(h.s,c.s)<=d.s),rj(d.s<=Math.max(u.s,l.s)),sj.vertLeq(d,t.event)&&(d.s=t.event.s,d.t=t.event.t),i=sj.vertLeq(l,u)?l:u,sj.vertLeq(i,d)&&(d.s=i.s,d.t=i.t),sj.vertEq(d,l)||sj.vertEq(d,u)?(e.checkForRightSplice(t,n),!1):!sj.vertEq(c,t.event)&&sj.edgeSign(c,t.event,d)>=0||!sj.vertEq(h,t.event)&&sj.edgeSign(h,t.event,d)<=0?h===t.event?(t.mesh.splitEdge(a.Sym),t.mesh.splice(o.Sym,a),n=e.topLeftRegion(t,n),a=e.regionBelow(n).eUp,e.finishLeftRegions(t,e.regionBelow(n),s),e.addRightEdges(t,n,a.Oprev,a,a,!0),!0):c===t.event?(t.mesh.splitEdge(o.Sym),t.mesh.splice(a.Lnext,o.Oprev),s=n,n=e.topRightRegion(n),r=e.regionBelow(n).eUp.Rprev,s.eUp=o.Oprev,o=e.finishLeftRegions(t,s,null),e.addRightEdges(t,n,o.Onext,a.Rprev,r,!0),!0):(sj.edgeSign(c,t.event,d)>=0&&(e.regionAbove(n).dirty=n.dirty=!0,t.mesh.splitEdge(a.Sym),a.Org.s=t.event.s,a.Org.t=t.event.t),sj.edgeSign(h,t.event,d)<=0&&(n.dirty=s.dirty=!0,t.mesh.splitEdge(o.Sym),o.Org.s=t.event.s,o.Org.t=t.event.t),!1):(t.mesh.splitEdge(a.Sym),t.mesh.splitEdge(o.Sym),t.mesh.splice(o.Oprev,a),a.Org.s=d.s,a.Org.t=d.t,a.Org.pqHandle=t.pq.insert(a.Org),e.getIntersectData(t,a.Org,l,c,u,h),e.regionAbove(n).dirty=n.dirty=s.dirty=!0,!1)},e.walkDirtyRegions=function(t,n){for(var i,r,s=e.regionBelow(n);;){for(;s.dirty;)n=s,s=e.regionBelow(s);if(!n.dirty&&(s=n,null===(n=e.regionAbove(n))||!n.dirty))return;if(n.dirty=!1,i=n.eUp,r=s.eUp,i.Dst!==r.Dst&&e.checkForLeftSplice(t,n)&&(s.fixUpperEdge?(e.deleteRegion(t,s),t.mesh.delete(r),r=(s=e.regionBelow(n)).eUp):n.fixUpperEdge&&(e.deleteRegion(t,n),t.mesh.delete(i),i=(n=e.regionAbove(s)).eUp)),i.Org!==r.Org)if(i.Dst===r.Dst||n.fixUpperEdge||s.fixUpperEdge||i.Dst!==t.event&&r.Dst!==t.event)e.checkForRightSplice(t,n);else if(e.checkForIntersect(t,n))return;i.Org===r.Org&&i.Dst===r.Dst&&(e.addWinding(r,i),e.deleteRegion(t,n),t.mesh.delete(i),n=e.regionAbove(s))}},e.connectRightVertex=function(t,n,i){var r,s=i.Onext,a=e.regionBelow(n),o=n.eUp,l=a.eUp,u=!1;o.Dst!==l.Dst&&e.checkForIntersect(t,n),sj.vertEq(o.Org,t.event)&&(t.mesh.splice(s.Oprev,o),n=e.topLeftRegion(t,n),s=e.regionBelow(n).eUp,e.finishLeftRegions(t,e.regionBelow(n),a),u=!0),sj.vertEq(l.Org,t.event)&&(t.mesh.splice(i,l.Oprev),i=e.finishLeftRegions(t,a,null),u=!0),u?e.addRightEdges(t,n,i.Onext,s,s,!0):(r=sj.vertLeq(l.Org,o.Org)?l.Oprev:o,r=t.mesh.connect(i.Lprev,r),e.addRightEdges(t,n,r,r.Onext,r.Onext,!1),r.Sym.activeRegion.fixUpperEdge=!0,e.walkDirtyRegions(t,n))},e.connectLeftDegenerate=function(t,n,i){var r,s,a,o,l;return r=n.eUp,sj.vertEq(r.Org,i)?(rj(!1),void e.spliceMergeVertices(t,r,i.anEdge)):sj.vertEq(r.Dst,i)?(rj(!1),n=e.topRightRegion(n),s=o=(a=(l=e.regionBelow(n)).eUp.Sym).Onext,l.fixUpperEdge&&(rj(s!==a),e.deleteRegion(t,l),t.mesh.delete(a),a=s.Oprev),t.mesh.splice(i.anEdge,a),sj.edgeGoesLeft(s)||(s=null),void e.addRightEdges(t,n,a.Onext,o,s,!0)):(t.mesh.splitEdge(r.Sym),n.fixUpperEdge&&(t.mesh.delete(r.Onext),n.fixUpperEdge=!1),t.mesh.splice(i.anEdge,r),void e.sweepEvent(t,i))},e.connectLeftVertex=function(t,n){var i,r,s,a,o,l,u=new pj;if(u.eUp=n.anEdge.Sym,i=t.dict.search(u).key,r=e.regionBelow(i)){if(a=i.eUp,o=r.eUp,0===sj.edgeSign(a.Dst,n,a.Org))return void e.connectLeftDegenerate(t,i,n);if(s=sj.vertLeq(o.Dst,a.Dst)?i:r,i.inside||s.fixUpperEdge){if(s===i)l=t.mesh.connect(n.anEdge.Sym,a.Lnext);else l=t.mesh.connect(o.Dnext,n.anEdge).Sym;s.fixUpperEdge?e.fixUpperEdge(t,s,l):e.computeWinding(t,e.addRegionBelow(t,i,l)),e.sweepEvent(t,n)}else e.addRightEdges(t,i,n.anEdge,n.anEdge,null,!0)}},e.sweepEvent=function(t,n){t.event=n,e.debugEvent(t);for(var i=n.anEdge;null===i.activeRegion;)if((i=i.Onext)===n.anEdge)return void e.connectLeftVertex(t,n);var r=e.topLeftRegion(t,i.activeRegion);rj(null!==r);var s=e.regionBelow(r),a=s.eUp,o=e.finishLeftRegions(t,s,null);o.Onext===a?e.connectRightVertex(t,r,o):e.addRightEdges(t,r,o.Onext,a,a,!0)},e.addSentinel=function(e,t,n,i){var r=new pj,s=e.mesh.makeEdge();s.Org.s=n,s.Org.t=i,s.Dst.s=t,s.Dst.t=i,e.event=s.Dst,r.eUp=s,r.windingNumber=0,r.inside=!1,r.fixUpperEdge=!1,r.sentinel=!0,r.dirty=!1,r.nodeUp=e.dict.insert(r)},e.initEdgeDict=function(t){t.dict=new mj(t,e.edgeLeq);var n=t.bmax[0]-t.bmin[0],i=t.bmax[1]-t.bmin[1],r=t.bmin[0]-n,s=t.bmax[0]+n,a=t.bmin[1]-i,o=t.bmax[1]+i;e.addSentinel(t,r,s,a),e.addSentinel(t,r,s,o)},e.doneEdgeDict=function(t){for(var n,i=0;null!==(n=t.dict.min().key);)n.sentinel||(rj(n.fixUpperEdge),rj(1===++i)),rj(0===n.windingNumber),e.deleteRegion(t,n)},e.removeDegenerateEdges=function(t){var n,i,r,s=t.mesh.eHead;for(n=s.next;n!==s;n=i)i=n.next,r=n.Lnext,sj.vertEq(n.Org,n.Dst)&&n.Lnext.Lnext!==n&&(e.spliceMergeVertices(t,r,n),t.mesh.delete(n),r=(n=r).Lnext),r.Lnext===n&&(r!==n&&((r===i||r===i.Sym)&&(i=i.next),t.mesh.delete(r)),(n===i||n===i.Sym)&&(i=i.next),t.mesh.delete(n))},e.initPriorityQ=function(e){var t,n,i,r=0;for(n=(i=e.mesh.vHead).next;n!==i;n=n.next)r++;for(r+=8,t=e.pq=new dj(r,sj.vertLeq),n=(i=e.mesh.vHead).next;n!==i;n=n.next)n.pqHandle=t.insert(n);return n===i&&(t.init(),!0)},e.donePriorityQ=function(e){e.pq=null},e.removeDegenerateFaces=function(t,n){var i,r,s;for(i=n.fHead.next;i!==n.fHead;i=r)r=i.next,rj((s=i.anEdge).Lnext!==s),s.Lnext.Lnext===s&&(e.addWinding(s.Onext,s),t.mesh.delete(s));return!0},e.computeInterior=function(t,n){var i,r;if(void 0===n&&(n=!0),e.removeDegenerateEdges(t),!e.initPriorityQ(t))return!1;for(e.initEdgeDict(t);null!==(i=t.pq.extractMin());){for(;null!==(r=t.pq.min())&&sj.vertEq(r,i);)r=t.pq.extractMin(),e.spliceMergeVertices(t,i.anEdge,r.anEdge);e.sweepEvent(t,i)}return t.event=t.dict.min().key.eUp.Org,e.debugEvent(t),e.doneEdgeDict(t),e.donePriorityQ(t),!!e.removeDegenerateFaces(t,t.mesh)&&(n&&t.mesh.check(),!0)},e}(),vj=function(){function e(){this.mesh=new uj,this.normal=[0,0,0],this.sUnit=[0,0,0],this.tUnit=[0,0,0],this.bmin=[0,0],this.bmax=[0,0],this.windingRule=WN.ODD,this.dict=null,this.pq=null,this.event=null,this.vertexIndexCounter=0,this.vertices=[],this.vertexIndices=[],this.vertexCount=0,this.elements=[],this.elementCount=0}return e.prototype.dot_=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]},e.prototype.normalize_=function(e){var t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2];if(!t)throw"Zero-size vector!";t=Math.sqrt(t),e[0]/=t,e[1]/=t,e[2]/=t},e.prototype.longAxis_=function(e){var t=0;return Math.abs(e[1])>Math.abs(e[0])&&(t=1),Math.abs(e[2])>Math.abs(e[t])&&(t=2),t},e.prototype.computeNormal_=function(e){var t,n,i,r,s,a,o=[0,0,0],l=[0,0,0],u=[0,0,0],c=[0,0,0],h=[0,0,0],d=[null,null,null],p=[null,null,null],f=this.mesh.vHead;t=f.next;for(var m=0;m<3;++m)r=t.coords[m],l[m]=r,p[m]=t,o[m]=r,d[m]=t;for(t=f.next;t!==f;t=t.next)for(var g=0;g<3;++g)(r=t.coords[g])<l[g]&&(l[g]=r,p[g]=t),r>o[g]&&(o[g]=r,d[g]=t);var v=0;if(o[1]-l[1]>o[0]-l[0]&&(v=1),o[2]-l[2]>o[v]-l[v]&&(v=2),l[v]>=o[v])return e[0]=0,e[1]=0,void(e[2]=1);for(a=0,n=p[v],i=d[v],u[0]=n.coords[0]-i.coords[0],u[1]=n.coords[1]-i.coords[1],u[2]=n.coords[2]-i.coords[2],t=f.next;t!==f;t=t.next)c[0]=t.coords[0]-i.coords[0],c[1]=t.coords[1]-i.coords[1],c[2]=t.coords[2]-i.coords[2],h[0]=u[1]*c[2]-u[2]*c[1],h[1]=u[2]*c[0]-u[0]*c[2],h[2]=u[0]*c[1]-u[1]*c[0],(s=h[0]*h[0]+h[1]*h[1]+h[2]*h[2])>a&&(a=s,e[0]=h[0],e[1]=h[1],e[2]=h[2]);a<=0&&(e[0]=e[1]=e[2]=0,e[this.longAxis_(u)]=1)},e.prototype.checkOrientation_=function(){for(var e,t,n=this.mesh.fHead,i=this.mesh.vHead,r=0,s=n.next;s!==n;s=s.next)if(!((t=s.anEdge).winding<=0))do{r+=(t.Org.s-t.Dst.s)*(t.Org.t+t.Dst.t),t=t.Lnext}while(t!==s.anEdge);if(r<0){for(e=i.next;e!==i;e=e.next)e.t=-e.t;this.tUnit[0]=-this.tUnit[0],this.tUnit[1]=-this.tUnit[1],this.tUnit[2]=-this.tUnit[2]}},e.prototype.projectPolygon_=function(){var e,t,n=this.mesh.vHead,i=[0,0,0],r=!1;i[0]=this.normal[0],i[1]=this.normal[1],i[2]=this.normal[2],!i[0]&&!i[1]&&!i[2]&&(this.computeNormal_(i),r=!0),e=this.sUnit,t=this.tUnit;var s=this.longAxis_(i);e[s]=0,e[(s+1)%3]=1,e[(s+2)%3]=0,t[s]=0,t[(s+1)%3]=0,t[(s+2)%3]=i[s]>0?1:-1;for(var a=n.next;a!==n;a=a.next)a.s=this.dot_(a.coords,e),a.t=this.dot_(a.coords,t);r&&this.checkOrientation_();for(var o=!0,l=n.next;l!==n;l=l.next)o?(this.bmin[0]=this.bmax[0]=l.s,this.bmin[1]=this.bmax[1]=l.t,o=!1):(l.s<this.bmin[0]&&(this.bmin[0]=l.s),l.s>this.bmax[0]&&(this.bmax[0]=l.s),l.t<this.bmin[1]&&(this.bmin[1]=l.t),l.t>this.bmax[1]&&(this.bmax[1]=l.t))},e.prototype.addWinding_=function(e,t){e.winding+=t.winding,e.Sym.winding+=t.Sym.winding},e.prototype.tessellateMonoRegion_=function(e,t){var n,i;if((n=t.anEdge).Lnext===n||n.Lnext.Lnext===n)throw"Mono region invalid";for(;sj.vertLeq(n.Dst,n.Org);n=n.Lprev);for(;sj.vertLeq(n.Org,n.Dst);n=n.Lnext);i=n.Lprev;for(;n.Lnext!==i;)if(sj.vertLeq(n.Dst,i.Org)){for(;i.Lnext!==n&&(sj.edgeGoesLeft(i.Lnext)||sj.edgeSign(i.Org,i.Dst,i.Lnext.Dst)<=0);)i=e.connect(i.Lnext,i).Sym;i=i.Lprev}else{for(;i.Lnext!==n&&(sj.edgeGoesRight(n.Lprev)||sj.edgeSign(n.Dst,n.Org,n.Lprev.Org)>=0);)n=e.connect(n,n.Lprev).Sym;n=n.Lnext}if(i.Lnext===n)throw"Mono region invalid";for(;i.Lnext.Lnext!==n;)i=e.connect(i.Lnext,i).Sym;return!0},e.prototype.tessellateInterior_=function(e){for(var t,n=e.fHead.next;n!==e.fHead;n=t)if(t=n.next,n.inside&&!this.tessellateMonoRegion_(e,n))return!1;return!0},e.prototype.discardExterior_=function(e){for(var t,n=e.fHead.next;n!==e.fHead;n=t)t=n.next,n.inside||e.zapFace(n)},e.prototype.setWindingNumber_=function(e,t,n){for(var i,r=e.eHead.next;r!==e.eHead;r=i)i=r.next,r.Rface.inside!==r.Lface.inside?r.winding=r.Lface.inside?t:-t:n?e.delete(r):r.winding=0},e.prototype.getNeighbourFace_=function(e){return e.Rface&&e.Rface.inside?e.Rface.n:-1},e.prototype.outputPolymesh_=function(e,t,n,i){var r,s,a=0,o=0;n>3&&e.mergeConvexFaces(n);for(var l=e.vHead.next;l!==e.vHead;l=l.next)l.n=-1;for(var u=e.fHead.next;u!==e.fHead;u=u.next)if(u.n=-1,u.inside){r=u.anEdge,s=0;do{-1===(l=r.Org).n&&(l.n=o,o++),s++,r=r.Lnext}while(r!==u.anEdge);if(s>n)throw"Face vertex greater that support polygon";u.n=a,++a}this.elementCount=a,t===GN.CONNECTED_POLYGONS&&(a*=2),this.elements=[],this.elements.length=a*n,this.vertexCount=o,this.vertices=[],this.vertices.length=o*i,this.vertexIndices=[],this.vertexIndices.length=o;for(l=e.vHead.next;l!==e.vHead;l=l.next)if(-1!==l.n){var c=l.n*i;this.vertices[c+0]=l.coords[0],this.vertices[c+1]=l.coords[1],i>2&&(this.vertices[c+2]=l.coords[2]),this.vertexIndices[l.n]=l.idx}var h=0;for(u=e.fHead.next;u!==e.fHead;u=u.next)if(u.inside){r=u.anEdge,s=0;do{l=r.Org;this.elements[h++]=l.n,s++,r=r.Lnext}while(r!==u.anEdge);for(var d=s;d<n;++d)this.elements[h++]=-1;if(t===GN.CONNECTED_POLYGONS){r=u.anEdge;do{this.elements[h++]=this.getNeighbourFace_(r),r=r.Lnext}while(r!==u.anEdge);for(var p=s;p<n;++p)this.elements[h++]=-1}}},e.prototype.outputContours_=function(e,t){var n,i,r=0,s=0;this.vertexCount=0,this.elementCount=0;for(var a=e.fHead.next;a!==e.fHead;a=a.next)if(a.inside){i=n=a.anEdge;do{this.vertexCount++,n=n.Lnext}while(n!==i);this.elementCount++}this.elements=[],this.elements.length=2*this.elementCount,this.vertices=[],this.vertices.length=this.vertexCount*t,this.vertexIndices=[],this.vertexIndices.length=this.vertexCount;var o=0,l=0,u=0;r=0;for(a=e.fHead.next;a!==e.fHead;a=a.next)if(a.inside){s=0,i=n=a.anEdge;do{this.vertices[o++]=n.Org.coords[0],this.vertices[o++]=n.Org.coords[1],t>2&&(this.vertices[o++]=n.Org.coords[2]),this.vertexIndices[l++]=this.vertexIdCallback?this.vertexIdCallback(n):n.Org.idx,s++,n=n.Lnext}while(n!==i);this.elements[u++]=r,this.elements[u++]=s,r+=s}},e.prototype.addContour=function(e,t){null===this.mesh&&(this.mesh=new uj),e<2&&(e=2),e>3&&(e=3);for(var n=null,i=0;i<t.length;i+=e)null===n?(n=this.mesh.makeEdge(),this.mesh.splice(n,n.Sym)):(this.mesh.splitEdge(n),n=n.Lnext),n.Org.coords[0]=t[i+0],n.Org.coords[1]=t[i+1],n.Org.coords[2]=e>2?t[i+2]:0,n.Org.idx=this.vertexIndexCounter++,this.edgeCreateCallback&&this.edgeCreateCallback(n),n.winding=1,n.Sym.winding=-1},e.prototype.tesselate=function(e,t,n,i,r,s){if(void 0===e&&(e=WN.ODD),void 0===t&&(t=GN.POLYGONS),void 0===s&&(s=!0),this.vertices=[],this.elements=[],this.vertexIndices=[],this.vertexIndexCounter=0,r&&(this.normal[0]=r[0],this.normal[1]=r[1],this.normal[2]=r[2]),this.windingRule=e,i<2&&(i=2),i>3&&(i=3),!this.mesh)return!1;this.projectPolygon_(),gj.computeInterior(this,s);var a=this.mesh;return t===GN.BOUNDARY_CONTOURS?this.setWindingNumber_(a,1,!0):this.tessellateInterior_(a),s&&a.check(),t===GN.BOUNDARY_CONTOURS?this.outputContours_(a,i):this.outputPolymesh_(a,t,n,i),!0},e}();function yj(e){var t=e.windingRule,n=void 0===t?WN.ODD:t,i=e.elementType,r=void 0===i?GN.POLYGONS:i,s=e.polySize,a=void 0===s?3:s,o=e.vertexSize,l=void 0===o?2:o,u=e.normal,c=void 0===u?[0,0,1]:u,h=e.contours,d=void 0===h?[]:h,p=e.strict,f=void 0===p||p,m=e.debug,g=void 0!==m&&m;if(!d&&f)throw new Error("Contours can't be empty");if(d){var v=new vj;e.edgeCreateCallback&&(v.edgeCreateCallback=e.edgeCreateCallback),e.vertexIdCallback&&(v.vertexIdCallback=e.vertexIdCallback);for(var y=0;y<d.length;y++)v.addContour(l||2,d[y]);return v.tesselate(n,r,a,l,c,f),{vertices:v.vertices,vertexIndices:v.vertexIndices,vertexCount:v.vertexCount,elements:v.elements,elementCount:v.elementCount,mesh:g?v.mesh:void 0}}}WN.ODD,WN.NONZERO,WN.POSITIVE,WN.NEGATIVE,WN.ABS_GEQ_TWO,GN.POLYGONS,GN.CONNECTED_POLYGONS,GN.BOUNDARY_CONTOURS;var xj=class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:256,t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.capacity=e,this.size=0,this.debug=t,this.debug&&console.log("allocating with cap ".concat(e));let n=e*xj.eSize;this.buffer=new ArrayBuffer(n);let i=Float32Array.BYTES_PER_ELEMENT,r=0;this.positions=new Float32Array(this.buffer,r*i,3*e),r+=3*e,this.normals=new Float32Array(this.buffer,r*i,3*e),r+=3*e,this.uvs=new Float32Array(this.buffer,r*i,2*e)}realloc(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(e<this.size)throw Error("cannot shrink buffer");if(e<=this.capacity&&!t)return;this.debug&&console.log("resizing from ".concat(this.capacity," \u2192 ").concat(e));let n=e*xj.eSize,i=new ArrayBuffer(n),r=Float32Array.BYTES_PER_ELEMENT,s=0,a=new Float32Array(i,s*r,3*e);s+=3*e;let o=new Float32Array(i,s*r,3*e);s+=3*e;let l=new Float32Array(i,s*r,2*e);t?(a.set(this.positions.subarray(0,3*this.size)),o.set(this.normals.subarray(0,3*this.size)),l.set(this.uvs.subarray(0,2*this.size))):(a.set(this.positions),o.set(this.normals),l.set(this.uvs)),this.buffer=i,this.positions=a,this.normals=o,this.uvs=l,this.capacity=e}get(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=this.size+e;if(t>this.capacity){let e=this.capacity;for(;t>e;)e*=2;this.realloc(e)}let n=this.size;return this.size=t,n}reserve(e){let t=this.size+e;t>this.capacity&&this.realloc(t)}shrink(){this.debug&&console.log("shrinking ".concat(this.capacity," \u2192 ").concat(this.size)),this.realloc(this.size,!0)}},bj=xj;bj.eSize=8*Float32Array.BYTES_PER_ELEMENT;var wj=class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(e,t)=>e<t?-1:e>t?1:0;if(this.data=e,this.length=this.data.length,this.compare=t,this.length>0)for(let n=(this.length>>1)-1;n>=0;n--)this._down(n)}push(e){this.data.push(e),this._up(this.length++)}pop(){if(0===this.length)return;let e=this.data[0],t=this.data.pop();return--this.length>0&&(this.data[0]=t,this._down(0)),e}peek(){return this.data[0]}_up(e){let{data:t,compare:n}=this,i=t[e];for(;e>0;){let r=e-1>>1,s=t[r];if(n(i,s)>=0)break;t[e]=s,e=r}t[e]=i}_down(e){let{data:t,compare:n}=this,i=this.length>>1,r=t[e];for(;e<i;){let i=1+(e<<1),s=i+1;if(s<this.length&&n(t[s],t[i])<0&&(i=s),n(t[i],r)>=0)break;t[e]=t[i],e=i}t[e]=r}};function Dj(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=1/0,s=1/0,a=-1/0,o=-1/0;for(let[y,x]of e[0])y<r&&(r=y),x<s&&(s=x),y>a&&(a=y),x>o&&(o=x);let l=a-r,u=o-s,c=Math.max(n,Math.min(l,u));if(c===n){let e=[r,s];return e.distance=0,e.distance}let h=new wj([],((e,t)=>t.max-e.max)),d=function(e){let t=0,n=0,i=0,r=e[0];for(let a=0,o=r.length,l=o-1;a<o;l=a++){let e=r[a],s=r[l],o=e[0]*s[1]-s[0]*e[1];n+=(e[0]+s[0])*o,i+=(e[1]+s[1])*o,t+=3*o}let s=new _j(n/t,i/t,0,e);return 0===t||s.d<0?new _j(r[0][0],r[0][1],0,e):s}(e),p=new _j(r+l/2,s+u/2,0,e);p.d>d.d&&(d=p);let f=2;function m(r,s,a){let o=new _j(r,s,a,e);if(f++,o.max>d.d+n&&h.push(o),o.d>d.d&&(d=o,i&&console.log("found best ".concat(Math.round(1e4*o.d)/1e4," after ").concat(f," probes")),d.d>t))return t}let g=c/2;for(let y=r;y<a;y+=c)for(let e=s;e<o;e+=c)m(y+g,e+g,g);for(;h.length;){let{max:e,x:t,y:i,h:r}=h.pop();if(e-d.d<=n)break;g=r/2,m(t-g,i-g,g),m(t+g,i-g,g),m(t-g,i+g,g),m(t+g,i+g,g)}i&&console.log("num probes: ".concat(f,"\nbest distance: ").concat(d.d));let v=[d.x,d.y];return v.distance=d.d,v.distance}function _j(e,t,n,i){this.x=e,this.y=t,this.h=n,this.d=function(e,t,n){let i=!1,r=1/0;for(let s of n)for(let n=0,a=s.length,o=a-1;n<a;o=n++){let a=s[n],l=s[o];a[1]>t!=l[1]>t&&e<(l[0]-a[0])*(t-a[1])/(l[1]-a[1])+a[0]&&(i=!i),r=Math.min(r,Sj(e,t,a,l))}return 0===r?0:(i?1:-1)*Math.sqrt(r)}(e,t,i),this.max=this.d+this.h*Math.SQRT2}function Sj(e,t,n,i){let r=n[0],s=n[1],a=i[0]-r,o=i[1]-s;if(0!==a||0!==o){let n=((e-r)*a+(t-s)*o)/(a*a+o*o);n>1?(r=i[0],s=i[1]):n>0&&(r+=a*n,s+=o*n)}return a=e-r,o=t-s,a*a+o*o}var Ej={vertices:[160,160,-160,160,-160,-160,160,-160],vertexIndices:[1,0,3,2],vertexCount:4,elements:[0,4],elementCount:1,mesh:void 0},Cj={vertices:[],vertexIndices:[],vertexCount:0,elements:[],elementCount:0,mesh:void 0},Aj={vertices:[-160,160,160,-160,160,160,-160,-160],vertexIndices:[1,3,0,2],vertexCount:4,elements:[0,1,2,1,0,3],elementCount:2,mesh:void 0},Mj=(e,t)=>n=>{let[i,r]=n;return r<i&&(r+=t),(e>=i?e:e+t)<=r},Tj=class extends dx{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:12,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:3,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:WN.ODD,a=arguments.length>6&&void 0!==arguments[6]&&arguments[6];super(),this.forPathBevel=a,this.type="ShapeGeometry",this.vertexCache={},this._shape=e,this._depth=t,this._curveSegments=i,this._bevelSegmentsInput=r;let o,l,u,c=this._shape.extractShapePointsToFlatArray([],i),h=this._shape.shapeHoles.map((e=>{let t=e.extractShapePointsToFlatArray([],i),n=[];for(let i=t.length-1;i>=1;i-=2){let e=t[i-1],r=t[i-0];n.push(e,r)}return n})),d=[],p=[];for(let M=0;M<c.length;M+=2)p.push([c[M],c[M+1]]);d.push(p);for(let M=0;M<h.length;M++){let e=h[M],t=[];for(let n=0;n<e.length;n+=2)t.push([e[n],e[n+1]]);d.push(t)}o=e.isText?.1*(new xE).setFromPoints(e.points.map((e=>e.position))).getSize(new lv).length():0===d[0].length?n:n>0?Dj(d,n):1e-5,n<=0?(this._bevel=0,this._bevelSegments=0):(this._bevel=Math.min(n,o,t/2),this._bevelSegments=Math.floor(r));try{l=yj({windingRule:s,elementType:GN.BOUNDARY_CONTOURS,vertexSize:2,strict:!0,contours:[c]})}catch(E){l=Ej}try{u=yj({windingRule:WN.ODD,elementType:GN.BOUNDARY_CONTOURS,vertexSize:2,strict:!0,contours:[...h]})}catch(C){u=Cj}if(!l)throw new Error("error generating geometry");let f=l.elementCount;if(u){l.elementCount+=u.elementCount;for(let e=0;e<u.elements.length;e++){let t=u.elements[e],n=e%2===0?l.vertexCount:0;l.elements.push(t+n)}for(let e=0;e<u.vertexIndices.length;e++){let t=u.vertexIndices[e],n=l.vertexCount;l.vertexIndices.push(t+n)}for(let e=0;e<u.vertices.length;e++){let t=u.vertices[e];l.vertices.push(t)}}let m=1/0,g=-1/0,v=1/0,y=-1/0;for(let M=0,T=l.vertexCount;M<T;M++){let e=2*M,t=l.vertices[e+0],n=l.vertices[e+1];t<m&&(m=t),t>g&&(g=t),n<v&&(v=n),n>y&&(y=n)}this._minX=m,this._minY=v,this._width=g-m,this._height=y-v,this._buffer=new bj(this._computeBufferEstimatedSize(l));let x=[],b=[];for(let M=l.elementCount-1;M>=0;M--){let e=M>=f,t=2*M,n=l.elements[t+0],r=l.elements[t+1],s=n+r,u={start:n,count:r,normals:[],continuous:[],concave:[]},c=n,d=s-1,p=n+1,m=this._shape.roundedCurves.length;do{let t=c-n,i=l.vertices[2*d+0],a=l.vertices[2*d+1],o=l.vertices[2*c+0],h=l.vertices[2*c+1],f=l.vertices[2*p+0],g=l.vertices[2*p+1],v=o-i,y=h-a,x=Math.sqrt(v*v+y*y);v/=x,y/=x;let b=o-f,w=h-g,D=Math.sqrt(b*b+w*w);b/=D,w/=D,u.normals[2*t+0]=-w,u.normals[2*t+1]=b,u.concave[t]=v*w-y*b>0;let _=l.vertexIndices[c];if(Array.isArray(_))u.continuous[t]=!1;else{let[e,n]=this._shape.getCurveIndexFromVertexId(_-1,!0);if(n>0&&n<1)u.continuous[t]=!0;else{let i=1===n?e+1:e-1;i=(i+m)%m;let r=1===n?0:1,s=this._shape.roundedCurves[e].getTangent(n),a=this._shape.roundedCurves[i].getTangent(r);u.continuous[t]=s.dot(a)>.95}}e&&(u.normals[2*t+0]*=-1,u.normals[2*t+1]*=-1),[d,c,p]=[c,p,p+1],p>=s&&(p-=r)}while(p!==n+1);let g=[];g.push({bevelI:0,angle:0,size:0,boundary:{vertices:l.vertices.slice(2*n,2*s),vertexCount:r,vertexIndices:new Array(r).fill(!0).map(((e,t)=>[t,t])),elements:[0,r],elementCount:1,mesh:null},reverseMap:[],insetPoints:l.vertices.slice(2*n,2*s)});let v=0;for(let a=1;a<=this._bevelSegments;a++){let t=a/this._bevelSegments*Math.PI/2,n=(1-Math.cos(t))*this._bevel,s=[],o=[],c=[],h=[],d=0;for(let a=0;a<r;a++){let t=2*a,p=(a-1+r)%r*2,f=l.vertices[2*u.start+t+0],m=l.vertices[2*u.start+t+1],g=-u.normals[p+0]*n,v=-u.normals[p+1]*n,y=-u.normals[t+0]*n,x=-u.normals[t+1]*n;if(u.concave[a]||!u.concave[a]&&e){let t=Math.atan2(v,g),r=Math.atan2(x,y);r>t&&(r-=2*Math.PI);let o=r-t;if(u.continuous[a]||e){let i=t+o/2,r=Math.cos(i)*n,l=Math.sin(i)*n;s[2*d+0]=f+r*(e?-1:1),s[2*d+1]=m+l*(e?-1:1),h[d]=a,d++}else{let e=Math.max(1,Math.floor(i/4*Math.abs(o)/Math.PI));for(let i=0;i<=e;i++){let r=t+o*(i/e),l=Math.cos(r)*n,u=Math.sin(r)*n;s[2*d+0]=f+l,s[2*d+1]=m+u,h[d]=a,d++}}}else s[2*d+0]=f+g,s[2*d+1]=m+v,h[d]=a,o[a]=d,d++,s[2*d+0]=f,s[2*d+1]=m,h[d]=a,d++,s[2*d+0]=f+y,s[2*d+1]=m+x,h[d]=a,c[a]=d,d++}let p=yj({windingRule:WN.POSITIVE,elementType:GN.BOUNDARY_CONTOURS,vertexSize:2,strict:!0,contours:[s],edgeCreateCallback:e=>{let t=e.Org.idx,n=h[t],i=h[(t+1)%h.length];e.idx=[n,i],e.Sym.idx=[i,n]},vertexIdCallback:e=>{let t=e.Lprev.idx;return[t?t[1]:0,e.idx?e.idx[0]:0]}});if(!p)throw console.log("Error"),new Error("error generating bevel geometry for ".concat(a,"'th loop"));if(!p.vertexCount){let e=(a-1)/this._bevelSegments*Math.PI/2;v=(1-Math.sin(e))*this._bevel;break}for(let e=0;e<p.vertexIndices.length;e++){let[t,n]=p.vertexIndices[e];if(t===n)continue;let i=n;n<t&&(i+=r);for(let s=t;s<i;s++){let i=s%r,a=(s+1)%r;if(!u.continuous[i]||!u.continuous[a]){p.vertexIndices[e]=[t,i],p.vertexIndices.splice(e+1,0,[a,n]),p.vertices.splice(2*(e+1),0,p.vertices[2*e],p.vertices[2*e+1]);break}}}g.push({bevelI:a,angle:t,size:n,boundary:p,reverseMap:h,insetPoints:s})}let y=(e,t,n)=>{let i=0,r=e.boundary.vertexIndices.length;for(;i<r&&n(e.boundary.vertexIndices[t]);)t=(t+1)%r,i++;return i},w=x.length;for(let i=1;i<g.length;i++){let e=g[i-1],t=g[i],n=e.boundary.vertexIndices.length,s=t.boundary.vertexIndices.length;if(!n||!s)break;let o=u.concave.length,l=0,c=Mj(l,r);for(;!e.boundary.vertexIndices.filter(c).length||!t.boundary.vertexIndices.filter(c).length;)l++,c=Mj(l,r);let h=e.boundary.vertexIndices.findIndex(c),d=t.boundary.vertexIndices.findIndex(c);do{h=(h+1)%n}while(c(e.boundary.vertexIndices[h]));do{d=(d+1)%s}while(c(t.boundary.vertexIndices[d]));l=(l+1)%r;let p,f,m=l,v=0,b=this._buildBevelVert(u,e,(h-1+n)%n,void 0,v),w=this._buildBevelVert(u,t,(d-1+s)%s,void 0,v),D=!1;do{v=(l||o)/o,c=Mj(l,r);let i=y(e,h,c),m=y(t,d,c),g=D;if(D=!1,i&&!m){for(let t=0;t<i;t++)p=this._buildBevelVert(u,e,(h+t)%n,t/(i-1),v),x.push(b.topN,p.topP,w.topN),!1===a&&x.push(p.bottomP,b.bottomN,w.bottomN),b=p;D=!0}else if(!i&&m)for(let e=0;e<m;e++)f=this._buildBevelVert(u,t,(d+e)%s,e/(m-1),v),x.push(w.topN,b.topP,f.topP),!1===a&&x.push(b.bottomP,w.bottomN,f.bottomP),w=f;else if(i&&m)if(p=this._buildBevelVert(u,e,h,0,v),f=this._buildBevelVert(u,t,d,0,v),g?(x.push(b.topN,f.topP,w.topN),x.push(b.topN,p.topP,f.topP),!1===a&&(x.push(f.bottomP,b.bottomN,w.bottomN),x.push(f.bottomP,p.bottomP,b.bottomN))):(x.push(w.topN,b.topN,p.topP),x.push(w.topN,p.topP,f.topP),!1===a&&(x.push(p.bottomP,b.bottomN,w.bottomN),x.push(p.bottomP,w.bottomN,f.bottomP))),b=p,w=f,i===m)for(let r=1;r<i;r++)p=this._buildBevelVert(u,e,(h+r)%n,r/(i-1),v),f=this._buildBevelVert(u,t,(d+r)%s,r/(m-1),v),x.push(b.topN,p.topP,w.topN),x.push(w.topN,p.topP,f.topP),!1===a&&(x.push(p.bottomP,b.bottomN,w.bottomN),x.push(p.bottomP,w.bottomN,f.bottomP)),b=p,w=f;else if(i>m){let r=i/m,o=0;for(let l=1;l<i;l++)p=this._buildBevelVert(u,e,(h+l)%n,l/(i-1),v),x.push(b.topN,p.topP,w.topN),!1===a&&x.push(p.bottomP,b.bottomN,w.bottomN),b=p,l>(o+1)*r&&(o++,f=this._buildBevelVert(u,t,(d+o)%s,o/(m-1),v),x.push(w.topN,p.topP,f.topP),!1===a&&x.push(p.bottomP,w.bottomN,f.bottomP),w=f)}else{let r=m/i,o=0;for(let l=1;l<m;l++)f=this._buildBevelVert(u,t,(d+l)%s,l/(m-1),v),x.push(w.topN,p.topP,f.topP),!1===a&&x.push(p.bottomP,w.bottomN,f.bottomP),w=f,l>(o+1)*r&&(o++,p=this._buildBevelVert(u,e,(h+o)%n,o/(i-1),v),x.push(b.topN,p.topP,w.topN),!1===a&&x.push(p.bottomP,b.bottomN,w.bottomN),b=p)}h=(h+i)%n,d=(d+m)%s,l=(l+1)%o}while(l!==m)}if(!1===a&&this._depth>2*this._bevel&&this._buildWall(g,u,x),e){let e=[];for(let t=x.length-1;t>=w+2;t-=3){let n=x[t-2],i=x[t-1],r=x[t-0];e.push(r,i,n)}x.splice(w,x.length-w,...e)}if(e){let e=[];for(let t=g[g.length-1].boundary.vertices.length-1;t>=1;t-=2){let n=g[g.length-1].boundary.vertices[t-1],i=g[g.length-1].boundary.vertices[t-0];e.push(n,i)}b.push(e)}if(!e){let e,t=g[g.length-1];try{e=yj({windingRule:g.length>1?WN.POSITIVE:WN.ODD,elementType:GN.POLYGONS,vertexSize:2,strict:!0,contours:[t.insetPoints,...b]})}catch(A){e=Aj}if(!e)throw new Error("Error generating geometry for surface");0===h.length&&this._bevel<o&&Object.assign(this,{useNgonForTopBottomFaceDuringBake:!0});for(let n=0;n<3*e.elementCount;n+=3){let t=this._buildSurfaceVert(e,e.elements[n+0],v),i=this._buildSurfaceVert(e,e.elements[n+1],v),r=this._buildSurfaceVert(e,e.elements[n+2],v);x.push(t.top,i.top,r.top),!1===a&&x.push(r.bottom,i.bottom,t.bottom)}}this.vertexCache={}}this._buffer.shrink();let w=new tx(Uint32Array.from(x),1),D=new tx(this._buffer.positions,3),_=new tx(this._buffer.normals,3),S=new tx(this._buffer.uvs,2);D.needsUpdate=!0,_.needsUpdate=!0,S.needsUpdate=!0,w.needsUpdate=!0,this.setAttribute("position",D),this.setAttribute("normal",_),this.setAttribute("uv",S),this.setIndex(w)}_computeBufferEstimatedSize(e){return 2*e.vertexCount*(2+this._bevelSegments)}_buildWall(e,t,n){let i=e[0];for(let r=0,s=i.boundary.vertexCount;r<s;r++){let e=this._buildBevelVert(t,i,r),a=this._buildBevelVert(t,i,(r+1)%s);n.push(a.topP,e.topN,e.bottomN),n.push(a.topP,e.bottomN,a.bottomP)}}_buildSurfaceVert(e,t,n){let i=t.toString();if(i in this.vertexCache)return this.vertexCache[i];let r=e.vertices[2*t+0],s=e.vertices[2*t+1],a=(r-this._minX)/this._width,o=(s-this._minY)/this._height;this.forPathBevel&&(o=1);let l=this._buffer.get(this.forPathBevel?1:2),u=3*l,c=2*l,h={top:l+0,bottom:l+1};return this._buffer.positions[u+0]=r,this._buffer.positions[u+1]=s,this._buffer.positions[u+2]=this.forPathBevel?this._bevel:this._depth-n,this._buffer.normals[u+0]=0,this._buffer.normals[u+1]=0,this._buffer.normals[u+2]=1,this._buffer.uvs[c+0]=a,this._buffer.uvs[c+1]=o,!1===this.forPathBevel&&(this._buffer.positions[u+3]=r,this._buffer.positions[u+4]=s,this._buffer.positions[u+5]=n,this._buffer.normals[u+3]=0,this._buffer.normals[u+4]=0,this._buffer.normals[u+5]=-1,this._buffer.uvs[c+2]=a,this._buffer.uvs[c+3]=o),this.vertexCache[i]=h,h}_buildBevelVert(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,r=arguments.length>4?arguments[4]:void 0,s="".concat(t.bevelI,":").concat(n);if(s in this.vertexCache&&0!==r&&1!==r&&(!r||r===this.vertexCache[s].pathBevelUCoord))return this.vertexCache[s];let a,o,l,u,[c,h]=t.boundary.vertexIndices[n];c!==h?(o=c,a=h,u=!1,l=e.continuous[o]&&e.continuous[a]):(a=c,o=(a-1+e.count)%e.count,u=e.concave[a]&&t.bevelI>0,l=e.continuous[a]||u);let d=Math.cos(t.angle),p=Math.sin(t.angle),f=2*n,m=2*a,g=2*o,v=t.boundary.vertices[f+0],y=t.boundary.vertices[f+1],x=(1-p)*this._bevel,b=(v-this._minX)/this._width,w=(y-this._minY)/this._height;this.forPathBevel&&(void 0!==r&&(b=r),w=1);let D=e.normals[m+0],_=e.normals[m+1],S=e.normals[g+0],E=e.normals[g+1];if(u){D+=(S-D)*(1-i),_+=(E-_)*(1-i);let e=Math.sqrt(D*D+_*_);D/=e,_/=e}let C=this.forPathBevel?this._buffer.get(l?1:2):this._buffer.get(l?2:4),A=3*C,M=2*C,T={i:n,fi:a,topP:C+0,topN:C+0,bottomP:C+1,bottomN:C+1,pathBevelUCoord:r};return this._buffer.positions[A+0]=v,this._buffer.positions[A+1]=y,this._buffer.positions[A+2]=(this.forPathBevel?this._bevel:this._depth)-x,this._buffer.normals[A+0]=D*d,this._buffer.normals[A+1]=_*d,this._buffer.normals[A+2]=p,this._buffer.uvs[M+0]=b,this._buffer.uvs[M+1]=w,!1===this.forPathBevel&&(this._buffer.positions[A+3]=v,this._buffer.positions[A+4]=y,this._buffer.positions[A+5]=x,this._buffer.normals[A+3]=D*d,this._buffer.normals[A+4]=_*d,this._buffer.normals[A+5]=-p,this._buffer.uvs[M+2]=w,this._buffer.uvs[M+3]=b),l||(this.forPathBevel?(C+=1,A+=3,M+=2):(C+=2,A+=6,M+=4),T.topP=C+0,T.bottomP=C+1,this._buffer.positions[A+0]=v,this._buffer.positions[A+1]=y,this._buffer.positions[A+2]=(this.forPathBevel?this._bevel:this._depth)-x,this._buffer.normals[A+0]=S*d,this._buffer.normals[A+1]=E*d,this._buffer.normals[A+2]=p,this._buffer.uvs[M+0]=b,this._buffer.uvs[M+1]=w,!1===this.forPathBevel&&(this._buffer.positions[A+3]=v,this._buffer.positions[A+4]=y,this._buffer.positions[A+5]=x,this._buffer.normals[A+3]=S*d,this._buffer.normals[A+4]=E*d,this._buffer.normals[A+5]=-p,this._buffer.uvs[M+2]=w,this._buffer.uvs[M+3]=b)),this.vertexCache[s]=T,T}clone(){let e=new Tj(this._shape,this._depth,this._bevel,this._curveSegments,this._bevelSegmentsInput);return e.userData=PP(this.userData),e}},Pj=class extends dx{constructor(e){var t,n,i,r,s,a;let o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:12,l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};super(),this.type="ShapeGeometry",this.windingRule=WN.ODD,this.elementType=GN.POLYGONS,this.polySize=3,this.vertexSize=2,this.strict=!0,this._shape=e,this._curveSegments=o,this._triangulationOptions=Object.assign({windingRule:WN.ODD,elementType:GN.POLYGONS,polySize:3,vertexSize:2,strict:!0},l);let u,c,h,d=this._shape.extractShapePointsToFlatArray([],this._curveSegments),p=this._shape.shapeHoles.map((e=>e.extractShapePointsToFlatArray([],this._curveSegments))),f=!0,m=!0;for(let x=0,b=d.length/2;x<b;x++){let e=2*x,t=d[e+0],n=d[e+1];if(void 0!==c&&t!==c&&(f=!1),void 0!==h&&n!==h&&(m=!1),c=t,h=n,!f&&!m)break}if(!f&&!m)try{u=yj({contours:[d,...p],windingRule:this._triangulationOptions.windingRule,elementType:this._triangulationOptions.elementType,polySize:this._triangulationOptions.polySize,vertexSize:this._triangulationOptions.vertexSize,strict:this._triangulationOptions.strict})}catch(y){u=Ej}let g=null!==(t=null===(n=u)||void 0===n?void 0:n.vertexCount)&&void 0!==t?t:1,v=null!==(i=null===(r=u)||void 0===r?void 0:r.elementCount)&&void 0!==i?i:1;if(this._positionAttribute=new tx(new Float32Array(3*g),3),this._normalAttribute=new tx(new Float32Array(3*g),3),this._uvAttribute=new tx(new Float32Array(2*g),2),this._indexAttribute=new tx(new Uint32Array(3*v),1),u){let e=1/0,t=-1/0,n=1/0,i=-1/0;for(let a=0,o=g;a<o;a++){let r=2*a,s=u.vertices[r+0],o=u.vertices[r+1];s<e&&(e=s),s>t&&(t=s),o<n&&(n=o),o>i&&(i=o)}let r=t-e,s=i-n;for(let a=0,o=g;a<o;a++){let t=2*a,i=u.vertices[t+0],o=u.vertices[t+1],l=(i-e)/r,c=(o-n)/s;this._positionAttribute.setXYZ(a,i,o,0),this._normalAttribute.setXYZ(a,0,0,1),this._uvAttribute.setXY(a,l,c)}for(let a=0,o=v;a<o;a++){let e=3*a,t=u.elements[e+0],n=u.elements[e+1],i=u.elements[e+2];this._indexAttribute.setX(e+0,t),this._indexAttribute.setX(e+1,n),this._indexAttribute.setX(e+2,i)}}this.setAttribute("position",this._positionAttribute),this.setAttribute("normal",this._normalAttribute),this.setAttribute("uv",this._uvAttribute),this.setIndex(this._indexAttribute),this.setDrawRange(0,3*(null!==(s=null===(a=u)||void 0===a?void 0:a.elementCount)&&void 0!==s?s:1))}clone(){let e=new Pj(this._shape,this._curveSegments);return e.userData=PP(this.userData),e}},Fj=class extends Tj{constructor(e,t){super(e,t,arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,arguments.length>3&&void 0!==arguments[3]?arguments[3]:12,arguments.length>4&&void 0!==arguments[4]?arguments[4]:3,arguments.length>5&&void 0!==arguments[5]?arguments[5]:WN.ODD),this.type="ShapeGeometry"}_computeBufferEstimatedSize(e){return 2*e.vertexCount*(2+this._bevelSegments)}_buildWall(e,t,n){let i=e[0];for(let r=0,s=i.boundary.vertexCount;r<s;r++){let e=this._buildBevelVert(t,i,r),a=this._buildBevelVert(t,i,(r+1)%s);n.push(a.topP,e.topN,e.bottomN),n.push(a.topP,e.bottomN,a.bottomP)}}clone(){let e=new Fj(this._shape,this._depth,this._bevel,this._curveSegments,this._bevelSegmentsInput);return e.userData=PP(this.userData),e}},Oj=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){var n,i,r,s,a,o,l,u;let c=Object.assign({},null!==(n=null===t||void 0===t?void 0:t.parameters)&&void 0!==n?n:{width:100,subdivisions:40,roundness:0,extrudeBevelSize:0,extrudeBevelSegments:3,windingRule:WN.ODD},e.parameters),h=Math.abs(c.width),d=Math.abs(null!==(i=c.height)&&void 0!==i?i:c.width),p=Math.abs(null!==(r=c.depth)&&void 0!==r?r:0),f=null!==(s=e.shape)&&void 0!==s?s:null===t||void 0===t?void 0:t.shape,m=null!==(a=null===(o=f)||void 0===o?void 0:o.roundness)&&void 0!==a?a:c.roundness;void 0!==f&&(f instanceof JN?(f.width!==h||f.height!==d)&&f.applySize(h,d):f=new JN(h,d).fromJSON(f),void 0!==(null===(l=e.parameters)||void 0===l?void 0:l.roundness)&&(null===(u=e.parameters)||void 0===u?void 0:u.roundness)>0&&f.update());let g=null!==f&&void 0!==f?f:new JN(h,d);return{parameters:Object.assign(c,{width:h,height:d,depth:p,roundness:m}),shape:g}}static build(e){let t,{depth:n,extrudeBevelSize:i,extrudeBevelSegments:r,subdivisions:s,roundness:a,windingRule:o}=e.parameters;return e.shape.roundness=a,t=n<=0?new Pj(e.shape,s,{windingRule:o}):new Fj(e.shape,n,i,s,r,o),Object.assign(t,{userData:d(d({},e),{},{type:"VectorGeometry"})})}},Ij=2*Math.PI,kj=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){var n,i,r;let s=Object.assign({},null!==(n=null===t||void 0===t?void 0:t.parameters)&&void 0!==n?n:{width:100,depth:0,spikes:64,angle:360,innerRadius:0,extrudeBevelSize:0,extrudeBevelSegments:1},e.parameters);return s.angle=ov.clamp(s.angle,0,360),{shape:e.shape&&e.shape instanceof JN?e.shape:new JN,parameters:Object.assign(s,{width:Math.abs(s.width),height:Math.abs(null!==(i=s.height)&&void 0!==i?i:s.width),depth:Math.abs(null!==(r=s.depth)&&void 0!==r?r:0)})}}static build(e){let t,{width:n,height:i,spikes:r,angle:s,innerRadius:a,depth:o,extrudeBevelSize:l,extrudeBevelSegments:u}=e.parameters,c=e.shape,h=function(e,t,n,i,r,s){if(i>=Ij)return r>30||r%4===0?(function(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,a=.5522847498,o=t*a,l=n*a;e.addPoint(Lj(r-t,s,r-t,s-l,r-t,s+l)),e.addPoint(Lj(r,s+n,r-o,s+n,r+o,s+n)),e.addPoint(Lj(r+t,s,r+t,s+l,r+t,s-l)),e.addPoint(Lj(r,s-n,r+o,s-n,r-o,s-n)),i>0&&Nj(e,t,n,i)}(e,t,n,s),Math.round(r/4)):Bj(e,i,r,t,n,s);i=Math.max(i,.001);let a={x:0,y:n},o=i+.5*Math.PI,l={x:Math.cos(o)*t,y:Math.sin(o)*n},u=ij({px:a.x,py:a.y,cx:l.x,cy:l.y,rx:t,ry:n,largeArcFlag:i>Math.PI,sweepFlag:!0});return r>30||r%u.length===0?function(e,t,n,i,r,s,a,o){let l=Math.round(r/i.length);e.addPoint(Rj(t,n));for(let u=0,c=i.length;u<c;u++){let t=i[u],n=e.points[u],r=Rj(t.x,t.y);n.controls[1].position.set(t.x1,t.y1),r.controls[0].position.set(t.x2,t.y2),e.addPoint(r)}return o>0?zj(e,s,a,o):e.addPoint(Rj(0,0)),l}(e,a.x,a.y,u,r,t,n,s):Bj(e,i,r,t,n,s)}(c,.5*n,.5*i,s*Math.PI/180,r,a);return c.isClosed=!0,c.update(),0===s?(t=new dx,t.setAttribute("position",new rx([],3))):t=Oj.create({shape:c,parameters:{subdivisions:h,depth:o,extrudeBevelSize:l,extrudeBevelSegments:u}}),Object.assign(t,{userData:d(d({},e),{},{type:"EllipseGeometry"})})}};function Bj(e,t,n,i,r,s){let a=-t/n;for(let o=0;o<=n;o++){let t=a*o,n=Math.sin(t)*i,s=Math.cos(t)*r;e.addPoint(Rj(n,s))}return t<Ij?s>0?zj(e,i,r,s):e.addPoint(Rj(0,0)):(e.removePoint(e.points[e.points.length-1]),s>0&&Nj(e,i,r,s)),1}function Rj(e,t){return new bN(ov.generateUUID(),new lv(e,t))}function Lj(e,t,n,i,r,s){let a=Rj(e,t);return a.controls[0].position.set(n,i),a.controls[1].position.set(r,s),a}function zj(e,t,n,i){jj(e,t,n,i).forEach((t=>e.addPoint(t)))}function Nj(e,t,n,i){let r=jj(e,t,n,i),s=new JN;r.forEach((e=>s.addPoint(e))),s.isClosed=!0,e.shapeHoles.push(s)}function jj(e,t,n,i){let r=i*t/100,s=r*(Math.abs(n)/Math.abs(t)),a=new lv(r/t,s/n),o=e.points.map((e=>{let t=e.clone();return t.uuid=ov.generateUUID(),t})).reverse();return o.forEach((e=>{e.position.multiply(a);let t=e.controls[0].position.clone().multiply(a),n=e.controls[1].position.clone().multiply(a);e.controls[0].position.copy(n),e.controls[1].position.copy(t)})),o}var Uj=new ix([0,0,0],1),Vj=class extends dx{constructor(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,r=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1,s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:1,a=arguments.length>9&&void 0!==arguments[9]?arguments[9]:1,o=arguments.length>10&&void 0!==arguments[10]?arguments[10]:1,l=arguments.length>11&&void 0!==arguments[11]?arguments[11]:1;if(super(),0===i)return;let u=e&&1===i;u&&(l=0),o>100&&(o=100),0===o&&(l=0);let c,h,d,p,f,m,g,v,y=()=>new Lv,x=new Lv,b=y(),w=y(),D=y(),_=y(),S=y(),E=y(),C=y(),A=y(),M=y(),T=y(),P=y(),F=t-2*s+.001,O=F/i,I=Math.ceil(r*i),k=I+1,B=F/I,R=-F/2,L=a+1,z=2*Math.PI/a,N=Math.PI/2/l,j=Math.min((1-o/100)*s,s-.01),U=s-j,V=0,H=2*l+2,W=L*H/2,G=W+L*k,q=Math.max(0,L*(k+H)),[Y,X,Q]=[3,3,2].map((e=>Array(q*e).fill(0))),K=[],Z=n-s;function J(t,n){let i=Math.PI/2;m=n*B,v=2*Math.PI*(m%O)/O+i,m+=R,g=Math.sin(v)*Z,f=Math.cos(v)*Z,e?t.set(f,g,m):t.set(f,m,g)}J(x,-1e-10),J(b,0),_.copy(x),J(x,1);let $=x.distanceTo(b),ee=u?0:U+j,te=$*I+2*ee,ne=j,ie=te-ee;for(let oe=0;oe<=I;oe++){J(w,oe),P.subVectors(w,_).normalize(),_.copy(w),M.copy(w).setComponent(+e+1,0).normalize(),T.crossVectors(P,M).normalize();let t=0===oe,n=oe===I,i=t?3*Math.PI/2:N,r=t?ne:ie,o=t?L:G,c=t?0:q-L,h=P.clone().multiplyScalar(t?-U:U).add(w),d=P.clone().multiplyScalar(t?-1:1).normalize();for(let e=0;e<L;e++){let p=e*z;if(S.addVectors(x.copy(M).multiplyScalar(s*Math.cos(p)),b.copy(T).multiplyScalar(s*Math.sin(p))),E.copy(S).normalize(),t||n){u||(V=c+e,[0,1,2].forEach((e=>{Y[3*V+e]=h.getComponent(e),X[3*V+e]=d.getComponent(e)})),Q[2*V]=+n,Q[2*V+1]=e/a),b.copy(E).multiplyScalar(j),D.addVectors(w,b);for(let n=0;n<l;n++){let s=n*N+i;C.addVectors(x.copy(P).multiplyScalar(U*Math.sin(s)),b.copy(E).multiplyScalar(U*Math.cos(s))),A.copy(C).normalize(),b.addVectors(D,C),C.normalize(),V=o+n*L+e,[0,1,2].forEach((e=>{Y[3*V+e]=b.getComponent(e),X[3*V+e]=A.getComponent(e)}));let l=+t+Math.sin(s);Q[2*V]=(r+U*l)/te,Q[2*V+1]=e/a}}b.addVectors(w,S),V=W+oe*L+e,[0,1,2].forEach((e=>{Y[3*V+e]=b.getComponent(e),X[3*V+e]=E.getComponent(e)})),Q[2*V]=(ee+oe*$)/te,Q[2*V+1]=e/a}}let re=k+2*l+2,[se,ae]=[+u,re-1];for(let oe=se;oe<=ae-1;oe++){let e=u&&oe===ae-1;for(let t=0;t<L-1;t++)c=oe*L+t,h=c+1,d=(e?t:c)+L,p=(e?t+1:h)+L,0===oe?K.push(h,p,d):oe===re-2?K.push(c,h,d):K.push(c,h,d,h,p,d)}this.setIndex(K),this.setAttribute("position",new rx(Y,3)),this.setAttribute("normal",new rx(X,3)),this.setAttribute("uv",new rx(Q,2))}getClosedTorusIndicesForBooleanOrSubdiv(){let e,t,n,i,r=this.userData.parameters,s=Math.ceil(r.tubularSegments),a=r.radialSegments+1,o=Array.from(this.getIndex().array),l=6*(s-1)*r.radialSegments,u=s,c=u===s;for(let h=0;h<r.radialSegments;h++)e=u*a+h,t=e+1,n=(c?h:e)+a,i=(c?h+1:t)+a,o[l++]=e,o[l++]=t,o[l++]=n,o[l++]=t,o[l++]=i,o[l++]=n;return o.length=l,Uj.array=o,Uj.count=o.length,Uj}},Hj=class extends mN{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.2,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:4,i=(1+Math.sqrt(5))/2,r="IcosahedronGeometry";super([-1,i,0,1,i,0,-1,-i,0,1,-i,0,0,-1,i,0,1,i,0,-1,-i,0,1,-i,i,0,-1,i,0,1,-i,0,-1,-i,0,1],[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],r,e,t,n),this.type=r}static fromJSON(e){return new Hj(e.radius,e.corner,e.cornerSides)}},Wj=new py,Gj=new zy,qj=new Lv,Yj=class extends Yg{constructor(){super(),this.uuid=ov.generateUUID(),this.name="",this.type="Geometry",this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.elementsNeedUpdate=!1,this.verticesNeedUpdate=!1,this.uvsNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.lineDistancesNeedUpdate=!1,this.groupsNeedUpdate=!1}applyMatrix4(e){let t=(new uv).getNormalMatrix(e);for(let n=0,i=this.vertices.length;n<i;n++)this.vertices[n].applyMatrix4(e);for(let n=0,i=this.faces.length;n<i;n++){let e=this.faces[n];e.normal.applyMatrix3(t).normalize();for(let n=0,i=e.vertexNormals.length;n<i;n++)e.vertexNormals[n].applyMatrix3(t).normalize()}return null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this.verticesNeedUpdate=!0,this.normalsNeedUpdate=!0,this}rotateX(e){return Wj.makeRotationX(e),this.applyMatrix4(Wj),this}rotateY(e){return Wj.makeRotationY(e),this.applyMatrix4(Wj),this}rotateZ(e){return Wj.makeRotationZ(e),this.applyMatrix4(Wj),this}translate(e,t,n){return Wj.makeTranslation(e,t,n),this.applyMatrix4(Wj),this}scale(e,t,n){return Wj.makeScale(e,t,n),this.applyMatrix4(Wj),this}lookAt(e){return Gj.lookAt(e),Gj.updateMatrix(),this.applyMatrix4(Gj.matrix),this}fromBufferGeometry(e){let t=this,n=null!==e.index?e.index:void 0,i=e.attributes;if(void 0===i.position)return console.error("THREE.Geometry.fromBufferGeometry(): Position attribute required for conversion."),this;let r=i.position,s=i.normal,a=i.color,o=i.uv,l=i.uv2;void 0!==l&&(this.faceVertexUvs[1]=[]);for(let h=0;h<r.count;h++)t.vertices.push((new Lv).fromBufferAttribute(r,h)),void 0!==a&&t.colors.push((new Ev).fromBufferAttribute(a,h));function u(e,n,i,r){let u=void 0===a?[]:[t.colors[e].clone(),t.colors[n].clone(),t.colors[i].clone()],c=void 0===s?[]:[(new Lv).fromBufferAttribute(s,e),(new Lv).fromBufferAttribute(s,n),(new Lv).fromBufferAttribute(s,i)],h=new Qj(e,n,i,c,u,r);t.faces.push(h),void 0!==o&&t.faceVertexUvs[0].push([(new lv).fromBufferAttribute(o,e),(new lv).fromBufferAttribute(o,n),(new lv).fromBufferAttribute(o,i)]),void 0!==l&&t.faceVertexUvs[1].push([(new lv).fromBufferAttribute(l,e),(new lv).fromBufferAttribute(l,n),(new lv).fromBufferAttribute(l,i)])}let c=e.groups;if(c.length>0)for(let h=0;h<c.length;h++){let e=c[h],t=e.start;for(let i=t,r=t+e.count;i<r;i+=3)void 0!==n?u(n.getX(i),n.getX(i+1),n.getX(i+2),e.materialIndex):u(i,i+1,i+2,e.materialIndex)}else if(void 0!==n)for(let h=0;h<n.count;h+=3)u(n.getX(h),n.getX(h+1),n.getX(h+2));else for(let h=0;h<r.count;h+=3)u(h,h+1,h+2);return this.computeFaceNormals(),null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone()),null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(qj).negate(),this.translate(qj.x,qj.y,qj.z),this}normalize(){this.computeBoundingSphere();let e=this.boundingSphere.center,t=this.boundingSphere.radius,n=0===t?1:1/t,i=new py;return i.set(n,0,0,-n*e.x,0,n,0,-n*e.y,0,0,n,-n*e.z,0,0,0,1),this.applyMatrix4(i),this}computeFaceNormals(){let e=new Lv,t=new Lv;for(let n=0,i=this.faces.length;n<i;n++){let i=this.faces[n],r=this.vertices[i.a],s=this.vertices[i.b],a=this.vertices[i.c];e.subVectors(a,s),t.subVectors(r,s),e.cross(t),e.normalize(),i.normal.copy(e)}}computeVertexNormals(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=new Array(this.vertices.length);for(let n=0,i=this.vertices.length;n<i;n++)t[n]=new Lv;if(e){let e=new Lv,n=new Lv;for(let i=0,r=this.faces.length;i<r;i++){let r=this.faces[i],s=this.vertices[r.a],a=this.vertices[r.b],o=this.vertices[r.c];e.subVectors(o,a),n.subVectors(s,a),e.cross(n),t[r.a].add(e),t[r.b].add(e),t[r.c].add(e)}}else{this.computeFaceNormals();for(let e=0,n=this.faces.length;e<n;e++){let n=this.faces[e];t[n.a].add(n.normal),t[n.b].add(n.normal),t[n.c].add(n.normal)}}for(let n=0,i=this.vertices.length;n<i;n++)t[n].normalize();for(let n=0,i=this.faces.length;n<i;n++){let e=this.faces[n],i=e.vertexNormals;3===i.length?(i[0].copy(t[e.a]),i[1].copy(t[e.b]),i[2].copy(t[e.c])):(i[0]=t[e.a].clone(),i[1]=t[e.b].clone(),i[2]=t[e.c].clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)}computeFlatVertexNormals(){this.computeFaceNormals();for(let e=0,t=this.faces.length;e<t;e++){let t=this.faces[e],n=t.vertexNormals;3===n.length?(n[0].copy(t.normal),n[1].copy(t.normal),n[2].copy(t.normal)):(n[0]=t.normal.clone(),n[1]=t.normal.clone(),n[2]=t.normal.clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)}computeMorphNormals(){for(let t=0,n=this.faces.length;t<n;t++){let e=this.faces[t];e.__originalFaceNormal?e.__originalFaceNormal.copy(e.normal):e.__originalFaceNormal=e.normal.clone(),e.__originalVertexNormals||(e.__originalVertexNormals=[]);for(let t=0,n=e.vertexNormals.length;t<n;t++)e.__originalVertexNormals[t]?e.__originalVertexNormals[t].copy(e.vertexNormals[t]):e.__originalVertexNormals[t]=e.vertexNormals[t].clone()}let e=new Yj;e.faces=this.faces;for(let t=0,n=this.morphTargets.length;t<n;t++){if(!this.morphNormals[t]){this.morphNormals[t]={},this.morphNormals[t].faceNormals=[],this.morphNormals[t].vertexNormals=[];let e=this.morphNormals[t].faceNormals,n=this.morphNormals[t].vertexNormals;for(let t=0,i=this.faces.length;t<i;t++){let t=new Lv,i={a:new Lv,b:new Lv,c:new Lv};e.push(t),n.push(i)}}let n=this.morphNormals[t];e.vertices=this.morphTargets[t].vertices,e.computeFaceNormals(),e.computeVertexNormals();for(let e=0,t=this.faces.length;e<t;e++){let t=this.faces[e],i=n.faceNormals[e],r=n.vertexNormals[e];i.copy(t.normal),r.a.copy(t.vertexNormals[0]),r.b.copy(t.vertexNormals[1]),r.c.copy(t.vertexNormals[2])}}for(let t=0,n=this.faces.length;t<n;t++){let e=this.faces[t];e.normal=e.__originalFaceNormal,e.vertexNormals=e.__originalVertexNormals}}computeBoundingBox(){null===this.boundingBox&&(this.boundingBox=new jv),this.boundingBox.setFromPoints(this.vertices)}computeBoundingSphere(){null===this.boundingSphere&&(this.boundingSphere=new ry),this.boundingSphere.setFromPoints(this.vertices)}merge(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(!e||!e.isGeometry)return void console.error("THREE.Geometry.merge(): geometry not an instance of THREE.Geometry.",e);let i,r=this.vertices.length,s=this.vertices,a=e.vertices,o=this.faces,l=e.faces,u=this.colors,c=e.colors;void 0!==t&&(i=(new uv).getNormalMatrix(t));for(let h=0,d=a.length;h<d;h++){let e=a[h].clone();void 0!==t&&e.applyMatrix4(t),s.push(e)}for(let h=0,d=c.length;h<d;h++)u.push(c[h].clone());for(let h=0,d=l.length;h<d;h++){let e,t,s=l[h],a=s.vertexNormals,u=s.vertexColors,c=new Qj(s.a+r,s.b+r,s.c+r);c.normal.copy(s.normal),void 0!==i&&c.normal.applyMatrix3(i).normalize();for(let n=0,r=a.length;n<r;n++)e=a[n].clone(),void 0!==i&&e.applyMatrix3(i).normalize(),c.vertexNormals.push(e);c.color.copy(s.color);for(let n=0,i=u.length;n<i;n++)t=u[n],c.vertexColors.push(t.clone());c.materialIndex=s.materialIndex+n,o.push(c)}for(let h=0,d=e.faceVertexUvs.length;h<d;h++){let t=e.faceVertexUvs[h];void 0===this.faceVertexUvs[h]&&(this.faceVertexUvs[h]=[]);for(let e=0,n=t.length;e<n;e++){let n=t[e],i=[];for(let e=0,t=n.length;e<t;e++)i.push(n[e].clone());this.faceVertexUvs[h].push(i)}}}mergeMesh(e){e&&e.isMesh?(e.matrixAutoUpdate&&e.updateMatrix(),this.merge(e.geometry,e.matrix)):console.error("THREE.Geometry.mergeMesh(): mesh not an instance of THREE.Mesh.",e)}mergeVertices(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:4,t={},n=[],i=[],r=Math.pow(10,e);for(let o=0,l=this.vertices.length;o<l;o++){let e=this.vertices[o],s=Math.round(e.x*r)+"_"+Math.round(e.y*r)+"_"+Math.round(e.z*r);void 0===t[s]?(t[s]=o,n.push(this.vertices[o]),i[o]=n.length-1):i[o]=i[t[s]]}let s=[];for(let o=0,l=this.faces.length;o<l;o++){let e=this.faces[o];e.a=i[e.a],e.b=i[e.b],e.c=i[e.c];let t=[e.a,e.b,e.c];for(let n=0;n<3;n++)if(t[n]===t[(n+1)%3]){s.push(o);break}}for(let o=s.length-1;o>=0;o--){let e=s[o];this.faces.splice(e,1);for(let t=0,n=this.faceVertexUvs.length;t<n;t++)this.faceVertexUvs[t].splice(e,1)}let a=this.vertices.length-n.length;return this.vertices=n,a}setFromPoints(e){this.vertices=[];for(let t=0,n=e.length;t<n;t++){let n=e[t];this.vertices.push(new Lv(n.x,n.y,n.z||0))}return this}sortFacesByMaterialIndex(){let e=this.faces,t=e.length;for(let a=0;a<t;a++)e[a]._id=a;e.sort((function(e,t){return e.materialIndex-t.materialIndex}));let n,i,r=this.faceVertexUvs[0],s=this.faceVertexUvs[1];r&&r.length===t&&(n=[]),s&&s.length===t&&(i=[]);for(let a=0;a<t;a++){let t=e[a]._id;n&&n.push(r[t]),i&&i.push(s[t])}n&&(this.faceVertexUvs[0]=n),i&&(this.faceVertexUvs[1]=i)}toJSON(){let e={metadata:{version:4.5,type:"Geometry",generator:"Geometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),void 0!==this.parameters){let t=this.parameters;for(let n in t)void 0!==t[n]&&(e[n]=t[n]);return e}let t=[];for(let p=0;p<this.vertices.length;p++){let e=this.vertices[p];t.push(e.x,e.y,e.z)}let n=[],i=[],r={},s=[],a={},o=[],l={};for(let p=0;p<this.faces.length;p++){let e=this.faces[p],t=!0,i=!1,r=void 0!==this.faceVertexUvs[0][p],s=e.normal.length()>0,a=e.vertexNormals.length>0,o=1!==e.color.r||1!==e.color.g||1!==e.color.b,l=e.vertexColors.length>0,f=0;if(f=u(f,0,0),f=u(f,1,t),f=u(f,2,i),f=u(f,3,r),f=u(f,4,s),f=u(f,5,a),f=u(f,6,o),f=u(f,7,l),n.push(f),n.push(e.a,e.b,e.c),n.push(e.materialIndex),r){let e=this.faceVertexUvs[0][p];n.push(d(e[0]),d(e[1]),d(e[2]))}if(s&&n.push(c(e.normal)),a){let t=e.vertexNormals;n.push(c(t[0]),c(t[1]),c(t[2]))}if(o&&n.push(h(e.color)),l){let t=e.vertexColors;n.push(h(t[0]),h(t[1]),h(t[2]))}}function u(e,t,n){return n?e|1<<t:e&~(1<<t)}function c(e){let t=e.x.toString()+e.y.toString()+e.z.toString();return void 0!==r[t]||(r[t]=i.length/3,i.push(e.x,e.y,e.z)),r[t]}function h(e){let t=e.r.toString()+e.g.toString()+e.b.toString();return void 0!==a[t]||(a[t]=s.length,s.push(e.getHex())),a[t]}function d(e){let t=e.x.toString()+e.y.toString();return void 0!==l[t]||(l[t]=o.length/2,o.push(e.x,e.y)),l[t]}return e.data={},e.data.vertices=t,e.data.normals=i,s.length>0&&(e.data.colors=s),o.length>0&&(e.data.uvs=[o]),e.data.faces=n,e}clone(){return(new Yj).copy(this)}copy(e){this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.name=e.name;let t=e.vertices;for(let h=0,d=t.length;h<d;h++)this.vertices.push(t[h].clone());let n=e.colors;for(let h=0,d=n.length;h<d;h++)this.colors.push(n[h].clone());let i=e.faces;for(let h=0,d=i.length;h<d;h++)this.faces.push(i[h].clone());for(let h=0,d=e.faceVertexUvs.length;h<d;h++){let t=e.faceVertexUvs[h];void 0===this.faceVertexUvs[h]&&(this.faceVertexUvs[h]=[]);for(let e=0,n=t.length;e<n;e++){let n=t[e],i=[];for(let e=0,t=n.length;e<t;e++){let t=n[e];i.push(t.clone())}this.faceVertexUvs[h].push(i)}}let r=e.morphTargets;for(let h=0,d=r.length;h<d;h++){let e={};if(e.name=r[h].name,void 0!==r[h].vertices){e.vertices=[];for(let t=0,n=r[h].vertices.length;t<n;t++)e.vertices.push(r[h].vertices[t].clone())}if(void 0!==r[h].normals){e.normals=[];for(let t=0,n=r[h].normals.length;t<n;t++)e.normals.push(r[h].normals[t].clone())}this.morphTargets.push(e)}let s=e.morphNormals;for(let h=0,d=s.length;h<d;h++){let e={};if(void 0!==s[h].vertexNormals){e.vertexNormals=[];for(let t=0,n=s[h].vertexNormals.length;t<n;t++){let n=s[h].vertexNormals[t],i={};i.a=n.a.clone(),i.b=n.b.clone(),i.c=n.c.clone(),e.vertexNormals.push(i)}}if(void 0!==s[h].faceNormals){e.faceNormals=[];for(let t=0,n=s[h].faceNormals.length;t<n;t++)e.faceNormals.push(s[h].faceNormals[t].clone())}this.morphNormals.push(e)}let a=e.skinWeights;for(let h=0,d=a.length;h<d;h++)this.skinWeights.push(a[h].clone());let o=e.skinIndices;for(let h=0,d=o.length;h<d;h++)this.skinIndices.push(o[h].clone());let l=e.lineDistances;for(let h=0,d=l.length;h<d;h++)this.lineDistances.push(l[h]);let u=e.boundingBox;null!==u&&(this.boundingBox=u.clone());let c=e.boundingSphere;return null!==c&&(this.boundingSphere=c.clone()),this.elementsNeedUpdate=e.elementsNeedUpdate,this.verticesNeedUpdate=e.verticesNeedUpdate,this.uvsNeedUpdate=e.uvsNeedUpdate,this.normalsNeedUpdate=e.normalsNeedUpdate,this.colorsNeedUpdate=e.colorsNeedUpdate,this.lineDistancesNeedUpdate=e.lineDistancesNeedUpdate,this.groupsNeedUpdate=e.groupsNeedUpdate,this}toBufferGeometry(){let e=(new Xj).fromGeometry(this),t=new dx,n=new Float32Array(3*e.vertices.length);if(t.setAttribute("position",$j.call(new tx(n,3),e.vertices)),e.normals.length>0){let n=new Float32Array(3*e.normals.length);t.setAttribute("normal",$j.call(new tx(n,3),e.normals))}if(e.colors.length>0){let n=new Float32Array(3*e.colors.length);t.setAttribute("color",Zj.call(new tx(n,3),e.colors))}if(e.uvs.length>0){let n=new Float32Array(2*e.uvs.length);t.setAttribute("uv",Jj.call(new tx(n,2),e.uvs))}if(e.uvs2.length>0){let n=new Float32Array(2*e.uvs2.length);t.setAttribute("uv2",Jj.call(new tx(n,2),e.uvs2))}t.groups=e.groups;for(let i in e.morphTargets){let n=[],r=e.morphTargets[i];for(let e=0,t=r.length;e<t;e++){let t=r[e],i=new rx(3*t.data.length,3);i.name=t.name,n.push($j.call(i,t.data))}t.morphAttributes[i]=n}if(e.skinIndices.length>0){let n=new rx(4*e.skinIndices.length,4);t.setAttribute("skinIndex",eU.call(n,e.skinIndices))}if(e.skinWeights.length>0){let n=new rx(4*e.skinWeights.length,4);t.setAttribute("skinWeight",eU.call(n,e.skinWeights))}return null!==e.boundingSphere&&(t.boundingSphere=e.boundingSphere.clone()),null!==e.boundingBox&&(t.boundingBox=e.boundingBox.clone()),t}computeTangents(){console.error("THREE.Geometry: .computeTangents() has been removed.")}computeLineDistances(){console.error("THREE.Geometry: .computeLineDistances() has been removed. Use THREE.Line.computeLineDistances() instead.")}applyMatrix(e){return console.warn("THREE.Geometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(e)}dispose(){this.dispatchEvent({type:"dispose"})}static createBufferGeometryFromObject(e){let t=new dx,n=e.geometry;if(e.isPoints||e.isLine){let e=new rx(3*n.vertices.length,3),i=new rx(3*n.colors.length,3);if(t.setAttribute("position",$j.call(e,n.vertices)),t.setAttribute("color",Zj.call(i,n.colors)),n.lineDistances&&n.lineDistances.length===n.vertices.length){let e=new rx(n.lineDistances.length,1);t.setAttribute("lineDistance",Kj.call(e,n.lineDistances))}null!==n.boundingSphere&&(t.boundingSphere=n.boundingSphere.clone()),null!==n.boundingBox&&(t.boundingBox=n.boundingBox.clone())}else e.isMesh&&(t=n.toBufferGeometry());return t}};Yj.prototype.isGeometry=!0;var Xj=class{constructor(){this.vertices=[],this.normals=[],this.colors=[],this.uvs=[],this.uvs2=[],this.groups=[],this.morphTargets={},this.skinWeights=[],this.skinIndices=[],this.boundingBox=null,this.boundingSphere=null,this.verticesNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.uvsNeedUpdate=!1,this.groupsNeedUpdate=!1}computeGroups(e){let t,n,i,r=[],s=e.faces;for(n=0;n<s.length;n++){let e=s[n];e.materialIndex!==i&&(i=e.materialIndex,void 0!==t&&(t.count=3*n-t.start,r.push(t)),t={start:3*n,materialIndex:i})}void 0!==t&&(t.count=3*n-t.start,r.push(t)),this.groups=r}fromGeometry(e){let t,n=e.faces,i=e.vertices,r=e.faceVertexUvs,s=r[0]&&r[0].length>0,a=r[1]&&r[1].length>0,o=e.morphTargets,l=o.length;if(l>0){t=[];for(let e=0;e<l;e++)t[e]={name:o[e].name,data:[]};this.morphTargets.position=t}let u,c=e.morphNormals,h=c.length;if(h>0){u=[];for(let e=0;e<h;e++)u[e]={name:c[e].name,data:[]};this.morphTargets.normal=u}let d=e.skinIndices,p=e.skinWeights,f=d.length===i.length,m=p.length===i.length;i.length>0&&0===n.length&&console.error("THREE.DirectGeometry: Faceless geometries are not supported.");for(let g=0;g<n.length;g++){let e=n[g];this.vertices.push(i[e.a],i[e.b],i[e.c]);let v=e.vertexNormals;if(3===v.length)this.normals.push(v[0],v[1],v[2]);else{let t=e.normal;this.normals.push(t,t,t)}let y=e.vertexColors;if(3===y.length)this.colors.push(y[0],y[1],y[2]);else{let t=e.color;this.colors.push(t,t,t)}if(!0===s){let e=r[0][g];void 0!==e?this.uvs.push(e[0],e[1],e[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv ",g),this.uvs.push(new lv,new lv,new lv))}if(!0===a){let e=r[1][g];void 0!==e?this.uvs2.push(e[0],e[1],e[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv2 ",g),this.uvs2.push(new lv,new lv,new lv))}for(let n=0;n<l;n++){let i=o[n].vertices;t[n].data.push(i[e.a],i[e.b],i[e.c])}for(let t=0;t<h;t++){let e=c[t].vertexNormals[g];u[t].data.push(e.a,e.b,e.c)}f&&this.skinIndices.push(d[e.a],d[e.b],d[e.c]),m&&this.skinWeights.push(p[e.a],p[e.b],p[e.c])}return this.computeGroups(e),this.verticesNeedUpdate=e.verticesNeedUpdate,this.normalsNeedUpdate=e.normalsNeedUpdate,this.colorsNeedUpdate=e.colorsNeedUpdate,this.uvsNeedUpdate=e.uvsNeedUpdate,this.groupsNeedUpdate=e.groupsNeedUpdate,null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone()),this}},Qj=class{constructor(e,t,n,i,r){let s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;this.a=e,this.b=t,this.c=n,this.normal=i&&i.isVector3?i:new Lv,this.vertexNormals=Array.isArray(i)?i:[],this.color=r&&r.isColor?r:new Ev,this.vertexColors=Array.isArray(r)?r:[],this.materialIndex=s}clone(){return(new this.constructor).copy(this)}copy(e){this.a=e.a,this.b=e.b,this.c=e.c,this.normal.copy(e.normal),this.color.copy(e.color),this.materialIndex=e.materialIndex;for(let t=0,n=e.vertexNormals.length;t<n;t++)this.vertexNormals[t]=e.vertexNormals[t].clone();for(let t=0,n=e.vertexColors.length;t<n;t++)this.vertexColors[t]=e.vertexColors[t].clone();return this}};function Kj(e){return this.array.set(e),this}function Zj(e){let t=this.array,n=0;for(let i=0,r=e.length;i<r;i++){let r=e[i];void 0===r&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",i),r=new Ev),t[n++]=r.r,t[n++]=r.g,t[n++]=r.b}return this}function Jj(e){let t=this.array,n=0;for(let i=0,r=e.length;i<r;i++){let r=e[i];void 0===r&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",i),r=new lv),t[n++]=r.x,t[n++]=r.y}return this}function $j(e){let t=this.array,n=0;for(let i=0,r=e.length;i<r;i++){let r=e[i];void 0===r&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",i),r=new Lv),t[n++]=r.x,t[n++]=r.y,t[n++]=r.z}return this}function eU(e){let t=this.array,n=0;for(let i=0,r=e.length;i<r;i++){let r=e[i];void 0===r&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",i),r=new Ov),t[n++]=r.x,t[n++]=r.y,t[n++]=r.z,t[n++]=r.w}return this}var tU=["a","b","c"];function nU(e,t){switch(t){case"c":return e.c;case"b":return e.b;default:return e.a}}function iU(e,t,n){let i=Math.min(e,t)+"_"+Math.max(e,t);return n.get(i)}function rU(e,t,n,i,r,s){let a,o=Math.min(e,t),l=Math.max(e,t),u=o+"_"+l;if(i.has(u))a=i.get(u);else{a={a:n[o],b:n[l],newEdge:null,faces:[]},i.set(u,a)}a.faces.push(r),s[e].edges.push(a),s[t].edges.push(a)}function sU(e,t,n,i,r){e.push(new Qj(t,n,i,void 0,void 0,r))}function aU(e,t){return Math.abs(t-e)/2+Math.min(e,t)}function oU(e,t,n,i){e.push([t.clone(),n.clone(),i.clone()])}var lU=class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this.subdivisions=e}modify(e){(e=e instanceof dx?(new Yj).fromBufferGeometry(e):e.clone()).mergeVertices();let t=this.subdivisions;for(;t-- >0;)this._smooth(e);return e.computeFaceNormals(),e.computeVertexNormals(),e}_smooth(e){let t,n,i,r,s,a=new Lv,o=e.vertices,l=e.faces,u=e.faceVertexUvs[0],c=void 0!==u&&u.length>0,h=[],d=new Map;!function(e,t,n,i){let r,s,a;for(r=0,s=e.length;r<s;r++)n[r]={edges:[]};for(r=0,s=t.length;r<s;r++)a=t[r],rU(a.a,a.b,e,i,a,n),rU(a.b,a.c,e,i,a,n),rU(a.c,a.a,e,i,a,n)}(o,l,h,d);let p,f,m,g,v,y,x,b=[];for(let H of Array.from(d.keys())){for(f=d.get(H),m=new Lv,v=3/8,y=1/8,x=f.faces.length,2!=x&&(v=.5,y=0),m.addVectors(f.a,f.b).multiplyScalar(v),a.set(0,0,0),r=0;r<x;r++){for(g=f.faces[r],s=0;s<3&&(p=o[nU(g,tU[s])],p===f.a||p===f.b);s++);p&&a.add(p)}a.multiplyScalar(y),m.add(a),f.newEdge=b.length,b.push(m)}let w,D,_,S,E,C,A,M=[];for(n=0,i=o.length;n<i;n++){for(C=o[n],E=h[n].edges,t=E.length,3==t?w=3/16:t>3&&(w=3/(8*t)),D=1-t*Number(w),_=w,t<=2&&(2==t&&(D=3/4,_=1/8)),A=C.clone().multiplyScalar(D),a.set(0,0,0),r=0;r<t;r++)S=E[r],p=S.a!==C?S.a:S.b,a.add(p);a.multiplyScalar(Number(_)),A.add(a),M.push(A)}let T,P,F,O,I,k,B,R=M.concat(b),L=M.length,z=[],N=[],j=new lv,U=new lv,V=new lv;for(n=0,i=l.length;n<i;n++)g=l[n],T=Number(iU(g.a,g.b,d).newEdge)+L,P=Number(iU(g.b,g.c,d).newEdge)+L,F=Number(iU(g.c,g.a,d).newEdge)+L,sU(z,T,P,F,g.materialIndex),sU(z,g.a,T,F,g.materialIndex),sU(z,g.b,P,T,g.materialIndex),sU(z,g.c,F,P,g.materialIndex),c&&(O=u[n],I=O[0],k=O[1],B=O[2],j.set(aU(I.x,k.x),aU(I.y,k.y)),U.set(aU(k.x,B.x),aU(k.y,B.y)),V.set(aU(I.x,B.x),aU(I.y,B.y)),oU(N,j,U,V),oU(N,I,j,V),oU(N,k,U,j),oU(N,B,V,U));e.vertices=R,e.faces=z,c&&(e.faceVertexUvs[0]=N)}},uU=new Lv,cU=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){var n,i,r;let s=Object.assign({},null!==(n=null===t||void 0===t?void 0:t.parameters)&&void 0!==n?n:{width:100,depth:0,spikes:5,cornerRadius:0,extrudeBevelSize:0,extrudeBevelSegments:3},e.parameters);return{shape:e.shape&&e.shape instanceof JN?e.shape:new JN,parameters:Object.assign(s,{width:Math.abs(s.width),height:Math.abs(null!==(i=s.height)&&void 0!==i?i:s.width),depth:Math.abs(null!==(r=s.depth)&&void 0!==r?r:0)})}}static build(e){let{width:t,height:n,spikes:i,cornerRadius:r,depth:s,extrudeBevelSize:a,extrudeBevelSegments:o}=e.parameters,l=e.shape,u=.5*t,c=.5*n,h=2*Math.PI/i;for(let d=0;d<i;d++){let e=h*d,t=0+Math.sin(e)*u,n=0+Math.cos(e)*c;l.addPoint(l.createPoint(t,n))}l.isClosed=!0;for(let d=0,f=l.points.length;d<f;d++)l.points[d].roundness=r;l.roundness=r,l.update();let p=Oj.create({shape:l,parameters:{roundness:r,depth:s,extrudeBevelSize:a,extrudeBevelSegments:o}});return Object.assign(p,{userData:d(d({},e),{},{type:"PolygonGeometry"})})}};function hU(e,t,n){n.x=e.x*t.x,n.y=e.y,n.z=e.x*t.y}function dU(e,t,n,i,r,s){let a=t.clone().sub(e),o=n.clone().sub(e),l=a.angleTo(o);if(a.normalize(),o.normalize(),i===r){let t=a.add(o).normalize();s.copy(e).addScaledVector(t,i/Math.sin(l/2))}else{let t=a.angleTo(o);s.copy(e),s.addScaledVector(a,r/Math.sin(t)),s.addScaledVector(o,i/Math.sin(t))}}function pU(e,t,n){let i=e.clone().sub(t),r=n.clone().sub(t);return i.projectOnVector(r),i.add(t)}var fU=class extends dx{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.5,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:4,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,r=arguments.length>4&&void 0!==arguments[4]&&arguments[4],s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:4;super(),n=Math.floor(Math.max(3,n)),i=Math.floor(i),a=Math.floor(a);let o,l=[],u=[],c=[],h=[],d=0,p=t/2,f=Math.PI/n,m=e*Math.cos(Math.PI/n),g=2*Math.PI/n,v=(n-2)*Math.PI/n,y=Math.PI-v,x=new Lv(0,-p,0),b=new Lv(0,p,0),w=new lv(e,-p),D=new lv(m,-p),_=new lv(0,b.y).sub(D),S=new lv(0,b.y).sub(w),E=new lv(_.y,-_.x).normalize(),C=new lv(S.y,-S.x).normalize(),A=e*Math.cos(Math.PI/n)*Math.tan((Math.PI-_.angle())/2)-1e-8;s=Math.min(s,A);{let e=new Lv(E.x,E.y,0),t=new Lv(Math.cos(g)*e.x,e.y,Math.sin(g)*e.x);o=e.angleTo(t)}let M=s/Math.tan((Math.PI-_.angle())/2),T=s/Math.tan((Math.PI-o)/2),P=new Lv;if(!r){u.push(x.x,x.y,x.z),c.push(0,-1,0),h.push(0,0);let e=d++,t=[],i=w.clone(),r=M/Math.cos(Math.PI/n);i.x-=r;for(let s=0;s<n;s++){let e=s/n*Math.PI*2+f;hU(i,new lv(Math.sin(e),Math.cos(e)),P),u.push(P.x,P.y,P.z),c.push(0,-1,0),h.push(0,0),t.push(d++)}for(let n=0;n<t.length;n++)l.push(t[n],e,t[(n+1)%t.length])}let F=[];{let e=new Lv,t=new Lv,i=new Lv,r=new Lv,p=new Lv,m=new Lv;for(let g=0;g<n;g++){let v=g/n*Math.PI*2+f,y=(g+.5)/n*Math.PI*2+f,D=(g+1)/n*Math.PI*2+f,S=new lv(Math.sin(v),Math.cos(v)),A=new lv(Math.sin(y),Math.cos(y)),P=new lv(Math.sin(D),Math.cos(D));hU(w,S,t),hU(w,P,i),hU(E,A,e),dU(b,t,i,T,T,r),u.push(r.x,r.y,r.z),dU(t,b,i,T,M,p),u.push(p.x,p.y,p.z),dU(i,t,b,M,T,m),u.push(m.x,m.y,m.z),c.push(e.x,e.y,e.z),c.push(e.x,e.y,e.z),c.push(e.x,e.y,e.z),h.push(0,0),h.push(0,0),h.push(0,0);let k=d++,B=d++,R=d++;if(l.push(k,B,R),s>0){{let e=t.clone().add(i).multiplyScalar(.5),n=b.clone().sub(e).normalize(),r=x.clone().sub(e).normalize().add(n).normalize().multiplyScalar(-1);O(e,m.clone().sub(p),r,_.angle())}let f,g;{let e=new Lv;hU(C,P,e);let t=m.clone().add(r).multiplyScalar(.5);t=pU(t,i,b);let n=m.clone().sub(r);[f,g]=O(t,n,e,o,r.y)}{let e=f,t=e.clone().setY(0).normalize(),n=new Lv(0,-1,0),i=t.clone().cross(n);I(e,t,n,i)}F.concat(g);{let t=_.angle(),i=Math.PI-t,r=b.clone();r.y-=s/Math.sin(t-Math.PI/2);let o=new Lv,p=[];for(let l=0;l<a;l++){let t=[],f=Math.PI/2-i*l/a,m=Math.cos(f),g=Math.sin(f),v=y;for(let i=0;i<=l;i++){let i=Math.cos(v),a=Math.sin(v);e.x=m*a,e.y=g,e.z=m*i,o.copy(r).addScaledVector(e,s),u.push(o.x,o.y,o.z),c.push(e.x,e.y,e.z),h.push(0,0),t.push(d++),v+=2*Math.PI/l/n}p.push(t)}g.reverse(),p.push(g);let f=p.length-1;for(let e=0;e<f;e++){let t=p[e],n=p[e+1],i=t.length-1;l.push(n[1],t[0],n[0]);for(let e=1;e<=i;e++)l.push(t[e],t[e-1],n[e]),l.push(n[e+1],t[e],n[e])}}}}}function O(e,t,n,i,r){let o=-i/2,p=(Math.PI-i)/2,f=t.clone().normalize().cross(n);e.addScaledVector(n,-s/Math.sin(p));let m=new Lv,g=new Lv,v=d,y=[];for(let l=0;l<=a;l++){let p=o+l/a*i;g.set(0,0,0),g.addScaledVector(f,Math.sin(p)),g.addScaledVector(n,Math.cos(p));for(let n=0;n<=1;n++){let i=n/1-.5;if(m.copy(e),m.addScaledVector(t,i),m.addScaledVector(g,s),null!=r){let e=Math.max(0,m.y-r);m.addScaledVector(t,-e/t.y)}u.push(m.x,m.y,m.z),c.push(g.x,g.y,g.z),h.push(0,0),0===n&&y.push(d),d++}}for(let s=0;s<a;s++)for(let e=0;e<1;e++){let t=v+e+2*s,n=t+2,i=n+1,r=t+1;l.push(t,n,r),l.push(n,i,r)}return[e.clone().addScaledVector(t,.5),y]}function I(e,t,n,i){let r=Math.PI/2,o=S.angle()-r,p=[],f=new Lv,m=new Lv;for(let l=0;l<=a;l++){let g=[],v=l/a;for(let a=0;a<=l;a++){let p=((l?a/l:0)-.5)*y,x=Math.cos(p),b=Math.sin(p),w=(r+Math.atan(Math.tan(o)*x))*v,D=Math.cos(w),_=Math.sin(w);f.set(0,0,0),f.addScaledVector(t,_*x),f.addScaledVector(n,D),f.addScaledVector(i,_*b),m.copy(e).addScaledVector(f,s),u.push(m.x,m.y,m.z),c.push(f.x,f.y,f.z),h.push(0,0),g.push(d++)}p.push(g)}let g=p.length-1;for(let s=0;s<g;s++){let e=p[s],t=p[s+1],n=e.length-1;l.push(e[0],t[1],t[0]);for(let i=1;i<=n;i++)l.push(e[i-1],e[i],t[i]),l.push(e[i],t[i+1],t[i])}}this.setIndex(l),this.setAttribute("position",new rx(u,3)),this.setAttribute("normal",new rx(c,3)),this.setAttribute("uv",new rx(h,2))}},mU=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){var n,i,r,s;let a=Object.assign({},null!==(n=null===t||void 0===t?void 0:t.parameters)&&void 0!==n?n:{width:100,depth:0,cornerRadius:[0,0,0,0],cornerType:1,extrudeBevelSize:0,extrudeBevelSegments:1},e.parameters),o=Object.assign(null!==(i=null===t||void 0===t?void 0:t.ui)&&void 0!==i?i:{enabledIndieCorners:!1},e.ui);return{shape:e.shape&&e.shape instanceof JN?e.shape:new JN,parameters:Object.assign(a,{width:Math.abs(a.width),height:Math.abs(null!==(r=a.height)&&void 0!==r?r:a.width),depth:Math.abs(null!==(s=a.depth)&&void 0!==s?s:0)}),ui:o}}static build(e){let t=e.shape,{width:n,height:i,cornerRadius:r,cornerType:s,depth:a,extrudeBevelSize:o,extrudeBevelSegments:l}=e.parameters,u={x:.5*n,y:.5*i},c={x:-u.x,y:-u.y},h={x:u.x,y:u.y};function p(e,t,r){return t>n&&r>i?Math.min(e*n/t,e*i/r):t>n?e*n/t:r>i?e*i/r:e}let f=[];f[0]=0===r[0]?0:p(r[0],r[0]+r[3],r[0]+r[1]),f[1]=0===r[1]?0:p(r[1],r[1]+r[2],r[1]+r[0]),f[2]=0===r[2]?0:p(r[2],r[2]+r[1],r[2]+r[3]),f[3]=0===r[3]?0:p(r[3],r[3]+r[0],r[3]+r[2]);let m=c.x,g=h.x,v=h.y,y=c.y;t.addPoint(t.createPoint(m,v)),t.addPoint(t.createPoint(g,v)),t.addPoint(t.createPoint(g,y)),t.addPoint(t.createPoint(m,y)),t.isClosed=!0;let x=!0;for(let d=0,w=t.points.length;d<w;d++)t.points[d].roundness=f[d],d>0&&f[d]!==f[d-1]&&(x=!1);x&&(t.roundness=f[0]),t.useCubicForRoundedCorners=1!==s,t.update();let b=Oj.create({shape:t,parameters:{depth:a,extrudeBevelSize:o,extrudeBevelSegments:l}});return Object.assign(b,{userData:d(d({},e),{},{type:"RectangleGeometry"})})}},gU=class extends dx{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:90,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:10,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:24;super(),this.type="BackdropGeometry";let a=[],o=[],l=[],u=.001;0==r&&(s=1),s=Math.max(1,Math.floor(s)),r=Math.min(r,100),i=Math.min(180-u,i),i*=Math.PI/180;let c=[],h=Math.PI/2,d=function(){return new Lv(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,arguments.length>2&&void 0!==arguments[2]?arguments[2]:0)},p=d(),f=d(),[m,g,v]=[t/2,e/2,n/2],y=-g,x=+g,[b,w,D]=[d(y,-m,+v),d(y,-m,-v),d(y,+m,-v)],_=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return Math.sin(e-Math.PI/(+t+1))},S=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return Math.cos(e-Math.PI/(+t+1))};D.y=Math.sin(i)*t-m;let E=Math.cos(i)*t-v,C=b.z-u;i<=h?(D.z=Math.min(E,C),D.z==C&&(D.y-=(E-C)/Math.tan(h-i))):w.z=Math.min(w.z-E-v,b.z-u),p.subVectors(b,w),f.subVectors(D,w);let A=Math.min(p.length(),f.length())*r/100,M=A*Math.tan(i/2),T=A/Math.cos(i/2),P=p.clone().normalize().add(f.normalize()).setLength(T).add(w);p.set(0,_(i,!0),S(i,!0)),c.push([D,p.clone()]);let F=(Math.PI-i)/s;for(let V=0;V<=s;V++){let e=h+i+V*F;p.set(0,Math.sin(e)*M,Math.cos(e)*M),p.add(P),f.set(0,_(e),S(e)),c.push([p.clone(),f.clone()])}c.push([b,d(0,1,0)]);let O=Math.sin(F/2)*M*2,I=c.length-1,k=c[0][0].distanceTo(c[1][0]),B=k+O*s+c[I-1][0].distanceTo(c[I][0]);c[0].push(1);for(let V=0;V<=s;V++)c[V+1].push(1-(k+V*O)/B);c[I].push(0);let R,L,z,[N,j,U]=c[0];for(let V=1;V<c.length;V++)[R,L,z]=c[V],a.push(y,N.y,N.z,y,R.y,R.z,x,N.y,N.z,x,N.y,N.z,y,R.y,R.z,x,R.y,R.z),o.push(0,j.y,j.z,0,L.y,L.z,0,j.y,j.z,0,j.y,j.z,0,L.y,L.z,0,L.y,L.z),l.push(0,U,0,z,1,U,1,U,0,z,1,z),[N,j,U]=[R,L,z];this.setAttribute("position",new rx(a,3)),this.setAttribute("normal",new rx(o,3)),this.setAttribute("uv",new rx(l,2))}},vU=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){var n,i,r;let s=Object.assign({},null!==(n=null===t||void 0===t?void 0:t.parameters)&&void 0!==n?n:{width:100,depth:0,innerRadiusPercent:38.19,spikes:5,cornerRadius:0,angle:360,extrudeBevelSize:0,extrudeBevelSegments:1},e.parameters);return{shape:e.shape&&e.shape instanceof JN?e.shape:new JN,parameters:Object.assign(s,{width:Math.abs(s.width),height:Math.abs(null!==(i=s.height)&&void 0!==i?i:s.width),depth:Math.abs(null!==(r=s.depth)&&void 0!==r?r:0)})}}static build(e){let{width:t,height:n,innerRadiusPercent:i,spikes:r,cornerRadius:s,angle:a,depth:o,extrudeBevelSize:l,extrudeBevelSegments:u}=e.parameters,c=e.shape,h=.5*t,p=.5*n,f=a*Math.PI/360/r,m=Math.PI/2*3*-1,g=h*i/100,v=p*i/100;if(3===r&&50===i){f=2*Math.PI/r;for(let e=0;e<r;e++){let t=f*e,n=0+Math.sin(t)*h,i=0+Math.cos(t)*p;c.addPoint(c.createPoint(n,i))}}else for(let d=0;d<r;d++){let e=0+Math.cos(m)*h,t=0+Math.sin(m)*p;c.addPoint(c.createPoint(e,t)),m+=f,e=0+Math.cos(m)*g,t=0+Math.sin(m)*v,c.addPoint(c.createPoint(e,t)),m+=f}c.isClosed=!0;for(let d=0,x=c.points.length;d<x;d++)c.points[d].roundness=s;c.roundness=s,c.update();let y=Oj.create({shape:c,parameters:{roundness:s,depth:o,extrudeBevelSize:l,extrudeBevelSegments:u}});return Object.assign(y,{userData:d(d({},e),{},{type:"StarGeometry"})})}};var yU={parseRgba:function(e){return/^(rgba)?\(\s*(\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d+(?:\.\d+)?))?\s*\)$/.exec(e.toLowerCase())},hsvToRgb:function(e,t,n){let i,r,s,a=Math.floor(6*e),o=6*e-a,l=n*(1-t),u=n*(1-o*t),c=n*(1-(1-o)*t);switch(a%6){case 0:i=n,r=c,s=l;break;case 1:i=u,r=n,s=l;break;case 2:i=l,r=n,s=c;break;case 3:i=l,r=u,s=n;break;case 4:i=c,r=l,s=n;break;default:i=n,r=l,s=u}return{r:255*i,g:255*r,b:255*s}},rgbToHsv:function(e,t,n){e/=255,t/=255,n/=255;let i,r=Math.max(e,t,n),s=Math.min(e,t,n),a=r,o=r-s,l=0==r?0:o/r;if(r==s)i=0;else{switch(r){case e:i=(t-n)/o+(t<n?6:0);break;case t:i=(n-e)/o+2;break;default:i=(e-t)/o+4}i/=6}return{h:i,s:l,v:a}},hexToRgb:function(e){return{r:(e=Math.floor(e))>>16&255,g:e>>8&255,b:255&e}},rgbToHex:function(e,t,n){return(e<<16)+(t<<8)+n},rgbToHexString:function(e,t,n){return"#"+[e=Math.round(e),t=Math.round(t),n=Math.round(n)].map((e=>e.toString(16).padStart(2,"0"))).join("").toUpperCase()},hexStringToRgb:function(e){e=e.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,((e,t,n,i)=>String(t+t+n+n+i+i)));let t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return t?{r:parseInt(t[1],16),g:parseInt(t[2],16),b:parseInt(t[3],16)}:null}},xU=class{static get version(){return"1.3.8"}static toString(){return"JavaScript Expression Parser (JSEP) v"+xU.version}static addUnaryOp(e){return xU.max_unop_len=Math.max(e.length,xU.max_unop_len),xU.unary_ops[e]=1,xU}static addBinaryOp(e,t,n){return xU.max_binop_len=Math.max(e.length,xU.max_binop_len),xU.binary_ops[e]=t,n?xU.right_associative.add(e):xU.right_associative.delete(e),xU}static addIdentifierChar(e){return xU.additional_identifier_chars.add(e),xU}static addLiteral(e,t){return xU.literals[e]=t,xU}static removeUnaryOp(e){return delete xU.unary_ops[e],e.length===xU.max_unop_len&&(xU.max_unop_len=xU.getMaxKeyLen(xU.unary_ops)),xU}static removeAllUnaryOps(){return xU.unary_ops={},xU.max_unop_len=0,xU}static removeIdentifierChar(e){return xU.additional_identifier_chars.delete(e),xU}static removeBinaryOp(e){return delete xU.binary_ops[e],e.length===xU.max_binop_len&&(xU.max_binop_len=xU.getMaxKeyLen(xU.binary_ops)),xU.right_associative.delete(e),xU}static removeAllBinaryOps(){return xU.binary_ops={},xU.max_binop_len=0,xU}static removeLiteral(e){return delete xU.literals[e],xU}static removeAllLiterals(){return xU.literals={},xU}get char(){return this.expr.charAt(this.index)}get code(){return this.expr.charCodeAt(this.index)}constructor(e){this.expr=e,this.index=0}static parse(e){return new xU(e).parse()}static getMaxKeyLen(e){return Math.max(0,...Object.keys(e).map((e=>e.length)))}static isDecimalDigit(e){return e>=48&&e<=57}static binaryPrecedence(e){return xU.binary_ops[e]||0}static isIdentifierStart(e){return e>=65&&e<=90||e>=97&&e<=122||e>=128&&!xU.binary_ops[String.fromCharCode(e)]||xU.additional_identifier_chars.has(String.fromCharCode(e))}static isIdentifierPart(e){return xU.isIdentifierStart(e)||xU.isDecimalDigit(e)}throwError(e){let t=new Error(e+" at character "+this.index);throw t.index=this.index,t.description=e,t}runHook(e,t){if(xU.hooks[e]){let n={context:this,node:t};return xU.hooks.run(e,n),n.node}return t}searchHook(e){if(xU.hooks[e]){let t={context:this};return xU.hooks[e].find((function(e){return e.call(t.context,t),t.node})),t.node}}gobbleSpaces(){let e=this.code;for(;e===xU.SPACE_CODE||e===xU.TAB_CODE||e===xU.LF_CODE||e===xU.CR_CODE;)e=this.expr.charCodeAt(++this.index);this.runHook("gobble-spaces")}parse(){this.runHook("before-all");let e=this.gobbleExpressions(),t=1===e.length?e[0]:{type:xU.COMPOUND,body:e};return this.runHook("after-all",t)}gobbleExpressions(e){let t,n,i=[];for(;this.index<this.expr.length;)if(t=this.code,t===xU.SEMCOL_CODE||t===xU.COMMA_CODE)this.index++;else if(n=this.gobbleExpression())i.push(n);else if(this.index<this.expr.length){if(t===e)break;this.throwError('Unexpected "'+this.char+'"')}return i}gobbleExpression(){let e=this.searchHook("gobble-expression")||this.gobbleBinaryExpression();return this.gobbleSpaces(),this.runHook("after-expression",e)}gobbleBinaryOp(){this.gobbleSpaces();let e=this.expr.substr(this.index,xU.max_binop_len),t=e.length;for(;t>0;){if(xU.binary_ops.hasOwnProperty(e)&&(!xU.isIdentifierStart(this.code)||this.index+e.length<this.expr.length&&!xU.isIdentifierPart(this.expr.charCodeAt(this.index+e.length))))return this.index+=t,e;e=e.substr(0,--t)}return!1}gobbleBinaryExpression(){let e,t,n,i,r,s,a,o,l;if(s=this.gobbleToken(),!s||(t=this.gobbleBinaryOp(),!t))return s;for(r={value:t,prec:xU.binaryPrecedence(t),right_a:xU.right_associative.has(t)},a=this.gobbleToken(),a||this.throwError("Expected expression after "+t),i=[s,r,a];t=this.gobbleBinaryOp();){if(n=xU.binaryPrecedence(t),0===n){this.index-=t.length;break}r={value:t,prec:n,right_a:xU.right_associative.has(t)},l=t;let o=e=>r.right_a&&e.right_a?n>e.prec:n<=e.prec;for(;i.length>2&&o(i[i.length-2]);)a=i.pop(),t=i.pop().value,s=i.pop(),e={type:xU.BINARY_EXP,operator:t,left:s,right:a},i.push(e);e=this.gobbleToken(),e||this.throwError("Expected expression after "+l),i.push(r,e)}for(o=i.length-1,e=i[o];o>1;)e={type:xU.BINARY_EXP,operator:i[o-1].value,left:i[o-2],right:e},o-=2;return e}gobbleToken(){let e,t,n,i;if(this.gobbleSpaces(),i=this.searchHook("gobble-token"),i)return this.runHook("after-token",i);if(e=this.code,xU.isDecimalDigit(e)||e===xU.PERIOD_CODE)return this.gobbleNumericLiteral();if(e===xU.SQUOTE_CODE||e===xU.DQUOTE_CODE)i=this.gobbleStringLiteral();else if(e===xU.OBRACK_CODE)i=this.gobbleArray();else{for(t=this.expr.substr(this.index,xU.max_unop_len),n=t.length;n>0;){if(xU.unary_ops.hasOwnProperty(t)&&(!xU.isIdentifierStart(this.code)||this.index+t.length<this.expr.length&&!xU.isIdentifierPart(this.expr.charCodeAt(this.index+t.length)))){this.index+=n;let e=this.gobbleToken();return e||this.throwError("missing unaryOp argument"),this.runHook("after-token",{type:xU.UNARY_EXP,operator:t,argument:e,prefix:!0})}t=t.substr(0,--n)}xU.isIdentifierStart(e)?(i=this.gobbleIdentifier(),xU.literals.hasOwnProperty(i.name)?i={type:xU.LITERAL,value:xU.literals[i.name],raw:i.name}:i.name===xU.this_str&&(i={type:xU.THIS_EXP})):e===xU.OPAREN_CODE&&(i=this.gobbleGroup())}return i?(i=this.gobbleTokenProperty(i),this.runHook("after-token",i)):this.runHook("after-token",!1)}gobbleTokenProperty(e){this.gobbleSpaces();let t=this.code;for(;t===xU.PERIOD_CODE||t===xU.OBRACK_CODE||t===xU.OPAREN_CODE||t===xU.QUMARK_CODE;){let n;if(t===xU.QUMARK_CODE){if(this.expr.charCodeAt(this.index+1)!==xU.PERIOD_CODE)break;n=!0,this.index+=2,this.gobbleSpaces(),t=this.code}this.index++,t===xU.OBRACK_CODE?(e={type:xU.MEMBER_EXP,computed:!0,object:e,property:this.gobbleExpression()},this.gobbleSpaces(),t=this.code,t!==xU.CBRACK_CODE&&this.throwError("Unclosed ["),this.index++):t===xU.OPAREN_CODE?e={type:xU.CALL_EXP,arguments:this.gobbleArguments(xU.CPAREN_CODE),callee:e}:(t===xU.PERIOD_CODE||n)&&(n&&this.index--,this.gobbleSpaces(),e={type:xU.MEMBER_EXP,computed:!1,object:e,property:this.gobbleIdentifier()}),n&&(e.optional=!0),this.gobbleSpaces(),t=this.code}return e}gobbleNumericLiteral(){let e,t,n="";for(;xU.isDecimalDigit(this.code);)n+=this.expr.charAt(this.index++);if(this.code===xU.PERIOD_CODE)for(n+=this.expr.charAt(this.index++);xU.isDecimalDigit(this.code);)n+=this.expr.charAt(this.index++);if(e=this.char,"e"===e||"E"===e){for(n+=this.expr.charAt(this.index++),e=this.char,("+"===e||"-"===e)&&(n+=this.expr.charAt(this.index++));xU.isDecimalDigit(this.code);)n+=this.expr.charAt(this.index++);xU.isDecimalDigit(this.expr.charCodeAt(this.index-1))||this.throwError("Expected exponent ("+n+this.char+")")}return t=this.code,xU.isIdentifierStart(t)?this.throwError("Variable names cannot start with a number ("+n+this.char+")"):(t===xU.PERIOD_CODE||1===n.length&&n.charCodeAt(0)===xU.PERIOD_CODE)&&this.throwError("Unexpected period"),{type:xU.LITERAL,value:parseFloat(n),raw:n}}gobbleStringLiteral(){let e="",t=this.index,n=this.expr.charAt(this.index++),i=!1;for(;this.index<this.expr.length;){let t=this.expr.charAt(this.index++);if(t===n){i=!0;break}if("\\"===t)switch(t=this.expr.charAt(this.index++),t){case"n":e+="\n";break;case"r":e+="\r";break;case"t":e+="\t";break;case"b":e+="\b";break;case"f":e+="\f";break;case"v":e+="\v";break;default:e+=t}else e+=t}return i||this.throwError('Unclosed quote after "'+e+'"'),{type:xU.LITERAL,value:e,raw:this.expr.substring(t,this.index)}}gobbleIdentifier(){let e=this.code,t=this.index;for(xU.isIdentifierStart(e)?this.index++:this.throwError("Unexpected "+this.char);this.index<this.expr.length&&(e=this.code,xU.isIdentifierPart(e));)this.index++;return{type:xU.IDENTIFIER,name:this.expr.slice(t,this.index)}}gobbleArguments(e){let t=[],n=!1,i=0;for(;this.index<this.expr.length;){this.gobbleSpaces();let r=this.code;if(r===e){n=!0,this.index++,e===xU.CPAREN_CODE&&i&&i>=t.length&&this.throwError("Unexpected token "+String.fromCharCode(e));break}if(r===xU.COMMA_CODE){if(this.index++,i++,i!==t.length)if(e===xU.CPAREN_CODE)this.throwError("Unexpected token ,");else if(e===xU.CBRACK_CODE)for(let e=t.length;e<i;e++)t.push(null)}else if(t.length!==i&&0!==i)this.throwError("Expected comma");else{let e=this.gobbleExpression();(!e||e.type===xU.COMPOUND)&&this.throwError("Expected comma"),t.push(e)}}return n||this.throwError("Expected "+String.fromCharCode(e)),t}gobbleGroup(){this.index++;let e=this.gobbleExpressions(xU.CPAREN_CODE);if(this.code===xU.CPAREN_CODE)return this.index++,1===e.length?e[0]:!!e.length&&{type:xU.SEQUENCE_EXP,expressions:e};this.throwError("Unclosed (")}gobbleArray(){return this.index++,{type:xU.ARRAY_EXP,elements:this.gobbleArguments(xU.CBRACK_CODE)}}},bU=new class{add(e,t,n){if("string"!=typeof arguments[0])for(let i in arguments[0])this.add(i,arguments[0][i],arguments[1]);else(Array.isArray(e)?e:[e]).forEach((function(e){this[e]=this[e]||[],t&&this[e][n?"unshift":"push"](t)}),this)}run(e,t){this[e]=this[e]||[],this[e].forEach((function(e){e.call(t&&t.context?t.context:t,t)}))}};Object.assign(xU,{hooks:bU,plugins:new class{constructor(e){this.jsep=e,this.registered={}}register(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];t.forEach((e=>{if("object"!=typeof e||!e.name||!e.init)throw new Error("Invalid JSEP plugin format");this.registered[e.name]||(e.init(this.jsep),this.registered[e.name]=e)}))}}(xU),COMPOUND:"Compound",SEQUENCE_EXP:"SequenceExpression",IDENTIFIER:"Identifier",MEMBER_EXP:"MemberExpression",LITERAL:"Literal",THIS_EXP:"ThisExpression",CALL_EXP:"CallExpression",UNARY_EXP:"UnaryExpression",BINARY_EXP:"BinaryExpression",ARRAY_EXP:"ArrayExpression",TAB_CODE:9,LF_CODE:10,CR_CODE:13,SPACE_CODE:32,PERIOD_CODE:46,COMMA_CODE:44,SQUOTE_CODE:39,DQUOTE_CODE:34,OPAREN_CODE:40,CPAREN_CODE:41,OBRACK_CODE:91,CBRACK_CODE:93,QUMARK_CODE:63,SEMCOL_CODE:59,COLON_CODE:58,unary_ops:{"-":1,"!":1,"~":1,"+":1},binary_ops:{"||":1,"&&":2,"|":3,"^":4,"&":5,"==":6,"!=":6,"===":6,"!==":6,"<":7,">":7,"<=":7,">=":7,"<<":8,">>":8,">>>":8,"+":9,"-":9,"*":10,"/":10,"%":10},right_associative:new Set,additional_identifier_chars:new Set(["$","_"]),literals:{true:!0,false:!1,null:null},this_str:"this"}),xU.max_unop_len=xU.getMaxKeyLen(xU.unary_ops),xU.max_binop_len=xU.getMaxKeyLen(xU.binary_ops);var wU=e=>new xU(e).parse();Object.getOwnPropertyNames(xU).forEach((e=>{void 0===wU[e]&&"prototype"!==e&&(wU[e]=xU[e])})),wU.Jsep=xU;var DU={name:"ternary",init(e){e.hooks.add("after-expression",(function(t){if(t.node&&this.code===e.QUMARK_CODE){this.index++;let n=t.node,i=this.gobbleExpression();if(i||this.throwError("Expected expression"),this.gobbleSpaces(),this.code===e.COLON_CODE){this.index++;let r=this.gobbleExpression();if(r||this.throwError("Expected expression"),t.node={type:"ConditionalExpression",test:n,consequent:i,alternate:r},n.operator&&e.binary_ops[n.operator]<=.9){let i=n;for(;i.right.operator&&e.binary_ops[i.right.operator]<=.9;)i=i.right;t.node.test=i.right,i.right=t.node,t.node=n}}else this.throwError("Expected :")}}))}};function _U(e){return{all:e=e||new Map,on:function(t,n){var i=e.get(t);i?i.push(n):e.set(t,[n])},off:function(t,n){var i=e.get(t);i&&(n?i.splice(i.indexOf(n)>>>0,1):e.set(t,[]))},emit:function(t,n){var i=e.get(t);i&&i.slice().map((function(e){e(n)})),(i=e.get("*"))&&i.slice().map((function(e){e(t,n)}))}}}wU.plugins.register(DU);var SU=class{constructor(e,t,n){var i;this.id=e,this.userAPI=t,this.result=void 0,this.error="null",this.isPrefetched=!1,this.isLoading=!1,this.isLoaded=!1,this.prefetchPromise=new Promise((e=>e())),this.emitter=_U(),this._innerCallUserAPI=async e=>{this.emitter.emit("start",{userAPIId:this.id}),this.isLoading=!0,this.isLoading=!1;try{this.result=await async function(e,t){var n,i,r,s,a;let o,l,u=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new AbortController,c=e.url,h=null!==(n=null===(i=e.proxy)||void 0===i?void 0:i.enabled)&&void 0!==n&&n;if("OpenAI"===(null===(r=e.integration)||void 0===r?void 0:r.type)){let n=AU(""===e.integration.prompt?[]:JSON.parse(e.integration.prompt),t),i=""===e.integration.behavior?[]:AU(JSON.parse(e.integration.behavior),t);l='{\n\t\t"model": "'.concat(e.integration.model,'",\n\t\t"messages": [').concat(e.integration.useBehavior?'\n\t\t{\n\t\t\t"role": "system",\n\t\t\t"content": "'.concat(i,'"\n\t\t},'):"",'\n\t\t{\n\t\t\t"role": "user",\n\t\t\t"content": "').concat(n,'"\n\t\t}\n\t\t]\n\t}')}if(h){let n;c="".concat("https://apis.spline.design/","file/").concat(e.proxy.fileId,"/external-api/request?uuidexternalapi=").concat(e.proxy.proxyId),void 0!==l?n=l:"POST"===e.method&&e.body&&(n=AU(JSON.parse(e.body),t)),void 0!==n&&(c+="&data=".concat(encodeURIComponent(n.replace(/(\r\n|\n|\r|\t)/gm,""))))}else"OpenAI"===(null===(s=e.integration)||void 0===s?void 0:s.type)?o=l:"POST"===e.method&&e.body&&(o=AU(JSON.parse(e.body),t));let d=await fetch(c,{method:h?"GET":e.method,headers:h?void 0:EU(e),signal:u.signal,body:o});if(!d.ok)throw new Error("status:"+d.status+"_:_"+d.statusText);if("OpenAI"===(null===(a=e.integration)||void 0===a?void 0:a.type)){let e=await d.json();return h&&(e=e.response),{content:e.choices[0].message.content}}{let e=await d.json();return h&&(e=e.response),e}}(this.userAPI,e),this.error="null",this.emitter.emit("success",{userAPIId:this.id})}catch(t){var n,i;let r=null!==(n=null===(i=t.message)||void 0===i||null===(i=i.split("_:_"))||void 0===i||null===(i=i[0])||void 0===i?void 0:i.replace("status:",""))&&void 0!==n?n:"null";this.error=r,this.result=null,this.emitter.emit("error",{userAPIId:this.id})}this.isLoading=!1,this.isPrefetched=!0,this.isLoaded=!0},"OpenAI"===(null===t||void 0===t||null===(i=t.integration)||void 0===i?void 0:i.type)?this.result={content:""}:"GET"===t.method&&""!==t.url&&(this.prefetchPromise=this.prefetch(n)),this._debouncedCallUserAPI=this._innerCallUserAPI,this._updateDebouncedCallUserAPI(),this._debouncedPrefetch=iF(this.prefetch,1e3,{trailing:!0})}_updateDebouncedCallUserAPI(){this._debouncedCallUserAPI=void 0!==this.userAPI.debounce&&this.userAPI.debounce>0?iF(this._innerCallUserAPI,this.userAPI.debounce,{leading:!0,trailing:!0}):this._innerCallUserAPI}async prefetch(e){await this.callUserAPI(e)}async callUserAPI(e){await this._debouncedCallUserAPI(e)}update(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];this.userAPI=e,this._updateDebouncedCallUserAPI(),""!==this.userAPI.url&&"GET"===this.userAPI.method&&n&&this._debouncedPrefetch(t)}retrieveValue(e){if(this.result)try{return OO.zoom(this.result,e)}catch(Mn){console.error(Mn)}}retrieveZoomedKeyValues(e){if(this.result){let t=e&&e.length?OO.zoom(this.result,e):this.result;if(function(e){return"object"==typeof e&&null!==e}(t))return Object.entries(t);if(function(e){return Array.isArray(e)}(t))return t.map(((e,t)=>[t.toString(),e]));throw function(e){return"string"==typeof e||"number"==typeof e||"boolean"==typeof e||null===e}(t)?new Error("This path points to a value, use retrieveValue() instead. "+(null===e||void 0===e?void 0:e.join("."))):new Error("Path error"+(null===e||void 0===e?void 0:e.join(".")))}}dispose(){}on(e,t){this.emitter.on(e,t)}off(e,t){this.emitter.off(e,t)}get autostart(){return this.userAPI.autoStart}};function EU(e){let t=new Headers;return e.headers.forEach((e=>{""!==e.data.key&&t.append(e.data.key,e.data.value)})),t}var CU=(e,t)=>{if("string"==typeof e){let n=t.getVariable(e);if(n)return CU(n,t)}return cR.isBoolean(e)?cR.getDisplayedValue(e).toLowerCase():cR.getDisplayedValue(e)},AU=(e,t)=>e.map(((e,n)=>{if("text"in e)return e.text;if("type"in e){if("paragraph"===e.type)return(n>0?"\n":"")+AU(e.children,t);if("variable"===e.type){let n=t.getVariable(e.variableId);if(void 0!==n)return CU(n,t)}}return""})).join(""),MU=["+","-","*","/","(",")","==","!=",">","<",">=","<=","and","or","!","%","^",","],TU=["0","1","2","3","4","5","6","7","8","9","."],PU=["sin","cos","tan","asin","acos","atan","atan2","sqrt","abs","log","exp","floor","ceil","round","min","max","random"];function FU(e){return"string"==typeof e&&(!isNaN(e)&&!isNaN(parseFloat(e)))}function OU(e,t){let n,i,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"number",s="";for(let l=0;l<e.length;l++){let n=e[l];if("objType"in n&&"api"===n.objType){let e=JSON.parse(n.id),i=e[0],r=t.getUserAPI(i);if(void 0!==r&&r instanceof SU){let t=r.retrieveValue(e.slice(1));void 0!==t&&(s+=t)}}else if("objType"in n&&"webhook"===n.objType){let e=JSON.parse(n.id),[i,r]=e,a=t.getUserWebhook(i);if(void 0!==a){let e=a.getParameterValue(r);void 0!==e&&(s+=e)}}else if("objType"in n&&"aiAssistant"===n.objType){var a;let e=t.openAIRealtime;if("objId"in n&&void 0!==n.objId){let i;if(t.scene.data.objects.traverse(((e,t)=>{var r;let s=null===(r=t.events)||void 0===r?void 0:r.find((e=>e.id===n.objId));s&&(i=s)})),void 0!==i&&"AIAssistantListener"===i.data.type){let t=null===e||void 0===e?void 0:e.computeAnalysisForListenerEvent(i.data);if(void 0!==t){s+=t;continue}}}s+=null!==(a=null===e||void 0===e?void 0:e.voice)&&void 0!==a?a:0}else if("id"in n){let i=e[l-1];if(l>0&&"id"in i)return void console.error("Two variables in a row",e);let a=t.getVariable(n.id),o=cR.getDisplayedValue(a);"number"===r&&cR.isTextValue(a)&&Array.isArray(a.textValue)&&1===a.textValue.length?o=parseFloat(o).toString():"boolean"===r&&cR.isBoolean(a)?o=a?"true":"false":"boolean"===r&&cR.isTextValue(a)&&!Array.isArray(a.textValue)&&(o='"'+o+'"'),s+=o}else"string"!==r?"and"!==n.name?"or"!==n.name?"True"!==n.name?"False"!==n.name?"boolean"!==r||FU(n.name)||TU.includes(n.name)||MU.includes(n.name)||PU.includes(n.name.replace(/\($/g,""))?s+=n.name:s+='"'+n.name+'"':s+="false":s+="true":s+="||":s+="&&":('"'!==n.name&&("+"!==n.name||n.escaped)&&(s+=n.name),"+"===n.name&&!n.escaped&&"\\"===s[s.length-1]&&(s=s.slice(0,-1)+n.name))}if("string"===r)return s;if(0===e.length){if("number"===r)return 0;if("boolean"===r)return!1}try{n=wU(s)}catch(o){return void console.error(s,o)}try{i=IU(n)}catch(o){console.error(s,n,o)}return i}function IU(e){switch(e.type){case"BinaryExpression":switch(e.operator){case"==":return Number(IU(e.left)===IU(e.right));case"!=":return Number(IU(e.left)!==IU(e.right));case">":return Number(IU(e.left)>IU(e.right));case">=":return Number(IU(e.left)>=IU(e.right));case"<":return Number(IU(e.left)<IU(e.right));case"<=":return Number(IU(e.left)<=IU(e.right));case"+":return IU(e.left)+IU(e.right);case"-":return IU(e.left)-IU(e.right);case"*":return IU(e.left)*IU(e.right);case"/":return IU(e.left)/IU(e.right);case"%":return IU(e.left)%IU(e.right);case"&&":return IU(e.left)&&IU(e.right);case"||":return IU(e.left)||IU(e.right);case"^":return Math.pow(IU(e.left),IU(e.right));default:throw new Error("Unknown operator: "+e.operator)}case"UnaryExpression":switch(e.operator){case"-":return-IU(e.argument);case"!":return Number(!IU(e.argument));default:throw new Error("Unknown operator: "+e.operator)}case"Identifier":throw new Error("Unknown identifier: "+e.name);case"Literal":return e.value;case"CallExpression":if("Identifier"===e.callee.type){if("random"===e.callee.name){let t=0,n=1;if(e.arguments.length>=1)try{t=IU(e.arguments[0])}catch(un){console.warn(un)}if(e.arguments.length>=2)try{n=IU(e.arguments[1])}catch(un){console.warn(un)}return t=Math.min(n,t),n=Math.max(n,t),t+Math.random()*(n-t)}return Math[e.callee.name].apply(null,e.arguments.map(IU))}throw new Error("Unknown node");default:throw new Error("Unknown node type: "+e.type)}}wU.addBinaryOp("^",11,!0);var kU=new py,BU=new py;var RU=class extends dx{constructor(e){super(),this.type="PathExtrusionGeometry",this.inputs=e,this.build()}_isGeometryClosed(){return this.inputs.path.isClosed&&1===this.inputs.parameters.extrusion.depth}_isOpenEnded(){let e=this.inputs.parameters.extrusion;return!(this.inputs.path.isClosed&&1===e.depth)||!function(e,t){let n=2*Math.PI;return(e%n+n)%n===(t%n+n)%n}(e.twist,0)||e.startScale!==e.endScale}build(){let e=this._extractPathPoints();if(e.length<2)return;let t=this._computeBasisMatrices(e),{depth:n,offset:i}=this.inputs.parameters.extrusion;n=Math.max(0,Math.min(n,1)),i=Math.max(0,Math.min(i,1));let r=this.inputs.path.isClosed?e.length:e.length-1,s=Math.floor(i*r),a=this.inputs.path.isClosed?Math.ceil((n+i)*r):Math.ceil(Math.min(1,n+i)*r),o=Math.min(Math.max(2,a-s+1),r+2),l=[],u=[];for(let k=0;k<o;k++){let n=this.inputs.path.isClosed?(k+s)%e.length:Math.min(k+s,e.length-1);l.push(e[n].clone()),u.push(t[n].clone())}let c=(e,t,n)=>{l[e]=l[e].clone().lerp(l[t],n),u[e]=function(e,t,n){let i=[new Lv,new Lv,new Lv],r=[new Lv,new Lv,new Lv];return e.extractBasis(i[0],i[1],i[2]),t.extractBasis(r[0],r[1],r[2]),i.forEach(((e,t)=>{let i=r[t],s=ov.lerp(e.length(),i.length(),n);e.lerp(i,n).setLength(s)})),(new py).makeBasis(i[0],i[1],i[2])}(u[e],u[t],n)},h=0,d=i*r%1;(!this.inputs.path.isClosed||n<=1)&&(d||0===i)&&(h=d,c(0,1,h));let p=0,f=(i+n)*r%1;if((this.inputs.path.isClosed&&n<=1||!this.inputs.path.isClosed&&i+n<1)&&f&&(p=f,c(l.length-1,l.length-2,1-p)),0===n){let e=l.length-1;l[e].copy(l[0]),u[e].copy(u[0])}this._applyPathModifiers(u,h,p);let{bevel:m,bevelSides:g}=this.inputs.parameters.extrusion,v=m>0?this.inputs.parameters.extrusion.capType:"flat",y=5;"Custom"===this.inputs.parameters.extrusion.shape.type&&(y="low"===this.inputs.parameters.extrusion.shape.shapeQuality?5:12);let x,{regions:b,infos:w,vertices:D}=this._computeShapePoints(y),_=0;"round"===v&&(x=new Tj(this.inputs.shapeData,2*m,m,y,g,void 0,!0),_=x.getAttribute("position").count);let S=0,E=0;w.sort(((e,t)=>e.start-t.start)),w.forEach((e=>{e.verticesStart=S,e.verticesCount=e.continuous.reduce(((e,t,n)=>e+(0!==n&&t?1:2)),0),E+=e.verticesCount,S=E}));let C,A=E*o,M=0;if(this._isOpenEnded()&&"flat"===v){try{C=yj({windingRule:WN.ODD,elementType:GN.POLYGONS,polySize:3,vertexSize:2,strict:!0,contours:b})}catch(I){C=Aj}M=C.vertexCount}let T=A+2*M+2*_,P=A+2*M,F={positions:new Float32Array(3*T),normals:new Float32Array(3*T),uvs:new Float32Array(2*T)},O=[];if(w.forEach((e=>{this._extrudeRegion(e,D,u,l,F,O,this._isGeometryClosed()&&!this._isOpenEnded())})),C&&(this._closeEnd(C,A,O,F,u[0],l[0],!1),this._closeEnd(C,A+M,O,F,u[u.length-1],l[l.length-1],!0)),x){F.positions.set(x.getAttribute("position").array,3*P),F.normals.set(x.getAttribute("normal").array,3*P),F.uvs.set(x.getAttribute("uv").array,2*P);for(let i=P;i<P+_;i++)F.uvs[2*i+1]=1e-4;let e=O.length;O.push(...x.getIndex().array.map((e=>e+P))),P+=_,F.positions.set(x.getAttribute("position").array,3*P),F.normals.set(x.getAttribute("normal").array,3*P),F.uvs.set(x.getAttribute("uv").array,2*P);let t=O.length;O.push(...x.getIndex().array.map((e=>e+P))),this.setAttribute("position",new tx(F.positions,3)),this.setAttribute("normal",new tx(F.normals,3)),this.setAttribute("uv",new tx(F.uvs,2)),this.setIndex(O);let n=kU;n.copy(u[u.length-1]).setPosition(l[l.length-1]),this.applyMatrix4OnRange(n,P,T),n.copy(u[0]).setPosition(l[0]).multiply(BU.makeScale(1,1,-1)),this.applyMatrix4OnRange(n,P-_,P),this.reverseIndicesOnRange(e,t)}else this.setAttribute("position",new tx(F.positions,3)),this.setAttribute("normal",new tx(F.normals,3)),this.setAttribute("uv",new tx(F.uvs,2)),this.setIndex(O)}_extractPathPoints(){let e=nN(this.inputs.path).getPoints(this.inputs.path.subdivisions);if(e.length<2)return[];let t=[e[0]];return e.forEach((e=>{t[t.length-1].distanceToSquared(e)>.001&&t.push(e)})),this.inputs.path.isClosed&&t[t.length-1].distanceTo(t[0])<.001&&t.pop(),t}_computeBasisMatrices(e){let t=[],n=e.length,i=this.inputs.path.isClosed,r=new Lv,s=new Lv,a=new Lv,o=new Lv,l=new Lv(0,1,0);for(let f=0;f<n;f++){let u,c,h=e[f];u=0===f?i?e[e.length-2]:h.clone().multiplyScalar(2).sub(e[1]):e[f-1],c=f===n-1?i?e[1]:h.clone().multiplyScalar(2).sub(e[f-1]):e[f+1];let d=h.clone().sub(u).normalize(),p=c.clone().sub(h).normalize(),m=d.clone().add(p).normalize();a.copy(m),0===f&&(m.equals(l)||m.clone().negate().equals(l))&&l.set(0,0,1);let g=l.clone().cross(m).normalize(),v=m.clone().cross(g).normalize();l.copy(v),o.copy(g),0===f&&(r.copy(v),s.copy(m));let y=(new py).makeBasis(g,v,m);t.push(y)}let u=i?s:a,c=i?r:new Lv(0,1,0),h=u.clone().cross(o).normalize(),d=Math.acos(c.dot(h));if(isNaN(d))return t;let p=c.clone().cross(h);u.dot(p)>0&&(d*=-1);for(let f=1;f<t.length;f++){let e=(new py).makeRotationZ(d*f/t.length);t[f].multiply(e)}return t}_applyPathModifiers(e,t,n){let i=e.length,{angle:r,twist:s,startScale:a,endScale:o}=this.inputs.parameters.extrusion,l=new py,u=new py;return e.forEach(((e,c)=>{let h=0===c?0:c===i-1?1:(c-t)/(i-(0===n?0:1)-(t+(1-n)));l.makeRotationZ(ov.lerp(r,r+s,h)*ov.DEG2RAD);let d=ov.lerp(a,o,h);u.makeScale(d,d,d),e.multiply(l).multiply(u)})),e}_computeShapePoints(){let e,t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:12,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:WN.ODD,r=this.inputs.shapeData,s=r.extractShapePointsToFlatArray([],n),a=r.shapeHoles.map((e=>{let t=e.extractShapePointsToFlatArray([],n),i=[];for(let n=t.length-1;n>=1;n-=2){let e=t[n-1],r=t[n-0];i.push(e,r)}return i}));try{e=yj({windingRule:i,elementType:GN.BOUNDARY_CONTOURS,vertexSize:2,strict:!0,contours:[s]})}catch(p){e=Ej}try{t=yj({windingRule:WN.ODD,elementType:GN.BOUNDARY_CONTOURS,vertexSize:2,strict:!0,contours:[...a]})}catch(f){t=Cj}if(!e)throw new Error("error generating geometry");let o=e.elementCount;if(t){e.elementCount+=t.elementCount;for(let n=0;n<t.elements.length;n++){let i=t.elements[n],r=n%2===0?e.vertexCount:0;e.elements.push(i+r)}for(let n=0;n<t.vertexIndices.length;n++){let i=t.vertexIndices[n],r=e.vertexCount;e.vertexIndices.push(i+r)}for(let n=0;n<t.vertices.length;n++){let i=t.vertices[n];e.vertices.push(i)}}let l=1/0,u=-1/0,c=1/0,h=-1/0;for(let m=0,g=e.vertexCount;m<g;m++){let t=2*m,n=e.vertices[t+0],i=e.vertices[t+1];n<l&&(l=n),n>u&&(u=n),i<c&&(c=i),i>h&&(h=i)}let d=[];for(let m=e.elementCount-1;m>=0;m--){let t=m>=o,n=2*m,i=e.elements[n+0],s=e.elements[n+1],a=i+s,l={start:i,count:s,normals:[],isHole:t,continuous:[],verticesStart:0,verticesCount:0};d.push(l);let u=i,c=a-1,h=i+1,p=r.roundedCurves.length;do{let n=u-i,o=e.vertices[2*c+0],d=e.vertices[2*c+1],f=e.vertices[2*u+0],m=e.vertices[2*u+1],g=e.vertices[2*h+0],v=e.vertices[2*h+1],y=f-o,x=m-d,b=Math.sqrt(y*y+x*x);y/=b,x/=b;let w=f-g,D=m-v,_=Math.sqrt(w*w+D*D);w/=_,D/=_,l.normals[2*n+0]=-D,l.normals[2*n+1]=w;let S=e.vertexIndices[u];if(Array.isArray(S))l.continuous[n]=!1;else{let[e,t]=r.getCurveIndexFromVertexId(S-1,!0);if(t>0&&t<1)l.continuous[n]=!0;else{let i=1===t?e+1:e-1;i=(i+p)%p;let s=1===t?0:1,a=r.roundedCurves[e].getTangent(t),o=r.roundedCurves[i].getTangent(s);l.continuous[n]=a.dot(o)>.95}}t&&(l.normals[2*n+0]*=-1,l.normals[2*n+1]*=-1),[c,u,h]=[u,h,h+1],h>=a&&(h-=s)}while(h!==i+1)}return{regions:[s,...a],infos:d,vertices:e.vertices}}_insertVertex(e,t,n,i,r){let s=2*t,a=3*t;e.positions[a+0]=n.x,e.positions[a+1]=n.y,e.positions[a+2]=n.z,e.normals[a+0]=i.x,e.normals[a+1]=i.y,e.normals[a+2]=i.z,e.uvs[s+0]=r.x,e.uvs[s+1]=r.y}_extrudeRegion(e,t,n,i,r,s,a){let o=new Lv,l=new Lv,u=new Lv,c=new Lv,h=new lv;n.forEach(((s,a)=>{let d=i[a],p=e.verticesStart*n.length+e.verticesCount*a;for(let i=0;i<e.count;i++){let f=2*(e.start+i);if(o.set(t[f+0],t[f+1],0),u.copy(o).applyMatrix4(s).add(d),e.continuous[i])c.set(e.normals[2*i+0],e.normals[2*i+1],0);else{let n=0===i?2*(e.start+e.count-1):f-2;l.set(t[n+0],t[n+1],0),c.copy(o).sub(l),c.set(-c.y,c.x,0),e.isHole||c.negate()}if(c.applyMatrix4(s).normalize(),h.set(0===i?1:i/e.count,a/(n.length-1)),this._insertVertex(r,p,u,c,h),p++,!e.continuous[i]||0===i){if(0===i)c.set(e.normals[2*i+0],e.normals[2*i+1],0),h.set(0,a/(n.length-1));else{let n=i===e.count-1?2*e.start:f+2;l.set(t[n+0],t[n+1],0),c.copy(l).sub(o),c.set(-c.y,c.x,0),e.isHole||c.negate()}c.applyMatrix4(s).normalize(),this._insertVertex(r,p,u,c,h),p++}}}));let d=n.length-1;for(let p=0;p<d;p++){let t=e.verticesStart*n.length+e.verticesCount*p,i=e.verticesStart*n.length+e.verticesCount*(p+1),r=0;for(let n=0;n<e.count;n++){(!e.continuous[n]||0===n)&&r++;let a=n===e.count-1?0:r+1,o=t+r,l=t+a,u=i+a,c=i+r;e.isHole?s.push(o,u,l,o,c,u):s.push(o,l,u,o,u,c),r++}}}_closeEnd(e,t,n,i,r,s,a){let o=e.vertexCount,l=new Lv(0,0,a?-1:1).applyMatrix4(r),u=new Lv,c=new lv;for(let d=0;d<o;d++){let n=2*d;u.set(e.vertices[n+0],e.vertices[n+1],0).applyMatrix4(r).add(s),this._insertVertex(i,t+d,u,l,c)}let h=e.elements;for(let d=0;d<e.elementCount;d++){let e=3*d,i=h[e+0]+t,r=h[e+(a?1:2)]+t,s=h[e+(a?2:1)]+t;n.push(i,r,s)}}applyMatrix4OnRange(e,t,n){let i,r,s,a,o=e.elements,l=(new uv).getNormalMatrix(e).elements,u=this.attributes.position,c=this.attributes.normal;if(!u||!c)return;let h=u.array,d=c.array,p=u.itemSize;for(let f=t*p,m=n*p;f<m;f+=p)i=h[f+0],r=h[f+1],s=h[f+2],a=1/(o[3]*i+o[7]*r+o[11]*s+o[15]),h[f+0]=(o[0]*i+o[4]*r+o[8]*s+o[12])*a,h[f+1]=(o[1]*i+o[5]*r+o[9]*s+o[13])*a,h[f+2]=(o[2]*i+o[6]*r+o[10]*s+o[14])*a,i=d[f+0],r=d[f+1],s=d[f+2],d[f+0]=l[0]*i+l[3]*r+l[6]*s,d[f+1]=l[1]*i+l[4]*r+l[7]*s,d[f+2]=l[2]*i+l[5]*r+l[8]*s;u.needsUpdate=!0,c.needsUpdate=!0}reverseIndicesOnRange(e,t){let n=this.index;if(n){for(let i=e;i<t;i+=3){let e=n.getX(i),t=n.getX(i+1),r=n.getX(i+2);n.setXYZ(i,r,t,e)}n.needsUpdate=!0}}};function LU(){let e=new dx;return e.setAttribute("position",new tx(new Float32Array([]),3)),e.setIndex(new tx(new Uint16Array([]),1)),e}var zU=LU().attributes,NU=class extends dx{constructor(e,t){super(),this.charWidths=[],this.charCoords=[],this.wrappedText=[],this.isLowResolution=!1,this.vectorShapes=[],Object.assign(this.attributes,zU),this.userData={parameters:e,type:"TextGeometry"};let n=t.getFont(e.font);null!==n&&void 0!==n&&n.isLoaded?(this.font=n,this.update(e)):this.updateFont(e.font,t).then((()=>{this.update(e),null===t||void 0===t||t.requestRender()}))}async updateFont(e,t){let n=t.getFont(e);n&&(this.font=n,await n.loadingPromise)}update(e){let t=this.font;if(this.userData={parameters:e,type:"TextGeometry"},null===t||void 0===t||!t.isLoaded)return void console.warn("Cannot update text because its font is not loaded");let{width:n,height:i,depth:r,extrudeBevelSize:s,extrudeBevelSegments:a,text:o,textTransform:l}=e,u=cR.getDisplayedValue(o),c=function(e,t,n){let i=[""],r="";for(let s of n)r+=s," "===s||"\n"===s?(i[i.length-1]+=r,r="","\n"===s&&i.push("")):t.getTextWidth(i[i.length-1]+r,e)>e.width&&(i[i.length-1].length&&i.push(""),t.getTextWidth(i[i.length-1]+r,e)>e.width&&(1===r.length?(i[i.length-1]+=r,r=""):(i[i.length-1]+=r.slice(0,-1),r=r[r.length-1],i.push(""))));return i[i.length-1]+=r,i}(e,t,2===l?u.toUpperCase():3===l?u.toLowerCase():u),{shapes:h,charWidths:d,charCoords:p}=t.generateShapes(c,e),f=.5*("number"==typeof n?n:1),m=.5*("number"==typeof i?i:1),g=h.map((e=>(new JN).fromShape(e,!0)));this.vectorShapes=g;let v=g.map((e=>Oj.create({shape:e,parameters:{depth:r,extrudeBevelSegments:a,extrudeBevelSize:s,windingRule:r<=0?WN.NONZERO:WN.ODD,subdivisions:this.isLowResolution&&r>0?1:12}}))),y=v.length?aL(v):LU();y.translate(-f,m,0),this.dispose(),this.wrappedText=c,this.charCoords=p,this.charWidths=d,this.deleteAttribute("extrudeNormal"),Object.entries(y.attributes).forEach((e=>{let[t,n]=e;this.setAttribute(t,n)})),this.setIndex(y.index),this.computeBoundingSphere()}clone(){let e=bF(new dx,NU.prototype);return e.copy(this),console.log("CloneGeometry",this,e),e}copy(e){return Object.entries(e.attributes).forEach((e=>{let[t,n]=e;this.setAttribute(t,n)})),this.setIndex(e.index),this.userData={parameters:d({},e.userData.parameters),type:"TextGeometry"},this}async setText(e){this.font&&await this.font.loadingPromise,await this.update(d(d({},this.userData.parameters),{},{text:{textValue:e}}))}get text(){var e;return null!==(e=this.userData.parameters.text)&&void 0!==e?e:""}};var jU,UU,VU=new Promise((e=>{jU=e})),HU=!1;function WU(){if(!HU)return UU||(UU=async function(){let e=n.e(917).then(n.bind(n,917)),[t,i]=await Promise.all([e,fetch("".concat("https://unpkg.com/@splinetool/modelling-wasm@1.9.59/build","/process.wasm")).then((e=>e.arrayBuffer()))]),r=t.default,s=await r({wasmBinary:i});jU(s),HU=!0}(),UU)}var GU=["font"];function qU(e,t,n,i){let r,s,a;"PathGeometry"===e.type?(s=JSON.parse(JSON.stringify(e)),a=[[],["extrusion"]]):(s=d({},e),a=[[]]);for(let d of a){let e=s;for(let t of d)e=e[t];for(r in e){let n=e[r];$k(n)&&!GU.includes(r)&&(e[r]=t.getVariable(n,[i.uuid,"geometry",...d,r]),$k(e[r])&&(e[r]=1))}}let o,l={parameters:s,type:s.type};if("PathGeometry"===s.type)l.path=s.path;else if("VectorGeometry"===s.type){let e=JN.createFromState(s.shape,s.width,s.height);l.shape=e}else if("NonParametricGeometry"===s.type){var u;if(s.data.groups&&null!==(u=s.data.groups)&&void 0!==u&&u.forEach((e=>{var t;return e.materialIndex=Math.max(null!==(t=e.materialIndex)&&void 0!==t?t:0,0)})),l.geometry=(new QS).parse(s),0===l.geometry.groups.length){var c,h;let e=l.geometry;e.addGroup(0,Math.max(null!==(c=null===(h=e.getIndex())||void 0===h?void 0:h.count)&&void 0!==c?c:0,e.getAttribute("position").count),0)}}else{if("SubdivGeometry"===s.type){let t=new tV(s,n);return t.data=e,t}if("TextGeometry"===s.type)return new NU(s,t);if("InputGeometry"===s.type)return new NU(s,t);if("UIGeometry"===s.type)return mU.create({parameters:{width:s.width,height:s.height,cornerRadius:s.cornerRadius,cornerType:s.cornerType}})}try{o=SV(l)}catch(p){console.error(p)}if(!o){let e=JN.createFromState(xB.defaultData(),100,100);l.shape=e,o=SV(l)}return o}var YU=new py;function XU(e,t,n,i){let r,s,a,o=e.position.array,l=e.normal.array,u=YU.makeScale(t,n,i).invert().elements;for(var c=0,h=o.length;c<h;c+=3)o[c]*=t,o[c+1]*=n,o[c+2]*=i,r=l[c],s=l[c+1],a=l[c+2],l[c]=u[0]*r+u[4]*s+u[8]*a,l[c+1]=u[1]*r+u[5]*s+u[9]*a,l[c+2]=u[2]*r+u[6]*s+u[10]*a;e.position.needsUpdate=!0,e.normal.needsUpdate=!0}var QU,KU=new jv,ZU=new Lv;VU.then((e=>{QU=e}));var JU=new Float32Array([10,10,0,-10,10,0,-10,-10,0,10,-10,0]),$U=new Uint32Array([0,1,2,3]),eV=new Uint8Array([4]),tV=class extends dx{constructor(e,t){super(),this.data=e,this.flatShading=t,this.subdivPointer=0,this.rebuild(),this.freeSubdivPointer()}mutateDirectlyScaleBaked(e,t){this.freeSubdivPointer();let n=this.data.scaleBaked,i=Rk.div(t,n);this.subdividedGeometry&&XU(this.subdividedGeometry.attributes,...i),this.originalGeometry&&XU(this.originalGeometry.attributes,...i),this.data=e;let r=this.userData.parameters;this.userData.parameters={width:r.width*i[0],height:r.height*i[1],depth:r.depth*i[2]},this.originalGeometry.boundingSphere.center.multiply(ZU.fromArray(i));let s=ZU.set(r.width,r.height,r.depth).length();this.originalGeometry.boundingSphere.radius=s/2}ensureSubdivPointer(){return 0===this.subdivPointer&&this.rebuild(),this.subdivPointer}rebuild(){var e;let t,n,i;try{({originalGeometry:t,subdividedGeometry:n,subdivPointer:i}=tV.build(this.data,void 0,!this.flatShading,void 0))}catch(s){t=new Mx(100,100,100),i=0}this.subdivPointer=i,this.originalGeometry=t,this.subdividedGeometry=null!==n&&void 0!==n?n:void 0;let r=null!==(e=this.subdividedGeometry)&&void 0!==e?e:this.originalGeometry;Object.assign(this,r),this.calcBoundingBox()}freeSubdivPointer(){this.subdivPointer&&(tV.freeSubdivPointer(this.subdivPointer),this.subdivPointer=0)}dispose(){super.dispose(),this.freeSubdivPointer()}calcBoundingBox(){let e=this.originalGeometry;null===e.boundingSphere&&(e.boundingSphere=new ry,this.subdividedGeometry&&(this.subdividedGeometry.boundingSphere=e.boundingSphere));let t=e.attributes.position,n=e.boundingSphere.center;KU.setFromBufferAttribute(t),KU.getCenter(n),e.boundingSphere.radius=n.distanceTo(KU.max),isNaN(e.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this),KU.getSize(ZU);let i={width:ZU.x,height:ZU.y,depth:ZU.z};return this.userData.parameters=i,i}static build(e,t,n,i){var r;let s,a,o,l=null!==(r=null===e||void 0===e?void 0:e.phongAngle)&&void 0!==r?r:35;!1===n&&(l=-1),t&&(QU.free_bvh(t),QU.free_subdivision_surface(t));try{s=tV.allocate(e,i)}catch(u){console.error(u,e),s=tV.allocate({positionWASM:JU,indexWASM:$U,verticesPerFaceWASM:eV},i)}if(QU.set_destination_refinement_level(s,0),a=tV.buildLevel(s,!0,l),e.subdivisions>0)try{QU.set_destination_refinement_level(s,e.subdivisions),o=tV.buildLevel(s,!1,l)}catch(c){try{QU.set_destination_refinement_level(s,e.subdivisions-1),o=tV.buildLevel(s,!1,l)}catch(h){o=null}}else o=null;return{subdivPointer:s,originalGeometry:a,subdividedGeometry:o}}static primitiveToQuads(e,t,n){e.widthSegments>16&&(e.widthSegments=16),e.heightSegments>16&&(e.heightSegments=16),e.depthSegments>16&&(e.depthSegments=16),e.radialSegments>16&&(e.radialSegments=16),"DodecahedronGeometry"===e.type&&(e.detail=0);let i,r,s,a,o,l,u=void 0!==e.shape||void 0!==e.path?t.geometry:qU(e,n,!1);if(i="TorusGeometry"===e.type&&e.arc===2*Math.PI?u.getClosedTorusIndicesForBooleanOrSubdiv():u.getIndex(),({positions:r,triIndices:o}=iV(u.getAttribute("position"),i)),"CylinderGeometry"===e.type&&0===e.cornerRadius&&0===e.hollow&&!1===e.openEnded){let t=e.radialSegments*e.heightSegments*3*2;l=[t,t+3*e.radialSegments]}return({indices:s,verticesPerFace:a}=lV(r,o,u,l)),{positions:r,indices:s,verticesPerFace:a}}static allocate(e,t){var n;let i,r,s,a=[],o=[];e.positionWASM&&e.positionWASM.length>0?(i=e.positionWASM,r=e.indexWASM,s=e.verticesPerFaceWASM):(i=JU,r=$U,s=eV);let l,u=i.length,c=r.length,h=s.length,d=i.length+a.length+o.length,p=r.length+s.length,f=d*Float32Array.BYTES_PER_ELEMENT+p*Uint32Array.BYTES_PER_ELEMENT,m=d*Float32Array.BYTES_PER_ELEMENT,g=(Uint32Array.BYTES_PER_ELEMENT,QU._malloc(f)),v=new Float32Array(QU.HEAPF32.buffer,g,d),y=new Uint32Array(QU.HEAPU32.buffer,g+m,p);v.set(i,0),v.set(a,i.length),v.set(o,i.length+a.length),y.set(r,0),y.set(s,r.length),null!==e&&void 0!==e&&null!==(n=e.scaleBaked)&&void 0!==n&&n.some((e=>1!==e))&&(l=(new py).makeScale(...e.scaleBaked)),t&&(l?l.premultiply(t):l=t);let x=l?QU.alloc_subdivision_surface2(g,u,g+m,c,g+m+r.length*Uint32Array.BYTES_PER_ELEMENT,h,l.elements):QU.alloc_subdivision_surface(g,u,g+m,c,g+m+r.length*Uint32Array.BYTES_PER_ELEMENT,h);return QU._free(g),x}static buildLevel(e,t,n,i,r){let s=r?QU.get_mesh_data2(e,t?QU.Level.CONTROL:QU.Level.REFINED,n,r.elements):QU.get_mesh_data(e,t?QU.Level.CONTROL:QU.Level.REFINED,n),a=QU.HEAPU32.subarray(s>>2,8+(s>>2)),o=a.subarray(4,8),l=0,u=QU.HEAPU32[a[l]>>2],c=QU.HEAPF32.subarray(u>>2,(u>>2)+o[l]);l++;let h=QU.HEAPU32[a[l]>>2],d=QU.HEAPF32.subarray(h>>2,(h>>2)+o[l]);l++;let p=QU.HEAPU32[a[l]>>2],f=QU.HEAPU32.subarray(p>>2,(p>>2)+o[l]);l++;let m=QU.HEAPU32[a[l]>>2],g=QU.HEAPU32.subarray(m>>2,(m>>2)+o[l]);if(l++,void 0===i){let e=new dx;if(e.setIndex(new ix(g,1)),e.setAttribute("position",new rx(c,3)),e.setAttribute("normal",new rx(d,3)),t){e.setAttribute("faceMap",new ix(f,1));let t=new Float32Array(d.length/3*4).fill(0);e.setAttribute("color",new tx(t,4))}return QU.free_mesh_data(s),e.userData.type="SubdivGeometry",e}i.getAttribute("position").copyArray(c),i.getAttribute("normal").copyArray(d),i.attributes.position.needsUpdate=!0,i.attributes.normal.needsUpdate=!0,QU.free_mesh_data(s)}static freeSubdivPointer(e){QU.free_bvh(e),QU.free_subdivision_surface(e)}static buildControlCageWireframe(e,t,n){let i=QU.get_wireframe_data_for_base_level(e),r=QU.HEAPU32.subarray(i>>2,4+(i>>2)),s=r.subarray(2,4),a=0,o=QU.HEAPU32[r[a]>>2],l=QU.HEAPF32.subarray(o>>2,(o>>2)+s[a]);a++;let u=QU.HEAPU32[r[a]>>2],c=QU.HEAPU32.subarray(u>>2,(u>>2)+s[a]);if(void 0===t){let e=new dx;e.setAttribute("position",new rx(l,3));let t=new Float32Array(l.length);for(let i=0,r=l.length;i<r;)t[i++]=n.r,t[i++]=n.g,t[i++]=n.b;return e.setAttribute("color",new tx(t,3)),e.setIndex(new ix(c,1)),QU.free_wireframe_data_for_base_level(i),e}t.getAttribute("position").copyArray(l),t.attributes.position.needsUpdate=!0,QU.free_wireframe_data_for_base_level(i)}static updateCollabMesh(e,t,n){let i=0===t;i||QU.set_destination_refinement_level(e,t);let r=n?QU.get_topological_data2(e,i?QU.Level.CONTROL:QU.Level.REFINED,n.elements):QU.get_topological_data(e,i?QU.Level.CONTROL:QU.Level.REFINED),s=QU.HEAPU32.subarray(r>>2,6+(r>>2)),a=s.subarray(3,6),o=0,l=QU.HEAPU32[s[o]>>2],u=new Float32Array(QU.HEAPF32.subarray(l>>2,(l>>2)+a[o]));o++;let c=QU.HEAPU32[s[o]>>2],h=new Uint32Array(QU.HEAPU32.subarray(c>>2,(c>>2)+a[o]));o++;let d=QU.HEAPU32[s[o]>>2],p=new Uint8Array(QU.HEAPU32.subarray(d>>2,(d>>2)+a[o]));return QU.free_topological_data(r),{positions:u,indices:h,verticesPerFace:p}}},nV=["getX","getY","getZ"];function iV(e,t){let n={},i=t?t.count:e.count,r=0,s=[],a=[];for(let l=0;l<i;l++){let i=t?t.getX(l):l,o="";for(let t=0;t<3;t++)o+="".concat(~~(1e4*e[nV[t]](i)),",");if(o in n)s.push(n[o]);else{for(let t=0;t<3;t++)a.push(e[nV[t]](i));n[o]=r,s.push(r),r++}}let o=[];for(let l=0;l<s.length;l+=3)s[l]===s[l+1]||s[l]===s[l+2]||s[l+1]===s[l+2]||o.push(s[l],s[l+1],s[l+2]);return{positions:a,triIndices:o}}var rV=new Lv,sV=new Lv,aV=new Lv,oV=new Lv;function lV(e,t,n,i){let r=[],s=[];if(void 0!==n.userData.shape&&0===n.userData.parameters.depth&&0===n.userData.shape.shapeHoles.length){let t=n.userData.shape.extractShapePointsToFlatArray([]),i=n.userData.parameters.spikes;if("EllipseGeometry"===n.userData.type&&i<=24&&i%4===0&&n.userData.parameters.angle>=360){let e=t.length/2/i;t=t.filter(((t,n)=>Math.floor(n/2)%e===0))}let a=0;for(let e=0;e<t.length;e+=2)a+=(t[e]-t[(0===e?t.length:e)-2])*(t[e+1]+t[(0===e?t.length:e)-1]);e.length=0;let o=0;if(a<0)for(let n=0;n<t.length;n+=2)e.push(t[n],t[n+1],0),r.push(o++);else for(let n=t.length-2;n>=0;n-=2)e.push(t[n],t[n+1],0),r.push(o++);return s.push(o),{indices:r,verticesPerFace:s}}let a=new Float32Array([n.userData.parameters.depth])[0],o=0;for(;o<t.length;){if(n.useNgonForTopBottomFaceDuringBake){let n=0;if((e[3*t[o]+2]===a||0===e[3*t[o]+2])&&n++,(e[3*t[o+1]+2]===a||0===e[3*t[o+1]+2])&&n++,(e[3*t[o+2]+2]===a||0===e[3*t[o+2]+2])&&n++,3===n)break}if(t[o+1]===t[o+3]&&t[o+2]===t[o+5]||t[o+0]===t[o+3]&&t[o+2]===t[o+4]){rV.set(e[3*t[o]],e[3*t[o]+1],e[3*t[o]+2]),sV.set(e[3*t[o+1]],e[3*t[o+1]+1],e[3*t[o+1]+2]),aV.set(e[3*t[o+4]],e[3*t[o+4]+1],e[3*t[o+4]+2]),oV.set(e[3*t[o+5]],e[3*t[o+5]+1],e[3*t[o+5]+2]),sV.sub(rV).normalize(),aV.sub(rV).normalize(),oV.sub(rV).normalize();let n=sV.cross(aV).dot(oV);Math.abs(n)>.005||i&&i.some(((e,t)=>t%2!==1&&(o>=i[t]&&o<i[t+1])))?(r.push(t[o],t[o+1],t[o+2]),s.push(3),o+=3):(r.push(t[o],t[o+1],t[o+4],t[o+5]),s.push(4),o+=6)}else r.push(t[o],t[o+1],t[o+2]),s.push(3),o+=3}if(n.useNgonForTopBottomFaceDuringBake){let t=[],i=[],o=0;for(let n=0,r=0;n<e.length;n+=3,r++)0===e[n+2]&&(t.push(r),o++),e[n+2]===a&&i.push(r);if(0===n.userData.parameters.extrudeBevelSize){let e=i[0];i[0]=i[1],i[1]=e}t.reverse(),r.push(...t,...i),s.push(o,o)}return{indices:r,verticesPerFace:s}}var uV,cV,hV,dV,pV={};function fV(){if(cV)return cV;return cV=async function(){let e=n.e(516).then(n.bind(n,516)),[t,i]=await Promise.all([e,fetch("".concat("https://unpkg.com/@splinetool/boolean-wasm@1.9.59/build","/boolean.wasm")).then((e=>e.arrayBuffer()))]),r=t.default,s=await r({wasmBinary:i});uV(s)}(),cV}function mV(e){let t=e.length,n=t*Uint32Array.BYTES_PER_ELEMENT,i=t*Float32Array.BYTES_PER_ELEMENT,r=Number.isInteger(e[0])?n:i,s=hV._malloc(r);return(Number.isInteger(e[0])?new Uint32Array(hV.HEAPU32.buffer,s,t):new Float32Array(hV.HEAPF32.buffer,s,t)).set(e,0),s}function gV(e){switch(e){case 0:return hV.OP.UNION;case 1:return hV.OP.INTERSECTION;case 2:return hV.OP.A_MINUS_B;default:throw new Error("Unknown boolean operation "+e)}}function vV(e,t){void 0===dV&&(dV=hV.init_csg());let n=mV(e),i=hV.csg_calc_topological(dV,n,e.length,gV(t));hV._free(n);let r=hV.HEAPU32.subarray(i>>2,6+(i>>2)),s=r.subarray(3,6),a=0,o=hV.HEAPU32[r[a]>>2],l=new Float32Array(hV.HEAPF32.subarray(o>>2,(o>>2)+s[a]));a++;let u=hV.HEAPU32[r[a]>>2],c=new Uint32Array(hV.HEAPU32.subarray(u>>2,(u>>2)+s[a]));a++;let h=hV.HEAPU32[r[a]>>2],d=new Uint8Array(hV.HEAPU32.subarray(h>>2,(h>>2)+s[a]));return hV.free_mesh_data(i),{positions:l,indices:c,verticesPerFace:d}}function yV(e,t,n,i){void 0===dV&&(dV=hV.init_csg());let r=mV(e),s=hV.csg_calc(dV,r,e.length,i,gV(t));hV._free(r);let a=hV.HEAPU32.subarray(s>>2,5+(s>>2)),o=a.subarray(2,5),l=0,u=hV.HEAPU32[a[l]>>2],c=hV.HEAPF32.subarray(u>>2,(u>>2)+o[l]);l++;let h=hV.HEAPU32[a[l]>>2],d=hV.HEAPF32.subarray(h>>2,(h>>2)+o[l]);l++;let p=o[l];n.setAttribute("position",new rx(c,3)),n.setAttribute("normal",new rx(d,3));let f=hV.HEAPF32.subarray(5+(s>>2),5+(s>>2)+6);return null===n.boundingSphere&&(n.boundingSphere=new ry),n.boundingSphere.center.set(f[0],f[1],f[2]),n.boundingSphere.radius=(f[3]**2+f[4]**2+f[5]**2)**.5,n.userData.parameters={width:2*f[3],height:2*f[4],depth:2*f[5]},hV.free_mesh_data(s),p}function xV(e,t,n){if(void 0===hV)return-1;let i,r,s;if(t&&void 0!==e.userData.positions){let t=e.userData;s=t.verticesPerFace.length,i=t.positions,r=Array(t.verticesPerFace.reduce(((e,t)=>e+t),0)+s);for(let e=0,n=0,i=0;e<t.verticesPerFace.length;e++){r[i++]=t.verticesPerFace[e];for(let s=0;s<t.verticesPerFace[e];s++)r[i++]=t.indices[n++]}}else({positions:i,faceIndices:r,nFaces:s}=function(e,t,n){let i,r;r="TorusGeometry"===e.userData.parameters.type&&e.userData.parameters.arc===2*Math.PI?e.getClosedTorusIndicesForBooleanOrSubdiv():e.getIndex();let s,{positions:a,triIndices:o}=iV(e.getAttribute("position"),r);if(t&&n){let{indices:t,verticesPerFace:n}=lV(a,o,e);s=n.length,i=[];for(let e=0,r=0;e<s;e++){i.push(n[e]);for(let s=0;s<n[e];s++)i.push(t[r++])}}else{let e=o.length;i=Array(e+e/3),s=0;for(let t=0,n=0;n<i.length;)i[n++]=3,s++,i[n++]=o[t++],i[n++]=o[t++],i[n++]=o[t++]}return{positions:a,faceIndices:i,nFaces:s}}(e,t,n));let a=i.length,o=r.length,l=i.length,u=r.length,c=l*Float32Array.BYTES_PER_ELEMENT+u*Uint32Array.BYTES_PER_ELEMENT,h=l*Float32Array.BYTES_PER_ELEMENT,d=(Uint32Array.BYTES_PER_ELEMENT,hV._malloc(c)),p=new Float32Array(hV.HEAPF32.buffer,d,l),f=new Uint32Array(hV.HEAPU32.buffer,d+h,u);p.set(i,0),f.set(r,0);let m=hV.get_csg_mesh(d,a,d+h,o,s);return hV._free(d),m}function bV(e){return hV.has_open_edges(e)}function wV(e,t){hV.transform_csg_mesh(e,t.elements)}function DV(e){hV.free_csg_mesh(e)}((e,t)=>{for(var n in t)bm(e,n,{get:t[n],enumerable:!0})})(pV,{calcBoolean:()=>yV,calcBooleanTopological:()=>vV,freeMeshSet:()=>DV,getMeshSet:()=>xV,hasOpenEdges:()=>bV,transformMeshSet:()=>wV}),new Promise((e=>{uV=e})).then((e=>hV=e));var _V={ConeGeometry:class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){var n,i,r;let s=Object.assign({},null!==(n=null===t||void 0===t?void 0:t.parameters)&&void 0!==n?n:{width:100,radialSegments:32,heightSegments:8,openEnded:!1,thetaStart:0,thetaLength:360,cornerRadiusTop:8,cornerRadiusBottom:8,cornerSegments:8},e.parameters);return s.thetaLength=ov.clamp(s.thetaLength,0,360),{parameters:Object.assign(s,{width:Math.abs(s.width),height:Math.abs(null!==(i=s.height)&&void 0!==i?i:s.width),depth:Math.abs(null!==(r=s.depth)&&void 0!==r?r:s.width)})}}static build(e){let t,{width:n,depth:i,height:r,radialSegments:s,heightSegments:a,openEnded:o,thetaStart:l,thetaLength:u,cornerRadiusTop:c,cornerRadiusBottom:h,cornerSegments:p}=e.parameters;return 0===u?(t=new dx,t.setAttribute("position",new rx([],3))):t=c>0||h>0||u<360?new dN(0,n/2,r,s,a,o,l,u*Math.PI/180,c,h,p,0,!0):new w_(n/2,r,s,a,o),t.scale(1,1,i/n),Object.assign(t,{userData:d(d({},e),{},{type:"ConeGeometry"})})}},CubeGeometry:class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){var n,i,r;let s=Object.assign({},null!==(n=null===t||void 0===t?void 0:t.parameters)&&void 0!==n?n:{width:100,widthSegments:1,heightSegments:1,depthSegments:1,cornerRadius:8,cornerSegments:8},e.parameters);return{parameters:Object.assign(s,{width:Math.abs(s.width),height:Math.abs(null!==(i=s.height)&&void 0!==i?i:s.width),depth:Math.abs(null!==(r=s.depth)&&void 0!==r?r:s.width)})}}static build(e){let t,{width:n,height:i,depth:r,widthSegments:s,heightSegments:a,depthSegments:o,cornerRadius:l,cornerSegments:u}=e.parameters;return t=0===l?new Mx(n,i,r,s,a,o):new fN(n,i,r,s,a,o,l,u),Object.assign(t,{userData:d(d({},e),{},{type:"CubeGeometry"})})}},CylinderGeometry:uN,DodecahedronGeometry:class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){var n,i,r;let s=Object.assign({},null!==(n=null===t||void 0===t?void 0:t.parameters)&&void 0!==n?n:{width:100,detail:0,corner:0,cornerSides:4},e.parameters);return{parameters:Object.assign(s,{width:Math.abs(s.width),height:Math.abs(null!==(i=s.height)&&void 0!==i?i:s.width),depth:Math.abs(null!==(r=s.depth)&&void 0!==r?r:s.width)})}}static build(e){let{width:t,height:n,depth:i,detail:r,corner:s,cornerSides:a}=e.parameters,o=0===r&&0!==s?new gN(.5*t,s,a):new __(.5*t,r);return o.scale(1,n/t,i/t),Object.assign(o,{userData:d(d({},e),{},{type:"DodecahedronGeometry"})})}},EllipseGeometry:kj,HelixGeometry:class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){var n,i,r;let s=Object.assign({},null!==(n=null===t||void 0===t?void 0:t.parameters)&&void 0!==n?n:{width:100,revolutions:2,segments:40,pathRadius:10,pathType:0,pathSegments:30,cornerRadius:30,cornerSegments:4},e.parameters),a=Math.abs(s.width),o=Math.abs(null!==(i=s.height)&&void 0!==i?i:a),l=Math.abs(null!==(r=s.depth)&&void 0!==r?r:a),u=Math.abs(Math.min(a,l))/2;return{parameters:Object.assign(s,{width:a,height:o,depth:l,radius:u,segments:Math.round(s.segments),pathSegments:Math.round(s.pathSegments),cornerSegments:Math.round(s.cornerSegments)})}}static build(e){let{width:t,height:n,depth:i,radius:r,revolutions:s,segments:a,pathRadius:o,pathType:l,pathSegments:u,cornerRadius:c,cornerSegments:h}=e.parameters,p=new Vj(!1,t,n,i,r,s,a,o,l,u,c,h);return Object.assign(p,{userData:d(d({},e),{},{type:"HelixGeometry"})})}},IcosahedronGeometry:class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){var n,i,r;let s=Object.assign({},null!==(n=null===t||void 0===t?void 0:t.parameters)&&void 0!==n?n:{width:100,detail:0,corner:0,cornerSides:4},e.parameters);return{parameters:Object.assign(s,{width:Math.abs(s.width),height:Math.abs(null!==(i=s.height)&&void 0!==i?i:s.width),depth:Math.abs(null!==(r=s.depth)&&void 0!==r?r:s.width)})}}static build(e){let{width:t,height:n,depth:i,detail:r,corner:s,cornerSides:a}=e.parameters,o=0===r&&0!==s?new Hj(.5*t,s,a):new $_(.5*t,r);return o.scale(1,n/t,i/t),Object.assign(o,{userData:d(d({},e),{},{type:"IcosahedronGeometry"})})}},LatheGeometry:class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){var n,i,r,s,a;(null!==(n=null===(i=e.parameters)||void 0===i?void 0:i.points)&&void 0!==n?n:[]).forEach((e=>{Array.isArray(e)&&(e.x=e[0],e.y=e[1])}));let o=Object.assign({},null!==(r=null===t||void 0===t?void 0:t.parameters)&&void 0!==r?r:{width:100,segments:64,verticalSegments:64,points:[{x:0,y:-50,id:0},{x:50,y:-50,id:1},{x:50,y:50,id:2},{x:0,y:50,id:3}]},e.parameters);return{parameters:Object.assign(o,{width:Math.abs(o.width),height:Math.abs(null!==(s=o.height)&&void 0!==s?s:o.width),depth:Math.abs(null!==(a=o.depth)&&void 0!==a?a:o.width)})}}static build(e){let{points:t,segments:n,verticalSegments:i}=e.parameters,r=new S_;r.moveTo(t[0].x,t[0].y),r.bezierCurveTo(t[1].x,t[1].y,t[2].x,t[2].y,t[3].x,t[3].y);let s=new x_(r.extractPoints(i).shape,n);return s.rotateZ(Math.PI),Object.assign(s,{userData:d(d({},e),{},{type:"LatheGeometry"})})}},NonParametricGeometry:class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){var n,i;let r,s=null!==(n=null!==(i=e.geometry)&&void 0!==i?i:null===t||void 0===t?void 0:t.geometry)&&void 0!==n?n:(new dx).copy(new Mx(100,100,100));void 0===t?(s.computeBoundingBox(),s.boundingBox.getSize(uU),r={width:uU.x,height:uU.y,depth:uU.z,subdivisions:0}):r=t.parameters;let a=d(d({},r),e.parameters);return{parameters:{width:Math.abs(a.width),height:Math.abs(a.height),depth:Math.abs(a.depth),subdivisions:Math.abs(a.subdivisions)},geometry:s}}static build(e){var t;let{width:n,height:i,depth:r,subdivisions:s}=e.parameters,a=null!==(t=e.geometry)&&void 0!==t?t:(new dx).copy(new Mx(100,100,100)),o=a.userData.parameters;void 0===o?(a.computeBoundingBox(),a.boundingBox.getSize(uU)):uU.set(o.width,o.height,o.depth),(n!==uU.x||i!==uU.y||r!==uU.z)&&a.scale(0===uU.x?1:n/uU.x,0===uU.y?1:i/uU.y,0===uU.z?1:r/uU.z);let l=a.originalGeometry;try{s>0?(void 0===l||(null===o||void 0===o?void 0:o.subdivisions)!==s)&&(void 0===l&&(l=a),a=new lU(s).modify(l).toBufferGeometry()):(void 0!==l&&(a=l),l=void 0,void 0===a.getAttribute("normal")&&a.computeVertexNormals())}catch(u){void 0!==l&&(a=l),l=void 0,void 0===a.getAttribute("normal")&&a.computeVertexNormals()}return void 0!==l&&Object.assign(a,{originalGeometry:l}),delete e.geometry,Object.assign(a,{userData:d(d({},e),{},{type:"NonParametricGeometry"})})}static loadFromUrl(e,t,n){new QS(n).load(e,(e=>{let n=this.normalizeInputs({geometry:e});e.boundingBox.getSize(uU);let i=100/uU.x;Object.assign(n.parameters,{width:100,height:uU.y*i,depth:uU.z*i}),t(this.build(n))}))}},PolygonGeometry:cU,PyramidGeometry:class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){var n,i,r;let s=Object.assign({},null!==(n=null===t||void 0===t?void 0:t.parameters)&&void 0!==n?n:{width:100,radialSegments:4,heightSegments:1,cornerRadius:0,cornerSegments:8,openEnded:!1},e.parameters);return{parameters:Object.assign(s,{width:Math.abs(s.width),height:Math.abs(null!==(i=s.height)&&void 0!==i?i:s.width),depth:Math.abs(null!==(r=s.depth)&&void 0!==r?r:s.width)})}}static build(e){let{width:t,height:n,depth:i,radialSegments:r,heightSegments:s,openEnded:a,cornerRadius:o,cornerSegments:l}=e.parameters,u=new fU(.5*t,n,r,s,a,o,l);return u.scale(1,1,i/t),Object.assign(u,{userData:d(d({},e),{},{type:"PyramidGeometry"})})}},RectangleGeometry:mU,SphereGeometry:class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){var n,i,r;let s=Object.assign({},null!==(n=null===t||void 0===t?void 0:t.parameters)&&void 0!==n?n:{width:100,widthSegments:64,heightSegments:64,phiStart:0,phiLength:2*Math.PI,thetaStart:0,thetaLength:180},e.parameters);return s.thetaLength=ov.clamp(s.thetaLength,0,180),{parameters:Object.assign(s,{width:Math.abs(s.width),height:Math.abs(null!==(i=s.height)&&void 0!==i?i:s.width),depth:Math.abs(null!==(r=s.depth)&&void 0!==r?r:s.width)})}}static build(e){let t,{width:n=100,height:i=n,depth:r=n,widthSegments:s=64,heightSegments:a=64,phiStart:o,phiLength:l,thetaStart:u,thetaLength:c}=e.parameters;return 0===c?(t=new dx,t.setAttribute("position",new rx([],3))):t=new eS(.5*n,s,a,o,l,u,c*ov.DEG2RAD),t.scale(1,i/n,r/n),Object.assign(t,{userData:d(d({},e),{},{type:"SphereGeometry"})})}},PlaneGeometry:class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){var n,i;let r=Object.assign({},null!==(n=null===t||void 0===t?void 0:t.parameters)&&void 0!==n?n:{width:100,depth:0,widthSegments:8,heightSegments:8},e.parameters);return{parameters:Object.assign(r,{width:Math.abs(r.width),height:Math.abs(null!==(i=r.height)&&void 0!==i?i:r.width),depth:0})}}static build(e){let{width:t=100,height:n=t,widthSegments:i=8,heightSegments:r=8}=e.parameters,s=new Qx(t,n,i,r);return s.scale(1,1,1),Object.assign(s,{userData:d(d({},e),{},{type:"PlaneGeometry"})})}},BackdropGeometry:class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){var n,i,r;let s=Object.assign({},null!==(n=null===t||void 0===t?void 0:t.parameters)&&void 0!==n?n:{width:100,angle:90,cornerRadius:24,cornerSegments:8},e.parameters);return{parameters:Object.assign(s,{width:Math.abs(s.width),height:Math.abs(null!==(i=s.height)&&void 0!==i?i:s.width),depth:Math.abs(null!==(r=s.depth)&&void 0!==r?r:s.width)})}}static build(e){let{width:t,height:n,depth:i,angle:r,cornerRadius:s,cornerSegments:a}=e.parameters,o=new gU(t,n,i,r,s,a);return Object.assign(o,{userData:d(d({},e),{},{type:"BackdropGeometry"})})}},StarGeometry:vU,TextFrameGeometry:class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){var n,i,r;let s=Object.assign({},null!==(n=null===t||void 0===t?void 0:t.parameters)&&void 0!==n?n:{width:100,depth:0},e.parameters);return{parameters:Object.assign(s,{width:Math.abs(s.width),height:Math.abs(null!==(i=s.height)&&void 0!==i?i:s.width),depth:Math.abs(null!==(r=s.depth)&&void 0!==r?r:0)})}}static build(e){let{width:t,height:n}=e.parameters,i=new Qx(t,n);return Object.assign(i,{userData:d(d({},e),{},{type:"TextFrameGeometry"})})}},TorusGeometry:class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){var n,i,r;let s=Object.assign({},null!==(n=null===t||void 0===t?void 0:t.parameters)&&void 0!==n?n:{width:100,radialSegments:32,tubularSegments:64,arc:360,cornerRadius:30,cornerSegments:8},e.parameters),a=Math.abs(s.width),o=Math.abs(null!==(i=s.height)&&void 0!==i?i:s.width);s.shapeBlendNode&&(o=a);let l=Math.round(Math.abs(null!==(r=s.depth)&&void 0!==r?r:.25*s.width));return{parameters:Object.assign(s,{width:a,height:o,depth:l})}}static build(e){let{width:t,height:n,depth:i,radialSegments:r,tubularSegments:s,arc:a,cornerRadius:o,cornerSegments:l}=e.parameters,u=function(e,t,n,i,r,s,a,o,l,u,c){[t,n]=[n,t],a=t/2;let h=ov.clamp(r/360,0,1);if(0===h){let e=new dx;return e.setAttribute("position",new rx([],3)),e}return 1===h&&(u=0),new Vj(!0,e,t,n,i,h,s,a,o,l,u,c)}(t,n,i,.5*t,a,s,0,0,r,o,l);return u.scale(1,n/t,1),Object.assign(u,{userData:d(d({},e),{},{type:"TorusGeometry"})})}},TorusKnotGeometry:class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){var n,i,r,s;let a=Object.assign({},null!==(n=null===t||void 0===t?void 0:t.parameters)&&void 0!==n?n:{width:100,tubularSegments:64,radialSegments:32,p:2,q:3},e.parameters);return{parameters:Object.assign(a,{width:Math.abs(a.width),height:Math.abs(null!==(i=a.height)&&void 0!==i?i:a.width),depth:Math.abs(null!==(r=a.depth)&&void 0!==r?r:a.width),tube:null!==(s=a.tube)&&void 0!==s?s:.125*a.width})}}static build(e){let{width:t,tube:n,tubularSegments:i,radialSegments:r,p:s,q:a}=e.parameters,o=.5*t;o!==n&&(o-=n);let l=new nS(o,n,i,r,s,a);return Object.assign(l,{userData:d(d({},e),{},{type:"TorusKnotGeometry"})})}},TriangleGeometry:class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){var n,i,r;let s=Object.assign({},null!==(n=null===t||void 0===t?void 0:t.parameters)&&void 0!==n?n:{width:100,depth:0,spikes:5,cornerRadius:0,extrudeBevelSize:0,extrudeBevelSegments:1,isRect:!1},e.parameters);return{shape:e.shape&&e.shape instanceof JN?e.shape:new JN,parameters:Object.assign(s,{width:Math.abs(s.width),height:Math.abs(null!==(i=s.height)&&void 0!==i?i:s.width*(s.isRect?1:Math.sqrt(3)/2)),depth:Math.abs(null!==(r=s.depth)&&void 0!==r?r:0)})}}static build(e){let{width:t=100,height:n,cornerRadius:i,depth:r,extrudeBevelSize:s,extrudeBevelSegments:a,isRect:o}=e.parameters,l=e.shape,u=.5*t,c=.5*n;o?(l.addPoint(l.createPoint(-u,c)),l.addPoint(l.createPoint(u,-c)),l.addPoint(l.createPoint(-u,-c))):(l.addPoint(l.createPoint(0,c)),l.addPoint(l.createPoint(u,-c)),l.addPoint(l.createPoint(-u,-c))),l.isClosed=!0;for(let d=0,p=l.points.length;d<p;d++)l.points[d].roundness=i;l.roundness=i,l.update();let h=Oj.create({shape:l,parameters:{roundness:i,depth:r,extrudeBevelSize:s,extrudeBevelSegments:a}});return Object.assign(h,{userData:d(d({},e),{},{type:"TriangleGeometry"})})}},PathGeometry:class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){var n,i,r,s,a;let o=Object.assign({},null!==(n=null===t||void 0===t?void 0:t.parameters)&&void 0!==n?n:{width:100,height:100,depth:1,subdivisions:12,roundness:0,extrudeBevelSize:0,extrudeBevelSegments:3},e.parameters),l=Math.abs(o.width),u=Math.abs(null!==(i=o.height)&&void 0!==i?i:o.width),c=Math.abs(null!==(r=o.depth)&&void 0!==r?r:0),h=null!==(s=null===t||void 0===t?void 0:t.shapeData)&&void 0!==s?s:kj.create({parameters:SB}).userData.shape;return{path:null!==(a=e.path)&&void 0!==a?a:bB.defaultData(),parameters:Object.assign(o,{width:l,height:u,depth:c,extrusion:d(d({},MB),o.extrusion)}),shapeData:h}}static build(e){if(e.path.points.length>=2){let t=new RU(e);return Object.assign(t,{userData:d(d({},e),{},{type:"PathGeometry"})})}return Object.assign(new dx,{userData:d(d({},e),{},{type:"PathGeometry"})})}},VectorGeometry:Oj},SV=e=>_V[e.type].create(e);function EV(e){return null!==e&&"booleanOp"in e}var CV=class extends(lN(Cx)){constructor(){super(...arguments),this.booleanMeshSetAddress=-1,this.booleanWasTransformed=!1,this.booleanMatrixInvOld=new py}updateVisible(e){super.updateVisible(e),this.visible=!EV(this.parent)&&this.visible,EV(this.parent)&&this.parent.invalidateDownstreamBooleanData()}freeBooleanPointer(){-1!==this.booleanMeshSetAddress&&(pV.freeMeshSet(this.booleanMeshSetAddress),this.booleanMeshSetAddress=-1)}invalidateDownstreamBooleanData(){return arguments.length>0&&void 0!==arguments[0]&&arguments[0]?this.booleanWasTransformed=!0:this.freeBooleanPointer(),EV(this.parent)?this.parent.invalidateDownstreamBooleanData():this}invalidateUpstreamBooleanData(){this.freeBooleanPointer();for(let e of this.children)e instanceof CV&&(e.freeBooleanPointer(),EV(e)&&e.invalidateUpstreamBooleanData())}updateTransformState(e,t){let n=super.updateTransformState(e,t);return n&&EV(this.parent)&&this.invalidateDownstreamBooleanData(!0),n}onVariableUpdate(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];super.onVariableUpdate(e),EV(this.parent)&&this.invalidateDownstreamBooleanData(!0)}},AV=new jv;function MV(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.count,i=arguments.length>3?arguments[3]:void 0,r=arguments.length>4?arguments[4]:void 0,s=1/0,a=1/0,o=1/0,l=-1/0,u=-1/0,c=-1/0;for(let h=t;h<n;h++){let t=e.getX(h),n=e.getY(h),i=e.getZ(h);t<s&&(s=t),n<a&&(a=n),i<o&&(o=i),t>l&&(l=t),n>u&&(u=n),i>c&&(c=i)}AV.min.set(s,a,o),AV.max.set(l,u,c),AV.getCenter(i),AV.getSize(r).multiplyScalar(.5)}var TV=new dx,PV=new Jy,FV=class extends CV{constructor(e,t){super(TV,PV),this.super_Entity(e,t)}updateState(e,t){this.updateState_Entity(e,t)}updateEntityBoxSize(e,t){let n=this.geometry.getAttribute("position");void 0!==n?MV(n,this.geometry.drawRange.start,this.geometry.drawRange.count<1/0?this.geometry.drawRange.count:n.count,e,t):super.updateEntityBoxSize(e,t)}},OV=class{constructor(e){if(this.hashProperties=void 0,this.isNode=!0,this.shortcuts={},null===OV.uuidContext)throw new Error("plz startContext");OV.uuidContext===OV.globalContext?this.uuid="_gid"+OV.uuidContext.nodeContextUuid++:this.uuid="_uid"+OV.uuidContext.nodeContextUuid++,this.type=e,this.name=""}static startContext(e){null===this.uuidContext||this.uuidContext===OV.globalContext?this.uuidContext=e:console.error("Can't start context twice")}static endContext(e){this.uuidContext!==e&&console.error("Can't end context twice"),this.uuidContext=null}analyze(e,t){t=null!==t&&void 0!==t?t:{},e.analyzing=!0,this.build(e.addFlow(t.slot,t.cache,t.context),"v4"),e.clearVertexNodeCode(),e.clearFragmentNodeCode(),e.removeFlow(),e.analyzing=!1}analyzeAndFlow(e,t,n){return n=null!==n&&void 0!==n?n:{},this.analyze(e,n),this.flow(e,t,n)}flow(e,t,n){n=null!==n&&void 0!==n?n:{},e.addFlow(n.slot,n.cache,n.context);let i={result:this.build(e,t),code:e.clearNodeCode(),extra:e.context.extra};return e.removeFlow(),i}build(e,t,n){t=null!==t&&void 0!==t?t:this.getType(e,t);let i=e.getNodeData(null!==n&&void 0!==n?n:this);return e.analyzing&&this.appendDepsNode(e,i,t),-1===e.nodes.indexOf(this)&&e.nodes.push(this),void 0!==this.updateFrame&&-1===e.updaters.indexOf(this)&&e.updaters.push(this),this.generate(e,t,n)}updateFrame(e){}generateReadonly(e,t,n,i,r,s){return""}generate(e,t,n,i,r){return""}parse(e,t,n,i){}appendDepsNode(e,t,n){t.deps=(t.deps||0)+1;let i=e.getTypeLength(n);(i>(t.outputMax||0)||this.getType(e,n))&&(t.outputMax=i,t.output=n)}setName(e){this.name=e}getName(){return this.name}getType(e,t){return"sampler2D"===t||"samplerCube"===t?t:this.type}},IV=OV;IV.globalContext={nodeContextUuid:0},IV.uuidContext=OV.globalContext;var kV=class{constructor(e){e=null!==e&&void 0!==e?e:{},this.name=e.name,this.type=e.type,this.node=e.node,this.size=e.size,this.needsUpdate=e.needsUpdate}get value(){return this.node.value}set value(e){this.node.value=e}},BV=new class{constructor(){this.nodes={},this.keywords={}}add(e){this.nodes[e.name]=e}addKeyword(e,t,n){n=void 0===n||n,this.keywords[e]={callback:t,cache:n}}remove(e){delete this.nodes[e.name]}removeKeyword(e){delete this.keywords[e]}get(e){return this.nodes[e]}getKeyword(e,t){return this.keywords[e].callback(t)}getKeywordData(e){return this.keywords[e]}contains(e){return void 0!==this.nodes[e]}containsKeyword(e){return void 0!==this.keywords[e]}},RV=class extends IV{constructor(e,t){super(e),this.scope="",t=null!==t&&void 0!==t?t:{},this.shared=void 0===t.shared||t.shared,this.unique=void 0!==t.unique&&t.unique}build(e,t,n,i){if(t=null!==t&&void 0!==t?t:this.getType(e),this.getShared(e,t)){let r=this.getUnique(e,t);r&&void 0===this.uuid&&(this.uuid=ov.generateUUID()),n=e.getUUID(null!==n&&void 0!==n?n:this.getUUID(),!r);let s=e.getNodeData(n),a=s.output||this.getType(e);if(e.analyzing)return(s.deps||0)>0||this.getLabel()?(this.appendDepsNode(e,s,t),this.generate(e,t,n)):super.build(e,t,n);if(r)return s.name=s.name||super.build(e,t,n),s.name;if(!this.getLabel()&&(!this.getShared(e,a)||e.context.ignoreCache||1===s.deps))return super.build(e,t,n);n=this.getUUID(!1);let o=this.getTemp(e,n);if(o)return e.format(o,a,t);{o=super.generate(e,t,n,s.output,i);let r=this.generate(e,a,n);return e.addNodeCode(o+" = "+r+";"),e.format(o,a,t)}}return super.build(e,t,n)}getShared(e,t){return"sampler2D"!==t&&"samplerCube"!==t&&this.shared}getUnique(e,t){return this.unique}setLabel(e){return this.label=e,this}getLabel(){return this.label}getUUID(e){let t=this.uuid;return"string"==typeof this.scope&&(t=this.scope+"-"+t),t}getTemp(e,t){t=t||this.uuid;let n=e.getVars()[t];return n?n.name:void 0}generate(e,t,n,i,r){return this.getShared(e,t)||console.error("TempNode is not shared"),n=null!==n&&void 0!==n?n:this.uuid,e.getTempVar(n,null!==i&&void 0!==i?i:this.getType(e),r,this.getLabel()).name}},LV=class extends RV{constructor(e,t){(t=null!==t&&void 0!==t?t:{}).shared=void 0!==t.shared&&t.shared,super(e,t),this.readonly=!1}setReadonly(e){return this.readonly=e,this.hashProperties=this.readonly?["value"]:void 0,this}getReadonly(){return this.readonly}generate(e,t,n,i,r,s){n=e.getUUID(null!==n&&void 0!==n?n:this.getUUID()),i=null!==i&&void 0!==i?i:this.getType(e);let a=e.getNodeData(n);return this.getReadonly()&&void 0!==this.generateReadonly?this.generateReadonly(e,t,n,i,r,s):e.isShader("vertex")?(a.vertex||(a.vertex=e.createVertexUniform(i,this,r,s,this.getLabel())),e.format(a.vertex.name,i,t)):(a.fragment||(a.fragment=e.createFragmentUniform(i,this,r,s,this.getLabel())),e.format(a.fragment.name,i,t))}},zV=class extends LV{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1?arguments[1]:void 0;super("v2"),this.nodeType="Vector2",this.value=e instanceof lv?e:new lv(e,t)}get x(){return this.value.x}set x(e){this.value.x=e}get y(){return this.value.y}set y(e){this.value.y=e}generateReadonly(e,t,n,i,r,s){return e.format("vec2("+this.value.x+", "+this.value.y+")",i,t)}},NV=class extends LV{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0;super("v3"),this.nodeType="Vector3",this.value=e instanceof Lv?e:new Lv(e,t,n)}get x(){return this.value.x}set x(e){this.value.x=e}get y(){return this.value.y}set y(e){this.value.y=e}get z(){return this.value.z}set z(e){this.value.z=e}generateReadonly(e,t,n,i,r,s){return e.format("vec3("+this.value.x+", "+this.value.y+", "+this.value.z+")",i,t)}},jV=class extends Ev{constructor(e,t,n,i){super(e,t,n),this.isColorA=!0,this.a=i}setRGBA(e,t,n,i){super.setRGB(e,t,n),this.a=i}copy(e){return super.copy(e),this.a="a"in e?e.a:1,this}clone(){return new this.constructor(this.r,this.g,this.b,this.a)}equals(e){return super.equals(e)&&this.a===e.a}setStyle(e){let t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"srgb";if("transparent"===e)return this.setRGBA(0,0,0,0),this;if(t=/^((?:rgb|hsl)a?)\(([^)]*)\)/.exec(e)){let i,r=t[1],s=t[2];switch(r){case"rgb":case"rgba":if(i=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(s))return this.a="rgba"===r?parseFloat(i[4]):1,super.setStyle(e,n);break;case"hsl":case"hsla":if(i=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)%\s*,\s*(\d*\.?\d+)%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(s))return this.a="hsla"===r?parseFloat(i[4]):1,super.setStyle(e,n)}}return super.setStyle(e,n)}get x(){return this.r}get y(){return this.g}get z(){return this.b}get w(){return this.a}set x(e){this.r=e}set y(e){this.g=e}set z(e){this.b=e}set w(e){this.a=e}},UV=class extends LV{constructor(e){super("v4"),this.nodeType="Vector4",this.value=e instanceof jV?e:new jV(e.r,e.g,e.b,e.a)}generateReadonly(e,t,n,i,r,s){return e.format("vec4("+this.value.r+", "+this.value.g+", "+this.value.b+", "+this.value.a+")",i,t)}},VV=/^\s*([a-z_0-9]+)\s([a-z_0-9]+)\s*\((.*?)\)/i,HV=/[a-z_0-9]+/gi,WV=class extends RV{constructor(e,t,n,i,r){super(r),this.src="",this.nodeType="Function",this.useKeywords=!0,this.includes=[],this.extensions={},this.keywords={},this.isMethod=void 0===r,this.isInterface=!1,this.parse(e,t,n,i)}getShared(e,t){return!this.isMethod}getType(e){return e.getTypeByFormat(this.type)}getInputByName(e){if(this.inputs){let t=this.inputs.length;for(;t--;)if(this.inputs[t].name===e)return this.inputs[t]}}getIncludeByName(e){if(this.includes){let t=this.includes.length;for(;t--;)if(this.includes[t].name===e)return this.includes[t]}}generate(e,t,n,i,r){let s,a=0,o=this.src;if(this.includes)for(let u=0;u<this.includes.length;u++)e.include(this.includes[u],this);for(let u in this.extensions)e.extensions[u]=!0;let l=[];for(;s=HV.exec(this.src);)l.push(s);for(let u=0;u<l.length;u++){let t=l[u],n=t[0],i=!this.isMethod||!this.getInputByName(n),r=n;if(this.keywords[n]||this.useKeywords&&i&&BV.containsKeyword(n)){let t=this.keywords[n];if(!t){let i=BV.getKeywordData(n);i.cache&&(t=e.keywords[n]),t=t||BV.getKeyword(n,e),i.cache&&(e.keywords[n]=t)}r=t.build(e)}n!==r&&"."!==o[t.index+a-1]&&(o=o.substring(0,t.index+a)+r+o.substring(t.index+n.length+a),a+=r.length-n.length),void 0===this.getIncludeByName(r)&&BV.contains(r)&&e.include(BV.get(r))}return"source"===t?o:this.isMethod?(this.isInterface||e.include(this,void 0,o),this.name):e.format("( "+o+" )",this.getType(e),t)}parse(e,t,n,i){if(this.src=e||"",this.includes=null!==t&&void 0!==t?t:[],this.extensions=null!==n&&void 0!==n?n:{},this.keywords=null!==i&&void 0!==i?i:{},this.isMethod){let e=VV.exec(this.src);if(this.inputs=[],e&&4==e.length){this.type=e[1],this.name=e[2];let t=e[3].match(HV);if(t){let e=0;for(;e<t.length;){let n,i=t[e++];"in"===i||"out"===i||"inout"===i?n=t[e++]:(n=i,i="");let r=t[e++];this.inputs.push({name:r,type:n,qualifier:i})}}this.isInterface=-1===this.src.indexOf("{")}else this.type="",this.name=""}}},GV=/^([a-z_0-9]+)\s([a-z_0-9]+)\s?\=?\s?(.*?)(\;|$)/i,qV=class extends RV{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0;super(),this.src="",this.useDefine=!1,this.nodeType="Const",this.parse(e||qV.PI,void 0,void 0,void 0,t)}getType(e){return e.getTypeByFormat(this.type)}parse(e,t,n,i,r){this.src=e||"";let s,a,o="",l=GV.exec(e);this.useDefine=null!==r&&void 0!==r?r:"#"===this.src.charAt(0),l&&l.length>1?(a=l[1],s=l[2],o=l[3]):(s=this.src,a="f"),this.name=s,this.type=a,this.value=o}build(e,t){if("source"===t){if(this.value)return this.useDefine?"#define "+this.name+" "+this.value:"const "+this.type+" "+this.name+" = "+this.value+";";if(this.useDefine)return this.src}return e.include(this),e.format(this.name,this.getType(e),t)}generate(e,t,n,i,r){return e.format(this.name,this.getType(e),t)}},YV=qV;YV.PI="PI",YV.PI2="PI2",YV.RECIPROCAL_PI="RECIPROCAL_PI",YV.RECIPROCAL_PI2="RECIPROCAL_PI2",YV.LOG2="LOG2",YV.EPSILON="EPSILON";var XV=new RegExp("^structs*([a-z_0-9]+)s*{s*((.|\n)*?)}","gim"),QV=new RegExp("s*(w*?)s*(w*?)(=|;)","gim"),KV=class extends RV{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";super(),this.inputs=[],this.src="",this.nodeType="Struct",this.parse(e)}getType(e){return e.getTypeByFormat(this.name)}getInputByName(e){let t=this.inputs.length;for(;t--;)if(this.inputs[t].name===e)return this.inputs[t]}generate(e,t,n,i,r){return"source"===t?this.src+";":e.format("( "+this.src+" )",this.getType(e),t)}parse(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";this.src=e,this.inputs=[];let t=XV.exec(e);if(t){let e,n=t[2];for(;e=QV.exec(n);)this.inputs.push({type:e[1],name:e[2]});this.name=t[1]}else this.name="";this.type=this.name}},ZV=class extends RV{constructor(e){super("v2",{shared:!1}),this.nodeType="UV",this.index=null!==e&&void 0!==e?e:0}generate(e,t){e.requires.uv[this.index]=!0;let n=this.index>0?this.index+1:"",i=e.isShader("vertex")?"uv"+n:"vUv"+n;return e.format(i,this.getType(e),t)}};BV.addKeyword("uv",(function(){return new ZV})),BV.addKeyword("uv2",(function(){return new ZV(1)}));var JV=class extends RV{constructor(e,t){super("v4"),this.nodeType="ColorSpace",this.input=e,this.method=null!==t&&void 0!==t?t:JV.LINEAR_TO_LINEAR,this.hashProperties=["method"]}static getEncodingComponents(e){switch(e){case zg:return["Linear"];case Ng:return["sRGB"];default:return[]}}generate(e,t){var n;let i=this.input.build(e,"v4"),r=this.getType(e),s=JV.Nodes[this.method],a=e.include(s);if(a===JV.LINEAR_TO_LINEAR)return e.format(i,r,t);if(2===(null===(n=s.inputs)||void 0===n?void 0:n.length)){let n=this.factor.build(e,"f");return e.format(a+"( "+i+", "+n+" )",r,t)}return e.format(a+"( "+i+" )",r,t)}fromEncoding(e){let t=JV.getEncodingComponents(e);this.method="LinearTo"+t[0],this.factor=t[1]}fromDecoding(e){let t=JV.getEncodingComponents(e);this.method=t[0]+"ToLinear",this.factor=t[1]}},$V=JV;$V.Nodes={LinearToLinear:new WV(["vec4 LinearToLinear( in vec4 value ) {","\treturn value;","}"].join("\n")),sRGBToLinear:new WV(["vec4 sRGBToLinear( in vec4 value ) {","\treturn vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.w );","}"].join("\n")),LinearTosRGB:new WV(["vec4 LinearTosRGB( in vec4 value ) {","\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.w );","}"].join("\n"))},$V.LINEAR_TO_LINEAR="LinearToLinear",$V.SRGB_TO_LINEAR="sRGBToLinear",$V.LINEAR_TO_SRGB="LinearTosRGB";var eH=class extends WV{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",arguments.length>4?arguments[4]:void 0,arguments.length>3?arguments[3]:void 0,arguments.length>2?arguments[2]:void 0,arguments.length>1?arguments[1]:void 0),this.nodeType="Expression"}},tH=class extends LV{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Fv,t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0;super("v4",{shared:!0}),this.nodeType="Texture",this.value=e,this.uv=null!==t&&void 0!==t?t:new ZV,this.bias=n,this.project=void 0!==i&&i}getTexture(e,t){return super.generate(e,t,this.value.uuid,"t")}generate(e,t){var n;if("sampler2D"===t)return this.getTexture(e,t);let i,r,s=this.getTexture(e,t),a=this.uv.build(e,this.project?"v4":"v2"),o=this.bias?this.bias.build(e,"f"):void 0;void 0===o&&e.context.bias&&(o=e.context.bias.setTexture(this).build(e,"f")),i=this.project?"texture2DProj":o?"tex2DBias":"tex2D",r=o?i+"( "+s+", "+a+", "+o+" )":i+"( "+s+", "+a+" )";let l={include:e.isShader("vertex"),ignoreCache:!0},u=this.getType(e);return e.addContext(l),this.colorSpace=null!==(n=this.colorSpace)&&void 0!==n?n:new $V(new eH("",u)),this.colorSpace.fromDecoding(e.getTextureEncodingFromMap(this.value)),this.colorSpace.input.parse(r),r=this.colorSpace.build(e,u),e.removeContext(),e.format(r,u,t)}},nH=class extends LV{constructor(e){super("f"),this.nodeType="Float",this.value=null!==e&&void 0!==e?e:0}generateReadonly(e,t,n,i,r,s){return e.format(this.value+(this.value%1?"":".0"),i,t)}},iH=class extends RV{constructor(e,t){super(),this.inputs=[],this.nodeType="FunctionCall",this.value=e,this.inputs=null!==t&&void 0!==t?t:[]}getFunction(){return this.value}getType(e){return this.value.getType(e)}generate(e,t,n,i,r){i=this.getType(e);let s=this.value,a=s.build(e,t)+"( ",o=[];if(s.inputs){for(let t=0;t<s.inputs.length;t++){let n=s.inputs[t],i=this.inputs[t]||this.inputs[n.name];o.push(i.build(e,e.getTypeByFormat(n.type)))}a+=o.join(", ")+" )"}return e.format(a,i,t)}},rH=class extends RV{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:rH.ADD;super(),this.nodeType="Operator",this.type=e.type,this.a=e,this.b=t,this.op=n}getType(e){let t=this.a.getType(e),n=this.b.getType(e);return e.isTypeMatrix(t)?"v4":e.getTypeLength(n)>e.getTypeLength(t)?n:t}generate(e,t){let n=this.getType(e);this.type=n;let i=this.a.build(e,n),r=this.b.build(e,n);return e.format("( "+i+" "+this.op+" "+r+" )",n,t)}},sH=rH;sH.ADD="+",sH.SUB="-",sH.MUL="*",sH.DIV="/";var aH=class extends RV{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:aH.ABS,n=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0;super(),this.nodeType="Math",this.a=e,"string"!=typeof t?this.b=t:i=t,"string"!=typeof n?this.c=n:i=n,this.method=i,this.hashProperties=["method"]}getNumInputs(e){switch(this.method){case aH.MIX:case aH.CLAMP:case aH.REFRACT:case aH.SMOOTHSTEP:case aH.FACEFORWARD:return 3;case aH.MIN:case aH.MAX:case aH.MOD:case aH.STEP:case aH.REFLECT:case aH.DISTANCE:case aH.DOT:case aH.CROSS:case aH.POW:return 2;default:return 1}}getInputType(e){let t=e.getTypeLength(this.a.getType(e)),n=this.b?e.getTypeLength(this.b.getType(e)):0,i=this.c?e.getTypeLength(this.c.getType(e)):0;return t>n&&t>i?this.a.getType(e):n>i?this.b.getType(e):this.c.getType(e)}getType(e){switch(this.method){case aH.LENGTH:case aH.DISTANCE:case aH.DOT:return"f";case aH.CROSS:return"v3"}return this.getInputType(e)}generate(e,t){let n,i,r,s=this.a?e.getTypeLength(this.a.getType(e)):0,a=this.b?e.getTypeLength(this.b.getType(e)):0,o=this.c?e.getTypeLength(this.c.getType(e)):0,l=this.getInputType(e),u=this.getType(e);switch(this.type=u,this.method){case aH.NEGATE:return e.format("( -"+this.a.build(e,l)+" )",l,t);case aH.INVERT:return e.format("( 1.0 - "+this.a.build(e,l)+" )",l,t);case aH.CROSS:n=this.a.build(e,"v3"),i=this.b.build(e,"v3");break;case aH.STEP:n=this.a.build(e,1===s?"f":l),i=this.b.build(e,l);break;case aH.MIN:case aH.MAX:case aH.MOD:n=this.a.build(e,l),i=this.b.build(e,1===a?"f":l);break;case aH.REFRACT:n=this.a.build(e,l),i=this.b.build(e,l),r=this.c.build(e,"f");break;case aH.MIX:n=this.a.build(e,l),i=this.b.build(e,l),r=this.c.build(e,1===o?"f":l);break;default:n=this.a.build(e,l),this.b&&(i=this.b.build(e,l)),this.c&&(r=this.c.build(e,l))}let c=[];c.push(n),i&&c.push(i),r&&c.push(r);let h=this.getNumInputs(e);if(c.length!==h)throw Error('Arguments not match used in "'.concat(this.method,'". Require ').concat(h,", currently ").concat(c.length,"."));return e.format(this.method+"( "+c.join(", ")+" )",u,t)}},oH=aH;oH.RAD="radians",oH.DEG="degrees",oH.EXP="exp",oH.EXP2="exp2",oH.LOG="log",oH.LOG2="log2",oH.SQRT="sqrt",oH.INV_SQRT="inversesqrt",oH.FLOOR="floor",oH.CEIL="ceil",oH.NORMALIZE="normalize",oH.FRACT="fract",oH.SATURATE="saturate",oH.SIN="sin",oH.COS="cos",oH.TAN="tan",oH.ASIN="asin",oH.ACOS="acos",oH.ARCTAN="atan",oH.ABS="abs",oH.SIGN="sign",oH.LENGTH="length",oH.NEGATE="negate",oH.INVERT="invert",oH.MIN="min",oH.MAX="max",oH.MOD="mod",oH.STEP="step",oH.REFLECT="reflect",oH.DISTANCE="distance",oH.DOT="dot",oH.CROSS="cross",oH.POW="pow",oH.MIX="mix",oH.CLAMP="clamp",oH.REFRACT="refract",oH.SMOOTHSTEP="smoothstep",oH.FACEFORWARD="faceforward";var lH=class extends RV{constructor(e,t,n){super("v4"),this.nodeType="TextureCubeUV",this.value=e,this.uv=t,this.bias=n}bilinearCubeUV(e,t,n,i){var r,s,a,o;let l=new iH(lH.Nodes.bilinearCubeUV,[t,n,i]);this.colorSpaceTL=null!==(r=this.colorSpaceTL)&&void 0!==r?r:new $V(new eH("","v4")),this.colorSpaceTL.fromDecoding(e.getTextureEncodingFromMap(this.value.value)),this.colorSpaceTL.input.parse(l.build(e)+".tl"),this.colorSpaceTR=null!==(s=this.colorSpaceTR)&&void 0!==s?s:new $V(new eH("","v4")),this.colorSpaceTR.fromDecoding(e.getTextureEncodingFromMap(this.value.value)),this.colorSpaceTR.input.parse(l.build(e)+".tr"),this.colorSpaceBL=null!==(a=this.colorSpaceBL)&&void 0!==a?a:new $V(new eH("","v4")),this.colorSpaceBL.fromDecoding(e.getTextureEncodingFromMap(this.value.value)),this.colorSpaceBL.input.parse(l.build(e)+".bl"),this.colorSpaceBR=null!==(o=this.colorSpaceBR)&&void 0!==o?o:new $V(new eH("","v4")),this.colorSpaceBR.fromDecoding(e.getTextureEncodingFromMap(this.value.value)),this.colorSpaceBR.input.parse(l.build(e)+".br");let u={include:e.isShader("vertex"),ignoreCache:!0};e.addContext(u),this.colorSpaceTLExp=new eH(this.colorSpaceTL.build(e,"v4"),"v4"),this.colorSpaceTRExp=new eH(this.colorSpaceTR.build(e,"v4"),"v4"),this.colorSpaceBLExp=new eH(this.colorSpaceBL.build(e,"v4"),"v4"),this.colorSpaceBRExp=new eH(this.colorSpaceBR.build(e,"v4"),"v4"),e.removeContext();let c=new eH("mix( mix( cubeUV_TL, cubeUV_TR, cubeUV.f.x ), mix( cubeUV_BL, cubeUV_BR, cubeUV.f.x ), cubeUV.f.y )","v4");return c.keywords.cubeUV_TL=this.colorSpaceTLExp,c.keywords.cubeUV_TR=this.colorSpaceTRExp,c.keywords.cubeUV_BL=this.colorSpaceBLExp,c.keywords.cubeUV_BR=this.colorSpaceBRExp,c.keywords.cubeUV=l,c}generate(e,t){if(e.isShader("fragment")){let n=this.uv,i=this.bias||e.context.roughness,r=new iH(lH.Nodes.roughnessToMip,[i]),s=new oH(r,lH.Nodes.m0,lH.Nodes.cubeUV_maxMipLevel,oH.CLAMP),a=new oH(s,oH.FLOOR),o=new oH(s,oH.FRACT),l=this.bilinearCubeUV(e,this.value,n,a),u=this.bilinearCubeUV(e,this.value,n,new sH(a,new nH(1).setReadonly(!0),sH.ADD)),c=new oH(l,u,o,oH.MIX);return e.format(c.build(e),"v4",t)}return console.warn("TextureCubeUVNode is not compatible with "+e.shader+" shader."),e.format("vec4( 0.0 )",this.getType(e),t)}},uH=lH;uH.Nodes=function(){let e=new KV("struct TextureCubeUVData {\n\t\t\tvec4 tl;\n\t\t\tvec4 tr;\n\t\t\tvec4 br;\n\t\t\tvec4 bl;\n\t\t\tvec2 f;\n\t\t}"),t=new YV("float cubeUV_maxMipLevel 8.0",!0),n=new YV("float cubeUV_minMipLevel 4.0",!0),i=new YV("float cubeUV_maxTileSize 256.0",!0),r=new YV("float cubeUV_minTileSize 16.0",!0),s=new WV("float getFace(vec3 direction) {\n\t\t\t\tvec3 absDirection = abs(direction);\n\t\t\t\tfloat face = -1.0;\n\t\t\t\tif (absDirection.x > absDirection.z) {\n\t\t\t\t\tif (absDirection.x > absDirection.y)\n\t\t\t\t\t\tface = direction.x > 0.0 ? 0.0 : 3.0;\n\t\t\t\t\telse\n\t\t\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t\t\t} else {\n\t\t\t\t\tif (absDirection.z > absDirection.y)\n\t\t\t\t\t\tface = direction.z > 0.0 ? 2.0 : 5.0;\n\t\t\t\t\telse\n\t\t\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t\t\t}\n\t\t\t\treturn face;\n\t\t}");s.useKeywords=!1;let a=new WV("vec2 getUV(vec3 direction, float face) {\n\t\t\t\tvec2 uv;\n\t\t\t\tif (face == 0.0) {\n\t\t\t\t\tuv = vec2(direction.z, direction.y) / abs(direction.x); // pos x\n\t\t\t\t} else if (face == 1.0) {\n\t\t\t\t\tuv = vec2(-direction.x, -direction.z) / abs(direction.y); // pos y\n\t\t\t\t} else if (face == 2.0) {\n\t\t\t\t\tuv = vec2(-direction.x, direction.y) / abs(direction.z); // pos z\n\t\t\t\t} else if (face == 3.0) {\n\t\t\t\t\tuv = vec2(-direction.z, direction.y) / abs(direction.x); // neg x\n\t\t\t\t} else if (face == 4.0) {\n\t\t\t\t\tuv = vec2(-direction.x, direction.z) / abs(direction.y); // neg y\n\t\t\t\t} else {\n\t\t\t\t\tuv = vec2(direction.x, direction.y) / abs(direction.z); // neg z\n\t\t\t\t}\n\t\t\t\treturn 0.5 * (uv + 1.0);\n\t\t}");a.useKeywords=!1;let o=new WV("TextureCubeUVData bilinearCubeUV(sampler2D envMap, vec3 direction, float mipInt) {\n\t\t\tfloat face = getFace(direction);\n\t\t\tfloat filterInt = max(cubeUV_minMipLevel - mipInt, 0.0);\n\t\t\tmipInt = max(mipInt, cubeUV_minMipLevel);\n\t\t\tfloat faceSize = exp2(mipInt);\n\t\t\tfloat texelSize = 1.0 / (3.0 * cubeUV_maxTileSize);\n\t\t\tvec2 uv = getUV(direction, face) * (faceSize - 1.0);\n\t\t\tvec2 f = fract(uv);\n\t\t\tuv += 0.5 - f;\n\t\t\tif (face > 2.0) {\n\t\t\t\tuv.y += faceSize;\n\t\t\t\tface -= 3.0;\n\t\t\t}\n\t\t\tuv.x += face * faceSize;\n\t\t\tif(mipInt < cubeUV_maxMipLevel){\n\t\t\t\tuv.y += 2.0 * cubeUV_maxTileSize;\n\t\t\t}\n\t\t\tuv.y += filterInt * 2.0 * cubeUV_minTileSize;\n\t\t\tuv.x += 3.0 * max(0.0, cubeUV_maxTileSize - 2.0 * faceSize);\n\t\t\tuv *= texelSize;\n\t\t\tvec4 tl = texture2D(envMap, uv);\n\t\t\tuv.x += texelSize;\n\t\t\tvec4 tr = texture2D(envMap, uv);\n\t\t\tuv.y += texelSize;\n\t\t\tvec4 br = texture2D(envMap, uv);\n\t\t\tuv.x -= texelSize;\n\t\t\tvec4 bl = texture2D(envMap, uv);\n\t\t\treturn TextureCubeUVData( tl, tr, br, bl, f );\n\t\t}",[e,s,a,t,n,i,r]);o.useKeywords=!1;let l=new YV("float r0 1.0",!0),u=new YV("float v0 0.339",!0),c=new YV("float m0 -2.0",!0),h=new YV("float r1 0.8",!0),d=new YV("float v1 0.276",!0),p=new YV("float m1 -1.0",!0),f=new YV("float r4 0.4",!0),m=new YV("float v4 0.046",!0),g=new YV("float m4 2.0",!0),v=new YV("float r5 0.305",!0),y=new YV("float v5 0.016",!0),x=new YV("float m5 3.0",!0),b=new YV("float r6 0.21",!0),w=new YV("float v6 0.0038",!0),D=new YV("float m6 4.0",!0);return{bilinearCubeUV:o,roughnessToMip:new WV("float roughnessToMip(float roughness) {\n\t\t\tfloat mip = 0.0;\n\t\t\tif (roughness >= r1) {\n\t\t\t\tmip = (r0 - roughness) * (m1 - m0) / (r0 - r1) + m0;\n\t\t\t} else if (roughness >= r4) {\n\t\t\t\tmip = (r1 - roughness) * (m4 - m1) / (r1 - r4) + m1;\n\t\t\t} else if (roughness >= r5) {\n\t\t\t\tmip = (r4 - roughness) * (m5 - m4) / (r4 - r5) + m4;\n\t\t\t} else if (roughness >= r6) {\n\t\t\t\tmip = (r5 - roughness) * (m6 - m5) / (r5 - r6) + m5;\n\t\t\t} else {\n\t\t\t\tmip = -2.0 * log2(1.16 * roughness);// 1.16 = 1.79^0.25\n\t\t\t}\n\t\t\treturn mip;\n\t\t}",[l,u,c,h,d,p,f,m,g,v,y,x,b,w,D]),m0:c,cubeUV_maxMipLevel:t}}();var cH=class extends RV{constructor(e){super("v3"),this.nodeType="Normal",this.scope=null!==e&&void 0!==e?e:cH.VIEW}getShared(){return this.scope===cH.WORLD}build(e,t,n,i){let r=e.context[this.scope+"Normal"];return r?r.build(e,t,n,i):super.build(e,t,n)}generate(e,t,n,i,r){let s;switch(this.scope){case cH.VIEW:s=e.isShader("vertex")?"transformedNormal":"geometryNormal";break;case cH.LOCAL:e.isShader("vertex")?s="objectNormal":(e.requires.normal=!0,s="vObjectNormal");break;case cH.WORLD:e.isShader("vertex")?s="inverseTransformDirection( transformedNormal, viewMatrix ).xyz":(e.requires.worldNormal=!0,s="vWNormal")}return e.format(s,this.getType(e),t)}},hH=cH;hH.LOCAL="local",hH.WORLD="world",hH.VIEW="view",hH.NORMAL="normal",BV.addKeyword("viewNormal",(function(){return new hH(hH.VIEW)})),BV.addKeyword("localNormal",(function(){return new hH(hH.NORMAL)})),BV.addKeyword("worldNormal",(function(){return new hH(hH.WORLD)}));var dH=class extends RV{constructor(e){super("v3"),this.nodeType="Position",this.scope=null!==e&&void 0!==e?e:dH.LOCAL}getType(){return this.scope===dH.PROJECTION?"v4":this.type}getShader(){switch(this.scope){case dH.LOCAL:case dH.WORLD:return!1}return!0}generate(e,t,n,i,r){let s;switch(this.scope){case dH.LOCAL:e.isShader("vertex")?s="transformed":(e.requires.position=!0,s="vPosition");break;case dH.WORLD:if(e.isShader("vertex"))return"( modelMatrix * vec4( transformed, 1.0 ) ).xyz";e.requires.worldPosition=!0,s="vWPosition";break;case dH.VIEW:s=e.isShader("vertex")?"-mvPosition.xyz":"vViewPosition";break;case dH.PROJECTION:s=e.isShader("vertex")?"( projectionMatrix * modelViewMatrix * vec4( position, 1.0 ) )":"vec4( 0.0 )"}return e.format(s,this.getType(),t)}},pH=dH;pH.LOCAL="local",pH.WORLD="world",pH.VIEW="view",pH.PROJECTION="projection",BV.addKeyword("position",(function(){return new pH})),BV.addKeyword("worldPosition",(function(){return new pH(pH.WORLD)})),BV.addKeyword("viewPosition",(function(){return new pH(pH.VIEW)}));var fH=class extends RV{constructor(e){super("v3"),this.nodeType="Reflect",this.scope=null!==e&&void 0!==e?e:fH.CUBE}getUnique(e){return!e.context.viewNormal}getType(){return this.scope===fH.SPHERE?"v2":this.type}generate(e,t){let n=this.getUnique(e);if(e.isShader("fragment")){let i;switch(this.scope){case fH.VECTOR:{let t=new hH(hH.VIEW),r=e.context.roughness,s=t.build(e,"v3"),a=new pH(pH.VIEW).build(e,"v3"),o=r?r.build(e,"f"):void 0,l="reflect( -normalize( ".concat(a," ), ").concat(s," )");o&&(l="normalize( mix( ".concat(l,", ").concat(s,", ").concat(o," * ").concat(o," ) )"));let u="inverseTransformDirection( ".concat(l,", viewMatrix )");n?(e.addNodeCode("vec3 reflectVec = ".concat(u,";")),i="reflectVec"):i=u;break}case fH.CUBE:{let t=new fH(fH.VECTOR).build(e,"v3"),r="vec3( -"+t+".x, "+t+".yz )";n?(e.addNodeCode("vec3 reflectCubeVec = ".concat(r,";")),i="reflectCubeVec"):i=r;break}case fH.SPHERE:{let t="normalize( ( viewMatrix * vec4( "+new fH(fH.VECTOR).build(e,"v3")+", 0.0 ) ).xyz + vec3( 0.0, 0.0, 1.0 ) ).xy * 0.5 + 0.5";n?(e.addNodeCode("vec2 reflectSphereVec = ".concat(t,";")),i="reflectSphereVec"):i=t;break}}return e.format(i,this.getType(),t)}return console.warn("ReflectNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.type,t)}},mH=fH;mH.CUBE="cube",mH.SPHERE="sphere",mH.VECTOR="vector";var gH=class extends RV{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new tH,t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0;super("v4"),this.nodeType="TextureCube",this.value=e,this.radianceNode=new uH(this.value,null!==t&&void 0!==t?t:new mH(mH.VECTOR),n),this.irradianceNode=new uH(this.value,new hH(hH.WORLD),new nH(1).setReadonly(!0))}generate(e,t){return e.isShader("fragment")?(e.require("irradiance"),e.context.bias&&e.context.bias.setTexture(this.value),("irradiance"===e.slot?this.irradianceNode:this.radianceNode).build(e,t)):(console.warn("TextureCubeNode is not compatible with "+e.shader+" shader."),e.format("vec4( 0.0 )",this.getType(e),t))}},vH=class extends LV{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new zx,t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0;super("v4",{shared:!0}),this.nodeType="CubeTexture",this.value=e,this.uv=null!==t&&void 0!==t?t:new mH,this.bias=n}getTexture(e,t){return super.generate(e,t,this.value.uuid,"tc")}generate(e,t){var n,i;if("samplerCube"===t)return this.getTexture(e,t);let r,s=this.getTexture(e,t),a=null===(n=this.uv)||void 0===n?void 0:n.build(e,"v3"),o=this.bias?this.bias.build(e,"f"):void 0;void 0===o&&e.context.bias&&(o=e.context.bias.setTexture(this).build(e,"f")),r=o?"texCubeBias( "+s+", "+a+", "+o+" )":"texCube( "+s+", "+a+" )";let l={include:e.isShader("vertex"),ignoreCache:!0},u=this.getType(e);return e.addContext(l),this.colorSpace=null!==(i=this.colorSpace)&&void 0!==i?i:new $V(new eH("",u)),this.colorSpace.fromDecoding(e.getTextureEncodingFromMap(this.value)),this.colorSpace.input.parse(r),r=this.colorSpace.build(e,u),e.removeContext(),e.format(r,u,t)}},yH=["x","y","z","w"],xH=["float","vec2","vec3","vec4"],bH={float:"f",vec2:"v2",vec3:"v3",vec4:"v4",mat4:"v4",int:"i",bool:"b","float[]":"f[]","vec4[]":"v4[]"},wH={t:"sampler2D",tc:"samplerCube",b:"bool",i:"int",f:"float",c:"vec3",v2:"vec2",v3:"vec3",v4:"vec4",m3:"mat3",m4:"mat4","f[]":"float[]","v4[]":"vec4[]"},DH=class{constructor(){this.includes={consts:{},functions:{},structs:{}},this.cache="",this.slot="",this.shader="",this.context={},this.needsJitter=!0,this.getIncludesCode=function(){function e(e,t){return e.deps.length-t.deps.length}return function(t,n){let i=this.getIncludes(t,n);if(!i)return"";let r="";i=i.sort(e);for(let e=0;e<i.length;e++)i[e].src&&(r+=i[e].src+"\n");return r}}(),this.slots=[],this.caches=[],this.contexts=[],this.keywords={},this.nodeData={},this.fragmentVariables={},this.fragmentParsVariables={},this.vertexParsVariables={},this.requires={uv:[],color:[],transparent:!1,irradiance:!1,position:!1,worldPosition:!1,normal:!1,worldNormal:!1,vWorldViewDir:!1,modelMatrix:!1,viewMatrix:!1,projectionMatrix:!1},this.includes={consts:[],functions:[],structs:[]},this.attributes={},this.prefixCode=["#ifdef TEXTURE_LOD_EXT","\t#define texCube(a, b) textureCube(a, b)","\t#define texCubeBias(a, b, c) textureCubeLodEXT(a, b, c)","\t#define tex2D(a, b) texture2D(a, b)","\t#define tex2DBias(a, b, c) texture2DLodEXT(a, b, c)","#else","\t#define texCube(a, b) textureCube(a, b)","\t#define texCubeBias(a, b, c) textureCube(a, b, c)","\t#define tex2D(a, b) texture2D(a, b)","\t#define tex2DBias(a, b, c) texture2D(a, b, c)","#endif","\n\t\t\t// NOTE: Include Spline's blending modes. This could be part of BlendNode\n\t\t\t#define SPE_BLENDING_NORMAL 0\n\t\t\t#define SPE_BLENDING_MULTIPLY 1\n\t\t\t#define SPE_BLENDING_SCREEN 2\n\t\t\t#define SPE_BLENDING_OVERLAY 3\n\n\t\t\tvec3 spe_normalBlend( vec3 a, vec3 b, float alpha ) {\n\t\t\t\treturn mix( a, b, alpha );\n\t\t\t}\n\n\t\t\tvec3 spe_multiplyBlend( vec3 a, vec3 b, float alpha ) {\n\t\t\t\treturn mix( a, a * b, alpha );\n\t\t\t}\n\n\t\t\tvec3 spe_screenBlend( vec3 a, vec3 b, float alpha ) {\n\t\t\t\tvec3 tmp = 1.0 - ( 1.0 - a ) * ( 1.0 - b );\n\t\t\t\treturn mix( a, tmp, alpha );\n\t\t\t}\n\n\t\t\tvec3 spe_overlayBlend( vec3 a, vec3 b, float alpha ) {\n\t\t\t\tvec3 tmp = mix( 1. - 2. * (1. - a) * (1. - b), 2. * a * b, step( a, vec3(.5) ) );\n\t\t\t\treturn clamp( mix( a, tmp, alpha ), 0.0, 1.0 );\n\t\t\t}\n\n\t\t\tvec3 spe_blend( vec3 a, vec3 b, float alpha, int mode ) {\n\t\t\t\tif ( mode == SPE_BLENDING_NORMAL ) return spe_normalBlend( a, b, alpha );\n\t\t\t\telse if ( mode == SPE_BLENDING_MULTIPLY ) return spe_multiplyBlend( a, b, alpha );\n\t\t\t\telse if ( mode == SPE_BLENDING_SCREEN ) return spe_screenBlend( a, b, alpha );\n\t\t\t\telse if ( mode == SPE_BLENDING_OVERLAY ) return spe_overlayBlend( a, b, alpha );\n\t\t\t\treturn vec3( 1.0 );\n\t\t\t}\n\t\t\t","#include <packing>","#include <common>"].join("\n"),this.parsCode={vertex:["float neighbor_offset = 0.0001;",""].join("\n"),fragment:["float accumAlpha = 0.0;","void accumulateAlpha(float alpha) {\n\t\t\t\t\taccumAlpha += (1.0 - accumAlpha) * alpha;\n\t\t\t\t}",""].join("\n")},this.code={vertex:"",fragment:""},this.nodeCode={vertex:"",fragment:""},this.resultCode={vertex:"",fragment:""},this.finalCode={vertex:"",fragment:""},this.inputs={uniforms:{list:[],vertex:[],fragment:[]},arrayUniforms:{list:[],vertex:[],fragment:[]},vars:{varying:[],vertex:[],fragment:[]}},this.defines={},this.uniforms={},this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.updaters=[],this.nodes=[],this.analyzing=!1}build(e,t){this.addVertexParsCode("\nuniform int frameIndex;\nuniform vec2 resolution;\nuniform mat4 previousModelViewMatrix;\nuniform mat4 previousProjectionMatrix;\n\nvarying vec4 vCurrentPosition;\nvarying vec4 vPreviousPosition;\n"),this.addFragmentParsCode("\nlayout(location = 1) out vec4 gVelocity;\n\nuniform int frameIndex;\nuniform vec2 resolution;\n\nvarying vec4 vCurrentPosition;\nvarying vec4 vPreviousPosition;\n\nconst vec2 haltonSequence[16] = vec2[16](\nvec2( 0.000000,-0.333334),\nvec2(-0.500000, 0.333334),\nvec2( 0.500000,-0.777778),\nvec2(-0.750000,-0.111112),\nvec2( 0.250000, 0.555556),\nvec2(-0.250000,-0.555556),\nvec2( 0.750000, 0.111112),\nvec2(-0.875000, 0.777778),\nvec2(0.125000, -0.925926),\nvec2(-0.375000, -0.259260),\nvec2(0.625000, 0.407408),\nvec2(-0.625000, -0.703704),\nvec2(0.375000, -0.037038),\nvec2(-0.125000, 0.629630),\nvec2(0.875000, -0.481482),\nvec2(-0.937500, 0.185186));\n\nvec2 vogelDiskSample(int sampleIndex, int sampleCount, float angle) {\n  const float goldenAngle = 2.399963f; // radians\n  float r = sqrt(float(sampleIndex) + 0.5f) / sqrt(float(sampleCount));\n  float theta = float(sampleIndex) * goldenAngle + angle;\n  float sine = sin(theta);\n  float cosine = cos(theta);\n  return vec2(cosine, sine) * r;\n}\n\n// Derived from the interleaved gradient function from Jimenez 2014 http:goo.gl/eomGso\nfloat getNoiseInterleavedGradient(vec2 screenPos) {\n    vec3 magic = vec3(0.06711056f, 0.00583715f, 52.9829189f);\n    return fract(magic.z * fract(dot(screenPos, magic.xy)));\n}\n\n"),this.buildShader("vertex",e),this.buildShader("fragment",t);for(let n=0;n<this.requires.uv.length;n++)if(this.requires.uv[n]){let e=n>0?n+1:"";this.addVaryCode("varying vec2 vUv"+e+";"),n>0&&this.addVertexParsCode("attribute vec2 uv"+e+";"),this.addVertexFinalCode("vUv"+e+" = uv"+e+";")}return this.requires.color[0]&&(this.addVaryCode("varying vec4 vColor;"),this.addVertexParsCode("attribute vec4 color;"),this.addVertexFinalCode("vColor = color;")),this.requires.color[1]&&(this.addVaryCode("varying vec4 vColor2;"),this.addVertexParsCode("attribute vec4 color2;"),this.addVertexFinalCode("vColor2 = color2;")),this.requires.position&&(this.addVaryCode("varying vec3 vPosition;"),this.addVertexFinalCode("vPosition = transformed;")),this.requires.worldPosition,this.requires.normal&&(this.addVaryCode("varying vec3 vObjectNormal;"),this.addVertexFinalCode("\n\t\t\t\t#ifndef SHAPEBLEND \n\t\t\t\t\tvObjectNormal = normal;\n\t\t\t\t#else\n\t\t\t\t\tvObjectNormal = objectNormal;\n\t\t\t\t#endif\n\t\t\t")),this.requires.modelMatrix&&this.addFragmentParsCode("uniform mat4 modelMatrix;"),this.requires.viewMatrix&&this.addFragmentParsCode("uniform mat4 viewMatrix;"),this.requires.projectionMatrix&&this.addFragmentParsCode("uniform mat4 projectionMatrix;"),this.requires.worldNormal&&(this.addVaryCode("varying vec3 vWNormal;"),this.addVertexFinalCode("vWNormal = inverseTransformDirection( transformedNormal, viewMatrix ).xyz;")),this.requires.vWorldViewDir&&(this.addVaryCode("varying vec3 vWorldViewDir;"),this.addVertexFinalCode("vWorldViewDir = isPerspectiveMatrix( projectionMatrix ) ?  ( (modelMatrix * vec4(position, 1.0)).xyz - cameraPosition ) : vec3( -viewMatrix[0][2], -viewMatrix[1][2], -viewMatrix[2][2] );")),this.needsJitter&&(this.addVertexFinalCode("\n// TODO: This could be generated CPU side and passed to the shader every frame\nconst vec2 haltonSequence[16] = vec2[16](\nvec2( 0.000000,-0.333334),\nvec2(-0.500000, 0.333334),\nvec2( 0.500000,-0.777778),\nvec2(-0.750000,-0.111112),\nvec2( 0.250000, 0.555556),\nvec2(-0.250000,-0.555556),\nvec2( 0.750000, 0.111112),\nvec2(-0.875000, 0.777778),\nvec2(0.125000, -0.925926),\nvec2(-0.375000, -0.259260),\nvec2(0.625000, 0.407408),\nvec2(-0.625000, -0.703704),\nvec2(0.375000, -0.037038),\nvec2(-0.125000, 0.629630),\nvec2(0.875000, -0.481482),\nvec2(-0.937500, 0.185186));\n\n// TODO: Pass correct view size\nvec2 offset = haltonSequence[frameIndex];\noffset.x /= resolution.x;\noffset.y /= resolution.y;\n\nvec4 currentPosition = gl_Position;\nvec4 currentPositionJittered = currentPosition + (vec4(offset.x, offset.y, 0.0, 0.0) * currentPosition.w);\n\n// We want to calculate the velocity with unjittered positions\n// so that things that are not moving get a velocity = 0\nvCurrentPosition = currentPosition;\nvPreviousPosition = previousProjectionMatrix * previousModelViewMatrix * vec4(transformed, 1.0);\n#ifdef OUTLINE_COMPENSATION\nvPreviousPosition.xy += OUTLINE_COMPENSATION;\n#endif\ngl_Position = currentPositionJittered;\n\n"),this.addFragmentFinalCode("\nvec2 oldPos = vPreviousPosition.xy;\n    oldPos /= vPreviousPosition.w;\n    oldPos.xy = (oldPos.xy+1.)/2.0;\n\nvec2 newPos = vCurrentPosition.xy;\n    newPos /= vCurrentPosition.w;\n    newPos.xy = (newPos.xy+1.)/2.0;\n\nvec2 velocity = (newPos - oldPos);\n\n// Discard fully transparent pixels \nif (gl_FragColor.a <= 0.0) discard;\n\ngVelocity = vec4(velocity, 0.0, 1.0);\n")),this}buildShader(e,t){this.resultCode[e]=t.build(this.setShader(e),"v4")}setMaterial(e,t){return this.defines={},this}addFlow(e,t,n){return this.addSlot(e).addCache(t).addContext(n)}removeFlow(){return this.removeSlot().removeCache().removeContext()}addCache(e){return this.cache=null!==e&&void 0!==e?e:"",this.caches.push(this.cache),this}removeCache(){return this.caches.pop(),this.cache=this.caches[this.caches.length-1]||"",this}addContext(e){return this.context=Object.assign({},this.context,e),this.context.extra=this.context.extra||{},this.contexts.push(this.context),this}removeContext(){return this.contexts.pop(),this.context=this.contexts[this.contexts.length-1]||{},this}addSlot(e){return this.slot=e||"",this.slots.push(this.slot),this}removeSlot(){return this.slots.pop(),this.slot=this.slots[this.slots.length-1]||"",this}addFragmentVariable(e,t){void 0===this.fragmentVariables[e]&&(this.addFragmentCode("".concat(t," ").concat(e,";")),this.fragmentVariables[e]="")}addFragmentParsVariable(e,t){void 0===this.fragmentParsVariables[e]&&(this.addFragmentParsCode("".concat(t," ").concat(e,";")),this.fragmentParsVariables[e]="")}addVertexParsVariable(e,t){void 0===this.vertexParsVariables[e]&&(this.addVertexParsCode("".concat(t," ").concat(e,";")),this.vertexParsVariables[e]="")}addVertexCode(e){this.addCode(e,"vertex")}addFragmentCode(e){this.addCode(e,"fragment")}addCode(e,t){this.code[null!==t&&void 0!==t?t:this.shader]+=e+"\n"}addVertexNodeCode(e){this.addNodeCode(e,"vertex")}addFragmentNodeCode(e){this.addNodeCode(e,"fragment")}addNodeCode(e,t){this.nodeCode[null!==t&&void 0!==t?t:this.shader]+=e+"\n"}clearNodeCode(e){e=null!==e&&void 0!==e?e:this.shader;let t=this.nodeCode[e];return this.nodeCode[e]="",t}clearVertexNodeCode(){return this.clearNodeCode("vertex")}clearFragmentNodeCode(){return this.clearNodeCode("fragment")}addVertexFinalCode(e){this.addFinalCode(e,"vertex")}addFragmentFinalCode(e){this.addFinalCode(e,"fragment")}addFinalCode(e,t){this.finalCode[null!==t&&void 0!==t?t:this.shader]+=e+"\n"}addVertexParsCode(e){this.addParsCode(e,"vertex")}addFragmentParsCode(e){this.addParsCode(e,"fragment")}addParsCode(e,t){this.parsCode[null!==t&&void 0!==t?t:this.shader]+=e+"\n"}addVaryCode(e){this.addVertexParsCode(e),this.addFragmentParsCode(e)}isCache(e){return-1!==this.caches.indexOf(e)}isSlot(e){return-1!==this.slots.indexOf(e)}define(e,t){this.defines[e]=void 0===t?1:t}require(e){this.requires[e]=!0}isDefined(e){return void 0!==this.defines[e]}getVar(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"varying",r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"V",s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"",a=this.getVars(i),o=a[e];if(!o){let i=a.length;o={name:n||"node"+r+i+(s?"_"+s:""),type:t},a.push(o),a[e]=o}return o}getTempVar(e,t,n,i){return this.getVar(e,t,n,this.shader,"T",i)}getAttribute(e,t){if(!this.attributes[e]){let n=this.getVar(e,t);this.addVertexParsCode("attribute "+t+" "+e+";"),this.addVertexFinalCode(n.name+" = "+e+";"),this.attributes[e]={varying:n,name:e,type:t}}return this.attributes[e]}getCode(e){return[this.prefixCode,this.parsCode[e],this.getVarListCode(this.getVars("varying"),"varying"),this.getVarListCode(this.inputs.uniforms[e],"uniform"),this.getVarListCode(this.inputs.arrayUniforms[e],"uniform"),this.getIncludesCode("consts",e),this.getIncludesCode("structs",e),this.getIncludesCode("functions",e),"void main() {",this.getVarListCode(this.getVars(e)),this.code[e],this.resultCode[e],this.finalCode[e],"}"].join("\n")}getVarListCode(e,t){t=null!==t&&void 0!==t?t:"";let n="";for(let i=0,r=e.length;i<r;++i){let r=e[i],s=r.type,a=r.name,o=r.size,l=this.getFormatByType(s);if(void 0===l)throw new Error("Node pars "+l+" not found.");l.includes("[]")?n+=t+" "+l.substring(0,l.length-2)+" "+a+"[".concat(o,"];\n"):n+=t+" "+l+" "+a+";\n"}return n}getVars(e){return this.inputs.vars[null!==e&&void 0!==e?e:this.shader]}getNodeData(e){let t=e instanceof IV?e.uuid:e;return this.nodeData[t]=this.nodeData[t]||{}}createUniform(e,t,n,i,r,s){if(t.includes("[]")){let a=this.inputs.arrayUniforms,o=a.list.length,l=new kV({type:t,size:n.size,name:i||"nodeUA"+o+(s?"_"+s:""),node:n,needsUpdate:r});return a.list.push(l),a[e].push(l),a[e][l.name]=l,this.uniforms[l.name]=l,l}{let a=this.inputs.uniforms,o=a.list.length,l=new kV({type:t,name:i||"nodeU"+o+(s?"_"+s:""),node:n,needsUpdate:r});return a.list.push(l),a[e].push(l),a[e][l.name]=l,this.uniforms[l.name]=l,l}}createVertexUniform(e,t,n,i,r){return this.createUniform("vertex",e,t,n,i,r)}createFragmentUniform(e,t,n,i,r){return this.createUniform("fragment",e,t,n,i,r)}include(e,t,n){let i;if(e="string"==typeof e?BV.get(e):e,!1===this.context.include)return e.name;e instanceof WV?i=this.includes.functions:e instanceof YV?i=this.includes.consts:e instanceof KV&&(i=this.includes.structs);let r=i[this.shader]=i[this.shader]||[];if(e){var s;let i=r[e.name];if(i||(i=r[e.name]={node:e,deps:[]},r.push(i),i.src=e.build(this,"source")),e instanceof WV&&t&&r[t.name]&&-1===r[t.name].deps.indexOf(e)&&(r[t.name].deps.push(e),null!==(s=e.includes)&&void 0!==s&&s.length)){let n=0;do{this.include(e.includes[n++],t)}while(n<e.includes.length)}return n&&(i.src=n),e.name}throw new Error("Include not found.")}colorToVectorProperties(e){return e.replace("r","x").replace("g","y").replace("b","z").replace("a","w")}colorToVector(e){return e.replace(/c/g,"v3")}getIncludes(e,t){return this.includes[e][t||this.shader]}getConstructorFromLength(e){return xH[e-1]}isTypeMatrix(e){return/^m/.test(e)}getTypeLength(e){return"f"===e?1:parseInt(this.colorToVector(e).substr(1))}getTypeFromLength(e){return 1===e?"f":"v"+e}findNode(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];for(let i=0;i<arguments.length;i++){let e=t[i];if(null!==e&&void 0!==e&&e.isNode)return e}}resolve(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];for(let i=0;i<arguments.length;i++){let e=t[i];if(void 0!==e){if(e.isNode)return e;if(e.isTexture)switch(e.mapping){case ig:case rg:return new vH(e);case sg:return new gH(new tH(e));default:return new tH(e)}else{if(e.isVector2)return new zV(e);if(e.isVector3)return new NV(e);if(e.isVector4)return new UV(e)}}}}format(e,t,n){switch(this.colorToVector(n+" <- "+t)){case"f <- v2":case"f <- v3":case"f <- v4":return e+".x";case"f <- i":case"f <- b":return"float( "+e+" )";case"v2 <- f":return"vec2( "+e+" )";case"v2 <- v3":case"v2 <- v4":return e+".xy";case"v2 <- i":case"v2 <- b":case"v3 <- i":case"v3 <- b":return"vec2( float( "+e+" ) )";case"v3 <- f":return"vec3( "+e+" )";case"v3 <- v2":return"vec3( "+e+", 0.0 )";case"v3 <- v4":return e+".xyz";case"v4 <- f":return"vec4( "+e+" )";case"v4 <- v2":return"vec4( "+e+", 0.0, 1.0 )";case"v4 <- v3":return"vec4( "+e+", 1.0 )";case"v4 <- i":case"v4 <- b":return"vec4( float( "+e+" ) )";case"i <- f":case"i <- b":return"int( "+e+" )";case"i <- v2":case"i <- v3":case"i <- v4":return"int( "+e+".x )";case"b <- f":return"( "+e+" != 0.0 )";case"b <- v2":return"( "+e+" != vec2( 0.0 ) )";case"b <- v3":return"( "+e+" != vec3( 0.0 ) )";case"b <- v4":return"( "+e+" != vec4( 0.0 ) )";case"b <- i":return"( "+e+" != 0 )"}return e}getTypeByFormat(e){return bH[e]||e}getFormatByType(e){return wH[e]||e}getUUID(e,t){return(t=void 0===t||t)&&this.cache&&(e=this.cache+"-"+e),e}getElementByIndex(e){return yH[e]}getIndexByElement(e){return yH.indexOf(e)}isShader(e){return this.shader===e}setShader(e){return this.shader=e,this}mergeDefines(e){for(let t in e)this.defines[t]=e[t];return this.defines}mergeUniform(e){for(let t in e)this.uniforms[t]=e[t];return this.uniforms}getTextureEncodingFromMap(e){let t;return e?e.isTexture&&(t=e.encoding):t=zg,t===zg&&this.context.gamma&&(t=Ng),t}},_H=class extends LV{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0;super("c"),this.nodeType="Color",this.value=e instanceof jV?e:new jV(e||0,t,n,i)}setRGBA(e){this.value.setRGBA(e.r,e.g,e.b,e.a)}generate(e,t,n,i,r,s){n=e.getUUID(null!==n&&void 0!==n?n:this.getUUID()),i=null!==i&&void 0!==i?i:this.getType(e);let a=e.getNodeData(n),o=this.getReadonly()&&void 0!==this.generateReadonly;if(this.alpha){let t=this.alpha.build(e,"f");e.addFragmentNodeCode("accumAlpha += ( 1.0 - accumAlpha ) * ".concat(t,";"))}return o?this.generateReadonly(e,t,n,i,r,s):e.isShader("vertex")?(a.vertex||(a.vertex=e.createVertexUniform(i,this,r,s,this.getLabel())),e.format(a.vertex.name,i,t)):(a.fragment||(a.fragment=e.createFragmentUniform(i,this,r,s,this.getLabel())),e.format(a.fragment.name,i,t))}generateReadonly(e,t,n,i,r,s){return e.format("vec3("+this.value.r+", "+this.value.g+", "+this.value.b+")",i,t)}},SH=class extends LV{constructor(e){super("i"),this.nodeType="Int",this.value=Math.floor(null!==e&&void 0!==e?e:0)}generateReadonly(e,t,n,i,r,s){return e.format(this.value.toString(),i,t)}},EH=class extends LV{constructor(e){super("b"),this.nodeType="Bool",this.value=null!==e&&void 0!==e&&e}generateReadonly(e,t,n,i){return e.format(this.value?"true":"false",i,t)}},CH=class extends LV{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1?arguments[1]:void 0;super("f[]"),this.nodeType="FloatArray",this.size=e,this.value=Array.isArray(t)?t:"number"==typeof t?new Array(e).fill(t):new Array(e).fill(0)}},AH=class extends LV{},MH=class extends AH{constructor(e){super("v3"),this.image=e,this._value=new Lv}get value(){var e,t;return this._value.x=this.image.isVideo?null!==(e=this.image.img.videoWidth)&&void 0!==e?e:0:this.image.img.width,this._value.y=this.image.isVideo?null!==(t=this.image.img.videoHeight)&&void 0!==t?t:0:this.image.img.height,this._value}},TH=class extends AH{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1008,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1006;super("t"),this.image=e,this.wrap=t,this.minFilter=n,this.magFilter=i}get value(){return this.image.getTexture(this.wrap,this.minFilter,this.magFilter)}},PH=class extends LV{constructor(e){super("m3"),this.nodeType="Matrix3",this.value=null!==e&&void 0!==e?e:new uv}generateReadonly(e,t,n,i,r,s){return e.format("mat3("+this.value.elements.join(", ")+")",i,t)}get elements(){return this.value.elements}set elements(e){this.value.fromArray(e)}},FH=class extends LV{constructor(e){super("m4"),this.nodeType="Matrix4",this.value=null!==e&&void 0!==e?e:new py}generateReadonly(e,t,n,i,r,s){return e.format("mat4("+this.value.elements.join(", ")+")",i,t)}get elements(){return this.value.elements}set elements(e){this.value.fromArray(e)}};function OH(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;e.setUvTransform(n[0],n[1],t[0],t[1],0,0,0).premultiply((new uv).makeRotation(i*ov.DEG2RAD))}var IH=class extends PH{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;super(new uv),this.repeat=e,this.offset=t,this.rotation=n,OH(this.value,e,t,n)}updateMatrix(){OH(this.value,this.repeat,this.offset,this.rotation)}},kH=class extends LV{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1?arguments[1]:void 0;super("v4[]"),this.nodeType="Vector4Array",this.size=e,this.value=Array.isArray(t)?t:t instanceof Ov?new Array(e).fill(t):new Array(e).fill(new Ov(0))}},BH=class extends RV{constructor(e,t,n,i){super("v3"),this.nodeType="Blend",this.a=e,this.b=t,this.alpha=n,this.mode=i}generate(e,t){if(e.isShader("fragment")){let n=[];return n.push(this.a.build(e,"c")),n.push(this.b.build(e,"c")),n.push(this.alpha.build(e,"f")),n.push(this.mode.build(e,"i")),e.format("spe_blend("+n.join(",")+")",this.getType(e),t)}return console.warn("BlendNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.getType(e),t)}},RH=class extends RV{constructor(e,t){super("v3"),this.nodeType="CustomColor",this.color=e,this.alpha=t,this.calpha="g".concat(this.uuid.toString().replace(/-/g,""),"_calpha")}generate(e,t){if(e.isShader("fragment")){let n=e.include(RH.Nodes.customColor);e.addFragmentVariable(this.calpha,"float");let i=[];return i.push(this.color.build(e,"v3")),i.push(this.mask?"luminance(".concat(this.mask.build(e,"v3"),")"):"1.0"),i.push(this.alpha.build(e,"f")),i.push(this.calpha),e.format(n+"("+i.join(",")+")",this.getType(e),t)}return console.warn("CustomColorNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.getType(e),t)}},LH=RH;LH.Nodes={customColor:new WV("vec3 customColor(vec3 color, float mask, float alpha, out float calpha) {\n\t\t\t\tfloat lalpha = alpha * mask;\n\t\t\t\tcalpha =  lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0);\n\t\t\t\taccumAlpha += (1.0 - accumAlpha) * lalpha;\n\n\t\t\t\treturn color;\n\t\t\t}")};var zH=class extends RV{constructor(e,t){super("v3"),this.nodeType="CustomNormal",this.cnormal=e,this.alpha=t,this.calpha="g".concat(this.uuid.toString().replace(/-/g,""),"_calpha")}generate(e,t){if(e.isShader("fragment")){let n=e.include(zH.Nodes.customNormal);e.addFragmentVariable(this.calpha,"float");let i=[];return i.push(this.cnormal.build(e,"v3")),i.push("normal"),i.push(this.mask?"luminance(".concat(this.mask.flow(e,"v3").result,")"):"1.0"),i.push(this.alpha.build(e,"f")),i.push(this.calpha),e.format(n+"("+i.join(",")+")",this.getType(e),t)}return console.warn("CustomNormalNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.getType(e),t)}},NH=zH;NH.Nodes={customNormal:new WV("vec3 customNormal(vec3 cnormal, vec3 norm, float mask, float alpha, out float calpha) {\n\t\t\t\tvec3 normal = packNormalToRGB( norm ).rgb;\n\t\t\t\tnormal *= step( vec3(0.5), cnormal );\n\n\t\t\t\tfloat lalpha = alpha * mask;\n\t\t\t\tcalpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );\n\t\t\t\taccumAlpha += ( 1.0 - accumAlpha ) * lalpha;\n\n\t\t\t\treturn normal;\n\t\t\t}")};var jH=class extends RV{constructor(e,t,n,i,r,s,a,o,l,u,c,h){super("v3"),this.nodeType="CustomTexture",this.texture=e,this.textureSize=t,this.crop=n,this.projection=i,this.axis=r,this.side=s,this.size=a,this.blending=o,this.mat=l,this.isMask=h,this.alpha=u,this.mode=c,this.calpha="g".concat(this.uuid.toString().replace(/-/g,""),"_calpha")}generate(e,t){e.require("position"),e.require("normal"),e.require("uv"),e.requires.uv=[!0],e.extensions.shaderTextureLOD=!0,e.extensions.derivatives=!0;let n,i="g".concat(this.uuid.toString().replace(/-/g,""));switch(this.projection.value){case 3:n=e.include(jH.Nodes.cylindrical);break;case 2:n=e.include(jH.Nodes.spherical);break;case 1:let t=["vec3(1.0, 0.0, 0.0)","vec3(0.0, 1.0, 0.0)","vec3(0.0, 0.0, 1.0)"][this.axis.value],r=["zy","xz","xy"][this.axis.value],s=new WV("\n\t\tvec3 ".concat(i,"_planarTexture(vec3 normal, sampler2D tex, vec2 textureSize, float crop, mat3 mat, vec2 size, float blending, bool isMask, float mask, float alpha, int mode, out float calpha, out vec2 writeUv) {\n\t\t\t\tvec2 projected = (1. + (position.").concat(r,")) / 2.;\n\t\t\t\tvec2 uvs = ( mat * vec3( (projected * 2. - 1.) / (size * .5), 1. ) / 2. + 0.5 ).xy;\n\t\t\t\twriteUv = uvs;\n\n\t\t\t\tvec4 tmp = texture2D( tex, uvs );\n\n\t\t\t\tvec3 col = tmp.rgb;\n\t\t\t\tfloat lalpha = alpha * tmp.a;\n\t\t\t\t").concat(2===this.side.value?"":"lalpha *= step(0.0, ".concat(1===this.side.value?"-1.0 * ":"","dot(vObjectNormal, ").concat(t,"));"),"\n\n\t\t\t\tif ( crop > 0.5 ) {\n\t\t\t\t\tif ( uvs.x < 0.0 || uvs.x > 1.0 || uvs.y < 0.0 || uvs.y > 1.0 )  {\n\t\t\t\t\t\tlalpha = 0.0;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tlalpha *= mask;\n\n\t\t\t\tcalpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );\n\t\t\t\taccumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));\n\n\t\t\t\treturn col;\n\t\t\t}"));n=e.include(s);break;case 4:n=e.include(jH.Nodes.triplanar);break;default:n=e.include(jH.Nodes.uv)}e.addFragmentVariable(this.calpha,"float");let r=[];if(r.push("normal"),r.push(this.texture.generate(e,"t")),r.push(this.textureSize.build(e,"v2")),r.push(this.crop.build(e,"f")),r.push(this.mat.build(e,"mat3")),r.push(this.size.build(e,"v2")),r.push(this.blending.build(e,"f")),r.push(this.isMask.build(e,"b")),r.push(this.mask?"luminance(".concat(this.mask.flow(e,"v3").result,")"):"1.0"),r.push(this.alpha.build(e,"f")),r.push(this.mode.build(e,"i")),r.push(this.calpha),4===this.projection.value){let t="".concat(i,"_writeUvs"),n=t+"0",s=t+"1",a=t+"2",o="".concat(i,"_triplanarWeights");e.addFragmentVariable(n,"vec2"),e.addFragmentVariable(s,"vec2"),e.addFragmentVariable(a,"vec2"),e.addFragmentVariable(o,"vec3"),r.push(n),r.push(s),r.push(a),r.push(o)}else{let t="".concat(i,"_writeUvs");e.addFragmentVariable(t,"vec2"),r.push(t)}return e.format(n+"("+r.join(",")+")",this.getType(e),t)}},UH=jH;UH.Nodes={cylindrical:new WV("\nvec3 cylindricalTexture(vec3 normal, sampler2D tex, vec2 textureSize, float crop, mat3 mat, vec2 size, float blending, bool isMask, float mask, float alpha, int mode, out float calpha, out vec2 writeUv) {\n                vec3 posN = normalize(position);\n                float u = 0.5 + atan(posN.z, posN.x) / (2.*3.1415);\n                float scaledHeight = position.y / (size.y * 0.5);\n                float v =  (scaledHeight / 2.) + .5;\n\n                vec2 calculatedUv = vec2(u,v);\n\t\t\t\tvec2 uvs = ( mat * vec3( calculatedUv * 2. - 1., 1. ) / 2. + 0.5 ).xy;\n\t\t\t\twriteUv = uvs;\n\n                vec2 df = fwidth(uvs);\n               \tif(df.x > 0.5) df.x = 0.;\n\n\t\t\t\t#ifdef GL_EXT_shader_texture_lod\n                vec4 tmp = texture2DLodEXT(tex, uvs, log2(max(df.x, df.y)*min(textureSize.x, textureSize.y)));\n\t\t\t\t#else\n                vec4 tmp = textureLod(tex, uvs, log2(max(df.x, df.y)*min(textureSize.x, textureSize.y)));\n\t\t\t\t#endif\n\n\t\t\t\tvec3 col = tmp.rgb;\n\t\t\t\tfloat lalpha = alpha * tmp.a;\n\t\t\t\tif ( crop > 0.5 ) {\n\t\t\t\t\tif ( uvs.x < 0.0 || uvs.x > 1.0 || uvs.y < 0.0 || uvs.y > 1.0 )  {\n\t\t\t\t\t\tlalpha = 0.0;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tlalpha *= mask;\n\t\t\t\t\n\t\t\t\tcalpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );\n\t\t\t\taccumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));\n\n\t\t\t\treturn col;\n\t\t\t}\n"),spherical:new WV("\nvec3 sphericalTexture(vec3 normal, sampler2D tex, vec2 textureSize, float crop, mat3 mat, vec2 size, float blending, bool isMask, float mask, float alpha, int mode, out float calpha, out vec2 writeUv) {\n                vec3 posN = normalize(vPosition);\n                float u = 0.5 + atan(posN.z, posN.x) / (2.*3.1415);\n                float v = 0.5 + asin(posN.y) / 3.1415;\n\n                vec2 calculatedUv = vec2(u,v);\n\t\t\t\tvec2 uvs = ( mat * vec3( calculatedUv * 2. - 1., 1. ) / 2. + 0.5 ).xy;\n\t\t\t\twriteUv = uvs;\n\n                vec2 df = fwidth(uvs);\n               \tif(df.x > 0.5) df.x = 0.;\n\t\t\t\t#ifdef GL_EXT_shader_texture_lod\n                vec4 tmp = texture2DLodEXT(tex, uvs, log2(max(df.x, df.y)*min(textureSize.x, textureSize.y)));\n\t\t\t\t#else\n                vec4 tmp = textureLod(tex, uvs, log2(max(df.x, df.y)*min(textureSize.x, textureSize.y)));\n\t\t\t\t#endif\n\n\t\t\t\tvec3 col = tmp.rgb;\n\t\t\t\tfloat lalpha = alpha * tmp.a;\n\t\t\t\tif ( crop > 0.5 ) {\n\t\t\t\t\tif ( uvs.x < 0.0 || uvs.x > 1.0 || uvs.y < 0.0 || uvs.y > 1.0 )  {\n\t\t\t\t\t\tlalpha = 0.0;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tlalpha *= mask;\n\n\t\t\t\tcalpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );\n\t\t\t\taccumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));\n\n\t\t\t\treturn col;\n\t\t\t}\n"),uv:new WV("vec3 uvTexture(vec3 normal, sampler2D tex, vec2 textureSize, float crop, mat3 mat, vec2 size, float blending, bool isMask, float mask, float alpha, int mode, out float calpha, out vec2 writeUv) {\n\t\t\t\tvec2 uvs = ( mat * vec3( vUv * 2. - 1., 1. ) / 2. + 0.5 ).xy;\n\t\t\t\twriteUv = uvs;\n\n\t\t\t\tvec4 tmp = texture2D( tex, uvs );\n\n\t\t\t\tvec3 col = tmp.rgb;\n\n\t\t\t\tfloat lalpha = alpha * tmp.a;\n\t\t\t\tif ( crop > 0.5 ) {\n\t\t\t\t\tif ( uvs.x < 0.0 || uvs.x > 1.0 || uvs.y < 0.0 || uvs.y > 1.0 )  {\n\t\t\t\t\t\tlalpha = 0.0;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tlalpha *= mask;\n\n\t\t\t\tcalpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );\n\t\t\t\taccumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));\n\n\t\t\t\treturn col;\n\t\t\t}"),triplanar:new WV("vec3 triplanarTexture(vec3 normal, sampler2D tex, vec2 textureSize, float crop, mat3 mat, vec2 size, float blending, bool isMask, float mask, float alpha, int mode, out float calpha, out vec2 writeUvs0, out vec2 writeUvs1, out vec2 writeUvs2, out vec3 writeWeights) {\n\t\t\t\tvec3 p = position;\n\t\t\t\tvec2 uv0 = (1.0 + p.xy) / 2.0;     \n\t\t\t\tvec2 uv1 = (1.0 + p.zy) / 2.0;\t\t\n\t\t\t\tvec2 uv2 = (1.0 + p.xz) / 2.0;\t\t\n\t\n\t\t\t\tuv0 = (mat * vec3((uv0 * 2.0 - 1.0) / (size * 0.5), 1.0) / 2.0 + 0.5).xy;\n\t\t\t\tuv1 = (mat * vec3((uv1 * 2.0 - 1.0) / (size * 0.5), 1.0) / 2.0 + 0.5).xy;\n\t\t\t\tuv2 = (mat * vec3((uv2 * 2.0 - 1.0) / (size * 0.5), 1.0) / 2.0 + 0.5).xy;\n\n\t\t\t\t// Range from 3 to 128 seems to be good\n\t\t\t\tfloat exponent = (1.0 - blending) * 125.0 + 3.0;\n\n\t\t\t\tvec3 n = vObjectNormal;\n\t\t\t\tvec3 weights = abs(normalize(n));\n\t\t\t\tweights = pow(weights, vec3(exponent));\n\t\t\t\tweights /= dot(weights, vec3(1.0));\n\n\t\t\t\t// Write out all sets of UVs that we generated\n\t\t\t\twriteUvs0 = uv0;\n\t\t\t\twriteUvs1 = uv1;\n\t\t\t\twriteUvs2 = uv2;\n\t\t\t\twriteWeights = weights;\n\n\t\t\t\t// Derivatives for LOD\n\t\t\t\tvec2 df0 = fwidth(uv0);\n\t\t\t\tvec2 df1 = fwidth(uv1);\n\t\t\t\tvec2 df2 = fwidth(uv2);\n\t\t\t\tif (df0.x > 0.5) df0.x = 0.0;\n\t\t\t\tif (df1.x > 0.5) df1.x = 0.0;\n\t\t\t\tif (df2.x > 0.5) df2.x = 0.0;\n\n\t\t\t\t#ifdef GL_EXT_shader_texture_lod\n                \tvec4 tmp = \n\t\t\t\t\t\ttexture2DLodEXT(tex, uv0, log2(max(df0.x, df0.y)*min(textureSize.x, textureSize.y))) * weights.z + \n\t\t\t\t\t\ttexture2DLodEXT(tex, uv1, log2(max(df1.x, df1.y)*min(textureSize.x, textureSize.y))) * weights.x + \n\t\t\t\t\t\ttexture2DLodEXT(tex, uv2, log2(max(df2.x, df2.y)*min(textureSize.x, textureSize.y))) * weights.y;\n\t\t\t\t#else\n                \tvec4 tmp = \n\t\t\t\t\t\ttextureLod(tex, uv0, log2(max(df0.x, df0.y)*min(textureSize.x, textureSize.y))) * weights.z + \n\t\t\t\t\t\ttextureLod(tex, uv1, log2(max(df1.x, df1.y)*min(textureSize.x, textureSize.y))) * weights.x + \n\t\t\t\t\t\ttextureLod(tex, uv2, log2(max(df2.x, df2.y)*min(textureSize.x, textureSize.y))) * weights.y;\n\t\t\t\t#endif\n\n\t\t\t\tvec3 col = tmp.rgb;\n\t\t\t\tfloat lalpha = alpha * tmp.a;\n\n\t\t\t\t// Apply cropping across all 3 planes\n\t\t\t\tif ( crop > 0.5 ) {\n\t\t\t\t\tif ( uv0.x < 0.0 || uv0.x > 1.0 || uv0.y < 0.0 || uv0.y > 1.0 )  {\n\t\t\t\t\t\tlalpha = 0.0;\n\t\t\t\t\t}\n\t\t\t\t\tif ( uv1.x < 0.0 || uv1.x > 1.0 || uv1.y < 0.0 || uv1.y > 1.0 )  {\n\t\t\t\t\t\tlalpha = 0.0;\n\t\t\t\t\t}\n\t\t\t\t\tif ( uv2.x < 0.0 || uv2.x > 1.0 || uv2.y < 0.0 || uv2.y > 1.0 )  {\n\t\t\t\t\t\tlalpha = 0.0;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tlalpha *= mask;\n\t\t\t\tcalpha =  lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0);\n\t\t\t\taccumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));\n\n\t\t\t\treturn col;//n * 0.5 + 0.5;\n\t\t\t}\t\t\t\n\t\t\t")};var VH=class extends RV{constructor(e,t,n,i,r,s,a,o,l,u,c,h){super("v3"),this.nodeType="Depth",this.gradientType=e,this.smooth=t,this.near=n,this.far=i,this.isVector=r,this.isWorldSpace=s,this.origin=a,this.direction=o,this.colors=l,this.steps=u,this.isMask=h,this.alpha=c,this.calpha="g".concat(this.uuid.toString().replace(/-/g,""),"_calpha")}generate(e,t){let n="g".concat(this.uuid.toString().replace(/-/g,"")),i=new WV("vec3 ".concat(n,"_sdepth(float near, float far, vec3 origin, vec3 direction, vec4 colors[").concat(n,"_MAX_COLORS], float steps[").concat(n,"_MAX_COLORS], bool isMask, float mask, float alpha, out float calpha) {\n               vec4 color = colors[0];\n               #ifdef ").concat(n,"_IS_VECTOR\n                   #ifdef ").concat(n,"_LINEAR\n                       #ifdef ").concat(n,"_WORLDSPACE\n                       float depth = vectorLinearWorldSpaceDepth(direction, origin, near, far);\n                       #else\n                       float depth = vectorLinearObjectSpaceDepth(direction, origin, near, far);\n                       #endif\n                   #else\n                       #ifdef ").concat(n,"_WORLDSPACE\n                           float depth = vectorSphericalWorldSpaceDepth(origin, near, far);\n                       #else\n                           float depth = vectorSphericalObjectSpaceDepth(origin, near, far);\n                       #endif\n                   #endif\n               #else\n                   float dist = length(vWPosition - cameraPosition);\n\t\t\t       float depth = ( dist - near ) / ( far - near );\n               #endif\n\n\n              float p;\n              #ifdef ").concat(n,"_SMOOTH\n\t\t\t\tfor ( int i = 1; i < ").concat(n,"_MAX_COLORS; i++ ) {\n\t\t\t\t\t\tp = clamp( ( depth - steps[i-1] ) / ( steps[i] - steps[i-1] ), 0.0, 1.0 );\n\t\t\t\t\t\tcolor = mix(color, colors[i], smoothstep(0.0, 1.0, p));\n\t\t\t\t\t}\n              #else\n                for ( int i = 1; i < ").concat(n,"_MAX_COLORS; i++ ) {\n                   p = clamp(( depth - steps[i - 1] ) / ( steps[i] - steps[i - 1] ), 0.0, 1.0);\n                   color = mix(color, colors[i], p);\n                 }\n              #endif\n\n               float lalpha = alpha * color.a * mask;\n               calpha = mix(lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0), lalpha, float(isMask));\n\t\t\t   accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));\n\t\t\t   \n               return color.rgb;\n\t\t\t}"),[VH.Nodes.vectorLinearWorldSpaceDepth,VH.Nodes.vectorLinearObjectSpaceDepth,VH.Nodes.vectorSphericalObjectSpaceDepth,VH.Nodes.vectorSphericalWorldSpaceDepth]);if(e.isShader("fragment")){e.define("".concat(n,"_MAX_COLORS"),this.colors.value.length),this.smooth.value&&e.define("".concat(n,"_SMOOTH")),this.isVector.value>.5&&e.define("".concat(n,"_IS_VECTOR")),0===this.gradientType.value&&e.define("".concat(n,"_LINEAR")),this.isWorldSpace.value>.5&&e.define("".concat(n,"_WORLDSPACE")),e.require("worldPosition"),e.addFragmentVariable(this.calpha,"float");let r=e.include(i),s=[];return s.push(this.near.build(e,"f")),s.push(this.far.build(e,"f")),s.push(this.origin.build(e,"v3")),s.push(this.direction.build(e,"v3")),s.push(this.colors.build(e,"v4[]")),s.push(this.steps.build(e,"f[]")),s.push(this.isMask.build(e,"b")),s.push(this.mask?"luminance(".concat(this.mask.flow(e,"v3").result,")"):"1.0"),s.push(this.alpha.build(e,"f")),s.push(this.calpha),e.format(r+"("+s.join(",")+")",this.getType(e),t)}return console.warn("DepthNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.getType(e),t)}},HH=VH;HH.Nodes={vectorLinearWorldSpaceDepth:new WV("float vectorLinearWorldSpaceDepth(vec3 direction, vec3 origin, float near, float far) {\n               vec3 n = normalize(direction);\n               float dist = (n.x*(vWPosition.x - origin.x) + n.y*(vWPosition.y - origin.y) + n.z*(vWPosition.z - origin.z));\n               return ( dist - near ) / ( far - near );\n            }"),vectorLinearObjectSpaceDepth:new WV("float vectorLinearObjectSpaceDepth(vec3 direction, vec3 origin, float near, float far) {\n               vec3 n = normalize(direction);\n               float dist = (n.x*(position.x - origin.x) + n.y*(position.y - origin.y) + n.z*(position.z - origin.z));\n               return ( dist - near ) / ( far - near );\n            }"),vectorSphericalWorldSpaceDepth:new WV("float vectorSphericalWorldSpaceDepth(vec3 origin, float near, float far) {\n               float dist = length(vWPosition - origin);\n               return ( dist - near ) / ( far - near );\n            }"),vectorSphericalObjectSpaceDepth:new WV("float vectorSphericalObjectSpaceDepth(vec3 origin, float near, float far) {\n               float dist = length(position - origin);\n               return ( dist - near ) / ( far - near );\n            }")};var WH=class extends RV{constructor(e,t,n,i,r,s,a,o){super("v3"),this.nodeType="Fresnel",this.color=e,this.bias=t,this.scale=n,this.intensity=i,this.factor=r,this.isMask=o,this.alpha=s,this.mode=a,this.calpha="g".concat(this.uuid.toString().replace(/-/g,""),"_calpha")}generate(e,t){if(e.require("vWorldViewDir"),e.require("worldNormal"),e.isShader("fragment")){e.addFragmentVariable(this.calpha,"float");let n=new WV("vec3 fresnel(vec3 color, float bias, float scale, float intensity, float factor, bool isMask, float mask, float alpha, int mode, out float calpha) {\n\t\t\t\t\tfloat fresnel = bias + scale * pow( abs( factor + dot( normalize( vWorldViewDir ), normalize( vWNormal ) ) ), intensity );\n\n\t\t\t\t\tfloat lalpha = clamp(fresnel, 0.0, 1.0) * alpha * mask;\n\t\t\t\t\tcalpha = mix(lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0), lalpha, float(isMask));\n\t\t\t\t\taccumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));\n\n\t\t\t\t\treturn color;\n\t\t\t\t}"),i=e.include(n),r=[];return r.push(this.color.build(e,"c")),r.push(this.bias.build(e,"f")),r.push(this.scale.build(e,"f")),r.push(this.intensity.build(e,"f")),r.push(this.factor.build(e,"f")),r.push(this.isMask.build(e,"b")),r.push(this.mask?"luminance(".concat(this.mask.flow(e,"v3").result,")"):"1.0"),r.push(this.alpha.build(e,"f")),r.push(this.mode.build(e,"i")),r.push(this.calpha),e.format(i+"("+r.join(",")+")",this.getType(e),t)}return console.warn("FresnelNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.getType(e),t)}},GH=class extends RV{constructor(e,t,n,i,r,s,a,o,l){super("v3"),this.nodeType="Gradient",this.gradientType=e,this.smooth=t,this.colors=n,this.steps=i,this.offset=r,this.morph=s,this.angle=a,this.isMask=l,this.alpha=o,this.calpha="g".concat(this.uuid.toString().replace(/-/g,""),"_calpha")}generate(e,t){if(e.isShader("fragment")){e.define("GRAD_MAX",10),e.require("uv"),e.requires.uv=[!0],e.addFragmentVariable(this.calpha,"float");let n=e.include(GH.Nodes.gradient),i=[];return i.push(this.gradientType.build(e,"i")),i.push(this.smooth.build(e,"b")),i.push(this.colors.build(e,"v4[]")),i.push(this.steps.build(e,"f[]")),i.push(this.offset.build(e,"v2")),i.push(this.morph.build(e,"v2")),i.push(this.angle.build(e,"f")),i.push(this.isMask.build(e,"b")),i.push(this.mask?"luminance(".concat(this.mask.flow(e,"v3").result,")"):"1.0"),i.push(this.alpha.build(e,"f")),i.push(this.calpha),e.format(n+"("+i.join(",")+")",this.getType(e),t)}return console.warn("GradientNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.getType(e),t)}},qH=GH;qH.Nodes={gradient:new WV("vec3 gradient(int gradientType, bool smoothed, vec4 colors[GRAD_MAX], float steps[GRAD_MAX], vec2 offset, vec2 morph, float angle, bool isMask, float mask, float alpha, out float calpha) {\n\t\t\t\tvec4 color = colors[0];\n\t\t\t\tvec2 m = morph / vUv.xy;\n\t\t\t\tvec2 rot = vec2( 0.5 + m.x, m.y );\n\t\t\t\tvec2 dt = vec2(\n\t\t\t\t\tcos( angle ) * rot.x - sin( angle ) * rot.y,\n\t\t\t\t\tsin( angle ) * rot.x + cos( angle ) * rot.y\n\t\t\t\t);\n\t\t\t\tvec2 pt = ( vUv - 0.5 + offset ) / 2.0 + dt / 2.0;\n\t\t\t\tfloat t = dot( pt, dt ) / dot( dt, dt );\n\t\t\t\tif ( gradientType == 1 ) {\n\t\t\t\t\tt = distance (\n\t\t\t\t\t\t( vUv + morph ) * 3.0,\n\t\t\t\t\t\t( vUv + offset ) + 1.0\n\t\t\t\t\t) + angle;\n\t\t\t\t} else if ( gradientType == 2 ) {\n\t\t\t\t\tfloat polar = atan(\n\t\t\t\t\t\tvUv.x + morph.x - 0.5 + offset.x,\n\t\t\t\t\t\tvUv.y + morph.y - 0.5 + offset.y\n\t\t\t\t\t) * -1.0;\n\t\t\t\t\tt = fract( ( angle / PI / -2.0 ) + 0.5 * ( polar / PI ) );\n\t\t\t\t}\n\n\t\t\t\tfloat p;\n\t\t\t\tif (smoothed) {\n\t\t\t\t\tfor ( int i = 1; i < GRAD_MAX; i++ ) {\n\t\t\t\t\t\tp = clamp( ( t - steps[i-1] ) / ( steps[i] - steps[i-1] ), 0.0, 1.0 );\n\t\t\t\t\t\tcolor = mix(color, colors[i], smoothstep(0.0, 1.0, p));\n\t\t\t\t\t}\n\n\t\t\t\t} else {\n\t\t\t\t\tfor ( int i = 1; i < GRAD_MAX; i++ ) {\n\t\t\t\t\t\tp = clamp( ( t - steps[i-1] ) / ( steps[i] - steps[i-1] ), 0.0, 1.0 );\n\t\t\t\t\t\tcolor = mix(color, colors[i], p);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tfloat lalpha = alpha * color.a * mask;\n\t\t\t\tcalpha = mix(lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0), lalpha, float(isMask));\n\t\t\t\taccumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));\n\t\t\t\t\n\t\t\t\treturn color.xyz;\n\t\t\t}")};var YH=class extends RV{constructor(e,t,n,i,r){super("v3"),this.nodeType="Matcap",this.texture=e,this.isMask=i,this.alpha=t,this.mode=n,this.calpha="g".concat(this.uuid.toString().replace(/-/g,""),"_calpha"),this.rotation=r}generate(e,t){if(e.isShader("fragment")){e.addFragmentVariable(this.calpha,"float");let n=e.include(YH.Nodes.matcap);e.require("normal"),e.requires.normal=!0;let i=[];return i.push(this.texture.generate(e,"t")),i.push("normal"),i.push(this.isMask.build(e,"b")),i.push(this.mask?"luminance(".concat(this.mask.flow(e,"v3").result,")"):"1.0"),i.push(this.alpha.build(e,"f")),i.push(this.mode.build(e,"i")),i.push(this.calpha),i.push(this.rotation.build(e,"f")),e.format(n+"("+i.join(",")+")",this.getType(e),t)}return console.warn("MatcapNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.getType(e),t)}},XH=YH;XH.Nodes={matcap:new WV("vec3 matcap(sampler2D matcapTex, vec3 normal, bool isMask, float mask, float alpha, int mode, out float calpha, float rotation) {\n\t\t\t\t\tvec3 viewDir = normalize( vViewPosition );\n\t\t\t\t\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\t\t\t\t\tvec3 y = cross( viewDir, x );\n\t\t\t\t\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) );\n\t\t\t\t\tuv = mat2( cos(rotation), sin(rotation), -sin(rotation), cos(rotation) ) * uv;\n\t\t\t\t\tuv = uv * 0.495 + 0.5;\n\t\t\t\t\tvec4 matcapColor = texture2D( matcapTex, uv );\n\n\t\t\t\t\tfloat lalpha = alpha * mask;\n\t\t\t\t\tcalpha = mix(lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0), lalpha, float(isMask));\n\t\t\t\t\taccumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));\n\t\t\t\t\t\n\t\t\t\t\treturn matcapColor.rgb;\n            \t}")};var QH=function(){let e=new WV("vec3 random3(vec3 c) {\n\t\t\tfloat j = 4096.0*sin(dot(c,vec3(17.0, 59.4, 15.0)));\n\t\t\tvec3 r;\n\t\t\tr.z = fract(512.0*j);\n\t\t\tj *= .125;\n\t\t\tr.x = fract(512.0*j);\n\t\t\tj *= .125;\n\t\t\tr.y = fract(512.0*j);\n\t\t\treturn r-0.5;\n\t\t}"),t=new WV("float simplexFast(vec3 p) {\n\t\t\t vec3 s = floor(p + dot(p, vec3(F3)));\n\t\t\t mediump vec3 x = p - s + dot(s, vec3(G3));\n\t\t\t mediump vec3 hs = s;\n\t\t\t \n\t\t\t mediump vec3 e = step(vec3(0.0), x - x.yzx);\n\t\t\t mediump vec3 i1 = e*(1.0 - e.zxy);\n\t\t\t mediump vec3 i2 = 1.0 - e.zxy*(1.0 - e);\n\t\t\t\t\n\t\t\t mediump vec3 x1 = x - i1 + G3;\n\t\t\t mediump vec3 x2 = x - i2 + 2.0*G3;\n\t\t\t mediump vec3 x3 = x - 1.0 + 3.0*G3;\n\t\t\t \n\t\t\t mediump vec4 w, d;\n\t\t\t \n\t\t\t w.x = dot(x, x);\n\t\t\t w.y = dot(x1, x1);\n\t\t\t w.z = dot(x2, x2);\n\t\t\t w.w = dot(x3, x3);\n\t\t\t \n\t\t\t w = max(0.6 - w, 0.0);\n\t\t\t \n\t\t\t d.x = dot(random3(hs), x);\n\t\t\t d.y = dot(random3(hs + i1), x1);\n\t\t\t d.z = dot(random3(hs + i2), x2);\n\t\t\t d.w = dot(random3(hs + 1.0), x3);\n\t\t\t \n\t\t\t w *= w;\n\t\t\t w *= w;\n\t\t\t d *= w;\n\t\t\t \n\t\t\t return dot(d, vec4(52.0));\n\t\t}",[e]);t.keywords.F3=new YV("float F3 0.3333333"),t.keywords.G3=new YV("float G3 0.1666667");let n=new WV("float simplexPrecise(vec3 p) {\n\t\t\t vec3 s = floor(p + dot(p, vec3(F3)));\n\t\t\t vec3 x = p - s + dot(s, vec3(G3));\n\t\t\t \n\t\t\t vec3 e = step(vec3(0.0), x - x.yzx);\n\t\t\t vec3 i1 = e*(1.0 - e.zxy);\n\t\t\t vec3 i2 = 1.0 - e.zxy*(1.0 - e);\n\t\t\t\t\n\t\t\t vec3 x1 = x - i1 + G3;\n\t\t\t vec3 x2 = x - i2 + 2.0*G3;\n\t\t\t vec3 x3 = x - 1.0 + 3.0*G3;\n\t\t\t \n\t\t\t vec4 w, d;\n\t\t\t \n\t\t\t w.x = dot(x, x);\n\t\t\t w.y = dot(x1, x1);\n\t\t\t w.z = dot(x2, x2);\n\t\t\t w.w = dot(x3, x3);\n\t\t\t \n\t\t\t w = max(0.6 - w, 0.0);\n\t\t\t \n\t\t\t d.x = dot(random3(s), x);\n\t\t\t d.y = dot(random3(s + i1), x1);\n\t\t\t d.z = dot(random3(s + i2), x2);\n\t\t\t d.w = dot(random3(s + 1.0), x3);\n\t\t\t \n\t\t\t w *= w;\n\t\t\t w *= w;\n\t\t\t d *= w;\n\t\t\t \n\t\t\t return dot(d, vec4(52.0));\n\t\t}",[e]);n.keywords.F3=new YV("float F3 0.3333333"),n.keywords.G3=new YV("float G3 0.1666667");let i=new WV("float simplexFractal(vec3 m) {\n\t\t\tmat3 rot1 = mat3(-0.37, 0.36, 0.85,-0.14,-0.93, 0.34,0.92, 0.01,0.4);\n\t\t\tmat3 rot2 = mat3(-0.55,-0.39, 0.74, 0.33,-0.91,-0.24,0.77, 0.12,0.63);\n\t\t\tmat3 rot3 = mat3(-0.71, 0.52,-0.47,-0.08,-0.72,-0.68,-0.7,-0.45,0.56);\n\t\t\treturn 0.5333333 * simplexFast(m * rot1)\n\t\t\t\t + 0.2666667 * simplexFast(2.0 * m * rot2)\n\t\t\t\t + 0.1333333 * simplexFast(4.0 * m * rot3)\n\t\t\t\t + 0.0666667 * simplexFast(8.0 * m);\n\t\t}",[t]),r=new WV("vec4 permute(vec4 x){return mod(((x*34.0)+1.0)*x, 289.0);}"),s=new WV("vec4 taylorInvSqrt(vec4 r){return 1.79284291400159 - 0.85373472095314 * r;}"),a=new WV("float simplexAshima(vec3 v) {\n\t\t  const vec2  C = vec2(1.0/6.0, 1.0/3.0) ;\n\t\t  const vec4  D = vec4(0.0, 0.5, 1.0, 2.0);\n\t\t  vec3 i  = floor(v + dot(v, C.yyy) );\n\t\t  vec3 x0 =   v - i + dot(i, C.xxx) ;\n\t\t  vec3 g = step(x0.yzx, x0.xyz);\n\t\t  vec3 l = 1.0 - g;\n\t\t  vec3 i1 = min( g.xyz, l.zxy );\n\t\t  vec3 i2 = max( g.xyz, l.zxy );\n\t\t  vec3 x1 = x0 - i1 + 1.0 * C.xxx;\n\t\t  vec3 x2 = x0 - i2 + 2.0 * C.xxx;\n\t\t  vec3 x3 = x0 - 1. + 3.0 * C.xxx;\n\t\t  i = mod(i, 289.0 ); \n\t\t  vec4 p = permute( permute( permute( \n\t\t\t\t\t i.z + vec4(0.0, i1.z, i2.z, 1.0 ))\n\t\t\t\t   + i.y + vec4(0.0, i1.y, i2.y, 1.0 )) \n\t\t\t\t   + i.x + vec4(0.0, i1.x, i2.x, 1.0 ));\n\t\t  float n_ = 1.0/7.0; // N=7\n\t\t  vec3  ns = n_ * D.wyz - D.xzx;\n\t\t  vec4 j = p - 49.0 * floor(p * ns.z *ns.z);  //  mod(p,N*N)\n\t\t  vec4 x_ = floor(j * ns.z);\n\t\t  vec4 y_ = floor(j - 7.0 * x_ );    // mod(j,N)\n\t\t  vec4 x = x_ *ns.x + ns.yyyy;\n\t\t  vec4 y = y_ *ns.x + ns.yyyy;\n\t\t  vec4 h = 1.0 - abs(x) - abs(y);\n\t\t  vec4 b0 = vec4( x.xy, y.xy );\n\t\t  vec4 b1 = vec4( x.zw, y.zw );\n\t\t  vec4 s0 = floor(b0)*2.0 + 1.0;\n\t\t  vec4 s1 = floor(b1)*2.0 + 1.0;\n\t\t  vec4 sh = -step(h, vec4(0.0));\n\t\t  vec4 a0 = b0.xzyw + s0.xzyw*sh.xxyy ;\n\t\t  vec4 a1 = b1.xzyw + s1.xzyw*sh.zzww ;\n\t\t  vec3 p0 = vec3(a0.xy,h.x);\n\t\t  vec3 p1 = vec3(a0.zw,h.y);\n\t\t  vec3 p2 = vec3(a1.xy,h.z);\n\t\t  vec3 p3 = vec3(a1.zw,h.w);\n\t\t  vec4 norm = taylorInvSqrt(vec4(dot(p0,p0), dot(p1,p1), dot(p2, p2), dot(p3,p3)));\n\t\t  p0 *= norm.x;\n\t\t  p1 *= norm.y;\n\t\t  p2 *= norm.z;\n\t\t  p3 *= norm.w;\n\t\t  vec4 m = max(0.6 - vec4(dot(x0,x0), dot(x1,x1), dot(x2,x2), dot(x3,x3)), 0.0);\n\t\t  m = m * m;\n\t\t  return 42.0 * dot( m*m, vec4( dot(p0,x0), dot(p1,x1), \n\t\t\t\t\t\t\t\t\t\tdot(p2,x2), dot(p3,x3) ) );\n\t\t}",[r,s]),o=new WV("vec4 mod289(vec4 x){return x - floor(x * (1.0 / 289.0)) * 289.0;}"),l=new WV("vec4 perm(vec4 x){return mod289(((x * 34.0) + 1.0) * x);}",[o]),u=new WV("float noise(vec3 p){\n\t\t\tvec3 a = floor(p);\n\t\t\tvec3 d = p - a;\n\t\t\td = d * d * (3.0 - 2.0 * d);\n\t\t\tvec4 b = a.xxyy + vec4(0.0, 1.0, 0.0, 1.0);\n\t\t\tvec4 k1 = perm(b.xyxy);\n\t\t\tvec4 k2 = perm(k1.xyxy + b.zzww);\n\t\t\tvec4 c = k2 + a.zzzz;\n\t\t\tvec4 k3 = perm(c);\n\t\t\tvec4 k4 = perm(c + 1.0);\n\t\t\tvec4 o1 = fract(k3 * (1.0 / 41.0));\n\t\t\tvec4 o2 = fract(k4 * (1.0 / 41.0));\n\t\t\tvec4 o3 = o2 * d.z + o1 * (1.0 - d.z);\n\t\t\tvec2 o4 = o3.yw * d.x + o3.xz * (1.0 - d.x);\n\t\t\treturn o4.y * d.y + o4.x * (1.0 - d.y);\n\t\t}",[l]),c=new WV("float fbm(vec3 x) {\n\t\t\tfloat v = 0.0;\n\t\t\tfloat a = 0.5;\n\t\t\tvec3 shift = vec3(100);\n\t\t\tfor (int i = 0; i < NUM_OCTAVES; ++i) {\n\t\t\t\tv += a * noise(x);\n\t\t\t\tx = x * 2.0 + shift;\n\t\t\t\ta *= 0.5;\n\t\t\t}\n\t\t\treturn v;\n\t\t}",[u]);c.keywords.NUM_OCTAVES=new YV("int NUM_OCTAVES ".concat(5));let h=new WV("vec3 fade(vec3 t) {return t*t*t*(t*(t*6.0-15.0)+10.0);}"),d=new WV("float perlin(vec3 P){\n\t\t  vec3 Pi0 = floor(P);\n\t\t  vec3 Pi1 = Pi0 + vec3(1.0);\n\t\t  Pi0 = mod(Pi0, 289.0);\n\t\t  Pi1 = mod(Pi1, 289.0);\n\t\t  vec3 Pf0 = fract(P);\n\t\t  vec3 Pf1 = Pf0 - vec3(1.0);\n\t\t  vec4 ix = vec4(Pi0.x, Pi1.x, Pi0.x, Pi1.x);\n\t\t  vec4 iy = vec4(Pi0.yy, Pi1.yy);\n\t\t  vec4 iz0 = Pi0.zzzz;\n\t\t  vec4 iz1 = Pi1.zzzz;\n\t\t  vec4 ixy = permute(permute(ix) + iy);\n\t\t  vec4 ixy0 = permute(ixy + iz0);\n\t\t  vec4 ixy1 = permute(ixy + iz1);\n\t\t  vec4 gx0 = ixy0 / 7.0;\n\t\t  vec4 gy0 = fract(floor(gx0) / 7.0) - 0.5;\n\t\t  gx0 = fract(gx0);\n\t\t  vec4 gz0 = vec4(0.5) - abs(gx0) - abs(gy0);\n\t\t  vec4 sz0 = step(gz0, vec4(0.0));\n\t\t  gx0 -= sz0 * (step(0.0, gx0) - 0.5);\n\t\t  gy0 -= sz0 * (step(0.0, gy0) - 0.5);\n\t\t  vec4 gx1 = ixy1 / 7.0;\n\t\t  vec4 gy1 = fract(floor(gx1) / 7.0) - 0.5;\n\t\t  gx1 = fract(gx1);\n\t\t  vec4 gz1 = vec4(0.5) - abs(gx1) - abs(gy1);\n\t\t  vec4 sz1 = step(gz1, vec4(0.0));\n\t\t  gx1 -= sz1 * (step(0.0, gx1) - 0.5);\n\t\t  gy1 -= sz1 * (step(0.0, gy1) - 0.5);\n\t\t  vec3 g000 = vec3(gx0.x,gy0.x,gz0.x);\n\t\t  vec3 g100 = vec3(gx0.y,gy0.y,gz0.y);\n\t\t  vec3 g010 = vec3(gx0.z,gy0.z,gz0.z);\n\t\t  vec3 g110 = vec3(gx0.w,gy0.w,gz0.w);\n\t\t  vec3 g001 = vec3(gx1.x,gy1.x,gz1.x);\n\t\t  vec3 g101 = vec3(gx1.y,gy1.y,gz1.y);\n\t\t  vec3 g011 = vec3(gx1.z,gy1.z,gz1.z);\n\t\t  vec3 g111 = vec3(gx1.w,gy1.w,gz1.w);\n\t\t  vec4 norm0 = taylorInvSqrt(vec4(dot(g000, g000), dot(g010, g010), dot(g100, g100), dot(g110, g110)));\n\t\t  g000 *= norm0.x;\n\t\t  g010 *= norm0.y;\n\t\t  g100 *= norm0.z;\n\t\t  g110 *= norm0.w;\n\t\t  vec4 norm1 = taylorInvSqrt(vec4(dot(g001, g001), dot(g011, g011), dot(g101, g101), dot(g111, g111)));\n\t\t  g001 *= norm1.x;\n\t\t  g011 *= norm1.y;\n\t\t  g101 *= norm1.z;\n\t\t  g111 *= norm1.w;\n\t\t  float n000 = dot(g000, Pf0);\n\t\t  float n100 = dot(g100, vec3(Pf1.x, Pf0.yz));\n\t\t  float n010 = dot(g010, vec3(Pf0.x, Pf1.y, Pf0.z));\n\t\t  float n110 = dot(g110, vec3(Pf1.xy, Pf0.z));\n\t\t  float n001 = dot(g001, vec3(Pf0.xy, Pf1.z));\n\t\t  float n101 = dot(g101, vec3(Pf1.x, Pf0.y, Pf1.z));\n\t\t  float n011 = dot(g011, vec3(Pf0.x, Pf1.yz));\n\t\t  float n111 = dot(g111, Pf1);\n\t\t  vec3 fade_xyz = fade(Pf0);\n\t\t  vec4 n_z = mix(vec4(n000, n100, n010, n110), vec4(n001, n101, n011, n111), fade_xyz.z);\n\t\t  vec2 n_yz = mix(n_z.xy, n_z.zw, fade_xyz.y);\n\t\t  float n_xyz = mix(n_yz.x, n_yz.y, fade_xyz.x); \n\t\t  return 2.2 * n_xyz;\n\t\t}",[r,s,h]),p=new WV("float hashwithoutsine13(vec3 p3)\n\t\t{\n\t\t\tp3  = fract(p3 * .1031);\n\t\t\tp3 += dot(p3, p3.yzx + 33.33);\n\t\t\treturn fract((p3.x + p3.y) * p3.z);\n\t\t}"),f=new WV("vec3 hashwithoutsine33(vec3 p3)\n\t\t{\n\t\t\tp3 = fract(p3 * vec3(.1031, .1030, .0973));\n\t\t\tp3 += dot(p3, p3.yxz+33.33);\n\t\t\treturn fract((p3.xxy + p3.yxx)*p3.zyx);\n\t\t}"),m=new WV("float metric(in vec3 p)\n\t\t{\n\t\t\t// L2 \n\t\t\treturn length(p);\n\n\t\t\t// Chebyshev \n\t\t\t// vec3 a = abs(p);\n\t\t\t// return max(a.x, max(a.y, a.z));\n\t\t}"),g=new WV("float smin( float a, float b, float k )\n\t\t{\n\t\t\tfloat h = smoothstep(0.0, 1.0, 0.5 + 0.5 * (b - a) / k);\n\t\t\tfloat correction = k * h * (1.0 - h);\n\t\t\treturn mix(b, a, h) - correction;\n\t\t}"),v=new WV("float smax( float a, float b, float k )\n\t\t{\n\t\t\tfloat h = smoothstep(1.0, 0.0, 0.5 + 0.5 * (a - b) / k);\n\t\t\tfloat correction = k * h * (1.0 - h);\n\t\t\treturn mix(a, b, h) + correction;\n\t\t}"),y=new WV("float remap(float value, float input_min, float input_max, float output_min, float output_max) {\n\t\t\t// Compute width of each interval\n\t\t\tfloat input_width = input_max - input_min;\n\t\t\tfloat output_width = output_max - output_min;\n\t\t\n\t\t\t// Convert input range into a 0-1 range \n\t\t\tfloat scaled = (value - input_min) / input_width;\n\t\t\n\t\t\t// Convert the 0-1 range into a value in output range\n\t\t\treturn output_min + (scaled * output_width);\n\t\t}");return{simplexFast:t,simplexPrecise:n,simplexFractal:i,simplexAshima:a,fbm:c,perlin:d,voronoi:new WV('float voronoi(in vec3 x, in int style, in float smoothness, in float seed, in int quality) \n\t\t{\n\t\t\t// Integer and fractional parts of this point\'s coordinates\n\t\t\tivec3 p = ivec3(floor(x));\n\t\t\tvec3 f = fract(x);\n\n\t\t\t// Different variables that we will use to construct noise:\n\t\t\t//\n\t\t\t// f1: distance to the closest feature point\n\t\t\t// f2: distance to the second closest feature point\n\t\t\t// e: distance to the closest edge (cell boundary)\n\t\t\t//\n\t\t\t// We also compute "smooth" versions of all of the above quantites, essentially\n\t\t\t// replacing "hard" minimums with "smooth" minimums (described by IQ)\n\t\t\tfloat f1_smooth = 8.0;\n\t\t\tfloat f1 = 8.0;\n\t\t\tfloat f2_smooth = 8.0;\n\t\t\tfloat f2 = 8.0;\n\t\t\tfloat e_smooth = 8.0;\n\t\t\tfloat e = 8.0;\n\n\t\t\t// Variables stored from closest cell\n\t\t\tivec3 mb;\n\t\t\tvec3 mr; \n\n\t\t\tint steps = quality;\n\t\t\t\n\t\t\tfor (int x = -steps; x <= steps; x++) \n\t\t\tfor (int y = -steps; y <= steps; y++)\n\t\t\tfor (int z = -steps; z <= steps; z++)\n\t\t\t{\n\t\t\t\tivec3 b = ivec3(x, y, z);\n\t\t\t\tvec3 r = vec3(b) + hashwithoutsine33(vec3(p + b) + seed) - f;\n\t\t\t\tfloat d = length(r);\n\t\t\t\t\n\t\t\t\tf1_smooth = smin(d, f1_smooth, smoothness);\n\n\t\t\t\t// Store un-smoothed distances too \n\t\t\t\tif (d < f1) \n\t\t\t\t{\n\t\t\t\t\tf2 = f1;\n\t\t\t\t\tf1 = d;\n\n\t\t\t\t\tmb = ivec3(x, y, z);\n\t\t\t\t\tmr = r;\n\t\t\t\t} \n\t\t\t\telse if (d < f2) \n\t\t\t\t{\n\t\t\t\t\tf2 = d;\n\t\t\t\t}\n\t\t\t}\t\n\t\t\t\n\t\t\t// Second pass for edge distance  \n\t\t\t// skip for styles don\'t need\n\t\t\tif (style != 0 &&  style != 5 && style != 7)\n\t\t\tfor (int x = -steps; x <= steps; x++) \n\t\t\tfor (int y = -steps; y <= steps; y++)\n\t\t\tfor (int z = -steps; z <= steps; z++)\n\t\t\t{\n\t\t\t\t// Start search at the cell that contains the closest point to "x" (found in 1st pass)\n\t\t\t\tivec3 b = mb + ivec3(x, y, z);\n\t\t\t\tvec3 r = vec3(b) + hashwithoutsine33(vec3(p + b) + seed) - f;\n\t\t\t\tfloat d1 = dot(0.5 * (mr + r), (r - mr)); \t\t\t\t// IQ normalizes "r - mr" but that breaks things for the smooth version?\n\t\t\t\tfloat d2 = dot(0.5 * (mr + r), normalize(r - mr));\n\n\t\t\t\te_smooth = smin(d1, e_smooth, smoothness);\n\n\t\t\t\te = min(e, d2);\n\n\t\t\t\t// Also compute a smooth version of F2 in this pass\n\t\t\t\t{\n\t\t\t\t\tivec3 b = ivec3(x, y, z);\n\t\t\t\t\tif (b != mb) \n\t\t\t\t\t{\n\t\t\t\t\t\tvec3 r = vec3(b) + hashwithoutsine33(vec3(p + b) + seed) - f;\n\t\t\t\t\t\tfloat d = length(r);\n\n\t\t\t\t\t\tf2_smooth = smin(d, f2_smooth, smoothness);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Different visualization modes \n\t\t\tif (style == 0) \n\t\t\t{\n\t\t\t\treturn f1_smooth;\n\t\t\t}\n\t\t\tif (style == 1) \n\t\t\t{\n\t\t\t\treturn f2_smooth;\n\t\t\t}\n\t\t\tif (style == 2) \n\t\t\t{\n\t\t\t\treturn f2_smooth - f1_smooth;\n\t\t\t\t\n\t\t\t\t// "Pebbles" also cool\n\t\t\t\t//return step(0.2, f2_smooth - f1_smooth);\n\t\t\t}\n\t\t\tif (style == 3) \n\t\t\t{\n\t\t\t\t// This one is really good for rock / stone effects\n\t\t\t\tfloat a = f1; \n\t\t\t\tfloat b = f2;\n\t\t\t\tfloat k = 3.0;\n\t\t\t\tfloat h = max(k - abs(a - b), 0.0) / k;\n\t\t\t\tfloat final = min(a, b) - h * h * k * (1.0 / 4.0);\n\t\t\t\treturn final;\n\t\t\t}\n\t\t\tif (style == 4) \n\t\t\t{\n\t\t\t\t// Some random adjustments to make this style stand out more \n\t\t\t\treturn exp(5.0 * e_smooth);\n\t\t\t}\n\t\t\tif (style == 5) \n\t\t\t{\n\t\t\t\treturn pow(f1_smooth, 3.0);\n\t\t\t}\n\t\t\tif (style == 6) \n\t\t\t{\t\t\t\t\n\t\t\t\tconst float eps = 0.0125;\n\n\t\t\t\t// Thicker lines as the user increases the smoothness slider\n\t\t\t\tfloat thickness = smoothness * 0.25 + eps;\n\n\t\t\t\t// Blurrier lines as the user increases the smoothness slider\n\t\t\t\tfloat blur = pow(smoothness, 3.0) * 0.25 + eps;\n\n\t\t\t\treturn smoothstep(\n\t\t\t\t\tthickness - thickness * blur, \n\t\t\t\t\tthickness + thickness * blur, \n\t\t\t\t\te\n\t\t\t\t);\n\t\t\t}\n\t\t\tif (style == 7) \n\t\t\t{\n\t\t\t\treturn hashwithoutsine13(vec3(p + mb) + seed);\n\t\t\t}\n\t\t}\n\t',[p,f,m,g,v,y])}}(),KH=class extends RV{constructor(e,t,n,i,r,s,a,o,l,u,c,h,d,p,f,m,g,v,y){super("v3"),this.nodeType="Noise",this.scale=e,this.size=t,this.move=n,this.fA=i,this.fB=r,this.distortion=s,this.colorA=a,this.colorB=o,this.colorC=l,this.colorD=u,this.noiseType=h,this.voronoiStyle=p,this.highCut=f,this.lowCut=m,this.smoothness=g,this.seed=v,this.quality=y,this.isMask=d,this.alpha=c,this.calpha="g".concat(this.uuid.toString().replace(/-/g,""),"_calpha")}generate(e,t,n,i,r){e.require("uv"),e.requires.uv=[!0],e.addFragmentVariable(this.calpha,"float");let s=["simplexFast","simplexFractal","simplexAshima","fbm","perlin","voronoi"][this.noiseType.value],a="voronoi"==s?"\n\t\tfloat v = ".concat(s,'(st + move, voronoiStyle, smoothness, seed, quality);\n\n\t\t// Apply clipping to colors\n\t\tv = remap(v, lowCut, highCut, 0.0, 1.0);\n\t\tv = smax(v, 0.0, smoothness * 0.25);\n\t\tv = smin(v, 1.0, smoothness * 0.25);\n\n\t\t// Note that the voronoi mode only uses colors "A" and "C" from the UI \n\t\tvec4 color = mix(colorA, colorC, v); \n\t\t'):"\n\t\tvec3 q = vec3(".concat(s,"(st),\n\t\t\t\t\t   ").concat(s,"(st + vec3(1.0)),\n\t\t\t\t\t   ").concat(s,"(st + vec3(1.0)));\n\t\tvec3 r = vec3(").concat(s,"(st + vec3(distortion, 1.0) * q + vec3(fA, 1.0) + move),\n\t\t\t\t\t  ").concat(s,"(st + vec3(distortion, 1.0) * q + vec3(fB, 1.0) + move), \n\t\t\t\t\t  ").concat(s,"(st * q));\n\t\tfloat f = ").concat(s,"(st + r);\n\t\tvec4 color;\n\t\tcolor = mix(colorA, colorB, clamp((f * f) * 4.0, 0.0, 1.0));\n\t\tcolor = mix(color, colorC, clamp(length(q), 0.0, 1.0));\n\t\tcolor = mix(color, colorD, clamp(length(r.x), 0.0, 1.0));\n\t\t"),o=new WV("vec3 ".concat(s,"customNoise(float scale, vec3 size, float move, vec2 fA, vec2 fB, vec2 distortion, vec4 colorA, vec4 colorB, vec4 colorC, vec4 colorD, int voronoiStyle, float highCut, float lowCut, float smoothness, float seed, int quality, bool isMask, float mask, float alpha, out float calpha) \n\t\t\t{\n                // Prevent scale of zero \n\t\t\t\tscale = max(abs(scale), 0.001);\n\n\t\t\t\tvec3 st = position / size;\n\t\t\t\tst /= scale;\n\n\t\t\t\t").concat(a,"\n\n\t\t\t\tfloat lalpha = alpha * color.a * mask;\n\t\t\t\tcalpha = mix(lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0), lalpha, float(isMask));\n\t\t\t\taccumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));\n\n\t\t\t\treturn clamp(color, 0.0, 1.0).rgb;\n\t\t\t}"),[QH.simplexFast,QH.simplexFractal,QH.simplexAshima,QH.fbm,QH.perlin,QH.voronoi]),l=e.include(o),u=[];return u.push(this.scale.build(e,"f")),u.push(this.size.build(e,"v3")),u.push(this.move.build(e,"f")),u.push(this.fA.build(e,"v2")),u.push(this.fB.build(e,"v2")),u.push(this.distortion.build(e,"v2")),u.push(this.colorA.build(e,"v4")),u.push(this.colorB.build(e,"v4")),u.push(this.colorC.build(e,"v4")),u.push(this.colorD.build(e,"v4")),u.push(this.voronoiStyle.build(e,"i")),u.push(this.highCut.build(e,"f")),u.push(this.lowCut.build(e,"f")),u.push(this.smoothness.build(e,"f")),u.push(this.seed.build(e,"f")),u.push(this.quality.build(e,"i")),u.push(this.isMask.build(e,"b")),u.push(this.mask?"luminance(".concat(this.mask.flow(e,"v3").result,")"):"1.0"),u.push(this.alpha.build(e,"f")),u.push(this.calpha),e.format(l+"("+u.join(",")+")",this.getType(e),t)}};KH.numOctaves=5;var ZH=class extends RV{constructor(e,t,n,i,r,s,a,o,l,u,c,h,d,p,f,m){super("v3"),this.nodeType="Outline",this.firstTime=!0,this.outlineColor=e,this.contourColor=t,this.outlineWidth=n,this.contourWidth=i,this.contourThreshold=r,this.outlineThreshold=s,this.contourFrequency=a,this.outlineSmoothing=o,this.contourDirection=l,this.positionalLines=u,this.compensation=c,this.resolution=h,this.normalMap=d,this.depthMap=p,this.pixelRatio=f,this.alpha=m,this.calpha="g".concat(this.uuid.toString().replace(/-/g,""),"_calpha")}generate(e,t){let n="g".concat(this.uuid.toString().replace(/-/g,""));if(e.require("vWorldViewDir"),e.require("worldNormal"),e.extensions.derivatives=!0,this.compensation.value&&e.define("OUTLINE_COMPENSATION","".concat(n,"_offset")),this.firstTime){let t=this.outlineWidth.build(e,"f"),i=this.resolution.build(e,"v2"),r=this.compensation.build(e,"b"),s=this.pixelRatio.build(e,"f");e.addVertexParsVariable("randomColor","attribute vec3"),e.addVertexParsVariable("extrudeNormal","attribute vec3"),e.addVertexParsVariable(t,"uniform float"),e.addVertexParsVariable(i,"uniform vec2"),e.addVertexParsVariable(r,"uniform bool"),e.addVertexParsVariable(s,"uniform float"),e.addVertexParsVariable("vID","flat out float"),e.addFragmentParsVariable("vID","flat in float"),e.addVertexFinalCode("\n                vID = randomColor.r;\n                vec2 ".concat(n,"_offset = vec2(0.0);\n                if (").concat(r,") {\n                    vec4 ").concat(n,"_clipPosition = projectionMatrix * (modelViewMatrix * vec4(transformed, 1.0));\n                    // NOTE: For certain shapes, like spheres, we get incorrect extrusion when the\n                    // normals face the camera directly. So we hackily fix this by offsetting the normal\n                    // by a tiny amount.\n                    vec3 ").concat(n,"_clipNormal = mat3(projectionMatrix) * (mat3(modelViewMatrix) * extrudeNormal) + 0.0000001;\n                    ").concat(n,"_offset = normalize(").concat(n,"_clipNormal.xy) / ").concat(i," * (").concat(t," / 2.0) * ").concat(n,"_clipPosition.w * 2.0 * ").concat(s,";\n                    ").concat(n,"_clipPosition.xy += ").concat(n,"_offset;\n                    // TODO(MAX): To handle multiple outline layers, we only want to extrude\n                    // if this offset is the biggest of all the potential offsets\n                    gl_Position = ").concat(n,"_clipPosition;\n                }\n            "))}if(e.isShader("fragment")){e.require("uv"),e.requires.uv=[!0],e.addFragmentVariable(this.calpha,"float");let n=e.include(ZH.Nodes.outline),i=[];return i.push(this.outlineColor.build(e,"c")),i.push(this.contourColor.build(e,"c")),i.push(this.outlineWidth.build(e,"f")),i.push(this.contourWidth.build(e,"f")),i.push(this.contourThreshold.build(e,"f")),i.push(this.outlineThreshold.build(e,"f")),i.push(this.contourFrequency.build(e,"f")),i.push(this.outlineSmoothing.build(e,"f")),i.push(this.contourDirection.build(e,"v3")),i.push(this.positionalLines.build(e,"b")),i.push(this.resolution.build(e,"v2")),i.push(this.normalMap.getTexture(e,"t")),i.push(this.depthMap.getTexture(e,"t")),i.push(this.pixelRatio.build(e,"f")),i.push(this.compensation.build(e,"b")),i.push(this.mask?"luminance(".concat(this.mask.flow(e,"v3").result,")"):"1.0"),i.push(this.alpha.build(e,"f")),i.push(this.calpha),this.firstTime=!this.firstTime,e.format(n+"("+i.join(",")+")",this.getType(e),t)}return console.warn("OutlineNode is not compatible with "+e.shader+" shader."),""}},JH=ZH;JH.Nodes=function(){let e=new WV("\nfloat sobelSample(sampler2D t, sampler2D d, vec2 uv, vec2 resolution, float outlineWidth, float pixelRatio)\n{\n    vec2 halton = haltonSequence[frameIndex];\n    float temporalOffset = getNoiseInterleavedGradient(gl_FragCoord.xy + halton);\n    float temporalAngle  = temporalOffset * PI2;\n\n    vec2 texelSize = (vec2(1.0) / resolution);\n    vec2 offsetSize = texelSize * outlineWidth * pixelRatio;\n\n    vec2 uvSamples[9];\n    vec4 normalSamples[9];\n\n\tuvSamples[0] = uv + vec2( -offsetSize.x, -offsetSize.y) + (vogelDiskSample(0, 9, temporalAngle) * texelSize);\n\tuvSamples[1] = uv + vec2(0.0, -offsetSize.y) + (vogelDiskSample(1, 9, temporalAngle) * texelSize);\n\tuvSamples[2] = uv + vec2(  offsetSize.x, -offsetSize.y) + (vogelDiskSample(2, 9, temporalAngle) * texelSize);\n\tuvSamples[3] = uv + vec2( -offsetSize.x, 0.0) + (vogelDiskSample(3, 9, temporalAngle) * texelSize);\n\tuvSamples[4] = uv;\n\tuvSamples[5] = uv + vec2(  offsetSize.x, 0.0) + (vogelDiskSample(5, 9, temporalAngle) * texelSize);\n\tuvSamples[6] = uv + vec2( -offsetSize.x, offsetSize.y) + (vogelDiskSample(6, 9, temporalAngle) * texelSize);\n\tuvSamples[7] = uv + vec2(0.0, offsetSize.y) + (vogelDiskSample(7, 9, temporalAngle) * texelSize);\n\tuvSamples[8] = uv + vec2(  offsetSize.x, offsetSize.y) + (vogelDiskSample(8, 9, temporalAngle) * texelSize);\n\n\n    normalSamples[0] = texture2D(t, uvSamples[0]);\n    normalSamples[1] = texture2D(t, uvSamples[1]);\n    normalSamples[2] = texture2D(t, uvSamples[2]);\n    normalSamples[3] = texture2D(t, uvSamples[3]);\n    normalSamples[4] = texture2D(t, uvSamples[4]);\n    normalSamples[5] = texture2D(t, uvSamples[5]);\n    normalSamples[6] = texture2D(t, uvSamples[6]);\n    normalSamples[7] = texture2D(t, uvSamples[7]);\n    normalSamples[8] = texture2D(t, uvSamples[8]);\n\n    float depthBias = 0.0001;\n    // TODO(MAX): Can we somehow reduce the number of conditionals here with MATH?!\n    if (normalSamples[0].a != vID && normalSamples[0].a != 0.0) {\n        float depthAtSample = texture2D(d, uvSamples[0]).r + depthBias;\n        if (gl_FragCoord.z > depthAtSample) {\n           return 0.0;\n        }\n    }\n\n    if (normalSamples[1].a != vID && normalSamples[1].a != 0.0) {\n        float depthAtSample = texture2D(d, uvSamples[1]).r + depthBias;\n        if (gl_FragCoord.z > depthAtSample) {\n           return 0.0;\n        }\n    }\n\n    if (normalSamples[2].a != vID && normalSamples[2].a != 0.0) {\n        float depthAtSample = texture2D(d, uvSamples[2]).r + depthBias;\n        if (gl_FragCoord.z > depthAtSample) {\n           return 0.0;\n        }\n    }\n\n    if (normalSamples[3].a != vID && normalSamples[3].a != 0.0) {\n        float depthAtSample = texture2D(d, uvSamples[3]).r + depthBias;\n        if (gl_FragCoord.z > depthAtSample) {\n           return 0.0;\n        }\n    }\n\n\n    if (normalSamples[4].a != vID && normalSamples[4].a != 0.0) {\n        float depthAtSample = texture2D(d, uvSamples[4]).r + depthBias;\n        if (gl_FragCoord.z > depthAtSample) {\n           return 0.0;\n        }\n    }\n\n    if (normalSamples[5].a != vID && normalSamples[5].a != 0.0) {\n        float depthAtSample = texture2D(d, uvSamples[5]).r + depthBias;\n        if (gl_FragCoord.z > depthAtSample) {\n           return 0.0;\n        }\n    }\n\n    if (normalSamples[6].a != vID && normalSamples[6].a != 0.0) {\n        float depthAtSample = texture2D(d, uvSamples[6]).r + depthBias;\n        if (gl_FragCoord.z > depthAtSample) {\n           return 0.0;\n        }\n    }\n\n    if (normalSamples[7].a != vID && normalSamples[7].a != 0.0) {\n        float depthAtSample = texture2D(d, uvSamples[7]).r + depthBias;\n        if (gl_FragCoord.z > depthAtSample) {\n           return 0.0;\n        }\n    }\n\n    if (normalSamples[8].a != vID && normalSamples[8].a != 0.0) {\n        float depthAtSample = texture2D(d, uvSamples[8]).r + depthBias;\n        if (gl_FragCoord.z > depthAtSample) {\n           return 0.0;\n        }\n    }\n\n    vec3 sobel_edge_h = normalSamples[2].rgb + (2.0*normalSamples[5].rgb) + normalSamples[8].rgb - (normalSamples[0].rgb + (2.0*normalSamples[3].rgb) + normalSamples[6].rgb);\n  \tvec3 sobel_edge_v = normalSamples[0].rgb + (2.0*normalSamples[1].rgb) + normalSamples[2].rgb - (normalSamples[6].rgb + (2.0*normalSamples[7].rgb) + normalSamples[8].rgb);\n\n    float edgeNormal = sqrt(dot(sobel_edge_h, sobel_edge_h) + dot(sobel_edge_v, sobel_edge_v));\n    return edgeNormal;\n}\n");return{outline:new WV("vec3 outline(vec3 outlineColor, vec3 contourColor, float outlineWidth, float contourWidth, float outlineThreshold, float contourThreshold, float outlineSmoothing, float contourFrequency, vec3 contourDirection, bool positionalLines, vec2 resolution, sampler2D normalMap, sampler2D depthMap, float pixelRatio, bool compensation, float mask, float alpha, out float calpha) {\n                vec3 result = outlineColor;\n                float resultAlpha = 0.0;\n\n                vec3 N = normalize(vWNormal);\n                vec2 nuv = (gl_FragCoord.xy / resolution);\n                float sobelSample = compensation ? sobelSample(normalMap, depthMap, nuv, resolution, outlineWidth / 2., pixelRatio) : sobelSample(normalMap, depthMap, nuv, resolution, outlineWidth, pixelRatio);\n                resultAlpha = smoothstep(outlineThreshold - outlineSmoothing, outlineThreshold + outlineSmoothing, sobelSample);\n\n                //resultAlpha = 1.0;\n                //result = vec3(sobelSample);\n\n                float t = 1.0 - contourThreshold;\n                if(positionalLines) {\n                    vec3 NDir = position * contourDirection;\n                    float NT = NDir.x + NDir.y + NDir.z;\n                    float f  = fract(NT * contourFrequency * 0.01);\n                    float df = fwidth(NT * contourFrequency);\n\n                    float g = smoothstep(df * (contourWidth * 0.01), df * (contourWidth * 0.01 * 2.0), f);\n                    if (g < 1.0 && resultAlpha == 0.0) {\n                        result = contourColor;\n                        resultAlpha = 1.0;\n                    }\n                 }\n                 else {\n                    vec3 NDir = N * contourDirection;\n                    float NT = NDir.x + NDir.y + NDir.z;\n                    float df = fwidth(NT * contourThreshold);\n                    float f = sin(NT * 1.0 * contourFrequency);\n                    float g = smoothstep(0.0, df * contourWidth, 1.0 - f);\n\n                    if (df > (t * 0.5) && g < 1.0 && resultAlpha == 0.0) {\n                        result = contourColor;\n                        resultAlpha = 1.0 - g;\n                    }\n                 }\n\n                 float lalpha = alpha * resultAlpha * mask;\n                 calpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );\n                 accumAlpha += ( 1.0 - accumAlpha ) * lalpha;\n\t\t\t\t \n                 return result;\n             }",[e])}}();var $H=class extends RV{constructor(e,t,n,i,r,s,a,o,l,u,c,h,d,p,f,m,g,v){super("v3"),this.nodeType="Pattern",this.style=e,this.projection=t,this.axis=n,this.blending=i,this.offset=r,this.colorA=s,this.colorB=a,this.frequency=o,this.size=l,this.variation=u,this.smoothness=c,this.zigzag=h,this.rotation=d,this.vertical=p,this.horizontal=f,this.sides=m,this.isMask=v,this.alpha=g,this.calpha="g".concat(this.uuid.toString().replace(/-/g,""),"_calpha")}generate(e,t){if(e.isShader("fragment")){let n;switch(e.require("position"),e.require("uv"),e.requires.uv=[!0],e.require("normal"),e.requires.normal=!0,e.addFragmentVariable(this.calpha,"float"),this.style.value){case 0:default:n="circle";break;case 1:n="ring";break;case 2:n="polygon";break;case 3:n="xcross";break;case 4:n="diamond";break;case 5:n="checkerboard";break;case 6:n="line";break;case 7:n="wave"}let i="g".concat(this.uuid.toString().replace(/-/g,"")),r=new WV("float hashwithoutsine12(vec2 p)\n\t\t\t\t{\n\t\t\t\t\tvec3 p3 = fract(vec3(p.xyx) * .1031);\n\t\t\t\t\tp3 += dot(p3, p3.yzx + 33.33);\n\t\t\t\t\treturn fract((p3.x + p3.y) * p3.z);\n\t\t\t\t}"),s=new WV("vec2 rotate_uv(in vec2 uv, float a, bool repeat) \n\t\t\t\t{\n\t\t\t\t\tconst float mid = 0.5;\n\t\t\t\t\tfloat radians = a * (PI / 180.0);\n\t\t\t\t\tvec2 rotated = vec2(\n\t\t\t\t\t\tcos(radians) * (uv.x - mid) + sin(radians) * (uv.y - mid) + mid,\n\t\t\t\t\t\tcos(radians) * (uv.y - mid) - sin(radians) * (uv.x - mid) + mid\n\t\t\t\t\t);\n\t\t\t\t\treturn repeat ? fract(rotated): rotated;\n\t\t\t\t}"),a="";if(4===this.projection.value){let e=2===this.style.value?"".concat(n,"(uv0, frequency, size, variation, smoothness_remapped, zigzag, rotation, sides)"):"".concat(n,"(uv0, frequency, size, variation, smoothness_remapped, zigzag, rotation)"),t=2===this.style.value?"".concat(n,"(uv1, frequency, size, variation, smoothness_remapped, zigzag, rotation, sides)"):"".concat(n,"(uv1, frequency, size, variation, smoothness_remapped, zigzag, rotation)"),i=2===this.style.value?"".concat(n,"(uv2, frequency, size, variation, smoothness_remapped, zigzag, rotation, sides)"):"".concat(n,"(uv2, frequency, size, variation, smoothness_remapped, zigzag, rotation)");a="\n\t\t\t\tvec3 p = position;\n\t\t\t\tfloat factor = 0.0125;\n\t\t\t\tvec2 uv0 = fract(p.xy * factor);\n\t\t\t\tvec2 uv1 = fract(p.zy * factor);\n\t\t\t\tvec2 uv2 = fract(p.xz * factor);\n\t\t\t\t\n\t\t\t\tuv0 = rotate_uv(uv0 + offset, rotation, true);\n\t\t\t\tuv1 = rotate_uv(uv1 + offset, rotation, true);\n\t\t\t\tuv2 = rotate_uv(uv2 + offset, rotation, true);\n\t\n\t\t\t\tfloat d0 = ".concat(e,";\n\t\t\t\tfloat d1 = ").concat(t,";\n\t\t\t\tfloat d2 = ").concat(i,";\n\t\t\t\t\n\t\t\t\t// Range from 3 to 128 seems to be good\n\t\t\t\tfloat exponent = (1.0 - blending) * 125.0 + 3.0;\n\n\t\t\t\tvec3 n = vObjectNormal;\n\t\t\t\tvec3 weights = abs(normalize(n));\n\t\t\t\tweights = pow(weights, vec3(exponent));\n\t\t\t\tweights /= dot(weights, vec3(1.0));\n\t\t\t\td0 *= weights.z;\n\t\t\t\td1 *= weights.x;\n\t\t\t\td2 *= weights.y;\n\t\t\t\tfloat draw = d0 + d1 + d2;\n\t\n\t\t\t\tvec2 custom_uv = uv0 * weights.z + uv1 * weights.x + uv2 * weights.y;\n\t\t\t\t")}else{let e=2===this.style.value?"".concat(n,"(custom_uv, frequency, size, variation, smoothness_remapped, zigzag, rotation, sides)"):"".concat(n,"(custom_uv, frequency, size, variation, smoothness_remapped, zigzag, rotation)"),t="";0===this.axis.value?t="float radius = length(p);\n\t\t\t\t\tfloat theta = atan(p.y, p.z);\n\t\t\t\t\tfloat phi = acos(p.x / radius);":1===this.axis.value?t="float radius = length(p);\n\t\t\t\t\tfloat theta = atan(p.x, p.z);\n\t\t\t\t\tfloat phi = acos(p.y / radius);":(this.axis.value,t="float radius = length(p);\n\t\t\t\t\tfloat theta = atan(p.y, p.x);\n\t\t\t\t\tfloat phi = acos(p.z / radius);");let i="";switch(this.projection.value){case 0:i="custom_uv = vUv.st;";break;case 1:case 3:default:break;case 2:i="\n\t\t\t\t\t\t\tvec3 p = position;\n\t\t\t\t\t\t\t".concat(t,"\n\t\t\t\t\t\t\tcustom_uv = vec2(theta, phi);\n\t\t\t\t\t\t\tcustom_uv /= PI;\n\t\t\t\t\t\t\t")}a="\n\t\t\t\tvec2 custom_uv;\n\t\t\t\t".concat(i,"\n\t\n\t\t\t\tcustom_uv += offset;\n\t\t\t\tcustom_uv = fract(custom_uv);\n\t\t\t\tcustom_uv = rotate_uv(custom_uv, rotation, true);\n\t\n\t\t\t\tfloat draw = ").concat(e,";\n\t\t\t\t")}let o=new WV("vec3 ".concat(i,"_pattern(vec3 normal, float blending, int style, vec2 offset, vec4 colorA, vec4 colorB, vec2 frequency, float size, float variation, float smoothness, float zigzag, float rotation, vec2 vertical, vec2 horizontal, int sides, bool isMask, float mask, float alpha, out float calpha) {\n\t\t\t\t\tconst float TWO_PI = PI * 2.0;\n\t\t\t\t\tfloat smoothness_remapped = pow(smoothness, 5.0);\t\n\n\t\t\t\t\t").concat(a,"\n\n\t\t\t\t\t// Construct final output color\n\t\t\t\t\tvec4 color = mix(colorA, colorB, draw);\n\t\t\t\t\tcolor.a = clamp(color.a, 0.0, 1.0);\n\n\t\t\t\t\t// Apply cuts\n\t\t\t\t\tcolor.a *= \n\t\t\t\t\t\tstep(vertical.x, custom_uv.y) * \n\t\t\t\t\t\tstep(custom_uv.y, vertical.y);\n\t\t\t\t\tcolor.a *= \n\t\t\t\t\t\tstep(horizontal.x, abs(custom_uv.x)) * \n\t\t\t\t\t\tstep(abs(custom_uv.x), horizontal.y);\n\n\t\t\t\t\t// Accumulate alpha \n\t\t\t\t\tfloat lalpha = alpha * clamp(color.a, 0.0, 1.0) * mask;\n\t\t\t\t\tcalpha = mix(lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0), lalpha, float(isMask));\n\t\t\t\t\taccumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));\n\n\t\t\t\t\treturn clamp(color, 0.0, 1.0).rgb;\n\t\t\t\t}"),[s,r,$H.DrawFunctions.circle,$H.DrawFunctions.ring,$H.DrawFunctions.polygon,$H.DrawFunctions.cross,$H.DrawFunctions.diamond,$H.DrawFunctions.checkerboard,$H.DrawFunctions.line,$H.DrawFunctions.wave]),l=e.include(o),u=[];return u.push("normal"),u.push(this.blending.build(e,"f")),u.push(this.style.build(e,"i")),u.push(this.offset.build(e,"v2")),u.push(this.colorA.build(e,"v4")),u.push(this.colorB.build(e,"v4")),u.push(this.frequency.build(e,"v2")),u.push(this.size.build(e,"f")),u.push(this.variation.build(e,"f")),u.push(this.smoothness.build(e,"f")),u.push(this.zigzag.build(e,"f")),u.push(this.rotation.build(e,"f")),u.push(this.vertical.build(e,"v2")),u.push(this.horizontal.build(e,"v2")),u.push(this.sides.build(e,"i")),u.push(this.isMask.build(e,"b")),u.push(this.mask?"luminance(".concat(this.mask.flow(e,"v3").result,")"):"1.0"),u.push(this.alpha.build(e,"f")),u.push(this.calpha),e.format(l+"("+u.join(",")+")",this.getType(e),t)}return console.warn("PatterNode is not compatible with "+e.shader+" shader."),e.format("vec3(0.0)",this.getType(e),t)}},eW=$H;eW.DrawFunctions=function(){let e=new WV("float hashwithoutsine12(vec2 p) {\n\t\t\t\tvec3 p3 = fract(vec3(p.xyx) * 0.1031);\n\t\t\t\tp3 += dot(p3, p3.yzx + 33.33);\n\t\t\t\treturn fract((p3.x + p3.y) * p3.z);\n\t\t\t}"),t=new WV("vec2 tile_and_center(in vec2 uv, in vec2 frequency, in float variation, in float zigzag, in float rotation) {\n                // Create tiles in UV-space\n                uv *= frequency;\n\n                // Integer coords\n                vec2 i = floor(uv);\n\n                // Offset every other row based on zigzag param, then compute fractional coords\n                float row_offset = mod(i.y, 2.0);\n                uv.x += row_offset * zigzag;\n                vec2 f = fract(uv);\n\n\t\t\t\t// Rotate the tile itself:\n\t\t\t\t// const float mid = 0.5;\n\t\t\t\t// f = vec2(\n\t\t\t\t// \tcos(rotation) * (f.x - mid) + sin(rotation) * (f.y - mid) + mid,\n\t\t\t\t// \tcos(rotation) * (f.y - mid) - sin(rotation) * (f.x - mid) + mid\n\t\t\t\t// );\n\t\t\t\t// f = fract(f);\n\n                f = f * 2.0 - 1.0;\n\n\t\t\t\t// Recompute integer coords after shifting - then, random value per tile \n\t\t\t\ti = floor(uv);\n\t\t\t\tfloat rand = (hashwithoutsine12(i) * 5.0 + 1.0);\n\t\t\t\tfloat jitter = mix(1.0, rand, variation);\n\t\t\t\tf *= jitter;\n\n                return f;\n            }",[e]);return{tileAndCenter:t,circle:new WV("float circle(in vec2 uv, in vec2 frequency, in float size, in float variation, in float smoothness, in float zigzag, in float rotation) {\n                vec2 f = tile_and_center(uv, frequency, variation, zigzag, rotation);\n                return smoothstep(\n                    -smoothness, \n                     smoothness, \n                     length(f) - size\n                );\n            }",[t]),ring:new WV("float ring(in vec2 uv, in vec2 frequency, in float size, in float variation, in float smoothness, in float zigzag, in float rotation) {\n                vec2 f = tile_and_center(uv, frequency, variation, zigzag, rotation);\n\n\t\t\t\tfloat d = length(f);\n                const float inner_width = 0.5;\n\n                float outer = smoothstep(-smoothness, smoothness, d - size);\n                float inner = smoothstep(-smoothness, smoothness, d - size * inner_width);\n\t\t\t\treturn outer + (1.0 - inner);   \n            }",[t]),polygon:new WV("float sdf_ngon(in vec2 p, in float r, in int n) {\n                float an = (PI * 2.0) / float(n);\n                float he = r * tan(0.5 * an);\n                \n                // Rotate to first sector\n                p = -p.yx; \n                float bn = an * floor((atan(p.y, p.x) + 0.5 * an) / an);\n                vec2  cs = vec2(cos(bn), sin(bn));\n                p = mat2(cs.x, -cs.y, cs.y, cs.x)*p;\n            \n                // Side of polygon\n                return length(p - vec2(r, clamp(p.y, -he, he))) * sign(p.x - r);\n            }\n            \n            float polygon(in vec2 uv, in vec2 frequency, in float size, in float variation, in float smoothness, in float zigzag, in float rotation, in int sides) {\n                vec2 f = tile_and_center(uv, frequency, variation, zigzag, rotation);\n                return smoothstep(-smoothness, smoothness, sdf_ngon(f, size, sides));\n            }",[t]),cross:new WV("float sdf_cross(in vec2 p, in vec2 b, float r ) {\n                p = abs(p); \n\t\t\t\tp = (p.y > p.x) ? p.yx : p.xy;\n                vec2  q = p - b;\n                float k = max(q.y, q.x);\n                vec2  w = (k > 0.0) ? q : vec2(b.y - p.x, -k);\n                return sign(k) * length(max(w, 0.0)) + r;\n            }\n            \n            // Avoid namespace conflicts \n            float xcross(in vec2 uv, in vec2 frequency, in float size, in float variation, in float smoothness, in float zigzag, in float rotation) {\n                vec2 f = tile_and_center(uv, frequency, variation, zigzag, rotation);\n                return smoothstep(-smoothness, smoothness, sdf_cross(f, vec2(size, size * 0.25), smoothness));\n            }",[t]),diamond:new WV("float ndot(vec2 a, vec2 b) { \n                return a.x*b.x - a.y*b.y; \n            }\n            \n            float sdf_diamond(in vec2 p, in vec2 b) {\n                p = abs(p);\n                float h = clamp(ndot(b - 2.0 * p, b) / dot(b, b), -1.0, 1.0);\n                float d = length(p - 0.5 * b * vec2(1.0 - h, 1.0 + h));\n                return d * sign(p.x * b.y + p.y * b.x - b.x * b.y);\n            }\n\n            float diamond(in vec2 uv, in vec2 frequency, in float size, in float variation, in float smoothness, in float zigzag, in float rotation) {\n                vec2 f = tile_and_center(uv, frequency, variation, zigzag, rotation);\n\t            return smoothstep(-smoothness, smoothness, sdf_diamond(f, vec2(size)));\n            }",[t]),checkerboard:new WV("float checkerboard(in vec2 uv, in vec2 frequency, in float size, in float variation, in float smoothness, in float zigzag, in float rotation) {\n                uv *= frequency;\n                vec2 i = floor(uv);\n\n                float offset = mod(i.y, 2.0);\n\n                uv.x += offset + zigzag * offset;\n                float x = floor(uv.x);\n                \n                return mod(x, 2.0);\n            }"),line:new WV("float line(in vec2 uv, in vec2 frequency, in float size, in float variation, in float smoothness, in float zigzag, in float rotation) {\n                vec2 f = tile_and_center(uv, frequency, 0.0, zigzag, rotation);\n\t\t\t\t\n\t\t\t\t// Different approach for variation param here\n\t\t\t\tfloat row = floor(uv * frequency).y;\n\t\t\t\tfloat rand = hashwithoutsine12(vec2(row));\n\t\t\t\tfloat s = mix(size, size * rand, variation);\n\n\t\t\t\treturn smoothstep(\n\t\t\t\t\ts - smoothness, \n\t\t\t\t\ts + smoothness, \n\t\t\t\t\tabs(f.y)\n\t\t\t\t);\n            }",[t]),wave:new WV("// Uses bisection \n            float udf_cos(in vec2 p, in float a, in float b, in float c, in float d) {\n                // Convert all data to a primitive cosine wave\n                p = c * (p - vec2(d, a));\n                \n                const float TWO_PI = PI * 2.0;\n\n                // Reduce to principal half cycle\n                p.x = mod(p.x, TWO_PI); \n                if (p.x > PI) {\n                    p.x = TWO_PI - p.x;\n                }\n            \n                // Find zero of derivative (minimize distance)\n                float xa = 0.0;\n                float xb = TWO_PI;\n\n                // 24 bit precision\n                for (int i = 0; i < 24; i++) {\n                    float x = 0.5 * (xa + xb);\n                    float y = x - p.x + b * c * sin(x) * (p.y - b * c * cos(x));\n                    if (y < 0.0) xa = x; \n                    else xb = x;\n                }\n                float x = 0.5 * (xa + xb);\n                \n                // Compute distance    \n                vec2 q = vec2(x, b * c * cos(x));\n                return length(p - q) / c;\n            }\n\n            float wave(in vec2 uv, in vec2 frequency, in float size, in float variation, in float smoothness, in float zigzag, in float rotation) {\n                float repeat = frequency.x;\n                uv *= repeat;\n                vec2 i = floor(uv);\n                float row_offset = mod(i.y, 2.0);\n                uv.x += row_offset * zigzag;\n                vec2 f = vec2(uv.x, fract(uv.y));\n\n                // Generalized cosine: y(x) = a + b * cos(cx + d)\n                const float amplitude = 0.125;\n                float wave_frequency = frequency.y * 0.1;\n                float distance_estimate = udf_cos(f, 0.50, amplitude, wave_frequency * (2.0 * PI), 0.0);\n\n\t\t\t\t// Different approach for variation param here\n\t\t\t\tfloat rand = hashwithoutsine12(vec2(i.y));\n\t\t\t\tfloat s = mix(size, size * rand, variation);\n\n                return smoothstep(-smoothness, smoothness, distance_estimate - s * 0.5);\n            }")}}();var tW=class extends RV{constructor(e,t,n,i,r,s,a,o){super("v3"),this.nodeType="Rainbow",this.filmThickness=e,this.movement=t,this.wavelengths=n,this.noiseStrength=i,this.noiseScale=r,this.offset=s,this.isMask=o,this.alpha=a,this.calpha="g".concat(this.uuid.toString().replace(/-/g,""),"_calpha")}generate(e,t){if(e.require("vWorldViewDir"),e.require("worldNormal"),e.isShader("fragment")){e.require("uv"),e.requires.uv=[!0],e.addFragmentVariable(this.calpha,"float");let n=e.include(tW.Nodes.rainbow),i=[];return i.push(this.filmThickness.build(e,"f")),i.push(this.movement.build(e,"f")),i.push(this.wavelengths.build(e,"v3")),i.push(this.noiseStrength.build(e,"f")),i.push(this.noiseScale.build(e,"f")),i.push(this.offset.build(e,"v3")),i.push(this.isMask.build(e,"b")),i.push(this.mask?"luminance(".concat(this.mask.flow(e,"v3").result,")"):"1.0"),i.push(this.alpha.build(e,"f")),i.push(this.calpha),e.format(n+"("+i.join(",")+")",this.getType(e),t)}return console.warn("RainbowNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.getType(e),t)}},nW=tW;nW.Nodes=function(){let e=new WV("vec3 attenuation(vec3 wavelengths, float filmThickness, float movement, float noiseStrength, float noiseScale, vec3 offset) {\n\t\t\t\tfloat f = 0.0;\n\t\t\t\t\n\t\t\t\tif (noiseStrength != 0.0) {\n\t\t\t\t\tvec3 st = position / noiseScale;\n\t\t\t\t\tfloat noise = simplexFast(1.6 * st + vec3(1.8, 1.5, 1.9) * simplexFast(st) + vec3(1.7, 9.2, 1.0));\n\t\t\t\t\tf = noise * noiseStrength;\n\t\t\t\t}\n\n\t\t\t\tvec3 waves = wavelengths * vec3(1.0, 0.8, 0.6) + 1.0;\n\t\t\t\tfloat angle = dot(normalize(vWorldViewDir + (offset * -0.001)), normalize(vWNormal));\n\n\t\t\t\tmediump vec3 color = cos((((filmThickness + f) / waves) * angle) + movement);\n\t\t\t\treturn .5 + .5 * color;\n\t\t\t }",[QH.simplexFast]);return{rainbow:new WV("vec3 rainbow(float filmThickness, float movement, vec3 wavelengths, float noiseStrength, float noiseScale, vec3 offset, bool isMask, float mask, float alpha, out float calpha) {\n\t\t\t\tmediump vec3 res = clamp(attenuation(wavelengths, filmThickness, movement, noiseStrength, noiseScale, offset), 0.0, 2.0);\n\n\t\t\t\tfloat rainbowContribution = clamp(res.r + res.g + res.b, 0.0, 1.0);\n\n\t\t\t\tfloat lalpha = alpha * rainbowContribution * mask;\n\t\t\t\tcalpha = mix(lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0), lalpha, float(isMask));\n\t\t\t\taccumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));\n\n\t\t\t\treturn res;\n\t\t\t }",[e])}}();var iW=class extends RV{constructor(e,t,n,i,r,s,a,o,l,u){super("v3"),this.nodeType="Toon",this.positioning=e,this.colors=t,this.steps=n,this.source=i,this.isWorldSpace=r,this.noiseStrength=s,this.noiseScale=a,this.shadowColor=o,this.offset=l,this.alpha=u,this.calpha="g".concat(this.uuid.toString().replace(/-/g,""),"_calpha")}generate(e,t){if(e.require("worldNormal"),e.require("worldPosition"),e.isShader("fragment")){e.define("COLORS_MAX",10),e.addFragmentVariable(this.calpha,"float");let n=e.include(iW.Nodes.toon),i=[];return i.push(this.positioning.build(e,"i")),i.push(this.colors.build(e,"v4[]")),i.push(this.steps.build(e,"f[]")),i.push(this.source.build(e,"v3")),i.push(this.isWorldSpace.build(e,"b")),i.push(this.noiseStrength.build(e,"f")),i.push(this.noiseScale.build(e,"f")),i.push(this.shadowColor.build(e,"v4")),i.push(this.offset.build(e,"v3")),i.push(this.mask?"luminance(".concat(this.mask.flow(e,"v3").result,")"):"1.0"),i.push(this.alpha.build(e,"f")),i.push(this.calpha),e.format(n+"("+i.join(",")+")",this.getType(e),t)}return console.warn("ToonNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.getType(e),t)}},rW=iW;rW.Nodes=function(){let e=new WV("float rand(float n) {\n\t\t\t\treturn fract(sin(n) * 43758.5453123);\n\t\t\t}"),t=new WV("float hash1(float p) { \n\t\t\t\tp = fract(p * 0.011); \n\t\t\t\tp *= p + 7.5; \n\t\t\t\tp *= p + p; \n\t\t\t\treturn fract(p); \n\t\t\t}"),n=new WV("float valueNoise(vec3 x) {\n\t\t\t\tconst vec3 step = vec3(110, 241, 171);\n\t\t\t\n\t\t\t\tvec3 i = floor(x);\n\t\t\t\tvec3 f = fract(x);\n\t\t\t \n\t\t\t\t// For performance, compute the base input to a 1D hash from the integer part of the argument and the \n\t\t\t\t// incremental change to the 1D based on the 3D -> 1D wrapping\n\t\t\t\tfloat n = dot(i, step);\n\t\t\t\n\t\t\t\tvec3 u = f * f * (3.0 - 2.0 * f);\n\t\t\t\treturn mix(mix(mix( hash1(n + dot(step, vec3(0, 0, 0))), hash1(n + dot(step, vec3(1, 0, 0))), u.x),\n\t\t\t\t\t\t\t   mix( hash1(n + dot(step, vec3(0, 1, 0))), hash1(n + dot(step, vec3(1, 1, 0))), u.x), u.y),\n\t\t\t\t\t\t   mix(mix( hash1(n + dot(step, vec3(0, 0, 1))), hash1(n + dot(step, vec3(1, 0, 1))), u.x),\n\t\t\t\t\t\t\t   mix( hash1(n + dot(step, vec3(0, 1, 1))), hash1(n + dot(step, vec3(1, 1, 1))), u.x), u.y), u.z);\n\t\t\t}",[t]),i=new WV("vec3 hash3(vec3 x) {\n\t\t\t\tx = vec3(dot(x,vec3(127.1, 311.7, 74.7)),\n\t\t\t\t\t\t dot(x,vec3(269.5, 183.3, 246.1)),\n\t\t\t\t\t\t dot(x,vec3(113.5, 271.9, 124.6)));\n\t\t\t\n\t\t\t\treturn fract(sin(x)*43758.5453123);\n\t\t\t}"),r=new WV('vec3 voronoiNoise(in vec3 x)\n\t\t\t{\n\t\t\t\tvec3 p = floor(x);\n\t\t\t\tvec3 f = fract(x);\n\n\t\t\t\tfloat id = 0.0;\n\t\t\t\tvec2 res = vec2(100.0);\n\n\t\t\t\tfor(int k=-1; k<=1; k++)\n\t\t\t\tfor(int j=-1; j<=1; j++)\n\t\t\t\tfor(int i=-1; i<=1; i++)\n\t\t\t\t{\n\t\t\t\t\tvec3 b = vec3(float(i), float(j), float(k));\n\n\t\t\t\t\t// Comment out the "+ hash(p + b);" part below to get "square" cells\n\t\t\t\t\tvec3 r = vec3(b) - f + hash3(p + b);\n\t\t\t\t\tfloat d = dot(r, r);\n\n\t\t\t\t\tif (d < res.x)\n\t\t\t\t\t{\n\t\t\t\t\t\tid = dot(p + b, vec3(1.0, 57.0, 113.0));\n\t\t\t\t\t\tres = vec2(d, res.x);\t\t\t\n\t\t\t\t\t}\n\t\t\t\t\telse if (d < res.y)\n\t\t\t\t\t{\n\t\t\t\t\t\tres.y = d;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\treturn vec3(sqrt(res), abs(id));\n\t\t\t}\n\t\t\t',[i]);return{toon:new WV('vec3 toon(int positioning, vec4 colors[COLORS_MAX], float steps[COLORS_MAX], vec3 source, bool isWorldSpace, float noiseStrength, float noiseScale, vec4 shadowColor, vec3 offset, float mask, float alpha, out float calpha) {\n\t\t\t\tfloat t = 0.0;\n\t\t\t\tfloat shadow = 1.0;\n\n\t\t\t\tif (positioning == 0) {\n\n\t\t\t\t\t// Can\'t do this mode if lighting is "none"\n\t\t\t\t\t#if (defined(PHONG) || defined(LAMBERT) || defined(STANDARD))\n\n\t\t\t\t\t\t// Algorithm from Chapter 10 of Graphics Shaders\n\t\t\t\t\t\tconst vec3 weights = vec3(0.2125, 0.7154, 0.0721);\n\t\t\t\t\t\tvec3 lpos;\n\t\t\t\t\t\tvec3 l;\n\t\t\t\t\t\tfloat dproduct;\n\n\t\t\t\t\t\t#if (NUM_POINT_LIGHTS > 0)\n\n\t\t\t\t\t\t\t#if defined(USE_SHADOWMAP) && (NUM_POINT_LIGHT_SHADOWS > 0)\n\t\t\t\t\t\t\t\tPointLightShadow pointLightShadow;\n\t\t\t\t\t\t\t#endif \n\n\t\t\t\t\t\t\t#pragma unroll_loop_start\n\t\t\t\t\t\t\tfor (int i = 0; i < NUM_POINT_LIGHTS; i++) {\n\t\t\t\t\t\t\t\t// Light positions are in view-space for some reason?\n\t\t\t\t\t\t\t\tlpos = (inverse(viewMatrix) * vec4(pointLights[UNROLLED_LOOP_INDEX].position, 1.0)).xyz;\n\t\t\t\t\t\t\t\tl = normalize(lpos - worldPosition);\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\tdproduct = dot(l, normalize(worldNormal)) * 0.5 + 0.5;\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t// TODO: we want to use "intensity" but it isn\'t available in the shader code\n\t\t\t\t\t\t\t\t//dproduct += dot(pointLights[UNROLLED_LOOP_INDEX].color, weights);\n\n\t\t\t\t\t\t\t\tt = max(t, dproduct);\n\n\t\t\t\t\t\t\t\t// Accumulate shadow contribution\n\t\t\t\t\t\t\t\t#if defined(USE_SHADOWMAP) && (UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS)\n\t\t\t\t\t\t\t\t\tpointLightShadow = pointLightShadows[UNROLLED_LOOP_INDEX];\n\t\t\t\t\t\t\t\t\tshadow *= getPointShadow( \n\t\t\t\t\t\t\t\t\t\t\tpointShadowMap[UNROLLED_LOOP_INDEX], \n\t\t\t\t\t\t\t\t\t\t\tpointLightShadow.shadowMapSize, \n\t\t\t\t\t\t\t\t\t\t\tpointLightShadow.shadowBias, \n\t\t\t\t\t\t\t\t\t\t\tpointLightShadow.shadowRadius,\n\t\t\t\t\t\t\t\t\t\t\tvPointShadowCoord[UNROLLED_LOOP_INDEX], \n\t\t\t\t\t\t\t\t\t\t\tpointLightShadow.shadowCameraNear, \n\t\t\t\t\t\t\t\t\t\t\tpointLightShadow.shadowCameraFar);\n\t\t\t\t\t\t\t\t#endif\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t#pragma unroll_loop_end\n\n\t\t\t\t\t\t#endif\n\n\t\t\t\t\t\t#if NUM_DIR_LIGHTS > 0 \n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t#if defined(USE_SHADOWMAP) && (NUM_DIR_LIGHT_SHADOWS > 0)\n\t\t\t\t\t\t\t\tDirectionalLightShadow directionalLightShadow;\n\t\t\t\t\t\t\t#endif \n\n\t\t\t\t\t\t\t#pragma unroll_loop_start\n\t\t\t\t\t\t\tfor (int i = 0; i < NUM_DIR_LIGHTS; i++) {\n\t\t\t\t\t\t\t\t// Use the direction vector for directional lights instead\n\t\t\t\t\t\t\t\tl = (inverse(viewMatrix) * vec4(directionalLights[UNROLLED_LOOP_INDEX].direction, 0.0)).xyz;\n\t\t\n\t\t\t\t\t\t\t\tdproduct = dot(l, normalize(worldNormal)) * 0.5 + 0.5;\n\t\t\t\t\t\t\t\tt = max(t, dproduct);\n\n\t\t\t\t\t\t\t\t// Accumulate shadow contribution\n\t\t\t\t\t\t\t\t#if defined(USE_SHADOWMAP) && (UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS)\n\t\t\t\t\t\t\t\t\tdirectionalLightShadow = directionalLightShadows[UNROLLED_LOOP_INDEX];\n\t\t\t\t\t\t\t\t\tshadow *= getShadow( \n\t\t\t\t\t\t\t\t\t\tUNROLLED_LOOP_INDEX,\n\t\t\t\t\t\t\t\t\t\tdirectionalShadowMap[UNROLLED_LOOP_INDEX], \n\t\t\t\t\t\t\t\t\t\tdirectionalLightShadow.shadowMapSize, \n\t\t\t\t\t\t\t\t\t\tdirectionalLightShadow.shadowBias, \n\t\t\t\t\t\t\t\t\t\tdirectionalLightShadow.shadowRadius, \n\t\t\t\t\t\t\t\t\t\tvDirectionalShadowCoord[UNROLLED_LOOP_INDEX]);\n\t\t\t\t\t\t\t\t#endif\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t#pragma unroll_loop_end\n\n\t\t\t\t\t\t#endif\n\n\t\t\t\t\t\t#if NUM_SPOT_LIGHTS > 0 \n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t#if defined(USE_SHADOWMAP) && (NUM_SPOT_LIGHT_SHADOWS > 0)\n\t\t\t\t\t\t\t\tSpotLightShadow spotLightShadow;\n\t\t\t\t\t\t\t#endif \n\n\t\t\t\t\t\t\t#pragma unroll_loop_start\n\t\t\t\t\t\t\tfor (int i = 0; i < NUM_SPOT_LIGHTS; i++) {\n\t\t\t\t\t\t\t\tlpos = (inverse(viewMatrix) * vec4(spotLights[UNROLLED_LOOP_INDEX].position, 1.0)).xyz;\n\t\t\t\t\t\t\t\tl = normalize(lpos - worldPosition);\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\tdproduct = dot(l, normalize(worldNormal)) * 0.5 + 0.5;\n\t\t\t\t\t\t\t\tt = max(t, dproduct);\n\n\t\t\t\t\t\t\t\t// Accumulate shadow contribution\n\t\t\t\t\t\t\t\t#if defined(USE_SHADOWMAP) && (UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS)\n\t\t\t\t\t\t\t\t\tspotLightShadow = spotLightShadows[UNROLLED_LOOP_INDEX];\n\t\t\t\t\t\t\t\t\tshadow *= getShadow(\n\t\t\t\t\t\t\t\t\t\tUNROLLED_LOOP_INDEX,\n\t\t\t\t\t\t\t\t\t\tspotShadowMap[UNROLLED_LOOP_INDEX], \n\t\t\t\t\t\t\t\t\t\tspotLightShadow.shadowMapSize, \n\t\t\t\t\t\t\t\t\t\tspotLightShadow.shadowBias, \n\t\t\t\t\t\t\t\t\t\tspotLightShadow.shadowRadius, \n\t\t\t\t\t\t\t\t\t\tvSpotLightCoord[UNROLLED_LOOP_INDEX]);\n\t\t\t\t\t\t\t\t#endif\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t#pragma unroll_loop_end\n\n\t\t\t\t\t\t#endif\n\n\t\t\t\t\t\tt = clamp(t, 0.0, 1.0);\n\t\t\t\t\n\t\t\t\t\t#endif\n\n\t\t\t\t} else if (positioning == 1) {\n\t\t\t\t\t\n\t\t\t\t\tvec3 origin = mix(position, worldPosition, float(isWorldSpace));\n\t\t\t\t\tvec3 direction = normalize(source - origin);\n\t\t\t\t\tt = dot(direction, normalize(worldNormal)) * 0.5 + 0.5;\t\n\n\t\t\t\t} else {\n\n\t\t\t\t\tvec3 origin = worldPosition;\n\t\t\t\t\tvec3 source = cameraPosition - offset;\n\t\t\t\t\tvec3 direction = normalize(source - origin);\n\t\t\t\t\tt = dot(direction, normalize(worldNormal)) * 0.5 + 0.5;\t\n\t\t\t\t\t\n\t\t\t\t}\n\n\t\t\t\tif (noiseStrength > 0.0) {\n\t\t\t\t\t// Distort with noise\n\t\t\t\t\tvec3 st = position / noiseScale;\n\t\t\t\t\t\n\t\t\t\t\t// Voronoi "smooth" noise\n\t\t\t\t\tfloat noise = 1.0 - voronoiNoise(st).x;\n\n\t\t\t\t\t// Voronoi cellular noise\n\t\t\t\t\t//float noise = 1.0 - rand(voronoiNoise(st).z);\n\n\t\t\t\t\t// Position warp noise\n\t\t\t\t\t// vec3 offset = vec3(\n\t\t\t\t\t// \tsimplexFast(st),\n\t\t\t\t\t// \tsimplexFast(st + vec3(111.1, 143.89, 217.19)),\n\t\t\t\t\t// \tsimplexFast(st + vec3(171.1, 247.89, 117.23))\n\t\t\t\t\t// );\n\t\t\t\t\t// st += offset;\n\t\t\t\t\t// float noise = valueNoise(st);\n\n\t\t\t\t\tt += noise * noiseStrength;\n\t\t\t\t}\n\n\t\t\t\tt = clamp(t, 0.0, 1.0);\n\n\t\t\t\t// Compute ramp color\n\t\t\t\tfloat p;\n\t\t\t\tvec4 color = colors[0];\n\t\t\t\tfor (int i = 1; i < COLORS_MAX; i++) {\n\t\t\t\t\tp = clamp((t - steps[i-1]) / (steps[i] - steps[i-1]), 0.0, 1.0);\n\t\t\t\t\tcolor = mix(color, colors[i], smoothstep(0.0, 1.0, p));\n\t\t\t\t}\n\n\t\t\t\t// Incorporate custom shadow color\n\t\t\t\tif (positioning == 0) {\n\n\t\t\t\t\tvec3 blendedShadow = mix(color.rgb, shadowColor.rgb, shadowColor.a);\n\t\t\t\t\tcolor.rgb = mix(blendedShadow, color.rgb, shadow);\n\t\t\t\t\n\t\t\t\t}\n\n\t\t\t\t// Accumulate alpha as usual\n\t\t\t\tfloat lalpha = alpha * color.a * mask;\n\t\t\t\tcalpha =  lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0);\n\t\t\t\taccumAlpha += (1.0 - accumAlpha) * lalpha;\n\n\t\t\t\treturn color.xyz;\n\n            }',[QH.simplexFast,e,n,r])}}();var sW={textureBicubic:new WV("float w0( float a ) {\n            return ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );\n        }\n    \n        float w1( float a ) {\n            return ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );\n        }\n    \n        float w2( float a ){\n            return ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );\n        }\n    \n        float w3( float a ) {\n            return ( 1.0 / 6.0 ) * ( a * a * a );\n        }\n    \n        // g0 and g1 are the two amplitude functions\n        float g0( float a ) {\n            return w0( a ) + w1( a );\n        }\n    \n        float g1( float a ) {\n            return w2( a ) + w3( a );\n        }\n    \n        // h0 and h1 are the two offset functions\n        float h0( float a ) {\n            return - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );\n        }\n    \n        float h1( float a ) {\n            return 1.0 + w3( a ) / ( w2( a ) + w3( a ) );\n        }\n    \n        vec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {\n            uv = uv * texelSize.zw + 0.5;\n    \n            vec2 iuv = floor( uv );\n            vec2 fuv = fract( uv );\n    \n            float g0x = g0( fuv.x );\n            float g1x = g1( fuv.x );\n            float h0x = h0( fuv.x );\n            float h1x = h1( fuv.x );\n            float h0y = h0( fuv.y );\n            float h1y = h1( fuv.y );\n    \n            vec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;\n            vec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;\n            vec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;\n            vec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;\n    \n            return g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) + \n                   g1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );\n        }\n\n        vec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {\n            vec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );\n            vec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );\n            vec2 fLodSizeInv = 1.0 / fLodSize;\n            vec2 cLodSizeInv = 1.0 / cLodSize;\n            vec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );\n            vec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );\n            return mix( fSample, cSample, fract( lod ) );\n        }")};var aW=class extends RV{constructor(e,t,n,i,r,s,a,o){super("v3"),this.nodeType="Transmission",this.thickness=e,this.ior=t,this.roughness=n,this.transmissionSamplerSize=i,this.transmissionSamplerMap=r,this.transmissionDepthMap=s,this.aspectRatio=a,this.alpha=o,this.calpha="g".concat(this.uuid.toString().replace(/-/g,""),"_calpha")}generate(e,t){if(e.extensions.shaderTextureLOD=!0,e.extensions.derivatives=!0,e.isShader("fragment")){e.define("NUM_SAMPLES",6),e.define("BLUR_SLOD",Math.pow(2,hW.transmissionLod.value)),e.require("worldPosition"),e.requires.worldNormal=!0,e.requires.modelMatrix=!0,e.requires.projectionMatrix=!0,e.addFragmentVariable(this.calpha,"float");let n=e.include(aW.Nodes.transmission),i=[];return i.push(this.thickness.build(e,"f")),i.push(this.ior.build(e,"f")),i.push(this.roughness.build(e,"f")),i.push(this.transmissionSamplerSize.build(e,"v2")),i.push(this.transmissionSamplerMap.getTexture(e,"t")),i.push(this.transmissionDepthMap.getTexture(e,"t")),i.push(this.aspectRatio.build(e,"v2")),i.push("normal"),i.push(this.mask?"luminance(".concat(this.mask.flow(e,"v3").result,")"):"1.0"),i.push(this.alpha.build(e,"f")),i.push(this.calpha),e.format(n+"("+i.join(",")+")",this.getType(e),t)}return console.warn("TransmissionNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.getType(e),t)}},oW=aW;oW.Nodes=function(){let e=new WV("vec3 blur(sampler2D sp, vec2 U, vec2 scale, float lod, sampler2D dm, vec2 unrefractedU, vec2 aspectRatio) {\n                // Slightly modified version of this:\n                // https://www.shadertoy.com/view/ltScRG\n\n\t\t\t\t// Special case for blur == 0.0\n\t\t\t\tif (lod == 0.0) {\n\t\t\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\t\treturn texture2DLodEXT( sp, U, 0.0).rgb;\n\t\t\t\t\t#else\n\t\t\t\t\treturn textureLod( sp, U, 0.0).rgb;\n\t\t\t\t\t#endif\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tvec2 texelSize = vec2(1.0) / resolution;\n                vec2 halton = haltonSequence[frameIndex];\n                float temporalOffset = getNoiseInterleavedGradient(gl_FragCoord.xy + halton);\n                float temporalAngle  = temporalOffset * PI2;\n\t\t\t\tvec3 res = vec3(0.0);\n                vec2 uv = vec2(0.0);\n                vec2 offset = vec2(0.0);\n                vec2 vogelSample = vec2(0.0);\n                for (int i = 0; i < NUM_SAMPLES; i++) {\n                    vogelSample =  vogelDiskSample(i, NUM_SAMPLES, temporalAngle) * texelSize;\n                    offset = vogelSample * scale * (lod * 10.0); // TODO: used to be hardcoded to 20\n                    uv = U + offset;\n                    float opaqueDepth = unpackRGBAToDepth(textureLod(dm, uv, lod));\n                    if (opaqueDepth != 0.0 && opaqueDepth < gl_FragCoord.z) {\n                        uv = unrefractedU;\n                        lod = lod > 4.0 ? lod : lod / 2.0;\n                    }\n                    res += textureLod(sp, uv, lod).rgb;\n                }\n                return res / float(NUM_SAMPLES);\n            }"),t=new WV("vec3 getVolumeTransmissionRay( vec3 n, vec3 v, float thickness, float ior, mat4 modelMatrix ) {\n\t\t        // Direction of refracted light.\n\t\t        vec3 refractionVector = refract( -v,  n, 1.0 / ior );\n\t\t        \n\t\t\t\t// Compute rotation-independant scaling of the model matrix.\n\t\t        vec3 modelScale;\n\t\t        modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );\n\t\t        modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );\n\t\t        modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );\n\n\t\t        // The thickness is specified in local space\n\t\t        return normalize( refractionVector ) * thickness * modelScale;\n\t        }"),n=new WV("float applyIorToRoughness( float roughness, float ior ) {\n\t\t\t\t// Scale roughness with IOR so that an IOR of 1.0 results in no microfacet refraction and\n\t\t\t\t// an IOR of 1.5 results in the default amount of microfacet refraction.\n\t\t\t\treturn roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );\n\t\t\t}"),i=new WV('vec3 getTransmissionSample( vec2 fragCoord, float roughness, float ior, vec2 transmissionSamplerSize, sampler2D transmissionSamplerMap, sampler2D transmissionDepthMap, vec2 unrefractedCoords, vec2 aspectRatio) {\n\t\t\t\t// Threejs exports do not pass a depth map to this shader, so we have to fallback to the "Threejs method of blurring" - see\n\t\t\t\t// also the code in convertTransmission.ts, which runs during export\n\t\t\t\t#ifdef IS_THREEJS_EXPORT\n\t\t\t\t\tfloat lod = log2(transmissionSamplerSize.x) * applyIorToRoughness(roughness / 5.0, ior);\n\t\t\t\t\treturn textureBicubic(transmissionSamplerMap, fragCoord.xy, lod).rgb;\n\t\t\t\t#else\n\t\t\t\t\tfloat framebufferLod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );\n\t\t\t\t\tfloat lod = applyIorToRoughness(roughness, ior);\n\t\t\t\t\treturn blur(transmissionSamplerMap, fragCoord, vec2(lod), min(framebufferLod / 5.5, 8.5), transmissionDepthMap, unrefractedCoords, aspectRatio);\n\t\t\t\t#endif\n\t\t\t}',[sW.textureBicubic,n,e]),r=new WV("vec3 getIBLVolumeRefraction( vec3 n, vec3 v, float roughness, vec3 position, mat4 modelMatrix, mat4 viewMatrix, mat4 projMatrix, float ior, float thickness, vec2 transmissionSamplerSize, sampler2D transmissionSamplerMap, sampler2D transmissionDepthMap, vec2 aspectRatio ) {\n\t\t\t\tvec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );\n\t\t\t\tvec3 refractedRayExit = position + transmissionRay;\n\n\t\t\t\t// Project refracted vector on the framebuffer, while mapping to normalized device coordinates.\n\t\t\t\tvec4 ndcPos = projMatrix * viewMatrix *  vec4( refractedRayExit, 1.0 );\n\t\t\t\tvec2 refractionCoords = ndcPos.xy / ndcPos.w;\n\t\t\t\trefractionCoords += 1.0;\n\t\t\t\trefractionCoords /= 2.0;\n\n\t\t\t\tvec4 ndcPosUnrefracted = projMatrix * viewMatrix * vec4(position, 1.0 );\n\t\t\t\tvec2 unrefractedCoords = ndcPosUnrefracted.xy / ndcPosUnrefracted.w;\n\t\t\t\tunrefractedCoords += 1.0;\n\t\t\t\tunrefractedCoords /= 2.0;\n\n\t\t\t\t// Sample framebuffer to get pixel the refracted ray hits.\n\t\t\t\treturn getTransmissionSample( refractionCoords, roughness, ior, transmissionSamplerSize, transmissionSamplerMap, transmissionDepthMap, unrefractedCoords, aspectRatio );\n    \t\t}",[i,t]);return{transmission:new WV("vec3 transmission(float thickness, float ior, float roughness, vec2 transmissionSamplerSize, sampler2D transmissionSamplerMap, sampler2D transmissionDepthMap, vec2 aspectRatio, vec3 normal, float mask, float alpha, out float calpha) {\n                vec3 v = vec3(0.);\n                if (isOrthographic) {\n                    v = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n                } else {\n                    v = normalize(vWPosition - cameraPosition);\n                }\n                vec3 transmission = getIBLVolumeRefraction(vWNormal, -v, roughness,  vWPosition, modelMatrix, viewMatrix, projectionMatrix, ior, thickness, transmissionSamplerSize, transmissionSamplerMap, transmissionDepthMap, aspectRatio );\n                \n\t\t\t\tfloat lalpha = alpha * mask;\n\t\t\t\tcalpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );\n\t\t\t\taccumAlpha += ( 1.0 - accumAlpha ) * alpha;\n\n\t\t\t\treturn transmission;\n            }",[r])}}();var lW=(e=>(e.NOISE="noise",e.MAP="map",e))(lW||{}),uW=class extends RV{constructor(e,t,n,i,r,s,a,o,l,u,c){super("v3"),this.displacementTypeIndex=new SH(0),this.nodeType="VertexDisplacement",this.intensity=e,this.movementOrTexture=t,"map"===Object.values(lW)[this.displacementTypeIndex.value]&&(this.mat=new PH(this.movementOrTexture.value.matrix)),this.cropOrOffset=n,this.scale=u,this.noiseFunctionIndex=c,this.voronoiStyle=i,this.smoothness=r,this.seed=s,this.highCut=a,this.lowCut=o,this.quality=l}generate(e,t){if(e.isShader("vertex")){e.define("USE_LAYER_DISPLACE");let n,i=[];switch(i.push("displaced_position"),i.push("displaced_normal"),Object.values(lW)[this.displacementTypeIndex.value]){case"map":n=e.include(uW.Nodes.map),i.push(this.movementOrTexture.getTexture(e,"t")),i.push("uv"),i.push(this.cropOrOffset.build(e,"f")),this.mat&&i.push(this.mat.build(e,"mat3"));break;case"noise":{let t=["simplexPrecise","simplexFractal","simplexAshima","fbm","perlin","voronoi"][this.noiseFunctionIndex.value],r=new WV("vec3 orthogonal(vec3 v) {\n\t\t\t\t\t\t\treturn normalize(abs(v.x) > abs(v.z) ? vec3(-v.y, v.x, 0.0) : vec3(0.0, -v.z, v.y));\n\t\t\t\t\t\t}"),s="voronoi"==t?"\n\t\t\t\t\tfloat v = ".concat(t,"((p + offset) * scale * 0.001 + neighbour_offset + (movement * 0.1), voronoiStyle, smoothness, seed, quality);\n\t\t\t\t\tv = remap(v, lowCut, highCut, 0.0, 1.0);\n\t\t\t\t\tv = smax(v, 0.0, smoothness * 0.25);\n\t\t\t\t\tv = smin(v, 1.0, smoothness * 0.25);\n\n\t\t\t\t\treturn p + n * v * intensity;\n\t\t\t\t\t"):"\n\t\t\t\t\treturn p + n * ".concat(t,"((p + offset) * scale * 0.001 + neighbour_offset + (movement * 0.1)) * intensity;\n\t\t\t\t\t"),a=new WV("vec3 distorted(vec3 p, vec3 n, float scale, float intensity, vec3 offset, float neighbour_offset, float movement, int voronoiStyle, float smoothness, float seed, float highCut, float lowCut, int quality) {\n\t\t\t\t\t\t\t".concat(s,"\n\t\t\t\t\t\t}"),[QH.simplexPrecise,QH.simplexFractal,QH.simplexAshima,QH.fbm,QH.perlin,QH.voronoi]),o=new WV("vec3 vertexDisplacementNoise(vec3 position, vec3 normal, float scale, vec3 offset, float movement, int voronoiStyle, float smoothness, float seed, float highCut, float lowCut, int quality, float intensity, out vec3 displaced_normal) {\n\t\t\t\t\t\t\tvec3 displaced_position = distorted(position, normal, scale, intensity, offset, neighbor_offset, movement, voronoiStyle, smoothness, seed, highCut, lowCut, quality);\n\t\t\t\t\t\t\tvec3 tangent1 = orthogonal(normal);\n\t\t\t\t\t\t\tvec3 tangent2 = normalize(cross(normal, tangent1));\n\n                            // TODO(Max): The distance to the neighbors was originally scaled by 0.1.\n                            // This caused some small oval/circular visual artifacts in the lighting.\n                            // For now, simply using neighbors further away betters the problem,\n                            // but we should figure out the underlying cause when we have some time.\n                            // Maybe its related to how we calculate the tangent and bitangent?\n\t\t\t\t\t\t\tvec3 nearby1 = position + tangent1;\n\t\t\t\t\t\t\tvec3 nearby2 = position + tangent2;\n\t\t\t\t\t\t\tvec3 distorted1 = distorted(nearby1, normal, scale, intensity, offset, neighbor_offset, movement, voronoiStyle, smoothness, seed, highCut, lowCut, quality);\n\t\t\t\t\t\t\tvec3 distorted2 = distorted(nearby2, normal, scale, intensity, offset, neighbor_offset, movement, voronoiStyle, smoothness, seed, highCut, lowCut, quality);\n\t\t\t\t\t\t\tdisplaced_normal = normalize(cross(distorted1 - displaced_position, distorted2 - displaced_position));\n\t\t\t\t\t\t\treturn displaced_position;\n\t\t\t\t\t\t}",[a,r]);n=e.include(o),i.push(this.scale.build(e,"f")),i.push(this.cropOrOffset.build(e,"v3")),i.push(this.movementOrTexture.build(e,"f")),i.push(this.voronoiStyle.build(e,"i")),i.push(this.smoothness.build(e,"f")),i.push(this.seed.build(e,"f")),i.push(this.highCut.build(e,"f")),i.push(this.lowCut.build(e,"f")),i.push(this.quality.build(e,"i"));break}}return i.push(this.intensity.build(e,"f")),i.push("displaced_normal"),e.format(n+"("+i.join(",")+")",this.getType(e),t)}return console.warn("VertexDisplacementNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.getType(e),t)}},cW=uW;cW.Nodes=function(){let e=new WV("vec3 orthogonal(vec3 v) {\n\t\t\t\treturn normalize(abs(v.x) > abs(v.z) ? vec3(-v.y, v.x, 0.0) : vec3(0.0, -v.z, v.y));\n\t\t\t}"),t=new WV("float displacementMapTexture(sampler2D tex, float crop, vec2 uv, mat3 mat, vec2 offset) {\n\t\t\t\tvec2 uvs = (mat * vec3(uv * 2.0 - 1.0, 1.0) / 2.0 + 0.5).xy + offset;\n\t\t\t\tvec4 tmp = texture2D(tex, uvs);\n\t\t\t\tvec3 col = tmp.rgb;\n\t\t\t\tif (crop > 0.5) {\n\t\t\t\t\tif ( uvs.x < 0.0 || uvs.x > 1.0 || uvs.y < 0.0 || uvs.y > 1.0 )  {\n\t\t\t\t\t\treturn 0.0;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn col.r;\n\t\t\t}");return{map:new WV("vec3 vertexDisplacementMap(vec3 position, vec3 normal, sampler2D tex, vec2 uv, float crop, mat3 mat, float intensity, out vec3 displaced_normal) {\n\t\t\t\tvec3 displaced_position = position + normal * displacementMapTexture(tex, crop, uv, mat, vec2(0.0)) * intensity;\n\t\t\t\tvec3 tangent1 = normalize(orthogonal(normal));\n\t\t\t\tvec3 tangent2 = normalize(cross(normal, tangent1));\n\t\t\t\tvec3 nearby1 = position + tangent1 * 0.1;\n\t\t\t\tvec3 nearby2 = position + tangent2 * 0.1;\n\t\t\t\tvec3 distorted1 = nearby1 + normal * displacementMapTexture(tex, crop, uv, mat, vec2(neighbor_offset)) * intensity;\n\t\t\t\tvec3 distorted2 = nearby2 + normal * displacementMapTexture(tex, crop, uv, mat, vec2(neighbor_offset)) * intensity;\n\t\t\t\tdisplaced_normal = normalize(cross(distorted1 - displaced_position, distorted2 - displaced_position));\n\t\t\t\treturn displaced_position;\n\t\t\t}",[e,t])}}();var hW={normalRenderTarget:new tH,normalRenderTargetDepth:new tH,transmissionRenderTarget:new tH,aspectRatio:new zV,transmissionSize:new zV(2048,2048),transmissionRenderTargetDepth:new tH,aoRenderTarget:new tH,aoEnabled:new EH,pixelRatioNode:new nH(1),resolution:new zV,penumbraSize:new CH(5,.5),frameIndex:new SH(0),transmissionLod:new SH(2)};for(let n of Object.values(hW))n.isRenderGlobal=!0;var dW,pW={skiaWasmUrl:"https://unpkg.com/@splinetool/ui-wasm@1.9.59/build/ui.wasm"},fW=class extends IV{constructor(){super("basic"),this.nodeType="Basic",this.color=new _H(Jk),this.shadingAlpha=new nH(1),this.shadingBlend=new SH(0),this.previousModelViewMatrix=new FH,this.previouseProjectionMatrix=new FH}get category(){return"phong"}generate(e){let t;if(e.isShader("vertex")){let n=this.position?this.position.analyzeAndFlow(e,"v3",{cache:"position"}):void 0;e.mergeUniform({frameIndex:hW.frameIndex}),e.mergeUniform({resolution:hW.resolution}),e.mergeUniform({previousModelViewMatrix:this.previousModelViewMatrix}),e.mergeUniform({previousProjectionMatrix:this.previouseProjectionMatrix}),e.mergeUniform(Ox.merge([Zx.fog])),e.addParsCode(["varying vec3 vViewPosition;","varying vec3 vWPosition;","#include <fog_pars_vertex>","#include <skinning_pars_vertex>","#include <normal_pars_vertex>","#include <morphtarget_pars_vertex>"].join("\n"));let i=["#include <beginnormal_vertex>","#include <morphnormal_vertex>","\n\t\t\t\t#include <skinbase_vertex>\n\t\t\t\t#include <skinnormal_vertex>\n\t\t\t\t#if !defined( USE_LAYER_DISPLACE )\n\t\t\t\t\t#include <defaultnormal_vertex>\n\t\t\t\t#endif\n\n\t\t\t\tvec3 displaced_position = position;\n\t\t\t\tvec3 displaced_normal = normal;\n\n\t\t\t\t#if defined( USE_LAYER_DISPLACE )\n\t\t\t\t\tvec3 transformed;\n\t\t\t\t\tvec3 transformedNormal;\n\t\t\t\t#endif\n\t\t\t\t","#include <normal_vertex>","\n\t\t\t\t#if !defined( USE_LAYER_DISPLACE )\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t#endif /* !USE_LAYER_DISPLACE */\n\t\t\t\t"];n&&i.push(n.code,n.result?"displaced_position = "+n.result+";":""),i.push("transformed = displaced_position;","#include <morphtarget_vertex>","#include <skinning_vertex>","transformedNormal = normalMatrix * displaced_normal;","#ifndef FLAT_SHADED","\tvNormal = transformedNormal;","#endif"),i.push("#include <project_vertex>","#include <fog_vertex>","#include <clipping_planes_vertex>","\tvViewPosition = - mvPosition.xyz;","#include <worldpos_vertex>"),i.push("vWPosition = ( modelMatrix * vec4( transformed, 1.0 ) ).xyz;"),t=i.join("\n")}else{void 0===this.color&&(this.color=new _H(Jk)),this.color.analyze(e,{slot:"color"}),this.alpha&&this.alpha.analyze(e),this.afterColor&&this.afterColor.analyze(e,{slot:"afterColor"});let n=this.color.flow(e,"c",{slot:"color"}),i=this.alpha?this.alpha.flow(e,"f"):void 0,r=this.alphaOverride?this.alphaOverride.flow(e,"f"):void 0,s=this.afterColor?this.afterColor.flow(e,"c",{slot:"afterColor"}):void 0;e.requires.transparent=void 0!==i,e.addParsCode(["varying vec3 vWPosition;","#include <fog_pars_fragment>","#include <dithering_pars_fragment>","varying vec3 vViewPosition;","#include <normal_pars_fragment>"].join("\n"));let a=["#include <normal_fragment_begin>",n.code];i&&a.push(i.code,"#ifdef ALPHATEST"," if ( "+i.result+" <= ALPHATEST ) discard;","#endif"),s?a.push(s.code,"vec3 outgoingLight = ".concat(n.result,";"),"vec3 finalColor = spe_blend(outgoingLight, ".concat(s.result,", 1.0, SPE_BLENDING_NORMAL);")):a.push("vec3 finalColor = ".concat(n.result,";"));let o="1.0";this.mask&&(this.mask.analyze(e),o="luminance(".concat(this.mask.flow(e,"v3").result,")")),i?a.push("gl_FragColor = vec4( finalColor, accumAlpha * ".concat(i.result," * ").concat(o," );")):a.push("gl_FragColor = vec4("+n.result+", 1.0 );"),r&&a.push("gl_FragColor.a *= ".concat(r.result,";")),a.push("#include <fog_fragment>","#include <dithering_fragment>"),t=a.join("\n")}return t}},mW=class extends IV{constructor(){super("lambert"),this.nodeType="Lambert",this.color=new _H(Jk),this.emissive=new _H(0),this.emissiveIntensity=new nH(1),this.previousModelViewMatrix=new FH,this.previouseProjectionMatrix=new FH,this.shadingAlpha=new nH(1),this.shadingBlend=new SH(0),this.occlusion=new EH(!0)}get category(){return"lambert"}build(e){let t;if(e.define("LAMBERT"),e.requires.lights=!0,e.extensions.derivatives=!0,e.isShader("vertex")){let n=this.position?this.position.analyzeAndFlow(e,"v3",{cache:"position"}):void 0;e.mergeUniform({frameIndex:hW.frameIndex}),e.mergeUniform({resolution:hW.resolution}),e.mergeUniform({previousModelViewMatrix:this.previousModelViewMatrix}),e.mergeUniform({previousProjectionMatrix:this.previouseProjectionMatrix}),e.mergeUniform(Ox.merge([Zx.fog,Zx.lights])),e.addParsCode(["varying vec3 vViewPosition;","varying vec3 vWPosition;","varying vec3 vLightFront;","varying vec3 vIndirectFront;","#ifndef DOUBLE_SIDED","   #define DOUBLE_SIDED","#endif","#ifdef DOUBLE_SIDED","\tvarying vec3 vLightBack;","\tvarying vec3 vIndirectBack;","#endif","#include <bsdfs>","#include <lights_pars_begin>","#include <color_pars_vertex>","#include <fog_pars_vertex>","#include <skinning_pars_vertex>","#include <normal_pars_vertex>","#include <morphtarget_pars_vertex>","#include <shadowmap_pars_vertex>","#include <clipping_planes_pars_vertex>"].join("\n"));let i=["#include <beginnormal_vertex>","#include <morphnormal_vertex>","\n\t\t\t\t#include <skinbase_vertex>\n\t\t\t\t#include <skinnormal_vertex>\n\t\t\t\t#ifndef USE_LAYER_DISPLACE\n\t\t\t\t\t#include <defaultnormal_vertex>\n\t\t\t\t#endif\n\n\t\t\t\tvec3 displaced_position = position;\n\t\t\t\tvec3 displaced_normal = objectNormal;\n\n\t\t\t\t#ifdef USE_LAYER_DISPLACE\n\t\t\t\t\tvec3 transformed;\n\t\t\t\t\tvec3 transformedNormal;\n\t\t\t\t#endif\n\t\t\t\t","#include <normal_vertex>","\n\t\t\t\t#ifndef USE_LAYER_DISPLACE\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t#endif\n\t\t\t\t"];n&&i.push(n.code,n.result?"displaced_position = "+n.result+";":""),i.push("transformed = displaced_position;","#include <morphtarget_vertex>","#include <skinning_vertex>","transformedNormal = normalMatrix * displaced_normal;","#ifndef FLAT_SHADED","    vNormal = transformedNormal;","#endif"),i.push("\t#include <project_vertex>","\t#include <clipping_planes_vertex>","\tvViewPosition = - mvPosition.xyz;","\t#include <worldpos_vertex>","\n\t\t\t\t\tvec3 diffuse = vec3( 1.0 );\n\t\t\t\t\tGeometricContext geometry;\n\t\t\t\t\tgeometry.position = mvPosition.xyz;\n\t\t\t\t\tgeometry.normal = normalize( transformedNormal );\n\t\t\t\t\tgeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( -mvPosition.xyz );\n\t\t\t\t"),i.push("\n\t\t\t\t\tGeometricContext backGeometry;\n\t\t\t\t\tbackGeometry.position = geometry.position;\n\t\t\t\t\tbackGeometry.normal = -geometry.normal;\n\t\t\t\t\tbackGeometry.viewDir = geometry.viewDir;\n\t\t\t\t\tvLightFront = vec3( 0.0 );\n\t\t\t\t\tvIndirectFront = vec3( 0.0 );\n\t\t\t\t\t#ifdef DOUBLE_SIDED\n\t\t\t\t\t\tvLightBack = vec3( 0.0 );\n\t\t\t\t\t\tvIndirectBack = vec3( 0.0 );\n\t\t\t\t\t#endif\n\t\t\t\t\tIncidentLight directLight;\n\t\t\t\t\tfloat dotNL;\n\t\t\t\t\tvec3 directLightColor_Diffuse;\n\t\t\t\t\tvIndirectFront += getAmbientLightIrradiance( ambientLightColor );\n\t\t\t\t\tvIndirectFront += getLightProbeIrradiance( lightProbe, geometry.normal );\n\t\t\t\t\t#ifdef DOUBLE_SIDED\n\t\t\t\t\t\tvIndirectBack += getAmbientLightIrradiance( ambientLightColor );\n\t\t\t\t\t\tvIndirectBack += getLightProbeIrradiance( lightProbe, backGeometry.normal );\n\t\t\t\t\t#endif\n\t\t\t\t\t#if NUM_POINT_LIGHTS > 0\n\t\t\t\t\t\t#pragma unroll_loop_start\n\t\t\t\t\t\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\t\t\t\t\t\tgetPointLightInfo( pointLights[ i ], geometry, directLight );\n\t\t\t\t\t\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\t\t\t\t\t\tdirectLightColor_Diffuse = directLight.color;\n\t\t\t\t\t\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t\t\t\t\t\t#ifdef DOUBLE_SIDED\n\t\t\t\t\t\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t\t\t\t\t\t#endif\n\t\t\t\t\t\t}\n\t\t\t\t\t\t#pragma unroll_loop_end\n\t\t\t\t\t#endif\n\t\t\t\t\t#if NUM_SPOT_LIGHTS > 0\n\t\t\t\t\t\t#pragma unroll_loop_start\n\t\t\t\t\t\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\t\t\t\t\t\tgetSpotLightInfo( spotLights[ i ], geometry, directLight );\n\t\t\t\t\t\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\t\t\t\t\t\tdirectLightColor_Diffuse = directLight.color;\n\t\t\t\t\t\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t\t\t\t\t\t#ifdef DOUBLE_SIDED\n\t\t\t\t\t\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t\t\t\t\t\t#endif\n\t\t\t\t\t\t}\n\t\t\t\t\t\t#pragma unroll_loop_end\n\t\t\t\t\t#endif\n\t\t\t\t\t#if NUM_DIR_LIGHTS > 0\n\t\t\t\t\t\t#pragma unroll_loop_start\n\t\t\t\t\t\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\t\t\t\t\t\tgetDirectionalLightInfo( directionalLights[ i ], geometry, directLight );\n\t\t\t\t\t\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\t\t\t\t\t\tdirectLightColor_Diffuse = directLight.color;\n\t\t\t\t\t\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t\t\t\t\t\t#ifdef DOUBLE_SIDED\n\t\t\t\t\t\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t\t\t\t\t\t#endif\n\t\t\t\t\t\t}\n\t\t\t\t\t\t#pragma unroll_loop_end\n\t\t\t\t\t#endif\n\t\t\t\t\t#if NUM_HEMI_LIGHTS > 0\n\t\t\t\t\t\t#pragma unroll_loop_start\n\t\t\t\t\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\t\t\t\t\tvIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );\n\t\t\t\t\t\t\t#ifdef DOUBLE_SIDED\n\t\t\t\t\t\t\t\tvIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry.normal );\n\t\t\t\t\t\t\t#endif\n\t\t\t\t\t\t}\n\t\t\t\t\t\t#pragma unroll_loop_end\n\t\t\t\t\t#endif\n\t\t\t\t","\t#include <shadowmap_vertex>","\t#include <fog_vertex>"),i.push("vWPosition = ( modelMatrix * vec4( transformed, 1.0 ) ).xyz;"),t=i.join("\n")}else{e.mergeUniform({penumbraSize:hW.penumbraSize}),e.mergeUniform({frameIndex:hW.frameIndex}),e.mergeUniform({aoMap:hW.aoRenderTarget}),e.mergeUniform({aoEnabled:hW.aoEnabled}),void 0===this.color&&(this.color=new _H(Jk)),this.color.analyze(e,{slot:"color"}),this.shadingAlpha.analyze(e),this.shadingBlend.analyze(e),this.afterColor&&this.afterColor.analyze(e,{slot:"afterColor"}),this.alpha&&this.alpha.analyze(e);let n=this.color.flow(e,"c",{slot:"color"}),i=this.emissive.flow(e,"c",{slot:"emissive"}),r=this.emissiveIntensity.flow(e,"f",{slot:"emissive"}),s=this.occlusion.flow(e,"b",{slot:"occlusion"}),a=this.shadingAlpha.flow(e,"f"),o=this.shadingBlend.flow(e,"i"),l=this.afterColor?this.afterColor.flow(e,"c",{slot:"afterColor"}):void 0,u=this.alpha?this.alpha.flow(e,"f"):void 0,c=this.alphaOverride?this.alphaOverride.flow(e,"f"):void 0;e.requires.transparent=void 0!==u,e.addParsCode(["uniform float penumbraSize[".concat(5,"];"),"uniform sampler2D aoMap;","uniform bool aoEnabled;","varying vec3 vViewPosition;","varying vec3 vWPosition;","varying vec3 vLightFront;","varying vec3 vIndirectFront;","#ifndef DOUBLE_SIDED","   #define DOUBLE_SIDED","#endif","#include <normal_pars_fragment>","#ifdef DOUBLE_SIDED","\tvarying vec3 vLightBack;","\tvarying vec3 vIndirectBack;","#endif","#include <bsdfs>","#include <lights_pars_begin>","#include <fog_pars_fragment>","#include <shadowmap_pars_fragment>","#include <shadowmask_pars_fragment>","#include <clipping_planes_pars_fragment>","#include <dithering_pars_fragment>"].join("\n"));let h=["#include <normal_fragment_begin>","\n\t\t\t\t// NOTE: gl_FrontFacing alternative using face normal estimation.\n\t\t\t\tvec3 viewdx = dFdx(vViewPosition);\n\t\t\t\tvec3 viewdy = dFdy(vViewPosition);\n\t\t\t\tvec3 faceNormal = normalize(cross(viewdx, viewdy));\n\t\t\t\tbool isFrontFacing = (dot(normal, faceNormal) >= 0.0);\n\t\t\t\t","#include <clipping_planes_fragment>"];h.push(n.code,"vec3 diffuseColor = "+n.result+";","ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );"),u&&h.push(u.code,"#ifdef ALPHATEST","if ( "+u.result+" <= ALPHATEST ) discard;","#endif"),h.push("#ifdef DOUBLE_SIDED","\treflectedLight.indirectDiffuse += ( isFrontFacing ) ? vIndirectFront : vIndirectBack;","#else","\treflectedLight.indirectDiffuse += vIndirectFront;","#endif","#include <lightmap_fragment>","reflectedLight.indirectDiffuse *= BRDF_Lambert( diffuseColor.rgb );","#ifdef DOUBLE_SIDED","\treflectedLight.directDiffuse = ( isFrontFacing ) ? vLightFront : vLightBack;","#else","\treflectedLight.directDiffuse = vLightFront;","#endif","reflectedLight.directDiffuse *= BRDF_Lambert( diffuseColor.rgb ) * getShadowMask();"),i&&h.push(i.code,"reflectedLight.directDiffuse += "+i.result+" * "+r.result+";"),h.push("vec3 ao = aoEnabled && "+s.result+" ? tex2D(aoMap, gl_FragCoord.xy / resolution).rgb : vec3(1.0);","vec3 outgoingLight = (reflectedLight.directDiffuse + reflectedLight.indirectDiffuse) ;");let d="1.0";this.mask&&(this.mask.analyze(e),d="luminance(".concat(this.mask.flow(e,"v3").result,")")),h.push("\n\t\t\t\tif (outgoingLight != diffuseColor) {\n\t\t\t\t\tfloat lightAccu = clamp( length( reflectedLight.directSpecular + reflectedLight.indirectSpecular ), 0.0, 1.0 );\n\t\t\t\t\taccumAlpha += ( 1.0 - accumAlpha ) * ".concat(a.result," * ").concat(d," * lightAccu;\n\t\t\t\t\toutgoingLight = spe_blend( diffuseColor, outgoingLight, ").concat(a.result," * ").concat(d,", ").concat(o.result," );\n\n\t\t\t\t\toutgoingLight *= ao;\n\t\t\t\t}\n\t\t\t\t")),l&&h.push(l.code,"outgoingLight = spe_blend(outgoingLight, ".concat(l.result,", 1.0, SPE_BLENDING_NORMAL);")),u?h.push("gl_FragColor = vec4( outgoingLight, accumAlpha * ".concat(u.result," );")):h.push("gl_FragColor = vec4( outgoingLight, 1.0 );"),c&&h.push("gl_FragColor.a *= ".concat(c.result,";")),h.push("#include <encodings_fragment>","#include <fog_fragment>","#include <dithering_fragment>"),t=h.join("\n")}return t}},gW={dHdxy:new WV("vec2 dHdxy(sampler2D bumpMap, vec2 bumpMapUv, float bumpScale) {\n\n            // Gradient of UVs w.r.t. X coordinate (in screen-space)\n            vec2 dSTdx = dFdx(bumpMapUv);\n\n            // Gradient of UVs w.r.t. Y coordinate (in screen-space)\n            vec2 dSTdy = dFdy(bumpMapUv);\n            \n            // Forward differencing\n            float Hll = bumpScale * luminance(texture(bumpMap, bumpMapUv).rgb);\n            float dBx = bumpScale * luminance(texture(bumpMap, bumpMapUv + dSTdx).rgb) - Hll;\n            float dBy = bumpScale * luminance(texture(bumpMap, bumpMapUv + dSTdy).rgb) - Hll;\n            \n            return vec2( dBx, dBy );\n        }"),perturbNormalArb:new WV("vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {\n            vec3 vSigmaX = dFdx( surf_pos.xyz );\n            vec3 vSigmaY = dFdy( surf_pos.xyz );\n            vec3 vN = surf_norm; // normalized\n            \n            vN = normalize(vN);\n\n            vec3 R1 = cross( vSigmaY, vN );\n            vec3 R2 = cross( vN, vSigmaX );\n\n            R1 = normalize(R1);\n            R2 = normalize(R2);\n    \n            float fDet = dot( vSigmaX, R1 ) * faceDirection;\n    \n            vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n            return normalize( abs( fDet ) * vN - vGrad );\n        }")},vW=class extends IV{constructor(){super("phong"),this.nodeType="Phong",this.color=new _H(Jk),this.specular=new _H(1118481),this.shininess=new nH(30),this.previousModelViewMatrix=new FH,this.previouseProjectionMatrix=new FH,this.shadingAlpha=new nH(1),this.shadingBlend=new SH(0),this.occlusion=new EH(!0)}get category(){return"phong"}build(e){let t;if(e.define("PHONG"),e.requires.lights=!0,e.extensions.derivatives=!0,e.isShader("vertex")){let n=this.position?this.position.analyzeAndFlow(e,"v3",{cache:"position"}):void 0;e.mergeUniform({frameIndex:hW.frameIndex}),e.mergeUniform({resolution:hW.resolution}),e.mergeUniform({previousModelViewMatrix:this.previousModelViewMatrix}),e.mergeUniform({previousProjectionMatrix:this.previouseProjectionMatrix}),e.mergeUniform(Ox.merge([Zx.fog,Zx.lights])),e.addParsCode(["varying vec3 vViewPosition;","varying vec3 vWPosition;","#include <fog_pars_vertex>","#include <skinning_pars_vertex>","#include <normal_pars_vertex>","#include <morphtarget_pars_vertex>","#include <shadowmap_pars_vertex>","#include <clipping_planes_pars_vertex>"].join("\n"));let i=["#include <beginnormal_vertex>","#include <morphnormal_vertex>","\n\t\t\t\t#include <skinbase_vertex>\n\t\t\t\t#include <skinnormal_vertex>\n\t\t\t\t#ifndef USE_LAYER_DISPLACE\n\t\t\t\t\t#include <defaultnormal_vertex>\n\t\t\t\t#endif\n\n\t\t\t\tvec3 displaced_position = position;\n\t\t\t\tvec3 displaced_normal = objectNormal;\n\n\t\t\t\t#ifdef USE_LAYER_DISPLACE\n\t\t\t\t\tvec3 transformed;\n\t\t\t\t\tvec3 transformedNormal;\n\t\t\t\t#endif\n\t\t\t\t","#include <normal_vertex>","\n\t\t\t\t#ifndef USE_LAYER_DISPLACE\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t#endif\n\t\t\t\t"];n&&i.push(n.code,n.result?"displaced_position = "+n.result+";":""),i.push("transformed = displaced_position;","#include <morphtarget_vertex>","#include <skinning_vertex>","transformedNormal = normalMatrix * displaced_normal;","#ifndef FLAT_SHADED","    vNormal = transformedNormal;","#endif"),i.push("\t#include <project_vertex>","\t#include <clipping_planes_vertex>","\tvViewPosition = - mvPosition.xyz;","\t#include <worldpos_vertex>","\t#include <shadowmap_vertex>","\t#include <fog_vertex>"),i.push("vWPosition = ( modelMatrix * vec4( transformed, 1.0 ) ).xyz;"),t=i.join("\n")}else{e.mergeUniform({penumbraSize:hW.penumbraSize}),e.mergeUniform({frameIndex:hW.frameIndex}),e.mergeUniform({aoMap:hW.aoRenderTarget}),e.mergeUniform({aoEnabled:hW.aoEnabled}),void 0===this.color&&(this.color=new _H(Jk)),this.color.analyze(e,{slot:"color"}),this.specular.analyze(e),this.shininess.analyze(e);let n=this.occlusion.flow(e,"b",{slot:"occlusion"});this.shadingAlpha.analyze(e),this.shadingBlend.analyze(e),this.afterColor&&this.afterColor.analyze(e,{slot:"afterColor"}),this.alpha&&this.alpha.analyze(e);let i=this.color.flow(e,"c",{slot:"color"}),r=this.specular.flow(e,"c"),s=this.shininess.flow(e,"f"),a=this.shadingAlpha.flow(e,"f"),o=this.shadingBlend.flow(e,"i"),l=this.afterColor?this.afterColor.flow(e,"c",{slot:"afterColor"}):void 0,u=this.alpha?this.alpha.flow(e,"f"):void 0,c=this.alphaOverride?this.alphaOverride.flow(e,"f"):void 0;e.requires.transparent=void 0!==u,e.addParsCode(["varying vec3 vWPosition;","uniform vec3 emissive;","uniform float penumbraSize[".concat(5,"];"),"uniform sampler2D aoMap;","uniform bool aoEnabled;","#include <normal_pars_fragment>","#include <fog_pars_fragment>","#include <bsdfs>","#include <lights_pars_begin>","#include <lights_phong_pars_fragment>","#include <shadowmap_pars_fragment>","#include <dithering_pars_fragment>"].join("\n"));let h=["#include <normal_fragment_begin>","\n\t\t\t\t// NOTE: gl_FrontFacing alternative using face normal estimation.\n\t\t\t\tvec3 viewdx = dFdx(vViewPosition);\n\t\t\t\tvec3 viewdy = dFdy(vViewPosition);\n\t\t\t\tvec3 faceNormal = normalize(cross(viewdx,viewdy));\n\t\t\t\tif (dot(normal, faceNormal) < 0.0) {\n\t\t\t\t\tnormal *= -1.0;\n\t\t\t\t}\n\t\t\t\t","\tBlinnPhongMaterial material;"];if(this.bumpMap){e.include(gW.dHdxy),e.include(gW.perturbNormalArb);let t=this.bumpMap.texture.flow(e,"t"),n=this.bumpMap.flow(e,"v3"),i=this.bumpMapIntensity?this.bumpMapIntensity.flow(e,"f").result:"1.0",r="";r=4===this.bumpMap.projection.value?"\n\t\t\t\t\tvec3 bumpNormal = vec3(0.0);\n\t\t\t\t\t{\n\t\t\t\t\t\tvec2 uv0 = g".concat(this.bumpMap.uuid.toString().replace(/-/g,""),"_writeUvs0;\n\t\t\t\t\t\tvec2 uv1 = g").concat(this.bumpMap.uuid.toString().replace(/-/g,""),"_writeUvs1;\n\t\t\t\t\t\tvec2 uv2 = g").concat(this.bumpMap.uuid.toString().replace(/-/g,""),"_writeUvs2;\n\t\t\t\t\t\tvec3 weights = g").concat(this.bumpMap.uuid.toString().replace(/-/g,""),"_triplanarWeights;\n\n\t\t\t\t\t\tvec2 grad0 = dHdxy(").concat(t.result,", uv0, ").concat(i,");\n\t\t\t\t\t\tvec3 n0 = perturbNormalArb(-vViewPosition, normal, grad0, faceDirection);\n\n\t\t\t\t\t\tvec2 grad1 = dHdxy(").concat(t.result,", uv1, ").concat(i,");\n\t\t\t\t\t\tvec3 n1 = perturbNormalArb(-vViewPosition, normal, grad1, faceDirection);\n\n\t\t\t\t\t\tvec2 grad2 = dHdxy(").concat(t.result,", uv2, ").concat(i,");\n\t\t\t\t\t\tvec3 n2 = perturbNormalArb(-vViewPosition, normal, grad2, faceDirection);\n\t\t\t\t\t\t\n\t\t\t\t\t\tbumpNormal = n0 * weights.z + n1 * weights.x + n2 * weights.y;\n\t\t\t\t\t\tbumpNormal = normalize(bumpNormal);\n\t\t\t\t\t}\n\n\t\t\t\t\tnormal = bumpNormal;\n\t\t\t\t\t"):"\n\t\t\t\t\tvec2 bumpMapCachedUv = g".concat(this.bumpMap.uuid.toString().replace(/-/g,""),"_writeUvs;\n\t\t\t\t\tvec2 grad = dHdxy(").concat(t.result,", bumpMapCachedUv, ").concat(i,");\n\t\t\t\t\tnormal = perturbNormalArb( - vViewPosition, normal, grad, faceDirection );\n\t\t\t\t\t"),h.push("// Call the Texture Layer's function once here so that it writes out its procedural UV coordinates\n\t\t\t\t\t".concat(n.result,";\n\t\t\t\t\t").concat(r,"\n\t\t\t\t\t"))}h.push(i.code,"\tvec3 diffuseColor = "+i.result+";","\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );","\tvec3 totalEmissiveRadiance = emissive;",r.code,"\tvec3 specular = "+r.result+";",s.code,"\tfloat shininess = max( 0.0001, "+s.result+" );","\tfloat specularStrength = 1.0;"),u&&h.push(u.code,"#ifdef ALPHATEST","if ( "+u.result+" <= ALPHATEST ) discard;","#endif"),h.push("material.diffuseColor = diffuseColor;"),h.push("material.specularColor = specular;","material.specularShininess = shininess;","material.specularStrength = specularStrength;","#include <lights_fragment_begin>","#include <lights_fragment_end>"),h.push("vec3 ao = aoEnabled && "+n.result+" ? tex2D(aoMap, gl_FragCoord.xy / resolution).rgb : vec3(1.0);","vec3 outgoingLight = ((reflectedLight.directDiffuse + reflectedLight.indirectDiffuse)) + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;");let d="1.0";this.mask&&(this.mask.analyze(e),d="luminance(".concat(this.mask.flow(e,"v3").result,")")),h.push("\n\t\t\t\tif (outgoingLight != diffuseColor) {\n\t\t\t\t\tfloat lightAccu = clamp( length( reflectedLight.directSpecular + reflectedLight.indirectSpecular ), 0.0, 1.0 );\n\t\t\t\t\taccumAlpha += ( 1.0 - accumAlpha ) * ".concat(a.result," * ").concat(d," * lightAccu;\n\t\t\t\t\toutgoingLight = spe_blend( diffuseColor, outgoingLight, ").concat(a.result," * ").concat(d,", ").concat(o.result," );\n\t\t\t\t\t\n\t\t\t\t\toutgoingLight *= ao;\n\t\t\t\t}\n\t\t\t\t")),l&&h.push(l.code,"outgoingLight = spe_blend(outgoingLight, ".concat(l.result,", 1.0, SPE_BLENDING_NORMAL);")),u?h.push("gl_FragColor = vec4( outgoingLight, accumAlpha * ".concat(u.result,");")):h.push("gl_FragColor = vec4( outgoingLight, 1.0 );"),c&&h.push("gl_FragColor.a *= ".concat(c.result,";")),h.push("#include <encodings_fragment>","#include <fog_fragment>","#include <dithering_fragment>"),t=h.join("\n")}return t}},yW=class extends IV{constructor(){super("standard"),this.nodeType="Standard",this.color=new _H(Jk),this.roughness=new nH(.3),this.metalness=new nH(0),this.reflectivity=new nH(.5),this.previousModelViewMatrix=new FH,this.previouseProjectionMatrix=new FH,this.shadingAlpha=new nH(1),this.shadingBlend=new SH(0),this.occlusion=new EH(!0)}get category(){return"physical"}build(e){let t;if(e.define("STANDARD"),e.requires.lights=!0,e.extensions.derivatives=!0,e.extensions.shaderTextureLOD=!0,e.isShader("vertex")){let n=this.position?this.position.analyzeAndFlow(e,"v3",{cache:"position"}):void 0;e.mergeUniform({frameIndex:hW.frameIndex}),e.mergeUniform({resolution:hW.resolution}),e.mergeUniform({previousModelViewMatrix:this.previousModelViewMatrix}),e.mergeUniform({previousProjectionMatrix:this.previouseProjectionMatrix}),e.mergeUniform(Ox.merge([Zx.fog,Zx.lights])),Zx.LTC_1&&(e.uniforms.ltc_1={value:void 0},e.uniforms.ltc_2={value:void 0}),e.addParsCode(["varying vec3 vViewPosition;","varying vec3 vWPosition;","#include <fog_pars_vertex>","#include <skinning_pars_vertex>","#include <normal_pars_vertex>","#include <morphtarget_pars_vertex>","#include <shadowmap_pars_vertex>","#include <clipping_planes_pars_vertex>"].join("\n"));let i=["#include <beginnormal_vertex>","#include <morphnormal_vertex>","\n\t\t\t\t#include <skinbase_vertex>\n\t\t\t\t#include <skinnormal_vertex>\n\t\t\t\t#if !defined( USE_LAYER_DISPLACE )\n\t\t\t\t\t#include <defaultnormal_vertex>\n\t\t\t\t#endif\n\n\t\t\t\tvec3 displaced_position = position;\n\t\t\t\tvec3 displaced_normal = objectNormal;\n\n\t\t\t\t#if defined( USE_LAYER_DISPLACE )\n\t\t\t\t\tvec3 transformed;\n\t\t\t\t\tvec3 transformedNormal;\n\t\t\t\t#endif\n\t\t\t\t","#include <normal_vertex>","\n\t\t\t\t#if !defined( USE_LAYER_DISPLACE )\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t#endif /* !USE_LAYER_DISPLACE */\n\t\t\t\t"];n&&i.push(n.code,n.result?"displaced_position = "+n.result+";":""),i.push("transformed = displaced_position;","#include <morphtarget_vertex>","#include <skinning_vertex>","transformedNormal = normalMatrix * displaced_normal;","#ifndef FLAT_SHADED","    vNormal = transformedNormal;","#endif"),i.push("#include <project_vertex>","#include <fog_vertex>","#include <clipping_planes_vertex>","\tvViewPosition = - mvPosition.xyz;","#include <worldpos_vertex>","#include <shadowmap_vertex>"),i.push("vWPosition = ( modelMatrix * vec4( transformed, 1.0 ) ).xyz;"),t=i.join("\n")}else{e.mergeUniform({penumbraSize:hW.penumbraSize}),e.mergeUniform({frameIndex:hW.frameIndex}),e.mergeUniform({aoMap:hW.aoRenderTarget}),e.mergeUniform({aoEnabled:hW.aoEnabled});let n={gamma:!0};void 0===this.color&&(this.color=new _H(Jk)),this.color.analyze(e,{slot:"color",context:n}),this.roughness.analyze(e),this.metalness.analyze(e);let i=this.occlusion.flow(e,"b",{slot:"occlusion"});this.shadingAlpha.analyze(e),this.shadingBlend.analyze(e),this.afterColor&&this.afterColor.analyze(e,{slot:"afterColor"}),this.alpha&&this.alpha.analyze(e),this.reflectivity&&this.reflectivity.analyze(e);let r=this.color.flow(e,"c",{slot:"color",context:n}),s=this.roughness.flow(e,"f"),a=this.metalness.flow(e,"f"),o=this.shadingAlpha.flow(e,"f"),l=this.shadingBlend.flow(e,"i"),u=this.afterColor?this.afterColor.flow(e,"c",{slot:"afterColor"}):void 0,c=this.alpha?this.alpha.flow(e,"f"):void 0,h=this.alphaOverride?this.alphaOverride.flow(e,"f"):void 0,d=this.reflectivity?this.reflectivity.flow(e,"f"):void 0;e.requires.transparent=void 0!==c,e.addParsCode(["varying vec3 vViewPosition;","varying vec3 vWPosition;","uniform float penumbraSize[".concat(5,"];"),"uniform sampler2D aoMap;","uniform bool aoEnabled;","#include <normal_pars_fragment>","#include <dithering_pars_fragment>","#include <fog_pars_fragment>","#include <bsdfs>","#include <lights_pars_begin>","#include <lights_physical_pars_fragment>","#include <shadowmap_pars_fragment>"].join("\n"));let p=["#include <clipping_planes_fragment>","\t#include <normal_fragment_begin>","\n\t\t\t\t// NOTE: gl_FrontFacing alternative using face normal estimation.\n\t\t\t\tvec3 viewdx = dFdx(vViewPosition);\n\t\t\t\tvec3 viewdy = dFdy(vViewPosition);\n\t\t\t\tvec3 faceNormal = normalize(cross(viewdx,viewdy));\n\t\t\t\tif (dot(normal, faceNormal) < 0.0) {\n\t\t\t\t\tnormal *= -1.0;\n\t\t\t\t}\n\t\t\t\t","\tPhysicalMaterial material;","\tmaterial.diffuseColor = vec3( 1.0 );"];if(this.bumpMap){e.include(gW.dHdxy),e.include(gW.perturbNormalArb);let t=this.bumpMap.texture.flow(e,"t"),n=this.bumpMap.flow(e,"v3"),i=this.bumpMapIntensity?this.bumpMapIntensity.flow(e,"f").result:"1.0",r="";r=4===this.bumpMap.projection.value?"\n\t\t\t\t\tvec3 bumpNormal = vec3(0.0);\n\t\t\t\t\t{\n\t\t\t\t\t\tvec2 uv0 = g".concat(this.bumpMap.uuid.toString().replace(/-/g,""),"_writeUvs0;\n\t\t\t\t\t\tvec2 uv1 = g").concat(this.bumpMap.uuid.toString().replace(/-/g,""),"_writeUvs1;\n\t\t\t\t\t\tvec2 uv2 = g").concat(this.bumpMap.uuid.toString().replace(/-/g,""),"_writeUvs2;\n\t\t\t\t\t\tvec3 weights = g").concat(this.bumpMap.uuid.toString().replace(/-/g,""),"_triplanarWeights;\n\n\t\t\t\t\t\tvec2 grad0 = dHdxy(").concat(t.result,", uv0, ").concat(i,");\n\t\t\t\t\t\tvec3 n0 = perturbNormalArb(-vViewPosition, normal, grad0, faceDirection);\n\n\t\t\t\t\t\tvec2 grad1 = dHdxy(").concat(t.result,", uv1, ").concat(i,");\n\t\t\t\t\t\tvec3 n1 = perturbNormalArb(-vViewPosition, normal, grad1, faceDirection);\n\n\t\t\t\t\t\tvec2 grad2 = dHdxy(").concat(t.result,", uv2, ").concat(i,");\n\t\t\t\t\t\tvec3 n2 = perturbNormalArb(-vViewPosition, normal, grad2, faceDirection);\n\t\t\t\t\t\t\n\t\t\t\t\t\tbumpNormal = n0 * weights.z + n1 * weights.x + n2 * weights.y;\n\t\t\t\t\t\tbumpNormal = normalize(bumpNormal);\n\t\t\t\t\t}\n\n\t\t\t\t\tnormal = bumpNormal;\n\t\t\t\t\t"):"\n\t\t\t\t\tvec2 bumpMapCachedUv = g".concat(this.bumpMap.uuid.toString().replace(/-/g,""),"_writeUvs;\n\t\t\t\t\tvec2 grad = dHdxy(").concat(t.result,", bumpMapCachedUv, ").concat(i,");\n\t\t\t\t\tnormal = perturbNormalArb( - vViewPosition, normal, grad, faceDirection );\n\t\t\t\t\t"),p.push("// Call the Texture Layer's function once here so that it writes out its procedural UV coordinates\n\t\t\t\t\t".concat(n.result,";\n\t\t\t\t\t").concat(r,"\n\t\t\t\t\t"))}if(p.push(r.code,"\tvec3 diffuseColor = "+r.result+";","\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );",a.code,"\tfloat metalnessFactor = "+a.result+";"),this.roughnessMap){let t=this.roughnessMap.texture.flow(e,"t"),n=this.roughnessMap.flow(e,"v3"),i="";i=4===this.roughnessMap.projection.value?"\n\t\t\t\t\tfloat roughnessChange = 1.0;\n\t\t\t\t\t{\n\t\t\t\t\t\tvec2 uv0 = g".concat(this.roughnessMap.uuid.toString().replace(/-/g,""),"_writeUvs0;\n\t\t\t\t\t\tvec2 uv1 = g").concat(this.roughnessMap.uuid.toString().replace(/-/g,""),"_writeUvs1;\n\t\t\t\t\t\tvec2 uv2 = g").concat(this.roughnessMap.uuid.toString().replace(/-/g,""),"_writeUvs2;\n\t\t\t\t\t\tvec3 weights = g").concat(this.roughnessMap.uuid.toString().replace(/-/g,""),"_triplanarWeights;\n\n\t\t\t\t\t\tfloat r0 = luminance(texture(").concat(t.result,", uv0).rgb) * roughnessScale;\n\t\t\t\t\t\tfloat r1 = luminance(texture(").concat(t.result,", uv1).rgb) * roughnessScale;\n\t\t\t\t\t\tfloat r2 = luminance(texture(").concat(t.result,", uv2).rgb) * roughnessScale;\n\n\t\t\t\t\t\troughnessChange = (r0 * weights.z + r1 * weights.x + r2 * weights.y);\n\t\t\t\t\t}\n\t\t\t\t\tfloat roughnessFactor = roughnessChange * ").concat(s.result,";\n\t\t\t\t\t"):"\n\t\t\t\t\tvec2 roughnessMapCachedUv = g".concat(this.roughnessMap.uuid.toString().replace(/-/g,""),"_writeUvs;\n\n\t\t\t\t\tvec4 vals = texture(").concat(t.result,",  roughnessMapCachedUv);\n\t\t\t\t\tfloat roughnessFactor = luminance(vals.rgb) * ").concat(s.result,";\n\t\t\t\t\t"),p.push("// Call the Texture Layer's function once here so that it writes out its procedural UV coordinates\n\t\t\t\t\t".concat(n.result,";\n\n\t\t\t\t\tconst float roughnessScale = 1.0;\n\n\t\t\t\t\t").concat(i,"\n\t\t\t\t"))}else p.push(s.code,"\tfloat roughnessFactor = "+s.result+";");c&&p.push(c.code,"#ifdef ALPHATEST","\tif ( "+c.result+" <= ALPHATEST ) discard;","#endif"),p.push("vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );","float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );"),p.push("material.diffuseColor = diffuseColor * ( 1.0 - metalnessFactor );","material.roughness = max( roughnessFactor, 0.0525 );","material.roughness += geometryRoughness;","material.roughness = min( material.roughness, 1.0 );","material.roughness = clamp( roughnessFactor, 0.04, 1.0 );"),d?p.push(d.code,"material.specularColor = mix( vec3( 0.16 * pow2( "+d.result+" ) ), diffuseColor, metalnessFactor );"):p.push("material.specularColor = mix( vec3( 0.04 ), diffuseColor, metalnessFactor );"),p.push("#include <lights_fragment_begin>"),p.push("#include <lights_fragment_end>"),p.push("vec3 ao = aoEnabled && "+i.result+" ? tex2D(aoMap, gl_FragCoord.xy / resolution).rgb : vec3(1.0);","vec3 outgoingLight = ((reflectedLight.directDiffuse + reflectedLight.indirectDiffuse)) + reflectedLight.directSpecular + reflectedLight.indirectSpecular;");let f="1.0";this.mask&&(this.mask.analyze(e),f="luminance(".concat(this.mask.flow(e,"v3").result,")")),p.push("\n\t\t\t\tif (outgoingLight != diffuseColor) {\n\t\t\t\t\tfloat lightAccu = clamp( length( reflectedLight.directSpecular + reflectedLight.indirectSpecular ), 0.0, 1.0 );\n\t\t\t\t\taccumAlpha += ( 1.0 - accumAlpha ) * ".concat(o.result," * ").concat(f," * lightAccu;\n\t\t\t\t\toutgoingLight = spe_blend( diffuseColor, outgoingLight, ").concat(o.result," * ").concat(f,", ").concat(l.result," );\n\t\t\t\t\t\n\t\t\t\t\toutgoingLight *= ao;\n\t\t\t\t}\n\t\t\t\t")),u&&p.push(u.code,"outgoingLight = spe_blend(outgoingLight, ".concat(u.result,", 1.0, SPE_BLENDING_NORMAL);")),c?p.push("gl_FragColor = vec4( outgoingLight, accumAlpha * ".concat(c.result," );")):p.push("gl_FragColor = vec4( outgoingLight, 1.0 );"),h&&p.push("gl_FragColor.a *= ".concat(h.result,";")),p.push("#include <encodings_fragment>","#include <fog_fragment>","#include <dithering_fragment>"),t=p.join("\n")}return t}},xW=class extends IV{constructor(){super("toon"),this.nodeType="Toon",this.color=new _H(Jk),this.specular=new _H(1118481),this.shininess=new nH(30),this.previousModelViewMatrix=new FH,this.previouseProjectionMatrix=new FH,this.shadingAlpha=new nH(1),this.shadingBlend=new SH(0)}get category(){return"toon"}build(e){let t;if(e.define("TOON"),e.requires.lights=!0,e.extensions.derivatives=!0,e.isShader("vertex")){let n=this.position?this.position.analyzeAndFlow(e,"v3",{cache:"position"}):void 0;e.mergeUniform({frameIndex:hW.frameIndex}),e.mergeUniform({resolution:hW.resolution}),e.mergeUniform({previousModelViewMatrix:this.previousModelViewMatrix}),e.mergeUniform({previousProjectionMatrix:this.previouseProjectionMatrix}),e.mergeUniform(Ox.merge([Zx.fog,Zx.lights])),e.addParsCode(["varying vec3 vViewPosition;","varying vec3 vWPosition;","#include <fog_pars_vertex>","#include <skinning_pars_vertex>","#include <normal_pars_vertex>","#include <morphtarget_pars_vertex>","#include <shadowmap_pars_vertex>","#include <clipping_planes_pars_vertex>"].join("\n"));let i=["#include <beginnormal_vertex>","#include <morphnormal_vertex>","\n\t\t\t\t#include <skinbase_vertex>\n\t\t\t\t#include <skinnormal_vertex>\n\t\t\t\t#ifndef USE_LAYER_DISPLACE\n\t\t\t\t\t#include <defaultnormal_vertex>\n\t\t\t\t#endif\n\n\t\t\t\tvec3 displaced_position = position;\n\t\t\t\tvec3 displaced_normal = objectNormal;\n\n\t\t\t\t#ifdef USE_LAYER_DISPLACE\n\t\t\t\t\tvec3 transformed;\n\t\t\t\t\tvec3 transformedNormal;\n\t\t\t\t#endif\n\t\t\t\t","#include <normal_vertex>","\n\t\t\t\t#ifndef USE_LAYER_DISPLACE\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t#endif\n\t\t\t\t"];n&&i.push(n.code,n.result?"displaced_position = "+n.result+";":""),i.push("transformed = displaced_position;","#include <morphtarget_vertex>","#include <skinning_vertex>","transformedNormal = normalMatrix * displaced_normal;","#ifndef FLAT_SHADED","    vNormal = transformedNormal;","#endif"),i.push("\t#include <project_vertex>","\t#include <fog_vertex>","\t#include <clipping_planes_vertex>","\tvViewPosition = - mvPosition.xyz;","\t#include <worldpos_vertex>","\t#include <shadowmap_vertex>","\t#include <fog_vertex>"),i.push("vWPosition = ( modelMatrix * vec4( transformed, 1.0 ) ).xyz;"),t=i.join("\n")}else{e.mergeUniform({penumbraSize:hW.penumbraSize}),e.mergeUniform({frameIndex:hW.frameIndex}),e.mergeUniform({aoMap:hW.aoRenderTarget}),e.mergeUniform({aoEnabled:hW.aoEnabled}),void 0===this.color&&(this.color=new _H(Jk)),this.color.analyze(e,{slot:"color"}),this.specular.analyze(e),this.shininess.analyze(e),this.shadingAlpha.analyze(e),this.shadingBlend.analyze(e),this.afterColor&&this.afterColor.analyze(e,{slot:"afterColor"}),this.alpha&&this.alpha.analyze(e);let n=this.color.flow(e,"c",{slot:"color"}),i=this.specular.flow(e,"c"),r=this.shininess.flow(e,"f"),s=this.shadingAlpha.flow(e,"f"),a=this.shadingBlend.flow(e,"i"),o=this.afterColor?this.afterColor.flow(e,"c",{slot:"afterColor"}):void 0,l=this.alpha?this.alpha.flow(e,"f"):void 0,u=this.alphaOverride?this.alphaOverride.flow(e,"f"):void 0;e.requires.transparent=void 0!==l,e.addParsCode(["uniform float penumbraSize[".concat(5,"];"),"uniform sampler2D aoMap;","uniform bool aoEnabled;","varying vec3 vWPosition;","#include <normal_pars_fragment>","#include <gradientmap_pars_fragment>","#include <fog_pars_fragment>","#include <bsdfs>","#include <lights_pars_begin>","#include <dithering_pars_fragment>","\n\t\t\t\t\tvarying vec3 vViewPosition;\n\t\t\t\t\tstruct ToonMaterial {\n\t\t\t\t\t\tvec3\tdiffuseColor;\n\t\t\t\t\t\tvec3\tspecularColor;\n\t\t\t\t\t\tfloat\tspecularShininess;\n\t\t\t\t\t\tfloat\tspecularStrength;\n\t\t\t\t\t};\n\t\t\t\t\tvoid RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\t\t\t\t\t\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\t\t\t\n\t\t\t\t\t\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n\t\t\t\t\t\treflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularShininess ) * material.specularStrength;\n\t\t\t\t\t}\n\t\t\t\t\tvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\t\t\t\t\t\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n\t\t\t\t\t}\n\t\t\t\t\t#define RE_Direct\t\t\t\tRE_Direct_Toon\n\t\t\t\t\t#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Toon\n\t\t\t\t\t#define Material_LightProbeLOD( material )\t(0)\n\t\t\t\t\t","#include <shadowmap_pars_fragment>","#include <bumpmap_pars_fragment>","#include <normalmap_pars_fragment>"].join("\n"));let c=["#include <normal_fragment_begin>","\n\t\t\t\t// NOTE: gl_FrontFacing alternative using face normal estimation.\n\t\t\t\tvec3 viewdx = dFdx(vViewPosition);\n\t\t\t\tvec3 viewdy = dFdy(vViewPosition);\n\t\t\t\tvec3 faceNormal = normalize(cross(viewdx,viewdy));\n\t\t\t\tif (dot(normal, faceNormal) < 0.0) {\n\t\t\t\t\tnormal *= -1.0;\n\t\t\t\t}\n\t\t\t\t","\tToonMaterial material;"];if(this.bumpMap){e.include(gW.dHdxy),e.include(gW.perturbNormalArb);let t=this.bumpMap.texture.flow(e,"t"),n=this.bumpMap.flow(e,"v3"),i=this.bumpMapIntensity?this.bumpMapIntensity.flow(e,"f").result:"1.0",r="";r=4===this.bumpMap.projection.value?"\n\t\t\t\t\tvec3 bumpNormal = vec3(0.0);\n\t\t\t\t\t{\n\t\t\t\t\t\tvec2 uv0 = g".concat(this.bumpMap.uuid.toString().replace(/-/g,""),"_writeUvs0;\n\t\t\t\t\t\tvec2 uv1 = g").concat(this.bumpMap.uuid.toString().replace(/-/g,""),"_writeUvs1;\n\t\t\t\t\t\tvec2 uv2 = g").concat(this.bumpMap.uuid.toString().replace(/-/g,""),"_writeUvs2;\n\t\t\t\t\t\tvec3 weights = g").concat(this.bumpMap.uuid.toString().replace(/-/g,""),"_triplanarWeights;\n\n\t\t\t\t\t\tvec2 grad0 = dHdxy(").concat(t.result,", uv0, ").concat(i,");\n\t\t\t\t\t\tvec3 n0 = perturbNormalArb(-vViewPosition, normal, grad0, faceDirection);\n\n\t\t\t\t\t\tvec2 grad1 = dHdxy(").concat(t.result,", uv1, ").concat(i,");\n\t\t\t\t\t\tvec3 n1 = perturbNormalArb(-vViewPosition, normal, grad1, faceDirection);\n\n\t\t\t\t\t\tvec2 grad2 = dHdxy(").concat(t.result,", uv2, ").concat(i,");\n\t\t\t\t\t\tvec3 n2 = perturbNormalArb(-vViewPosition, normal, grad2, faceDirection);\n\t\t\t\t\t\t\n\t\t\t\t\t\tbumpNormal = n0 * weights.z + n1 * weights.x + n2 * weights.y;\n\t\t\t\t\t\tbumpNormal = normalize(bumpNormal);\n\t\t\t\t\t}\n\n\t\t\t\t\tnormal = bumpNormal;\n\t\t\t\t\t"):"\n\t\t\t\t\tvec2 bumpMapCachedUv = g".concat(this.bumpMap.uuid.toString().replace(/-/g,""),"_writeUvs;\n\t\t\t\t\tvec2 grad = dHdxy(").concat(t.result,", bumpMapCachedUv, ").concat(i,");\n\t\t\t\t\tnormal = perturbNormalArb( - vViewPosition, normal, grad, faceDirection );\n\t\t\t\t\t"),c.push("// Call the Texture Layer's function once here so that it writes out its procedural UV coordinates\n\t\t\t\t\t".concat(n.result,";\n\t\t\t\t\t").concat(r,"\n\t\t\t\t\t"))}c.push(n.code,"\tvec3 diffuseColor = "+n.result+";","\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );",i.code,"\tvec3 specular = "+i.result+";",r.code,"\tfloat shininess = max( 0.0001, "+r.result+" );","\tfloat specularStrength = 1.0;"),l&&c.push(l.code,"#ifdef ALPHATEST","if ( "+l.result+" <= ALPHATEST ) discard;","#endif"),c.push("material.diffuseColor = diffuseColor;"),c.push("material.specularColor = specular;","material.specularShininess = shininess;","material.specularStrength = specularStrength;","#include <lights_fragment_begin>","#include <lights_fragment_end>"),c.push("vec3 ao = aoEnabled ? tex2D(aoMap, gl_FragCoord.xy / resolution).rgb : vec3(1.0);","vec3 outgoingLight = ((reflectedLight.directDiffuse + reflectedLight.indirectDiffuse) * ao) + reflectedLight.directSpecular;");let h="1.0";this.mask&&(this.mask.analyze(e),h="luminance(".concat(this.mask.flow(e,"v3").result,")")),c.push("\n\t\t\t\tif (outgoingLight != diffuseColor) {\n\t\t\t\t\tfloat lightAccu = clamp( length( reflectedLight.directSpecular + reflectedLight.indirectSpecular ), 0.0, 1.0 );\n\t\t\t\t\taccumAlpha += ( 1.0 - accumAlpha ) * ".concat(s.result," * ").concat(h," * lightAccu;\n\t\t\t\t\toutgoingLight = spe_blend( diffuseColor, outgoingLight, ").concat(s.result," * ").concat(h,", ").concat(a.result," );\n\t\t\t\t}\n\t\t\t\t")),o&&c.push(o.code,"outgoingLight = spe_blend(outgoingLight, ".concat(o.result,", 1.0, SPE_BLENDING_NORMAL);")),l?c.push("gl_FragColor = vec4( outgoingLight, accumAlpha * ".concat(l.result," );")):c.push("gl_FragColor = vec4( outgoingLight, 1.0 );"),u&&c.push("gl_FragColor.a *= ".concat(u.result,";")),c.push("#include <encodings_fragment>","#include <fog_fragment>","#include <dithering_fragment>"),t=c.join("\n")}return t}},bW=class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1e4;this.timeout=e,this.cache=new Map,this.head={data:null,time:0,src:null,next:null,prev:null},this.tail={data:null,time:1/0,src:null,next:null,prev:null},this.hasClean=!1,this.head.next=this.tail,this.tail.prev=this.head}log(){}remove(e){let t=this.cache.get(e);t&&(this.dispose(e,t.data),this.cache.delete(e),t.prev.next=t.next,t.next.prev=t.prev)}scheduleCleanup(){this.hasClean||(this.log("scheduled cleanup"),this.hasClean=!0,setTimeout((()=>{this.hasClean=!1,this.log("cleaning");let e=Date.now(),t=this.head.next;for(;t.time<e-this.timeout;)this.dispose(t.src,t.data),this.cache.delete(t.src),t=t.next,t.prev=this.head,this.head.next=t;this.head.next!==this.tail?this.scheduleCleanup():this.log("no more cleanup")}),this.timeout+1e3))}has(e){var t;return null===(t=this.cache.get(e))||void 0===t?void 0:t.data}load(e){let t=Date.now(),n=this.cache.get(e);return void 0===n?(n={data:this.create(e),src:e,time:t,next:null,prev:null},this.cache.set(e,n)):(n.time=t,n.prev.next=n.next,n.next.prev=n.prev),n.prev=this.tail.prev,n.next=this.tail,this.tail.prev.next=n,this.tail.prev=n,this.scheduleCleanup(),n.data}},wW=class extends bW{create(e){return URL.createObjectURL(new Blob([e]))}dispose(e,t){URL.revokeObjectURL(t)}};var DW=class{constructor(e,t){this.data=e,this.cache=t,this.refCount=0}deref(){this.refCount,this.refCount-=1,0===this.refCount&&(this.cache.remove(this),this.dispose())}dispose(){this.refCount,0}},_W=class{constructor(){this.cache=new Map}remove(e){this.cache.delete(e.data),0}load(e){let t=this.cache.get(e);return void 0===t&&(t=this.create(e),this.cache.set(e,t)),t.refCount+=1,t}},SW=class extends DW{constructor(e,t){super(e,t.imageHolderCache),this.data=e,this.shared=t,this.loaded=!1,this.isVideo=!1,this.isBuffer=!1,this._cache={1e3:{},1001:{},1002:{}},this.isVideo="video"===e.type,this.isBuffer=!0===e.isWebGLRenderTarget,this.loadPromise=this.updateSrc(this.isBuffer?e:e.data)}async updateSrc(e){if(typeof document>"u")return;this.disposeTextures(),this.loaded=!1;let t=()=>{this.loaded=!0;for(let e of Object.values(this._cache))for(let t of Object.values(e))for(let e of Object.values(t))e&&(e.image=this.img,e.needsUpdate=!0);this.shared.requestRender()};if(this.isBuffer)this.img=e,this.loaded=!0;else if(this.isVideo){if(this.img=document.createElement("video"),this.img.preload="auto",this.img.playsInline=!0,this.img.currentTime=.01,"string"!=typeof e){var n=new FileReader;let t;n.readAsDataURL(new Blob([e],{type:"video/mp4"})),await new Promise((e=>{n.onloadend=n=>{var i;t=null===(i=n.target)||void 0===i?void 0:i.result,e(null)}})),this.img.src=t}else this.img.src=e;this.img.onloadeddata=()=>{t()}}else this.img=new Image,this.img.src=function(e){return"string"==typeof e?e:(dW||(dW=new wW),dW.load(e))}(e),this.img.onload=t,await new Promise((e=>{this.img.onload=()=>{t(),e(null)}}))}getTexture(e){var t;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1008,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1006,r=null===(t=this._cache[e])||void 0===t||null===(t=t[n])||void 0===t?void 0:t[i];if(r)return r;{let t;return t=this.isBuffer?this.img.texture:this.isVideo?new JD(this.img,void 0,e,e):new Fv(this.img,void 0,e,e,i,n),this.loaded&&(t.needsUpdate=!0),void 0===this._cache[e]&&(this._cache[e]={}),void 0===this._cache[e][n]&&(this._cache[e][n]={}),this._cache[e][n][i]=t,t}}setNeedsUpdate(e){for(let t of Object.values(this._cache))for(let n of Object.values(t))for(let t of Object.values(n))t&&(t.needsUpdate=e)}disposeTextures(){for(let[e,t]of Object.entries(this._cache))for(let[n,i]of Object.entries(t))for(let[t,r]of Object.entries(i))null!==r&&void 0!==r&&r.dispose(),void 0!==this._cache[e]&&void 0!==this._cache[e][n]&&(this._cache[e][n][t]=void 0)}dispose(){super.dispose(),this.disposeTextures()}},EW=class extends SW{};function CW(e,t){var n=function(e){if(!MW[e]){var t=new Intl.DateTimeFormat("en-US",{hour12:!1,timeZone:"America/New_York",year:"numeric",month:"numeric",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"}).format(new Date("2014-06-25T04:00:00.123Z")),n="06/25/2014, 00:00:00"===t||"\u200e06\u200e/\u200e25\u200e/\u200e2014\u200e \u200e00\u200e:\u200e00\u200e:\u200e00"===t;MW[e]=n?new Intl.DateTimeFormat("en-US",{hour12:!1,timeZone:e,year:"numeric",month:"numeric",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"}):new Intl.DateTimeFormat("en-US",{hourCycle:"h23",timeZone:e,year:"numeric",month:"numeric",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"})}return MW[e]}(t);return n.formatToParts?function(e,t){try{for(var n=e.formatToParts(t),i=[],r=0;r<n.length;r++){var s=AW[n[r].type];s>=0&&(i[s]=parseInt(n[r].value,10))}return i}catch(a){if(a instanceof RangeError)return[NaN];throw a}}(n,e):function(e,t){var n=e.format(t).replace(/\u200E/g,""),i=/(\d+)\/(\d+)\/(\d+),? (\d+):(\d+):(\d+)/.exec(n);return[i[3],i[1],i[2],i[4],i[5],i[6]]}(n,e)}var AW={year:0,month:1,day:2,hour:3,minute:4,second:5};var MW={};function TW(e,t,n,i,r,s,a){var o=new Date(0);return o.setUTCFullYear(e,t,n),o.setUTCHours(i,r,s,a),o}var PW=36e5,FW={timezone:/([Z+-].*)$/,timezoneZ:/^(Z)$/,timezoneHH:/^([+-]\d{2})$/,timezoneHHMM:/^([+-]\d{2}):?(\d{2})$/};function OW(e,t,n){var i,r,s;if(!e||(i=FW.timezoneZ.exec(e)))return 0;if(i=FW.timezoneHH.exec(e))return kW(s=parseInt(i[1],10))?-s*PW:NaN;if(i=FW.timezoneHHMM.exec(e)){s=parseInt(i[1],10);var a=parseInt(i[2],10);return kW(s,a)?(r=Math.abs(s)*PW+6e4*a,s>0?-r:r):NaN}if(function(e){if(BW[e])return!0;try{return new Intl.DateTimeFormat(void 0,{timeZone:e}),BW[e]=!0,!0}catch(t){return!1}}(e)){t=new Date(t||Date.now());var o=n?t:function(e){return TW(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds())}(t),l=IW(o,e),u=n?l:function(e,t,n){var i=e.getTime(),r=i-t,s=IW(new Date(r),n);if(t===s)return t;r-=s-t;var a=IW(new Date(r),n);return s===a?s:Math.max(s,a)}(t,l,e);return-u}return NaN}function IW(e,t){var n=CW(e,t),i=TW(n[0],n[1]-1,n[2],n[3]%24,n[4],n[5],0).getTime(),r=e.getTime(),s=r%1e3;return i-(r-=s>=0?s:1e3+s)}function kW(e,t){return-23<=e&&e<=23&&(null==t||0<=t&&t<=59)}var BW={};var RW=Cm(Pm(),1),LW=Cm(Fm(),1),zW=36e5,NW=6e4,jW={dateTimePattern:/^([0-9W+-]+)(T| )(.*)/,datePattern:/^([0-9W+-]+)(.*)/,plainTime:/:/,YY:/^(\d{2})$/,YYY:[/^([+-]\d{2})$/,/^([+-]\d{3})$/,/^([+-]\d{4})$/],YYYY:/^(\d{4})/,YYYYY:[/^([+-]\d{4})/,/^([+-]\d{5})/,/^([+-]\d{6})/],MM:/^-(\d{2})$/,DDD:/^-?(\d{3})$/,MMDD:/^-?(\d{2})-?(\d{2})$/,Www:/^-?W(\d{2})$/,WwwD:/^-?W(\d{2})-?(\d{1})$/,HH:/^(\d{2}([.,]\d*)?)$/,HHMM:/^(\d{2}):?(\d{2}([.,]\d*)?)$/,HHMMSS:/^(\d{2}):?(\d{2}):?(\d{2}([.,]\d*)?)$/,timeZone:/(Z|[+-]\d{2}(?::?\d{2})?| UTC| [a-zA-Z]+\/[a-zA-Z_]+(?:\/[a-zA-Z_]+)?)$/};function UW(e,t){if(arguments.length<1)throw new TypeError("1 argument required, but only "+arguments.length+" present");if(null===e)return new Date(NaN);var n=t||{},i=null==n.additionalDigits?2:(0,RW.default)(n.additionalDigits);if(2!==i&&1!==i&&0!==i)throw new RangeError("additionalDigits must be 0, 1 or 2");if(e instanceof Date||"object"==typeof e&&"[object Date]"===Object.prototype.toString.call(e))return new Date(e.getTime());if("number"==typeof e||"[object Number]"===Object.prototype.toString.call(e))return new Date(e);if("string"!=typeof e&&"[object String]"!==Object.prototype.toString.call(e))return new Date(NaN);var r=function(e){var t,n={},i=jW.dateTimePattern.exec(e);if(i?(n.date=i[1],t=i[3]):(i=jW.datePattern.exec(e),i?(n.date=i[1],t=i[2]):(n.date=null,t=e)),t){var r=jW.timeZone.exec(t);r?(n.time=t.replace(r[1],""),n.timeZone=r[1].trim()):n.time=t}return n}(e),s=function(e,t){var n,i=jW.YYY[t],r=jW.YYYYY[t];if(n=jW.YYYY.exec(e)||r.exec(e),n){var s=n[1];return{year:parseInt(s,10),restDateString:e.slice(s.length)}}if(n=jW.YY.exec(e)||i.exec(e),n){var a=n[1];return{year:100*parseInt(a,10),restDateString:e.slice(a.length)}}return{year:null}}(r.date,i),a=s.year,o=function(e,t){if(null===t)return null;var n,i,r,s;if(0===e.length)return i=new Date(0),i.setUTCFullYear(t),i;if(n=jW.MM.exec(e),n)return i=new Date(0),r=parseInt(n[1],10)-1,qW(t,r)?(i.setUTCFullYear(t,r),i):new Date(NaN);if(n=jW.DDD.exec(e),n){i=new Date(0);var a=parseInt(n[1],10);return function(e,t){if(t<1)return!1;var n=GW(e);return!(n&&t>366||!n&&t>365)}(t,a)?(i.setUTCFullYear(t,0,a),i):new Date(NaN)}if(n=jW.MMDD.exec(e),n){i=new Date(0),r=parseInt(n[1],10)-1;var o=parseInt(n[2],10);return qW(t,r,o)?(i.setUTCFullYear(t,r,o),i):new Date(NaN)}if(n=jW.Www.exec(e),n)return s=parseInt(n[1],10)-1,YW(t,s)?VW(t,s):new Date(NaN);if(n=jW.WwwD.exec(e),n){s=parseInt(n[1],10)-1;var l=parseInt(n[2],10)-1;return YW(t,s,l)?VW(t,s,l):new Date(NaN)}return null}(s.restDateString,a);if(isNaN(o))return new Date(NaN);if(o){var l,u=o.getTime(),c=0;if(r.time&&(c=function(e){var t,n,i;if(t=jW.HH.exec(e),t)return n=parseFloat(t[1].replace(",",".")),XW(n)?n%24*zW:NaN;if(t=jW.HHMM.exec(e),t)return n=parseInt(t[1],10),i=parseFloat(t[2].replace(",",".")),XW(n,i)?n%24*zW+i*NW:NaN;if(t=jW.HHMMSS.exec(e),t){n=parseInt(t[1],10),i=parseInt(t[2],10);var r=parseFloat(t[3].replace(",","."));return XW(n,i,r)?n%24*zW+i*NW+1e3*r:NaN}return null}(r.time),isNaN(c)))return new Date(NaN);if(r.timeZone||n.timeZone){if(l=OW(r.timeZone||n.timeZone,new Date(u+c)),isNaN(l))return new Date(NaN)}else l=(0,LW.default)(new Date(u+c)),l=(0,LW.default)(new Date(u+c+l));return new Date(u+c+l)}return new Date(NaN)}function VW(e,t,n){t=t||0,n=n||0;var i=new Date(0);i.setUTCFullYear(e,0,4);var r=7*t+n+1-(i.getUTCDay()||7);return i.setUTCDate(i.getUTCDate()+r),i}var HW=[31,28,31,30,31,30,31,31,30,31,30,31],WW=[31,29,31,30,31,30,31,31,30,31,30,31];function GW(e){return e%400===0||e%4===0&&e%100!==0}function qW(e,t,n){if(t<0||t>11)return!1;if(null!=n){if(n<1)return!1;var i=GW(e);if(i&&n>WW[t]||!i&&n>HW[t])return!1}return!0}function YW(e,t,n){return!(t<0||t>52||null!=n&&(n<0||n>6))}function XW(e,t,n){return!(null!=e&&(e<0||e>=25)||null!=t&&(t<0||t>=60)||null!=n&&(n<0||n>=60))}function QW(e,t){return t.color(e)}function KW(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Date,t=arguments.length>1?arguments[1]:void 0,n=t.format,i=e.getSeconds(),r=e;t&&null!==t.timeZone&&(r=function(e,t,n){var i=UW(e,n),r=OW(t,i,!0),s=new Date(i.getTime()-r),a=new Date(0);return a.setFullYear(s.getUTCFullYear(),s.getUTCMonth(),s.getUTCDate()),a.setHours(s.getUTCHours(),s.getUTCMinutes(),s.getUTCSeconds(),s.getUTCMilliseconds()),a}(new Date,t.timeZone));let s,a=r.getHours(),o=r.getMinutes();"12ampm"===t.format12h24h&&(s=a>=12?"PM":"AM");let l,u,c=a;switch("24"!==t.format12h24h&&(c=a%12,0===c&&(c=12)),n){case"HH:mm:ss":l=[c,o,i];break;case"HH:mm":l=[c,o];break;case"HH":l=[c],s=void 0;break;case"mm":l=[o],s=void 0;break;case"ss":l=[i],s=void 0;break;case"year":u=r.getFullYear();break;case"month":u=r.getMonth()+1;break;case"dayOfYear":u=Math.floor((r.getTime()-new Date(r.getFullYear(),0,0).getTime())/864e5);break;case"dayOfMonth":u=r.getDate();break;case"secondOfDay":u=60*a*60+60*o+i;break;default:console.error("Unknown time format",n),u=0}return void 0!==l?{textValue:l,suffix:s}:u}function ZW(e,t){switch(e.type){case"fresnel":return function(e,t){let{bias:n,scale:i,intensity:r,factor:s,color:a}=e;return d(d({},JW(e,t)),{},{color:QW(a,t),bias:n,scale:i,intensity:r,factor:s})}(e,t);case"gradient":return function(e,t){let{gradientType:n,smooth:i,colors:r,steps:s,angle:a,offset:o,morph:l}=e;return d(d({},JW(e,t)),{},{gradientType:n,smooth:i,colors:r.map((e=>new Ov(e[0],e[1],e[2],e[3]))),num:r.length,steps:s,offset:new lv(...o),morph:new lv(...l),angle:a})}(e,t);case"depth":return function(e,t){let{gradientType:n,near:i,far:r,isVector:s,isWorldSpace:a,origin:o,direction:l,colors:u,steps:c,smooth:h}=e;return d(d({},JW(e,t)),{},{gradientType:n,near:i,far:r,isVector:s,isWorldSpace:a,origin:new Lv(...o),direction:l?new Lv(...l):new Lv(1,0,0),colors:u.map((e=>void 0!==e?new Ov(e[0],e[1],e[2],e[3]):new Ov(0,0,0,0))),steps:c.slice(0,u.length),smooth:h})}(e,t);case"normal":return function(e,t){let{cnormal:n}=e;return d(d({},JW(e,t)),{},{cnormal:new Lv(n[0],n[1],n[2])})}(e,t);case"noise":return function(e,t){return d(d({},JW(e,t)),{},{scale:e.scale,move:e.move,fA:new lv(...e.fA),fB:new lv(...e.fB),size:new Lv(...e.size),distortion:new lv(...e.distortion),colorA:QW(e.colorA,t),colorB:QW(e.colorB,t),colorC:QW(e.colorC,t),colorD:QW(e.colorD,t),noiseType:e.noiseType,voronoiStyle:e.voronoiStyle,highCut:e.highCut,lowCut:e.lowCut,smoothness:e.smoothness,seed:e.seed,quality:e.quality})}(e,t);case"rainbow":return function(e,t){return d(d({},JW(e,t)),{},{filmThickness:e.filmThickness,movement:e.movement,wavelengths:new Lv(...e.wavelengths),noiseStrength:e.noiseStrength,noiseScale:e.noiseScale,offset:new Lv(...e.offset)})}(e,t);case"toon":return function(e,t){return d(d({},JW(e,t)),{},{positioning:e.positioning,colors:e.colors.map((e=>new Ov(e[0],e[1],e[2],e[3]))),num:e.colors.length,steps:e.steps,source:new Lv(...e.source),isWorldSpace:e.isWorldSpace,noiseStrength:e.noiseStrength,noiseScale:e.noiseScale,shadowColor:QW(e.shadowColor,t),offset:new Lv(...e.offset)})}(e,t);case"outline":return function(e,t){return d(d({},JW(e,t)),{},{outlineColor:QW(e.outlineColor,t),contourColor:QW(e.contourColor,t),outlineWidth:e.outlineWidth,contourWidth:e.contourWidth,outlineThreshold:e.outlineThreshold,contourThreshold:e.contourThreshold,outlineSmoothing:e.outlineSmoothing,contourFrequency:e.contourFrequency,contourDirection:new Lv(...e.contourDirection),positionalLines:e.positionalLines,compensation:e.compensation})}(e,t);case"transmission":return function(e,t){return d(d({},JW(e,t)),{},{thickness:e.thickness,ior:e.ior,roughness:e.roughness})}(e,t);case"color":return function(e,t){return d(d({},JW(e,t)),{},{color:QW(e.color,t)})}(e,t);case"pattern":return function(e,t){return d(d({},JW(e,t)),{},{style:e.style,projection:e.projection,axis:e.axis,blending:e.blending,offset:new lv(...e.offset),colorA:QW(e.colorA,t),colorB:QW(e.colorB,t),frequency:new lv(...e.frequency),size:e.size,variation:e.variation,smoothness:e.smoothness,zigzag:e.zigzag,rotation:e.rotation,vertical:new lv(...e.vertical),horizontal:new lv(...e.horizontal),sides:e.sides})}(e,t)}}function JW(e,t){var n;let{alpha:i,mode:r,isMask:s}=e,a="string"==typeof i?(null!==(n=Number(t.getVariable(i)))&&void 0!==n?n:100)/100:i;return d(d({},function(e){return{type:e.type}}(e)),{},{alpha:a,mode:r,isMask:s})}var $W=class extends jV{},eG={noise:["noiseType"],texture:["projection","axis","side"],video:["projection","axis","side"],displace:["noiseType"],light:["roughnessMap","bumpMap"],depth:["smooth","isWorldSpace","gradientType","isVector"],pattern:["style","projection","axis"]},tG={depth:["colors"]};function nG(e,t,n){if("isMask"===t)return!0;let i=eG[e.type],r=tG[e.type];if(void 0!==r){let i=e.color;if(r.includes(t)){var s;let e=null===(s=i[t])||void 0===s||null===(s=s.value)||void 0===s?void 0:s.length;if(void 0!==e&&e!==n.length)return!0}}return void 0!==i&&i.includes(t)}function iG(e,t,n){var i;let r=n.uniforms["f".concat(n.id,"_texture")];if(!r)return!1;let s=!1,a=e;if("image"in a){let e=a.image,n=t.image(e),i=r;i.image instanceof EW||i.image.deref(),i.image=n}if("video"in a){let e=a.video,n=t.video(e),i=r;i.image instanceof EW||i.image.deref(),i.image=n}if("wrapping"in a){r.wrap=a.wrapping}if("minFilter"in a){r.minFilter=a.minFilter}if("magFilter"in a){r.magFilter=a.magFilter}if("rotation"in a&&n.uniforms["f".concat(n.id,"_rotation")])return n.uniforms["f".concat(n.id,"_rotation")].value=(null!==(i=a.rotation)&&void 0!==i?i:0)*ov.DEG2RAD,s;if("repeat"in a||"offset"in a||"rotation"in a){var o;let e="mat",t=n.uniforms["f".concat(n.id,"_").concat(e)];"repeat"in a&&(t.repeat=a.repeat),"offset"in a&&(t.offset=a.offset),"rotation"in a&&(t.rotation=null!==(o=a.rotation)&&void 0!==o?o:0),t.updateMatrix()}return s}var rG=(e,t,n)=>{var i,r;return null!==(i=Math.max(0,Math.min(1,Number(null!==(r=t.getVariable("number"==typeof e?100*e:e,n))&&void 0!==r?r:100)/100)))&&void 0!==i?i:1},sG=class{constructor(e,t,n,i,r){this.id=e,this.uuid=t,this.data=n,this.uniforms={};for(let s in i)this.uniforms["f".concat(this.id,"_").concat(s)]=i[s];for(let s in n)cG(s,this,n,r)}get type(){return this.data.type}static create(e,t,n,i){if("light"===n.type)return lG.createLightLayer(e,t,n,i);if("texture"===n.type||"video"===n.type){var r,s,a,o,l,u,c,h,p,f;let d="texture"===n.type?null!==(r=i.uiBuffer(n.texture.image))&&void 0!==r?r:i.image(n.texture.image):i.video(n.texture.video),m=new TH(d,n.texture.wrapping,null!==(s=n.texture.minFilter)&&void 0!==s?s:1008,null!==(a=n.texture.magFilter)&&void 0!==a?a:1006),g=new MH(d),v=new IH(n.texture.repeat,n.texture.offset,null!==(o=n.texture.rotation)&&void 0!==o?o:0),y=new nH(n.crop?1:0),x=new SH(null!==(l=n.projection)&&void 0!==l?l:0),b=new SH(null!==(u=["x","y","z"].indexOf(n.axis))&&void 0!==u?u:0),w=new SH(null!==(c=n.side)&&void 0!==c?c:0),D=new zV(n.size?new lv(n.size[0],n.size[1]):new lv(100,100)),_=new nH(null!==(h=n.blending)&&void 0!==h?h:0),S=new nH(rG(n.alpha,i)),E=new SH(null!==(p=n.mode)&&void 0!==p?p:0),C=new EH(null!==(f=n.isMask)&&void 0!==f&&f),A=new UH(m,g,y,x,b,w,D,_,v,S,E,C),M=new eH(A.calpha,"f");return new aG(e,t,n,{texture:m,textureSize:g,crop:y,projection:x,axis:b,side:w,size:D,blending:_,mat:v,alpha:S,mode:E,isMask:C},A,E,M,C,i)}if("matcap"===n.type){var m,g,v,y,x;let r=i.image(n.texture.image),s=new TH(r,n.texture.wrapping,null!==(m=n.texture.minFilter)&&void 0!==m?m:1008,null!==(g=n.texture.magFilter)&&void 0!==g?g:1006),a=new nH(rG(n.alpha,i)),o=new SH(null!==(v=n.mode)&&void 0!==v?v:0),l=new EH(null!==(y=n.isMask)&&void 0!==y&&y),u=new nH((null!==(x=n.texture.rotation)&&void 0!==x?x:0)*ov.DEG2RAD),c=new XH(s,a,o,l,u),h=new eH(c.calpha,"f");return new aG(e,t,n,{texture:s,alpha:a,mode:o,isMask:l,rotation:u},c,o,h,l,i)}if("displace"===n.type){if("noise"===n.displacementType){var b,w,D,_,S,E,C,A,M,T;let r=new NV(new Lv(...n.offset)),s=new nH(null!==(b=n.scale)&&void 0!==b?b:10),a=new nH(null!==(w=n.intensity)&&void 0!==w?w:8),o=new nH(null!==(D=n.movement)&&void 0!==D?D:1),l=new SH(null!==(_=n.noiseType)&&void 0!==_?_:0),u=new SH(null!==(S=n.voronoiStyle)&&void 0!==S?S:0),c=new nH(null!==(E=n.smoothness)&&void 0!==E?E:.5),h=new nH(null!==(C=n.seed)&&void 0!==C?C:0),d=new nH(null!==(A=n.highCut)&&void 0!==A?A:1),p=new nH(null!==(M=n.lowCut)&&void 0!==M?M:0),f=new SH(null!==(T=n.quality)&&void 0!==T?T:1),m=new cW(a,o,r,u,c,h,d,p,f,s,l);return new oG(e,t,n,{offset:r,scale:s,intensity:a,movement:o,noiseType:l,voronoiStyle:u,smoothness:c,seed:h,highCut:d,lowCut:p,quality:f},m,i)}throw new Error}return function(e,t,n,i){let r=ZW(n,i);return function(e,t,n,i,r){switch(e.type){case"color":{var s;let a=new _H(null!==(s=i.color)&&void 0!==s?s:Jk),o=uG(i),l=new LH(a,o.alpha),u=new eH(l.calpha,"f");return new aG(t,n,e,d({color:a},o),l,o.mode,u,o.isMask,r)}case"fresnel":{var a,o,l,u,c;let s=new _H(null!==(a=i.color)&&void 0!==a?a:16777215),h=new nH(null!==(o=i.bias)&&void 0!==o?o:.1),p=new nH(null!==(l=i.scale)&&void 0!==l?l:1),f=new nH(null!==(u=i.intensity)&&void 0!==u?u:2),m=new nH(null!==(c=i.factor)&&void 0!==c?c:1),g=uG(i),v=new WH(s,h,p,f,m,g.alpha,g.mode,g.isMask),y=new eH(v.calpha,"f");return new aG(t,n,e,d({color:s,bias:h,scale:p,intensity:f,factor:m},g),v,g.mode,y,g.isMask,r)}case"rainbow":{var h,p,f,m,g,v;let s=new nH(null!==(h=i.filmThickness)&&void 0!==h?h:30),a=new nH(null!==(p=i.movement)&&void 0!==p?p:0),o=new NV(null!==(f=i.wavelengths)&&void 0!==f?f:new Lv(0,0,0)),l=new nH(null!==(m=i.noiseStrength)&&void 0!==m?m:0),u=new nH(null!==(g=i.noiseScale)&&void 0!==g?g:1),c=new NV(null!==(v=i.offset)&&void 0!==v?v:new Lv(0,0,0)),y=uG(i),x=new nW(s,a,o,l,u,c,y.alpha,y.isMask),b=new eH(x.calpha,"f");return new aG(t,n,e,d({filmThickness:s,movement:a,wavelengths:o,noiseStrength:l,noiseScale:u,offset:c},y),x,y.mode,b,y.isMask,r)}case"transmission":{var y,x,b;let s=new nH(null!==(y=i.thickness)&&void 0!==y?y:10),a=new nH(null!==(x=i.ior)&&void 0!==x?x:1.5),o=new nH(null!==(b=i.roughness)&&void 0!==b?b:.5),l=hW.transmissionSize,u=hW.transmissionRenderTarget,c=hW.transmissionRenderTargetDepth,h=window.innerWidth,p=window.innerHeight,f=h>=p?new zV(p/h,1):new zV(1,h/p),m=uG(i),g=new oW(s,a,o,l,u,c,f,m.alpha),v=new eH(g.calpha,"f");return new aG(t,n,e,d({thickness:s,ior:a,roughness:o,aspectRatio:f},m),g,m.mode,v,m.isMask,r)}case"toon":{var w,D,_,S,E,C;let s,a,o=new SH(null!==(w=i.positioning)&&void 0!==w?w:0);i.colors?s=new kH(i.colors.length,i.colors):(s=new kH(10,new Ov(0,0,0,1)),s.value[1]=new Ov(1,1,1,1)),i.steps?a=new CH(i.steps.length,i.steps):(a=new CH(10,1),a.value[0]=0);let l=new NV(null!==(D=i.source)&&void 0!==D?D:new Lv(0,0,0)),u=new EH(null===(_=i.isWorldSpace)||void 0===_||_),c=new nH(null!==(S=i.noiseStrength)&&void 0!==S?S:0),h=new nH(null!==(E=i.noiseScale)&&void 0!==E?E:1),p=new UV(i.shadowColor),f=new NV(null!==(C=i.offset)&&void 0!==C?C:new Lv(0,0,0)),m=uG(i),g=new rW(o,s,a,l,u,c,h,p,f,m.alpha),v=new eH(g.calpha,"f");return new aG(t,n,e,d({positioning:o,colors:s,steps:a,source:l,isWorldSpace:u,noiseStrength:c,noiseScale:h,shadowColor:p,offset:f},m),g,m.mode,v,m.isMask,r)}case"outline":{var A,M,T,P,F,O,I,k,B,R,L;let s=new _H(null!==(A=i.outlineColor)&&void 0!==A?A:16777215),a=new _H(null!==(M=i.contourColor)&&void 0!==M?M:16777215),o=new nH(null!==(T=i.outlineWidth)&&void 0!==T?T:.1),l=new nH(null!==(P=i.contourWidth)&&void 0!==P?P:.1),u=new nH(null!==(F=i.outlineThreshold)&&void 0!==F?F:.1),c=new nH(null!==(O=i.contourThreshold)&&void 0!==O?O:.1),h=new nH(null!==(I=i.outlineSmoothing)&&void 0!==I?I:.1),p=new nH(null!==(k=i.contourFrequency)&&void 0!==k?k:.1),f=new NV(null!==(B=i.contourDirection)&&void 0!==B?B:new Lv(0,1,0)),m=new EH(null!==(R=i.positionalLines)&&void 0!==R&&R),g=new EH(null===(L=i.compensation)||void 0===L||L),v=hW.normalRenderTarget,y=hW.normalRenderTargetDepth,x=hW.pixelRatioNode,b=hW.resolution,w=uG(i),D=new JH(s,a,o,l,u,c,h,p,f,m,g,b,v,y,x,w.alpha),_=new eH(D.calpha,"f");return new aG(t,n,e,d({outlineColor:s,contourColor:a,outlineWidth:o,contourWidth:l,outlineThreshold:u,contourThreshold:c,outlineSmoothing:h,contourFrequency:p,contourDirection:f,positionalLines:m,compensation:g},w),D,w.mode,_,w.isMask,r)}case"depth":{var z,N,j,U,V,H,W,G;let s,a,o=new SH(null!==(z=i.gradientType)&&void 0!==z?z:0),l=new EH(null!==(N=i.smooth)&&void 0!==N&&N),u=new nH(null!==(j=i.near)&&void 0!==j?j:50),c=new nH(null!==(U=i.far)&&void 0!==U?U:200),h=new nH(null!==(V=i.isVector)&&void 0!==V?V:1),p=new nH(null!==(H=i.isWorldSpace)&&void 0!==H?H:0),f=new NV(null!==(W=i.origin)&&void 0!==W?W:new Lv),m=new NV(null!==(G=i.direction)&&void 0!==G?G:new Lv);i.colors?s=new kH(i.colors.length,i.colors):(s=new kH(2,new Ov(0,0,0,1)),s.value[1]=new Ov(1,1,1,1)),i.steps?a=new CH(i.steps.length,i.steps):(a=new CH(2,1),a.value[0]=0);let g=uG(i),v=new HH(o,l,u,c,h,p,f,m,s,a,g.alpha,g.isMask),y=new eH(v.calpha,"f");return new aG(t,n,e,d({gradientType:o,smooth:l,near:u,far:c,isVector:h,isWorldSpace:p,origin:f,direction:m,colors:s,steps:a},g),v,g.mode,y,g.isMask,r)}case"noise":{var q,Y,X,Q,K,Z,J,$,ee,te,ne,ie,re;let s=new nH(null!==(q=i.scale)&&void 0!==q?q:1),a=new NV(null!==(Y=i.size)&&void 0!==Y?Y:new Lv(100,100,100)),o=new nH(null!==(X=i.move)&&void 0!==X?X:1),l=new zV(null!==(Q=i.fA)&&void 0!==Q?Q:new lv(1.7,9.2)),u=new zV(null!==(K=i.fB)&&void 0!==K?K:new lv(8.3,2.8)),c=new zV(null!==(Z=i.distortion)&&void 0!==Z?Z:new lv(1,1)),h=new UV(i.colorA),p=new UV(i.colorB),f=new UV(i.colorC),m=new UV(i.colorD),g=new SH(null!==(J=i.noiseType)&&void 0!==J?J:0),v=new SH(null!==($=i.voronoiStyle)&&void 0!==$?$:0),y=new nH(null!==(ee=i.highCut)&&void 0!==ee?ee:1),x=new nH(null!==(te=i.lowCut)&&void 0!==te?te:0),b=new nH(null!==(ne=i.smoothness)&&void 0!==ne?ne:.5),w=new nH(null!==(ie=i.seed)&&void 0!==ie?ie:.5),D=new SH(null!==(re=i.quality)&&void 0!==re?re:1),_=uG(i),S=new KH(s,a,o,l,u,c,h,p,f,m,_.alpha,g,_.isMask,v,y,x,b,w,D),E=new eH(S.calpha,"f");return new aG(t,n,e,d(d({scale:s,size:a,move:o,fA:l,fB:u,distortion:c,colorA:h,colorB:p,colorC:f,colorD:m,noiseType:g},_),{},{voronoiStyle:v,highCut:y,lowCut:x,smoothness:b,seed:w,quality:D}),S,_.mode,E,_.isMask,r)}case"normal":{var se;let s=new NV(null!==(se=i.cnormal)&&void 0!==se?se:new Lv(1,1,1)),a=uG(i),o=new NH(s,a.alpha),l=new eH(o.calpha,"f");return new aG(t,n,e,d({cnormal:s},a),o,a.mode,l,a.isMask,r)}case"gradient":{var ae,oe,le,ue,ce;let s,a,o=new SH(null!==(ae=i.gradientType)&&void 0!==ae?ae:0),l=new EH(null!==(oe=i.smooth)&&void 0!==oe&&oe);i.colors?s=new kH(i.colors.length,i.colors):(s=new kH(10,new Ov(0,0,0,1)),s.value[1]=new Ov(1,1,1,1)),i.steps?a=new CH(i.steps.length,i.steps):(a=new CH(10,1),a.value[0]=0);let u=new zV(null!==(le=i.offset)&&void 0!==le?le:new lv(0,0)),c=new zV(null!==(ue=i.morph)&&void 0!==ue?ue:new lv(0,0)),h=new nH(null!==(ce=i.angle)&&void 0!==ce?ce:0),p=uG(i),f=new qH(o,l,s,a,u,c,h,p.alpha,p.isMask),m=new eH(f.calpha,"f");return new aG(t,n,e,d({gradientType:o,smooth:l,colors:s,steps:a,offset:u,morph:c,angle:h},p),f,p.mode,m,p.isMask,r)}case"pattern":{var he,de,pe,fe,me,ge,ve,ye,xe,be,we,De,_e,Se;let s=new SH(null!==(he=i.style)&&void 0!==he?he:0),a=new SH(null!==(de=i.projection)&&void 0!==de?de:0),o=new SH(null!==(pe=["x","y","z"].indexOf(i.axis))&&void 0!==pe?pe:0),l=new nH(null!==(fe=i.blending)&&void 0!==fe?fe:0),u=new zV(null!==(me=i.offset)&&void 0!==me?me:new lv(0,0)),c=new UV(i.colorA),h=new UV(i.colorB),p=new zV(null!==(ge=i.frequency)&&void 0!==ge?ge:new lv(10,10)),f=new nH(null!==(ve=i.size)&&void 0!==ve?ve:.5),m=new nH(null!==(ye=i.variation)&&void 0!==ye?ye:0),g=new nH(null!==(xe=i.smoothness)&&void 0!==xe?xe:.5),v=new nH(null!==(be=i.zigzag)&&void 0!==be?be:0),y=new nH(null!==(we=i.rotation)&&void 0!==we?we:0),x=new zV(null!==(De=i.vertical)&&void 0!==De?De:new lv(0,1)),b=new zV(null!==(_e=i.horizontal)&&void 0!==_e?_e:new lv(0,1)),w=new SH(null!==(Se=i.sides)&&void 0!==Se?Se:6),D=uG(i),_=new eW(s,a,o,l,u,c,h,p,f,m,g,v,y,x,b,w,D.alpha,D.isMask),S=new eH(_.calpha,"f");return new aG(t,n,e,d({style:s,projection:a,axis:o,blending:l,offset:u,colorA:c,colorB:h,frequency:p,size:f,variation:m,smoothness:g,zigzag:v,rotation:y,vertical:x,horizontal:b,sides:w},D),_,D.mode,S,D.isMask,r)}default:{let s=new _H(1,0,0,1),a=uG(i),o=new LH(s,a.alpha),l=new eH(o.calpha,"f");return new aG(t,n,e,d({color:s},a),o,a.mode,l,a.isMask,r)}}}(n,e,t,r,i)}(e,t,n,i)}updateByOp(e,t,n){let i=e;if(void 0===i.path[0]){if(0===i.type)return"type"in i.props||"category"in i.props||"visible"in i.props||"noiseType"in i.props?(n.scene.markNeedsUpdateRendererDirty(),!0):function(e,t,n,i){let r=!1;for(let[s,a]of Object.entries(e)){if("bumpMap"===s||"roughnessMap"===s){r=!0;continue}if(!s||void 0===a)continue;if(cG(s,n,i,t)){"visible"===s&&"light"===n.type&&(r=!0);continue}n.visible=i.visible;let e=n.uniforms["f".concat(n.id,"_").concat(s)];if(e&&!(e instanceof AH))switch(r=r||nG(n,s,a),e.constructor){case _H:if("string"==typeof a){let n=t.getColor(a);n&&(e.value=n);break}{let t=a;e.value instanceof $W?e.value=new jV(t.r,t.g,t.b,t.a):e.setRGBA(t);break}case UV:if("string"==typeof a){let n=t.getColor(a);n&&(e.value=n);break}{let t=a;e.value instanceof $W?e.value=new jV(t.r,t.g,t.b,t.a):e.value.setRGBA(t.r,t.g,t.b,t.a);break}case zV:{let t=a;e.value.setX(t[0]),e.value.setY(t[1]);break}case NV:{let t=a;e.value.setX(t[0]),e.value.setY(t[1]),e.value.setZ(t[2]);break}case tH:iG(a,t,n);break;case kH:e.value=a.map((e=>new Ov(...e)));break;default:e.value=a}}return r}(i.props,n.shared,this,t)}else if("texture"===i.path[0])return!("texture"in t)&&!("video"in t)||iG(i.props,n.shared,this);return!1}dispose(){if(function(e){let t=e instanceof sG?e.type:e;return"texture"===t||"video"===t||"displace_map"===t||"matcap"===t}(this)){let e=this.uniforms["f".concat(this.id,"_texture")];if(!e)return!1;let t=e;t.image instanceof EW||t.image.deref()}}hasValueByKey(e){return void 0!==this.uniforms[e]}hasValue(e){return this.hasValueByKey("f".concat(this.id,"_").concat(e))}setValue(e,t){let n="f".concat(this.id,"_").concat(e);this.hasValueByKey(n)&&void 0!==t&&(this.uniforms[n].value=t)}getNode(e){let t="f".concat(this.id,"_").concat(e);if(this.hasValueByKey(t))return this.uniforms[t]}getValue(e){let t="f".concat(this.id,"_").concat(e);if(this.hasValueByKey(t))return this.uniforms[t].value}getName(e){let t=/f\d+_(.*)/.exec(e);if(t&&t.length>1)return t[1];console.log("Layer.getName: error ".concat(e))}getNames(){let e=[];for(let t in this.uniforms){let n=this.getName(t);n&&e.push(n)}return e}},aG=class extends sG{constructor(e,t,n,i,r,s,a,o,l){super(e,t,n,i,l),this.params=i,this.color=r,this.mode=s,this.alpha=a,this.isMask=o}},oG=class extends sG{constructor(e,t,n,i,r,s){super(e,t,n,i,s),this.position=r}},lG=class extends sG{constructor(e,t,n,i,r,s){super(e,t,n,r,s),this.node=i}static createLightLayer(e,t,n,i){let r,s,a=new nH(rG(n.alpha,i)),o=new SH(n.mode),l=new nH(n.bumpMapIntensity),u=new nH(rG(n.alphaOverride,i));if(n.visible)if("lambert"===n.category){var c,h;r=new mW;let e=new _H(null!==(c=i.color(n.emissive))&&void 0!==c?c:0),t=new EH(null===(h=n.occlusion)||void 0===h||h);s={emissive:e,occlusion:t},r.emissive=e,r.occlusion=t}else if("toon"===n.category){var d,p;r=new xW;let e=new nH(null!==(d=n.shininess)&&void 0!==d?d:30),t=new _H(null!==(p=i.color(n.specular))&&void 0!==p?p:1118481);s={shininess:e,specular:t},r.shininess=e,r.specular=t}else if("physical"===n.category){var f,m,g,v;r=new yW;let e=new nH(null!==(f=n.roughness)&&void 0!==f?f:.3),t=new nH(null!==(m=n.metalness)&&void 0!==m?m:0),i=new nH(null!==(g=n.reflectivity)&&void 0!==g?g:.5),a=new EH(null===(v=n.occlusion)||void 0===v||v);s={roughness:e,metalness:t,reflectivity:i,occlusion:a},r.roughness=e,r.metalness=t,r.reflectivity=i,r.occlusion=a}else{var y,x,b;r=new vW;let e=new nH(null!==(y=n.shininess)&&void 0!==y?y:30),t=new _H(void 0!==n.specular&&null!==(x=i.color(n.specular))&&void 0!==x?x:1118481),a=new EH(null===(b=n.occlusion)||void 0===b||b);s={shininess:e,specular:t,occlusion:a},r.shininess=e,r.specular=t,r.occlusion=a}else r=new fW,s={};return r.alpha=new nH(1),r.shadingAlpha=a,r.shadingBlend=o,r.bumpMapIntensity=l,r.alphaOverride=u,s.alpha=r.shadingAlpha,s.mode=r.shadingBlend,s.bumpMapIntensity=r.bumpMapIntensity,s.alphaOverride=r.alphaOverride,new lG(e,t,n,r,s,i)}get category(){return this.node.category}};function uG(e){var t,n,i;return{alpha:new nH(null!==(t=e.alpha)&&void 0!==t?t:1),mode:new SH(null!==(n=e.mode)&&void 0!==n?n:0),isMask:new EH(null!==(i=e.isMask)&&void 0!==i&&i)}}function cG(e,t,n,i){if("displace"===n.type&&("intensity"===e||"visible"===e)){let e=t.uniforms["f".concat(t.id,"_intensity")];return e?(e.value=n.intensity*(n.visible?1:0),e):void 0}if("displace"!==n.type&&("alpha"===e||"visible"===e)){let r=t.uniforms["f".concat(t.id,"_alpha")];if(!r)return;if(r.value=rG(n.alpha,i)*(n.visible?1:0),"outline"===n.type&&"visible"===e){let e=t.uniforms["f".concat(t.id,"_compensation")];e&&(e.value=n.compensation&&n.visible)}return r}}function hG(e,t){let n=0,i=e.layers.find((e=>"light"===e.data.type));if(i){let e=i.data,n=Number(t.getVariable(e.alphaOverride));if(("string"==typeof e.alphaOverride?n/100:e.alphaOverride)<1)return!0}for(let s of e.layers){if("displace"!==s.data.type&&s.data.isMask)return!0;if("displace"!==s.data.type&&"alpha"in s.data&&"light"!==s.data.type&&"fresnel"!==s.data.type&&"texture"!==s.data.type&&"matcap"!==s.data.type&&"rainbow"!==s.data.type&&"outline"!==s.data.type&&"pattern"!==s.data.type){var r;let e=s.data.visible?s.data.alpha:0;if("string"==typeof e&&(e=Math.max(0,Math.min(1,Number(null!==(r=t.getVariable(e))&&void 0!==r?r:100)/100))),1===e&&"depth"===s.data.type||"gradient"===s.data.type){for(let t of s.data.colors)if(t[3]<1){e=t[3];break}}else if(1===e&&"noise"===s.data.type){let n=t.color(s.data.colorA).a,i=t.color(s.data.colorB).a,r=t.color(s.data.colorC).a,a=t.color(s.data.colorD).a,o=Math.min(n,Math.min(i,Math.min(r,a)));o<1&&(e=o)}n+=(1-n)*e}}return n<1}var dG=class extends Ix{constructor(){super(void 0),this.flatShading=!1,this.needsJitter=!0,this.shadersPatchedForShapeBlend=!1,this.nodeContextUuid=0,this.fog=!0,this.dithering=!0,this.vertexColors=!0,this.transparent=!0}customProgramCacheKey(){return""}},pG=class extends dG{constructor(e,t,n,i){super(),this.flatShading=e,this.side=t,this.wireframe=n,this.root=i}updateAfterBuild(){let e=this.root;this.lights=e.lights,this.vertexShader=e.vertexShader,this.fragmentShader=e.fragmentShader,Object.assign(this.defines,e.defines),Object.assign(this.uniforms,e.uniforms),this.extensions=e.extensions,this.transparent=e.transparent,this.cacheKey=e.customProgramCacheKey()+"flat"+this.flatShading+this.side}onBeforeCompile(e,t){this.root.onBeforeCompile(e)}get data(){return this.root.data}get category(){return this.root.category}get hasAO(){return this.root.hasAO}getFlavor(e,t,n,i){return this.root.getFlavor(e,t,n,i)}get layers(){return this.root.layers}get fragment(){return this.root.fragment}getLayersOfType(e){return this.root.getLayersOfType(e)}getLayerByUuid(e){return this.root.getLayerByUuid(e)}updateByOp(e,t,n){this.root.updateByOp(e,t,n)}nodeMaterialDispose(){this.root.nodeMaterialDispose()}},fG=class extends dG{constructor(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];super(),this.data=e,this.allowVariableSaves=n,this.layerIdGen=0,this.flavors=[],this.masks={},this.type="NodeMaterial",this.updaters=[],this.needsJitter=t.shared.needsJitter,IV.startContext(this),this.reset0(e,t),IV.endContext(this)}get nodeMaterial(){return this}getFlavor(e,t,n,i){var r;let s=n?6:(e?3:0)+t;if(s+=7*((null!==(r=null===i||void 0===i?void 0:i.resolutionLevel)&&void 0!==r?r:0)-(null!==i&&void 0!==i&&i.useChildrenColors?4:0)),0===s)return this;void 0===this.flavors&&(this.flavors=[]),s-=1;let a=this.flavors[s];return void 0===a&&(a=new pG(e,t,n,this),a.needsJitter=this.needsJitter,this.flavors[s]=a,a.flatShading=e,a.side=t,a.updateAfterBuild(),i&&(a.defines.SHAPEBLEND=i.resolutionLevel,a.defines.SHAPEBLEND_C=i.useChildrenColors?1:0)),a}get fragment(){return this.lightLayer.node}get category(){return this.lightLayer.category}get hasAO(){var e,t;return null!==(e=null===(t=this.lightLayer.getNode("occlusion"))||void 0===t?void 0:t.value)&&void 0!==e&&e}reset(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];IV.startContext(this),(this.data!==e||n)&&this.reset0(e,t),IV.endContext(this)}reset0(e,t){var n,i;this.data=e;let r=null!==(n=e.layers)&&void 0!==n?n:yB.defaultTwoLayerData("phong").layers;try{this.layers=r.map((e=>sG.create(this.layerIdGen++,e.id,e.data,t.shared)))}catch(s){this.layers=[]}this.layers.reverse(),this.name=null!==(i=e.name)&&void 0!==i?i:"Untitled Material",this.onUpdate(t.shared),this.transparent=hG(e,t.shared),this.saveVariableLocations(t)}onVariableUpdate(e,t,n){if("alphaOverride"===e[0])this.transparent=hG(this.data,n.shared),this.lightLayer.setValue("alphaOverride",Math.max(0,Math.min(Number(t)/100,1)));else if("layer"===e[0]){let i=e[1],r=e[2];if(i&&r){let e=this.layers.find((e=>e.uuid===i));(null===e||void 0===e?void 0:e.hasValue(r))&&("alpha"===r?(this.transparent=hG(this.data,n.shared),e.setValue(r,Math.max(0,Math.min(Number(t)/100,1)))):e.setValue(r,t))}}}saveVariableLocations(e){if(!this.allowVariableSaves)return;let t=this.data.layers.find((e=>"light"===e.data.type));t&&e.shared.getVariable(t.data.alphaOverride,["material",this.uuid,"alphaOverride"]),this.data.layers.forEach((t=>{"alpha"in t.data&&"string"==typeof t.data.alpha&&e.shared.getVariable(t.data.alpha,["material",this.uuid,"layer",t.id,"alpha"])}))}getLayersOfType(e){return this.layers.filter((t=>t.type===e))}getLayerByUuid(e){return this.layers.find((t=>t.uuid===e))}onUpdate(e){this.lightLayer=this.layers.find((e=>e instanceof lG)),void 0===this.lightLayer&&(this.lightLayer=new lG(0,"",d(d({},vB.defaultData("light","phong")),{},{visible:!1}),new fW,{},e)),this.dispose();for(let t of this.flavors)t&&t.dispose();this.applyTextureMaps(),this.applyMasks(),this.blendColors(),this.blendAfterColors(),this.blendPositions(),this.build(),this.nodeContextUuid=0}applyTextureMaps(){let e=this.layers.find((e=>e instanceof lG));if(!e)return;let t=e.data,n=t.bumpMap,i=t.roughnessMap;e.node.bumpMap=void 0,e.node.roughnessMap=void 0;for(let r=0;r<this.layers.length;++r){let t=this.layers[r];t instanceof aG&&t.color instanceof UH&&(t.uuid===n&&(e.node.bumpMap=t.color),t.uuid===i&&(e.node.roughnessMap=t.color))}}updateByOp(e,t,n){if(IV.startContext(this),void 0!==t?this.data=t:t=this.data,this.transparent=hG(t,n.shared),"layers"===e.path[0]){let i=n.shared,r=e.path[1];if(void 0===r)n.scene.markNeedsUpdateRendererDirty(),this.reset0(t,n);else{0===e.type&&void 0!==e.props.occlusion&&n.scene.markNeedsUpdateRendererDirty();let s=this.layers.find((e=>e.uuid===r));if(s){let a,o=t.layers.data(r);0===e.type&&("alpha"in e.props||"alphaOverride"in e.props)&&(a="alpha"in e.props?d(d({},e.props),{},{alpha:rG(e.props.alpha,i,["material",this.uuid,"layer",r,"alpha"])}):d(d({},e.props),{},{alphaOverride:rG(e.props.alphaOverride,i,["material",this.uuid,"alphaOverride"])})),s.updateByOp(d(d(d({},e),a?{props:a}:{}),{},{path:e.path.slice(2)}),o,n)&&this.reset0(t,n)}}}else this.reset0(t,n);IV.endContext(this)}applyMasks(){for(let e=0;e<this.layers.length;++e){let t=this.layers[e];t instanceof aG?t.color.mask=void 0:t instanceof lG&&(t.node.mask=void 0)}for(let e=0;e<this.layers.length;++e){let t=this.layers[e];if(t instanceof aG&&t.isMask.value&&t.data.visible&&e>0){let n=e-1,i=this.layers[n];i instanceof lG?i.node.mask=new sH(t.color,t.alpha,sH.MUL):i instanceof aG&&(i.isMask.value||(i.color.mask=new sH(t.color,t.alpha,sH.MUL)))}}}blendColors(){let e=this.layers.findIndex((e=>e instanceof aG)),t=this.layers.findIndex((e=>e instanceof lG));if(-1!==e&&e<t){let n=this.layers[e].color;for(let i=e+1;i<t;++i){let e=this.layers[i];if(e instanceof aG){if(e.isMask.value)continue;n=new BH(n,e.color,e.alpha,e.mode)}}this.fragment.color=n}else this.fragment.color=void 0}blendAfterColors(){let e=new eH("outgoingLight","f"),t=this.layers.findIndex((e=>e instanceof lG));if(this.layers.length>t+1){for(let n=t+1;n<this.layers.length;++n){let t=this.layers[n];if(t instanceof aG){if(t.isMask.value)continue;e=new BH(e,t.color,t.alpha,t.mode)}}this.fragment.afterColor=e}else this.fragment.afterColor=void 0}blendPositions(){let e=this.layers.filter((e=>e instanceof oG));if(e.length>0){let t=e[0].position;for(let n=1;n<e.length;++n)e[n]&&(t=new sH(t,e[n].position,sH.ADD),t=new sH(t,new nH(.5).setReadonly(!0),sH.MUL));this.fragment.position=t}else this.fragment.position=void 0}getDefines(){return this.defines}getUniforms(){return this.uniforms}getVertexShader(){return this.vertexShader}getFragmentShader(){return this.fragmentShader}onBeforeCompile(e){this.shapeBlendhack&&this.shapeBlendhack(this),e.uniforms=this.uniforms,e.vertexShader=this.vertexShader,e.fragmentShader=this.fragmentShader,e.extensionDerivatives=!0===this.extensions.derivatives,e.extensionFragDepth=!0===this.extensions.fragDepth,e.extensionDrawBuffers=!0===this.extensions.drawBuffers,e.extensionShaderTextureLOD=!0===this.extensions.shaderTextureLOD}clampUniformsForPreview(e,t){let n=(e,t,n)=>Math.min(Math.max(e,t),n);for(let i of this.layers)if("displace"===i.type){let r=n(i.uniforms["f".concat(i.id,"_intensity")].value,e,t);i.uniforms["f".concat(i.id,"_intensity")].value=r}}updateFrame(e){for(let t=0;t<this.updaters.length;++t)e.updateNode(this.updaters[t])}build(){let e=new DH;e.needsJitter=this.needsJitter,this.lights=this.lightLayer.data.visible,e.build(this.fragment,this.fragment),this.vertexShader=e.getCode("vertex"),this.fragmentShader=e.getCode("fragment"),this.defines=e.defines,this.uniforms=e.uniforms,this.extensions=e.extensions,this.updaters=e.updaters;for(let t of this.flavors)t&&t.updateAfterBuild();return this.shadersPatchedForShapeBlend=!1,this}nodeMaterialDispose(){this.layers.forEach((e=>e.dispose())),super.dispose();for(let e of this.flavors)e&&e.dispose()}assetsLoaded(){for(let e of this.layers)if(e instanceof aG){let t=e.params.texture;if(t instanceof TH&&!t.image.loaded)return!1}return!0}};Object.defineProperties(dG.prototype,{properties:{get:function(){return this.fragment.properties}}});var mG=class extends fG{constructor(e,t,n){super(e,t,!1),this.uuid=n,this.allowVariableSaves=!0,this.saveVariableLocations(t)}},gG=new Map;function vG(e){if("string"==typeof e)return e;let t=gG.get(e);return t||(t={url:URL.createObjectURL(new Blob([e]))},gG.set(e,t)),t.url}var yG,xG,bG,wG=new Promise((e=>{yG=e})),DG=!1;function _G(){if(!DG)return xG||(xG=async function(){await n.e(519).then(n.bind(n,519)),yG(void 0!==window?window:global),DG=!0}())}function SG(e){let t=!1;return e.scene.objects.traverse(((e,n)=>{if(void 0===n.events||!1===Array.isArray(n.events))return!0;let i=[];n.events.forEach((e=>{"dragDropActions"in e.data?(i.push(...e.data.dragDropActions.drag),i.push(...e.data.dragDropActions.drop)):"inActions"in e.data?(i.push(...e.data.inActions),i.push(...e.data.outActions)):"gameActions"in e.data?(i.push(...e.data.gameActions.idle),i.push(...e.data.gameActions.move),i.push(...e.data.gameActions.jump),i.push(...e.data.gameActions.run)):"breakpoints"in e.data?e.data.breakpoints.forEach((e=>{i.push(...e.data.actions)})):"actions"in e.data&&i.push(...e.data.actions),t=t||i.some((e=>"Audio"===e.data.type))}))})),t}wG.then((e=>bG=e));var EG,CG,AG=class{constructor(e){let t,{src:n,volume:i,delay:r,loop:s}=e;this._volume=1,this.delay=0,this._loop=1,this.loopsRemaining=0,this._status="stopped",this.onEnd=()=>{this.loopsRemaining===1/0?this.replay():this.loopsRemaining>1?(this.replay(),this.loopsRemaining--):(this._status="stopped",this.loopsRemaining=this._loop)},t="string"==typeof n?{src:n}:{src:vG(n),format:"wav"},this.sound=new bG.Howl(t),this.sound.on("end",this.onEnd),this.src=n,void 0!==i&&(this.volume=i),void 0!==r&&(this.delay=r),void 0!==s&&(this.loop=s)}get status(){return this._status}get volume(){return this._volume}set volume(e){this._volume=e,this.sound.volume(e)}get loop(){return this._loop}set loop(e){this._loop=e,this.loopsRemaining=e}replay(){this.clearDelay(),this.delayTimerId=window.setTimeout((()=>{this.sound.play(),this.clearDelay()}),this.delay)}fade(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3;e?(this.sound.volume(this._volume),this.clearFade(),this.fadeTimerId=window.setTimeout((()=>{this.sound.fade(this._volume,0,t),this.clearFade()}),e)):this.sound.fade(this._volume,0,t)}on(e,t,n){this.sound.on(e,t,n)}off(e,t,n){this.sound.off(e,t,n)}play(){"playing"===this._status||this.sound.playing()||("paused"===this._status?(0===this.sound.seek()?this.replay():this.sound.play(),this._status="playing"):"stopped"===this._status&&(this.replay(),this._status="playing"))}pause(){"playing"===this._status&&(this.sound.pause(),this.clearFade(),this.clearDelay(),this._status="paused")}stop(){this.sound.stop(),this.loopsRemaining=this._loop,this.clearFade(),this.clearDelay(),this._status="stopped"}clearFade(){this.fadeTimerId&&(clearTimeout(this.fadeTimerId),delete this.fadeTimerId)}clearDelay(){this.delayTimerId&&(clearTimeout(this.delayTimerId),delete this.delayTimerId)}dispose(){this.off(),this.stop(),this.clearFade(),this.clearDelay()}},MG=class{constructor(){this.type="ShapePath",this.color=new Ev,this.subPaths=[],this.currentPath=null}moveTo(e,t){return this.currentPath=new y_,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,t),this}lineTo(e,t){var n;return null!==(n=this.currentPath)&&void 0!==n&&n.lineTo(e,t),this}quadraticCurveTo(e,t,n,i){var r;return null!==(r=this.currentPath)&&void 0!==r&&r.quadraticCurveTo(e,t,n,i),this}bezierCurveTo(e,t,n,i,r,s){var a;return null!==(a=this.currentPath)&&void 0!==a&&a.bezierCurveTo(e,t,n,i,r,s),this}splineThru(e){var t;return null!==(t=this.currentPath)&&void 0!==t&&t.splineThru(e),this}toShapes(){let e=0,t=1,n=2,i=3,r=4,s=5,a=6,o={loc:e,t:0};function l(t,i,r,s){let a=t.x,l=i.x,c=r.x,h=s.x,d=t.y,p=i.y,f=r.y,m=s.y,g=(h-c)*(d-f)-(m-f)*(a-c),v=(m-f)*(l-a)-(h-c)*(p-d),y=g/v,x=((l-a)*(d-f)-(p-d)*(a-c))/v;if(0===v&&0!==g||y<=0||y>=1||x<0||x>1)return null;if(0===g&&0===v){for(let c=0;c<2;c++){if(u(0===c?r:s,t,i),o.loc===e){let e=0===c?r:s;return{x:e.x,y:e.y,t:o.t}}if(o.loc===n){return{x:+(a+o.t*(l-a)).toPrecision(10),y:+(d+o.t*(p-d)).toPrecision(10),t:o.t}}}return null}for(let n=0;n<2;n++)if(u(0===n?r:s,t,i),o.loc===e){let e=0===n?r:s;return{x:e.x,y:e.y,t:o.t}}return{x:+(a+y*(l-a)).toPrecision(10),y:+(d+y*(p-d)).toPrecision(10),t:y}}function u(l,u,c){let h,d=c.x-u.x,p=c.y-u.y,f=l.x-u.x,m=l.y-u.y,g=d*m-f*p;return l.x===u.x&&l.y===u.y?(o.loc=e,void(o.t=0)):l.x===c.x&&l.y===c.y?(o.loc=t,void(o.t=1)):void(g<-Number.EPSILON?o.loc=i:g>Number.EPSILON?o.loc=r:d*f<0||p*m<0?o.loc=s:Math.sqrt(d*d+p*p)<Math.sqrt(f*f+m*m)?o.loc=a:(h=0!==d?f/d:m/p,o.loc=n,o.t=h))}function c(e,t,n){let i=new lv;t.getCenter(i);let r=[];return n.forEach((t=>{t.boundingBox.containsPoint(i)&&function(e,t){let n=[],i=[];for(let r=1;r<e.length;r++){let s=e[r-1],a=e[r];for(let e=1;e<t.length;e++){let r=l(s,a,t[e-1],t[e]);null!==r&&void 0===n.find((e=>e.t<=r.t+Number.EPSILON&&e.t>=r.t-Number.EPSILON))&&(n.push(r),i.push(new lv(r.x,r.y)))}}return i}(e,t.points).forEach((e=>{r.push({identifier:t.identifier,isCW:t.isCW,point:e})}))})),r.sort(((e,t)=>e.point.x-t.point.x)),r}let h=0,d=999999999,p=-999999999,f=[];this.subPaths.forEach((e=>{let t=e.getPoints(),n=-999999999,i=999999999,r=-999999999,s=999999999;for(let a=0;a<t.length;a++){let e=t[a];e.y>n&&(n=e.y),e.y<i&&(i=e.y),e.x>r&&(r=e.x),e.x<s&&(s=e.x)}p<=r&&(p=r+1),d>=s&&(d=s-1),t.length&&f.push({curves:e.curves,points:t,isCW:K_.isClockWise(t),identifier:h++,boundingBox:new xE(new lv(s,i),new lv(r,n))})}));let m=f.map((e=>{var t;return function(e,t,n,i,r){(null==r||""===r)&&(r="nonzero");let s=new lv;e.boundingBox.getCenter(s);let a=c([new lv(n,s.y),new lv(i,s.y)],e.boundingBox,t);a.sort(((e,t)=>e.point.x-t.point.x));let o=[],l=[];a.forEach((t=>{t.identifier===e.identifier?o.push(t):l.push(t)}));let u=o[0].point.x,h=[],d=0;for(;d<l.length&&l[d].point.x<u;)h.length>0&&h[h.length-1]===l[d].identifier?h.pop():h.push(l[d].identifier),d++;if(h.push(e.identifier),"evenodd"===r){let t=h.length%2===0,n=h[h.length-2];return{identifier:e.identifier,isHole:t,for:n}}if("nonzero"===r){let n=!0,i=null,r=null;for(let e=0;e<h.length;e++){let s=h[e];t[s]&&(n?(r=t[s].isCW,n=!1,i=s):r!==t[s].isCW&&(r=t[s].isCW,n=!0))}return{identifier:e.identifier,isHole:n,for:i}}console.warn('fill-rule: "'+r+'" is currently not implemented.')}(e,f,d,p,null===(t=this.userData)||void 0===t?void 0:t.style.fillRule)})),g=[];return f.forEach((e=>{let t=m[e.identifier];if(t&&!t.isHole){let t=new S_;t.curves=e.curves,m.filter((t=>(null===t||void 0===t?void 0:t.isHole)&&t.for===e.identifier)).forEach((e=>{if(e){let n=f[e.identifier],i=new y_;i.curves=n.curves,t.holes.push(i)}})),g.push(t)}})),g}},TG=!1,PG=new Promise((e=>{EG=e})),FG=!1;function OG(){if(TG=!0,!FG)return CG||(CG=async function(){let e=await n.e(946).then(n.bind(n,946));EG(e),FG=!0}(),CG)}var IG=new class{async load(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:()=>{},{load:i}=await PG;i(e,((e,i)=>{e||!i?n(null!==e&&void 0!==e?e:"Something went wrong"):t(i)}))}async parse(e){let{parse:t,Bidi:n}=await PG;try{let i=t(e),r=new n,s=e=>i.charToGlyphIndex(e.char);return r.registerModifier("glyphIndex",null,s),r.applyFeatures(i,i.defaultRenderOptions.features),{font:i,bidi:r}}catch(i){console.error(i)}}};async function kG(e){let t,n,i=!1;if(e.url?(t=await async function(e){return await(await fetch(e)).arrayBuffer()}(e.url),n=e.url,i=e.url.startsWith("/")):e.data&&(t=e.data.buffer.slice(e.data.byteOffset,e.data.byteOffset+e.data.byteLength)),t){if(!TG)return{font:void 0,url:n,intercepted:i,arr:t,bidi:null};{let e=await IG.parse(t);if(e)return{font:e.font,url:n,intercepted:i,arr:t,bidi:e.bidi}}}}function BG(e,t){return t.state.glyphIndex===e||t.state.fina===e||t.state.medi===e||t.state.init===e}var RG=class{constructor(e){var t;this._arrayBuffer=new ArrayBuffer(1),this._isLoaded=!1,this._intercepted=!1,this._isUserFont=null!==(t=e.isUserFont)&&void 0!==t&&t,this._loadingPromise=kG(e).then((e=>{e&&(this._arrayBuffer=e.arr,this._url=e.url,this.font=e.font,this._intercepted=e.intercepted,this._isLoaded=!0,this._bidi=e.bidi)}))}update(e){var t;this._isLoaded=!1,this._isUserFont=null!==(t=e.isUserFont)&&void 0!==t&&t,this._loadingPromise=kG(e).then((e=>{e&&(this._arrayBuffer=e.arr,this._url=e.url,this.font=e.font,this._intercepted=e.intercepted,this._isLoaded=!0,this._bidi=e.bidi)}))}get url(){return this._url}get intercepted(){return this._intercepted}get isLoaded(){return this._isLoaded}get loadingPromise(){return this._loadingPromise}reverseLigaturesTable(e,t,n){if(!this._bidi)return[];let i=this._bidi;i.getTextGlyphs(t);let r=i.tokenizer.tokens,s=[],a=0,o=n.length===r.length;for(let l=0;l<n.length;l++){let i=n[l].index,u=String.fromCharCode(n[l].unicode),c=r[a];if(BG(i,c)||o)s.push({char:u,index:i,replacements:[c.state.glyphIndex],replacementChars:[c.char]}),a++;else{let n=c.char,r="",o=[c.state.glyphIndex],l=[],h=!1;for(;!h;)a++,r=t.charAt(a),n+=r,o.push(e.charToGlyphIndex(r)),l=e.stringToGlyphs(n),1===l.length&&l[0].index===i&&(h=!0),a>t.length&&(h=!0);s.push({char:u,index:i,replacements:o,replacementChars:Array.from(n)}),a++}}return s}generateShapes(e,t){if(!this._isLoaded)return;let n,i=this.font,r=t.fontSize/this.unitsPerEm,s=t.fontSize*t.lineHeight,a=e.map((e=>this.getTextWidth(e,t))),o=t.width,l=this.getCharWidth("\n",t),u=1===t.horizontalAlign?l:0,c=this.computeSpaceWidthForLine(e,0,t),h=this.getLineInitialOffsetX(a[0],o,t.horizontalAlign,e[0],l),d=this.getLineInitialOffsetY(s,e.length,t.height,r,t.verticalAlign),p=[],f=e.map((e=>[])),m=e.map((e=>[]));for(let y=0;y<e.length;y++){let g=e[y],x={features:{liga:!0}},b=[];try{b=i.stringToGlyphs(g,x)}catch(v){console.warn(v)}h=this.getLineInitialOffsetX(a[y],o,t.horizontalAlign,g,l);let w=[];try{w=this.reverseLigaturesTable(i,g,b)}catch(v){console.warn(v)}c=this.computeSpaceWidthForLine(e,y,t);for(let e=0;e<b.length;e++){let s=b[e],a=0===s.index?"\n":s.unicode?String.fromCharCode(s.unicode):void 0,o=w[e],l=0,g=0;0===e&&2===t.horizontalAlign&&void 0!==s.leftSideBearing&&(g=-s.leftSideBearing*r),n&&(l=i.getKerningValue(s,n)*r),h+=g+l;let v=0;if("\n"===a)v=u;else if(" "===a)v=c;else{let e=this.createPath(s,r,h,d,t);e&&(v=e.offsetX-(l+g),p.push(e.path))}if(1===o.replacements.length)m[y].push([h,d]),f[y].push(v);else{let e=o.replacements.map((e=>{var t;return(null!==(t=i.glyphs.get(e).advanceWidth)&&void 0!==t?t:0)*r})),t=e.reduce(((e,t)=>e+t),0),n=e.map((e=>e/t)),s=h;for(let i=0;i<n.length;i++){let e=v*n[i];m[y].push([s,d]),f[y].push(e),s+=e}}h+=v,n=s}d-=s}let g=[];for(let y=0,x=p.length;y<x;y++)g.push(...p[y].toShapes());return{shapes:g,charWidths:f,lineWidths:a,charCoords:m}}get isUserFont(){return this._isUserFont}get arrayBuffer(){return this._arrayBuffer}get ascender(){var e,t;return null!==(e=null===(t=this.font)||void 0===t?void 0:t.ascender)&&void 0!==e?e:0}get descender(){var e,t;return null!==(e=null===(t=this.font)||void 0===t?void 0:t.descender)&&void 0!==e?e:0}get familyName(){var e,t;return null!==(e=null===(t=this.font)||void 0===t?void 0:t.names.fontFamily)&&void 0!==e?e:""}get subfamilyName(){var e,t;return null!==(e=null===(t=this.font)||void 0===t?void 0:t.names.fontSubfamily)&&void 0!==e?e:""}get unitsPerEm(){var e,t;return null!==(e=null===(t=this.font)||void 0===t?void 0:t.unitsPerEm)&&void 0!==e?e:1}getLineInitialOffsetX(e,t,n,i,r){return(3===n||2===n)&&i.indexOf("\n")>=0&&(e-=r),3===n?.5*t-.5*e:2===n?t-e:0}getLineInitialOffsetY(e,t,n,i,r){let s=t*e,a=e-Math.abs(this.ascender-this.descender)*i,o=-this.ascender*i-a/2;return 3===r?-(n-s-o):2===r?-(.5*n-.5*s-o):o}createPath(e,t,n,i,r){var s;let a=e.getPath(n,-i,r.fontSize,{kerning:!1,letterSpacing:r.letterSpacing});if(!a)return void console.error('THREE.Font: character "'+e+'" does not exists in font family '+this.familyName+".");let o=new MG,l=(null!==(s=e.advanceWidth)&&void 0!==s?s:1)*t;if(e)for(let c of a.commands){var u;let e=null===(u=o.currentPath)||void 0===u?void 0:u.currentPoint;if(!e||"Z"===c.type||e.x!==c.x||-e.y!==c.y)switch(c.type){case"M":o.moveTo(c.x,-c.y);break;case"L":o.lineTo(c.x,-c.y);break;case"Q":o.quadraticCurveTo(c.x1,-c.y1,c.x,-c.y);break;case"C":o.bezierCurveTo(c.x1,-c.y1,c.x2,-c.y2,c.x,-c.y)}}return o.subPaths.forEach((e=>{let t=function(e){if(e.length){let t=e[0];if(t instanceof d_)return t.v1;if(t instanceof c_||t instanceof f_)return t.v0}}(e.curves);void 0!==t&&e.currentPoint.distanceTo(t)>0&&e.lineTo(t.x,t.y)})),{offsetX:l+r.fontSize*r.letterSpacing,path:o}}getCharWidth(e,t){var n,i;return null!==(n=null===(i=this.font)||void 0===i?void 0:i.getAdvanceWidth(e,t.fontSize,{kerning:!0,letterSpacing:t.letterSpacing}))&&void 0!==n?n:0}getTextWidth(e,t){var n,i;return null!==(n=null===(i=this.font)||void 0===i?void 0:i.getAdvanceWidth(e,t.fontSize,{kerning:!0,letterSpacing:t.letterSpacing}))&&void 0!==n?n:0}computeSpaceWidthForLine(e,t,n){let i=this.getCharWidth(" ",n),r=e[t];if(r){let s=this.countSpaces(r.trimEnd());if(4===n.horizontalAlign&&t<e.length-1&&s){return(n.width-(this.getTextWidth(r,n)-s*i))/s}}return i}countSpaces(e){return(e.match(/ /g)||[]).length}};var LG=class{constructor(){this.objects=new Map,this.unreachable=new Set}getCached(e){return this.objects.get(e)}get size(){return this.objects.size}get(e,t,n){let i=this.objects.get(e);return void 0===i?(i=this.createObject(e,t,n),this.objects.set(e,i)):i.isShared=!0,i}forceDelete(e){let t=this.objects.get(e);t&&(this.disposeObject(t),this.objects.delete(e))}mutateIfUnique(e,t){let n=this.objects.get(e);if(n&&!0!==n.isShared)return this.objects.delete(e),this.objects.set(t,n),n}startGc(){this.unreachable=new Set(this.objects.keys())}markAsReachable(e,t){t===this.objects.get(e)&&this.unreachable.delete(e)}endGc(){this.unreachable.forEach((e=>{this.disposeObject(this.objects.get(e)),this.objects.delete(e)})),this.unreachable.clear()}dispose(){this.objects.forEach((e=>{this.disposeObject(e)})),this.objects.clear()}},zG=class extends LG{constructor(e){super(),this.flatShading=e}disposeObject(e){e.dispose()}createObject(e,t,n){let i=qU(e,t,this.flatShading,n);return i.computeBoundingSphere(),i}},NG={markNeedsUpdateRendererDirty:()=>{}},jG=1e3,UG=512e3;var VG="https://hooks.spline.design",HG="".concat(VG,"/events?hashFile="),WG=("".concat(VG,"/"),class{constructor(e,t){this.id=e,this.userWebhook=t,this.result=void 0,this._connected=!1,this.emitter=_U(),this.reconnectWaitFor=jG,this._onError=e=>{var t,n,i;null!==(t=this.eventSource)&&void 0!==t&&t.removeEventListener("message",this._onMessage),null!==(n=this.eventSource)&&void 0!==n&&n.removeEventListener("error",this._onError),null!==(i=this.eventSource)&&void 0!==i&&i.removeEventListener("open",this._onConnected),this._scheduleReconnect()},this._onConnected=e=>{clearTimeout(this.scheduledReconnectHandle),this.reconnectWaitFor=jG,this._connected=!0},this._onDisconnected=()=>{clearTimeout(this.scheduledReconnectHandle),this.reconnectWaitFor=jG,this._connected=!1},this._onMessage=e=>{let t,n=e.data;try{t=JSON.parse(n)}catch(i){console.error("Error parsing webhook message",i)}if(t){let e=!1;this.userWebhook.parametersSchemas.forEach((n=>{let{data:i}=n;void 0!==t[i.name]&&function(e,t){let n=typeof e;return!!(("string"===t||"number"===t)&&n===t||"boolean"===t&&("true"===e||"false"===e||!0===e||!1===e)||"image"===t&&"string"===n&&e.startsWith("http"))}(t[i.name],i.type)&&(void 0===this.result&&(this.result={}),this.result[i.name]=t[i.name],e=!0)})),e&&this.emitter.emit("message",{userWebhookId:this.id})}}}connect(){clearTimeout(this.scheduledReconnectHandle),this.userWebhook.url&&(this.eventSource=new EventSource(HG+this.userWebhook.url),this.eventSource.addEventListener("message",this._onMessage),this.eventSource.addEventListener("error",this._onError),this.eventSource.addEventListener("open",this._onConnected))}disconnect(){var e,t,n,i;null!==(e=this.eventSource)&&void 0!==e&&e.removeEventListener("message",this._onMessage),null!==(t=this.eventSource)&&void 0!==t&&t.removeEventListener("error",this._onError),null!==(n=this.eventSource)&&void 0!==n&&n.removeEventListener("open",this._onConnected),null!==(i=this.eventSource)&&void 0!==i&&i.close(),this._onDisconnected(),clearTimeout(this.scheduledReconnectHandle)}_scheduleReconnect(){this.reconnectWaitFor*=2,this.reconnectWaitFor>UG&&(this.reconnectWaitFor=UG),clearTimeout(this.scheduledReconnectHandle),this.scheduledReconnectHandle=setTimeout((()=>{this.scheduledReconnectHandle=void 0,this.connect()}),this.reconnectWaitFor)}update(e){this.userWebhook=e}dispose(){this._connected&&this.disconnect()}get connected(){return this._connected}on(e,t){this.emitter.on(e,t)}off(e,t){this.emitter.off(e,t)}getParametersKeys(){return this.userWebhook.parametersSchemas.map((e=>e.data.name))}getParameterValue(e){if(this.getParametersKeys().includes(e)){var t;if(this.result)return null===(t=this.result)||void 0===t?void 0:t[e];for(let t of this.userWebhook.parametersSchemas)if(t.data.name===e)return lR.defaultParameterValueByType(t.data.type)}}}),GG=globalThis.atob,qG=globalThis.btoa,YG=class{static floatTo16BitPCM(e){let t=new ArrayBuffer(2*e.length),n=new DataView(t),i=0;for(let r=0;r<e.length;r++,i+=2){let t=Math.max(-1,Math.min(1,e[r]));n.setInt16(i,t<0?32768*t:32767*t,!0)}return t}static base64ToArrayBuffer(e){let t=GG(e),n=t.length,i=new Uint8Array(n);for(let r=0;r<n;r++)i[r]=t.charCodeAt(r);return i.buffer}static arrayBufferToBase64(e){e instanceof Float32Array?e=this.floatTo16BitPCM(e):e instanceof Int16Array&&(e=e.buffer);let t="",n=new Uint8Array(e);for(let i=0;i<n.length;i+=32768){let e=n.subarray(i,i+32768);t+=String.fromCharCode.apply(null,e)}return qG(t)}static mergeInt16Arrays(e,t){if(e instanceof ArrayBuffer&&(e=new Int16Array(e)),t instanceof ArrayBuffer&&(t=new Int16Array(t)),!(e instanceof Int16Array)||!(t instanceof Int16Array))throw new Error("Both items must be Int16Array");let n=new Int16Array(e.length+t.length);for(let i=0;i<e.length;i++)n[i]=e[i];for(let i=0;i<t.length;i++)n[e.length+i]=t[i];return n}static generateId(e){let t="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz",n=Array((arguments.length>1&&void 0!==arguments[1]?arguments[1]:21)-e.length).fill(0).map((e=>t[Math.floor(58*Math.random())])).join("");return"".concat(e).concat(n)}},XG=e=>new Promise((t=>setTimeout((()=>t()),e))),QG=class{constructor(){this.eventHandlers={},this.nextEventHandlers={}}clearEventHandlers(){return this.eventHandlers={},this.nextEventHandlers={},!0}on(e,t){return this.eventHandlers[e]=this.eventHandlers[e]||[],this.eventHandlers[e].push(t),t}onNext(e,t){return this.nextEventHandlers[e]=this.nextEventHandlers[e]||[],this.nextEventHandlers[e].push(t),t}off(e,t){let n=this.eventHandlers[e]||[];if(t){let i=n.indexOf(t);if(-1===i)throw new Error('Could not turn off specified event listener for "'.concat(e,'": not found as a listener'));n.splice(i,1)}else delete this.eventHandlers[e];return!0}offNext(e,t){let n=this.nextEventHandlers[e]||[];if(t){let i=n.indexOf(t);if(-1===i)throw new Error('Could not turn off specified next event listener for "'.concat(e,'": not found as a listener'));n.splice(i,1)}else delete this.nextEventHandlers[e];return!0}async waitForNext(e){let t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=Date.now();for(this.onNext(e,(e=>t=e));!t;){if(n&&Date.now()-i>n)return null;await XG(1)}return t}dispatch(e,t){let n=[].concat(this.eventHandlers[e]||[]);for(let r of n)r(t);let i=[].concat(this.nextEventHandlers[e]||[]);for(let r of i)r(t);return delete this.nextEventHandlers[e],!0}},KG=class extends QG{constructor(){let{url:e,apiKey:t,dangerouslyAllowAPIKeyInBrowser:n,debug:i}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(super(),this.defaultUrl="wss://api.openai.com/v1/realtime",this.url=e||this.defaultUrl,this.apiKey=t||null,this.debug=!!i,this.ws=null,globalThis.document&&this.apiKey&&!n)throw new Error('Can not provide API key in the browser without "dangerouslyAllowAPIKeyInBrowser" set to true')}isConnected(){return!!this.ws}log(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];let i=["[Websocket/".concat((new Date).toISOString(),"]")].concat(t).map((e=>"object"==typeof e&&null!==e?JSON.stringify(e,null,2):e));return this.debug&&console.log(...i),!0}async connect(){let{model:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{model:"gpt-4o-realtime-preview-2024-10-01"};if(!this.apiKey&&this.url===this.defaultUrl&&console.warn('No apiKey provided for connection to "'.concat(this.url,'"')),this.isConnected())throw new Error("Already connected");if(globalThis.document){this.apiKey&&console.warn("Warning: Connecting using API key in the browser, this is not recommended");let t=new(0,globalThis.WebSocket)("".concat(this.url).concat(e?"?model=".concat(e):""),["realtime","openai-insecure-api-key.".concat(this.apiKey),"openai-beta.realtime-v1"]);return t.addEventListener("message",(e=>{let t=JSON.parse(e.data);this.receive(t.type,t)})),new Promise(((e,n)=>{let i=()=>{this.disconnect(t),n(new Error('Could not connect to "'.concat(this.url,'"')))};t.addEventListener("error",i),t.addEventListener("open",(()=>{this.log('Connected to "'.concat(this.url,'"')),t.removeEventListener("error",i),t.addEventListener("error",(()=>{this.disconnect(t),this.log('Error, disconnected from "'.concat(this.url,'"')),this.dispatch("close",{error:!0})})),t.addEventListener("close",(()=>{this.disconnect(t),this.log('Disconnected from "'.concat(this.url,'"')),this.dispatch("close",{error:!1})})),this.ws=t,e(!0)}))}))}}disconnect(e){if(!e||this.ws===e)return this.ws&&this.ws.close(),this.ws=null,!0}receive(e,t){return this.log("received:",e,t),this.dispatch("server.".concat(e),t),this.dispatch("server.*",t),!0}send(e,t){if(!this.isConnected())throw new Error("RealtimeAPI is not connected");if("object"!=typeof(t=t||{}))throw new Error("data must be an object");let n=d({event_id:YG.generateId("evt_"),type:e},t);return this.dispatch("client.".concat(e),n),this.dispatch("client.*",n),this.log("sent:",e,n),this.ws.send(JSON.stringify(n)),!0}},ZG=class{constructor(){Am(this,"defaultFrequency",24e3),Am(this,"EventProcessors",{"conversation.item.created":e=>{let{item:t}=e,n=JSON.parse(JSON.stringify(t));if(this.itemLookup[n.id]||(this.itemLookup[n.id]=n,this.items.push(n)),n.formatted={},n.formatted.audio=new Int16Array(0),n.formatted.text="",n.formatted.transcript="",this.queuedSpeechItems[n.id]&&(n.formatted.audio=this.queuedSpeechItems[n.id].audio,delete this.queuedSpeechItems[n.id]),n.content){let e=n.content.filter((e=>["text","input_text"].includes(e.type)));for(let t of e)n.formatted.text+=t.text}return this.queuedTranscriptItems[n.id]&&(n.formatted.transcript=this.queuedTranscriptItems.transcript,delete this.queuedTranscriptItems[n.id]),"message"===n.type?"user"===n.role?(n.status="completed",this.queuedInputAudio&&(n.formatted.audio=this.queuedInputAudio,this.queuedInputAudio=null)):n.status="in_progress":"function_call"===n.type?(n.formatted.tool={type:"function",name:n.name,call_id:n.call_id,arguments:""},n.status="in_progress"):"function_call_output"===n.type&&(n.status="completed",n.formatted.output=n.output),{item:n,delta:null}},"conversation.item.truncated":e=>{let{item_id:t,audio_end_ms:n}=e,i=this.itemLookup[t];if(!i)throw new Error('item.truncated: Item "'.concat(t,'" not found'));let r=Math.floor(n*this.defaultFrequency/1e3);return i.formatted.transcript="",i.formatted.audio=i.formatted.audio.slice(0,r),{item:i,delta:null}},"conversation.item.deleted":e=>{let{item_id:t}=e,n=this.itemLookup[t];if(!n)throw new Error('item.deleted: Item "'.concat(t,'" not found'));delete this.itemLookup[n.id];let i=this.items.indexOf(n);return i>-1&&this.items.splice(i,1),{item:n,delta:null}},"conversation.item.input_audio_transcription.completed":e=>{let{item_id:t,content_index:n,transcript:i}=e,r=this.itemLookup[t],s=i||" ";return r?(r.content[n].transcript=i,r.formatted.transcript=s,{item:r,delta:{transcript:i}}):(this.queuedTranscriptItems[t]={transcript:s},{item:null,delta:null})},"input_audio_buffer.speech_started":e=>{let{item_id:t,audio_start_ms:n}=e;return this.queuedSpeechItems[t]={audio_start_ms:n},{item:null,delta:null}},"input_audio_buffer.speech_stopped":(e,t)=>{let{item_id:n,audio_end_ms:i}=e;this.queuedSpeechItems[n]||(this.queuedSpeechItems[n]={audio_start_ms:i});let r=this.queuedSpeechItems[n];if(r.audio_end_ms=i,t){let e=Math.floor(r.audio_start_ms*this.defaultFrequency/1e3),n=Math.floor(r.audio_end_ms*this.defaultFrequency/1e3);r.audio=t.slice(e,n)}return{item:null,delta:null}},"response.created":e=>{let{response:t}=e;return this.responseLookup[t.id]||(this.responseLookup[t.id]=t,this.responses.push(t)),{item:null,delta:null}},"response.output_item.added":e=>{let{response_id:t,item:n}=e,i=this.responseLookup[t];if(!i)throw new Error('response.output_item.added: Response "'.concat(t,'" not found'));return i.output.push(n.id),{item:null,delta:null}},"response.output_item.done":e=>{let{item:t}=e;if(!t)throw new Error('response.output_item.done: Missing "item"');let n=this.itemLookup[t.id];if(!n)throw new Error('response.output_item.done: Item "'.concat(t.id,'" not found'));return n.status=t.status,{item:n,delta:null}},"response.content_part.added":e=>{let{item_id:t,part:n}=e,i=this.itemLookup[t];if(!i)throw new Error('response.content_part.added: Item "'.concat(t,'" not found'));return i.content.push(n),{item:i,delta:null}},"response.audio_transcript.delta":e=>{let{item_id:t,content_index:n,delta:i}=e,r=this.itemLookup[t];if(!r)throw new Error('response.audio_transcript.delta: Item "'.concat(t,'" not found'));return r.content[n].transcript+=i,r.formatted.transcript+=i,{item:r,delta:{transcript:i}}},"response.audio.delta":e=>{let{item_id:t,content_index:n,delta:i}=e,r=this.itemLookup[t];if(!r)throw new Error('response.audio.delta: Item "'.concat(t,'" not found'));let s=YG.base64ToArrayBuffer(i),a=new Int16Array(s);return r.formatted.audio=YG.mergeInt16Arrays(r.formatted.audio,a),{item:r,delta:{audio:a}}},"response.text.delta":e=>{let{item_id:t,content_index:n,delta:i}=e,r=this.itemLookup[t];if(!r)throw new Error('response.text.delta: Item "'.concat(t,'" not found'));return r.content[n].text+=i,r.formatted.text+=i,{item:r,delta:{text:i}}},"response.function_call_arguments.delta":e=>{let{item_id:t,delta:n}=e,i=this.itemLookup[t];if(!i)throw new Error('response.function_call_arguments.delta: Item "'.concat(t,'" not found'));return i.arguments+=n,i.formatted.tool.arguments+=n,{item:i,delta:{arguments:n}}}}),this.clear()}clear(){return this.itemLookup={},this.items=[],this.responseLookup={},this.responses=[],this.queuedSpeechItems={},this.queuedTranscriptItems={},this.queuedInputAudio=null,!0}queueInputAudio(e){return this.queuedInputAudio=e,e}processEvent(e){if(!e.event_id)throw console.error(e),new Error('Missing "event_id" on event');if(!e.type)throw console.error(e),new Error('Missing "type" on event');let t=this.EventProcessors[e.type];if(!t)throw new Error('Missing conversation event processor for "'.concat(e.type,'"'));for(var n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];return t.call(this,e,...i)}getItem(e){return this.itemLookup[e]||null}getItems(){return this.items.slice()}},JG=class extends QG{constructor(){let{url:e,apiKey:t,dangerouslyAllowAPIKeyInBrowser:n,debug:i}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super(),this.defaultSessionConfig={modalities:["text","audio"],instructions:"",voice:"alloy",input_audio_format:"pcm16",output_audio_format:"pcm16",input_audio_transcription:null,turn_detection:null,tools:[],tool_choice:"auto",temperature:.8,max_response_output_tokens:4096},this.sessionConfig={},this.transcriptionModels=[{model:"whisper-1"}],this.defaultServerVadConfig={type:"server_vad",threshold:.5,prefix_padding_ms:300,silence_duration_ms:200},this.realtime=new KG({url:e,apiKey:t,dangerouslyAllowAPIKeyInBrowser:n,debug:i}),this.conversation=new ZG,this._resetConfig(),this._addAPIEventHandlers()}_resetConfig(){return this.sessionCreated=!1,this.tools={},this.sessionConfig=JSON.parse(JSON.stringify(this.defaultSessionConfig)),this.inputAudioBuffer=new Int16Array(0),!0}_addAPIEventHandlers(){var e=this;this.realtime.on("client.*",(e=>{let t={time:(new Date).toISOString(),source:"client",event:e};this.dispatch("realtime.event",t)})),this.realtime.on("server.*",(e=>{let t={time:(new Date).toISOString(),source:"server",event:e};this.dispatch("realtime.event",t)})),this.realtime.on("server.session.created",(()=>this.sessionCreated=!0));let t=function(t){for(var n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];let{item:s,delta:a}=e.conversation.processEvent(t,...i);return{item:s,delta:a}},n=function(n){for(var i=arguments.length,r=new Array(i>1?i-1:0),s=1;s<i;s++)r[s-1]=arguments[s];let{item:a,delta:o}=t(n,...r);return a&&e.dispatch("conversation.updated",{item:a,delta:o}),{item:a,delta:o}},i=async e=>{try{let t=JSON.parse(e.arguments),n=this.tools[e.name];if(!n)throw new Error('Tool "'.concat(e.name,'" has not been added'));let i=await n.handler(t);this.realtime.send("conversation.item.create",{item:{type:"function_call_output",call_id:e.call_id,output:JSON.stringify(i)}})}catch(t){this.realtime.send("conversation.item.create",{item:{type:"function_call_output",call_id:e.call_id,output:JSON.stringify({error:t.message})}})}this.createResponse()};return this.realtime.on("server.response.created",t),this.realtime.on("server.response.output_item.added",t),this.realtime.on("server.response.content_part.added",t),this.realtime.on("server.input_audio_buffer.speech_started",(e=>{t(e),this.dispatch("conversation.interrupted")})),this.realtime.on("server.input_audio_buffer.speech_stopped",(e=>t(e,this.inputAudioBuffer))),this.realtime.on("server.conversation.item.created",(e=>{let{item:t}=n(e);this.dispatch("conversation.item.appended",{item:t}),"completed"===t.status&&this.dispatch("conversation.item.completed",{item:t})})),this.realtime.on("server.conversation.item.truncated",n),this.realtime.on("server.conversation.item.deleted",n),this.realtime.on("server.conversation.item.input_audio_transcription.completed",n),this.realtime.on("server.response.audio_transcript.delta",n),this.realtime.on("server.response.audio.delta",n),this.realtime.on("server.response.text.delta",n),this.realtime.on("server.response.function_call_arguments.delta",n),this.realtime.on("server.response.output_item.done",(async e=>{let{item:t}=n(e);"completed"===t.status&&this.dispatch("conversation.item.completed",{item:t}),t.formatted.tool&&i(t.formatted.tool)})),!0}isConnected(){return this.realtime.isConnected()}reset(){return this.disconnect(),this.clearEventHandlers(),this.realtime.clearEventHandlers(),this._resetConfig(),this._addAPIEventHandlers(),!0}async connect(){if(this.isConnected())throw new Error("Already connected, use .disconnect() first");return await this.realtime.connect(),this.updateSession(),!0}async waitForSessionCreated(){if(!this.isConnected())throw new Error("Not connected, use .connect() first");for(;!this.sessionCreated;)await new Promise((e=>setTimeout((()=>e()),1)));return!0}disconnect(){this.sessionCreated=!1,this.realtime.isConnected()&&this.realtime.disconnect(),this.conversation.clear()}getTurnDetectionType(){var e;return(null===(e=this.sessionConfig.turn_detection)||void 0===e?void 0:e.type)||null}addTool(e,t){if(null===e||void 0===e||!e.name)throw new Error("Missing tool name in definition");let n=null===e||void 0===e?void 0:e.name;if(this.tools[n])throw new Error('Tool "'.concat(n,'" already added. Please use .removeTool("').concat(n,'") before trying to add again.'));if("function"!=typeof t)throw new Error('Tool "'.concat(n,'" handler must be a function'));return this.tools[n]={definition:e,handler:t},this.updateSession(),this.tools[n]}removeTool(e){if(!this.tools[e])throw new Error('Tool "'.concat(e,'" does not exist, can not be removed.'));return delete this.tools[e],!0}deleteItem(e){return this.realtime.send("conversation.item.delete",{item_id:e}),!0}updateSession(){let{modalities:e,instructions:t,voice:n,input_audio_format:i,output_audio_format:r,input_audio_transcription:s,turn_detection:a,tools:o,tool_choice:l,temperature:u,max_response_output_tokens:c}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};void 0!==e&&(this.sessionConfig.modalities=e),void 0!==t&&(this.sessionConfig.instructions=t),void 0!==n&&(this.sessionConfig.voice=n),void 0!==i&&(this.sessionConfig.input_audio_format=i),void 0!==r&&(this.sessionConfig.output_audio_format=r),void 0!==s&&(this.sessionConfig.input_audio_transcription=s),void 0!==a&&(this.sessionConfig.turn_detection=a),void 0!==o&&(this.sessionConfig.tools=o),void 0!==l&&(this.sessionConfig.tool_choice=l),void 0!==u&&(this.sessionConfig.temperature=u),void 0!==c&&(this.sessionConfig.max_response_output_tokens=c);let h=[].concat((o||[]).map((e=>{let t=d({type:"function"},e);if(this.tools[null===t||void 0===t?void 0:t.name])throw new Error('Tool "'.concat(null===t||void 0===t?void 0:t.name,'" has already been defined'));return t})),Object.keys(this.tools).map((e=>d({type:"function"},this.tools[e].definition)))),p=d({},this.sessionConfig);return p.tools=h,this.realtime.isConnected()&&this.realtime.send("session.update",{session:p}),!0}sendUserMessageContent(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if(e.length){for(let t of e)"input_audio"===t.type&&(t.audio instanceof ArrayBuffer||t.audio instanceof Int16Array)&&(t.audio=YG.arrayBufferToBase64(t.audio));this.realtime.send("conversation.item.create",{item:{type:"message",role:"user",content:e}})}return this.createResponse(),!0}appendInputAudio(e){return e.byteLength>0&&(this.realtime.send("input_audio_buffer.append",{audio:YG.arrayBufferToBase64(e)}),this.inputAudioBuffer=YG.mergeInt16Arrays(this.inputAudioBuffer,e)),!0}createResponse(){return null===this.getTurnDetectionType()&&this.inputAudioBuffer.byteLength>0&&(this.realtime.send("input_audio_buffer.commit"),this.conversation.queueInputAudio(this.inputAudioBuffer),this.inputAudioBuffer=new Int16Array(0)),this.realtime.send("response.create"),!0}cancelResponse(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(!e)return this.realtime.send("response.cancel"),{item:null};if(e){let n=this.conversation.getItem(e);if(!n)throw new Error('Could not find item "'.concat(e,'"'));if("message"!==n.type)throw new Error('Can only cancelResponse messages with type "message"');if("assistant"!==n.role)throw new Error('Can only cancelResponse messages with role "assistant"');this.realtime.send("response.cancel");let i=n.content.findIndex((e=>"audio"===e.type));if(-1===i)throw new Error("Could not find audio on item to cancel");return this.realtime.send("conversation.item.truncate",{item_id:e,content_index:i,audio_end_ms:Math.floor(t/this.conversation.defaultFrequency*1e3)}),{item:n}}}async waitForNextItem(){let e=await this.waitForNext("conversation.item.appended"),{item:t}=e;return{item:t}}async waitForNextCompletedItem(){let e=await this.waitForNext("conversation.item.completed"),{item:t}=e;return{item:t}}},$G=new Blob(["\nclass AudioProcessor extends AudioWorkletProcessor {\n\n  constructor() {\n    super();\n    this.port.onmessage = this.receive.bind(this);\n    this.initialize();\n  }\n\n  initialize() {\n    this.foundAudio = false;\n    this.recording = false;\n    this.chunks = [];\n  }\n\n  /**\n   * Concatenates sampled chunks into channels\n   * Format is chunk[Left[], Right[]]\n   */\n  readChannelData(chunks, channel = -1, maxChannels = 9) {\n    let channelLimit;\n    if (channel !== -1) {\n      if (chunks[0] && chunks[0].length - 1 < channel) {\n        throw new Error(\n          `Channel ${channel} out of range: max ${chunks[0].length}`\n        );\n      }\n      channelLimit = channel + 1;\n    } else {\n      channel = 0;\n      channelLimit = Math.min(chunks[0] ? chunks[0].length : 1, maxChannels);\n    }\n    const channels = [];\n    for (let n = channel; n < channelLimit; n++) {\n      const length = chunks.reduce((sum, chunk) => {\n        return sum + chunk[n].length;\n      }, 0);\n      const buffers = chunks.map((chunk) => chunk[n]);\n      const result = new Float32Array(length);\n      let offset = 0;\n      for (let i = 0; i < buffers.length; i++) {\n        result.set(buffers[i], offset);\n        offset += buffers[i].length;\n      }\n      channels[n] = result;\n    }\n    return channels;\n  }\n\n  /**\n   * Combines parallel audio data into correct format,\n   * channels[Left[], Right[]] to float32Array[LRLRLRLR...]\n   */\n  formatAudioData(channels) {\n    if (channels.length === 1) {\n      // Simple case is only one channel\n      const float32Array = channels[0].slice();\n      const meanValues = channels[0].slice();\n      return { float32Array, meanValues };\n    } else {\n      const float32Array = new Float32Array(\n        channels[0].length * channels.length\n      );\n      const meanValues = new Float32Array(channels[0].length);\n      for (let i = 0; i < channels[0].length; i++) {\n        const offset = i * channels.length;\n        let meanValue = 0;\n        for (let n = 0; n < channels.length; n++) {\n          float32Array[offset + n] = channels[n][i];\n          meanValue += channels[n][i];\n        }\n        meanValues[i] = meanValue / channels.length;\n      }\n      return { float32Array, meanValues };\n    }\n  }\n\n  /**\n   * Converts 32-bit float data to 16-bit integers\n   */\n  floatTo16BitPCM(float32Array) {\n    const buffer = new ArrayBuffer(float32Array.length * 2);\n    const view = new DataView(buffer);\n    let offset = 0;\n    for (let i = 0; i < float32Array.length; i++, offset += 2) {\n      let s = Math.max(-1, Math.min(1, float32Array[i]));\n      view.setInt16(offset, s < 0 ? s * 0x8000 : s * 0x7fff, true);\n    }\n    return buffer;\n  }\n\n  /**\n   * Retrieves the most recent amplitude values from the audio stream\n   * @param {number} channel\n   */\n  getValues(channel = -1) {\n    const channels = this.readChannelData(this.chunks, channel);\n    const { meanValues } = this.formatAudioData(channels);\n    return { meanValues, channels };\n  }\n\n  /**\n   * Exports chunks as an audio/wav file\n   */\n  export() {\n    const channels = this.readChannelData(this.chunks);\n    const { float32Array, meanValues } = this.formatAudioData(channels);\n    const audioData = this.floatTo16BitPCM(float32Array);\n    return {\n      meanValues: meanValues,\n      audio: {\n        bitsPerSample: 16,\n        channels: channels,\n        data: audioData,\n      },\n    };\n  }\n\n  receive(e) {\n    const { event, id } = e.data;\n    let receiptData = {};\n    switch (event) {\n      case 'start':\n        this.recording = true;\n        break;\n      case 'stop':\n        this.recording = false;\n        break;\n      case 'clear':\n        this.initialize();\n        break;\n      case 'export':\n        receiptData = this.export();\n        break;\n      case 'read':\n        receiptData = this.getValues();\n        break;\n      default:\n        break;\n    }\n    // Always send back receipt\n    this.port.postMessage({ event: 'receipt', id, data: receiptData });\n  }\n\n  sendChunk(chunk) {\n    const channels = this.readChannelData([chunk]);\n    const { float32Array, meanValues } = this.formatAudioData(channels);\n    const rawAudioData = this.floatTo16BitPCM(float32Array);\n    const monoAudioData = this.floatTo16BitPCM(meanValues);\n    this.port.postMessage({\n      event: 'chunk',\n      data: {\n        mono: monoAudioData,\n        raw: rawAudioData,\n      },\n    });\n  }\n\n  process(inputList, outputList, parameters) {\n    // Copy input to output (e.g. speakers)\n    // Note that this creates choppy sounds with Mac products\n    const sourceLimit = Math.min(inputList.length, outputList.length);\n    for (let inputNum = 0; inputNum < sourceLimit; inputNum++) {\n      const input = inputList[inputNum];\n      const output = outputList[inputNum];\n      const channelCount = Math.min(input.length, output.length);\n      for (let channelNum = 0; channelNum < channelCount; channelNum++) {\n        input[channelNum].forEach((sample, i) => {\n          output[channelNum][i] = sample;\n        });\n      }\n    }\n    const inputs = inputList[0];\n    // There's latency at the beginning of a stream before recording starts\n    // Make sure we actually receive audio data before we start storing chunks\n    let sliceIndex = 0;\n    if (!this.foundAudio) {\n      for (const channel of inputs) {\n        sliceIndex = 0; // reset for each channel\n        if (this.foundAudio) {\n          break;\n        }\n        if (channel) {\n          for (const value of channel) {\n            if (value !== 0) {\n              // find only one non-zero entry in any channel\n              this.foundAudio = true;\n              break;\n            } else {\n              sliceIndex++;\n            }\n          }\n        }\n      }\n    }\n    if (inputs && inputs[0] && this.foundAudio && this.recording) {\n      // We need to copy the TypedArray, because the `process`\n      // internals will reuse the same buffer to hold each input\n      const chunk = inputs.map((input) => input.slice(sliceIndex));\n      this.chunks.push(chunk);\n      this.sendChunk(chunk);\n    }\n    return true;\n  }\n}\n\nregisterProcessor('audio_processor', AudioProcessor);\n"],{type:"application/javascript"}),eq=URL.createObjectURL($G),tq=[4186.01,4434.92,4698.63,4978.03,5274.04,5587.65,5919.91,6271.93,6644.88,7040,7458.62,7902.13],nq=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"],iq=[],rq=[];for(let n=1;n<=8;n++)for(let e=0;e<tq.length;e++){let t=tq[e];iq.push(t/Math.pow(2,8-n)),rq.push(nq[e]+n)}var sq=[32,2e3],aq=iq.filter(((e,t)=>iq[t]>sq[0]&&iq[t]<sq[1])),oq=rq.filter(((e,t)=>iq[t]>sq[0]&&iq[t]<sq[1])),lq=class{static getFrequencies(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"frequency",r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:-100,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:-30;n||(n=new Float32Array(e.frequencyBinCount),e.getFloatFrequencyData(n));let a,o,l,u=t/2,c=1/n.length*u;if("music"===i||"voice"===i){let e="voice"===i?aq:iq,t=Array(e.length).fill(r);for(let i=0;i<n.length;i++){let r=i*c,s=n[i];for(let n=e.length-1;n>=0;n--)if(r>e[n]){t[n]=Math.max(t[n],s);break}}a=t,o="voice"===i?aq:iq,l="voice"===i?oq:rq}else a=Array.from(n),o=a.map(((e,t)=>c*t)),l=o.map((e=>"".concat(e.toFixed(2)," Hz")));let h=a.map((e=>Math.max(0,Math.min((e-r)/(s-r),1))));return{values:new Float32Array(h),frequencies:o,labels:l}}constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(this.fftResults=[],t){let{length:n,sampleRate:i}=t,r=new OfflineAudioContext({length:n,sampleRate:i}),s=r.createBufferSource();s.buffer=t;let a=r.createAnalyser();a.fftSize=8192,a.smoothingTimeConstant=.1,s.connect(a);let o=1/60,l=n/i,u=e=>{let t=o*e;t<l&&r.suspend(t).then((()=>{let t=new Float32Array(a.frequencyBinCount);a.getFloatFrequencyData(t),this.fftResults.push(t),u(e+1)})),1===e?r.startRendering():r.resume()};s.start(0),u(1),this.audio=e,this.context=r,this.analyser=a,this.sampleRate=i,this.audioBuffer=t}else{let t=new AudioContext,n=t.createMediaElementSource(e),i=t.createAnalyser();i.fftSize=8192,i.smoothingTimeConstant=.1,n.connect(i),i.connect(t.destination),this.audio=e,this.context=t,this.analyser=i,this.sampleRate=this.context.sampleRate,this.audioBuffer=null}}getFrequencies(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"frequency",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-100,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-30,i=null;if(this.audioBuffer&&this.fftResults.length){let e=this.audio.currentTime/this.audio.duration,t=Math.min(e*this.fftResults.length|0,this.fftResults.length-1);i=this.fftResults[t]}return lq.getFrequencies(this.analyser,this.sampleRate,i,e,t,n)}async resumeIfSuspended(){return"suspended"===this.context.state&&await this.context.resume(),!0}},uq=class{static floatTo16BitPCM(e){let t=new ArrayBuffer(2*e.length),n=new DataView(t),i=0;for(let r=0;r<e.length;r++,i+=2){let t=Math.max(-1,Math.min(1,e[r]));n.setInt16(i,t<0?32768*t:32767*t,!0)}return t}static mergeBuffers(e,t){let n=new Uint8Array(e.byteLength+t.byteLength);return n.set(new Uint8Array(e),0),n.set(new Uint8Array(t),e.byteLength),n.buffer}_packData(e,t){return[new Uint8Array([t,t>>8]),new Uint8Array([t,t>>8,t>>16,t>>24])][e]}pack(e,t){if(null===t||void 0===t||!t.bitsPerSample)throw new Error('Missing "bitsPerSample"');if(null===t||void 0===t||!t.channels)throw new Error('Missing "channels"');if(null===t||void 0===t||!t.data)throw new Error('Missing "data"');let{bitsPerSample:n,channels:i,data:r}=t,s=["RIFF",this._packData(1,52),"WAVE","fmt ",this._packData(1,16),this._packData(0,1),this._packData(0,i.length),this._packData(1,e),this._packData(1,e*i.length*n/8),this._packData(0,i.length*n/8),this._packData(0,n),"data",this._packData(1,i[0].length*i.length*n/8),r],a=new Blob(s,{type:"audio/mpeg"});return{blob:a,url:URL.createObjectURL(a),channelCount:i.length,sampleRate:e,duration:r.byteLength/(i.length*e*2)}}},cq=class{constructor(){let{sampleRate:e=44100,outputToSpeakers:t=!1,debug:n=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.scriptSrc=eq,this.sampleRate=e,this.outputToSpeakers=t,this.debug=!!n,this._deviceChangeCallback=null,this._devices=[],this.stream=null,this.processor=null,this.source=null,this.node=null,this.recording=!1,this._lastEventId=0,this.eventReceipts={},this.eventTimeout=5e3,this._chunkProcessor=()=>{},this._chunkProcessorSize=void 0,this._chunkProcessorBuffer={raw:new ArrayBuffer(0),mono:new ArrayBuffer(0)}}static async decode(e){let t,n,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1,r=new AudioContext({sampleRate:arguments.length>1&&void 0!==arguments[1]?arguments[1]:44100});if(e instanceof Blob){if(-1!==i)throw new Error('Can not specify "fromSampleRate" when reading from Blob');n=e,t=await n.arrayBuffer()}else if(e instanceof ArrayBuffer){if(-1!==i)throw new Error('Can not specify "fromSampleRate" when reading from ArrayBuffer');t=e,n=new Blob([t],{type:"audio/wav"})}else{let r,s;if(e instanceof Int16Array){s=e,r=new Float32Array(e.length);for(let t=0;t<e.length;t++)r[t]=e[t]/32768}else if(e instanceof Float32Array)r=e;else{if(!(e instanceof Array))throw new Error('"audioData" must be one of: Blob, Float32Arrray, Int16Array, ArrayBuffer, Array<number>');r=new Float32Array(e)}if(-1===i)throw new Error('Must specify "fromSampleRate" when reading from Float32Array, In16Array or Array');if(i<3e3)throw new Error('Minimum "fromSampleRate" is 3000 (3kHz)');s||(s=uq.floatTo16BitPCM(r));let a={bitsPerSample:16,channels:[r],data:s};n=(new uq).pack(i,a).blob,t=await n.arrayBuffer()}let s=await r.decodeAudioData(t),a=s.getChannelData(0);return{blob:n,url:URL.createObjectURL(n),values:a,audioBuffer:s}}log(){return this.debug&&this.log(...arguments),!0}getSampleRate(){return this.sampleRate}getStatus(){return this.processor?this.recording?"recording":"paused":"ended"}async _event(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(n=n||this.processor,!n)throw new Error("Can not send events without recording first");let i={event:e,id:this._lastEventId++,data:t};n.port.postMessage(i);let r=(new Date).valueOf();for(;!this.eventReceipts[i.id];){if((new Date).valueOf()-r>this.eventTimeout)throw new Error('Timeout waiting for "'.concat(e,'" event'));await new Promise((e=>setTimeout((()=>e(!0)),1)))}let s=this.eventReceipts[i.id];return delete this.eventReceipts[i.id],s}listenForDeviceChange(e){if(null===e&&this._deviceChangeCallback)navigator.mediaDevices.removeEventListener("devicechange",this._deviceChangeCallback),this._deviceChangeCallback=null;else if(null!==e){let t=0,n=[],i=e=>e.map((e=>e.deviceId)).sort().join(","),r=async()=>{let r=++t,s=await this.listDevices();r===t&&i(n)!==i(s)&&(n=s,e(s.slice()))};navigator.mediaDevices.addEventListener("devicechange",r),r(),this._deviceChangeCallback=r}return!0}async requestPermission(){let e=await navigator.permissions.query({name:"microphone"});if("denied"===e.state)window.alert("You must grant microphone access to use this feature.");else if("prompt"===e.state)try{(await navigator.mediaDevices.getUserMedia({audio:!0})).getTracks().forEach((e=>e.stop()))}catch(t){window.alert("You must grant microphone access to use this feature.")}return!0}async listDevices(){if(!navigator.mediaDevices||!("enumerateDevices"in navigator.mediaDevices))throw new Error("Could not request user devices");await this.requestPermission();let e=(await navigator.mediaDevices.enumerateDevices()).filter((e=>"audioinput"===e.kind)),t=e.findIndex((e=>"default"===e.deviceId)),n=[];if(-1!==t){let i=e.splice(t,1)[0],r=e.findIndex((e=>e.groupId===i.groupId));-1!==r&&(i=e.splice(r,1)[0]),i.default=!0,n.push(i)}return n.concat(e)}async begin(e){if(this.processor)throw new Error("Already connected: please call .end() to start a new session");if(!navigator.mediaDevices||!("getUserMedia"in navigator.mediaDevices))throw new Error("Could not request user media");try{let t={audio:!0};e&&(t.audio={deviceId:{exact:e}}),this.stream=await navigator.mediaDevices.getUserMedia(t)}catch(a){throw new Error("Could not start media stream")}let t=new AudioContext({sampleRate:this.sampleRate}),n=t.createMediaStreamSource(this.stream);try{await t.audioWorklet.addModule(this.scriptSrc)}catch(wi){throw console.error(wi),new Error("Could not add audioWorklet module: ".concat(this.scriptSrc))}let i=new AudioWorkletNode(t,"audio_processor");i.port.onmessage=e=>{let{event:t,id:n,data:i}=e.data;if("receipt"===t)this.eventReceipts[n]=i;else if("chunk"===t)if(this._chunkProcessorSize){let e=this._chunkProcessorBuffer;this._chunkProcessorBuffer={raw:uq.mergeBuffers(e.raw,i.raw),mono:uq.mergeBuffers(e.mono,i.mono)},this._chunkProcessorBuffer.mono.byteLength>=this._chunkProcessorSize&&(this._chunkProcessor(this._chunkProcessorBuffer),this._chunkProcessorBuffer={raw:new ArrayBuffer(0),mono:new ArrayBuffer(0)})}else this._chunkProcessor(i)};let r=n.connect(i),s=t.createAnalyser();return s.fftSize=8192,s.smoothingTimeConstant=.1,r.connect(s),this.outputToSpeakers&&(console.warn("Warning: Output to speakers may affect sound quality,\nespecially due to system audio feedback preventative measures.\nuse only for debugging"),s.connect(t.destination)),this.source=n,this.node=r,this.analyser=s,this.processor=i,!0}getFrequencies(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"frequency",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-100,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-30;if(!this.processor)throw new Error("Session ended: please call .begin() first");return lq.getFrequencies(this.analyser,this.sampleRate,null,e,t,n)}async pause(){if(!this.processor)throw new Error("Session ended: please call .begin() first");if(!this.recording)throw new Error("Already paused: please call .record() first");return this._chunkProcessorBuffer.raw.byteLength&&this._chunkProcessor(this._chunkProcessorBuffer),this.log("Pausing ..."),await this._event("stop"),this.recording=!1,!0}async record(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:()=>{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:8192;if(!this.processor)throw new Error("Session ended: please call .begin() first");if(this.recording)throw new Error("Already recording: please call .pause() first");if("function"!=typeof e)throw new Error("chunkProcessor must be a function");return this._chunkProcessor=e,this._chunkProcessorSize=t,this._chunkProcessorBuffer={raw:new ArrayBuffer(0),mono:new ArrayBuffer(0)},this.log("Recording ..."),await this._event("start"),this.recording=!0,!0}async clear(){if(!this.processor)throw new Error("Session ended: please call .begin() first");return await this._event("clear"),!0}async read(){if(!this.processor)throw new Error("Session ended: please call .begin() first");return this.log("Reading ..."),await this._event("read")}async save(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this.processor)throw new Error("Session ended: please call .begin() first");if(!e&&this.recording)throw new Error("Currently recording: please call .pause() first, or call .save(true) to force");this.log("Exporting ...");let t=await this._event("export");return(new uq).pack(this.sampleRate,t.audio)}async end(){if(!this.processor)throw new Error("Session ended: please call .begin() first");let e=this.processor;this.log("Stopping ..."),await this._event("stop"),this.recording=!1,this.stream.getTracks().forEach((e=>e.stop())),this.log("Exporting ...");let t=await this._event("export",{},e);return this.processor.disconnect(),this.source.disconnect(),this.node.disconnect(),this.analyser.disconnect(),this.stream=null,this.processor=null,this.source=null,this.node=null,(new uq).pack(this.sampleRate,t.audio)}async quit(){return this.listenForDeviceChange(null),this.processor&&await this.end(),!0}},hq=new Blob(["\nclass StreamProcessor extends AudioWorkletProcessor {\n  constructor() {\n    super();\n    this.hasStarted = false;\n    this.hasInterrupted = false;\n    this.outputBuffers = [];\n    this.bufferLength = 128;\n    this.write = { buffer: new Float32Array(this.bufferLength), trackId: null };\n    this.writeOffset = 0;\n    this.trackSampleOffsets = {};\n    this.port.onmessage = (event) => {\n      if (event.data) {\n        const payload = event.data;\n        if (payload.event === 'write') {\n          const int16Array = payload.buffer;\n          const float32Array = new Float32Array(int16Array.length);\n          for (let i = 0; i < int16Array.length; i++) {\n            float32Array[i] = int16Array[i] / 0x8000; // Convert Int16 to Float32\n          }\n          this.writeData(float32Array, payload.trackId);\n        } else if (\n          payload.event === 'offset' ||\n          payload.event === 'interrupt'\n        ) {\n          const requestId = payload.requestId;\n          const trackId = this.write.trackId;\n          const offset = this.trackSampleOffsets[trackId] || 0;\n          this.port.postMessage({\n            event: 'offset',\n            requestId,\n            trackId,\n            offset,\n          });\n          if (payload.event === 'interrupt') {\n            this.hasInterrupted = true;\n          }\n        } else {\n          throw new Error(`Unhandled event \"${payload.event}\"`);\n        }\n      }\n    };\n  }\n\n  writeData(float32Array, trackId = null) {\n    let { buffer } = this.write;\n    let offset = this.writeOffset;\n    for (let i = 0; i < float32Array.length; i++) {\n      buffer[offset++] = float32Array[i];\n      if (offset >= buffer.length) {\n        this.outputBuffers.push(this.write);\n        this.write = { buffer: new Float32Array(this.bufferLength), trackId };\n        buffer = this.write.buffer;\n        offset = 0;\n      }\n    }\n    this.writeOffset = offset;\n    return true;\n  }\n\n  process(inputs, outputs, parameters) {\n    const output = outputs[0];\n    const outputChannelData = output[0];\n    const outputBuffers = this.outputBuffers;\n    if (this.hasInterrupted) {\n      this.port.postMessage({ event: 'stop' });\n      return false;\n    } else if (outputBuffers.length) {\n      this.hasStarted = true;\n      const { buffer, trackId } = outputBuffers.shift();\n      for (let i = 0; i < outputChannelData.length; i++) {\n        outputChannelData[i] = buffer[i] || 0;\n      }\n      if (trackId) {\n        this.trackSampleOffsets[trackId] =\n          this.trackSampleOffsets[trackId] || 0;\n        this.trackSampleOffsets[trackId] += buffer.length;\n      }\n      return true;\n    } else if (this.hasStarted) {\n      this.port.postMessage({ event: 'stop' });\n      return false;\n    } else {\n      return true;\n    }\n  }\n}\n\nregisterProcessor('stream_processor', StreamProcessor);\n"],{type:"application/javascript"}),dq=URL.createObjectURL(hq),pq=class{constructor(){let{sampleRate:e=44100}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.scriptSrc=dq,this.sampleRate=e,this.context=null,this.stream=null,this.analyser=null,this.trackSampleOffsets={},this.interruptedTrackIds={}}async connect(){this.context=new AudioContext({sampleRate:this.sampleRate}),"suspended"===this.context.state&&await this.context.resume();try{await this.context.audioWorklet.addModule(this.scriptSrc)}catch(Mn){throw console.error(Mn),new Error("Could not add audioWorklet module: ".concat(this.scriptSrc))}let e=this.context.createAnalyser();return e.fftSize=8192,e.smoothingTimeConstant=.1,this.analyser=e,!0}getFrequencies(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"frequency",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-100,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-30;if(!this.analyser)throw new Error("Not connected, please call .connect() first");return lq.getFrequencies(this.analyser,this.sampleRate,null,e,t,n)}_start(){let e=new AudioWorkletNode(this.context,"stream_processor");return e.connect(this.context.destination),e.port.onmessage=t=>{let{event:n}=t.data;if("stop"===n)e.disconnect(),this.stream=null;else if("offset"===n){let{requestId:e,trackId:n,offset:i}=t.data,r=i/this.sampleRate;this.trackSampleOffsets[e]={trackId:n,offset:i,currentTime:r}}},this.analyser.disconnect(),e.connect(this.analyser),this.stream=e,!0}add16BitPCM(e){let t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"default";if("string"!=typeof n)throw new Error("trackId must be a string");if(!this.interruptedTrackIds[n]){if(this.stream||this._start(),e instanceof Int16Array)t=e;else{if(!(e instanceof ArrayBuffer))throw new Error("argument must be Int16Array or ArrayBuffer");t=new Int16Array(e)}return this.stream.port.postMessage({event:"write",buffer:t,trackId:n}),t}}async getTrackSampleOffset(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this.stream)return null;let t,n=crypto.randomUUID();for(this.stream.port.postMessage({event:e?"interrupt":"offset",requestId:n});!t;)t=this.trackSampleOffsets[n],await new Promise((e=>setTimeout((()=>e()),1)));let{trackId:i}=t;return e&&i&&(this.interruptedTrackIds[i]=!0),t}async interrupt(){return this.getTrackSampleOffset(!0)}},fq=class{constructor(e,t,n){this.data=e,this.id=t,this.shared=n,this.items=[],this.isConnected=!1,this.rafId=0,this.emitter=_U(),this.voice=0,this.frequencies=new Float32Array([0]),this.onRealTimeEvent=e=>{let{time:t,source:n,event:i}=e;"server"===n&&"spline.ready"===i.type?this.onSessionCreated(i):"server"===n&&"session.created"===i.type&&(this.client.createResponse(),this.client.on("realtime.event",this.onRealTimeEvent))},this.onSessionCreated=async e=>{let t=Object.values(this.client.tools).map((e=>d({type:"function"},e.definition)));this.client.realtime.send("spline.tools",{tools:t}),this.client.realtime.send("spline.connect",{}),await this.wavRecorder.record((e=>this.client.isConnected()&&this.client.appendInputAudio(e.mono)))},this.animate=()=>{if(this.rafId=requestAnimationFrame(this.animate),this.isConnected){let e=this.wavStreamPlayer.analyser?this.wavStreamPlayer.getFrequencies("voice"):{values:new Float32Array([0])},t=e.values.reduce(((e,t)=>e+t),0)/e.values.length;this.voice=t,this.frequencies=e.values,this.emitter.emit("voice",{value:t,frequencies:e.values})}},this.client=new JG({url:"https://relayserver.spline.design/?uuidfile="+e.integration.hash}),this.wavRecorder=new cq({sampleRate:24e3}),this.wavStreamPlayer=new pq({sampleRate:24e3})}update(e){this.data=e,this.client=new JG({url:"https://relayserver.spline.design/?uuidfile="+e.integration.hash})}setColorByName(e,t){let n=this.shared.getColorByName(e);if(n){var i;let{id:e}=n,{r:r,g:s,b:a}=null!==(i=yU.hexStringToRgb(t))&&void 0!==i?i:{r:0,g:0,b:0};this.shared.updateColor(e,{r:r/255,g:s/255,b:a/255})}}connect(){if(this.isConnected)return;this.isConnected=!0,this.client.updateSession({turn_detection:{type:"server_vad"}}),this.client.addTool({name:"set_personality_color",description:"returns a color based on the voice personality of the ai assistant. This should be called by the voice assistant each time it is asks to speak differently. If a color cannot be associated to the personality, the color should be a neutral color.",parameters:{type:"object",properties:{color:{type:"string",description:"css hex color string, reflecting the personality"},personality:{type:"string",description:"the personality of the voice assistant"}},required:["color","personality"]}},(e=>{let{color:t}=e;this.setColorByName("Voice Assistant Color",t)}));let e=this.shared.getVariablesNames().join(", ");this.client.addTool({name:"set_variable",description:"Sets a Spline variable value when asked by the user.",parameters:{type:"object",properties:{name:{type:"string",description:"The name of the variable that needs to be set. Here's a list of available variables: ".concat(e,". It the variable does not exist, don't call the function and warn the user about it.")},value:{type:"string",description:"The new value for this variable, should always be a string even for number and boolean variables, assume that the value will be cast to the proper type afterwards."}},required:["name","value","type"]}},(e=>{let{name:t,value:n}=e,i=this.shared.getVariableByName(t);if(i){let e,t=this.shared.getVariable(i.id);e="number"==typeof t?parseFloat(n):"boolean"==typeof t?"true"===n.toLowerCase():{textValue:n},this.shared.updateVariable(i.id,e)}}));let t=this.shared.getColorNames().join(", ");this.client.addTool({name:"set_color",description:"Sets a Spline color asset value when asked by the user.",parameters:{type:"object",properties:{name:{type:"string",description:"The name of the color asset that needs to be set. Here's a list of available color assets: ".concat(t,". It the color asset does not exist, don't call the function and warn the user about it.")},value:{type:"string",description:"css hex color string"}},required:["name","value"]}},(e=>{let{name:t,value:n}=e;this.setColorByName(t,n)}));let n=this.shared.scene,i=[];n.traverseEntity((e=>{e.data.events.forEach((e=>{if("AIAssistantTrigger"===e.data.type){let{description:t}=e.data;i.push(t)}}))})),this.client.addTool({name:"trigger_event",description:"Trigger an event by name, here are the available events, please match what the user is asking for to one of these if it applies, otherwise don't call the function and warn the user.",parameters:{type:"object",properties:{description:{type:"string",description:"The name of the event that needs to be triggered. Here's a list of available events: ".concat(JSON.stringify(i),".")},direction:{type:"string",description:"default is forward, but can be forward or backward. Always set to forward unless the user ask to reverse or cancel the event, then set to backward."}},required:["description","direction"]}},(e=>{let{description:t,direction:n}=e;this.emitter.emit("trigger_event",{description:t,direction:n})})),this.client.on("error",(e=>console.error(e))),this.client.on("conversation.interrupted",(async()=>{let e=await this.wavStreamPlayer.interrupt();if(null!==e&&void 0!==e&&e.trackId){let{trackId:t,offset:n}=e;await this.client.cancelResponse(t,n)}})),this.client.on("conversation.updated",(async e=>{var t;let{item:n,delta:i}=e,r=this.client.conversation.getItems();if(null!==i&&void 0!==i&&i.audio&&this.wavStreamPlayer.add16BitPCM(i.audio,n.id),"completed"===n.status&&null!==(t=n.formatted.audio)&&void 0!==t&&t.length){let e=await cq.decode(n.formatted.audio,24e3,24e3);n.formatted.file=e}this.items=r})),this.animate()}disconnect(){cancelAnimationFrame(this.rafId),this.voice=0,this.isConnected=!1}async start(){try{await this.wavRecorder.end()}catch(e){}await this.wavRecorder.begin(),this.client.on("realtime.event",this.onRealTimeEvent),await this.wavStreamPlayer.connect(),await this.client.connect()}async stop(){try{this.client.off("realtime.event",this.onRealTimeEvent)}catch(e){console.error(e)}this.client.disconnect(),await this.wavRecorder.end(),await this.wavStreamPlayer.interrupt()}computeAnalysisForListenerEvent(e){if("range"===e.analysis){let t=this.frequencies.slice(...e.analysisRange);return t.reduce(((e,t)=>e+t),0)/t.length}return"single"===e.analysis?this.frequencies[e.analysisSingle]:this.voice}on(e,t){this.emitter.on(e,t)}off(e,t){this.emitter.off(e,t)}};function mq(e){return"variable_"+e}var gq=class extends _W{constructor(e){super(),this.shared=e}create(e){return new SW(e,this.shared)}},vq=class{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(this.data=e,this.needsJitter=n,this.enableLocalStorageForPersistentVariables=i,this.geometryCache=new zG(!0),this.geometryCache2=new zG(!1),this.imageHolderCache=new gq(this),this.thisContext={scene:NG,shared:this},this.deletedMaterial=new mG(yB.defaultTwoLayerData("phong"),this.thisContext,""),this.deletedImage=new EW(LR.emptyImage,this),this.deletedVideo=new EW(lB.defaultVideo,this),this.materials={},this.images={},this.uiBuffers={},this.videos={},this.colors={},this.audios={},this.particles={},this.fonts={},this.variables={},this.userAPIs={},this.userWebhooks={},this.mouseProperty=null,this.raycastProperty=null,this.requestRender=()=>{this._requestRender&&this._requestRender()},t.images)for(let[r,s]of Object.entries(t.images))this.addImage(r,s);if(t.videos)for(let[r,s]of Object.entries(t.videos))this.addVideo(r,s);if(t.audios)for(let[r,s]of Object.entries(t.audios))this.addAudio(r,s);if(t.particles)for(let[r,s]of Object.entries(t.particles))this.addParticle(r,s);this.reset(e)}setRequestRender(e){this._requestRender=e}getImageLoadPromises(){return Object.values(this.images).map((e=>e.loadPromise))}setEntityOpContext(e){this.entityOpContext=e}reset(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.data=e,this.resetLib(e.lib);for(let{id:n,data:i}of e.variables)this.addVariableHolder(n,i),t&&this.updateVariableHolder(n,i);for(let[n,i]of Object.entries(e.userAPIs))this.addUserAPI(n,i);for(let[n,i]of Object.entries(e.userWebhooks))this.addUserWebhook(n,i);for(let[n,i]of Object.entries(e.images))this.addImage(n,i);for(let[n,i]of Object.entries(e.videos))this.addVideo(n,i);for(let[n,i]of Object.entries(e.colors))this.addColor(n,i);for(let[n,i]of Object.entries(e.materials))this.addMaterial(n,i);for(let[n,i]of Object.entries(e.audios))this.addAudio(n,i);for(let[n,i]of Object.entries(e.particles))this.addParticle(n,i);for(let[n,i]of Object.entries(e.fonts))this.addFont(n,i)}addMaterial(e,t){if(this.materials[e]){let n=this.materials[e];n.reset(t,this.thisContext),n.dispose()}else{let n=new mG(t,this.thisContext,e);this.materials[e]=n}}deleteMaterial(e){this.materials[e]&&(this.materials[e].nodeMaterialDispose(),delete this.materials[e])}getMaterial(e){return this.materials[e]}getMaterialOrDeletedPlaceholder(e){var t;return null!==(t=this.materials[e])&&void 0!==t?t:this.deletedMaterial}material(e){return"string"==typeof e?this.getMaterialOrDeletedPlaceholder(e):null==e?(console.error("material is undefined or null"),this.deletedMaterial):new fG(e,this.thisContext)}getMaterials(){return this.materials}addImage(e,t){return this.images[e]?(this.onColorOrImageUpdate&&this.onColorOrImageUpdate(),this.images[e].updateSrc(t.data),!0):(this.images[e]=new EW(t,this),!1)}deleteImage(e){let t=this.images[e];t&&(t.dispose(),delete this.images[e])}getDefaultImage(){return this.images.image_0}getImage(e){var t;return null!==(t=this.images[e])&&void 0!==t?t:this.deletedImage}image(e){return"string"==typeof e?this.getImage(e):this.imageHolderCache.load(e)}addUIBuffer(e,t){return this.uiBuffers[e]?(this.onColorOrImageUpdate&&this.onColorOrImageUpdate(),this.uiBuffers[e].updateSrc(t),!0):(this.uiBuffers[e]=new EW(t,this),!1)}uiBuffer(e){return this.uiBuffers[e]}addVideo(e,t){return this.videos[e]?(this.videos[e].updateSrc(t.data),!0):(this.videos[e]=new EW(t,this),!1)}deleteVideo(e){let t=this.videos[e];t&&(t.dispose(),delete this.videos[e])}getVideo(e){var t;return null!==(t=this.videos[e])&&void 0!==t?t:this.deletedVideo}video(e){return"string"==typeof e?this.getVideo(e):this.imageHolderCache.load(e)}addColor(e,t){return this.colors[e]?(this.onColorOrImageUpdate&&this.onColorOrImageUpdate(),"a"in t?this.colors[e].setRGBA(t.r,t.g,t.b,t.a):this.colors[e].setRGBA(t.r,t.g,t.b,1),!0):(this.colors[e]=new $W(t.r,t.g,t.b,"a"in t?t.a:1),!1)}updateColor(e,t){if(this.colors[e]){var n,i,r,s;this.onColorOrImageUpdate&&this.onColorOrImageUpdate();let a=this.colors[e];return this.colors[e].r=null!==(n=t.r)&&void 0!==n?n:a.r,this.colors[e].g=null!==(i=t.g)&&void 0!==i?i:a.g,this.colors[e].b=null!==(r=t.b)&&void 0!==r?r:a.b,this.colors[e].a=null!==(s=t.a)&&void 0!==s?s:a.a,!0}return!1}deleteColor(e){this.colors[e]&&delete this.colors[e]}getColor(e){return this.colors[e]}getColorNames(){return Object.values(this.data.colors).map((e=>e.name))}getColorByName(e){for(let t in this.data.colors)if(this.data.colors[t].name===e)return{color:this.colors[t],id:t}}color(e){let t;if("string"!=typeof e)return new jV(e.r,e.g,e.b,"a"in e?e.a:1);{let n=this.getColor(e);n?t=n:(console.warn("Tried to create color layer params with a color key that does not exist in the assets manager"),t=new jV(0,0,0,0))}return t}addAudio(e,t){this.audios[e]=t}getAudio(e){let t=this.audios[e];if(t instanceof AG)return t;{let n=new AG({src:t.data});return this.audios[e]=n,n}}addParticle(e,t){this.particles[e]=t}getParticle(e){return this.particles[e]}deleteParticle(e){this.particles[e]&&delete this.particles[e]}deleteAudio(e){let t=this.audios[e];t&&(t instanceof AG&&t.dispose(),delete this.audios[e])}addFont(e,t){this.fonts[e]=new RG(t),this.fonts[e].loadingPromise.then((()=>this.requestRender()))}getFont(e){return this.fonts[e]}deleteFont(e){this.fonts[e]&&delete this.fonts[e]}dispose(){Object.keys(this.materials).forEach((e=>this.deleteMaterial(e))),this._requestRender=void 0,Object.values(this.audios).forEach((e=>{e instanceof AG&&e.dispose()})),this.audios={},this.particles={},this.geometryCache.dispose(),this.geometryCache2.dispose()}addVariableHolder(e,t){if(void 0===this.variables[e]){let n=t.value;if(this.enableLocalStorageForPersistentVariables&&t.persistent){let i=localStorage.getItem(mq(e));n=null!==i?JSON.parse(i):t.value}return this.variables[e]={value:n,locations:[],persistent:t.persistent},"dynamicVariableType"in t&&(this.variables[e].dynamicVariablePlayState="Playing",this.variables[e].dynamicVariableToggleIsForward=void 0),!0}return this.variables[e].value=t.value,!1}resetDynamicVariablePlayState(){for(let e in this.variables)void 0!==this.variables[e].dynamicVariablePlayState&&(this.variables[e].dynamicVariablePlayState="Playing",this.variables[e].dynamicVariableToggleIsForward=void 0)}updateVariableHolder(e,t){this.updateVariable(e,t.value)}updateVariable(e,t){if(void 0===this.variables[e])return!1;this.variables[e].value=t,this.enableLocalStorageForPersistentVariables&&this.variables[e].persistent&&localStorage.setItem(mq(e),JSON.stringify(t));let n=t;for(;"string"==typeof n;)n=this.variables[n].value;let i=this.entityOpContext.scene;for(let r=this.variables[e].locations.length-1;r>=0;r--){let t=this.variables[e].locations[r];if("material"===t[0]){let e=t[1],r=n,s={scene:i,shared:this},a=t.slice(2);i.traverseMaterial((t=>{var n;let i=null!==(n=t.root)&&void 0!==n?n:t;i.uuid===e&&i.onVariableUpdate(a,r,s)}));let o=this.materials[e];o&&o.onVariableUpdate(a,r,s)}else{let s=i.find(t[0]);if(void 0===s){this.variables[e].locations.splice(r,1);continue}if("geometry"!==t[1]&&"particles"!==t[1]){for(let e=1;e<t.length-1;e++)s=s[t[e]];"rotation"===t[1]?s[t[t.length-1]]=n*ov.DEG2RAD:s[t[t.length-1]]=n}if(s=i.find(t[0]),"ParticleEmitter"===s.type&&s.updateVariableState(n,t),Nz.is(s))if("position"===t[1]||"rotation"===t[1]||"scale"===t[1])s.onVariableUpdate();else if("geometry"===t[1]){let e=s;s.component&&(e=s.component);let t=e.dataPatched;e.chooseGeoemtryCache(this).forceDelete(t.geometry),e.createGeometryDelayed(this.entityOpContext),e.onVariableUpdate(!0),e.invalidateDownstreamBooleanData(),e.instances.forEach((e=>{let t=e.dataPatched;e.chooseGeoemtryCache(this).forceDelete(t.geometry),e.createGeometryDelayed(this.entityOpContext),e.onVariableUpdate(!0),e.invalidateDownstreamBooleanData()}))}else"morphTargetInfluences"===t[1]&&s.updateMorphInfluences(t[2],n)}}return this.requestRender(),!0}deleteVariable(e){this.variables[e]&&delete this.variables[e]}getVariable(e,t){if(Array.isArray(e)){var n,i,r,s;if("mouse"===e[0])return null!==(n=null===(i=this.mouseProperty)||void 0===i?void 0:i[e[1]])&&void 0!==n?n:0;if("raycast"===e[0])return null!==(r=null===(s=this.raycastProperty)||void 0===s?void 0:s[e[1]])&&void 0!==r?r:0;let t=this.entityOpContext.scene.find(e[0]);if("width"===e[1]||"height"===e[1]||"depth"===e[1])return t.geometry.userData.parameters[e[1]];for(let n=1;n<e.length;n++)t=t[e[n]];return"rotation"===e[1]&&(t*=ov.RAD2DEG),t}for(let o in this.variables){var a;if(void 0===t)break;let e=this.variables[o],n=null===(a=e.locations)||void 0===a?void 0:a.findIndex((e=>OO.equal(e,t)));void 0!==n&&-1!==n&&e.locations.splice(n,1)}if("string"==typeof e){let n=e,i=e;do{if(i=n,void 0===this.variables[n])break;let e=this.variables[n].value;t&&void 0!==this.variables[i]&&this.variables[i].locations.push(t),n=e}while("string"==typeof n);return n}return e}getVariables(){return this.variables}getVariablesNames(){return this.data.variables.map((e=>e.data.name))}getVariableByName(e){for(let t of this.data.variables)if(t.data.name===e)return{variable:t.data,id:t.id}}getDynamicVariablePlayState(e){var t;return null===(t=this.variables[e])||void 0===t?void 0:t.dynamicVariablePlayState}setDynamicVariablePlayState(e,t){void 0!==this.variables[e]&&(this.variables[e].dynamicVariablePlayState=t)}getDynamicVariableToggleIsForward(e){var t;return null===(t=this.variables[e])||void 0===t?void 0:t.dynamicVariableToggleIsForward}setDynamicVariableToggleIsForward(e,t){void 0!==this.variables[e]&&(this.variables[e].dynamicVariableToggleIsForward=t)}resetLib(e){for(let[t,n]of Object.entries(e.images))this.addImage(t,n.asset);for(let[t,n]of Object.entries(e.audios))this.addAudio(t,n.asset);for(let[t,n]of Object.entries(e.particles))this.addParticle(t,n.asset);for(let[t,n]of Object.entries(e.colors))this.addColor(t,n.asset);for(let[t,n]of Object.entries(e.fonts))this.addFont(t,n.asset);for(let[t,n]of Object.entries(e.materials))this.addMaterial(t,n.asset);for(let[t,n]of Object.entries(e.videos))this.addVideo(t,n.asset);for(let[t,n]of Object.entries(e.variables))this.addVariableHolder(t,n.asset)}updateLibByOp(e,t){"images"===e.path[0]?1===e.path.length&&1===e.type?this.addImage(e.id,e.data.asset):1===e.path.length&&2===e.type&&this.deleteImage(e.id):"videos"===e.path[0]?1===e.path.length&&1===e.type?this.addVideo(e.id,e.data.asset):1===e.path.length&&2===e.type&&this.deleteVideo(e.id):"audios"===e.path[0]?1===e.path.length&&1===e.type?this.addAudio(e.id,e.data.asset):1===e.path.length&&2===e.type&&this.deleteAudio(e.id):"particles"===e.path[0]?1===e.path.length&&1===e.type?this.addParticle(e.id,e.data.asset):1===e.path.length&&2===e.type&&this.deleteParticle(e.id):"colors"===e.path[0]?1===e.path.length&&1===e.type?this.addColor(e.id,e.data.asset):1===e.path.length&&2===e.type&&this.deleteColor(e.id):"materials"===e.path[0]?1===e.path.length&&1===e.type?this.addMaterial(e.id,e.data.asset):1===e.path.length&&2===e.type&&this.deleteMaterial(e.id):"fonts"===e.path[0]?1===e.path.length&&1===e.type?this.addFont(e.id,e.data.asset):1===e.path.length&&2===e.type&&this.deleteFont(e.id):"variables"===e.path[0]?1===e.path.length&&1===e.type?this.addVariableHolder(e.id,e.data.asset):1===e.path.length&&2===e.type&&this.deleteVariable(e.id):"components"===e.path[0]&&t.updateByLibOp(e,this)}updateByOp(e,t,n){if(this.data=t,"images"===e.path[0])2===e.path.length&&0===e.type?e.props.data&&this.getImage(e.path[1]).updateSrc(e.props.data):1===e.path.length&&1===e.type?this.addImage(e.id,e.data):1===e.path.length&&2===e.type&&this.deleteImage(e.id);else if("videos"===e.path[0])2===e.path.length&&0===e.type?e.props.data&&this.getVideo(e.path[1]).updateSrc(e.props.data):1===e.path.length&&1===e.type?this.addVideo(e.id,e.data):1===e.path.length&&2===e.type&&this.deleteVideo(e.id);else if("audios"===e.path[0])2===e.path.length&&0===e.type?e.props.data&&this.addAudio(e.path[1],t.audios[e.path[1]]):1===e.path.length&&1===e.type?this.addAudio(e.id,e.data):1===e.path.length&&2===e.type&&this.deleteAudio(e.id);else if("particles"===e.path[0])2===e.path.length&&0===e.type?e.props.data&&this.addParticle(e.path[1],t.particles[e.path[1]]):1===e.path.length&&1===e.type?this.addParticle(e.id,e.data):1===e.path.length&&2===e.type&&this.deleteParticle(e.id);else if("colors"===e.path[0])2===e.path.length&&0===e.type?this.updateColor(e.path[1],e.props):1===e.path.length&&1===e.type?this.addColor(e.id,e.data):1===e.path.length&&2===e.type&&this.deleteColor(e.id);else if("materials"===e.path[0])1===e.path.length&&1===e.type?this.addMaterial(e.id,e.data):1===e.path.length&&2===e.type?this.deleteMaterial(e.id):e.path.length>1&&this.getMaterial(e.path[1]).updateByOp(uO.drop(e,2),t.materials[e.path[1]],{shared:this,scene:n});else if("fonts"===e.path[0])2===e.path.length&&0===e.type?this.updateFont(e.path[1],e,n):1===e.path.length&&1===e.type?this.addFont(e.id,e.data):1===e.path.length&&2===e.type&&this.deleteFont(e.id);else if("variables"===e.path[0])2===e.path.length&&0===e.type?"value"in e.props?this.updateVariable(e.path[1],e.props.value):"persistent"in e.props&&(this.variables[e.path[1]].persistent=e.props.persistent):1===e.path.length&&4===e.type?this.addVariableHolder(e.id,e.data):1===e.path.length&&5===e.type&&this.deleteVariable(e.id);else if("userAPIs"===e.path[0]){if(1===e.path.length&&1===e.type)this.addUserAPI(e.id,e.data);else if(1===e.path.length&&2===e.type)this.deleteUserAPI(e.id);else if("string"==typeof e.path[1]){let n=t.userAPIs[e.path[1]];if(n){let t=0===e.type&&void 0===e.props.debounce,i=this.getUserAPI(e.path[1]);i instanceof fq?i.update(n):null===i||void 0===i||i.update(n,this,t)}}}else if("userWebhooks"===e.path[0]){if(1===e.path.length&&1===e.type)this.addUserWebhook(e.id,e.data);else if(1===e.path.length&&2===e.type)this.deleteUserWebhook(e.id);else if("string"==typeof e.path[1]){var i;let n=t.userWebhooks[e.path[1]];n&&(null===(i=this.getUserWebhook(e.path[1]))||void 0===i||i.update(n))}}else"lib"===e.path[0]&&this.updateLibByOp(uO.drop(e,1),n)}updateFont(e,t,n){if(t.props.url){let i=this.getFont(e),r=d(d({},this.data.fonts[e]),{},{url:t.props.url});i.update(r),i.loadingPromise.then((()=>this.requestRender())),n.updateFont(e,this)}}addUserAPI(e,t){var n,i;return this.userAPIs[e]?(this.userAPIs[e].update(t,this),!0):(null===(n=this.openAIRealtime)||void 0===n?void 0:n.id)===e?(this.openAIRealtime.update(t),!0):"VoiceAssistant"===(null===(i=t.integration)||void 0===i?void 0:i.type)?(this.openAIRealtime=new fq(t,e,this),!1):(this.userAPIs[e]=new SU(e,t,this),!1)}getUserAPI(e){var t;return(null===(t=this.openAIRealtime)||void 0===t?void 0:t.id)===e?this.openAIRealtime:this.userAPIs[e]}getUserAPIs(){return this.userAPIs}deleteUserAPI(e){let t=this.userAPIs[e];t&&(t.dispose(),delete this.userAPIs[e])}addUserWebhook(e,t){return this.userWebhooks[e]?(this.userWebhooks[e].update(t),!0):(this.userWebhooks[e]=new WG(e,t),!1)}getUserWebhook(e){return this.userWebhooks[e]}getUserWebhooks(){return this.userWebhooks}deleteUserWebhook(e){let t=this.userWebhooks[e];t&&(t.dispose(),delete this.userWebhooks[e])}get scene(){return this.entityOpContext.scene}},yq=(new vq(mR.emptyData()),class extends FV{updateByPatchedOp(e,t,n){if(super.updateByPatchedOp(e,t,n),null!==function(e,t){let n=[];if(t.length!==e.length)return null;for(var i=0;i<e.length;){if("*"===t[i])n.push(e[i]);else if(e[i]!==t[i])return null;i+=1}return n}(e.path,["materials"])&&0===e.type&&Array.isArray(this.material))for(let[i,r]of Object.entries(e.props)){let e=n.shared.material(r);this.material[Number(i)]=e}else if(zO(e.path,["material"])&&this.material instanceof dG)"material"in t&&"string"!=typeof t.material&&this.material.updateByOp(uO.drop(e,1),t.material,n);else if(zO(e.path,["materials","*"])&&Array.isArray(this.material)){let i=e.path[1];if("materials"in t&&i<this.material.length){let r=t.materials[i];"string"!=typeof r&&this.material[i].updateByOp(uO.drop(e,2),r,n)}}}get needsAO(){return void 0!==this.material&&(Array.isArray(this.material)?this.material[0]:this.material).hasAO}updateState(e,t){var n,i;super.updateState(e,t),void 0!==e.castShadow&&(this.castShadow=e.castShadow),void 0!==e.receiveShadow&&(this.receiveShadow=e.receiveShadow);let r,s=this.dataPatched;if("Mesh"===this.dataPatched.type&&this.dataPatched.geometry.shapeBlendNode&&this.layers.set(9),"Mesh"===this.dataPatched.type&&"ShapeBlendGeometry"===this.dataPatched.geometry.type&&(r={resolutionLevel:this.dataPatched.geometry.resolutionLevel,useChildrenColors:this.dataPatched.geometry.useChildrenColors}),"NonParametricGeometry"!==(null===(n=e.geometry)||void 0===n?void 0:n.type)&&"material"in e&&void 0!==e.material&&(this.disposeMaterial(),this.material=t.shared.material(e.material).getFlavor(s.flatShading,s.side,s.wireframe,r),t.scene.markNeedsUpdateRendererDirty()),("NonParametricGeometry"===(null===(i=e.geometry)||void 0===i?void 0:i.type)||"materials"in e)&&("materials"in e&&void 0!==e.materials?(this.disposeMaterial(),this.material=e.materials.map((e=>t.shared.material(e).getFlavor(s.flatShading,s.side,s.wireframe))),t.scene.markNeedsUpdateRendererDirty()):"material"in e&&void 0!==e.material&&(this.disposeMaterial(),this.material=[t.shared.material(e.material).getFlavor(s.flatShading,s.side,s.wireframe)],t.scene.markNeedsUpdateRendererDirty())),void 0!==e.flatShading||void 0!==e.wireframe||void 0!==e.side)if(Array.isArray(this.material))for(let a=0;a<this.material.length;a++)this.material[a]=this.material[a].getFlavor(s.flatShading,s.side,s.wireframe);else this.material=this.material.getFlavor(s.flatShading,s.side,s.wireframe,r)}disposeMaterial(){this.material&&MF(this.material).forEach((e=>{e instanceof dG&&(e instanceof mG||e.nodeMaterialDispose())}))}dispose(){this.disposeMaterial(),super.dispose()}}),xq=new Lv,bq=new Ov,wq=new Ov,Dq=new Lv,_q=new py,Sq=class extends yq{constructor(e,t,n){super(e,t),this.data=t,this.isSkinnedMesh=!1,this.localGeometry=void 0,t.bindMode&&t.bindMatrix&&(this.bindMode=t.bindMode,this.bindMatrix=(new py).fromArray(t.bindMatrix),this.bindMatrixInverse=new py)}chooseGeoemtryCache(e){return e.geometryCache}markGeometryAsReachable(e){this.geometryCreateDeleyed instanceof dx&&this.chooseGeoemtryCache(e).markAsReachable(this.dataPatched.geometry,this.geometryCreateDeleyed)}get geometry(){if(void 0!==this.localGeometry)return this.localGeometry;if(this.geometryCreateDeleyed instanceof vq){let e=this.geometryCreateDeleyed,t=this.chooseGeoemtryCache(e);this.geometryCreateDeleyed=t.get(this.dataPatched.geometry,e,this)}return this.geometryCreateDeleyed}set geometry(e){this.localGeometry=e}get is2DAndNoDepth(){let e=this.dataPatched.geometry;return EB.is2DParametricMesh(e.type)&&0===e.depth}get is2DType(){return EB.is2DParametricMesh(this.geometry.userData.type)}get isNonParametric(){return"NonParametricGeometry"===this.geometry.userData.type}updateByPatchedOp(e,t,n){super.updateByPatchedOp(e,t,n),zO(e.path,["geometry"])&&this.updateByPatchedOpGeometry(uO.drop(e,1),t.geometry,n)}removeInteractionGeometry(e){var t;null!==(t=this.localGeometry)&&void 0!==t&&t.dispose(),this.localGeometry=void 0}updateGeometryInteractions(e,t){this.invalidateDownstreamBooleanData();let n=this.data.geometry.type;if("NonParametricGeometry"===n||"SubdivGeometry"===n){let n,i,r,s=e;if(void 0===this.localGeometry){let e=d(d({},this.data.geometry),s);this.localGeometry=qU(e,t,this.data.flatShading,this)}s.scaleBaked?[n,i,r]=s.scaleBaked:({width:n,height:i,depth:r}=s);let a=this.localGeometry.userData;void 0!==a.sxPrev&&XU(this.localGeometry.attributes,n/a.sxPrev,i/a.syPrev,r/a.szPrev),a.sxPrev=n,a.syPrev=i,a.szPrev=r}else{var i;let n=d(d({},this.data.geometry),e);null!==(i=this.localGeometry)&&void 0!==i&&i.dispose(),this.localGeometry=qU(n,t,this.data.flatShading,this)}}refreshAttachedClonersInteractions(){for(let e of this.attachedSurfaceCloners)e.update()}refreshAttachedCloners(e){for(let t of this.attachedSurfaceCloners)e.scene.addPendingUpdateCloner(t.object)}refreshAttachedPaths(e){for(let t of this.attachedPaths)e.scene.addPendingCommand((()=>t.updateShape()))}createGeometryDelayed(e){this.geometryCreateDeleyed=e.shared,this.refreshAttachedCloners(e),this.refreshAttachedPaths(e)}updateByPatchedOpGeometry(e,t,n){var i;let r=!1;0===e.type&&0===e.path.length&&Object.keys(e.props).includes("scaleBaked")&&this.geometryCreateDeleyed instanceof tV&&this.chooseGeoemtryCache(n.shared).mutateIfUnique(this.geometryCreateDeleyed.data,t)===this.geometryCreateDeleyed&&(r=!0,this.geometryCreateDeleyed.mutateDirectlyScaleBaked(t,e.props.scaleBaked),this.refreshAttachedCloners(n),this.refreshAttachedPaths(n)),r||(null!==(i=n.scene)&&void 0!==i&&i.markGeometryCacheDirty(),this.createGeometryDelayed(n)),this.resetBBoxNeedsUpdate(),this.invalidateDownstreamBooleanData()}updateGeometryOnStateUpdate(e,t){this.createGeometryDelayed(t)}updateState(e,t){void 0!==e.geometry&&this.updateGeometryOnStateUpdate(e.geometry,t);let n=e.morphTargetInfluences;if(n){this.updateMorphTargets(),this.geometry.morphTargetsRelative=!0;for(let{data:{name:e,value:i}}of n)this.updateMorphInfluences(e,t.shared.getVariable(i,[this.uuid,"morphTargetInfluences",e]))}super.updateState(e,t)}updateMorphInfluences(e,t){if(void 0===this.morphTargetDictionary)return;let n=this.morphTargetDictionary[e];void 0!==n&&(this.morphTargetInfluences[n]=t)}updateGeometryGroupsIfNeeded(){var e,t;Array.isArray(this.material)&&0===this.geometry.groups.length&&this.geometry.addGroup(0,Math.max(null!==(e=null===(t=this.geometry.getIndex())||void 0===t?void 0:t.count)&&void 0!==e?e:0,this.geometry.getAttribute("position").count),0)}updateEntityBoxSize(e,t){var n,i;let r=this.geometry.userData.parameters;this.is2DType?e.set(0,0,.5*r.depth):this.isNonParametric?(e.setScalar(0),this.geometry.boundingSphere&&e.copy(this.geometry.boundingSphere.center),t.set(r.width,r.height,null!==(n=r.depth)&&void 0!==n?n:0).multiplyScalar(.5)):r.centerOffset?e.fromArray(r.centerOffset):e.setScalar(0),t.set(r.width,r.height,null!==(i=r.depth)&&void 0!==i?i:0).multiplyScalar(.5)}updateMatrixWorld(e){super.updateMatrixWorld(e),"attached"===this.bindMode?this.bindMatrixInverse.copy(this.matrixWorld).invert():"detached"===this.bindMode&&this.bindMatrixInverse.copy(this.bindMatrix).invert()}bind(e,t){this.skeleton=e,this.isSkinnedMesh=!0,void 0===t&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.copy(t).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(e){let t=new Ov,n=this.geometry.attributes.skinWeight;for(let i=0,r=n.count;i<r;i++){t.fromBufferAttribute(n,i);let e=1/t.manhattanLength();e!==1/0?t.multiplyScalar(e):t.set(1,0,0,0),n.setXYZW(i,t.x,t.y,t.z,t.w)}}boneTransform(e,t){let n=this.skeleton;if(void 0===n)return;let i=this.geometry;bq.fromBufferAttribute(i.attributes.skinIndex,e),wq.fromBufferAttribute(i.attributes.skinWeight,e),xq.copy(t).applyMatrix4(this.bindMatrix),t.set(0,0,0);for(let r=0;r<4;r++){let e=wq.getComponent(r);if(0!==e){let i=bq.getComponent(r);_q.multiplyMatrices(n.bones[i].matrixWorld,n.boneInverses[i]),t.addScaledVector(Dq.copy(xq).applyMatrix4(_q),e)}}return t.applyMatrix4(this.bindMatrixInverse)}};function Eq(e){if(Array.isArray(e.material)){for(let t of e.material)if(0===t.getLayersOfType("outline").length)return}else if(!(e.material instanceof dG)||0===e.material.getLayersOfType("outline").length)return;e instanceof Sq&&e.is2DAndNoDepth?function(e){if(e.geometry.attributes.extrudeNormals||!e.geometry.attributes.position)return;let t=e.geometry.attributes.position.array,n=new Float32Array(t.length),i=new Lv;for(let r=0;r<t.length;r+=3)i.set(t[r],t[r+1],t[r+2]).normalize(),n[r]=i.x,n[r+1]=i.y,n[r+2]=i.z;e.geometry.setAttribute("extrudeNormal",new rx(n,3))}(e):function(e){if(e.geometry.attributes.extrudeNormal||!e.geometry.attributes.position||!e.geometry.attributes.normal)return;let t=new Map,n=e.geometry.attributes,i=n.position.array,r=n.normal.array,s=new Float32Array(i.length);for(let l=0;l<i.length;l+=3){var a;let e="".concat(i[l],"_").concat(i[l+1],"_").concat(i[l+2]),n=new Lv(r[l],r[l+1],r[l+2]);t.has(e)?null===(a=t.get(e))||void 0===a||a.normals.push(n):t.set(e,{normals:[n],result:new Lv})}t.forEach(((e,t)=>{for(let n of e.normals)e.result.add(n);e.result.divideScalar(e.normals.length)}));for(let l=0;l<i.length;l+=3){var o;let e="".concat(i[l],"_").concat(i[l+1],"_").concat(i[l+2]),n=null===(o=t.get(e))||void 0===o?void 0:o.result;n&&(s[l]=n.x,s[l+1]=n.y,s[l+2]=n.z)}e.geometry.setAttribute("extrudeNormal",new rx(s,3))}(e)}function Cq(e){if(!e.geometry.attributes.position)return;let t=e.geometry.attributes.position.array,n=new Float32Array(t.length),i=parseInt(e.uuid.replace(/\D/g,"")),r=[ov.seededRandom(i),ov.seededRandom(i+1e4),ov.seededRandom(i+2e4)];for(let s=0;s<t.length;s++)n[s]=r[s%3];e.geometry.setAttribute("randomColor",new tx(n,3))}var Aq=new jv,Mq=new Lv;function Tq(e){let t=!1;return e.scene.objects.traverse(((e,n)=>{"Mesh"===n.type&&"SubdivGeometry"===n.geometry.type&&(t=!0)})),t}var Pq=class extends Sq{constructor(e,t,n){super(e,t,n),this.data=t,this.hiddenMatrixOld=new py,this.smoothShading=!0,this.skipReactionUpdate=!1}chooseGeoemtryCache(e){return this.dataPatched.flatShading?e.geometryCache:e.geometryCache2}get subdivPointerNew(){return void 0!==this.localGeometry?this.subdivPointer:this.geometry.ensureSubdivPointer()}get originalGeometryNew(){return void 0!==this.localGeometry?this.originalGeometry:this.geometry.originalGeometry}get phongAngle(){var e;return null!==(e=this.data.geometry.phongAngle)&&void 0!==e?e:45}updateEntityBoxSize(e,t){var n;let i=this.geometry.userData.parameters;e.copy(this.originalGeometryNew.boundingSphere.center),t.set(i.width,i.height,null!==(n=i.depth)&&void 0!==n?n:0).multiplyScalar(.5)}createGeometryByControls(e){var t,n,i,r;if(!0===this.skipReactionUpdate)return;let s=null===(t=this.localGeometry)||void 0===t?void 0:t.uuid,{originalGeometry:a,subdividedGeometry:o,subdivPointer:l}=tV.build(e,this.subdivPointer,this.smoothShading,this.hasNonUniformScale?this.shearScale:void 0);this.subdivPointer=l,void 0!==a&&(null!==(n=this.originalGeometry)&&void 0!==n&&n.dispose(),this.originalGeometry=a),void 0!==o&&(null!==(i=this.subdividedGeometry)&&void 0!==i&&i.dispose(),this.subdividedGeometry=null!==o&&void 0!==o?o:void 0),this.localGeometry=null!==(r=this.subdividedGeometry)&&void 0!==r?r:this.originalGeometry,Eq(this),Cq(this),this.calcBoundingBox(),s&&(this.localGeometry.uuid=s)}updateState(e,t){if(super.updateState(e,t),void 0!==e.flatShading){let n=this.material;this.material=Array.isArray(n)?n.map((e=>e.getFlavor(!1,e.side,e.wireframe))):n.getFlavor(!1,n.side,n.wireframe),this.smoothShading=!e.flatShading,this.createGeometryDelayed(t)}}updateMesh(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];tV.buildLevel(this.subdivPointer,!0,this.smoothShading?this.phongAngle:-1,this.originalGeometry,e&&this.hasNonUniformScale?this.shearScaleInv:void 0),this.subdividedGeometry&&tV.buildLevel(this.subdivPointer,!1,this.smoothShading?this.phongAngle:-1,this.subdividedGeometry,e&&this.hasNonUniformScale?this.shearScaleInv:void 0)}updateTopology(){var e;this.originalGeometry.dispose(),this.originalGeometry=tV.buildLevel(this.subdivPointer,!0,this.smoothShading?this.phongAngle:-1),this.subdividedGeometry&&(this.subdividedGeometry.dispose(),this.subdividedGeometry=tV.buildLevel(this.subdivPointer,!1,this.smoothShading?this.phongAngle:-1)),this.localGeometry=null!==(e=this.subdividedGeometry)&&void 0!==e?e:this.originalGeometry}raycast(e,t){let n=this.localGeometry;this.localGeometry=this.originalGeometryNew,FV.prototype.raycast.call(this,e,t),this.localGeometry=n}activateSVDCompensation(){!this.hasNonUniformScale||(this.matrix.copy(this.matrixWorldRigid),this.hiddenMatrixOld.copy(this.hiddenMatrix),this.hiddenMatrix.copy(this.parent.matrixWorld).invert())}deactivateSVDCompensation(){!this.hasNonUniformScale||(this.updateMatrix(),this.hasNonUniformScale=void 0,this.hiddenMatrix.copy(this.hiddenMatrixOld))}calcBoundingBox(){let e=this.originalGeometry;null===e.boundingSphere&&(e.boundingSphere=new ry,this.subdividedGeometry&&(this.subdividedGeometry.boundingSphere=e.boundingSphere));let t=e.attributes.position,n=e.boundingSphere.center;Aq.setFromBufferAttribute(t),Aq.getCenter(n),e.boundingSphere.radius=n.distanceTo(Aq.max),isNaN(e.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this),Aq.getSize(Mq),this.hasNonUniformScale&&Mq.divide(this.scale);let i={width:Mq.x,height:Mq.y,depth:Mq.z};return this.geometry.userData.parameters=i,i}updateBoundingSphere(e){let t=this.originalGeometry;Aq.min.set(e[0],e[2],e[4]),Aq.max.set(e[1],e[3],e[5]),this.hasNonUniformScale&&(Aq.min.applyMatrix4(this.shearScaleInv),Aq.max.applyMatrix4(this.shearScaleInv)),null===t.boundingSphere&&(t.boundingSphere=new ry);let n=t.boundingSphere.center;Aq.getCenter(n),t.boundingSphere.radius=n.distanceTo(Aq.max)}freeSubdivPointer(){var e,t;this.subdivPointer&&(tV.freeSubdivPointer(this.subdivPointer),this.subdivPointer=0),this.localGeometry=void 0,null!==(e=this.originalGeometry)&&void 0!==e&&e.dispose(),null===(t=this.subdividedGeometry)||void 0===t||t.dispose()}dispose(){super.dispose(),this.freeSubdivPointer()}updateByPatchedOpGeometry(e,t,n){super.updateByPatchedOpGeometry(e,t,n),this.localGeometry&&this.createGeometryByControls(t)}},Fq={x:[1,0,0],"-x":[-1,0,0],y:[0,1,0],"-y":[0,-1,0],z:[0,0,1],"-z":[0,0,-1]},Oq={polygon_center:0,edge:1,vertex:2},Iq=(e,t)=>(n,i)=>t&&0!==n&&0!==e?e*i/100:0,kq=(e,t)=>{let n=Math.abs(t),i=-1*n;return(e- -1)*(n-i)/2+i},Bq=new Lv,Rq=new Lv,Lq=new Lv,zq=new Lv;function Nq(e,t){let n=Lq.fromArray(e),i=zq.fromArray(t);Rq.copy(i).sub(n);let r=Rq.length();return Rq.normalize().multiplyScalar(.5*r),Bq.copy(n).add(Rq).toArray()}var jq=new Qy,Uq=new Lv,Vq=new Lv,Hq=new Lv;var Wq=e=>.5*(1-Math.cos(e*Math.PI)),Gq=class{constructor(){this.perlin=new Array(4096)}noise(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(null==this.perlin){this.perlin=new Array(4096);for(let e=0;e<4096;e++)this.perlin[e]=Math.random()}e<0&&(e=-e),t<0&&(t=-t),n<0&&(n=-n);let i,r,s,a,o,l=Math.floor(e),u=Math.floor(t),c=Math.floor(n),h=e-l,d=t-u,p=n-c,f=0,m=.5;for(let g=0;g<4;g++){let e=l+(u<<4)+(c<<8);i=Wq(h),r=Wq(d),s=this.perlin[4095&e],s+=i*(this.perlin[e+1&4095]-s),a=this.perlin[e+16&4095],a+=i*(this.perlin[e+16+1&4095]-a),s+=r*(a-s),e+=256,a=this.perlin[4095&e],a+=i*(this.perlin[e+1&4095]-a),o=this.perlin[e+16&4095],o+=i*(this.perlin[e+16+1&4095]-o),a+=r*(o-a),s+=Wq(p)*(a-s),f+=s*m,m*=.5,l<<=1,h*=2,u<<=1,d*=2,c<<=1,p*=2,h>=1&&(l++,h--),d>=1&&(u++,d--),p>=1&&(c++,p--)}return f}noiseSeed(e){let t=(()=>{let e,t;return{setSeed(n){t=e=(null!==n&&void 0!==n?n:4294967296*Math.random())>>>0},getSeed:()=>e,rand:()=>(t=(1664525*t+1013904223)%4294967296,t/4294967296)}})();t.setSeed(e),this.perlin=new Array(4096);for(let n=0;n<4096;n++)this.perlin[n]=t.rand()}},qq=new Lv,Yq=new py,Xq=new dy;function Qq(e){let t=!1;return e.scene.objects.traverse(((e,n)=>{"Mesh"===n.type&&("TextGeometry"===n.geometry.type||"InputGeometry"===n.geometry.type)&&(t=!0)})),t}var Kq,Zq,Jq,$q,eY=class extends Sq{constructor(e,t,n){super(e,t,n),this.data=t}get textGeometry(){return this.geometry}get charWidths(){return this.textGeometry.charWidths}get charCoords(){return this.textGeometry.charCoords}get wrappedText(){return this.textGeometry.wrappedText}get font(){return this.textGeometry.font}get initialOffsetY(){var e,t;let n=this.dataPatched;return null!==(e=null===(t=this.font)||void 0===t?void 0:t.getLineInitialOffsetY(this.lineHeight,this.wrappedText.length,n.geometry.height,this.fontScale,n.geometry.verticalAlign))&&void 0!==e?e:0}get fontScale(){let e=this.dataPatched;return this.font?e.geometry.fontSize/this.font.unitsPerEm:1}get AD(){return Math.abs(this.ascender-this.descender)}get ascender(){var e,t;return(null!==(e=null===(t=this.font)||void 0===t?void 0:t.ascender)&&void 0!==e?e:1)*this.fontScale}get descender(){var e,t;return(null!==(e=null===(t=this.font)||void 0===t?void 0:t.descender)&&void 0!==e?e:1)*this.fontScale}get lineHeight(){let e=this.dataPatched;return e.geometry.fontSize*e.geometry.lineHeight}raycast(e,t){let{matrixWorld:n}=this;if(!isNaN(e.ray.origin.x)&&0!==this.scale.x&&0!==this.scale.y&&0!==this.scale.z&&(Yq.copy(n).invert(),Xq.copy(e.ray).applyMatrix4(Yq),Xq.intersectBox(this.singleBBox,qq))){let i=qq.applyMatrix4(n),r=e.ray.origin.distanceTo(i);t.push({distance:r,point:i.clone(),object:this})}}},tY=1e-4,nY=new Lv,iY=new Lv;VU.then((e=>{Zq=[(Kq=e).get_face_center,Kq.get_edge_midpoint,Kq.get_vertex_position],Jq=[Kq.get_face_normal,Kq.get_edge_normal,Kq.get_vertex_normal],$q=[Kq.face_count,Kq.edge_count,Kq.vertex_count]}));var rY=new py,sY=new py,aY=new Lv,oY=new Lv,lY=new Lv,uY=new Lv,cY=new Lv,hY=new Lv,dY=class{constructor(e,t){this.data=e,this.is3D=t,this.perlin=new Gq,"perlin"===e.noiseType?(this.perlin.noiseSeed(e.seed),this.noise=t?(e,t,n)=>this.perlin.noise(e,t,n):e=>this.perlin.noise(e)):this.noise=t?function(){let e=Fz(arguments.length>0&&void 0!==arguments[0]?arguments[0]:Math.random),t=new Float64Array(e).map((e=>Pz[e%12*3])),n=new Float64Array(e).map((e=>Pz[e%12*3+1])),i=new Float64Array(e).map((e=>Pz[e%12*3+2]));return function(r,s,a){let o,l,u,c,h,d,p,f,m,g,v=(r+s+a)*Cz,y=Mz(r+v),x=Mz(s+v),b=Mz(a+v),w=(y+x+b)*Az,D=r-(y-w),_=s-(x-w),S=a-(b-w);D>=_?_>=S?(h=1,d=0,p=0,f=1,m=1,g=0):D>=S?(h=1,d=0,p=0,f=1,m=0,g=1):(h=0,d=0,p=1,f=1,m=0,g=1):_<S?(h=0,d=0,p=1,f=0,m=1,g=1):D<S?(h=0,d=1,p=0,f=0,m=1,g=1):(h=0,d=1,p=0,f=1,m=1,g=0);let E=D-h+Az,C=_-d+Az,A=S-p+Az,M=D-f+2*Az,T=_-m+2*Az,P=S-g+2*Az,F=D-1+.5,O=_-1+.5,I=S-1+.5,k=255&y,B=255&x,R=255&b,L=.6-D*D-_*_-S*S;if(L<0)o=0;else{let r=k+e[B+e[R]];L*=L,o=L*L*(t[r]*D+n[r]*_+i[r]*S)}let z=.6-E*E-C*C-A*A;if(z<0)l=0;else{let r=k+h+e[B+d+e[R+p]];z*=z,l=z*z*(t[r]*E+n[r]*C+i[r]*A)}let N=.6-M*M-T*T-P*P;if(N<0)u=0;else{let r=k+f+e[B+m+e[R+g]];N*=N,u=N*N*(t[r]*M+n[r]*T+i[r]*P)}let j=.6-F*F-O*O-I*I;if(j<0)c=0;else{let r=k+1+e[B+1+e[R+1]];j*=j,c=j*j*(t[r]*F+n[r]*O+i[r]*I)}return 32*(o+l+u+c)}}((0,_z.default)(e.seed)):function(){let e=Fz(arguments.length>0&&void 0!==arguments[0]?arguments[0]:Math.random),t=new Float64Array(e).map((e=>Tz[e%12*2])),n=new Float64Array(e).map((e=>Tz[e%12*2+1]));return function(i,r){let s,a,o=0,l=0,u=0,c=(i+r)*Sz,h=Mz(i+c),d=Mz(r+c),p=(h+d)*Ez,f=i-(h-p),m=r-(d-p);f>m?(s=1,a=0):(s=0,a=1);let g=f-s+Ez,v=m-a+Ez,y=f-1+2*Ez,x=m-1+2*Ez,b=255&h,w=255&d,D=.5-f*f-m*m;if(D>=0){let i=b+e[w];D*=D,o=D*D*(t[i]*f+n[i]*m)}let _=.5-g*g-v*v;if(_>=0){let i=b+s+e[w+a];_*=_,l=_*_*(t[i]*g+n[i]*v)}let S=.5-y*y-x*x;if(S>=0){let i=b+1+e[w+1];S*=S,u=S*S*(t[i]*y+n[i]*x)}return 70*(o+l+u)}}((0,_z.default)(e.seed))}},pY=class extends(jz(zy)){constructor(e,t){super(),this.parameters=t,this.objectForSample=void 0,this._pendingMediaLoad=!1,this.random=null,this.object=e}resetOnMove(){this.removeFromParent(),this.parent=null}expandClones(e){if(null===this.parent)this.updateState(this.parameters,e);else for(let t of this.children)t instanceof Vz&&t.expand()}invalidateTransform(e){this.matrixWorldNeedsUpdate=!0,this.traverse((t=>{t instanceof Vz&&t.object===e&&(t.matrixWorldNeedsUpdate=!0)}))}onObjUpdateMatrix(){"toObject"!==this.parameters.type&&(this.matrixWorldNeedsUpdate=!0)}update(){switch(this._updateCount(),this.parameters.type){case"radial":this._updateRadial(this.parameters);break;case"linear":this._updateLinear(this.parameters);break;case"grid":this._updateGrid(this.parameters);break;case"toObject":this._updateToObject(this.parameters)}for(let e of this.children)e.updateMatrix(),e.hasNonUniformScale&&(e.updateMatrixWorld(),e.updateMatrixWorldSVD())}_updateCount(e){let t;if(t=void 0!==e?e:"grid"===this.parameters.type?Math.round(this.parameters.grid.count[0])*Math.round(this.parameters.grid.count[1])*Math.round(this.parameters.grid.count[2]):this.parameters.count,"toObject"===this.parameters.type)if(this.parameters.toObject.object){if(void 0===e&&"random"!==this.parameters.toObject.spreadType)return}else t=0;if("toObject"===this.parameters.type&&this.objectForSample){let e=this.children;if(e.length===t)return;if(e.length<t)for(let n=0,i=t-e.length;n<i;++n){let e=new Vz(this.object);e.expand(),this.add(e)}else for(let n=0,i=e.length-t;n<i;++n)this.remove(e[n])}else{if(this.children.length===t)return;if(this.children.length<t)for(let e=0,n=t-this.children.length;e<n;++e){let e=new Vz(this.object);e.expand(),this.add(e)}else for(let e=0,n=this.children.length-t;e<n;++e)this.remove(this.children[e])}}getRandom(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return(null===this.random||this.random.data.seed!==e.seed||this.random.is3D!==t)&&(this.random=new dY(e,t)),this.random}_updateRadial(e){var t;let n,i=e.radial,r=i.start*ov.DEG2RAD,s=r-i.end*ov.DEG2RAD,a=new _y(i.rotation[0],i.rotation[1],i.rotation[2]);switch(i.axis){case"z":n=new Lv(0,0,1);break;case"y":n=new Lv(0,1,0);break;default:n=new Lv(1,0,0)}let o=null!==(t=e.randomnessObject)&&void 0!==t?t:Xk.defaultData([1,1,1]).randomnessObject,l=this.getRandom(o),u=Iq(o.strength,this.parameters.randomness);for(let[c,h]of this.children.entries()){let t=c*(o.freqScale/10)+o.movement,d=l.noise(t,t,t),p=c+1;h.scale.x=i.scale[0]+u(p,kq(d,o.scale[0]))||tY,h.scale.y=i.scale[1]+u(p,kq(d,o.scale[1]))||tY,h.scale.z=i.scale[2]+u(p,kq(d,o.scale[2]))||tY,h.position.setScalar(0);let f=s/e.count*c-r;switch(i.axis){case"x":h.rotation.set(0,f,0);break;case"y":h.rotation.set(0,0,f);break;case"z":h.rotation.set(f,0,0)}h.translateOnAxis(n,i.radius),h.position.x+=i.position[0]+u(p,kq(d,o.position[0])),h.position.y+=i.position[1]+u(p,kq(d,o.position[1])),h.position.z+=i.position[2]+u(p,kq(d,o.position[2]));let m=u(p,kq(d,o.rotation[0])),g=u(p,kq(d,o.rotation[1])),v=u(p,kq(d,o.rotation[2]));!0===i.alignment?(h.rotation.x+=a.x+m,h.rotation.y+=a.y+g,h.rotation.z+=a.z+v):h.rotation.set(a.x+m,a.y+g,a.z+v)}}_updateLinear(e){var t;if("linear"!==e.type)throw new Error;let n=e.linear,i=new _y(n.rotation[0],n.rotation[1],n.rotation[2]),r=null!==(t=e.randomnessObject)&&void 0!==t?t:Xk.defaultData([1,1,1]).randomnessObject,s=this.getRandom(r),a=Iq(r.strength,this.parameters.randomness);for(let[o,l]of this.children.entries()){let e=o*(r.freqScale/10)+r.movement,t=s.noise(e,e,e),u=o+1,c=a(u,kq(t,r.rotation[0])),h=a(u,kq(t,r.rotation[1])),d=a(u,kq(t,r.rotation[2]));l.scale.x=1+(n.scale[0]-1)*o+a(u,kq(t,r.scale[0]))||tY,l.scale.y=1+(n.scale[1]-1)*o+a(u,kq(t,r.scale[1]))||tY,l.scale.z=1+(n.scale[2]-1)*o+a(u,kq(t,r.scale[2]))||tY,l.rotation.x=i.x*o+c,l.rotation.y=i.y*o+h,l.rotation.z=i.z*o+d,l.position.x=n.position[0]*o+a(u,kq(t,r.position[0])),l.position.y=n.position[1]*o+a(u,kq(t,r.position[1])),l.position.z=n.position[2]*o+a(u,kq(t,r.position[2]))}}_updateGrid(e){var t;let n=0,i=e.grid,r=null!==(t=e.randomnessObject)&&void 0!==t?t:Xk.defaultData([1,1,1]).randomnessObject,s=this.getRandom(r,!0),a=Iq(r.strength,this.parameters.randomness);if(!0===i.useCenter){let e={x:i.count[0]%2===0?2:1,y:i.count[1]%2===0?2:1,z:i.count[2]%2===0?2:1},t=new Lv(i.size[0]*(i.count[0]-e.x)*.5,i.size[1]*(i.count[1]-e.y)*.5,i.size[2]*(i.count[2]-e.z)*.5);for(let o=0;o<i.count[0];o++)for(let e=0;e<i.count[1];e++)for(let l=0;l<i.count[2];l++){let u=s.noise((o+1)*(r.freqScale/10)+r.movement,(e+1)*(r.freqScale/10)+r.movement,(l+1)*(r.freqScale/10)+r.movement),c=this.children[n++];c.scale.x=1+a(n,kq(u,r.scale[0]))||tY,c.scale.y=1+a(n,kq(u,r.scale[1]))||tY,c.scale.z=1+a(n,kq(u,r.scale[2]))||tY;let h=a(n,kq(u,r.rotation[0])),d=a(n,kq(u,r.rotation[1])),p=a(n,kq(u,r.rotation[2]));c.rotation.set(h,d,p),c.position.x=i.size[0]*o-t.x+a(n,kq(u,r.position[0])),c.position.y=i.size[1]*e-t.y+a(n,kq(u,r.position[1])),c.position.z=i.size[2]*l-t.z+a(n,kq(u,r.position[2]))}}else for(let o=0;o<i.count[0];o++)for(let e=0;e<i.count[1];e++)for(let t=0;t<i.count[2];t++){let l=s.noise((o+1)*(r.freqScale/10)+r.movement,(e+1)*(r.freqScale/10)+r.movement,(t+1)*(r.freqScale/10)+r.movement),u=this.children[n++];u.scale.x=1+a(n,kq(l,r.scale[0]))||tY,u.scale.y=1+a(n,kq(l,r.scale[1]))||tY,u.scale.z=1+a(n,kq(l,r.scale[2]))||tY;let c=a(n,kq(l,r.rotation[0])),h=a(n,kq(l,r.rotation[1])),d=a(n,kq(l,r.rotation[2]));u.rotation.set(c,h,d),u.position.x=i.size[0]*o+a(n,kq(l,r.position[0])),u.position.y=-i.size[1]*e+a(n,kq(l,r.position[1])),u.position.z=-i.size[2]*t+a(n,kq(l,r.position[2]))}}_updateToObject(e){var t,n;if("toObject"!==e.type)throw new Error;let{toObject:i}=e,r=new _y(i.rotation[0],i.rotation[1],i.rotation[2]),s=null!==(t=e.randomnessObject)&&void 0!==t?t:Xk.defaultData([1,1,1]).randomnessObject,a=this.getRandom(s),o=Iq(s.strength,this.parameters.randomness);if(!i.object){for(let[,e]of this.children.entries())e.position.set(0,0,0),e.scale.setScalar(1),e.rotation.set(0,0,0);return void(this.objectForSample=void 0)}if(!this.objectForSample)return;if(this.objectForSample instanceof eY){if(null===(n=this.objectForSample.font)||void 0===n||!n.isLoaded||void 0===this.objectForSample.geometry.attributes.position)return void(this._pendingMediaLoad=!0);this._pendingMediaLoad=!1}if(void 0===this.objectForSample.geometry&&this.objectForSample.isAncestorOf(this.object.uuid))return void console.warn('Oh no! The object "'.concat(this.object.name,'" (').concat(this.object.uuid,") seem to be a child/descendant of the object it's being cloned to. Please re-parent it so that they are siblings instead."));let l=this.getSubdivData();if(l.length>0){let e=Math.round(l.length*i.count/100);this._updateCount(e)}else{let e=this.objectForSample.geometry.getAttribute("position");if(!e||isNaN(e.count)||0===e.count)return void console.warn('Oh no! The object "'.concat(this.object.name,'" (').concat(this.object.uuid,') cannot be cloned on the surface of "').concat(this.objectForSample.name,'" (').concat(this.objectForSample.uuid,") because the latter does not have a valid geometry."))}this.objectForSample.updateMatrixWorld();let u=new kz(this.objectForSample).build(),c=Fq[i.axis],h=this.children;u.setRandomGenerator((0,_z.default)(this.object.uuid+i.seed));for(let[d,p]of h.entries()){let e=d*(s.freqScale/10)+s.movement,t=a.noise(e,e,e),n=d+1,h=o(n,kq(t,s.rotation[0])),f=o(n,kq(t,s.rotation[1])),m=o(n,kq(t,s.rotation[2]));"random"===i.spreadType?u.sample(lY,uY):(l.length&&(lY.fromArray(l[d].pos),uY.fromArray(l[d].norm)),this.objectForSample instanceof Pq&&lY.applyMatrix4(rY.copy(this.objectForSample.matrixWorld).invert())),lY.applyMatrix4(this.object.hiddenMatrix.clone().invert()),p.position.copy(lY),aY.fromArray(c);let g="normal"===i.align?uY:this.object.getWorldDirection(hY),v=oY.fromArray(i.position);oY.x+=o(n,kq(t,s.position[0])),oY.y+=o(n,kq(t,s.position[1])),oY.z+=o(n,kq(t,s.position[2]));let y=Math.acos(g.dot(aY)),x=cY.crossVectors(aY,g).normalize(),b=sY.makeRotationAxis(x,y),w=g.clone().cross(this.object.up).normalize(),D=w.clone().cross(g).normalize(),_=(new py).makeBasis(w,g,D),S=new Lv(aY.y,aY.z,aY.x).normalize(),E=S.clone().cross(aY).normalize(),C=(new py).makeBasis(S,aY,E).invert(),A=(new py).multiplyMatrices(_,C);p.rotation.setFromRotationMatrix(A),v.applyMatrix4(b),p.position.add(v),p.rotation.x=p.rotation.x+r.x+h,p.rotation.y=p.rotation.y+r.y+f,p.rotation.z=p.rotation.z+r.z+m,p.scale.setScalar(1),p.scale.x=p.scale.x+i.scale[0]+o(n,kq(t,s.scale[0]))||tY,p.scale.y=p.scale.y+i.scale[1]+o(n,kq(t,s.scale[1]))||tY,p.scale.z=p.scale.z+i.scale[2]+o(n,kq(t,s.scale[2]))||tY,p.scale.multiply(this.object.scale),p.hiddenMatrix=this.object.hiddenMatrix}}getSubdivData(){if(!this.objectForSample)return[];let e=this.parameters.toObject.spreadType,t=new Map,n=(e,n)=>{let i=Math.round(1e4*e[0])+"_"+Math.round(1e4*e[1])+"_"+Math.round(1e4*e[2]),r=t.get(i);r?(r.pos[0]+=e[0],r.pos[1]+=e[1],r.pos[2]+=e[2],r.norm[0]+=n[0],r.norm[1]+=n[1],r.norm[2]+=n[2],r.count+=1):t.set(i,{pos:[...e],norm:[...n],count:1})};if("random"===e)return[];if(this.objectForSample instanceof Pq){let t=this.objectForSample,i=Oq[e],r=$q[i],s=Zq[i],a=Jq[i],o=r(t.subdivPointerNew);for(let e=0;e<=o-1;e++){let i=s(t.subdivPointerNew,e),r=a(t.subdivPointerNew,e);nY.fromArray(i).applyMatrix4(t.matrixWorld),iY.fromArray(r),n(nY.toArray(),iY.toArray())}}else(this.objectForSample.geometry.index?function(e){let t=[];for(let n=0;n<=e.index.count;n++)if(Uq.fromArray(e.index.array,3*n),jq.setFromAttributeAndIndices(e.attributes.position,Uq.x,Uq.y,Uq.z),jq.getNormal(Vq),jq.getMidpoint(Hq),!(isNaN(Hq.x)||isNaN(Hq.y)||isNaN(Hq.z))){let{a:e,b:n,c:i}=jq,r=e.toArray(),s=n.toArray(),a=i.toArray(),o=e.distanceTo(n),l=n.distanceTo(i),u=i.distanceTo(e),c=Nq(r,s),h=Nq(s,a),d=Nq(a,r),p=[o,l,u],f=Math.max(...p),m=p.filter((e=>Math.round(e)===Math.round(f))).length>1,g=[],v=jq.getMidpoint(Hq).toArray();f===o&&!m&&(g=[h,d,d],v=c),f===l&&!m&&(g=[c,d,d],v=h),f===u&&!m&&(g=[c,h,h],v=d),m&&(g=[c,h,d]),t.push({vertices:[r,s,a],faceCenters:g,midpoint:v,norm:jq.getNormal(Vq).toArray()})}return t}(this.objectForSample.geometry):function(e){let t=[],{position:n}=e.attributes;for(let i=0;i<n.count;i++){jq.setFromAttributeAndIndices(n,3*i,3*i+1,3*i+2),jq.getNormal(Vq),jq.getMidpoint(Hq);let e=jq.a.toArray(),r=jq.b.toArray(),s=jq.c.toArray();t.push({vertices:[e,r,s],faceCenters:[Nq(e,r),Nq(r,s),Nq(s,e)],midpoint:Hq.toArray(),norm:Vq.toArray()})}return t}(this.objectForSample.geometry)).forEach(((t,i)=>{"polygon_center"===e&&n(t.midpoint,t.norm),"vertex"===e&&(n(t.vertices[0],t.norm),n(t.vertices[1],t.norm),n(t.vertices[2],t.norm)),"edge"===e&&(n(t.faceCenters[0],t.norm),n(t.faceCenters[1],t.norm),n(t.faceCenters[2],t.norm))}));let i=Array.from(t.values());for(let r of i)r.pos[0]/=r.count,r.pos[1]/=r.count,r.pos[2]/=r.count,r.norm[0]/=r.count,r.norm[1]/=r.count,r.norm[2]/=r.count;return i}updateState(e,t){var n;if(this.parameters=PP(e),"toObject"!==this.parameters.type)(null===this.parent||this.parent!==this.object)&&(this.removeFromParent(),null!==(n=this.object.parent)&&void 0!==n&&n.add(this),this.matrix=this.object.matrix,this.hiddenMatrix=this.object.hiddenMatrix,this.matrixWorldNeedsUpdate=!0,this.matrixAutoUpdate=!1);else if(null===this.parent||this.parent.uuid!==this.parameters.toObject.object){this.removeFromParent();let e=t.find(this.parameters.toObject.object);this.objectForSample=e instanceof FV?e:void 0,this.matrix=new py,this.hiddenMatrix=new py,this.matrixWorldNeedsUpdate=!0,this.matrixAutoUpdate=!1,e&&e.add(this)}this.update()}get pendingMediaLoad(){return this._pendingMediaLoad}},fY=e=>{var t;return(t=class extends e{}).geometryHelper=new Mx(30,30,30),t},mY=new dy,gY=new ry,vY=new py,yY=function(e,t,n,i){let r=arguments.length>4&&void 0!==arguments[4]&&arguments[4],s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:e,a=t,o=s.matrixWorld;if(null===a.boundingSphere&&a.computeBoundingSphere(),gY.copy(a.boundingSphere),gY.applyMatrix4(o),!1===n.ray.intersectsSphere(gY)||(vY.copy(o).invert(),mY.copy(n.ray).applyMatrix4(vY),null!==a.boundingBox&&!1===mY.intersectsBox(a.boundingBox)))return;let l,u,c,h,d,p,f=a.index,m=a.attributes.position,g=a.drawRange;if(!1===r){for(d=Math.max(0,g.start),p=Math.min(f.count,g.start+g.count);d<p;d+=3)if(u=f.getX(d),c=f.getX(d+1),h=f.getX(d+2),l=v(e,n,mY,m,u,c,h),l)return l.faceIndex=Math.floor(d/3),void i.push(l)}else{let t=a.attributes.position,r=new Lv,o=new Lv,l=new Lv,u=new Lv,c=2,h=1/((s.scale.x+s.scale.y+s.scale.z)/3),d=h*h;for(let a=Math.max(0,g.start),p=Math.min(t.count,g.start+g.count)-1;a<p;a+=c){if(r.fromBufferAttribute(t,a),o.fromBufferAttribute(t,a+1),mY.distanceSqToSegment(r,o,u,l)>d)continue;u.applyMatrix4(s.matrixWorld);let c=n.ray.origin.distanceTo(u);c<n.near||c>n.far||i.push({distance:c,point:l.clone().applyMatrix4(s.matrixWorld),object:e})}}function v(e,t,n,i,r,s,a){let o=new Lv,l=new Lv,u=new Lv,c=new Lv,h=new Lv;if(o.fromBufferAttribute(i,r),l.fromBufferAttribute(i,s),u.fromBufferAttribute(i,a),null===n.intersectTriangle(o,l,u,!1,c))return null;h.copy(c),h.applyMatrix4(e.matrixWorld);let d=t.ray.origin.distanceTo(h);return d<t.near||d>t.far?null:{faceIndex:1,distance:d,point:h.clone(),object:e}}},xY=new Lv,bY=new kx,wY=class extends ZD{constructor(e){let t=new dx,n=new VD({color:16777215,vertexColors:!0,toneMapped:!1}),i=[],r=[],s={},a=new Ev(15711266),o=new Ev(15711266),l=new Ev(2857471);function u(e,t,n){c(e,n),c(t,n)}function c(e,t){i.push(0,0,0),r.push(t.r,t.g,t.b),void 0===s[e]&&(s[e]=[]),s[e].push(i.length/3-1)}u("n1","n2",a),u("n2","n4",a),u("n4","n3",a),u("n3","n1",a),u("f1","f2",a),u("f2","f4",a),u("f4","f3",a),u("f3","f1",a),u("n1","f1",a),u("n2","f2",a),u("n3","f3",a),u("n4","f4",a),u("p","n1",o),u("p","n2",o),u("p","n3",o),u("p","n4",o),u("u1","u2",l),u("u2","u3",l),u("u3","u1",l),t.setAttribute("position",new rx(i,3)),t.setAttribute("color",new rx(r,3)),super(t,n),this.type="CameraHelper",this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=s,this.update()}update(){let e=this.geometry,t=this.pointMap;bY.projectionMatrixInverse.elements=[.5112609807824982,-0,-0,-0,-0,.41421356237309503,-0,-0,-0,-0,-0,-.099999,-0,-0,-1.0000000000000002,.100001];let n=.8;DY("n1",t,e,bY,-1,-1,n),DY("n2",t,e,bY,1,-1,n),DY("n3",t,e,bY,-1,1,n),DY("n4",t,e,bY,1,1,n);let i=n;DY("f1",t,e,bY,-1,-1,i),DY("f2",t,e,bY,1,-1,i),DY("f3",t,e,bY,-1,1,i),DY("f4",t,e,bY,1,1,i);let r=i;DY("u1",t,e,bY,.35,1.1,r),DY("u2",t,e,bY,-.35,1.1,r),DY("u3",t,e,bY,0,1.55,r),e.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}};function DY(e,t,n,i,r,s,a){xY.set(r,s,a).unproject(i);let o=t[e];if(void 0!==o){let e=n.getAttribute("position");for(let t=0,n=o.length;t<n;t++)e.setXYZ(o[t],xY.x,xY.y,xY.z)}}var _Y,SY=class extends(fY(wY)){constructor(e){super(e),this.object=e,this.object=e,this.name="CombinedCameraHelper: ".concat(e.uuid)}updateMatrixWorld(e){super.updateMatrixWorld(e),this.updateTarget()}updateTarget(){let e=this.object.getTarget();this.updateWorldMatrix(!0,!1),this.worldToLocal(e)}raycast(e,t){yY(this.object,this.geometry,e,t,!0)}};(e=>{e.is=e=>"objectHelper"in e})(_Y||(_Y={}));var EY=(e,t)=>class extends(lN(e)){constructor(){super(...arguments),this.objectHelper=new t(this),this.gizmos={}}get geometryHelper(){return t.geometryHelper}raycast(e,t){this.objectHelper.raycast(e,t)}showGizmos(){for(let e in this.gizmos){let t=this.gizmos[e];t instanceof kE&&(t.visible=!0)}}updateEntityBoxSize(e,t){this.objectHelper.visible&&this.geometryHelper instanceof Mx?(e.setScalar(0),t.set(this.geometryHelper.parameters.width,this.geometryHelper.parameters.height,this.geometryHelper.parameters.height).multiplyScalar(.5)):super.updateEntityBoxSize(e,t)}hideGizmos(){for(let e in this.gizmos){let t=this.gizmos[e];t instanceof kE&&(t.visible=!1)}}},CY=new Lv,AY=new Lv,MY=new Rv,TY=new Lv,PY=new Lv,FY=new Lv,OY=class extends(EY(kx,SY)){constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:d(d({},YB.defaultData),{},{name:""});super(),this._cameraType="OrthographicCamera",this.targetOffset=Yk.DefaultTargetOffset,this.isUpVectorFlipped=!1,this.angleOffsetFromUp=0,this.wasMovedByUser=!1,this.wasMovedBySwitchCameraAction=!1,this.super_Entity(e,t),this.previousProjectionMatrix=new py,this.matrixAutoUpdate=!0,this.width=window.innerWidth,this.height=window.innerHeight;let n=this.width,i=this.height;this.orthoCamera=new ab(-.5*n,.5*n,.5*i,-.5*i,-5e4,1e4),this.perspCamera=new Bx(45,n/i,50,1e4),this.left=this.orthoCamera.left,this.right=this.orthoCamera.right,this.top=this.orthoCamera.top,this.bottom=this.orthoCamera.bottom,this.far=this.orthoCamera.far,this.view=this.orthoCamera.view,this.aspect=this.perspCamera.aspect,this.focus=this.perspCamera.focus,this.filmGauge=this.perspCamera.filmGauge,this.filmOffset=this.perspCamera.filmOffset,this.objectHelper.update()}get isPerspectiveCamera(){return"PerspectiveCamera"===this.cameraType}get isOrthographicCamera(){return!this.isPerspectiveCamera}get cameraType(){return this._cameraType}set fov(e){this.perspCamera.fov=e}get fov(){return this.perspCamera.fov}setNear(e,t){"PerspectiveCamera"===e?this.perspCamera.near=t:this.orthoCamera.near=t}setZoom(e,t){t>=0&&("PerspectiveCamera"===e?this.perspCamera.zoom=t:this.orthoCamera.zoom=t)}set cameraType(e){"PerspectiveCamera"===e?this.toPerspective():"OrthographicCamera"===e&&this.toOrthographic()}get near(){return"PerspectiveCamera"===this._cameraType?this.perspCamera.near:this.orthoCamera.near}set near(e){"PerspectiveCamera"===this._cameraType?this.perspCamera.near=e:this.orthoCamera.near=e}get zoom(){return"PerspectiveCamera"===this._cameraType?this.perspCamera.zoom:this.orthoCamera.zoom}set zoom(e){e>=0&&("PerspectiveCamera"===this._cameraType?this.perspCamera.zoom=e:this.orthoCamera.zoom=e)}lookAt(e,t,n){"number"==typeof e&&(e=new Lv(e,t,n)),super.lookAt(e),this.getWorldPosition(CY),this.targetOffset=CY.distanceTo(e)}getTarget(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Lv;return this.getWorldDirection(AY),this.getWorldPosition(CY),AY.multiplyScalar(this.targetOffset),e.copy(CY).add(AY),e}getDistanceToTarget(){let e=this.getTarget();return this.getWorldPosition(CY),CY.distanceTo(e)}updateUp(){this.getWorldQuaternion(MY),TY.set(0,0,1).applyQuaternion(MY),PY.copy(zy.DEFAULT_UP),this.isUpVectorFlipped&&PY.negate(),PY.applyQuaternion(MY),FY.copy(zy.DEFAULT_UP).projectOnPlane(TY),this.angleOffsetFromUp=FY.angleTo(PY),this.angleOffsetFromUp*=FY.cross(PY).dot(TY)>=0?1:-1}updateTransformState(e,t){let n=super.updateTransformState(e,t);return void 0!==e.isUpVectorFlipped&&(this.isUpVectorFlipped=e.isUpVectorFlipped),this.updateUp(),n}getViewFrontToObject(e){let t=e.getWorldPosition(new Lv),n=e.getWorldDirection(new Lv).multiplyScalar(this.targetOffset);return{position:t.clone().add(n),target:t}}getViewToTarget(e){let t=this.getWorldDirection(new Lv).multiplyScalar(this.targetOffset);return{position:e.clone().sub(t),target:e}}getViewToObject(e){let t=new Lv;e.getWorldPosition(t);return this.getViewToTarget(t)}setViewplaneSize(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(this.aspect=e/t,n){let n=e>t?this.aspect:1,i=e>t?1:this.aspect;this.left=-395*n,this.right=395*n,this.top=1/i*395,this.bottom=1/i*-395}else this.left=.5*-e,this.right=.5*e,this.top=.5*t,this.bottom=.5*-t;this.updateProjectionMatrix()}copyViewPlaneSize(e){this.aspect=e.aspect,this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.updateProjectionMatrix()}toOrthographic(){this.orthoCamera.left=this.left,this.orthoCamera.right=this.right,this.orthoCamera.top=this.top,this.orthoCamera.bottom=this.bottom,this.orthoCamera.view=this.view,this.orthoCamera.far=this.far,this.orthoCamera.updateProjectionMatrix(),this.projectionMatrix=this.orthoCamera.projectionMatrix,this.projectionMatrixInverse=this.orthoCamera.projectionMatrixInverse,this._cameraType="OrthographicCamera",this.objectHelper&&this.objectHelper.update()}toPerspective(){this.perspCamera.aspect=this.aspect,this.perspCamera.fov=this.fov,this.perspCamera.view=this.view,this.perspCamera.far=this.far,this.perspCamera.updateProjectionMatrix(),this.projectionMatrix=this.perspCamera.projectionMatrix,this.projectionMatrixInverse=this.perspCamera.projectionMatrixInverse,this._cameraType="PerspectiveCamera",this.objectHelper&&this.objectHelper.update()}setFocalLength(e){this.perspCamera.setFocalLength(e),this.toPerspective()}getFocalLength(){return this.perspCamera.getFocalLength()}getEffectiveFOV(){return this.perspCamera.getEffectiveFOV()}getFilmWidth(){return this.perspCamera.getFilmWidth()}getFilmHeight(){return this.perspCamera.getFilmHeight()}setViewOffset(e,t,n,i,r,s){"PerspectiveCamera"===this._cameraType?this.perspCamera.setViewOffset(e,t,n,i,r,s):this.orthoCamera.setViewOffset(e,t,n,i,r,s)}clearViewOffset(){"PerspectiveCamera"===this._cameraType?(this.perspCamera.clearViewOffset(),this.toPerspective()):(this.orthoCamera.clearViewOffset(),this.toOrthographic())}copyHistory(){this.previousProjectionMatrix&&this.previousProjectionMatrix.copy(this.projectionMatrix)}updateProjectionMatrix(){"PerspectiveCamera"===this._cameraType?this.toPerspective():"OrthographicCamera"===this._cameraType&&this.toOrthographic()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}copy(e,t){return super.copy(e,t),this.parent=e.parent,this.orthoCamera.copy(e.orthoCamera),this.perspCamera.copy(e.perspCamera),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.far=e.far,this.view=null===e.view?null:Object.assign({},e.view),this._cameraType=e._cameraType,this.aspect=e.aspect,this.fov=e.fov,this.focus=e.focus,this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this.targetOffset=e.targetOffset,this.updateProjectionMatrix(),this}toCameraState(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t={type:this.cameraType,far:this.far,orthographic:{near:this.orthoCamera.near,zoom:this.orthoCamera.zoom},perspective:{near:this.perspCamera.near,fov:this.perspCamera.fov,zoom:this.perspCamera.zoom},up:this.up.toArray(),targetOffset:this.targetOffset,isUpVectorFlipped:this.isUpVectorFlipped};return pF(t,e)}updateCameraSubtype(e,t){let n="perspective"===e?"PerspectiveCamera":"OrthographicCamera";void 0!==t.zoom&&this.setZoom(n,t.zoom),void 0!==t.near&&this.setNear(n,t.near),void 0!==t.fov&&"PerspectiveCamera"===n&&(this.fov=t.fov)}updateState(e,t){this.updateCameraState(e,t)}updateCameraState(e,t){this.updateState_Entity(e,t),void 0!==e.far&&(this.far=e.far),void 0!==e.orthographic&&this.updateCameraSubtype("orthographic",e.orthographic),void 0!==e.perspective&&this.updateCameraSubtype("perspective",e.perspective),void 0!==e.type&&(this.cameraType=e.type),void 0!==e.up&&this.up.fromArray(e.up),void 0!==e.targetOffset&&(this.targetOffset=e.targetOffset),void 0!==e.isUpVectorFlipped&&(this.isUpVectorFlipped=e.isUpVectorFlipped),this.updateProjectionMatrix()}updateByPatchedOp(e,t,n){super.updateByPatchedOp(e,t,n),1===e.path.length&&0===e.type&&this.updateCameraSubtype(e.path[0],e.props)}toState(e){return d(d(d({},super.toState(e)),this.toCameraState(e)),{},{type:this.cameraType})}},IY=new py,kY=new py;function BY(e){let t=!1;return e.scene.objects.traverse(((e,n)=>{var i;"BooleanGeometry"===(null===(i=n.geometry)||void 0===i?void 0:i.type)&&(t=!0)})),t}var RY,LY=class extends yq{constructor(e,t,n){super(e,t),this.data=t,this.meshSetAddresses=[],this.needsTransformForDownstream=!1,this.geometry=new dx,this.onAfterRender=(e,t,n,i,r,s)=>{super.onAfterRender(e,t,n,i,r,s),this.recomputeBoolean()},this.geometry.userData.parameters={width:0,height:0,depth:0}}get booleanOp(){return this.data.geometry.operation}get phongAngle(){var e;return null!==(e=this.data.geometry.phongAngle)&&void 0!==e?e:45}get isLOD(){return this.recomputeBoolean(),!1}updateByPatchedOp(e,t,n){super.updateByPatchedOp(e,t,n),1===e.path.length&&"geometry"===e.path[0]&&0===e.type&&void 0!==e.props.operation&&(this.freeBooleanPointer(),this.resetBBoxNeedsUpdate())}freeBooleanPointer(){super.freeBooleanPointer(),this.geometry.dispose()}recomputeBoolean(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(-1!==this.booleanMeshSetAddress&&!e)return;for(let a=0;a<this.children.length;a++){let n=this.children[a];n instanceof LY&&!0===n.dataPatched.visible&&n.recomputeBoolean(!0===e,t)}this.meshSetAddresses=[];for(let a=0;a<this.children.length;a++){var n;let r=this.children[a];if(r instanceof FV&&!0===r.dataPatched.visible&&(null===(n=r.geometry.attributes.position)||void 0===n?void 0:n.count)>0&&r.geometry.drawRange.count>0&&0!==r.booleanMeshSetAddress){IY.multiplyMatrices(r.hiddenMatrix,r.matrix);try{if(-1===r.booleanMeshSetAddress){var i;if((null!==(i=r.geometry.index)&&void 0!==i?i:r.geometry.getAttribute("position")).count/3<15e5&&(r.booleanMeshSetAddress=pV.getMeshSet(r.geometry,!0===e,t)),-1===r.booleanMeshSetAddress)return;pV.transformMeshSet(r.booleanMeshSetAddress,IY),r.booleanMatrixInvOld.copy(IY).invert(),r.booleanWasTransformed=!1}else r instanceof LY&&!0===r.needsTransformForDownstream?(pV.transformMeshSet(r.booleanMeshSetAddress,IY),r.needsTransformForDownstream=!1):!0===r.booleanWasTransformed&&(pV.transformMeshSet(r.booleanMeshSetAddress,kY.multiplyMatrices(IY,r.booleanMatrixInvOld)),r.booleanMatrixInvOld.copy(IY).invert(),r.booleanWasTransformed=!1)}catch(wi){console.error(wi),r.booleanMeshSetAddress=0,r.geometry.userData.booleanOperationDidFail=!0;continue}!1===pV.hasOpenEdges(r.booleanMeshSetAddress)||a===this.children.length-1&&2===this.booleanOp?(this.meshSetAddresses.push(r.booleanMeshSetAddress),r.geometry.userData.booleanOperationDidFail=!1):r.geometry.userData.booleanOperationDidFail="openEdges"}}if(0===this.meshSetAddresses.length)return this.geometry.setAttribute("position",new rx([],0)),void this.geometry.setDrawRange(0,0);if(!0===e)return pV.calcBooleanTopological(this.meshSetAddresses,this.booleanOp);let r=this.geometry;r.dispose(),this.geometry=new dx,this.geometry.userData=r.userData,this.geometry.boundingSphere=r.boundingSphere;try{this.booleanMeshSetAddress=pV.calcBoolean(this.meshSetAddresses,this.booleanOp,this.geometry,this.phongAngle)}catch(s){this.booleanMeshSetAddress=0,this.geometry.userData.booleanOperationDidFail=!0,console.error(s)}this.booleanMatrixInvOld.copy(this.matrix).invert(),this.needsTransformForDownstream=!0,Eq(this),Cq(this)}dispose(){super.dispose(),this.geometry.dispose()}};(e=>{e.is=function(e){return Nz.is(e)&&e instanceof IS}})(RY||(RY={}));var zY=(e,t)=>class extends(EY(e,t)){updateState_Light(e,t){this.updateState_Entity(e,t),void 0!==e.color&&(this.color=t.shared.color(e.color)),void 0!==e.intensity&&(this.intensity=e.intensity),void 0!==e.depth&&(this.shadow.camera.far=e.depth,this.shadow.needsUpdate=!0),void 0!==e.shadows&&(this.castShadow=e.shadows)}},NY=e=>e instanceof FV,jY=e=>null!==e&&e instanceof LY,UY=e=>_Y.is(e),VY=new Lv(1,1,1),HY=new Lv,WY=new Lv,GY=new Rv,qY=class extends(fY(BE)){constructor(e){super(arguments.length>1&&void 0!==arguments[1]?arguments[1]:15),this.object=e,this.dummy=new vD,this.object.updateMatrixWorld(),this.name="EmptyObjectHelper: ".concat(e.uuid),this.matrix=this.dummy.matrixWorld,this.matrixAutoUpdate=!1,this.object.isBone&&(this.visible=!1)}raycast(e,t){yY(this.object,qY.geometryHelper,e,t,!1,this.dummy)}update(){}updateMatrix(){}updateMatrixWorld(e){this.object.matrixWorld.decompose(HY,GY,WY),this.matrix.compose(HY,GY,VY),super.updateMatrixWorld(e)}updateWorldMatrix(e,t){}},YY=class extends(EY(vD,qY)){constructor(e,t){super(),this.super_Entity(e,t),this.objectHelper.update()}updateState(e,t){this.updateState_Entity(e,t),"buffer"in e&&1===Object.keys(e).length&&t.scene.reloadSplats()}},XY=class extends(EY(vD,qY)){constructor(e,t,n){super(),this.super_Entity(e,t),this.context=n,this.objectHelper.update()}updateState(e,t){this.updateState_Entity(e,t)}},QY=0,KY=1,ZY="varying vec2 vUv;void main(){vUv=position.xy*0.5+0.5;gl_Position=vec4(position.xy,1.0,1.0);}",JY=class extends Ix{constructor(){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];super({name:"BokehMaterial",defines:{PASS:arguments.length>0&&void 0!==arguments[0]&&arguments[0]?"2":"1"},uniforms:{kernel64:new pE(null),kernel16:new pE(null),inputBuffer:new pE(null),cocBuffer:new pE(null),texelSize:new pE(new lv),scale:new pE(1)},blending:0,depthWrite:!1,depthTest:!1,fragmentShader:"#ifdef FRAMEBUFFER_PRECISION_HIGH\nuniform mediump sampler2D inputBuffer;\n#else\nuniform lowp sampler2D inputBuffer;\n#endif\nuniform lowp sampler2D cocBuffer;uniform vec2 texelSize;uniform float scale;uniform vec4 kernel64[32];varying vec2 vUv;void main(){\n#ifdef FOREGROUND\nvec2 CoCNearFar=texture2D(cocBuffer,vUv).rg;float CoC=CoCNearFar.r*scale;\n#else\nfloat CoC=texture2D(cocBuffer,vUv).g*scale;\n#endif\nif(CoC==0.0){gl_FragColor=texture2D(inputBuffer,vUv);}else{\n#ifdef FOREGROUND\nvec2 step=texelSize*max(CoC,CoCNearFar.g*scale);\n#else\nvec2 step=texelSize*CoC;\n#endif\nvec4 acc=vec4(0.0);for(int i=0;i<32;++i){vec4 kernel=kernel64[i];vec2 uv=step*kernel.xy+vUv;acc+=texture2D(inputBuffer,uv);uv=step*kernel.zw+vUv;acc+=texture2D(inputBuffer,uv);}gl_FragColor=acc/64.0;}}",vertexShader:ZY}),this.toneMapped=!1,e&&(this.defines.FOREGROUND="1"),this.generateKernel()}set inputBuffer(e){this.uniforms.inputBuffer.value=e}setInputBuffer(e){this.uniforms.inputBuffer.value=e}set cocBuffer(e){this.uniforms.cocBuffer.value=e}setCoCBuffer(e){this.uniforms.cocBuffer.value=e}get scale(){return this.uniforms.scale.value}set scale(e){this.uniforms.scale.value=e}getScale(e){return this.uniforms.scale.value=e}setScale(e){this.uniforms.scale.value=e}generateKernel(){let e=new Float32Array(128),t=new Float32Array(32),n=0,i=0;for(let a=0;a<80;++a){let r=2.39996323*a,s=Math.sqrt(a)/Math.sqrt(80),o=s*Math.cos(r),l=s*Math.sin(r);a%5===0?(t[i++]=o,t[i++]=l):(e[n++]=o,e[n++]=l)}let r=[],s=[];for(let a=0;a<128;)r.push(new Ov(e[a++],e[a++],e[a++],e[a++]));for(let a=0;a<32;)s.push(new Ov(t[a++],t[a++],t[a++],t[a++]));this.uniforms.kernel64.value=r,this.uniforms.kernel16.value=s}setTexelSize(e,t){this.uniforms.texelSize.value.set(e,t)}setSize(e,t){this.uniforms.texelSize.value.set(1/e,1/t)}};function $Y(e,t,n){return e*(t-n)-t}function eX(e,t,n){return Math.min(Math.max((e+t)/(t-n),0),1)}var tX=class extends Ix{constructor(e){super({name:"CircleOfConfusionMaterial",defines:{DEPTH_PACKING:"0"},uniforms:{depthBuffer:new pE(null),focusDistance:new pE(0),focusRange:new pE(0),cameraNear:new pE(.3),cameraFar:new pE(1e3)},blending:0,depthWrite:!1,depthTest:!1,fragmentShader:"#include <common>\n#include <packing>\n#ifdef GL_FRAGMENT_PRECISION_HIGH\nuniform highp sampler2D depthBuffer;\n#else\nuniform mediump sampler2D depthBuffer;\n#endif\nuniform float focusDistance;uniform float focusRange;uniform float cameraNear;uniform float cameraFar;varying vec2 vUv;float readDepth(const in vec2 uv){\n#if DEPTH_PACKING == 3201\nreturn unpackRGBAToDepth(texture2D(depthBuffer,uv));\n#else\nreturn texture2D(depthBuffer,uv).r;\n#endif\n}void main(){float depth=readDepth(vUv);\n#ifdef PERSPECTIVE_CAMERA\nfloat viewZ=perspectiveDepthToViewZ(depth,cameraNear,cameraFar);float linearDepth=viewZToOrthographicDepth(viewZ,cameraNear,cameraFar);\n#else\nfloat linearDepth=depth;\n#endif\nfloat signedDistance=linearDepth-focusDistance;float magnitude=smoothstep(0.0,focusRange,abs(signedDistance));gl_FragColor.rg=magnitude*vec2(step(signedDistance,0.0),step(0.0,signedDistance));}",vertexShader:ZY}),this.toneMapped=!1,this.uniforms.focalLength=this.uniforms.focusRange,this.adoptCameraSettings(e)}get near(){return this.uniforms.cameraNear.value}get far(){return this.uniforms.cameraFar.value}set depthBuffer(e){this.uniforms.depthBuffer.value=e}set depthPacking(e){this.defines.DEPTH_PACKING=e.toFixed(0),this.needsUpdate=!0}setDepthBuffer(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:jg;this.depthBuffer=e,this.depthPacking=t}get focusDistance(){return this.uniforms.focusDistance.value}set focusDistance(e){this.uniforms.focusDistance.value=e}get worldFocusDistance(){return-$Y(this.focusDistance,this.near,this.far)}set worldFocusDistance(e){this.focusDistance=eX(-e,this.near,this.far)}getFocusDistance(e){this.uniforms.focusDistance.value=e}setFocusDistance(e){this.uniforms.focusDistance.value=e}get focalLength(){return this.focusRange}set focalLength(e){this.focusRange=e}get focusRange(){return this.uniforms.focusRange.value}set focusRange(e){this.uniforms.focusRange.value=e}get worldFocusRange(){return-$Y(this.focusRange,this.near,this.far)}set worldFocusRange(e){this.focusRange=eX(-e,this.near,this.far)}getFocalLength(e){return this.focusRange}setFocalLength(e){this.focusRange=e}adoptCameraSettings(e){e&&(this.uniforms.cameraNear.value=e.near,this.uniforms.cameraFar.value=e.far,e instanceof Bx?this.defines.PERSPECTIVE_CAMERA="1":delete this.defines.PERSPECTIVE_CAMERA,this.needsUpdate=!0)}},nX=class extends Ix{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new lv;super({name:"KawaseBlurMaterial",uniforms:{inputBuffer:new pE(null),texelSize:new pE(new lv),halfTexelSize:new pE(new lv),kernel:new pE(0),scale:new pE(1)},blending:0,depthWrite:!1,depthTest:!1,fragmentShader:"#include <common>\n#include <dithering_pars_fragment>\n#ifdef FRAMEBUFFER_PRECISION_HIGH\nuniform mediump sampler2D inputBuffer;\n#else\nuniform lowp sampler2D inputBuffer;\n#endif\nvarying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;void main(){vec4 sum=texture2D(inputBuffer,vUv0);sum+=texture2D(inputBuffer,vUv1);sum+=texture2D(inputBuffer,vUv2);sum+=texture2D(inputBuffer,vUv3);gl_FragColor=sum*0.25;\n#include <encodings_fragment>\n#include <dithering_fragment>\n}",vertexShader:"uniform vec2 texelSize;uniform vec2 halfTexelSize;uniform float kernel;uniform float scale;varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;void main(){vec2 uv=position.xy*0.5+0.5;vec2 dUv=(texelSize*vec2(kernel)+halfTexelSize)*scale;vUv0=vec2(uv.x-dUv.x,uv.y+dUv.y);vUv1=vec2(uv.x+dUv.x,uv.y+dUv.y);vUv2=vec2(uv.x+dUv.x,uv.y-dUv.y);vUv3=vec2(uv.x-dUv.x,uv.y-dUv.y);gl_Position=vec4(position.xy,1.0,1.0);}"}),this.toneMapped=!1,this.setTexelSize(e.x,e.y)}set inputBuffer(e){this.uniforms.inputBuffer.value=e}setInputBuffer(e){this.inputBuffer=e}get scale(){return this.uniforms.scale.value}set scale(e){this.uniforms.scale.value=e}getScale(){return this.uniforms.scale.value}setScale(e){this.uniforms.scale.value=e}getKernel(){return null}get kernel(){return this.uniforms.kernel.value}set kernel(e){this.uniforms.kernel.value=e}setKernel(e){this.kernel=e}setTexelSize(e,t){this.uniforms.texelSize.value.set(e,t),this.uniforms.halfTexelSize.value.set(e,t).multiplyScalar(.5)}setSize(e,t){let n=this.uniforms;n.texelSize.value.set(1/e,1/t),n.halfTexelSize.value.copy(n.texelSize.value).multiplyScalar(.5)}},iX=class extends Ix{constructor(){super({name:"CopyMaterial",uniforms:{inputBuffer:new pE(null),opacity:new pE(1)},blending:0,depthWrite:!1,depthTest:!1,fragmentShader:"#ifdef FRAMEBUFFER_PRECISION_HIGH\nuniform mediump sampler2D inputBuffer;\n#else\nuniform lowp sampler2D inputBuffer;\n#endif\nuniform float opacity;varying vec2 vUv;void main(){vec4 texel=texture2D(inputBuffer,vUv);gl_FragColor=opacity*texel;\n#include <encodings_fragment>\n}",vertexShader:ZY}),this.toneMapped=!1}set inputBuffer(e){this.uniforms.inputBuffer.value=e}setInputBuffer(e){this.uniforms.inputBuffer.value=e}getOpacity(e){return this.uniforms.opacity.value}setOpacity(e){this.uniforms.opacity.value=e}},rX={DEPTH:0,LUMA:1,COLOR:2},sX={DISABLED:0,DEPTH:1,CUSTOM:2},aX=class extends Ix{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new lv,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:rX.COLOR;super({name:"EdgeDetectionMaterial",defines:{THREE_REVISION:Bm.replace(/\D+/g,""),LOCAL_CONTRAST_ADAPTATION_FACTOR:"2.0",EDGE_THRESHOLD:"0.1",DEPTH_THRESHOLD:"0.01",PREDICATION_MODE:"0",PREDICATION_THRESHOLD:"0.01",PREDICATION_SCALE:"2.0",PREDICATION_STRENGTH:"1.0",DEPTH_PACKING:"0"},uniforms:{inputBuffer:new pE(null),depthBuffer:new pE(null),predicationBuffer:new pE(null),texelSize:new pE(e)},blending:0,depthWrite:!1,depthTest:!1,fragmentShader:"varying vec2 vUv;varying vec2 vUv0;varying vec2 vUv1;\n#if THREE_REVISION < 143\n#define luminance(v) linearToRelativeLuminance(v)\n#endif\n#if EDGE_DETECTION_MODE != 0\nvarying vec2 vUv2;varying vec2 vUv3;varying vec2 vUv4;varying vec2 vUv5;\n#endif\n#if EDGE_DETECTION_MODE == 1\n#include <common>\n#endif\n#if EDGE_DETECTION_MODE == 0 || PREDICATION_MODE == 1\n#ifdef GL_FRAGMENT_PRECISION_HIGH\nuniform highp sampler2D depthBuffer;\n#else\nuniform mediump sampler2D depthBuffer;\n#endif\nfloat readDepth(const in vec2 uv){\n#if DEPTH_PACKING == 3201\nreturn unpackRGBAToDepth(texture2D(depthBuffer,uv));\n#else\nreturn texture2D(depthBuffer,uv).r;\n#endif\n}vec3 gatherNeighbors(){float p=readDepth(vUv);float pLeft=readDepth(vUv0);float pTop=readDepth(vUv1);return vec3(p,pLeft,pTop);}\n#elif PREDICATION_MODE == 2\nuniform sampler2D predicationBuffer;vec3 gatherNeighbors(){float p=texture2D(predicationBuffer,vUv).r;float pLeft=texture2D(predicationBuffer,vUv0).r;float pTop=texture2D(predicationBuffer,vUv1).r;return vec3(p,pLeft,pTop);}\n#endif\n#if PREDICATION_MODE != 0\nvec2 calculatePredicatedThreshold(){vec3 neighbours=gatherNeighbors();vec2 delta=abs(neighbours.xx-neighbours.yz);vec2 edges=step(PREDICATION_THRESHOLD,delta);return PREDICATION_SCALE*EDGE_THRESHOLD*(1.0-PREDICATION_STRENGTH*edges);}\n#endif\n#if EDGE_DETECTION_MODE != 0\nuniform sampler2D inputBuffer;\n#endif\nvoid main(){\n#if EDGE_DETECTION_MODE == 0\nconst vec2 threshold=vec2(DEPTH_THRESHOLD);\n#elif PREDICATION_MODE != 0\nvec2 threshold=calculatePredicatedThreshold();\n#else\nconst vec2 threshold=vec2(EDGE_THRESHOLD);\n#endif\n#if EDGE_DETECTION_MODE == 0\nvec3 neighbors=gatherNeighbors();vec2 delta=abs(neighbors.xx-vec2(neighbors.y,neighbors.z));vec2 edges=step(threshold,delta);if(dot(edges,vec2(1.0))==0.0){discard;}gl_FragColor=vec4(edges,0.0,1.0);\n#elif EDGE_DETECTION_MODE == 1\nfloat l=luminance(texture2D(inputBuffer,vUv).rgb);float lLeft=luminance(texture2D(inputBuffer,vUv0).rgb);float lTop=luminance(texture2D(inputBuffer,vUv1).rgb);vec4 delta;delta.xy=abs(l-vec2(lLeft,lTop));vec2 edges=step(threshold,delta.xy);if(dot(edges,vec2(1.0))==0.0){discard;}float lRight=luminance(texture2D(inputBuffer,vUv2).rgb);float lBottom=luminance(texture2D(inputBuffer,vUv3).rgb);delta.zw=abs(l-vec2(lRight,lBottom));vec2 maxDelta=max(delta.xy,delta.zw);float lLeftLeft=luminance(texture2D(inputBuffer,vUv4).rgb);float lTopTop=luminance(texture2D(inputBuffer,vUv5).rgb);delta.zw=abs(vec2(lLeft,lTop)-vec2(lLeftLeft,lTopTop));maxDelta=max(maxDelta.xy,delta.zw);float finalDelta=max(maxDelta.x,maxDelta.y);edges.xy*=step(finalDelta,LOCAL_CONTRAST_ADAPTATION_FACTOR*delta.xy);gl_FragColor=vec4(edges,0.0,1.0);\n#elif EDGE_DETECTION_MODE == 2\nvec4 delta;vec3 c=texture2D(inputBuffer,vUv).rgb;vec3 cLeft=texture2D(inputBuffer,vUv0).rgb;vec3 t=abs(c-cLeft);delta.x=max(max(t.r,t.g),t.b);vec3 cTop=texture2D(inputBuffer,vUv1).rgb;t=abs(c-cTop);delta.y=max(max(t.r,t.g),t.b);vec2 edges=step(threshold,delta.xy);if(dot(edges,vec2(1.0))==0.0){discard;}vec3 cRight=texture2D(inputBuffer,vUv2).rgb;t=abs(c-cRight);delta.z=max(max(t.r,t.g),t.b);vec3 cBottom=texture2D(inputBuffer,vUv3).rgb;t=abs(c-cBottom);delta.w=max(max(t.r,t.g),t.b);vec2 maxDelta=max(delta.xy,delta.zw);vec3 cLeftLeft=texture2D(inputBuffer,vUv4).rgb;t=abs(c-cLeftLeft);delta.z=max(max(t.r,t.g),t.b);vec3 cTopTop=texture2D(inputBuffer,vUv5).rgb;t=abs(c-cTopTop);delta.w=max(max(t.r,t.g),t.b);maxDelta=max(maxDelta.xy,delta.zw);float finalDelta=max(maxDelta.x,maxDelta.y);edges*=step(finalDelta,LOCAL_CONTRAST_ADAPTATION_FACTOR*delta.xy);gl_FragColor=vec4(edges,0.0,1.0);\n#endif\n}",vertexShader:"uniform vec2 texelSize;varying vec2 vUv;varying vec2 vUv0;varying vec2 vUv1;\n#if EDGE_DETECTION_MODE != 0\nvarying vec2 vUv2;varying vec2 vUv3;varying vec2 vUv4;varying vec2 vUv5;\n#endif\nvoid main(){vUv=position.xy*0.5+0.5;vUv0=vUv+texelSize*vec2(-1.0,0.0);vUv1=vUv+texelSize*vec2(0.0,-1.0);\n#if EDGE_DETECTION_MODE != 0\nvUv2=vUv+texelSize*vec2(1.0,0.0);vUv3=vUv+texelSize*vec2(0.0,1.0);vUv4=vUv+texelSize*vec2(-2.0,0.0);vUv5=vUv+texelSize*vec2(0.0,-2.0);\n#endif\ngl_Position=vec4(position.xy,1.0,1.0);}"}),this.toneMapped=!1,this.edgeDetectionMode=t}set depthBuffer(e){this.uniforms.depthBuffer.value=e}set depthPacking(e){this.defines.DEPTH_PACKING=e.toFixed(0),this.needsUpdate=!0}setDepthBuffer(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:jg;this.depthBuffer=e,this.depthPacking=t}get edgeDetectionMode(){return Number(this.defines.EDGE_DETECTION_MODE)}set edgeDetectionMode(e){this.defines.EDGE_DETECTION_MODE=e.toFixed(0),this.needsUpdate=!0}getEdgeDetectionMode(){return this.edgeDetectionMode}setEdgeDetectionMode(e){this.edgeDetectionMode=e}get localContrastAdaptationFactor(){return Number(this.defines.LOCAL_CONTRAST_ADAPTATION_FACTOR)}set localContrastAdaptationFactor(e){this.defines.LOCAL_CONTRAST_ADAPTATION_FACTOR=e.toFixed("6"),this.needsUpdate=!0}getLocalContrastAdaptationFactor(){return this.localContrastAdaptationFactor}setLocalContrastAdaptationFactor(e){this.localContrastAdaptationFactor=e}get edgeDetectionThreshold(){return Number(this.defines.EDGE_THRESHOLD)}set edgeDetectionThreshold(e){this.defines.EDGE_THRESHOLD=e.toFixed("6"),this.defines.DEPTH_THRESHOLD=(.1*e).toFixed("6"),this.needsUpdate=!0}getEdgeDetectionThreshold(){return this.edgeDetectionThreshold}setEdgeDetectionThreshold(e){this.edgeDetectionThreshold=e}get predicationMode(){return Number(this.defines.PREDICATION_MODE)}set predicationMode(e){this.defines.PREDICATION_MODE=e.toFixed(0),this.needsUpdate=!0}getPredicationMode(){return this.predicationMode}setPredicationMode(e){this.predicationMode=e}set predicationBuffer(e){this.uniforms.predicationBuffer.value=e}setPredicationBuffer(e){this.uniforms.predicationBuffer.value=e}get predicationThreshold(){return Number(this.defines.PREDICATION_THRESHOLD)}set predicationThreshold(e){this.defines.PREDICATION_THRESHOLD=e.toFixed("6"),this.needsUpdate=!0}getPredicationThreshold(){return this.predicationThreshold}setPredicationThreshold(e){this.predicationThreshold=e}get predicationScale(){return Number(this.defines.PREDICATION_SCALE)}set predicationScale(e){this.defines.PREDICATION_SCALE=e.toFixed("6"),this.needsUpdate=!0}getPredicationScale(){return this.predicationScale}setPredicationScale(e){this.predicationScale=e}get predicationStrength(){return Number(this.defines.PREDICATION_STRENGTH)}set predicationStrength(e){this.defines.PREDICATION_STRENGTH=e.toFixed("6"),this.needsUpdate=!0}getPredicationStrength(){return this.predicationStrength}setPredicationStrength(e){this.predicationStrength=e}setSize(e,t){this.uniforms.texelSize.value.set(1/e,1/t)}},oX={FRAGMENT_HEAD:"FRAGMENT_HEAD",FRAGMENT_MAIN_UV:"FRAGMENT_MAIN_UV",FRAGMENT_MAIN_IMAGE:"FRAGMENT_MAIN_IMAGE",VERTEX_HEAD:"VERTEX_HEAD",VERTEX_MAIN_SUPPORT:"VERTEX_MAIN_SUPPORT"},lX=class extends Ix{constructor(e,t,n,i){let r=arguments.length>4&&void 0!==arguments[4]&&arguments[4];super({name:"EffectMaterial",defines:{THREE_REVISION:Bm.replace(/\D+/g,""),DEPTH_PACKING:"0",ENCODE_OUTPUT:"1"},uniforms:{inputBuffer:new pE(null),depthBuffer:new pE(null),resolution:new pE(new lv),texelSize:new pE(new lv),cameraNear:new pE(.3),cameraFar:new pE(1e3),aspect:new pE(1),time:new pE(0)},blending:0,depthWrite:!1,depthTest:!1,dithering:r}),this.toneMapped=!1,e&&this.setShaderParts(e),t&&this.setDefines(t),n&&this.setUniforms(n),this.adoptCameraSettings(i)}set inputBuffer(e){this.uniforms.inputBuffer.value=e}setInputBuffer(e){this.uniforms.inputBuffer.value=e}get depthBuffer(){return this.uniforms.depthBuffer.value}set depthBuffer(e){this.uniforms.depthBuffer.value=e}get depthPacking(){return Number(this.defines.DEPTH_PACKING)}set depthPacking(e){this.defines.DEPTH_PACKING=e.toFixed(0),this.needsUpdate=!0}setDepthBuffer(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:jg;this.depthBuffer=e,this.depthPacking=t}setShaderParts(e){return this.fragmentShader="#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#define packFloatToRGBA(v) packDepthToRGBA(v)\n#define unpackRGBAToFloat(v) unpackRGBAToDepth(v)\n#ifdef FRAMEBUFFER_PRECISION_HIGH\nuniform mediump sampler2D inputBuffer;\n#else\nuniform lowp sampler2D inputBuffer;\n#endif\n#ifdef GL_FRAGMENT_PRECISION_HIGH\nuniform highp sampler2D depthBuffer;\n#else\nuniform mediump sampler2D depthBuffer;\n#endif\nuniform vec2 resolution;uniform vec2 texelSize;uniform float cameraNear;uniform float cameraFar;uniform float aspect;uniform float time;varying vec2 vUv;\n#if THREE_REVISION < 143\n#define luminance(v) linearToRelativeLuminance(v)\n#endif\n#if THREE_REVISION >= 137\nvec4 sRGBToLinear(const in vec4 value){return vec4(mix(pow(value.rgb*0.9478672986+vec3(0.0521327014),vec3(2.4)),value.rgb*0.0773993808,vec3(lessThanEqual(value.rgb,vec3(0.04045)))),value.a);}\n#endif\nfloat readDepth(const in vec2 uv){\n#if DEPTH_PACKING == 3201\nreturn unpackRGBAToDepth(texture2D(depthBuffer,uv));\n#else\nreturn texture2D(depthBuffer,uv).r;\n#endif\n}float getViewZ(const in float depth){\n#ifdef PERSPECTIVE_CAMERA\nreturn perspectiveDepthToViewZ(depth,cameraNear,cameraFar);\n#else\nreturn orthographicDepthToViewZ(depth,cameraNear,cameraFar);\n#endif\n}FRAGMENT_HEADvoid main(){FRAGMENT_MAIN_UVvec4 color0=texture2D(inputBuffer,UV);vec4 color1=vec4(0.0);FRAGMENT_MAIN_IMAGEgl_FragColor=color0;\n#ifdef ENCODE_OUTPUT\n#include <encodings_fragment>\n#endif\n#include <dithering_fragment>\n}".replace(oX.FRAGMENT_HEAD,e.get(oX.FRAGMENT_HEAD)).replace(oX.FRAGMENT_MAIN_UV,e.get(oX.FRAGMENT_MAIN_UV)).replace(oX.FRAGMENT_MAIN_IMAGE,e.get(oX.FRAGMENT_MAIN_IMAGE)),this.vertexShader="uniform vec2 resolution;uniform vec2 texelSize;uniform float cameraNear;uniform float cameraFar;uniform float aspect;uniform float time;varying vec2 vUv;VERTEX_HEADvoid main(){vUv=position.xy*0.5+0.5;VERTEX_MAIN_SUPPORTgl_Position=vec4(position.xy,1.0,1.0);}".replace(oX.VERTEX_HEAD,e.get(oX.VERTEX_HEAD)).replace(oX.VERTEX_MAIN_SUPPORT,e.get(oX.VERTEX_MAIN_SUPPORT)),this.needsUpdate=!0,this}setDefines(e){for(let t of e.entries())this.defines[t[0]]=t[1];return this.needsUpdate=!0,this}setUniforms(e){for(let t of e.entries())this.uniforms[t[0]]=t[1];return this}setExtensions(e){this.extensions={};for(let t of e)this.extensions[t]=!0;return this}get encodeOutput(){return void 0!==this.defines.ENCODE_OUTPUT}set encodeOutput(e){this.encodeOutput!==e&&(e?this.defines.ENCODE_OUTPUT="1":delete this.defines.ENCODE_OUTPUT,this.needsUpdate=!0)}isOutputEncodingEnabled(e){return this.encodeOutput}setOutputEncodingEnabled(e){this.encodeOutput=e}get time(){return this.uniforms.time.value}set time(e){this.uniforms.time.value=e}setDeltaTime(e){this.uniforms.time.value+=e}adoptCameraSettings(e){e&&(this.uniforms.cameraNear.value=e.near,this.uniforms.cameraFar.value=e.far,e instanceof Bx?this.defines.PERSPECTIVE_CAMERA="1":delete this.defines.PERSPECTIVE_CAMERA,this.needsUpdate=!0)}setSize(e,t){let n=this.uniforms;n.resolution.value.set(e,t),n.texelSize.value.set(1/e,1/t),n.aspect.value=e/t}static get Section(){return oX}},uX=class extends Ix{constructor(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;super({name:"LuminanceMaterial",defines:{THREE_REVISION:Bm.replace(/\D+/g,"")},uniforms:{inputBuffer:new pE(null),threshold:new pE(0),smoothing:new pE(1),range:new pE(null)},blending:0,depthWrite:!1,depthTest:!1,fragmentShader:"#include <common>\n#if THREE_REVISION < 143\n#define luminance(v) linearToRelativeLuminance(v)\n#endif\n#ifdef FRAMEBUFFER_PRECISION_HIGH\nuniform mediump sampler2D inputBuffer;\n#else\nuniform lowp sampler2D inputBuffer;\n#endif\n#ifdef RANGE\nuniform vec2 range;\n#elif defined(THRESHOLD)\nuniform float threshold;uniform float smoothing;\n#endif\nvarying vec2 vUv;void main(){vec4 texel=texture2D(inputBuffer,vUv);float l=luminance(texel.rgb);\n#ifdef RANGE\nfloat low=step(range.x,l);float high=step(l,range.y);l*=low*high;\n#elif defined(THRESHOLD)\nl=smoothstep(threshold,threshold+smoothing,l);\n#endif\n#ifdef COLOR\ngl_FragColor=vec4(texel.rgb*l,l);\n#else\ngl_FragColor=vec4(l);\n#endif\n}",vertexShader:ZY}),this.toneMapped=!1,this.colorOutput=e,this.luminanceRange=t}set inputBuffer(e){this.uniforms.inputBuffer.value=e}setInputBuffer(e){this.uniforms.inputBuffer.value=e}get threshold(){return this.uniforms.threshold.value}set threshold(e){this.smoothing>0||e>0?this.defines.THRESHOLD="1":delete this.defines.THRESHOLD,this.uniforms.threshold.value=e}getThreshold(){return this.threshold}setThreshold(e){this.threshold=e}get smoothing(){return this.uniforms.smoothing.value}set smoothing(e){this.threshold>0||e>0?this.defines.THRESHOLD="1":delete this.defines.THRESHOLD,this.uniforms.smoothing.value=e}getSmoothingFactor(){return this.smoothing}setSmoothingFactor(e){this.smoothing=e}get useThreshold(){return this.threshold>0||this.smoothing>0}set useThreshold(e){}get colorOutput(){return void 0!==this.defines.COLOR}set colorOutput(e){e?this.defines.COLOR="1":delete this.defines.COLOR,this.needsUpdate=!0}isColorOutputEnabled(e){return this.colorOutput}setColorOutputEnabled(e){this.colorOutput=e}get useRange(){return null!==this.luminanceRange}set useRange(e){this.luminanceRange=null}get luminanceRange(){return this.uniforms.range.value}set luminanceRange(e){null!==e?this.defines.RANGE="1":delete this.defines.RANGE,this.uniforms.range.value=e,this.needsUpdate=!0}getLuminanceRange(){return this.luminanceRange}setLuminanceRange(e){this.luminanceRange=e}},cX=0,hX=1,dX=class extends Ix{constructor(){super({name:"MaskMaterial",uniforms:{maskTexture:new pE(arguments.length>0&&void 0!==arguments[0]?arguments[0]:null),inputBuffer:new pE(null),strength:new pE(1)},blending:0,depthWrite:!1,depthTest:!1,fragmentShader:"#ifdef FRAMEBUFFER_PRECISION_HIGH\nuniform mediump sampler2D inputBuffer;\n#else\nuniform lowp sampler2D inputBuffer;\n#endif\n#ifdef MASK_PRECISION_HIGH\nuniform mediump sampler2D maskTexture;\n#else\nuniform lowp sampler2D maskTexture;\n#endif\n#if MASK_FUNCTION != 0\nuniform float strength;\n#endif\nvarying vec2 vUv;void main(){\n#if COLOR_CHANNEL == 0\nfloat mask=texture2D(maskTexture,vUv).r;\n#elif COLOR_CHANNEL == 1\nfloat mask=texture2D(maskTexture,vUv).g;\n#elif COLOR_CHANNEL == 2\nfloat mask=texture2D(maskTexture,vUv).b;\n#else\nfloat mask=texture2D(maskTexture,vUv).a;\n#endif\n#if MASK_FUNCTION == 0\n#ifdef INVERTED\nmask=step(mask,0.0);\n#else\nmask=1.0-step(mask,0.0);\n#endif\n#else\nmask=clamp(mask*strength,0.0,1.0);\n#ifdef INVERTED\nmask=1.0-mask;\n#endif\n#endif\n#if MASK_FUNCTION == 2\ngl_FragColor=vec4(mask*texture2D(inputBuffer,vUv).rgb,mask);\n#else\ngl_FragColor=mask*texture2D(inputBuffer,vUv);\n#endif\n}",vertexShader:ZY}),this.toneMapped=!1,this.setColorChannel(QY),this.setMaskFunction(cX)}set inputBuffer(e){this.uniforms.inputBuffer.value=e}setInputBuffer(e){this.uniforms.inputBuffer.value=e}set maskTexture(e){this.uniforms.maskTexture.value=e,delete this.defines.MASK_PRECISION_HIGH,e.type!==mg&&(this.defines.MASK_PRECISION_HIGH="1"),this.needsUpdate=!0}setMaskTexture(e){this.maskTexture=e}set colorChannel(e){this.defines.COLOR_CHANNEL=e.toFixed(0),this.needsUpdate=!0}setColorChannel(e){this.colorChannel=e}set maskFunction(e){this.defines.MASK_FUNCTION=e.toFixed(0),this.needsUpdate=!0}setMaskFunction(e){this.maskFunction=e}get inverted(){return void 0!==this.defines.INVERTED}set inverted(e){this.inverted&&!e?delete this.defines.INVERTED:e&&(this.defines.INVERTED="1"),this.needsUpdate=!0}isInverted(){return this.inverted}setInverted(e){this.inverted=e}get strength(){return this.uniforms.strength.value}set strength(e){this.uniforms.strength.value=e}getStrength(){return this.strength}setStrength(e){this.strength=e}},pX=class extends Ix{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new lv,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new lv;super({name:"SMAAWeightsMaterial",defines:{MAX_SEARCH_STEPS_INT:"16",MAX_SEARCH_STEPS_FLOAT:"16.0",MAX_SEARCH_STEPS_DIAG_INT:"8",MAX_SEARCH_STEPS_DIAG_FLOAT:"8.0",CORNER_ROUNDING:"25",CORNER_ROUNDING_NORM:"0.25",AREATEX_MAX_DISTANCE:"16.0",AREATEX_MAX_DISTANCE_DIAG:"20.0",AREATEX_PIXEL_SIZE:"(1.0 / vec2(160.0, 560.0))",AREATEX_SUBTEX_SIZE:"(1.0 / 7.0)",SEARCHTEX_SIZE:"vec2(66.0, 33.0)",SEARCHTEX_PACKED_SIZE:"vec2(64.0, 16.0)"},uniforms:{inputBuffer:new pE(null),searchTexture:new pE(null),areaTexture:new pE(null),resolution:new pE(t),texelSize:new pE(e)},blending:0,depthWrite:!1,depthTest:!1,fragmentShader:"#define sampleLevelZeroOffset(t, coord, offset) texture2D(t, coord + offset * texelSize)\n#if __VERSION__ < 300\n#define round(v) floor(v + 0.5)\n#endif\n#ifdef FRAMEBUFFER_PRECISION_HIGH\nuniform mediump sampler2D inputBuffer;\n#else\nuniform lowp sampler2D inputBuffer;\n#endif\nuniform lowp sampler2D areaTexture;uniform lowp sampler2D searchTexture;uniform vec2 texelSize;uniform vec2 resolution;varying vec2 vUv;varying vec4 vOffset[3];varying vec2 vPixCoord;void movec(const in bvec2 c,inout vec2 variable,const in vec2 value){if(c.x){variable.x=value.x;}if(c.y){variable.y=value.y;}}void movec(const in bvec4 c,inout vec4 variable,const in vec4 value){movec(c.xy,variable.xy,value.xy);movec(c.zw,variable.zw,value.zw);}vec2 decodeDiagBilinearAccess(in vec2 e){e.r=e.r*abs(5.0*e.r-5.0*0.75);return round(e);}vec4 decodeDiagBilinearAccess(in vec4 e){e.rb=e.rb*abs(5.0*e.rb-5.0*0.75);return round(e);}vec2 searchDiag1(const in vec2 texCoord,const in vec2 dir,out vec2 e){vec4 coord=vec4(texCoord,-1.0,1.0);vec3 t=vec3(texelSize,1.0);for(int i=0;i<MAX_SEARCH_STEPS_INT;++i){if(!(coord.z<float(MAX_SEARCH_STEPS_DIAG_INT-1)&&coord.w>0.9)){break;}coord.xyz=t*vec3(dir,1.0)+coord.xyz;e=texture2D(inputBuffer,coord.xy).rg;coord.w=dot(e,vec2(0.5));}return coord.zw;}vec2 searchDiag2(const in vec2 texCoord,const in vec2 dir,out vec2 e){vec4 coord=vec4(texCoord,-1.0,1.0);coord.x+=0.25*texelSize.x;vec3 t=vec3(texelSize,1.0);for(int i=0;i<MAX_SEARCH_STEPS_INT;++i){if(!(coord.z<float(MAX_SEARCH_STEPS_DIAG_INT-1)&&coord.w>0.9)){break;}coord.xyz=t*vec3(dir,1.0)+coord.xyz;e=texture2D(inputBuffer,coord.xy).rg;e=decodeDiagBilinearAccess(e);coord.w=dot(e,vec2(0.5));}return coord.zw;}vec2 areaDiag(const in vec2 dist,const in vec2 e,const in float offset){vec2 texCoord=vec2(AREATEX_MAX_DISTANCE_DIAG,AREATEX_MAX_DISTANCE_DIAG)*e+dist;texCoord=AREATEX_PIXEL_SIZE*texCoord+0.5*AREATEX_PIXEL_SIZE;texCoord.x+=0.5;texCoord.y+=AREATEX_SUBTEX_SIZE*offset;return texture2D(areaTexture,texCoord).rg;}vec2 calculateDiagWeights(const in vec2 texCoord,const in vec2 e,const in vec4 subsampleIndices){vec2 weights=vec2(0.0);vec4 d;vec2 end;if(e.r>0.0){d.xz=searchDiag1(texCoord,vec2(-1.0,1.0),end);d.x+=float(end.y>0.9);}else{d.xz=vec2(0.0);}d.yw=searchDiag1(texCoord,vec2(1.0,-1.0),end);if(d.x+d.y>2.0){vec4 coords=vec4(-d.x+0.25,d.x,d.y,-d.y-0.25)*texelSize.xyxy+texCoord.xyxy;vec4 c;c.xy=sampleLevelZeroOffset(inputBuffer,coords.xy,vec2(-1,0)).rg;c.zw=sampleLevelZeroOffset(inputBuffer,coords.zw,vec2(1,0)).rg;c.yxwz=decodeDiagBilinearAccess(c.xyzw);vec2 cc=vec2(2.0)*c.xz+c.yw;movec(bvec2(step(0.9,d.zw)),cc,vec2(0.0));weights+=areaDiag(d.xy,cc,subsampleIndices.z);}d.xz=searchDiag2(texCoord,vec2(-1.0,-1.0),end);if(sampleLevelZeroOffset(inputBuffer,texCoord,vec2(1,0)).r>0.0){d.yw=searchDiag2(texCoord,vec2(1.0),end);d.y+=float(end.y>0.9);}else{d.yw=vec2(0.0);}if(d.x+d.y>2.0){vec4 coords=vec4(-d.x,-d.x,d.y,d.y)*texelSize.xyxy+texCoord.xyxy;vec4 c;c.x=sampleLevelZeroOffset(inputBuffer,coords.xy,vec2(-1,0)).g;c.y=sampleLevelZeroOffset(inputBuffer,coords.xy,vec2(0,-1)).r;c.zw=sampleLevelZeroOffset(inputBuffer,coords.zw,vec2(1,0)).gr;vec2 cc=vec2(2.0)*c.xz+c.yw;movec(bvec2(step(0.9,d.zw)),cc,vec2(0.0));weights+=areaDiag(d.xy,cc,subsampleIndices.w).gr;}return weights;}float searchLength(const in vec2 e,const in float offset){vec2 scale=SEARCHTEX_SIZE*vec2(0.5,-1.0);vec2 bias=SEARCHTEX_SIZE*vec2(offset,1.0);scale+=vec2(-1.0,1.0);bias+=vec2(0.5,-0.5);scale*=1.0/SEARCHTEX_PACKED_SIZE;bias*=1.0/SEARCHTEX_PACKED_SIZE;return texture2D(searchTexture,scale*e+bias).r;}float searchXLeft(in vec2 texCoord,const in float end){vec2 e=vec2(0.0,1.0);for(int i=0;i<MAX_SEARCH_STEPS_INT;++i){if(!(texCoord.x>end&&e.g>0.8281&&e.r==0.0)){break;}e=texture2D(inputBuffer,texCoord).rg;texCoord=vec2(-2.0,0.0)*texelSize+texCoord;}float offset=-(255.0/127.0)*searchLength(e,0.0)+3.25;return texelSize.x*offset+texCoord.x;}float searchXRight(vec2 texCoord,const in float end){vec2 e=vec2(0.0,1.0);for(int i=0;i<MAX_SEARCH_STEPS_INT;++i){if(!(texCoord.x<end&&e.g>0.8281&&e.r==0.0)){break;}e=texture2D(inputBuffer,texCoord).rg;texCoord=vec2(2.0,0.0)*texelSize.xy+texCoord;}float offset=-(255.0/127.0)*searchLength(e,0.5)+3.25;return-texelSize.x*offset+texCoord.x;}float searchYUp(vec2 texCoord,const in float end){vec2 e=vec2(1.0,0.0);for(int i=0;i<MAX_SEARCH_STEPS_INT;++i){if(!(texCoord.y>end&&e.r>0.8281&&e.g==0.0)){break;}e=texture2D(inputBuffer,texCoord).rg;texCoord=-vec2(0.0,2.0)*texelSize.xy+texCoord;}float offset=-(255.0/127.0)*searchLength(e.gr,0.0)+3.25;return texelSize.y*offset+texCoord.y;}float searchYDown(vec2 texCoord,const in float end){vec2 e=vec2(1.0,0.0);for(int i=0;i<MAX_SEARCH_STEPS_INT;i++){if(!(texCoord.y<end&&e.r>0.8281&&e.g==0.0)){break;}e=texture2D(inputBuffer,texCoord).rg;texCoord=vec2(0.0,2.0)*texelSize.xy+texCoord;}float offset=-(255.0/127.0)*searchLength(e.gr,0.5)+3.25;return-texelSize.y*offset+texCoord.y;}vec2 area(const in vec2 dist,const in float e1,const in float e2,const in float offset){vec2 texCoord=vec2(AREATEX_MAX_DISTANCE)*round(4.0*vec2(e1,e2))+dist;texCoord=AREATEX_PIXEL_SIZE*texCoord+0.5*AREATEX_PIXEL_SIZE;texCoord.y=AREATEX_SUBTEX_SIZE*offset+texCoord.y;return texture2D(areaTexture,texCoord).rg;}void detectHorizontalCornerPattern(inout vec2 weights,const in vec4 texCoord,const in vec2 d){\n#if !defined(DISABLE_CORNER_DETECTION)\nvec2 leftRight=step(d.xy,d.yx);vec2 rounding=(1.0-CORNER_ROUNDING_NORM)*leftRight;rounding/=leftRight.x+leftRight.y;vec2 factor=vec2(1.0);factor.x-=rounding.x*sampleLevelZeroOffset(inputBuffer,texCoord.xy,vec2(0,1)).r;factor.x-=rounding.y*sampleLevelZeroOffset(inputBuffer,texCoord.zw,vec2(1,1)).r;factor.y-=rounding.x*sampleLevelZeroOffset(inputBuffer,texCoord.xy,vec2(0,-2)).r;factor.y-=rounding.y*sampleLevelZeroOffset(inputBuffer,texCoord.zw,vec2(1,-2)).r;weights*=clamp(factor,0.0,1.0);\n#endif\n}void detectVerticalCornerPattern(inout vec2 weights,const in vec4 texCoord,const in vec2 d){\n#if !defined(DISABLE_CORNER_DETECTION)\nvec2 leftRight=step(d.xy,d.yx);vec2 rounding=(1.0-CORNER_ROUNDING_NORM)*leftRight;rounding/=leftRight.x+leftRight.y;vec2 factor=vec2(1.0);factor.x-=rounding.x*sampleLevelZeroOffset(inputBuffer,texCoord.xy,vec2(1,0)).g;factor.x-=rounding.y*sampleLevelZeroOffset(inputBuffer,texCoord.zw,vec2(1,1)).g;factor.y-=rounding.x*sampleLevelZeroOffset(inputBuffer,texCoord.xy,vec2(-2,0)).g;factor.y-=rounding.y*sampleLevelZeroOffset(inputBuffer,texCoord.zw,vec2(-2,1)).g;weights*=clamp(factor,0.0,1.0);\n#endif\n}void main(){vec4 weights=vec4(0.0);vec4 subsampleIndices=vec4(0.0);vec2 e=texture2D(inputBuffer,vUv).rg;if(e.g>0.0){\n#if !defined(DISABLE_DIAG_DETECTION)\nweights.rg=calculateDiagWeights(vUv,e,subsampleIndices);if(weights.r==-weights.g){\n#endif\nvec2 d;vec3 coords;coords.x=searchXLeft(vOffset[0].xy,vOffset[2].x);coords.y=vOffset[1].y;d.x=coords.x;float e1=texture2D(inputBuffer,coords.xy).r;coords.z=searchXRight(vOffset[0].zw,vOffset[2].y);d.y=coords.z;d=round(resolution.xx*d+-vPixCoord.xx);vec2 sqrtD=sqrt(abs(d));float e2=sampleLevelZeroOffset(inputBuffer,coords.zy,vec2(1,0)).r;weights.rg=area(sqrtD,e1,e2,subsampleIndices.y);coords.y=vUv.y;detectHorizontalCornerPattern(weights.rg,coords.xyzy,d);\n#if !defined(DISABLE_DIAG_DETECTION)\n}else{e.r=0.0;}\n#endif\n}if(e.r>0.0){vec2 d;vec3 coords;coords.y=searchYUp(vOffset[1].xy,vOffset[2].z);coords.x=vOffset[0].x;d.x=coords.y;float e1=texture2D(inputBuffer,coords.xy).g;coords.z=searchYDown(vOffset[1].zw,vOffset[2].w);d.y=coords.z;d=round(resolution.yy*d-vPixCoord.yy);vec2 sqrtD=sqrt(abs(d));float e2=sampleLevelZeroOffset(inputBuffer,coords.xz,vec2(0,1)).g;weights.ba=area(sqrtD,e1,e2,subsampleIndices.x);coords.x=vUv.x;detectVerticalCornerPattern(weights.ba,coords.xyxz,d);}gl_FragColor=weights;}",vertexShader:"uniform vec2 texelSize;uniform vec2 resolution;varying vec2 vUv;varying vec4 vOffset[3];varying vec2 vPixCoord;void main(){vUv=position.xy*0.5+0.5;vPixCoord=vUv*resolution;vOffset[0]=vUv.xyxy+texelSize.xyxy*vec4(-0.25,-0.125,1.25,-0.125);vOffset[1]=vUv.xyxy+texelSize.xyxy*vec4(-0.125,-0.25,-0.125,1.25);vOffset[2]=vec4(vOffset[0].xz,vOffset[1].yw)+vec4(-2.0,2.0,-2.0,2.0)*texelSize.xxyy*MAX_SEARCH_STEPS_FLOAT;gl_Position=vec4(position.xy,1.0,1.0);}"}),this.toneMapped=!1}set inputBuffer(e){this.uniforms.inputBuffer.value=e}setInputBuffer(e){this.uniforms.inputBuffer.value=e}get searchTexture(){return this.uniforms.searchTexture.value}set searchTexture(e){this.uniforms.searchTexture.value=e}get areaTexture(){return this.uniforms.areaTexture.value}set areaTexture(e){this.uniforms.areaTexture.value=e}setLookupTextures(e,t){this.searchTexture=e,this.areaTexture=t}get orthogonalSearchSteps(){return Number(this.defines.MAX_SEARCH_STEPS_INT)}set orthogonalSearchSteps(e){let t=Math.min(Math.max(e,0),112);this.defines.MAX_SEARCH_STEPS_INT=t.toFixed("0"),this.defines.MAX_SEARCH_STEPS_FLOAT=t.toFixed("1"),this.needsUpdate=!0}setOrthogonalSearchSteps(e){this.orthogonalSearchSteps=e}get diagonalSearchSteps(){return Number(this.defines.MAX_SEARCH_STEPS_DIAG_INT)}set diagonalSearchSteps(e){let t=Math.min(Math.max(e,0),20);this.defines.MAX_SEARCH_STEPS_DIAG_INT=t.toFixed("0"),this.defines.MAX_SEARCH_STEPS_DIAG_FLOAT=t.toFixed("1"),this.needsUpdate=!0}setDiagonalSearchSteps(e){this.diagonalSearchSteps=e}get diagonalDetection(){return void 0===this.defines.DISABLE_DIAG_DETECTION}set diagonalDetection(e){e?delete this.defines.DISABLE_DIAG_DETECTION:this.defines.DISABLE_DIAG_DETECTION="1",this.needsUpdate=!0}isDiagonalDetectionEnabled(){return this.diagonalDetection}setDiagonalDetectionEnabled(e){this.diagonalDetection=e}get cornerRounding(){return Number(this.defines.CORNER_ROUNDING)}set cornerRounding(e){let t=Math.min(Math.max(e,0),100);this.defines.CORNER_ROUNDING=t.toFixed("4"),this.defines.CORNER_ROUNDING_NORM=(t/100).toFixed("4"),this.needsUpdate=!0}setCornerRounding(e){this.cornerRounding=e}get cornerDetection(){return void 0===this.defines.DISABLE_CORNER_DETECTION}set cornerDetection(e){e?delete this.defines.DISABLE_CORNER_DETECTION:this.defines.DISABLE_CORNER_DETECTION="1",this.needsUpdate=!0}isCornerRoundingEnabled(){return this.cornerDetection}setCornerRoundingEnabled(e){this.cornerDetection=e}setSize(e,t){let n=this.uniforms;n.texelSize.value.set(1/e,1/t),n.resolution.value.set(e,t)}},fX=new kx,mX=null;var gX=class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Pass",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new CD,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:fX;this.name=e,this.renderer=null,this.scene=t,this.camera=n,this.screen=null,this.rtt=!0,this.needsSwap=!0,this.needsDepthTexture=!1,this.enabled=!0}get renderToScreen(){return!this.rtt}set renderToScreen(e){if(this.rtt===e){let t=this.getFullscreenMaterial();null!==t&&(t.needsUpdate=!0),this.rtt=!e}}setRenderer(e){this.renderer=e}isEnabled(){return this.enabled}setEnabled(e){this.enabled=e}get fullscreenMaterial(){return null!==this.screen?this.screen.material:null}set fullscreenMaterial(e){let t=this.screen;null!==t?t.material=e:(t=new Cx(function(){if(null===mX){let e=new Float32Array([-1,-1,0,3,-1,0,-1,3,0]),t=new Float32Array([0,0,2,0,0,2]);void 0!==(mX=new dx).setAttribute?(mX.setAttribute("position",new tx(e,3)),mX.setAttribute("uv",new tx(t,2))):(mX.addAttribute("position",new tx(e,3)),mX.addAttribute("uv",new tx(t,2)))}return mX}(),e),t.frustumCulled=!1,null===this.scene&&(this.scene=new CD),this.scene.add(t),this.screen=t)}getFullscreenMaterial(){return this.fullscreenMaterial}setFullscreenMaterial(e){this.fullscreenMaterial=e}getDepthTexture(){return null}setDepthTexture(e){}render(e,t,n,i,r){throw new Error("Render method not implemented!")}setSize(e,t){}initialize(e,t,n){}dispose(){for(let e of Object.keys(this)){let t=this[e];if(null!==t&&"object"==typeof t&&"function"==typeof t.dispose){if(t instanceof CD||t===this.renderer)continue;this[e].dispose()}}}},vX=class extends gX{constructor(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];super("CopyPass"),this.fullscreenMaterial=new iX,this.needsSwap=!1,this.renderTarget=e,void 0===e&&(this.renderTarget=new Iv(1,1,{minFilter:dg,magFilter:dg,stencilBuffer:!1,depthBuffer:!1}),this.renderTarget.texture.name="CopyPass.Target"),this.autoResize=t}get resize(){return this.autoResize}set resize(e){this.autoResize=e}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}setAutoResizeEnabled(e){this.autoResize=e}render(e,t,n,i,r){this.fullscreenMaterial.inputBuffer=t.texture,e.setRenderTarget(this.renderToScreen?null:this.renderTarget),e.render(this.scene,this.camera)}setSize(e,t){this.autoResize&&this.renderTarget.setSize(e,t)}initialize(e,t,n){void 0!==n&&(this.renderTarget.texture.type=n,n!==mg?this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1":e.outputEncoding===Ng&&(this.renderTarget.texture.encoding=Ng))}},yX=class extends gX{constructor(){super("ClearMaskPass",null,null),this.needsSwap=!1}render(e,t,n,i,r){let s=e.state.buffers.stencil;s.setLocked(!1),s.setTest(!1)}},xX=new Ev,bX=class extends gX{constructor(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];super("ClearPass",null,null),this.needsSwap=!1,this.color=e,this.depth=t,this.stencil=n,this.overrideClearColor=null,this.overrideClearAlpha=-1}setClearFlags(e,t,n){this.color=e,this.depth=t,this.stencil=n}getOverrideClearColor(){return this.overrideClearColor}setOverrideClearColor(e){this.overrideClearColor=e}getOverrideClearAlpha(){return this.overrideClearAlpha}setOverrideClearAlpha(e){this.overrideClearAlpha=e}render(e,t,n,i,r){let s=this.overrideClearColor,a=this.overrideClearAlpha,o=e.getClearAlpha(),l=null!==s,u=a>=0;l?(xX.copy(e.getClearColor(xX)),e.setClearColor(s,u?a:o)):u&&e.setClearAlpha(a),e.setRenderTarget(this.renderToScreen?null:t),e.clear(this.color,this.depth,this.stencil),l?e.setClearColor(xX,o):u&&e.setClearAlpha(o)}},wX=-1,DX=class extends Yg{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:wX,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:wX,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;super(),this.resizable=e,this.base=new lv(1,1),this.preferred=new lv(t,n),this.target=this.preferred,this.s=i}get width(){let e,{base:t,preferred:n,scale:i}=this;return e=n.width!==wX?n.width:n.height!==wX?Math.round(n.height*(t.width/Math.max(t.height,1))):Math.round(t.width*i),e}set width(e){this.preferredWidth=e}get height(){let e,{base:t,preferred:n,scale:i}=this;return e=n.height!==wX?n.height:n.width!==wX?Math.round(n.width/Math.max(t.width/Math.max(t.height,1),1)):Math.round(t.height*i),e}set height(e){this.preferredHeight=e}getWidth(){return this.width}getHeight(){return this.height}get scale(){return this.s}set scale(e){this.s!==e&&(this.s=e,this.preferred.setScalar(wX),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height))}getScale(){return this.scale}setScale(e){this.scale=e}get baseWidth(){return this.base.width}set baseWidth(e){this.base.width!==e&&(this.base.width=e,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height))}getBaseWidth(){return this.base.width}setBaseWidth(e){this.base.width!==e&&(this.base.width=e,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height))}get baseHeight(){return this.base.height}set baseHeight(e){this.base.height!==e&&(this.base.height=e,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height))}getBaseHeight(){return this.baseHeight}setBaseHeight(e){this.baseHeight=e}setBaseSize(e,t){(this.base.width!==e||this.base.height!==t)&&(this.base.set(e,t),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height))}get preferredWidth(){return this.preferred.width}set preferredWidth(e){this.preferred.width!==e&&(this.preferred.width=e,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height))}getPreferredWidth(){return this.preferredWidth}setPreferredWidth(e){this.preferredWidth=e}get preferredHeight(){return this.preferred.height}set preferredHeight(e){this.preferred.height!==e&&(this.preferred.height=e,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height))}getPreferredHeight(){return this.preferredHeight}setPreferredHeight(e){this.preferredHeight=e}setPreferredSize(e,t){(this.preferred.width!==e||this.preferred.height!==t)&&(this.preferred.set(e,t),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height))}copy(e){this.base.set(e.getBaseWidth(),e.getBaseHeight()),this.preferred.set(e.getPreferredWidth(),e.getPreferredHeight()),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height)}static get AUTO_SIZE(){return wX}},_X=!1,SX=class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.originalMaterials=new Map,this.material=null,this.materials=null,this.materialsBackSide=null,this.materialsDoubleSide=null,this.materialsFlatShaded=null,this.materialsFlatShadedBackSide=null,this.materialsFlatShadedDoubleSide=null,this.setMaterial(e),this.meshCount=0,this.replaceMaterial=e=>{if(e.isMesh){let t;if(e.material.flatShading)switch(e.material.side){case 2:t=this.materialsFlatShadedDoubleSide;break;case 1:t=this.materialsFlatShadedBackSide;break;default:t=this.materialsFlatShaded}else switch(e.material.side){case 2:t=this.materialsDoubleSide;break;case 1:t=this.materialsBackSide;break;default:t=this.materials}this.originalMaterials.set(e,e.material),e.isSkinnedMesh?e.material=t[2]:e.isInstancedMesh?e.material=t[1]:e.material=t[0],++this.meshCount}}}setMaterial(e){if(this.disposeMaterials(),this.material=e,null!==e){let t=this.materials=[e.clone(),e.clone(),e.clone()];for(let n of t)n.uniforms=Object.assign({},e.uniforms),n.side=0;t[2].skinning=!0,this.materialsBackSide=t.map((t=>{let n=t.clone();return n.uniforms=Object.assign({},e.uniforms),n.side=1,n})),this.materialsDoubleSide=t.map((t=>{let n=t.clone();return n.uniforms=Object.assign({},e.uniforms),n.side=2,n})),this.materialsFlatShaded=t.map((t=>{let n=t.clone();return n.uniforms=Object.assign({},e.uniforms),n.flatShading=!0,n})),this.materialsFlatShadedBackSide=t.map((t=>{let n=t.clone();return n.uniforms=Object.assign({},e.uniforms),n.flatShading=!0,n.side=1,n})),this.materialsFlatShadedDoubleSide=t.map((t=>{let n=t.clone();return n.uniforms=Object.assign({},e.uniforms),n.flatShading=!0,n.side=2,n}))}}render(e,t,n){let i=e.shadowMap.enabled;if(e.shadowMap.enabled=!1,_X){let i=this.originalMaterials;this.meshCount=0,t.traverse(this.replaceMaterial),e.render(t,n);for(let e of i)e[0].material=e[1];this.meshCount!==i.size&&i.clear()}else{let i=t.overrideMaterial;t.overrideMaterial=this.material,e.render(t,n),t.overrideMaterial=i}e.shadowMap.enabled=i}disposeMaterials(){if(null!==this.material){let e=this.materials.concat(this.materialsBackSide).concat(this.materialsDoubleSide).concat(this.materialsFlatShaded).concat(this.materialsFlatShadedBackSide).concat(this.materialsFlatShadedDoubleSide);for(let t of e)t.dispose()}}dispose(){this.originalMaterials.clear(),this.disposeMaterials()}static get workaroundEnabled(){return _X}static set workaroundEnabled(e){_X=e}},EX=class extends gX{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;super("RenderPass",e,t),this.needsSwap=!1,this.clearPass=new bX,this.overrideMaterialManager=null===n?null:new SX(n),this.ignoreBackground=!1,this.skipShadowMapUpdate=!1,this.selection=null}get renderToScreen(){return super.renderToScreen}set renderToScreen(e){super.renderToScreen=e,this.clearPass.renderToScreen=e}get overrideMaterial(){let e=this.overrideMaterialManager;return null!==e?e.material:null}set overrideMaterial(e){let t=this.overrideMaterialManager;null!==e?null!==t?t.setMaterial(e):this.overrideMaterialManager=new SX(e):null!==t&&(t.dispose(),this.overrideMaterialManager=null)}getOverrideMaterial(){return this.overrideMaterial}setOverrideMaterial(e){this.overrideMaterial=e}get clear(){return this.clearPass.enabled}set clear(e){this.clearPass.enabled=e}getSelection(){return this.selection}setSelection(e){this.selection=e}isBackgroundDisabled(){return this.ignoreBackground}setBackgroundDisabled(e){this.ignoreBackground=e}isShadowMapDisabled(){return this.skipShadowMapUpdate}setShadowMapDisabled(e){this.skipShadowMapUpdate=e}getClearPass(){return this.clearPass}render(e,t,n,i,r){let s=this.scene,a=this.camera,o=this.selection,l=a.layers.mask,u=s.background,c=e.shadowMap.autoUpdate,h=this.renderToScreen?null:t;null!==o&&a.layers.set(o.getLayer()),this.skipShadowMapUpdate&&(e.shadowMap.autoUpdate=!1),(this.ignoreBackground||null!==this.clearPass.overrideClearColor)&&(s.background=null),this.clearPass.enabled&&this.clearPass.render(e,t),e.setRenderTarget(h),null!==this.overrideMaterialManager?this.overrideMaterialManager.render(e,s,a):e.render(s,a),a.layers.mask=l,s.background=u,e.shadowMap.autoUpdate=c}},CX=class extends gX{constructor(e,t){let{resolutionScale:n=1,width:i=DX.AUTO_SIZE,height:r=DX.AUTO_SIZE,renderTarget:s}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};super("DepthPass"),this.needsSwap=!1,this.renderPass=new EX(e,t,new cD({depthPacking:3201}));let a=this.renderPass;a.skipShadowMapUpdate=!0,a.ignoreBackground=!0;let o=a.getClearPass();o.overrideClearColor=new Ev(16777215),o.overrideClearAlpha=1,this.renderTarget=s,void 0===this.renderTarget&&(this.renderTarget=new Iv(1,1,{minFilter:ug,magFilter:ug,stencilBuffer:!1}),this.renderTarget.texture.name="DepthPass.Target");let l=this.resolution=new DX(this,i,r,n);l.addEventListener("change",(e=>this.setSize(l.baseWidth,l.baseHeight)))}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}getResolution(){return this.resolution}getResolutionScale(){return this.resolution.scale}setResolutionScale(e){this.resolution.scale=e}render(e,t,n,i,r){let s=this.renderToScreen?null:this.renderTarget;this.renderPass.render(e,s)}setSize(e,t){let n=this.resolution;n.setBaseSize(e,t),this.renderTarget.setSize(n.width,n.height)}},AX=(new Float32Array([255/256/256**3,255/256/65536,255/256/256,255/256]),{SKIP:0,ADD:1,ALPHA:2,AVERAGE:3,COLOR_BURN:4,COLOR_DODGE:5,DARKEN:6,DIFFERENCE:7,EXCLUSION:8,LIGHTEN:9,MULTIPLY:10,DIVIDE:11,NEGATION:12,NORMAL:13,OVERLAY:14,REFLECT:15,SCREEN:16,SOFT_LIGHT:17,SUBTRACT:18}),MX=new Map([[AX.SKIP,null],[AX.ADD,"vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return min(x+y,1.0)*opacity+x*(1.0-opacity);}"],[AX.ALPHA,"vec3 blend(const in vec3 x,const in vec3 y,const in float opacity){return y*opacity+x*(1.0-opacity);}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){float a=min(y.a,opacity);return vec4(blend(x.rgb,y.rgb,a),max(x.a,a));}"],[AX.AVERAGE,"vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return(x+y)*0.5*opacity+x*(1.0-opacity);}"],[AX.COLOR_BURN,"float blend(const in float x,const in float y){return(y==0.0)?y:max(1.0-(1.0-x)/y,0.0);}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=vec4(blend(x.r,y.r),blend(x.g,y.g),blend(x.b,y.b),blend(x.a,y.a));return z*opacity+x*(1.0-opacity);}"],[AX.COLOR_DODGE,"float blend(const in float x,const in float y){return(y==1.0)?y:min(x/(1.0-y),1.0);}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=vec4(blend(x.r,y.r),blend(x.g,y.g),blend(x.b,y.b),blend(x.a,y.a));return z*opacity+x*(1.0-opacity);}"],[AX.DARKEN,"vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return min(x,y)*opacity+x*(1.0-opacity);}"],[AX.DIFFERENCE,"vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return abs(x-y)*opacity+x*(1.0-opacity);}"],[AX.EXCLUSION,"vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return(x+y-2.0*x*y)*opacity+x*(1.0-opacity);}"],[AX.LIGHTEN,"vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return max(x,y)*opacity+x*(1.0-opacity);}"],[AX.MULTIPLY,"vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return x*y*opacity+x*(1.0-opacity);}"],[AX.DIVIDE,"float blend(const in float x,const in float y){return(y>0.0)?min(x/y,1.0):1.0;}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=vec4(blend(x.r,y.r),blend(x.g,y.g),blend(x.b,y.b),blend(x.a,y.a));return z*opacity+x*(1.0-opacity);}"],[AX.NEGATION,"vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return(1.0-abs(1.0-x-y))*opacity+x*(1.0-opacity);}"],[AX.NORMAL,"vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return y*opacity+x*(1.0-opacity);}"],[AX.OVERLAY,"float blend(const in float x,const in float y){return(x<0.5)?(2.0*x*y):(1.0-2.0*(1.0-x)*(1.0-y));}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=vec4(blend(x.r,y.r),blend(x.g,y.g),blend(x.b,y.b),blend(x.a,y.a));return z*opacity+x*(1.0-opacity);}"],[AX.REFLECT,"float blend(const in float x,const in float y){return(y==1.0)?y:min(x*x/(1.0-y),1.0);}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=vec4(blend(x.r,y.r),blend(x.g,y.g),blend(x.b,y.b),blend(x.a,y.a));return z*opacity+x*(1.0-opacity);}"],[AX.SCREEN,"vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return(1.0-(1.0-x)*(1.0-y))*opacity+x*(1.0-opacity);}"],[AX.SOFT_LIGHT,"float blend(const in float x,const in float y){return(y<0.5)?(2.0*x*y+x*x*(1.0-2.0*y)):(sqrt(x)*(2.0*y-1.0)+2.0*x*(1.0-y));}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=vec4(blend(x.r,y.r),blend(x.g,y.g),blend(x.b,y.b),blend(x.a,y.a));return z*opacity+x*(1.0-opacity);}"],[AX.SUBTRACT,"vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return max(x+y-1.0,0.0)*opacity+x*(1.0-opacity);}"]]),TX=class extends Yg{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;super(),this.f=e,this.opacity=new pE(t)}getOpacity(){return this.opacity.value}setOpacity(e){this.opacity.value=e}get blendFunction(){return this.f}set blendFunction(e){this.f=e,this.dispatchEvent({type:"change"})}getBlendFunction(){return this.blendFunction}setBlendFunction(e){this.blendFunction=e}getShaderCode(){return MX.get(this.blendFunction)}},PX={NONE:0,DEPTH:1,CONVOLUTION:2},FX=class extends Yg{constructor(e,t){let{attributes:n=PX.NONE,blendFunction:i=AX.SCREEN,defines:r=new Map,uniforms:s=new Map,extensions:a=null,vertexShader:o=null}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};super(),this.name=e,this.renderer=null,this.attributes=n,this.fragmentShader=t,this.vertexShader=o,this.defines=r,this.uniforms=s,this.extensions=a,this.blendMode=new TX(i),this.blendMode.addEventListener("change",(e=>this.setChanged()))}getName(){return this.name}setRenderer(e){this.renderer=e}getDefines(){return this.defines}getUniforms(){return this.uniforms}getExtensions(){return this.extensions}getBlendMode(){return this.blendMode}getAttributes(){return this.attributes}setAttributes(e){this.attributes=e,this.setChanged()}getFragmentShader(){return this.fragmentShader}setFragmentShader(e){this.fragmentShader=e,this.setChanged()}getVertexShader(){return this.vertexShader}setVertexShader(e){this.vertexShader=e,this.setChanged()}setChanged(){this.dispatchEvent({type:"change"})}setDepthTexture(e){}update(e,t,n){}setSize(e,t){}initialize(e,t,n){}dispose(){for(let e of Object.keys(this)){let t=this[e];if(null!==t&&"object"==typeof t&&"function"==typeof t.dispose){if(t instanceof CD||t===this.renderer)continue;this[e].dispose()}}}};function OX(e,t,n){for(let i of t){let t="$1"+e+i.charAt(0).toUpperCase()+i.slice(1),r=new RegExp("([^\\.])(\\b"+i+"\\b)","g");for(let e of n.entries())null!==e[1]&&n.set(e[0],e[1].replace(r,t))}}function IX(e,t,n,i,r,s,a){let o=new Map([["fragment",t.getFragmentShader()],["vertex",t.getVertexShader()]]),l=void 0!==o.get("fragment")&&/mainImage/.test(o.get("fragment")),u=void 0!==o.get("fragment")&&/mainUv/.test(o.get("fragment")),c=[],h=[],d=!1,p=!1;if(void 0===o.get("fragment"))console.error("Missing fragment shader",t);else if(u&&0!==(a&PX.CONVOLUTION))console.error("Effects that transform UV coordinates are incompatible with convolution effects",t);else if(l||u){let f=/(?:\w+\s+(\w+)\([\w\s,]*\)\s*{[^}]+})/g,m=lX.Section;if(u){let t="\t".concat(e,"MainUv(UV);\n");n.set(m.FRAGMENT_MAIN_UV,n.get(m.FRAGMENT_MAIN_UV)+t),d=!0}if(null!==o.get("vertex")&&/mainSupport/.test(o.get("vertex"))){let t="\t".concat(e,"MainSupport(");t+=/mainSupport *\([\w\s]*?uv\s*?\)/.test(o.get("vertex"))?"vUv);\n":");\n",n.set(m.VERTEX_MAIN_SUPPORT,n.get(m.VERTEX_MAIN_SUPPORT)+t),c=c.concat([...o.get("vertex").matchAll(/(?:varying\s+\w+\s+(\w*))/g)].map((e=>e[1]))),h=h.concat(c).concat([...o.get("vertex").matchAll(f)].map((e=>e[1])))}h=h.concat([...o.get("fragment").matchAll(f)].map((e=>e[1]))),h=h.concat([...t.defines.keys()].map((e=>e.replace(/\([\w\s,]*\)/g,"")))),h=h.concat([...t.uniforms.keys()]),t.uniforms.forEach(((t,n)=>s.set(e+n.charAt(0).toUpperCase()+n.slice(1),t))),t.defines.forEach(((t,n)=>r.set(e+n.charAt(0).toUpperCase()+n.slice(1),t))),OX(e,h,r),OX(e,h,o);let g=t.blendMode;if(i.set(g.blendFunction,g),l){let t=/MainImage *\([\w\s,]*?depth[\w\s,]*?\)/,i="".concat(e,"MainImage(color0, UV, ");0!==(a&PX.DEPTH)&&t.test(o.get("fragment"))&&(i+="depth, ",p=!0),i+="color1);\n\t";let r=e+"BlendOpacity";s.set(r,g.opacity),i+="color0 = blend".concat(g.blendFunction,"(color0, color1, ").concat(r,");\n\n\t"),n.set(m.FRAGMENT_MAIN_IMAGE,n.get(m.FRAGMENT_MAIN_IMAGE)+i),i="uniform float ".concat(r,";\n\n"),n.set(m.FRAGMENT_HEAD,n.get(m.FRAGMENT_HEAD)+i)}n.set(m.FRAGMENT_HEAD,n.get(m.FRAGMENT_HEAD)+o.get("fragment")+"\n"),null!==o.get("vertex")&&n.set(m.VERTEX_HEAD,n.get(m.VERTEX_HEAD)+o.get("vertex")+"\n")}else console.error("The fragment shader contains neither a mainImage nor a mainUv function",t);return{varyings:c,transformedUv:d,readDepth:p}}var kX=class extends gX{constructor(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];super("EffectPass"),this.fullscreenMaterial=new lX(null,null,null,e),this.effects=n.sort(((e,t)=>t.attributes-e.attributes)),this.skipRendering=!1,this.uniformCount=0,this.varyingCount=0,this.minTime=1,this.maxTime=Number.POSITIVE_INFINITY}get encodeOutput(){return this.fullscreenMaterial.encodeOutput}set encodeOutput(e){this.fullscreenMaterial.encodeOutput=e}get dithering(){return this.fullscreenMaterial.dithering}set dithering(e){let t=this.fullscreenMaterial;t.dithering=e,t.needsUpdate=!0}verifyResources(){let e=this.renderer.capabilities,t=Math.min(e.maxFragmentUniforms,e.maxVertexUniforms);this.uniformCount>t&&console.warn("The current rendering context doesn't support more than "+t+" uniforms, but "+this.uniformCount+" were defined"),t=e.maxVaryings,this.varyingCount>t&&console.warn("The current rendering context doesn't support more than "+t+" varyings, but "+this.varyingCount+" were defined")}updateMaterial(){let e=lX.Section,t=new Map([[e.FRAGMENT_HEAD,""],[e.FRAGMENT_MAIN_UV,""],[e.FRAGMENT_MAIN_IMAGE,""],[e.VERTEX_HEAD,""],[e.VERTEX_MAIN_SUPPORT,""]]),n=new Map,i=new Map,r=new Map,s=new Set,a=0,o=0,l=0,u=!1,c=!1;for(let d of this.effects)if(d.blendMode.blendFunction===AX.SKIP)l|=d.getAttributes()&PX.DEPTH;else if(0!==(l&d.getAttributes()&PX.CONVOLUTION))console.error("Convolution effects cannot be merged",d);else{l|=d.getAttributes();let e=IX("e"+a++,d,t,n,i,r,l);if(o+=e.varyings.length,u=u||e.transformedUv,c=c||e.readDepth,null!==d.extensions)for(let t of d.extensions)s.add(t)}let h=/\bblend\b/g;for(let d of n.values()){let n=d.getShaderCode().replace(h,"blend".concat(d.blendFunction));t.set(e.FRAGMENT_HEAD,t.get(e.FRAGMENT_HEAD)+n+"\n")}if(0!==(l&PX.DEPTH)){if(c){let n="float depth = readDepth(UV);\n\n\t";t.set(e.FRAGMENT_MAIN_IMAGE,n+t.get(e.FRAGMENT_MAIN_IMAGE))}this.needsDepthTexture=null===this.getDepthTexture()}else this.needsDepthTexture=!1;if(u){let n="vec2 transformedUv = vUv;\n";t.set(e.FRAGMENT_MAIN_UV,n+t.get(e.FRAGMENT_MAIN_UV)),i.set("UV","transformedUv")}else i.set("UV","vUv");t.forEach(((e,t,n)=>n.set(t,e.trim().replace(/^#/,"\n#")))),this.uniformCount=r.size,this.varyingCount=o,this.skipRendering=0===a,this.needsSwap=!this.skipRendering,this.fullscreenMaterial.setShaderParts(t).setExtensions(s).setUniforms(r).setDefines(i)}recompile(){this.updateMaterial(),this.verifyResources()}getDepthTexture(){return this.fullscreenMaterial.depthBuffer}setDepthTexture(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:jg;this.fullscreenMaterial.depthBuffer=e,this.fullscreenMaterial.depthPacking=t;for(let n of this.effects)n.setDepthTexture(e,t)}render(e,t,n,i,r){for(let s of this.effects)s.update(e,t,i);if(!this.skipRendering||this.renderToScreen){let r=this.fullscreenMaterial;r.inputBuffer=t.texture,r.time+=i,e.setRenderTarget(this.renderToScreen?null:n),e.render(this.scene,this.camera)}}setSize(e,t){this.fullscreenMaterial.setSize(e,t);for(let n of this.effects)n.setSize(e,t)}initialize(e,t,n){this.renderer=e;for(let i of this.effects)i.initialize(e,t,n),i.addEventListener("change",(e=>this.handleEvent(e)));this.updateMaterial(),this.verifyResources(),void 0!==n&&n!==mg&&(this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1")}dispose(){super.dispose();for(let e of this.effects)e.dispose()}handleEvent(e){if("change"===e.type)this.recompile()}},BX=[new Float32Array([0,0]),new Float32Array([0,1,1]),new Float32Array([0,1,1,2]),new Float32Array([0,1,2,2,3]),new Float32Array([0,1,2,3,4,4,5]),new Float32Array([0,1,2,3,4,5,7,8,9,10])],RX=class extends gX{constructor(){let{resolutionScale:e=.5,width:t=DX.AUTO_SIZE,height:n=DX.AUTO_SIZE,kernelSize:i=VX.LARGE}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super("KawaseBlurPass"),this.renderTargetA=new Iv(1,1,{minFilter:dg,magFilter:dg,stencilBuffer:!1,depthBuffer:!1}),this.renderTargetA.texture.name="Blur.Target.A",this.renderTargetB=this.renderTargetA.clone(),this.renderTargetB.texture.name="Blur.Target.B";let r=this.resolution=new DX(this,t,n,e);r.addEventListener("change",(e=>this.setSize(r.baseWidth,r.baseHeight))),this.blurMaterial=new nX,this.ditheredBlurMaterial=new nX,this.ditheredBlurMaterial.uniforms.scale=this.blurMaterial.uniforms.scale,this.ditheredBlurMaterial.dithering=!0,this.dithering=!1,this.kernelSize=i}getResolution(){return this.resolution}get width(){return this.resolution.width}set width(e){this.resolution.preferredWidth=e}get height(){return this.resolution.height}set height(e){this.resolution.preferredHeight=e}get scale(){return this.blurMaterial.scale}set scale(e){this.blurMaterial.scale=e}getScale(){return this.blurMaterial.scale}setScale(e){this.blurMaterial.scale=e}getKernelSize(){return this.kernelSize}setKernelSize(e){this.kernelSize=e}getResolutionScale(){return this.resolution.scale}setResolutionScale(e){this.resolution.scale=e}render(e,t,n,i,r){let s,a,o=this.scene,l=this.camera,u=this.renderTargetA,c=this.renderTargetB,h=BX[this.kernelSize],d=this.blurMaterial,p=t;for(this.fullscreenMaterial=d,s=0,a=h.length-1;s<a;++s){let t=0===(1&s)?u:c;d.kernel=h[s],d.inputBuffer=p.texture,e.setRenderTarget(t),e.render(o,l),p=t}this.dithering&&(d=this.ditheredBlurMaterial,this.fullscreenMaterial=d),d.kernel=h[s],d.inputBuffer=p.texture,e.setRenderTarget(this.renderToScreen?null:n),e.render(o,l)}setSize(e,t){let n=this.resolution;n.setBaseSize(e,t);let i=n.width,r=n.height;this.renderTargetA.setSize(i,r),this.renderTargetB.setSize(i,r),this.blurMaterial.setSize(i,r),this.ditheredBlurMaterial.setSize(i,r)}initialize(e,t,n){void 0!==n&&(this.renderTargetA.texture.type=n,this.renderTargetB.texture.type=n,n!==mg?(this.blurMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1",this.ditheredBlurMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1"):e.outputEncoding===Ng&&(this.renderTargetA.texture.encoding=Ng,this.renderTargetB.texture.encoding=Ng))}static get AUTO_SIZE(){return DX.AUTO_SIZE}},LX=class extends gX{constructor(){let{width:e=DX.AUTO_SIZE,height:t=DX.AUTO_SIZE,renderTarget:n,luminanceRange:i,colorOutput:r}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super("LuminancePass"),this.fullscreenMaterial=new uX(r,i),this.needsSwap=!1,this.renderTarget=n,void 0===this.renderTarget&&(this.renderTarget=new Iv(1,1,{minFilter:dg,magFilter:dg,stencilBuffer:!1,depthBuffer:!1}),this.renderTarget.texture.name="LuminancePass.Target",this.renderTarget.texture.generateMipmaps=!1);let s=this.resolution=new DX(this,e,t);s.addEventListener("change",(e=>this.setSize(s.baseWidth,s.baseHeight)))}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}getResolution(){return this.resolution}render(e,t,n,i,r){this.fullscreenMaterial.inputBuffer=t.texture,e.setRenderTarget(this.renderToScreen?null:this.renderTarget),e.render(this.scene,this.camera)}setSize(e,t){let n=this.resolution;n.setBaseSize(e,t),this.renderTarget.setSize(n.width,n.height)}initialize(e,t,n){void 0!==n&&n!==mg&&(this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1")}},zX=class extends gX{constructor(e,t){super("MaskPass",e,t),this.needsSwap=!1,this.clearPass=new bX(!1,!1,!0),this.inverse=!1}get inverted(){return this.inverse}set inverted(e){this.inverse=e}get clear(){return this.clearPass.enabled}set clear(e){this.clearPass.enabled=e}getClearPass(){return this.clearPass}isInverted(){return this.inverted}setInverted(e){this.inverted=e}render(e,t,n,i,r){let s=e.getContext(),a=e.state.buffers,o=this.scene,l=this.camera,u=this.clearPass,c=this.inverted?0:1,h=1-c;a.color.setMask(!1),a.depth.setMask(!1),a.color.setLocked(!0),a.depth.setLocked(!0),a.stencil.setTest(!0),a.stencil.setOp(s.REPLACE,s.REPLACE,s.REPLACE),a.stencil.setFunc(s.ALWAYS,c,4294967295),a.stencil.setClear(h),a.stencil.setLocked(!0),this.clearPass.enabled&&(this.renderToScreen?u.render(e,null):(u.render(e,t),u.render(e,n))),this.renderToScreen?(e.setRenderTarget(null),e.render(o,l)):(e.setRenderTarget(t),e.render(o,l),e.setRenderTarget(n),e.render(o,l)),a.color.setLocked(!1),a.depth.setLocked(!1),a.stencil.setLocked(!1),a.stencil.setFunc(s.EQUAL,1,4294967295),a.stencil.setOp(s.KEEP,s.KEEP,s.KEEP),a.stencil.setLocked(!0)}},NX=class extends gX{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"inputBuffer";super("ShaderPass"),this.fullscreenMaterial=e,this.inputBufferUniform=null,this.setInput(t)}setInput(e){if(this.inputBufferUniform=null,null!==this.fullscreenMaterial){let t=this.fullscreenMaterial.uniforms;void 0!==t&&void 0!==t[e]&&(this.inputBufferUniform=t[e])}}render(e,t,n,i,r){null!==this.inputBufferUniform&&null!==t&&(this.inputBufferUniform.value=t.texture),e.setRenderTarget(this.renderToScreen?null:n),e.render(this.scene,this.camera)}initialize(e,t,n){void 0!==n&&n!==mg&&(this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1")}},jX=.001,UX=class{constructor(){this.previousTime=0,this.currentTime=0,this.delta=0,this.fixedDelta=1e3/60,this.elapsed=0,this.timescale=1,this.fixedDeltaEnabled=!1,this.autoReset=!1}setFixedDeltaEnabled(e){return this.fixedDeltaEnabled=e,this}isAutoResetEnabled(e){return this.autoReset}setAutoResetEnabled(e){return typeof document<"u"&&void 0!==document.hidden&&(e?document.addEventListener("visibilitychange",this):document.removeEventListener("visibilitychange",this),this.autoReset=e),this}getDelta(){return this.delta*jX}getFixedDelta(){return this.fixedDelta*jX}setFixedDelta(e){return this.fixedDelta=1e3*e,this}getElapsed(){return this.elapsed*jX}getTimescale(){return this.timescale}setTimescale(e){return this.timescale=e,this}update(e){return this.fixedDeltaEnabled?this.delta=this.fixedDelta:(this.previousTime=this.currentTime,this.currentTime=void 0!==e?e:performance.now(),this.delta=this.currentTime-this.previousTime),this.delta*=this.timescale,this.elapsed+=this.delta,this}reset(){return this.delta=0,this.elapsed=0,this.currentTime=performance.now(),this}handleEvent(e){document.hidden||(this.currentTime=performance.now())}dispose(){this.setAutoResetEnabled(!1)}},VX={VERY_SMALL:0,SMALL:1,MEDIUM:2,LARGE:3,VERY_LARGE:4,HUGE:5},HX=class extends FX{constructor(){let{blendFunction:e=AX.SCREEN,luminanceThreshold:t=.9,luminanceSmoothing:n=.025,resolutionScale:i=.5,intensity:r=1,width:s=DX.AUTO_SIZE,height:a=DX.AUTO_SIZE,kernelSize:o=VX.LARGE}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super("BloomEffect","#ifdef FRAMEBUFFER_PRECISION_HIGH\nuniform mediump sampler2D map;\n#else\nuniform lowp sampler2D map;\n#endif\nuniform float intensity;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){outputColor=clamp(texture2D(map,uv)*intensity,0.0,1.0);}",{blendFunction:e,uniforms:new Map([["map",new pE(null)],["intensity",new pE(r)]])}),this.renderTarget=new Iv(1,1,{minFilter:dg,magFilter:dg,stencilBuffer:!1,depthBuffer:!1}),this.renderTarget.texture.name="Bloom.Target",this.renderTarget.texture.generateMipmaps=!1,this.uniforms.get("map").value=this.renderTarget.texture,this.luminancePass=new LX({renderTarget:this.renderTarget,colorOutput:!0}),this.luminanceMaterial.threshold=t,this.luminanceMaterial.smoothingFactor=n,this.blurPass=new RX({resolutionScale:i,width:s,height:a,kernelSize:o});let l=this.blurPass.getResolution();l.addEventListener("change",(e=>this.setSize(l.baseWidth,l.baseHeight)))}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}get resolution(){return this.blurPass.resolution}getResolution(){return this.blurPass.resolution}getBlurPass(){return this.blurPass}getLuminancePass(){return this.luminancePass}get luminanceMaterial(){return this.luminancePass.fullscreenMaterial}getLuminanceMaterial(){return this.luminancePass.fullscreenMaterial}get width(){return this.resolution.width}set width(e){this.resolution.preferredWidth=e}get height(){return this.resolution.height}set height(e){this.resolution.preferredHeight=e}get dithering(){return this.blurPass.dithering}set dithering(e){this.blurPass.dithering=e}get kernelSize(){return this.blurPass.kernelSize}set kernelSize(e){this.blurPass.kernelSize=e}get distinction(){return console.warn(this.name,"distinction was removed"),1}set distinction(e){console.warn(this.name,"distinction was removed")}get intensity(){return this.uniforms.get("intensity").value}set intensity(e){this.uniforms.get("intensity").value=e}getIntensity(){return this.intensity}setIntensity(e){this.intensity=e}getResolutionScale(){return this.resolution.scale}setResolutionScale(e){this.resolution.scale=e}update(e,t,n){let i=this.renderTarget;this.luminancePass.enabled?(this.luminancePass.render(e,t,i),this.blurPass.render(e,i,i)):this.blurPass.render(e,t,i)}setSize(e,t){let n=this.resolution;n.setBaseSize(e,t),this.renderTarget.setSize(n.width,n.height),this.luminancePass.resolution.copy(n)}initialize(e,t,n){this.blurPass.initialize(e,t,n),void 0!==n&&(this.renderTarget.texture.type=n,e.outputEncoding===Ng&&(this.renderTarget.texture.encoding=Ng))}},WX=class extends FX{constructor(){let{blendFunction:e=AX.NORMAL,brightness:t=0,contrast:n=0}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super("BrightnessContrastEffect","uniform float brightness;uniform float contrast;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec3 color=inputColor.rgb+vec3(brightness-0.5);if(contrast>0.0){color/=vec3(1.0-contrast);}else{color*=vec3(1.0+contrast);}outputColor=vec4(min(color+vec3(0.5),1.0),inputColor.a);}",{blendFunction:e,uniforms:new Map([["brightness",new pE(t)],["contrast",new pE(n)]])})}get brightness(){return this.uniforms.get("brightness").value}set brightness(e){this.uniforms.get("brightness").value=e}getBrightness(e){return this.brightness}setBrightness(e){this.brightness=e}get contrast(){return this.uniforms.get("contrast").value}set contrast(e){this.uniforms.get("contrast").value=e}getContrast(e){return this.contrast}setContrast(e){this.contrast=e}},GX=class extends FX{constructor(){super("ColorAverageEffect","void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){outputColor=vec4(vec3(average(inputColor.rgb)),inputColor.a);}",{blendFunction:arguments.length>0&&void 0!==arguments[0]?arguments[0]:AX.NORMAL})}},qX=class extends FX{constructor(){let{blendFunction:e=AX.NORMAL,offset:t=new lv(.001,5e-4)}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super("ChromaticAberrationEffect","varying vec2 vUvR;varying vec2 vUvB;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec2 ra=texture2D(inputBuffer,vUvR).ra;vec2 ba=texture2D(inputBuffer,vUvB).ba;outputColor=vec4(ra.x,inputColor.g,ba.x,max(max(ra.y,ba.y),inputColor.a));}",{vertexShader:"uniform vec2 offset;varying vec2 vUvR;varying vec2 vUvB;void mainSupport(const in vec2 uv){vec2 shift=offset*vec2(1.0,aspect);vUvR=uv+shift;vUvB=uv-shift;}",blendFunction:e,attributes:PX.CONVOLUTION,uniforms:new Map([["offset",new pE(t)]])})}get offset(){return this.uniforms.get("offset").value}set offset(e){this.uniforms.get("offset").value=e}getOffset(){return this.offset}setOffset(e){this.offset=e}},YX=class extends FX{constructor(e){let{blendFunction:t=AX.NORMAL,worldFocusDistance:n,worldFocusRange:i,focusDistance:r=0,focalLength:s=.1,focusRange:a=s,bokehScale:o=1,width:l=DX.AUTO_SIZE,height:u=DX.AUTO_SIZE}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super("DepthOfFieldEffect","#ifdef FRAMEBUFFER_PRECISION_HIGH\nuniform mediump sampler2D nearColorBuffer;uniform mediump sampler2D farColorBuffer;\n#else\nuniform lowp sampler2D nearColorBuffer;uniform lowp sampler2D farColorBuffer;\n#endif\nuniform lowp sampler2D nearCoCBuffer;uniform float scale;void mainImage(const in vec4 inputColor,const in vec2 uv,const in float depth,out vec4 outputColor){vec4 colorNear=texture2D(nearColorBuffer,uv);vec4 colorFar=texture2D(farColorBuffer,uv);float CoCNear=texture2D(nearCoCBuffer,uv).r;CoCNear=min(CoCNear*scale,1.0);vec4 result=inputColor*(1.0-colorFar.a)+colorFar;result=mix(result,colorNear,CoCNear);outputColor=result;}",{blendFunction:t,attributes:PX.DEPTH,uniforms:new Map([["nearColorBuffer",new pE(null)],["farColorBuffer",new pE(null)],["nearCoCBuffer",new pE(null)],["scale",new pE(1)]])}),this.camera=e,this.renderTarget=new Iv(1,1,{minFilter:dg,magFilter:dg,stencilBuffer:!1,depthBuffer:!1}),this.renderTarget.texture.name="DoF.Intermediate",this.renderTarget.texture.generateMipmaps=!1,this.renderTargetMasked=this.renderTarget.clone(),this.renderTargetMasked.texture.name="DoF.Masked.Far",this.renderTargetNear=this.renderTarget.clone(),this.renderTargetNear.texture.name="DoF.Bokeh.Near",this.uniforms.get("nearColorBuffer").value=this.renderTargetNear.texture,this.renderTargetFar=this.renderTarget.clone(),this.renderTargetFar.texture.name="DoF.Bokeh.Far",this.uniforms.get("farColorBuffer").value=this.renderTargetFar.texture,this.renderTargetCoC=this.renderTarget.clone(),this.renderTargetCoC.texture.name="DoF.CoC",this.renderTargetCoCBlurred=this.renderTargetCoC.clone(),this.renderTargetCoCBlurred.texture.name="DoF.CoC.Blurred",this.uniforms.get("nearCoCBuffer").value=this.renderTargetCoCBlurred.texture,this.cocPass=new NX(new tX(e));let c=this.cocMaterial;c.focusDistance=r,c.focusRange=a,void 0!==n&&(c.worldFocusDistance=n),void 0!==i&&(c.worldFocusRange=i),this.blurPass=new RX({kernelSize:VX.MEDIUM,width:l,height:u});let h=this.blurPass.getResolution();h.addEventListener("change",(e=>this.setSize(h.getBaseWidth(),h.getBaseHeight()))),this.maskPass=new NX(new dX(this.renderTargetCoC.texture));let d=this.maskPass.fullscreenMaterial;d.maskFunction=hX,d.colorChannel=KY,this.bokehNearBasePass=new NX(new JY(!1,!0)),this.bokehNearBasePass.fullscreenMaterial.cocBuffer=this.renderTargetCoCBlurred.texture,this.bokehNearFillPass=new NX(new JY(!0,!0)),this.bokehNearFillPass.fullscreenMaterial.cocBuffer=this.renderTargetCoCBlurred.texture,this.bokehFarBasePass=new NX(new JY(!1,!1)),this.bokehFarBasePass.fullscreenMaterial.cocBuffer=this.renderTargetCoC.texture,this.bokehFarFillPass=new NX(new JY(!0,!1)),this.bokehFarFillPass.fullscreenMaterial.cocBuffer=this.renderTargetCoC.texture,this.target=null,this.bokehScale=o}get cocTexture(){return this.renderTargetCoC.texture}get cocMaterial(){return this.cocPass.fullscreenMaterial}get circleOfConfusionMaterial(){return this.cocMaterial}getCircleOfConfusionMaterial(){return this.circleOfConfusionMaterial}getBlurPass(){return this.blurPass}get resolution(){return this.blurPass.getResolution()}getResolution(){return this.blurPass.getResolution()}get bokehScale(){return this.uniforms.get("scale").value}set bokehScale(e){let t=[this.bokehNearBasePass,this.bokehNearFillPass,this.bokehFarBasePass,this.bokehFarFillPass];for(let n of t)n.fullscreenMaterial.setScale(e);this.maskPass.fullscreenMaterial.setStrength(e),this.uniforms.get("scale").value=e}getBokehScale(){return this.bokehScale}setBokehScale(e){this.bokehScale=e}getTarget(){return this.target}setTarget(e){this.target=e}calculateFocusDistance(e){let t=this.camera;return eX(-t.position.distanceTo(e),t.near,t.far)}setDepthTexture(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:jg;this.circleOfConfusionMaterial.depthBuffer=e,this.circleOfConfusionMaterial.depthPacking=t}update(e,t,n){let i=this.renderTarget,r=this.renderTargetCoC,s=this.renderTargetCoCBlurred,a=this.renderTargetMasked;if(null!==this.target){let e=this.calculateFocusDistance(this.target);this.circleOfConfusionMaterial.focusDistance=e}this.cocPass.render(e,null,r),this.blurPass.render(e,r,s),this.maskPass.render(e,t,a),this.bokehFarBasePass.render(e,a,i),this.bokehFarFillPass.render(e,i,this.renderTargetFar),this.bokehNearBasePass.render(e,t,i),this.bokehNearFillPass.render(e,i,this.renderTargetNear)}setSize(e,t){let n=this.resolution;n.setBaseSize(e,t);let i=n.width,r=n.height,s=[this.cocPass,this.blurPass,this.maskPass,this.bokehNearBasePass,this.bokehNearFillPass,this.bokehFarBasePass,this.bokehFarFillPass];s.push(this.renderTargetCoC,this.renderTargetMasked),s.forEach((n=>n.setSize(e,t))),s=[this.renderTarget,this.renderTargetNear,this.renderTargetFar,this.renderTargetCoCBlurred],s.forEach((e=>e.setSize(i,r))),[this.bokehNearBasePass,this.bokehNearFillPass,this.bokehFarBasePass,this.bokehFarFillPass].forEach((e=>e.fullscreenMaterial.setSize(i,r)))}initialize(e,t,n){[this.cocPass,this.maskPass,this.bokehNearBasePass,this.bokehNearFillPass,this.bokehFarBasePass,this.bokehFarFillPass].forEach((i=>i.initialize(e,t,n))),this.blurPass.initialize(e,t,mg),void 0!==n&&(this.renderTarget.texture.type=n,this.renderTargetNear.texture.type=n,this.renderTargetFar.texture.type=n,this.renderTargetMasked.texture.type=n,e.outputEncoding===Ng&&(this.renderTarget.texture.encoding=Ng,this.renderTargetNear.texture.encoding=Ng,this.renderTargetFar.texture.encoding=Ng,this.renderTargetMasked.texture.encoding=Ng))}},XX=(new Lv,new py,class extends FX{constructor(){let{blendFunction:e=AX.NORMAL,hue:t=0,saturation:n=0}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super("HueSaturationEffect","uniform vec3 hue;uniform float saturation;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec3 color=vec3(dot(inputColor.rgb,hue.xyz),dot(inputColor.rgb,hue.zxy),dot(inputColor.rgb,hue.yzx));float average=(color.r+color.g+color.b)/3.0;vec3 diff=average-color;if(saturation>0.0){color+=diff*(1.0-1.0/(1.001-saturation));}else{color+=diff*-saturation;}outputColor=vec4(min(color,1.0),inputColor.a);}",{blendFunction:e,uniforms:new Map([["hue",new pE(new Lv)],["saturation",new pE(n)]])}),this.hue=t}get saturation(){return this.uniforms.get("saturation").value}set saturation(e){this.uniforms.get("saturation").value=e}getSaturation(){return this.saturation}setSaturation(e){this.saturation=e}get hue(){let e=this.uniforms.get("hue").value;return Math.acos((3*e.x-1)/2)}set hue(e){let t=Math.sin(e),n=Math.cos(e);this.uniforms.get("hue").value.set((2*n+1)/3,(-Math.sqrt(3)*t-n+1)/3,(Math.sqrt(3)*t-n+1)/3)}getHue(){return this.hue}setHue(e){this.hue=e}}),QX=(new Ev,class extends FX{constructor(){let{blendFunction:e=AX.SCREEN,premultiply:t=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super("NoiseEffect","void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec3 noise=vec3(rand(uv*time));\n#ifdef PREMULTIPLY\noutputColor=vec4(min(inputColor.rgb*noise,vec3(1.0)),inputColor.a);\n#else\noutputColor=vec4(noise,inputColor.a);\n#endif\n}",{blendFunction:e}),this.premultiply=t}get premultiply(){return this.defines.has("PREMULTIPLY")}set premultiply(e){this.premultiply!==e&&(e?this.defines.set("PREMULTIPLY","1"):this.defines.delete("PREMULTIPLY"),this.setChanged())}isPremultiplied(){return this.premultiply}setPremultiplied(e){this.premultiply=e}}),KX=class extends FX{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:30;super("PixelationEffect","uniform bool active;uniform vec2 d;void mainUv(inout vec2 uv){if(active){uv=vec2(d.x*(floor(uv.x/d.x)+0.5),d.y*(floor(uv.y/d.y)+0.5));}}",{uniforms:new Map([["active",new pE(!1)],["d",new pE(new lv)]])}),this.resolution=new lv,this.d=0,this.granularity=e}get granularity(){return this.d}set granularity(e){let t=Math.floor(e);t%2>0&&(t+=1),this.d=t,this.uniforms.get("active").value=t>0,this.setSize(this.resolution.width,this.resolution.height)}getGranularity(){return this.granularity}setGranularity(e){this.granularity=e}setSize(e,t){this.resolution.set(e,t),this.uniforms.get("d").value.setScalar(this.d).divide(this.resolution)}},ZX=(Math.PI,new Lv,new Lv,"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAAAQCAYAAACm53kpAAAAeElEQVRYR+2XSwqAMAxEJ168ePEqwRSKhIIiuHjJqiU0gWE+1CQdApcVAMUAuARaMGCX1MIL/Ow13++9lW2s3mW9MWvsnWc/2fvGygwPAN4E8QzAA4CXAB6AHjG4JTHYI1ey3pcx6FHnEfhLDOIBKAmUBK6/ANUDTlROXAHd9EC1AAAAAElFTkSuQmCC"),JX="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAKAAAAIwCAYAAAABNmBHAAAgAElEQVR4Xuy9CbhlV1ktOvbpq09DkiIkUBI6kxASIH0DlAQiIK1wRfSJTx+i4JX7vKIigs8HXpXvqVcvrcC9agQ7IDTSSWgqCQQliDRBJKkkhDSkqVPNqVOnP+8b//rH3P+eZ+199tlznVTlvVrft7+1T7OaueZY42/m37QALKNk2wHg1pITlB17mC+Pp11W3X/LHyT32vhg48/5SOv+PnwpsHA70JoGlueB1iKApeqzvOzn44GatTB76Xzhd7suBR7+WWADgDEAwwCG/L54b/poDLrHuvvm70Z2Avhsc+PVcxscBU8F8C8ADg5+ipIjD/PlGwfgju8B924E5seARUfLsiNmqQW0IjL8+7L2NYD/7COBzfcCm+aB8SVgdAkYIRCXKyDax4EdAanL5PuNPllNvXDlAHwFgP8AcC2AhRIoDXbsYb48dl5WkVFTE3LGDcC9m4CZCWBuFFgeAZaGAYJQQCRqDHT+McJrVb8zwATUXH02MHYfMHEIGFsAxgjApQqACYQORjtd/B7Axt/z79sC0+cMPgjjlwPwVwHcA+DfAHzTxcVgWBroqMN8+cYBeM71wH0TwKExYHYUWCIAHYRLTlkCYgcIBcAgU/n3qy8GRu4HRgnAOWBkERhddPAJhGJDBxkvw7cqimr+zFM/ZLnZF64cgL8BYD+AWwB8x/dlWuWagHiYL984AJ/0RWBy1AE4AizyM1yxYAcTigW55xMbAkxEiwEdkJ/ZCQxPAiOHgBECcKEC4TBZcKkSv+mTieNcNPNC26mLNsj45QD8LQDTAO4GcJt/7iw2bfoG4WG+vAGwm9ExiEg69zpg/wgwPQLMjgALzn4E4aIzoJjQ9g4024uygkj+pyuAoX0VAIfngOH5NgCHMhAm8Sv2y3XDZeBhNIp8OzJE8OsBzAKYBHAXgDt8/4O+MVT0j4f58o0D8Pxrgf3DwMwIMEPQEYRkNwfgsuuDZLskip0No0gWMD/9HGDoADAkAC4Aw/wsAgZAgs2Z0ABI0GU6IVmKv+f28KDnHxkA/G0A8y6G73N9kOCjXnh/Ebb6OvgwX75xAF5wLTA1VIHPADgMLDj4yIA5AAm6aCUnv4oz46eeDwxNAUMzwJAz4BABSNDFTwSfg7DDKHE23MG5PqIY8A1u/dINs9dBdy8AgnGPM2NfUBrsnw7z5RsH4IXXAAcJviFgluAbygBINnSLWOAjGxJ4pgOKDV0v/OSLKp8iGXBovhLBBOCQM2ACoTOhnYrAdItYbCij5JFzRyIAqRccAnDAQUjg6UNQ7hsMXP0cRQAexss3DsCLCECCLwCQzMcPwUi2MwAScAKbfnY/YRLFQ8DHX+IAJAMSfDkAF13kLvleIjhjQQHxUVS3jjgGpKeeNzYVQEjgUS8k+PghONdhIwAP4+XXBYCHKIJbwJyDTgaIAdCBJx3Q2M8tYAHP9m4df/ylQOsQ0JqtRLCx30K1wtLBggScQOgsKBGcWHAJeOwRC0BSM1mQIKRbhh+Bj98JQP6t4U0APEyXXxcAEnxkQAFwoVUxID9kvQg+c1C7vidRbIDkc24B//hTQGumDcCWA5DgMxASdNIFBUI5pCML8v8API5zfEQx4BudgqiczviSnJhQwCP4BMCGl+wO8+U7AJi/W4O4YS6+pmK/2ciADsAOBhTIIiAJnPB7AvNjP+0AnANaYkAHX2JBAc+tYaJXOqBZv24Vc386XW5dtkHGW+4HFAJonpOe+YYQZAShgKjv3PNvPQaxVoI8zJdfFwASfPzMUwS3Kt1v0UFIlos6oDFdAGFcliMAP/ryAEAGNwQRnDOgLbdlIEwrIs6AZ/QgkMMHQF6ZAKQcJAsSYPwIeAIk9wJgoPK1gi7+PwF4GC/fOAAvIQPSs0URTPBJ/Pp3GSEGRHfBCIQ0xowBtUbcAj7ys5X4Jfu1HIAGQrIgQRXEsAFQIORDFhiDY/rMHmrU4QUgR08AkgUjCAW6CD6CkwBsAIQC4GG6fPMA3OXiNzCg2I9gNCMksmAAoemDzoimFwL48M85AKkiuQVMAAp8CYRRDAt8GQiJ67N6GJODAXAHlsGguscA2AJg1IPGYmxOpBxFWkRN9LsATgIwXnNs/v/5z/9XCf8BO3YAtxbc/46/KDt+5+ea1Yku2VUxHz/z0v24FwMGK1gWsK2OUUxHHdCBeRUB6OxHABr4ZICIBd0QWSF+XRdMTAjgCdTrG9cBNwE4F8CpDkICyYLGsuhFt6zs+gISwUen8zEAjgMw4cfx2H6O/90yAFo84Cbg4ID3/9TfLTt+5+ebnRABkODjx0SwPi5ec/FrYpmqSAxM8Dn60CsqAFI6GfhqAMiDE/gokmvEr0C4PgDkBQm40wE8zMFEUDKEVoxIMLl/KS73mE7H9d+vcKHQQcjwW0Yu9nP8m8sAmOIBuWY6wP2/4s0ezjjg8TuvaR6ABJ70vxUApGrm7EbGE+i472BAB+WHfqHS/eoAaEwY2E9+wLSXTqhI7CXgnB6LCoOJ4BiST+hTnG0HcCwAglCx3ARoZEVFXnBPp/O/A/hXACc7CPs9/i1lAOyIB+RDX+P9/+pbQjjjAMfv/PL6AFDs1wFAgs/9fgKfgdE/ZEpuiQlbwAde6QAMBgiRmsSwA9BY0JfjovGRDBMH4TlcXGhcBOc6HkF0gjPhZgchxTLZMAci/04W/B6Ab3t09EPXcPyflgFwRTwgJ2MN9/8bf5qFM67x+B/aW4XQz42FeL0YrRyikztUFw0704mf9kXgxhOAqc3AAsPyRxxQCs/PdXOFY0W1KHy3QIUGtx+6vdnx1vsB+dsTncm2AogglFgVEAlUWrOMB2RyEmMCGQ/Y7/HvKns6tfGAnJQ+r/9b76oJZ1zD8WdyQjYBh8aBhVEHjELouQ8ukQ7VRSCJAALwkr+sALhnGzDD3JAJYJHg9uhoi4bx8ytkWUtvHT/7+Zc4dw1uZ3612fH2dkQf7yxIEEockwkJQn4IQoq8unhAhmPRKKFx0uv4K8ueTs94wD7u//VX9ghn7OP4c+4G7h8HpseB+dF2AKlFLwuAIZ8jD6NPrOhAffmfA9/ZBuzZCkyRWSeqBCWyoYGQ5yQrBpDbum/ME1HoPo0XEkSD2zlfbna8q6+EUJcTCxKEtHL5EQjP6BEPyIgYAZBvYt3xHyx7OqvGA65y/7/9wVXCGVc5/sl7qxD66dEqiYgRzAqhN1A4CBNAAlDyAFI+iZ9/N3DLJuC+jcDUBmCWyUnOrmTYCMIOkNclLg0B8/RsNLg9+UvNjnd1APLmmQpFHyEBROuWACQT8nN+H/GAvY7/VNnT6SsesMf13/CpahGnZzhjj+PPmwX2MYdDIfQexWyBAwEUOQDrRDN/98p3A7dvAO6fAA5sqHJDBEAyoUVGkwEd6HR12XU4kwzfl6fCXTZzjy57vvnR513X7Hj7AyDvggAUi9EyFgiZqNxPQF6345nOWbD1HQ/Y5fpvuLa/2+82/vNHgAPDFQDnhoF5j2C2qBWCI8bw1eRw5CL5l94L3DEOTI4DB8Y9OWmsEu/zBJ3rgsaybqBob/7A4C7jtWcooRrczr+u2fH2D0AOQgAUCxKEP7aGgLy64+m6KdjWFA9Yc/03/Osa4glrjr+AupqHz1sEs0cxG0BC9HIePLoit9eNkVf9L+DuUWByDJgaq4ybGYLPAWgiXmLedUE7dwC7saL7CqfPKXi4NYdaykCD410bAHlDEsNiwZ9wAPYbkJcfz6T2gm3N8YDZ9d/wHxUA+739fPwXPrSKYGb+BuP3jAFDElFH9HIWwbzCIGkBr/or4J4RYO8oMOW6ZVcAuvi1Cgoha04BCwT5gfMKHm7NoRde2+x41w5A3hQZkADk5+cGiAeMx3+/7AENFA8Yrv/G71cAXFM4Yzj+otOAaQLQA0gZxaIIZtMDFTigKJV8H9Iq6aZ59ZXAvSPAvpEKgBTtBODcSCWCZeRYtpzrmLyeGNCAyFl1v+Hei8qeb370Rdc2O97BAMi7EgB/2QG41nhAHU9LuWAbOB7Qr//GPRUA13r7Gv9FZwIMoVcEswEwfDoimEP0shKKtIphaZQAXv1+YM+wA3DEdcvRKkGJADQQEsQuhi1Tjt95vBsh5nx2IO59SsHDrTmUOStNjndwAAqEry0IyCMICkOyiuIBNwBvPFQQT7gBuPjc9oRYAIHyOEL4vIFEYVNaOou5vCGE/tV/A0wOVcnpzI47NOri3QFIBpSeaSDUdYLOSWvYImSGgftpJDa4MWJbAGxivGUA5MAOc0Be6eVLj7/4Mk+hzCOYPYpZDBiNkLh+G/M3yFyv/ltgL3W3YQfgcFUhgRY2PwY+Z7/EhAR1SFyXCOb57r28QfQBsJQBMn5D4y0HYLPje9Cd7RIC0PM3EiMofF4gVCBp1P840ix/gyz56r+vAMjk9Gl375iB4+CzveuZdLkkEPJ8ZEfX/6R73vOjzT5Si9hucLxHAVg4PwJgRwh9CKOXK8YA4ZEqKZXSQWh5P+5AftXfA/uGKvYjCKn72cctbFrZNECka5L5CPwIPtMH3TVz17MLB5gdLgA2Nd6jACycHwLQxFEUSR5ASvARDB0h9AQb9bXIgCGk6lUfAPYTgEPAITKgg1BObk58srTJgG58WMkWMaAbQQT1nc8rHGANAJsc71EAFs4PAagQestgC1lsBJ4BMCSOK6dDUcwqqaFiQr/0QeAAAdjy+jBiQQeeMSBZT3nCPUDIa9z+/MIB1gCwyfEeBWDh/BCAeQSzgkjFfGLBBD5nxQ4DxN0wv3hVxX5TBGDwL5obxvVA5YqYL5BeMLd66YYxJpRB0gK+96LCAdYAsMnxHgVg4fwIgMrhUPKQ2C+Bz0PmBTqBMQehAbDlIjj4F80KJguSVZ0FuXpjoCOgXawLjALhbT9eOMAuAGxqvEcBWDg/l1IE05Ed0ygZnyHdz0VwCqEPIfNyx0QQvvLDFQCp+8nfZk5und8tXwIgWcHSNX0N2CJmnAl3v6RwgNnhl17T7HiPArBwfghAS7mV/hey2JS9FvM3BLpUUi1YwDRMXvkRYJoAlAh2l0dcZ04s6JUTDIjyBcrl4yDc/dLCAdYAsMnxHgVg4fxwKVwJgGEJNmWtxpQMpX9on2eRhVA+O56AjMfnP+e3Xvf3NwG4xIPTleiY55bpGh6UbafNU0l0z0p+5Jh5HqYJ6b51nP6XP8cx12XNHQVgIQB/bFPVg2OC7Q+WgVFWng/FvtWLI06uWh5oguKEcXVS/9sEAF//VGD7t4ETDgJbF4CNi8CGZWBs2fPL/H6Vwp2KEtVk4fJ+v/EIYPN9wKa5qu+IncfPwXHVZe/aOL3EbwS7xv8A1rQvnO0j8PArTgTGZ4BxFv9mIxhOCGsv+0OPYDRghcLfkWkEuq0+G00x4OtfDGz+d2DbHmDLjL8si8AYP/7CGIAiEEMTG92zXqSbH+d9R2aA0XnvO+JjthiIrOVDHHPOkBrzUQAWAPsZp3oPDpa/Xag6EVkLBK+5rAnJC3/nYk/APD704WiEAV8OTHwX2LQH2DgFbJgFNrBhjd8r79deGoEwsllgNBOzy8CdjweG9wBj08AIAci2D6HafmyAk4/Z7SJ72hGYRwFYAMDLTwOGp4FRFgD3HhzqRGQiyeurqOdG6r0Rm8IEZjzRlkiqCWoEgK8Axm4BJu4HJhyAbFhDxmbDGnZO4j0SgLGDkpibgEq66TJw/1nA0F5gdLpq+zDqFfd5LMeWqu5HNST0uJOIllg+qgMWgI+HPv0xwLA3gWHpW2sC441gCECbmKziaGrnUdMO4aHeh6MxAP4SMHI7ML4HGD8AjHvHJGNAgpDgY/ck3stipRemvVhc+uASMPUEYGh/9dIRgGx8Y+MNbR/00uVtH0wEx94j/v0oAxaA8Ed+GBieAYZZg5kADC0QWGOFzGJlcGPzl1BxNLXD8sk4xftwNAbA/wwM3wGMUmxOOQBnHXzetIYvibonmSiuYTNjriVg7glAiwBk0fNZH6+PmX9P6kfNmCXGpftJ7TgKwBIAnln14BAAYxMYm5C6RjCyCoOyr0qkD/c+HI0B8DXA8N3AyCQwesD1VQKH7EcASm1Q+y4CkN9pUKiVF5nLvy+fBbTUd8QBaH1HvNBROiZvfsNnrF4kcvPwpdsBLBeU18Nf7AB23Dp4ecHC8oBgUlJJecLS+7+WOpE3gbE+HKw+yoevCYkMGKqPJrdEKARutaFYRs1fiEZ0wP8CDN8LDO8FRqYq3W10pgKgfYLaYCzootgA6KXaTA90y374TKB1sBozy77xHFZ536utRgAmEaw6g5kUSFZwSXnA330qsOlfgHMPDlZesLA8IOjoLypPWHj/11EnCiVwkz7kAExtsGraYUWdSDX5TmsagL8KDBGA7Bd30JsW0oWivnEOQNP7yGTSBR101AlZSUtGyfgZDkCWY1HnJdcBVe6325hTvelg2CQjZNDygG/2An0j1wKnL6y9vGBheUC8prQ8YeH9X39OVQSc7Mc6fCaKvAeHdCIVf4yMYCynTpX+nb97NJmlSQb8r8DQHm9YOFUZTKOzoXGhs6AxF0HIexcLBvWBuiHN8s2ne98R3qc6L4Vyb2oBVjfm9MIFHbjDCh6kPOBbQoG+oW8CO5bWVl6wsDwgfr20PGHh/X/1iaEIuDcCTIW/1Q4rFv8OnYiW3c+W2iKwUjKbyjQNwL1uuR6sAEgDgq1brXOmV81PxhNB6DUDBSYzQJwFtz623XcktX1Q1VWKaTF/zZhVazBVYA1tX5MazsGvobwe/jQr0Ne6BTh5uf/ygoXlAfG60vKEhff/rSe1i4DnTWDUACY1guFTDqLYdCBvf6DJYSMYATBfOx1kLfj1v1axH10nQ3Sd0GUkBnTfpemtBJgseIKQAHLQcVxa2TnuMW0Aqui5es8xBIegVdVVE8VhzHnLh65WMB9An+X18K6aAn2tO4ETl6vqbKuVFywsDwhevqg8YeH93/Rk70JE90nowxZbIJjvS3WYNSGUwGHJTpPxwwcbBuBrgRYBeKACn7VtpdUu/c0NJxO9BIxcKu4TTODzbkonPLoaL0vyUQRb2y8HsL1ckfWzMeuFi40Qezqi+yiPhyt7FOjr6/gCFwgP7Xb5vssTFt7/nQRg6MGRWmDRoeyTlpgw68GRTwgZgo1gGmXAX6/8dtaylSKY/koyID9BhzML3q1gAos2AcOrZYSoq/pJp1VtODRm9Z3LS/7WjVkvXOzEtOpKyGrlAT+4SoG+VY8vBGCvy/dVnrDw/vee65NBJiAjBIVcAJQjOm+DkCZEeiGAMw6sAwDZsJrAdhFM9rPGhd4904Co5oVuCZPV6kD40Ec6+9W8dBTBsfdc3nkpvnB82fp2RPcs79dHgb51LA9ofsDV6vut5/3PnxcAmLVBiDqgevDaJLkYrpuQxzcNwN8AWgIgRbB8loEBzXDwl4cGiDGft58SCOWGedgjvOJ+bPvgRkiuA+ZjzhnQQOiFNVbloa7l/fos0LdO5QENgEXlCfs8Qbf7HyMA3QVjYihYhLENgjX9y/qwxQmRU/asfd0ZcLU2CHVGyusJQLKfVi98CS12T5f7iECkHpsMkAhCF8+nshWH2I/jXsOYO144GV/9ApAIrS3vt4YCfetQHtAA2G+/4PW4/2PPbzMgmUMi2NoeSCRxIt2/FvuxWURIWCXg357gfTjEDNIHnTRXRCpH5ugKwGl3HpMBXQc0v6WLYVm/5limj04rG762K2uYY9jBkr9+rI03NL5ZbczS/dJ+LQyoga4o77fGAn0NlwdMAOy3vl/T938KAcj121z8Bn+Y9eWQJRz8Y6kNagDh2ey5EvxjxQD8TWdAuneCCO4An1vw5vdzQMmdktwq7pLZQR+dM34+ZumAxvY1Y04uqOAJ6FsExzeto7zfAAX6GiwPaLWR1lrfr8n7f/Rl3QGzmsis+/uO71V9OFgP2gpPhgr7TGRqRUT6dyvr4aIs/pm/2zVUNbBSv6G8e5pEv0Cvec7Po7+bTtjlBRlkvAMBkDeQyvsNWKCvofKACYBrre/X1P0/oWEAnnFD1YdjhtXxR73mX10FfCHHE9pVWcGAI/S0gKsfA2y+twrFZw6Hxf/F0Pk8Ri/kpGSnMuDx5T0iACgQHioo0NdAecBUHW6QdsV2/cL7v/Cyqr5gnc42CCOcfX1VIZ/V8We9IDmTzVXwPDJiXuKXPxtDBma8+lzP4WAgKkPxCUAPE4v5GzEuMX0PYJPLhB6FJsc7MAMmkVxaYC/K9gG+F1++8AQ7Gwbgk78I7GFpXgIwFiRXOwaJZPUbiR0yCUDRk+cHf+YpwMj9HgfI8ClGPyvsSiH0WSKRuYlitLb/zHM/JOSs5C/YIC9cMQDZr/dwxgOW9gtGYUBi0wA8l304vDQvAchilFbpIBQhZ7Ejq6ZQ0/Yhil8y4j89Axie9DAsD6FX9HOK3QtROTFkviN83kG4felIY8DCeLrSeMDSfsEovAECUFsTjHD+tcB+tkFgcXKvBRir7qtFl9owmO4Xy/1G3bAFfPrZHorFNWBFwHjQAFctIghj2kBarw06If/+MM9ZqTN6DgsDojCerjQesLRfMApvoGkAWh8Ob/tgAPSKWCp8ngNQtadjmTdltvNvn3peFYhgQQgh+iUmEaUAUoXM1yRLmWuFLaE9Z+XIAWBhPF1pPGBpv2AU3kDTALzwmqo6qtVh9kJErAudABia38TC5wJgS2xIhAwBn3yhByL4EhzXfRXxYsDTJ4IvrNN2JFMxZcBzVo4cABbG05XGA5b2C0bhDTQNQLZBYH1AVsQSAAU+imI1obHyblnjG/kJk3U8BHz8xVUQAhnQIl5CyNgKAGp5LKSSCoAySh5Jj79vTagcxUaIBeRNe79g9gq+DXig4wGzy+PONfT7RWFA4noAkGXZVAhcBckJQgNgrLiaNb3paIDo1vHHX+oA9LQBi4DxJcOUPJUnTgU2NJUyROs8irGARxQAC+PpCtsFd40H/AEf0gMQkLgeACT41PiGoLOKqyrJq3K/Ya9mNyr5FusN/uPLPIeDa8Bc+w3rtyl4VFHaMZc3i9RWBM9jjzgAFsbTFbYLRmm/YBTeQNMAtD4cBKDXBTQGdAB2MGBo8SCLmEuS1AFVAJ3A/NhPt0PoCcA8bSDG76XI7aySg6JYuGfKwJHFgH0E5B3ueMCe/Y4L+xVHAOZ+9EHcEgQgwbeiEYx6jwTdz4qfu7EhEJqxGqruf/RnHIAEnxgwBM0aC8aUAYWNBRCmoIll4HTqO122QcZbrgMWxtMVtgvuOx6wa7/jwhtoGoDWh4MBJ16WN4lfr8AqI0TVV1O1fa9BbQzovkAy4Ed+NgCQUSxZCFWvCOaOFREXyUwZOPIA2GdA3uGOB6wPaOz+QPv5S+MA3OXiN9aclghW+d3IgupBF2pPqxcxGenDPxfSRh2ASiKKiVP2PaZScvAKoA0VDc6cOlIB2GdA3uGOB1zR77iwX/F6AFB9ONSOQW0frA50sILVcckWJyIDSgwPAVcJgFbYuZ3FJvAlEHbJ3IsgJLGedeBIA+AAAXmHOx6wo99xYb/i9QKg2iAIfDJEJHqj4SExbEty0gkdhB/6P9oZbBZIGiKYVb9GKaN50lRHBLOvhDxh/5EKwDUG5B3ueMB2QGM/grb7/6wHAPNGMAY+GSGUjC52VX2f2CD4+HO0gqkZfegXKgBaHkcWtS0AWii9xG1ImrLlN5XR8L8fmQD05BVrmEENmpYSP9QX+KHiqj2/82+HqqDWwnbBRfGATdzAegGwru2DpRq7Mzq2fpAf0Nq0Rl2wBXzglZ4yUAPAmDSVWDBPHQjLcgTqOZ6zUvdKHh4ruDCerox/Dnu7YqwXAC1NI/QcEQuK6WK/kdgCTGC0PYAP/KIDMBgglq+hIkrOfsaCviLSofcJgJ5AdM7kkSaCj/HqQKVIGvD4swF8bcBjmzjsaQ2H5D/6acBd9wALB4DFWWB5AVherMp4GKIYEOp7+26UF0aSfT/xYuDG7wDjrIpAERytXf2vajj7ueryQXSFl10K/ON3gIWDwCLvjfGB8Z54O+Ee4ve6513uB2R1yzsqC+twbC8HcNVhfAeaBuDP/TvwtS3A/ePAIfYFVlPq2HHTuyulZCTlhbjhETF5yxTQGgPGhoHhIWC4VSXGD3n0tLkMHXHxu+YyB+MlPwDuZs5K6FlsbCzdVO9DuKfkHM8AEkP7B8fOkwDcD+B7np42+JkGOvKdAL4E4K8P0zvQdET0b14D3DgB3D0B7B8HZka9WzrD88N6sFm+YcUjrn7E1ZDvMtF9DBgeAYaHgSGB0PNHCD4BLwLRsByAyX/ij0/dDUxuqlIG5hix7eFhvLcOVUAtyPSydAFmOQNe6EYGV/9ZESiKgIEgtbaD/gHALQC4ovY5r5KwtjOU/XfTAHzzLuCmIeDuMWDvKHBwpMoN0WQzNtAaYSs0K4ZlOSAjGG9kPjCBRwZ0ABKEBJexYAZEAU3A7Oi1BeDym4EDnjQ1TwCGWMW8MXcKks0YOyZNlQOQjcgYIUHllEzYQ0ktm+r6oz8G4F4AXwXwRd8/kO9A0wB8y65KmPxgGJgcqYJTKYpTv2CCzyddQJRDOjKivn+Deh8BF8BnwBtaCUA+YYEyAU8h+c6Az9gNHHRmrgOgmDA3jHQ+iWupCeUAvNSrA9HNwqx+muk9nJVNg/CTfrmbAPwbgK8D+PcHkIibjob5o13A3XypWsAkG1cPA9PDFQDZM1id0i1KxsWfOrKnAFXlifCFFMMRcASigOcs2MGAIfE9iWXplS6On7UbmPaUUTXQrgsVMzcRj5Folg2V5ayUA5BWYKwOxKUafnosWjcJwk+7W5F2EKvlE3xcXaNYfiCYsGkA/smuqug6hcleAnAImPbO6YwRpMgjCAVAm/yQmKTv5hNsAf/i7SyNBSl2a8Qv/4/M1yF+BZSYlNQCnnVrpbC+mToAACAASURBVJcaI7sOSEY2NpaDXLqpR+vE/OVksDgImgGgghHoYJbTWc7oJtFWc65/cg2AYvh2ALsB3AzgVv95nS/f4QdsIkT9T3cBrGtITWZfC5hqtQHInsEGQn3UDDvEDEY/ICf7SxMOrAg8T+c00JGkvHGd2DABUYZIAONzCUDppCFhSukCBsLQrFtZe/IixYQpSyEoJoqnuPWrVRAubQh83HNlZB23z7j1ywmj6CIIqUPxw2Xeu9bx2jx10wz4Z7sqTYZaDD8EIDuoE3hMVEphWg66JIp90k0sBxBcy+iPIIaT1RtEsHS/yIAqw+VSNPWQfe5tlVEk8auXgVa5BUsEJuT5uoliAbE5AGotmIAjCPnR9xDG3TQernYAUupTdBGEFMf83OkApHG+XlvTAPwfuyrgSZOhas3u6cwTsUBVn2gTwyFMi8wjHZAA1M9fYGHDULJD1m8Cpa8fRxDad+l+Ykf/3XNvd11U+qiL39SxXevSsshdDFvgbI1O2AwAtRZMZzTBRuDFjxe1Xg8QEIB8yyj5yYIUxfQIkfkIRnmHCM712JoG4FsdgHHp3ACoMH2G6jM4lWzoQarSvwQ6MSB/vporVaFkh+mCLlpVR8Z+dqDZLoDOpHSiQeAFDkBjPrlgCHgCUaFifg67H/9uYjn4Ai1vpTERTAASBaoQJBAKeNqHlL6mwPDZYAOROag/EYRkPX34MwHIvzW9rQcA+TLpI22G7EcQKlJGsYIJhC6ClUMiXfBTbFUQAej6nPS/OuAl9pOOqIc2BLzg++3VmWgIEUz82cRuCAtLIHQQm0gO52uOAb22sC3JEWgRfPpZf2sQBQIgLydPEIFGwPEj8MlF2bSbsulghLftqsCXq9HGgHysznrGgi5qzTUTFH8FLhAUn3hIJwCN0HLncw37qaF2zoYvuKNivmQIuUNc7GvWt6sHNs26twA6vhyq8NEMAHlyntFrDCcQehyaPTl+FwAbXDcmAKMRThakEk8Q8kPg8SPL0qzLBl+A9QCgR6uZGs3vfHz8TtBZvkgGQrEPBVAUg2Sij50QAOjiVKI3saADJRm7dSLYWfSFDkCem/dhZeMy9pPY5QvSDYQyUJoDIK8qMezh3wY6fSL49PcGgCAA8pScJLIgAUYQEmz8RPA17StvGoBv39W24eREiBoNQSgWNI1HBkdgxJSw1AI+dFIbgOYmkjimQ1r6XXC3rAbCHycAgytohf8vsB/r2KRaRq7zpZ+D37HMX0s3DDcCUGLYaw53MJ4YUODzusqlGCQAOQCejuxA8UULUkxIwAmMAp8Wa3qkN/R9W+sBwOhIEPjk5SLr8HeKFbTQfb77csPIMHGl/4MPbReslPhNe4+MiTpi9AFGV4nI7MfvagNQLh/pfrYnDAS8aJQ42A2w4em2cAyWQUuJVQTGWLs1uL7DG9J1RjhA+jvYk4t3KXeMqijpzrud4At9z3XtP16yGfjKZmCGooYh1tZzvv8xXPFl4PoJYC97k9FlwZWD+Azi/deMZWeP13eQCGEyoERudChIjbb3mJYwH7V0QIKuCwj/gfMj0asn2I0FXRSHXfL/iRkNgLyeVj8ccMY//J1fyxzTAXT2+xoQViKYD/1hDqLxPiYxTgSvQrphphG97tz4Slqafnj7uk1kIQDZrvWTw8B3jwEW+RLxPgSiCERdPwPR7+wCPg/gulFgfruDkOMQkFc5x84e708JAMmCuRNBXi4TIg5CGRzGiBGE/D4E/C2r2vcAYJoify62i0aJSMhB+2IHoNwu0fkcjQ85pu3ack5nIBREqneYFyWLkAXIJHESe00Cyx5QyeL6F/tyEcDcrOW2n7fX8df0mME+/vQ/PQjhoy3gzo3AISYf80MQaQx1peH9wb7v2mrtmCBkIMMejp3jIJD1MsaxaMZ8v5N/67INAsB3BAYU4JL4DSo1J15AFPAEwuQHZJzkKfUAtOHLJSOQRWndBYQvCQA01cfnNopfsaCJaD2baBn79QjSTiOEP1EcawIpkq2kegBTNgHWEpOKF8Uwq2NRFPM4AqCf46/rA2U9/uVDvurB01zvAJpiiwOl3fEeciCGF+Ij11f+QkbSfMPfIzqw57mEFZ9Dl3Ps5HXWAYByHJAJKV7N+s0cCQQhwSlfm4lGZ0KB8C/rABgZUS6ZHITBSEhCowUYAAksF7cStWREyxRwtuPpOlgw+5s9sq6OaIJIIlUgEhA1edoTgHxa9HVw5jibZNF+j/9yGQA/7pbujZ4bwv2+cWB6tFo0NzYnkxFA+cvEAo43VBoEo2e+48EMXEOmD9F6xhCE8RwZEJ80VblKvDlmzwicfqy93/o+8K8TwB2jVSgW138FrJQTXBNlnJgmrjZwanow9CBP/rL9wF0jwAGWDtFyoN9PHutnIHT05mPXz93dMGQAPniJsjiBXiTbxDZFMF9NLUPQxKR5qezz1Y6/YZDH0D6GkdAkYJIvRalAdHAMmPZoYhb6NhDWvEyf/ma737CXN7R1ZC7hUbPgcFgqt/ZZjADnM1xqEVhYBpb4CUk5UsL7jQvj///5buDrLeCOEeD+YQchYwG9VIfyg1NaZszFiCH6DkRGLze5/dgk8IMWcMCjdCiCzR8od1B8OTwvJM8JEShFut1fzMhi+eRJr6LI7hYP2M/xVLwKNoZjUTwRMAQQmYyhWGQxsSADOflZ4kukj7PhZ75bETjBpkAGahMkcrGgwhsXeCyBHBj1wmOBQwvAwqKzoFeRV8ZaerjKYAuirmPY/o9X7q5Cyr7fAvYMAftCPGAEoYlBiVtFwLjtp2U4irj7yOANbi+crHyrfCbTquJV44O0F1FrwQGIMZFqdQDyP/gGSZ8TC0ZRRsOlVzzgasd/u+zpMByLehAfCgMQCDyGZJHFCCgLZ2f8mgI5qauEcVx9e5vACTgCTwEMWr5TdIpWKJb5MvrnoocDswvAPAG4VLGg6UKeqmi4iuDz4er30oX0FP7u5moMvIf7W8B+jwlUNAzFnlZCIhvGFRCeWzrgXSSIBreXTFZSgVLHAp4UHOFuociEEsn2PJwl/XEk0dzfSojeerFg1IOo5BKAveIBex1P67lgUzgWQaJwLAKRH04i14ItgDKEtGsRnWx49b2Vkk9wUefTGrKCF7R0JxZMqxN8cmPAxWcAcxGABKEAKPA5u9lEaAbCmKMI+sDN1X3z+ro24wEZFc0VEE64ABgT180PF9ZdBcDb6JpqcPtPk+1ACbmKjJnllwyuILunEAWjZHkBsrsRUnfD0qEiC5IJfyisgMhzWhcP2O14Ro4WbASgAMQJ48SJwchmBCDFa8qpyBbSP7OvU4PQ0p2W7+LSnSJUFOrI4V7w5IoBTQQTfJ6oTSYk2mQcpGRyH2syGjIF6EM3V/fM++C1CfwUExhCsmzCaQT43lZC3e1hBpEHh36XEqrB7Scmq5dV0XZxmV8WuDFzAF9iwhow9seAGoBcGtKjqAc+1l9rLb/1igesO55ysmCrC8ei6IxRMAKTWNBi6Xw98xNTFUi0jEcmpYgRAPhddpVi9OIEPP5cYD4CcLkCooHPwaW9kV+iwWrQHT8uA1fd3F7DFvgUHUP2k8jTiogAqLoxFpDgbMj9jXSuN7i9dLIdaxzBp5XVBMIMgFEnFAPKT9qPd6A9BIGI7MfPmf4U+40HzI8nWgq2PBxL4FEkjKJixGRRFyQQPzzd1iAUzCAQas1YOmAEoFjwkecDC/PAwhKw6CxIkCXwOdVJLxTobMjBdyIgfvimNvNJ7Evf4jWtdnRYD1YNGVuG93VWuWs4Jf+mlZCCZxwP/cnJ6mXVKk2+tK8lQQVHRTGc64SDAZB3Ey3JcxyACkToJx4wHl+YwqloGDICmYmTFgMQFBET8yyYzyAG/AfWX8mCGQg0BTRoHwt9KVaPE/HQ890AIfgWK+CRAaMRYnVdxHbhdY8Wslw1V93UDsmPIj9GxgiAioRRMIJNvoti+SW/Ikd0gwAU8+XxJcbGITJPDvI6XdCFREFSknTB83xka40H1PGF9dnycCxFwygkK0bASJQSVAbAYeD98xUAe5U3jKIwBosSgNsuABYogl3/IwgFPrOIg1Xc4ZrpAsSrvruykl2ucykapkMMh4CExD5DwJfWAYAxwk4MKPAJgOIjGSEGwuCakRhemw6Yv0UUwRf7L00L9pnsNx6Qx4feY4O8pDEcixOjsoTKKpMYjSFYYjOC8Eq3Wnnr0YYS+0Tmi2HysrPGLqwASNYzBnT2Mz2QD91laxLB0gs12GAh81cf/o/OcHyJ+qj0S/zxnhUZbSyYWaL8+Rq2S29wowiWkJPan4MvgrDDGAlRe7KIywDIgR3meEDWg9HbJgApNTkXo8o0i7oVgxnEgFr8F7jEdnU5GvqfJQKQKyEOPlsNIQvyvupAGHS/Okv4qv9oh+PHxMLk8ggBCRxvAmEN+AiEzz2iQfQBeNmkh4K52hJBKOaNe/FSLobLRXCz43rQnu2yi9oMSMDxs2jo8303ERz1wsCGZECF4kd3DwEYYwJjhoNlQrgIjlYodbBPrwMAZfEmyzcIv27gs6XDzC/IR1DOgA9a6DRz4wZAsZ+LYXvQYsHoD4ziOFklna6YD3+nnU6dZ7bGDAcBUImIAmEUw/zbJ1i/scGNDJiLXmle3RhQ+l/aq57gUQCWzwwBKPeLsZ/LFrGg/ShRXAe64Ajkv30kALAjF8R11Dy3K7KRwJcsUTaqWScARou3w/INVnCH+A36n8RvM3nB5XP4oD6DATBYwGb5ajlOLOh6X8JaBKRG77+7ygGYp1bn+V25/01AzBnwQ1ypanD7KWfA1QDYC3zJIj7KgOUzc9nFbetX/r+O5biwNhyX5uSEDr5o0xsJwLp8/m4A7GaJUv/j3/5+HQFYJ3oFPPkho/hNeqBcMkcB2BAA6XrxmMBkfFAci/m0JpwzXw0TXvXtzrz+PKc/Ml/ugzM9MDqCAbz/keVjjGcQA/YLvjoguo1mRslRI6RwfsiA5nqhL5D6nscF8gfTdfxpS+/hLzvWfzMQCoB1Fq/8b3VWaPIDZqsRV64DALsZHVHs1gEvsqFAeBSApQC8pHK90Oql4UEAyvCwNeGcBXNLOPMLftgZsI75ouUr9ousp2TEyIJ/sU4AzC1e+WIFshyAHPZREVwItrrD3wGAhibTYBhxVpe/xePyrNBuWaoNp3DgFwC81O+RAepK/a5Lfe51jxr7JwA83nPXYgq1asl0yX5N48+f4VEGLATlK1vAo5YB1gBSRmsM+NFE57lcfPD5pPFWCJImtyvGgGfOAacBYO59zFglgHgPefZsXV6/gPXBYeC0RVgyJNOGYuJjPka9eHWgjL9bWzhWk0/n/wPn+k8bgFNmgYcsVflZnBRmIShtJM/m7JGibGBoOIIez9wKPP4AcNpylfbNlGfdI+9NjBjz8JVzppckZuJ+dBw4aQ44drk6j1LIY9JkPD7P4s2lwVEGLHwJnncscNIh4Nh5YMsSsHm5ndOu1BGFThJ8/K6JrZtoslST2+XHA6ftB05ZAE5crgAups5TfaL6EF+UyIif3gAcOwtsXep82eIYY9JkXpMgMp/AeZQBC2b8OduBYw8C2+aALQvARgJwGZhY7swEzbNa88IRvAVO1qkF91J36DNOBE7eD2yfB45fqphLnevzdGeBKBfL8UX5/CZgyyyweRHYsFwxYHzRNK6oetSBMDLjUQAWTPqPngpsnQK2zgKbCMAlYMMSME4ALrcnR6JYQIwsoUnjpDRstOLy7cBJB4CHUGwuAtuW2nUDVH1EFUhycSwWjGD64mZg0xywcaECoI0z5P3X5P6nWlHdgHgUgAUAfOYOYMtBYNMssHEe2LgITBCADkIzSJZXpCOnIg25uPrhgnupO/TyhwLHHwSOmwW2LVSik2pCrDsQskzNIBGIpBdGI+VfNgMb5oENCxX4yPRjPj4xaJ0+WGeEHRXBDUz2Mx4FbDoIbJypADixUAFwzAFI8KUJChMV2SUaAGc1cE/xFJef3FYRti64nkqWDrqqEhbrsm5zvZCdPCd8nHzJOLZuABRz9hTHZwPL7LnLnoNMIY2VyaKcjtZLHOAbNgNPngKe4BacfGF1pnydD+hphQ/8XV5UiEueLGnDN1tWXj/3/4cTwAUzwGPcRcFJiDpPt3FLmf5vjwE2HAQ2zPrEzDv7OQg5OSM+ScYQy5Xbo8465u/ZfLTJ7fKHAdumKxVh8wKwealSE6inEoSy2MWCdbUHIghv3AqMzwHji9VLZuDzD8cXxxWZs5c7apmW0fMBnIHKn5X7d6I5npvRz94O7LgXuGIReJSb+Xl1tzqflybwRwqf9i97BQRWomWJQ7oZVFtJoqDX/b/oGODsvcBTATB9gsfGqmzdjtVz+G+PAyamgYmZCoDjFE2anCVg1CeJwOMnTRB/DmUINVkkgia3y08BtkwDW+YqAFJFMD1VAAw6XG61R31O9/fdrcDYPDDmY0zjc1UjivBuAMx1QdMB+WAYXU8dhEU16dOSkppbcHFSrng8MHwnsGMPcN5ypURHp2xMIa7zDz2z8Gn/kVe0YomO0wEwBYKujL7v/zHA6C3AxfOVh58g5AsZxx4fZM7sf3h6BcDxWWeGBZ+cMEFiwGEHHRnDzun7ONHs/djkRgBunql0VDOSHIDU3cxSD4aEajhFXS4H4S1bgVGN0V8we7E0Fh9jVDG6Obr1LJMRwn+kOCaTEYT0dsfqZHXl/p7PrLi9wIY7gO0H2yAgCAWCWCowKrYE8nMLn/a7PQn9X7zIJPPkCcK+758y7x7guNsB6l98gZjLLYet3Ay5n0sv4R+fCYxPA2MOwLEAQLIDPyP8uBg2cRYmzFweAYilKkn+OC8/Fdh0CNhEA4nGA40kd6FES13WLO8v1qHKAfh9B+DoYjU2Ak/js/8NAIwg7OUb7LCC+WAfB4CpBJoIiTRNRmS1l13kqWh3Adv2A8cdqqp1MB+aIOSxWv6pq5D2kkIAvt8rF7BLJksN/jMqfa7v+7/Ak4B3A6ceqpasKMq5akAmlLWY37t8ZW97PDB2qALg2BxgAFwANEGcnI5JcrDZRPlkaXL4u1KJUAfAjbTQ59x6dSvdLPXAgGYshZWR6JIRaXB/NwFI8C1WwLMXzMeSwLfcXuKrA2G+wrLCDcN/IIg4ERRn0qvyySAQX6mG1XuA4fuAbTOVwktRRr2MLCoQyvEZ/UY/WwjAj3jtFJZkU79g1ghkgEBf98+0Umb/3A2M3lkBl/fOcdMok2EjkZyv8773LAfgHDDKjwNwxEUw9yailpwdxBAEYhBbAuGzG3aKkQEJwAkCkOCjlb7Y6SYyf2UwlAS+vKYnAXjfNmDEX7DEfA5CjUcsnzvbu1nDtUMmCDkRZEEyGdlAk6G6lQTSa6m0MP6HuY73AxNTlcJLZ6WOJYC5/CNxLpHMgdKIKNl69Qvu6/75AjHOiTU87gKOOViJb748BKCWrnK/maTA+58AjM0Ao7PA6Lx/xBAupoYDC9okBRAmPdBZ47lNA/DhwMRsxX7mPgl+SrmK5EaRNRslXFQ9CKB9DkADn79cZtkHFkysJ103eBbqlh97DpmTQTYgk9VNxu+xYbXKU3lhFoJPOgdFGY+lPkgQxokkgF9Xgj4AvfoFs84eX4Ke9x9fIC+tRfDxvvniif358sSir2LCj5wNjBKAc8CIi2AxxLCzIAGY9L7AhGIKgpATw4l8wToB0JjPrfTkp+SLQbHrOqm5jNyajS6VCMIpApDAWwQ4LrGgXqzIfnq5cv0vN0ZXHTInME5GBNLb1DGdOYQsI7AfGKFjlgqve8wJwG4T+fuFAFytXzCLb+VgWnH/fIGYfc46Hs7iHC8ZkPcdXx4VfVXJw8+cA4wIgM6AHSLKWZCTESfLfg7WsIyRF3ckiRQ+HACXkwHptyP4KHrpJvKVGnOhRF9eBF9wE0mUEogz2wC+WGI/vVxiQQIxAs9+rmHA6E1YFYB8DJwQMZl0OrLZ++i7sfT8zroYHLS9df4RACWKxSZvLXzG/fQLZqk2gqn2/vUCUQ9UZaM9wDaPeSPrC4A5C1KV+NITKwCS/SiCR/jRBDlLmP7nHynsxno1IPwJSyRpbiMADXzuPDYfZfBTEoAmcuVQdiaW0zwXwQsCYDYmMaDA1wG8TBSvaoR0G77EcGSET6hjOvVApfRPAUN0zjr45JzVcSqiTxD+VeGzXku/4Nr7JwDJOkxFIwt6j6+RqUrlkO4bXzp1gCAAv04AzgLDDsBhKugLFUvQUhTwCEKbnKCw14HwJ9cDgGQ9WegRgDI8XEcVEDvAl7lVlglAgi+I4CR+Zf1mLGgMmDFhBGFfDCicRJFERviSABjLS7FC0MFKMU+07wOPE0kGvaoQgGvtF9z1/iODkwn3VWoEXxres5ib9xx1wZufBAwLgAQexbAD0JiQwJOuJBA68/H3Zhk6+3CifqqwWNMKN8wjKgbk6gWJgC+FMaBb5vJVmsUbV2vCqo3cRWZcCIACoax53+ulkqNd7iqOcU1WcC9cxEm5kQBUdZ+sTnSL/jEtTWngi21jhJNJBivZBukXvOL+yYBkcOqxKjJ4AGgxzMrBVwdAMmHrZOAYF2l6y/mwV6xD17zmWo6MbRyeWtOHwxJ91IIhr6rqZS70DPPLXDVUrfBwzHKr1EUp6/h0T/6L/GcCqslt4IhoTcwdAqDSs7I60WQH6R329pHuFyuXDJmEjuOSbdB+wSvuP5bGUjmsA5XoUvcvBXKKAQnApUdXwah0b8jXR2YzJTsC0ZHB33FL+2yiX3h/1YeD1fFZGT81g/H6yqkVa9YEpqMhTADle8erHA6t7Mh6j4ZBXdBGjFyO4CSIm9wGBiBvgqxwIAJQlXIyEJLyI/i0SkAG/FbhaEr6BXfcv+5dLKhCg4z1C1HEBJ8+BODQGZXfk/quAZC6ketAZEQCTWAU8PIJt0fgwHzZvVWNaKqi7JLOmtDWFy42g1FxH/XfqGkII0C+a0tnDkfsGxQjn3VPsk7tXmuy+Xp0JhtoJosAaFcUAJUYKiYJxcqHqKAH9rPlG2cMrmCUbMX9guMLpGTcCMKDlZGhMK8IPnPIn1X5PA2AwegwEEYmDGBMjOI5whGQP3NPBT7VJlRNaKvF4t2IWHbDErtDlSk1p4lJ7/zd246tglGZryIfrFhQ7pU8WCAX0ZENG+57U14Z4YrCeLrSxXdev6TfLwrbxT7znMrfKQXfHLQCnyvmRIv0Q3430ezMmL98P393G3wqz6am1NYzzoGn+svqRmTAU2citctqAX/2EI8F9ACEmLHXLZGoFxtSl2xyK2bAYwrj6Xr12+1noL/jUTCD9vvFrn6u0v1/nvGkaoVBAQi0eummMAuXQHMWJAA7gCixG8U0gFfcXdlBKk4Z6zELgAJfZEKrxpC1xOIl/+Sk7jkcdYlSco90y9+gK6vJrRiADD0piad7RuFo3udNCgft94vCdrGXn+tujgV3QAcHLcFnroelivHkchEL8ue0uQ74S3eubAITS3IQhKkMRjBMokgWG3L//2z3VSnP4VDgQWxUEEUxAZFHL0eR3HDfm3IRbDHkBfF0zy4EIKNhSvr9goGEBdvTz/MIYQLQdVsTwRTFDj5jQmdArRDYJQNDSs961R3tPhx5NXoVgoxleHnarjohgLec3D2HI492yQNvIwvqO9fJm9zKGbAwnu6FhaP5pFuMg/b7tTbpBdvTz68cz/zI8azVj8iAHTqgmFHXDUB89R2dtaC7tUGw4kDOgFb0R2wYRDGZ8g9O8aU4XwPOczhiwGlMjqqLWiFYGu570wADFsbTvaxg8nkow7E8nM/atfKzln6/1mS4YHv6BQ4+Z0BbqHcd0NwwYbVD3+1yWhXJxPBrbq8AqE/XApSqAxiBV2MZ/54DMOZwKE00rnDUWcR5KiV/brjtSAMALIyn+/mCyeehjIYp6fdrvVELth8RAClyHXxmhPi6r1m8FM0ucgk8+y4RHC1kAK/5XgW+2hZYofafWcPq1B5AqDqEYsQ3nepR2gqhV2yiol1COkD0C+aOaoGx4aL7DQCwMJ7uVwomn4fm7VrX2u/XAlELth+5sHPtN+l/Ap6sX2dCsZ/phZkIJgv9l++1wbcq+2WFv2NXIjNKAPzuw7MUAV8DTuynFIEsQy83RgTAhiv+NgBABaQOGE/3mwWTLwAqHnaQfr9GnwUbARgDNBUlkpzQboyYCyYDYdILdf0l4NduW9kGoa4geNdazLElKoA3Prx7DofiETtC6XvE7hGEzJlpcis3Qgrj6d5UOJoYDcMglrX2+y0NPtl5UZUjkfx/Hqbecoe0OZzdF1gHQrln9Bhee4s3f3Zxm4MvAk9VSFdUIw0i+Q2PaBtISiBSSFgCYMjMW00MP7pwvvLDmwFgQTzdHxcOSGvBg/b7ZRZByWYAlOERluKM3Ra9CKWc0q73dTBhMFT4ZwIw9l5Lrpes+HjeBiGCUOKXeuBvPcKTiEIOR0f+RhDBMYi0Lhea4GTaa5NbOQAVDzhgPB1La5RssV3rIP1+7yy5OAADoAchEHBkFbKfGRpiweAPtMs5IFNokyOGk/7rAYC9OhBFwNXVY1at5tftCBHaWVS2AJdEcEinrDNC+Lumiyc1B8AB4+muLARAXTDCWvr93lR4/Z0Xt6ODFQkj8WtumEwHTKDLQejAfN3uds/dfjoQdatGLxb8jQBAYz6/boxiFgAVudzNIc2/s3xLk1szAORoB4yn+2DhaATAGJCtbpkCYq9+v4V+aBgAQ4i66XtaC85YkDog/zdZvzUgfN1N7a633Xqv6fe9msDIHfNaB6Ay2JRE1AHAEDIfI5nzZCLeN4Nbm9yaA+CA8XSsul6yqV0rJ2WQfr+splCyCYBR/HJyKX4phs0PKBZ0lqOYTpvniAiUAmAd+HKjo1cvDjHgr+3wPJQsVCymUZrPMuRsRBDG4AQCsunyJtFGHwAAIABJREFUcc0BUJlxQoH62q8ST8cggpKNAFRGwCD9fkuvbwAkyGgJE3C+Nz1P1q9/T3F1EZBxvZh50s6AEYC5yyUHXt5/Q8zI5/KrAmAIkkipkyGPYwXz1aRT8v5ZO6jJrRyAvKOvNXlLazsXs9bo/ztc29Pohgotp5J49Rcj/pzfIwGS//3OM4CNd1dpntQpFUmjEH4LYIgnyn/OLjL8FeDGhwJbNgFjI8DIEDA8BAy1PFK7FSKf43cNKrvHx+8C/vmxwMgmYHgEaA35J0StpvvzL/nP8RbLAfhyT207TChgDRiu/ZL9DsfWNABvYzbhCDBKoBAk/pEobGWTqp819hzQ1/0k0PoaMDEJbJjxVZFgDad0SaUO5LksWVj+XScDmw5UEUDJ6U4d0nVbC91S3ovfVHp5al64cgC+k7mZAP768KCA0WD3A/ieLz090CDceVmlAuhBljLgrfcAw6PAyDAwPFwBkCAbItM4a/FiNtERjBl76W9ffD2AbwJDdwFj+6syImRXrd5Y2FjIYcnzWPLEqnsfC0zsr6qBMQmfIDR/pyJ6xMhKyMrSDiKD2xja6TADTt0/AGAs1KcAUCFrOLF6tbtiRVFavT/wuMCa7MfVTlH098YBeBcwNAIMEYAUlS4uBULOmK3LCnwOPANlEIOSoF9+C4DvVoWXhvdWZVOYqWgi3vOXDUQhgieB0EElViMYJ08HxqeqnG8D4IIDkAzo51DKQQJvBKUmKACzbM4+5hUivwrgiwC4LzvjmgCh6nBcgiMTcv9Abo0D8E6g5eCjfpUA6AxoQIzgi8ALmWwC4z//DxcPPwBak8DQFDB8yJPpPZHeGCyC0KN5DFCByfh9/+OAsekKgEzCTwD047X0SCPM1IYQjCv2E/MJoGVwUUQoPboq0MdqkWVn7RtDDMahB4g+P6qhXFpjVtkDtRGA2nKjos7IyOyHFUbIrXe0FXsTuzIYfNb4O2M3ATGIYQOmPn6hG6gi3eUkQQAeAIYOAUOzALMVh2pAlESqGFBAXAYOMQVjxll03iO/yYKRAT0FQXkwZkjp1pz51LO2XAT3KtD3AIAwj4Wg05kfiuUHYlsXAJLVnP0INLM0OYFx78AzcRySeTsw2AJueI+Dj2Fne4EWKz5MA0MzDkCCkAByUWqsJzarEanzj2zXwjEGFHuGY+pYsMojzZL1G9EBexXou339IRBrC3lJGmNDuSHX+w7WC4Cm6wWxm8DngLTImgC8pBcGBuTXf/1fXnyTugnFwxTQOgi0CECyIFlsvvJfEnh0mhsYI/s5uxFYi1xZof7oOqSAawwYjRGBzYGXbtWXaCIrlvHUagX6SP/ruMVYCEbEqECXAMjfree2HgA0ESur1/0vtnNwGSsG0RsZME20/+/XWH6Mugk/yngPAGy5GDYALjiIHIgRUIrsZjM7Ax+BSx1S4pfffQVIep8dL7dMDsTGjJB+CvQxTHmdtrw4l0CovFruC2NOe975egDQsCXRK/eK634JhBK90q2C7I1i+Gt0jxF40k1cPJAB7UP2m3MGJAAFQrGei9iUTH9yBUDTHfU3B5+BOIKQ43BWtNtPcWIOzEZE8FoK9K0DCGNxLi3FqaKA9gTgeoFwPQAoI0OulWT11oEwiFz7cwbErzNxWtEYBB+VY76Vh4DWrH8IOoGQ7Ocg1CqMRLPltmxvs1/SHaP4dcAJePYyyUCRIzrTB8tE8FoL9DUMwl61kQQ87Rmy2PS2rgB0a1ci18RudEJH57OsY02y/+83/sZdBKr4FXQTApBvprGgQCg9UEAM+h9F6ugJDkC3gJPBEvRGrYoYCBX9IxEcS5K4i6cZAHIw8oXQ4mLBb35YH5d7OekadtTV1UZSjaEIPH4nQzYNwgjAHNwDuWGYpZc7lzPfX1cQur5oBorfzDf+zi0yVTuSkuxBI2Q+PhQDIUEnMLo1TBCZLufGw/ixbQa0KB8CTODjPohdY78IQmfDjmW7Yo/doAX6GqIiAtDHaYswSmeMubV81kp11L6hy2PdAcgblfslOKC1IiKRmyRxZgV/8++DS8BFrxXi5Hd/U6MeSKdqEsEKhpBRsgRMbAtuG4KU/+9ry5brzP/lPVMv1EPOQegharrVcgZUhVHFxNPcp9VFtlOWkL437C0WABWypFRGsV0sb5Hn2zYBwvUGoKl10v1knDgo0y7XA8Pfv0UACnjaK33Co9gJQAOe64FkNvtZAHQdjz9v2Nz2GSa3jYej2W3KGuZ9ixGdIVSoKT13B2s5AHkGheST6qn0erHv5AIgAAU+LVfw/wq3CEAV7clBKDDGZG9/5oVXx/oyYARczcqH5GyH8eFplTawFvAtrtXLGpNrQDGbejupB3omlIHQGc/ErzOcGSRs8zrhAbbuL1Tco/JfbLlNwHOmi2kIcs3owbdwNpYtynDQhsFcgvuG9/YapGFvYX22zZcAU0/GwA2LJ/4AmGF9mwEbBu98Y3cMF+uAGQCj2HVp3BbPuo3IlqxAy5wHAq4OfARmEBXGfNIBa0BIsG0ecwC67merHgRpZLwocrWaovuTxew/V0txJQ2DWeae3WAGbdhb2DB4+wRw7w5g8Qpv88liyGtoWHzMi4C9fAEHbBi8kwUKu2xNAdBxaGBLbJdZux1LwAGECYAEm6wyfpelJrEgFnRDxESwgyUxIUsVMwjVy5AYO0bG89Auu1/5BF38KqjBHlUAYXsteNCGwTeWNuwtk4JMkrlzGNizA1hm69g1Nix+zDOBW0aBeRZZGqBh8M4emfWNADDT+zqMjQyESdQFHfDbZECCLRgdHeCTe8CBaKJY1rDnBRCIAuGW4TYAZeFG8ZuMkGiQ1IEwGCJtHZBmy1obBsvVMnDD3jIAerti3LEBOMjGcOpa3WfD4ic9t6oveDtLfw7QMHjnH6wPAybW6yaG4+8D4HIQfvtDIVtLejpBFsVvUI7NIBHw3DUjRzL3rDVtsYPOkAScuX3coNDynT2VYJCkn+PjqvUD8hVbS8NgjphGxcANe8sAGNoVY/824BCBtIaGxRe8pLKZdpMkTvXiJ2toGHzSNHDPScAyq3er4qPyGaNc7JCRXWLT2TjwGmCOeQashq6+qSpZmp8vojQpheF58ncdZVjLnjWPHr4VWKTKxrHGUqq97qXu3jp0wPy+eEC/DYNZsZAO6IEb9pY9lNCuGPcNV830ZmkM9dmw+OKfbdcXvJMPdY0Ng0/7GnDXKcDMccBS7MwdKz8KCAKQIgY0MWGCtr4TOHAasMwOkTqf6unyuLykfd254nkb7qsw/iVg7jhgmSX31Vpd9yRHeLx+zRhjEGRbB6wDYT8NdymyubzDzCCGfpMJWfSRYfr9HP/aMgBm7YoxNQHMbQHm+ID6aFh8yS93tAvGQb7da2gYfPoXgbtPAqaPA+a3AEubgGU1RM6B060fgkRoCzj+TcD+04CFE4BldZdRc4/YxlxgjJMewSiwN1zWfsOngdljq3EmY08vm5i/7j5yIMqpvupKyGoNg9lngYosl9wY/0dZdrMzYl8Ne8sAWNOu2MA3zw/F2CoNiy99XbvftrcLriz6PhsGn3U9cM9xMODObQYWCMANwPJ49UliuW6SaqqBn/gGYP8pwPyJwNIxwDK76ahDeN6uXYCuYyABkEza4LbpY5WEWdSLxjF26/dQB0SJ6r4ByAN6NQxmkWcqrnQ00x1DEDJFjR8CcNWGvWVPp6ZdMQ6OVOCb3wAscPJ6NCy+7PerkP5Q3tBY1PrT9tEw+JwbgPu2AlNbgVkCcCOwtAFYcgAuiwWlM/XqDjMEbP9t4MB2YO54YJFMo/5gHIcALV1TRZ17FXOhPtvgtvkqf9H4kvHDlyKK4l6VzvVSBF22uwjOb7pbw+CfcwBSkyeFEHAUx/yw9JTyEbo27C17Ol3aFWNuAlgIn9QxO2tYfNlbK6MvaxeMRYquvL9rTcPgJ30TuH8LcHAzMOugX3QALo21WXBZLEHwRF1OgHS2eOgbgIPHA7PHAezNu7QFWFZ7JnXJ5rnqxHEulvlzwyVNN3+wern5Yovl7SXLGwvn4riLWO4fgMRJXcPd/+pmOymELEhRzBxJAo9gVL4kwVnbsLccgHEpWi3epocCAMeBRU5eTcPiy/6qtl0wpvhA+2gYfO7NwOQm4OBGYGaDs+5ExYDGgqP+ccAkINaVpB8GTv4d4OBxwNw2YGFrxYCmV0YxLNYheCXau7EhV3ga3Lb8g4+R45uoGLADgHWqhsBXA8K1AZADyRvuvtkBSArh+i9DsQhCOtf0UUgW/7aiYW/Z0+nRrhizoxXwFhyAi5y4rGHxU66qAFhT3rDSIVdpGHzencDejcDBDcDsBDBP1uX1CMJRwFiQIBzxieL3KIY1YW5MPOxNwLRb8gs0aghAss1GZ1O+SFHsdRPt0i/PLHu++dFb/x4mXfhcbWxhfCtYMFr/uWvKxfDaAcg7ipPCvFOVpuo3HrCjYW/ZA+rRrti6TS6MVQ+L4NPH2nx698GnXF0BsKa8Iab4dFZpGHz+JLBvApieqAA4J8CPOQuOBBAOV0CUYbIskRkAecrvAdNbXc/aDCxSpyT4CEIyTgRgneiLIp3nP6fs+a4A4N8B8/48CUC+ZGJA29fpuLmxJW+5h5kNFg2jiWHSi0r0Uv4pCoZsxw8DUfnhd4Vk0XGdGvaWPaBV2hVjdjgA0BlpkQ/K9bmn/HOVqtClvKEBqlfD4AtmgP3jDsBxB6DA7tdbcvYzJvQJkii2n4NOeMpbgJktbYPGACiF3wFoEx1ZMNe/4jnPLXu+KwD4t/5SO/iMBcXuesHylyACMBPDgzGg7opM8mEHIGdwrfGA1rC37AH10a64Yr4APvvOSdwEPOVbKxu+K2pdKRTmdI3dqkPPVgbSTBGAY8AsATjWniBdx0QxJylOFCcr6HBiw1P/CDgU3EgEIMW52M8YkLolQRddIN1AyKWiBretf9MJQN6HsaCPxe4rvgDdHOcOxDIAcmDFDXvLnk4f7Yqt63gEIB/Yoj+4p9xaAbBHeUPM8qF2aRh84QQwNQYcGgdmx4C50WqCFngNsgSvQ+Dxu4MuiawhwIAXVk1O+e/A7CZgThY1dcno1nHL2oDIyZULpBsAFTBZ9pjT0QQgn2V6ufRicS8QRgbs5ZYpEsENDejBfpoLrwAOjgIzZMBRZ0AHoUC+SOA56xJwNlEyTFw5FxBPeWvlzpnbANCdQ1eSGTRybMuydgMggVBsKmtYoC6Mt8znZxsZMLzAxoAOvsh+ydDqtXx4FIDl8L/omQ7A0QqA82S/ERdTI22mNfaTuBIIxR4BhKe+y61punQC+MytI/Zz/c9EuvyBeetLAfGZ5WOMZ9j2/gqABB1fMLsHAVBqhfTcyH5d9MByEdzs+B50Z7voGZX+NzNSsd8cwUcG5ASRKYbdHRNYwhhDIHRgGmO0gFP+HJh15jOXjnyKblVT5Cbfoq+yJOszF8P8+VnNPlICkMAzds/YLxlYznrJwIpO6egTPMqA5ZNDAB6iCCYAyYBcBqTRQ0e4630SxZyQJQIvMJ8mSeLrYe+p/GzGfnTpEIBy6US/out+K1wg+brs88rHmDOgAVCMnrEfxxMte1Mt6j7u9zzKgIXzczEBOJIB0BnCJoqgIfDEhM58SWzJEPGJe9hfVH42un/Mfxl9bgSiBySIBWnAJBDGEDAB8QWFA8wO3/a+wH4+rg4RLPYLul8tCI8CsJmJMQAOuwFC9qMI9g9Z0CxhZz65K0wfFBPqu7PEyVdWAOTHVlTcpxhXHZLz1w0ZA6EDLhkCskRf0sw4dRYC0PQ/vVSRAYPo7QCdj7GqVOSMeBSAzUzMxZcDMwLgcKX/zbv45SQlHXDIgagJc+bjZBqAWhUoH/Y+B2D0J7rFa6LYDRmzomsAaOeKqxEvbWacHQB08JkRIteSXiSBLYJOLB+X4xrzAzY7vgfd2S4RAKkDDgPzNEAIxMASSWF38WsgkuXLyXTRSRCe/DduSZMBMwe6ObTd8JBj24Aot07uDObPP9XsIzUGFPs5+JJ/M6oT4buxHv9X7BeY8KgOWDg/Z58GTC9Xq5FxTXOw9c3Cm6k5fPcjgbHbgAlvVG2tH1T3Oavoq6BlniZ+12n5u/2sDbOvasqoFg8x2Lnbcd1GdhSAhXN+7qMrAC4sA8sORJ6yHwD28z+Ft4fdv8UyqUDrDmCEBcpZ39kLS6aq9l4D2rLb/KYsFTPWdfbvh86vQu2s1K/K+zIjTsXIVQ9a59Egs4Y6sZfIA/EcSp/jEXv8BWcAhxaA+SVgSQAkGAMICcwVlNLlqTc9Gbv/HAA7MrL4+f1VlXwrUq7SvCoyGcrrWpGhuur2fNGYwM8YT67hT3s1LaZvqn5MLM0bzmHMmIFSgdFNj/mIBct63NhFZwEzDsBFgpDPeanNgATfCtGsX9TIKwNrg9tuVkhlng7TI/YArX1VkXKrEe1l2SynN1RCsFJsqnQv3UIMxhwIRjU5AGN9QUteVz3BUAvahuNgjC3HxLAND7nBp/cgONXF5wCz8xUDGgCjKPbvevlzcKUHH2ag6cnYzepYBB9Zi2FxDJdjoXJv1WDFiLJ6MKqKZUzoQFTfj2HmwTKcTpVWvcxHKm6kKgoORAEvVclPD6NdzLXpMT8IYNPcLV7yJGB2AVhYrAC4SNA5AxKM9ryDPE5fs6eeVKWGZ2M3S3MQfEyJUKV8L1ZpJXpVJ9pLilmlAxWkVJHKwIhjjD9TtVXVm1HdOy/pJiaMFRWM+bo0rWl4yM1N7oPhTJecC8wRgAttBjQWdBBGESwgSiV0Pb9DRgu0TY19N+M1mRKh8niqFx3rRDsLqjgl9yaGXT80vcL1wnE252PAZCzAHQCoiqoW3yYWFIt664fUpKaREr1NPakH6XkuOQ+YDwy4FMSwgU8GSRSz0UJx3Vx/5vFNbrs/EiLRY+v4ACITww6iJEodQKwBIyBRv9vwhKzUW6z66TUGEwhDS3ezqusAyNxnJn8xa1KRPSFts9YfFB/QDZcAm78CnDBT5U8rCqjfc3yh8Gn/hGd/MsKf1+QzYJ4891Jye13iy1cAE9cDJ+6FpYrEkidxDN3OtXR+FwBGMezoMmxJLOumAuD4J4rxJrfdH/XCoLGFVKiUbw+LAPQqWWaMMLrd6/+JycSIm85w9lOpt1j1MwAwFTiqAWEUxeYH5ENn/jInUVHeMXQ/f/jRePvCa4DhTwLHfBc4frGqqaNJzLPw6iZxV+HTplFGvZrXZT45N39+HW3TujlZv8D6fp8HRq8Dts9XIOR5YtakgBgdrrrt5Qsq8Ssd0BhQ4HMwmVitAWHAY/LbLDQNQDaTVJ8Q6W4qVB51OOqDZDPVB3TLOBepW5jmqaLbec3jGgBGMSxvvemDYkQ9GoKF1ShUCSKCqBeQrvmfVZPC1keBjXcCmw911tTJ8q5XgOLaQgA+x/OdWA2EGZ98gbjleTHdQHQN+2iwls3nK3/Zhj3VeQhovYzdxmArSwQgDRA3QiSCJUrTnjfl4KozRCSCCeYmt90EoJJbVCk/1+FiCwFZxLk4dRfLFia6x8LbYkD9v9cXtLG6+O4AYQRfrgPygVIcqyhTXcWFOJH8fh3rz7EKwnUArq8mcGwK2MCC1i7WY7Zenh56feHT/jE3yliE4TZncd636gPFCKWavGhcRx2J+cvs9MlSw0Ty3cCm+c7n0G0MExdW4BMIbTXE9UCynvyCCX+Ovm4gbByA/xisVgJPpXrzLj4EoRJjJIZrWHArS9iprK+KcefgiyB0XVKGjOmCmW9xhRVMUSyRFnNeFGEdI2q+/HFXclkp9WsAbgTG9wGj08CI64WxRk/OTDcUAvBHXSLQxcVCDMQSWbzv+1e7WVbz+k5w2tJtsbcCYV6WJY7hmAsDA7r1Sz3OgOgoM+KTOJbcjSI5yGIaNE1uuwlAAU/MF+tF5/0sIghVLdVdM2S0bSzHx2Mi+FTxXf8X925NC4BycK8QwfmgVX1LlcFiykEMcL2BndJJ7aQfijKfxLGDwAhByM7aC5U4qwPzNwufNnNuOH4VZaCPlPo2AahqFqoPVFc14ga2m+WEEL0cAz9kdPrOmMu8r1o/rTsXz7f9oswFs+jO6LAqkvC3Ggg5Fg6mwW03CUI6X12h8lyfcz3QHqr3DIl64DbqaQKc9mI87QXACD6vpJqY0EVxz2CEyCI5eMSGX2e7VtI5J4yTRyZhscrvt1nQuivOAaNLlYESwcySgiVbr37Bfd0/u31yEgg2FVaiPCeVOguqAfGov0iR0R9JABJ0bnwk9nMxw+fOh55EbgRhzozrBUA1polN9CLwok5HEEUQBjFMQB7D+j656PW+IrJ8O/bBCo4sGFdGejqiyYCx3mKe9/JtTiBvmI5OFiTisg9LtJFF7gZGDrUbHKs79+hyu5hSaUvh1foFr3r/6vZJCiXgCDwVVFJ7MVmRLsrGltuFCc68yFdACMDAflwR4QM3HPoKgIExt4gz42SuaQb8hBOE2oZmlu+KFlKR3QSssMJxDPWbbjpfLoJrxG8CYT8MKGZSVTCxYFTIb84nkCxCIPLDiby30gXFghaF4c2ReR466Uu2fvoFr3r/fKAEFxvpqMcd9yonIrkuK5LLV7MVCM+/uDJCyIC2J8a0z1iwqyESgMl15Sa33QKgmtPEBnp11mwuXgO70Ud4DHWzfgDYC3zBEOk7HlA6XKyHQzb8HgGoCSQLqsxorIy1Bxie7Wx0rFaf+wr9Xv32C+56/7HbJ5VHtRYT+GJrsehHcya57PyKAQk6+vBkBZPpjPEExlwU59awg3C24W6KBsC6tqHR+MidyVG3i3rdAnAsH2T093XT+zLr197MTA80h3SfsZP2UqpCrPQ46oF317VrpeiKXTJ9MhMLkgGdCacKG/mupV9w1/vnwyGgCDCKWzJe3lqsyzLWZWe6/kc/oKzgKH4jC7oolhdC4jiuzM0WPo+cPQ2AsX1obFCTO5Jzn566PwbReiwnfTWjI4KvDoh1juh+aT+WKSYD3i8Aql2rJk+VsVQly5kkddv2FvHT61icqO7Fr71/IkLNXOi0FQjV0046oBy6wZ922Q95ICqDEaL4XWw3COcf9Mw73DFB9AqE6wZAAS8XuzGQIDKf+oVkqxt00ttAc+YT0PJ9qRFSB8xoye5Xu1ZVeCSgCLbYLVNswoncHxoeLwCzBGjBNki/4BX3z9lXgUCyIIGmhova83cRgO5Te9yLgP3MfmsBS8xs8/U67ePQOqy9umBUruDchqo8sHSd3PMfT5ifo+ack8eFHI6QEcnT5GvdOnVdXof+ptJ+BVPWceiaRHA8Us/nkACo8mzqlqmWrbFDppT5A5UIZm7CPA2Vgm3QfsEd909kKIqB1qJAKCBG8ZstZz3xHOAAiwmpDIdng1maZQAkZzsHZ537YfQrwNyxoQ+HakrnS0h1mUA1C96TdJTmORyhC3oeqdwROi+GDhkFI6bYNrcNDEDeAkXwQizPRpmnIs3OdqZPSaRFUcbchHlgie6agq2kX7Dd/+d8lUJVXuUzk8ERmS+2vfd4uvN2VOV5rSwb0y3JhgIh9wJeN3YMQCIgR78Q+nDEVYBYZUrUpbXFnM7COSdf7N4IPvtDnT2BY/h8Chh10MXQeYGS+7GGjaQiABpuNIFiECnzdWJMIUHcazLptC7YivsF8/7FgLFMqpiQL5TuNbKfA/DC46rqqAbAwIKWK+timRUBEiNGsOQsyQm+Gpjd4n046hbT84KPuYjOmHHyp92gcgDS2OoIuVIeh/xyUkaVwyEWdLrewHE3uBUDcKIwnq40HpDXL+n3CzbaKdguel5VnFJl2awaghLQBTzteZ0cjLq2A2n0M6EPh2pC57Wg41poLzZsAZNso0Hw6eVR/J8bF9YjWGmVCpGKwQLBRCcrbiSxNLgVAxCF8XSl8YDHHFPW7xeFBRwv/rGqOKUBkODzqgdWPYAM53vTASMQu4Bx9J+69OHIF+N71F1O1gUB+AsBfFqKC+4Wi4BWX+CYgOTAU36wdMVNVKka3MoBWBhPxyiuko3xkSX9fvGMkqsDlzzHC1N6SQ4DoINOe7KelWWTheziObeKCdARApD1AdVnRH048gKUAmAEYi6Oh4DJV4VoGDWqjq4XLbO5o1jBoimEPhPJmwu9FvnTLgdgYTwd2wyXbMyRKen3i2eXXB245FlVYUpVxUpGiLtmGBlrTEhVUwV8dEkVKAq3MHJ1uzRbRx+OOgDWFX6MsXJU/36lJoEoA2AKvw8+uwTEDIBbStdOs8ddDsDCeDom7ZdszBIs6fcL9ror2C75US9IxJJsEsHdGFBil4yYuUwknofJgF4XcEUfjrz+X7fKo4EJJ//PkMORO6FrVjQMeL5kJhZMMXzLwNZCt1nzDFgYT8cQwpLt4hDON0i/X7ys5OrAJVe0S/ISgFY7j9ZvnQ7I3+lyqpYaL98CWp/N+nDkZdhi6bW8An1kP3fRTLKVWlwF6RZCH2L4zDDR0k1IqeTNb2OQSYNbOQMWxtMxeqtkY6I+ny9VEz6btfb7xc+XXB249AoXv85+tIBVgJJ6n4lf6oV+mfjdDJNMH0wAVFX90GMk1f5TxlS3Fggh92DyN0IORy5665KIfCktsl+K3VsGtpVOWOMiuDCerlSnjQ2rB+n3C+pIBdulz8wqonrNPLKgwKaC5B3s53qhXVq6oDNg6sOhqvqhEr3V2VNLBjmnSSNdrOLJ1zkAu6VPRjFcFz4fXDJ8i45hG94Gt3IGjOFYA8TTlQZ/qGH1oP1+8ZtlT1MAtHK8mQg25zOZUSCLIliWcbw8wfW5Ln04ssqnHX04euiCk6/3de66MPpuAQVZAEFkw2MKFw6a1wEL4+lSBvmAOMhD8vkOkFX77feLNw14YT/ssmc4A6oOdHBEkwXlgjH2k4Nal6wB4fIuX9LzZjAmorNeHMo5Tc0OewHwDTUh9HXxfGJsYkAbAAAgAElEQVS/uvCpoAcew6zBBrdyBlQwwoDxdLZWXLDFkHyF8xGE/fb7xR8XXByAAVC1oB18HQYIT+8uGfP75SCUs1o64he8v4j6cIQ+IqkPhxrBCHjdjBH6AblQkAeY1ondukSiELmsUPpjbyp7XuvDgAXxdNZVvWCLIfmKg6Bbhrjup98v3lVwcQLw8gqA5v9zC9jErutltg8gMxDWWMBaMVkmANWFyEV6R0uH2I1IzW7ypbkQOTP5f2ch9KsFkwp0kQlDAOmxzHpscGuGAQvi6VD4RgmAg/b7xZVlT5MATNXwqQc6KGwf2U2uGV2uzg3D4ua7fDnPwZcKgIdq9GaIBPZb0YdD7hgyIFWMXiH0eQ5vXS5HcMkc++9lz2t9GLAgns7KxxZsCkgdtN8vWD+vYDMAUpcja7lOR9eLVcIP4tcuob/3AOHCdW02VTX62ApB4Mv1v24gnPy9HiH03fJ366KYHYTHsgBBg1s5AxbG0+HLZaOp65i+ln6/YM5EwdYBwGj1cmUkE7+8THLNdAHhwrUOXtcrO/pwhF4cct2oN68BMDCfmsJM/n6PEPoYPp8bH3kCkbtjji2tJJA962YAWBBPZ0WBCrbYsFoOf9pDAiENk179fkuvf9nTXewKcBSjsn7ldonWbgQpx+26otaLIwAlfi2QQSJY3Yjy5i9dmsFM/oEDMM/Z7Uf0RiYUA7J+ToNbOQC3e0WBBm9qLad6HICG1ZK1XB5PoxnuOOIcxSXe/Of8xHV/P+FpwN47gKUpYHmuSve0pKZgCKSq5wqniWE1WZz/xouBm74KTMwBI17lVBXwtWSs+8/vL45Ff3vhpcAnvwos8d48DZX3M2hx9XIAnu0IIO0chu35AOgLL0yuG/jOmwbg028G/mNz1YWdETbm4I5BrFlov+EtD2wIo7l+Atg8D2xY7iw3V5diEqO54mnj6XdMAYcU+6gon7A3NSO2qFjlyZYDkAX6uD5Iam44YaUfVNDNxaJcLIPXcGGpfi6PnZdVD1wPspQBX/wl4OaNwN6Jqg+xwrxslcVFuYJblehkcYYZGPS3L20BxueBcS8nwg5H5kZkx6TQSbXFZcCQKadx5Cz5mPurAFxrRaa17pAR2PFC+ElSHKQ/0QjQcgCyGyM9v3SnsDBRJgL6msWCf6IfWeUJac8UFlpY8500DcCfvgb43hiwZwyYVhd2D/VSrKGAmIDnBkiafEcN9cprHgKMzgNjS1V7rRjRlceyrqif6KAkMgXIM+6tAnDl+zSL36O9+U8p9jGHQo285/2XA/AnXeNnKAorDXH/AILwbSvLEz6Ql2+cAf/3XcCdw8DkKHBwpOpFbE2wadzIdyh3jjNQirYWEwYq+/zJwMh8pf+xKNSwM6DZMmzNRRbM2K+2Ii6TlFrAWfd5V3i/F7IgT2LBF5LbIdkqxLPWvtzlAGQ3RpU3Y7AiixMxLOUB2t7pKQ8M0qCTnp8HkojJgNqaMEJesQv4AR3Iw8DB4QqAs+6SWRiqgJgY0HVDAdBA4Ba4xN7ndlSFAAjAYX4IPO5dBDMAdS2i+Jx7XTf1eEdTDfgAQnR34p/wQkRmjNAoByDT/ugFphXAmjAEn8qaPQAgZCs0lSckCNmVigEbFMsPBBE3DcBX7gLuawH7hoAD7EM8DMw48AhATrjtQwiXoqkTEwWd7LOneXNCbz6Tiq/TInb2M8ZzIFrTQbGiy92oGz7pXl/7jvdAJnb2470IbB3T77Sai+hyAP5voTqW6sKwFAc/TAdc5+3dvcsTrvPVYSK4SQb8xV3+6IaAqSHg0FDVh3iOIFTIFxtit9orL5Z/LD1Q4s+B8OnHVuXwhhdd5DoLGsgCCJ04q66X/Ju/vSaeAxDPvbdtmdtKDV90gVEPIl/xySkviOhmAEjrlzSkwj40SlQZYZ39I+8JBMx8mZryhOsKwqYB+KpdVSDFvhYwPVR9BD7uyX4SwRS59nNI+bRck/DzJ05v12M0nY8fAk8iWL5BB5qASPGRCi8EVjzv3mqpkC9ACrrwhKukB67GhpqRRowQMqCiYbj8oOoHeUWpdYIBAUj8c8WjrjyhNIJ1unzjDPjqXdUjJAAP8TMEzLYq9uOHICQALe/EwWe+QgddAqCzzD8+vgIgg0qp+5nYjaDzCgjmnCYone0klqP4JSgvvK+6LoFPoFMlkPGh+0rPWta4RHTNJJQz4M8EAGoNTPVU8opS64CC9zoAWTFChcq7lCdch6s3L4J/2QFIEBKA1P9mHIBmhPh3Ai354RyAAmWsR/PRs6vOR8Z8FMPS97yxtIlYgVB/I7jC0rIKSfLXF1EEB+BFFjQ3jCLA49OWsRTTEPzvzQEwry7VrZ5KwzAQAPssT9jw1dcHgCrORQCS/bgn+1HsCYQSveaHkzvGv1scgU/6R55Y1YIxhvOm1EZekQWl8wVDxJgwc88QiJc6AKX/meHDawX9z16M/Em7bO8Q08GBP/jEkAEVjMBoAFWXUjRA3KtNwOBXW3EkAZhrALktpC6lKtTV4OU7RHB+3kHWgv/zrnYZl2kCkF4uF8MGQGc+MqEYUCA0n1tkwxbw4ScHAHr71Q7W4++c8czwcBAmHVB/c7Bcek9b3FuwbdD/kjGWgzJjQ3thGmVA3jhfOyU+RxB6FamOFp8NrhsTgLy8Cpzm5QlVptAU+6CiNgXCaIQ0BcDYV8b0P4pi30vfIxD5+w72C9aliegW8MHzqrmh/meuFhYi0pKbs6D9fsh/n1XFMrYMbPgUByCZz6J+uEknDA9AornWFRb01WZEsACoHhOqyC7wdetT0QAK2KqOb5MCUvPyhLE0oQxzqaYNXL5xBvyVXe12vByLADjXAvgxBvSPGFGMIjCmJbEW8HfntxtQmxT0cmxp9UPAdKAZ1upA6EB7qgDo6oCUxXRtPVSpAwJpnUhuxAqWCCYK1MBExZljY5S8SYr+pxAFAuBayhNG26jw8usCQLX0SAAkwwcAEngyQizaXoziIli+Oe7/9kJvNk1LmBMe9ECO3XRB7aPeF0EYHNVPdT8gj016YBcWtBfBVYJuz7mF7VgGY/pO8f5WdQ1/7U67nIKNS7j0wIbDPFZsyNHHY7od/xdlEHj8CcC3TgCWHgGAPSxiSdt4312u/8SPAl8/Dlh4pDeZW2PD4J1c9+uyDaIDkgEJQKnTfG/N8nUAmu5HUnMW5ARbPfEuIHy/ACjRK7FL5pOR4RaxgTHofKl8r/S1ZWBnAGDKefbn3AFIPRPXB7sFiVQimKVgGdl5ooNwLQ1/1U+DQGSXQ9r5Evy1q9rZbP1lGQDZsPpzI8APHgXgod7qUx11YtBbFzC+/C+BL7SAWwhgdoLkONSLqy5oLogYft3ZI1F7EAC+phsAnekokhP4HIzml/PvthQWmPB9LJ7jxkcSr14jWj4/0wFlgJD5eoDw6fe4DzAYPHokWhHJZ3TFSkn4h7YOSOBwEtiMTv1aY0uktFYTmI2/43EMQmCuAJmUE0gmVD8EFdPpdnxhVhqzDr8F4NMtYM9Jfg98EVTeNu9Q2OFZBX7vr9vtgm/lcezczZ61ZNN8DCvilYCdPXqNDQpAlfGTKm0M6AA0PTAyoMSx64cRfPQHXsniOTI+fEWDFGp+Qb9BeySRBV2kpl0QxxGAlHDmkI56X6z+EP7UDYSdRgh/IouwIZ36lHabBE0GJ0r10Rgb/xA/tt/j/6aMAf+7R4CxzuBXWRGULwBfIrY6UNfpvLae7n0I+LO/reoLMqiVMbW38oUhkNkQIzZO7tIweGePcmWlAFTjAYHPVGwXxWoLYblEDkLuTT8MDPhXLJ4jALpaJB+ggU6xfgJknT7IKXIQXh4Y0FZCog+wxiUTwSkXUbSMV1rB/A31OXWuFpPUda/mRHKi1e6U+hA7Zq7l+A+UAfDtHg/LrptkQpZ727cRWOL9542Pa3rOvuOqagUltgtmJM08j4/PILbIDKz6w5PAHsbraTnMGdZWIwIzxIfeK0rn578J3LAVuH8CODRahV/FFQ/1IumIvXP1QudNfyNT8oVqcHviPcBd48A0g2RDuoDqHdb2SalZAdG9dnfDkAE0gXnH5ijWCDbKCq5/MRiV0QD8HgHQ63jG0hdsLGxA3x9Bw1Asli7hO3BwApgng/Gjvq01IHrXJ7q3Cz7E++YziF2rs1ZLZ+8H9jJsSoECWXj6igmR87aLgfbGq4GvbgLu2gjsHwdmCEIPSI1h+SkCRjpfUC3iNWcpoRrcnrYbuGsUOMBo7QBCxSTG/igxVcBIVGPWM1h1JYQPnyKNExGZMDIJ9b66eEBGxPDY1Y5nv+GCjfGAxD+DDpiawphABWZPjwNzNLAEIH4XCH0M7/5c93bBfI8Yk2cgVAdvdT10ifDkBWC/r9lGH51NhIsnsWHOfPmEUKT94WeAG8eAO8aAfWPAwVEHISNQlKQUglJjJExqC+H6Nq93kOpUg9szbwLuHa66QzFWkaFieXxi6hgVHOMCYGRuJ+5V4jYJIDKI9KlsAvFDq8QDrnb8NWVPh9EwdFkQ79TlSMIsN0Mi5s9MoOGno4U6f3YAvefL7Y7rvdoFLxOANSA8f7xSgWmd0kCQbmZ6mTLEnJ0UqWLhUkxlrBn6n3wWuGkYuGukCsufGq2iojnRFpafsU7MDxErJuZhYCsJosHtWTcBe1oeq+hxigJgXBrMmTBPnJKLrr+VED54ibHYvZos8sO+DNcrHrDX8YVVyglAKud0LtMjFPtNMz6QLDY7VomLJd671AEH4Xu+3g7nWq28ISvX58/hguOBg8vtFQvV/hEzxfqOevuTfpjri8vAWz8L3NYCfjBc6ZYHmBcitnFd06pxyb8W4gPlgonBqffTtdTg9pybqiVNBssyUsdUD7eGO9amnf3sXtxQipl7Wg/sD4A8AwHIyZMYky50Tp/xgN2OL8y051qw2hXzwRCEdT2nmck1RxHG+w5jeO9NFQBpR6ldMIMXlFWgVndqF2dVFsJzuOgRwMElB6DcI6rznemD0RnbwQiSRS3g7Z+tVIl7PC9kahiYZm6IizuLigliT/VoUog+p8P9l3wJ7qGEanB77k3VczroUToWLCsABud4ypaLCUoxf9i/9w9ADiICULrQRWuIB6w7nuZrwaZwLBGwClSqSyz3AhHbaRGEFGOmC44D72UVgjW2C2Z4lIF4ArjodODQcqUGqAxfcpG4mJVuVqcL5tbs2z/veV0tYK/nhTAqesYNHdO5PCJZos+WuzxHJIViuXFyJxupNLg976ZK2lizUKodilGUgzyGhokF8yw5Mf+qRkjdjfuDtwkkm7DTkNaBaQ2ox1q3eMD8+B6O3H6em8Kx1Ccx9ptWl9iYIUAAWrI3I3nHgPdOtsO5eOuxXXBdj0V1vOL/so3Cxef60tlSpYwveKf0pAu6ohfdJ8k4CUqgvr5jV6VGTBKALeCAh+VbZLTnh5gu6D44A6H8cVlkNK95O1WkBrfn31R5HSy+JCwPplAxRegE/2T+AloGncNmbQyogUQx/KwB4gHj8YWNTwRAOW0FIIIndoqNkTAxz/bd09XDGLBdMM6/pLKi5whAX60gCK2ujxzEAqGL2pQ1Jis5AJEAFHvTujYAKjRf+SEugm1d2COQLU/DAwQ44caEw8AtZzSIPgAvuKkdrWMM6M7xCMBoiBn4YpCE2NCfxWAA5MEuwvCCEICwlnhAHV+YORfDsWJGgPpMKwg1b9QpFnzHbD2BK2JGul9s8KkYW17vLALQRTCBpzXZpS4gtCXXMAkduuAy8E7PijPWprXJ5CR38ygw1fJDohh2BlRAgq2OeN7uTWc1D0AFNtmL54ESBsCaJcLkDajxj5ZXRiCIGA0waDwgjy8sk5+HY+X9ppUbJSCp6TnFCMXwny1WAFQ8rUAc2wUrRL6mXTAefWnFfnz3FpbagQKLAqAzoZjAKkkpXkNO5GCEvOMLFXOnnC4xIKOjnQGNdWSM+GqHQGd7JSsxUf+JzQLwhTdV4je1nQvr1MkPGtlf9yP2Dy+gAqZ6rQytfvdHSDxgLwBF8AmAYjHWluEDiKGMiqOVvtejXTBOuRSYJwDJAARgZAGWL9Nk+IM3SzgTydE4eec1nZHbtDaNAf1Dpd/SMx2END6kD0oXtFhBXmcY+OY6AFChnKnzl7NfdMR3qCAae2B+VVMYXASvDs3/X/zHJZcB84vuiqABEo0QPnhnwqQLyRURmZBPytnwHde0M1vN2lR6picoKULaxHDIEdHkW2iWg4/7b5zb7DSQAVd0/griV2JYojfpwRGEYsGBrOBmx/OgP5sAKANkcbFzNWTRnX/GSGImMYH/LYlk+gGvdT+bW+SWH+Ig1GqL5QeTtR2EYj5LVHfjw/ZDwL8yJ6TB7UU3VVoTjTYxYDK+Ivv7dzNAZIxpZSiU8jjKgIWTcykZkBawDBBnQdMr5QeTKI5iWCB09AmEb7+ucnOQ/aTPWn6wuzyS4u+R0Ob6CUGqJpIDA97AdqINbgRgBJ69CG4Jp6q/ckjXqB/RKla4WpkO2ODgHoynigA0JiLwaNiEt95YQKJ4FRC+7brKzRH9jZbN6iJYuSHm9I5iOAOhHNJfZkh+gxsBKPbLu3+JgaWDdojhMO5kkDWSlNTg4B6MpyIAjf3IggJgMD4MCARjFMU9QCgAykhSKnUCYHB9JB0wy5aTRUxmup4h+Q1uAmDs+hpXgFLnB6ULONOn5xACNJqxghsc3IPxVBGAiQG9aLeilWUJW1FvVXEN0TKp1C6At19TMSCBpz1dHtT/JH7N9yaxp6QkF73KBxYIr10nAMproB44qQGTj6sjUrtOFPtLeFQHLES9AdDFrq1E6M13MaxVCTNAXNFThIylLcor40zxtgDAPKuVwDMrOKw+SBTbtR2MND7sZwC7Qvm4wqHa4T/uIrhb+7n0EgbQdTijoyg+agWXT8llDsAFWr/B8qP1K7bT0pvtVwHhW6+t2C/m8svvZlawi2CKe37nhFtapkDnILRqBQA+v04AjMyn79EIkXO/DnzyCBwVweX4wxs9B4rRZgyPVFqykgDd+5JSpBU5r0vHyHz+jsc3ub0KABsZMCyQgeExKyFPVIz3lmcM6OfPAGCADYPE67Jfs6h7G0o+xvi7oyK4cLZfOgpsXwC2Lq9MwuuVERonKn4nSJrcXnQKcM7dwMMXgYcsVxkSebJgzOWPqdB1ad2f3gpsnwK2LXWeR9m3danUIV1lBSCPArBwtp+7DThuBti6UDWDmWA/DvXk8LRptfPtNUlihYZTOPCi04GH3wFsnwGOW6iAs5n3GeJJ+KLoE+9VDClQ8R6vOQHYegDYwuY3S6H/iJ8jb11ck0q9Qhoc9QMWgPBZJwFbpoFN88DGRWBiqQIgWyJY3lPozaGJ1KTEPh36zpTkJrcXPRE44S7g+Cng2DlgyyKwaclfFoIwvCwx9Zn3Q1DmIPx/2/sSaMuusszvjfXq1ZRUElJkKsBEGQyYhJCBSkUqAW1tsBdpuxEVaBzowXZqe1g90G2LotjQdmMjKqtBxQERdAWUAkUlZNBGkQRNyIAEMAkxpFKpqjfUG3t9//m/c/+737njPq9uVeqcte66b7jnnn32/s6///3v//++Tz0dmD0KzC4DM6vAFpd/0L3Gh6yTDgnvLwKzAWDGiH/ThcC2OWDrErB1pRgQisIQhAa+AED+HEEY6uNLyrRnZLSl6tSbrgLOeBQ44yiw8ziwfaV4UGbdegmA5QMTLFlqsfn7XecDW+eAmePAltXiXnkuZSBkRcm4UGXtU2uo3xsAZgz6y54JzMwDWzkgBOAqMMVBCSAUObh8QuN/CiTgcWAuyWhL1amvvBbY+VgxbW477paa7gIBqCnUrbUBiQuhAKDUot13IbBlDtiyBEyvtO5VDxvvVfxW/JkWNFrCeK8NAGsY7BsvKQC4hQCkJNaKy2LRIsg6SJ3IQSe1onKKC2CsOYMeN+0Dtj0ObDsGbFsEZmWp5S74g2Ir2uA22BScAJGA+dJFwPQ8ML0ETAUAkgDTPq9zdK/+sMWpPF19NxYwA4g3PtsHxAE4SQC6FdSgmGWRRIJLZJll8EGKjHiX1jwaN10HzD4BbD0GzC4WrsKMW2pNobZoCu6CLCDfCTqzgg6sr+wFphaAKQfgZHKvpRSYg7HN5XCL2AbAZwPrZGaj6ippXhgn0kqmU1woxnHedg5AATuWHig2FE1uVRwoxoX+Wcbg89S3AqCKPONcCi8oPtVP+9++G3j+oSK2xRBFDElUxbTS+3nvc4FpDsjxllXQoJg8FgdCQoGJJTTicLcQ6vPL6wbg9cDM4cJv27oAzFA5ky9/UOSvmg8oP86n0dICBn25JwjARWDSAUgBHN6vfdbv10AbARh8X91vDM2ss+NvAECKPVLCsHoyUgRqrlbnRwB933OBc+4DXrIC0IEmiLnE75di8HsyAcjzWUVGUi6uICMpVwwJVMXdeOk3XAxc+Hng+vV2esAYw+sWoP31r3eLcLwQBeQUrEHh4Jo2h4vDmJPuAyMLGAeEn7uqbgB+I7DlSWBGCwe31Gb9aL20kGDb/EGRxY6WTz8f2wtM8l4pgL1SgM8esHCvsuylME4nn9cfQLtldg6TZ0kUKorAfij23vAPCmqp3fcCl60XFINid1PlZrf41/dnApB6wSQjutUfIDJR8CGIQOwWEH7DywpKrWc8CFzqRLHkVYrB2jS2FQH5vkuBycXCAlIUUAAkCM2iRBA6+ARCe7DjYmQduLYTleiQ/XTTS4DpI+6nLhZW2nzVCEBaMLd+soIGqjD1ampdugiYWCpeBKA9bBJC9ActAk8LES26SqsftInLZ44dQif4Igdhym5WLrPDyuYH/7HTCNwDnPko8LXrBccjQaioe6BiKad3+QY/MGTH6rS3OBvCnQDuAIyqhiDkQ9RX+29yE3on8IwjxQPI8zkTiApGU3oVkD/4fGDieAuAdMw5MFQjEgg1DYsUku+a3uI0TGBfV7PotwHwaOEmbHEATvuDIutni6UAQoFRIFRYhfe/dhEw7tbe9Of0Si1g8HkrwRcevDajz07gIJ7n05rYyWIpb4ya/7vv8PRdFpj/LXDmkQLAnA4jCCOlTBRN/rFMAJKgkkVHpGUjySSBSFeg7/azqk8EgbSEq8UDRACLKDXSyaQ7Br//DcA4LSCtwnKhTEkQcmAIQhtM+Uaajl0uS9NatITXWzpzfcdNB4DpY+6nBgDaCtanYLN6fCj4u1ay0QIqtML/EYC61wSA9tAJeP6eWsAoDysFpg1eB0HIQRCIIkVeCqQf/05P3WCB+UPA+CPAzvmCaFWDKEuYcl1yMN+Y2dckqGTeHPEvvWDSNhOAfbefX0A6rS8CUw8X9066bFIfdqMHJID++DJgLACQumyc3gyAEYRRKFCLD1eu5ODLF6QvXedx0w3A1BwwxdAJLTXjd8seQnGrZ9bPFxLyA7WIKON63tYtCQBN/sv9QPm6BkLp0vl9t/m6ietR6fbyBA4gnXtORwRRpNnTtPpW6gWLH83lKqcOFTEnDiKtoHwy8RNFhrefyeztbnrBfbWfgttsP+kIyO32ELD1cHHvInrlvWs6TsnB7qAUlg/suFtAWkE55zYQ0QpqcALoNCXTEt7A3KoaDwGQfqoAOEUBa7fUbKctltwCajVbxvSiyvoasM0BaBKwwdKb9fN7NfcqBWGiSWykWXER0umeacUEonQgCKRfIgDFjya5yq8Wfsfs8dYgiuMxgpAg/vnMzu6mF0z6Zj5APdvPQec0TEosnvQosGOhaLuIYvnwEYSithE52F1XFAA0p5yigD4otCqygFKnpHUpLYP0OcKURYv6Mj4MNR433QhM0gL6QongawOg+6rl9CswKoSkEIxPyTsuAPigCYBmAXVfYcVf+n0SRYw6dP1YwNgHsgSajiJP429RrpWOM6cxDiJB6NINM4w7LbUGMQUwB/M9mZ3dSy+YVG0EoBiDBST5ddZ+PkCsAiIlQZDa3LVatJ0WXG2PbL98AB+4omB3oP/HgTUhmGgBfRqWf2TTrUSjExDSP/qWzQDgfAFAWyzR8rkFtDAKX75jo6nUguZxZ8NByHbvvqBQ36T1swcsBaBAGGRg40Ir+rt9WUDhQ5ZAU7Es2e9LLzglqHRxNkbeuW+oQRRls5jaMjnK0a9ecNf2R4LAwO829kQB3LTtEYQPUwzQAWgW0AGo8AQH0ljp/V17pm0KRcEifGuNOnocO1rACQbKPXhs8TtNwVr5uh+n6Zf3wDgu29g2FdMtOc8B6PdpFj08ZFrplw+ZA5FTvAQQ0/BT36FPDkRqBT9Jag7xYlQItY0f88j78sZzCcKPZlrAQfSCK9uvB4h577SCotUiEJ8opq8IQFl/PUBPEoBLxbRE62LSqG4dFB8r5bHcOtiOQSqT5T7RKzYDgJx+BUCCTxZQCwhaQc9oKcEnEBKknj5FsJ1LAPo9xoWWPWDy+6IIoqbeaO0VA+zHB0zxIQDKkn1GgtXiRxMIAx0Vn0Db+lkuFjLRCt5WEwD71Qvu2H5OfekD5FaciQay/GIbFgBXriwAyGmJADR1ck3DwTE3TQ4B0LetzBJErTYAr2BBSI3HTS8tLKBZPo/fWQDZp197Z3scjGb5BDp/L3+njMweB6B83Gj9wj3atOsPWin9WgXCFlVO/3ctf4iD8XkBkH5USlAZlNPZAQqARr5vxu1yjmH0givbX0UQKI63o0Wun/xHuR8E4VnPK5JQLd4VNttTBvK2uoiKOUf/f+GjwMNBh0NMV6J0c0NpcRv7mrYv3kh8/uHxYp+bVpwLp3R7sts2YzouSq3KGa+q7+x7Co4nazAerRKsVlV1QitF59dyyFZaYY0HMu9mWL3gtvZXMbymBIFMZ1ov2h0B+LTLisxgW+Eq5uU92iZ72ud9vvR+4JFp4NjkRh2ONi0OB1/UBCkvEYRhfuNs4OmhhiPKnFQlx6aAjMnSXJUAACAASURBVPjmz1w41nnwO4cCIBvBwZgTAOUHRq3gyDExD4zRGVYEnpm5LqmQc0M5esFt7acFl0SlHiBxuTkYxxdaihUC4QVXFu5FCUD5QtJl85sjGA0ziQxqeu/fem+hw0F2fLLQGxFlYMRvo7v1WmIVtpt1DFkXvOR7LwJ2HSkyoZmEypoVVe8p7b6qEMnidGG/Vl/L2aPOIwuA1pAIQE3DAmFa4j9f7CPaFpCHKujr5xzZesGdHqAqKz5X+FLRAl58le+jui+kTBALMcgZ73CDBkpN2/7+bfcWOhwUyCEAjQTcAVhKdjkPc2RajewKyu/n1//qJcA2uhBMRGXQOcn9U6JIOjXHQqSYOsVoQp1HNgAvz8yny80H5PVz9H6RqVd849WtXQ/zA0Ow2ayGLJ474L0G79vvbulwkJi8BGCg4S01SKqofoNvSIC+5zkhFUupV8rUTpJN06KpaBkFQm5M1HlkA3AyM5/u9Zl38zrk6f0iU6/4hmscgK5ISUtCTowyDqb7UxwsqFJW3fo/vbuIBJEZ1YRgyHwQKNi0KEl1OKTCZJdxtPDn//v8ooaDaVgqFyiTD2IKfcjZS4Fo+7g+HXOPv84jG4DIzKfLzQf8KVfI/FNKrQ6h94tfz+vOA9cGAAbrpylY2SDlVTTt+uCnV3/V3a7DQQAysJAwobZJgUXi78Qayhd812WeiOAZzEyUiAkHMeu5BF5FwZQAWLPwknkLQy9CrPMy8+lIHZFzvN3T+YbV+8X7c64OHHix74V6zIxB+RJ0wQ+UU992tYoFy3fcXcTDxQkoPsCUhFIczKVCegSg5B8A/PILN9ZwxBSxtiKiUAOi7JW0dLTustF8AGbm0/1o3vjjnSGdj+lYlGwdRO8XN+c1wABIoHk6k61yuSCJITq3jDY9Vx0BqK++uwAfX6JkI/hME0SC1EGguiQ+isqcQRLrF6/0jO2w+6FMnZhyZYsQ1W50qOHgPX1NXndtODsfgMwHzMin+0+ZN0S9YOllMzWfLwKQSS396P3iY3kNOLDPM1y065H4gOW3p4uTDkB8zWdb7FgbdDhEgJkCUDRvogTmd/vPv3BVAUBuvylNzAAYi4hisVQnEHoIqWblrxqm4Mx8ujfljT+YjsWBYgIOc0oJPsq1slCpH71fKybJOEoAuuVTRSCnYlmU6P/Z4iSJEcbLv+Yu9/1EAh7JKEXDKxq4ChUiKymRbwjgHdcUWTARgLYXHSr2LOU+BV7MVwzxwOfkOWybYAGZD5iRT0edjpxD6VhcOQ6j94tP51wdOHBdMeXa9OqWRcmWXA1XLUIUH6zyCwlAs3z+YBkfs1u+VIejJEF3ckrjI9T0y/aMA2+/tgAg08VURKT8vbKMUgAMIGzzAcOi5HknHQAz8+l+MW/829KxhtH7tTz+jIMAJPCYMULAWd6fvi+EY9ouoZBM/Kx/4LUBgFLgNC5o16FrE8JJVJgkiFhaQQBv3+dVbMrWVsC8UxFRkjjaVsW2DtRdOJ/vAyohVYK7A+bTvTdj8HlqTMcaRu/XxHkzjgNkIOWuDr8jnYYDKDutgpUhra0uAlAyCCUAK8BXcjBXgLCk/h0D/hcByDxFAdAzoFUqUBYRJTUcMWdPP7ONL6i5bLQeALJRQ+bT/W7G4AuAOXq/lsGdcRgAY+glLkYclJVTsa6ptCX3uQjAKINQstFrAZKIwWxQIhIJuovB/Nx+r2LzFCwlj8Y0evl/MYk0kieVtcvrwGUnHQCVjjVkPl3mItQsIPuElx9G79dOzDgMgGkAWlNyBJn8xKprBRC+zgEo4LWRgcdVcOCjjlNvmx84DrzNAahaFZWLygKWxUNibIhTcPD9BMLLa65bzreAMSGVoXvJ/Cgh1WUfO+XTZS5CDYDs9GH1fnOrIDcAkABTTDCCLYK0Cwi/586WcKJUiEpC8CCBYDsiiSplqUIUmOjf+o2tIiKVUJbgU5uSWl4DWwX4+PcXnrQATBNS+8yny1yEopdcay+930y5YhgAg+9n2OoUeI5TdQer+32fdhmGoOBZanBo+g1yEKU4dYgFSvqB//vZBIBt9RshkTbW8ZZZ2hUgvDL3iU3uux4LSBM0ZD7dPRnTH08VAIfV+2XAOucQAMuVcKfFSD/+IAABsEoGwYAoHZIKEEYxRIHwLS8pUuhjFVs6/ZZhIVWyxVKBBIRXnbQATBNS+8ynI4tBzkEACv+chlUVIKE/5cRGsWmlKfIzudc3APLQSlg3E2OCyVRc1kpU3DgBmKoQsWtlBcswjPu+nfTYtBL+GQdgOf16GCZW6pXlBCqWSgqJypoOAFfXXDifbwFJLvi5HAjlnUsiIe6AjOp4iQNQHRlT2PlgJCUbbc2s+v/hFwFb/q7gm6HlYpBbmTV2sscQyy/qFBj2v0/cAdz/HGD7NDA1AUyOOU+1CwWOewNjKj6/O03F1/WuugW4/XJgfBoYmwDGdH7IxB5kLPIB+I8AfNwZgga5ck2fJbEm8V9zNWPfrasbgMuPAcuseJ8Exsb9FdBhA+7gaQNKB6TfcgCYug+YJT+g89aoBDMmIMScP12uTKj13uDv8zsKig/uJ1uQOsnojm3qB5P5ACRBH3OhPuzzRN9DV88HqQLEWPJnvTy5nm/t/1s4BcuSpRZtGAu4fi+wtBVYEyccrYwn6hF8/FkJp9bKxAKVFsn/d8urgbHPA9NPOEOWl4+2cfoFHhfVrJTZPKHSj5daOtup6JyCpPx8rHWRVQ7WOlrYCMx8AHIzlxkALPD9c0VB+x/A3E/+E2fUYHXdF7KTGwdvTd0AHP9r4PgWYG0KWBdfsBdsMPfPrKKsoL9XAVLAvO2fFylCE4cKliyrDVZNcGS1CqEYhWFiAZV+XntaURdTLmpCEbpchTYLqi6NrkMCzLzt5Xc4HwyJmmkJ+Z73jQOh4NWeDUZiK1K08f0EXt7CMHVawIk7gaVpYJUA9LI1Ao8bzKX1cytoFtFfpdCIWz7rgzHgth8u0oPGDwETc8CEMySUzFaikgtlpW1Ta8JqNba7lVljSRgW+Q6ZP/57WQvj6fydBjXfAjKbgEvMLwWCvhNoipgNpnQshlS4IGFWzIk6ylWwAz93ETLxGWB5ClidLABoIOS7pmGfG+33YAG5mND0G8F4678vkiPJczNOAC4UyQm2N8w94kirFlfIAl7i402d6dbPWWAtrsjOFiuCvAJZOQE0pHTFsckHYDeCvhNgipQNxoAz8/8IPr5nbvH2jd+6AThJAE4AqwTdZKEBLDoDgU4+YVkPHIBoPwareOt/BkDexsMFAFnbzNJYm0IDnVwbt4uyur1kwL7Tp+iZM/08WT9Rc7DHUmuYTr/x+6o4ovvu9fjBbgR9JyA+omwwxvZI5ULg6ZW7y9FPf9QNwKm/CgCcKABovh8ByVy/UCtJq2f+X1yYJPGU27lIZLbuEWDsWBHesZeDz4iURLUWa1TE47LqK12fZmd3OXidFctqm92KatVs1jAEsNv6sdymaa2g8+xUL4I+Pn2beCgbLGWHI/h8G3oTr45iK86POlbBU9yKI/AcfLR+ouQwH9BfmmbLlTHboOnZ/T9+5vaf8FUaAThXsFOQ45mUcgZCWTAxe0UQ+urYMO1/37GtxQmoLCBtRSp30LrDp2SFdzYMgk/R+VNwvwR9mwQDsaspGSfJgYDYNTbp8psCQFJxEIBkQjDrxt8dXCUIY+COH5MVFPi8SOn2n/QYLZ9Gp0cxANIP5IvAkzVzxivRydnKNzBa8fddM84b6AFyAriMF2pajk9kYIeoClXmA3AQgr5NQEHMBqMVFMNaIOayNRL/vhlH3RZwmhbQQUcAasrVVGz4EtjCu/3dfb/ID3PbT7uKAZ/MhcIC0vqRTo4W0IBIEAmEtFwCYqjW03bcmdwBYeoWgetUbrR8snrloiR2drpACf+rD4D9EvTVjIJu7HBV+781X752Czj9lwUZkTEgcPoNPp5Nv4oBRhCG6dd+1DkMz1JIhR1BAHJ7zwqO3fIRRM5tmDK5CoQKsSgOeBYBKFZULTqcB9r6Ni5KYmd3WKDUA0BlhNLM8EbT1QBXBU72aI5ZjUcVOxz7WLkQ8d37vsart/uA6RcPsxNSAtAXHDYNC1AEpf9s01kKwuBwGU7HgVt/1jtD1e60fgQigSe/j5bQp+KYpGB+H62jT7P8/ZypBIC8Dhcx8eY9wF015abhmnoAyJ5WSrKeNgKO9SHxnT/LSasJBim5lRjWBEIVeROInKL1qunybRawLgASdEy74qjaNNzJCgqEEYzBGvK0297mAFSHEIB6ebKDgc8J1ksmV8t29f1en6L5v6cxIK5iK6Xne/5jCTiFcTqVn/r/tWDPWwXnEPTVgIKUHU7ljASawKefIwDpMdRxRB+wFgD+RREDJABpwSzz2c0LfxczVjkVKwaYgtBBezu3SvX08d39P5uO3QKahXMQciourZRAGKZWar/YZ1xXRPe8wQr2AUK7TvbOVTZBXx4MBECRnConUBSFEXT6mf/TK+/qmzAF/0UBOPqBZYF52HrTFCw2LH5G8UCzJEko5nZqmRnPh/uCXmpnVpDTsIPPwKApOaSA2QLDLSHf97iPx0tpISLfz7bl4iFfsUsnj+HZWEeOYDCDnDmCvZkEgedcCjxGseIhBYt3vx049HwMLRh8gA9gh2MoH9ABqKJzxf0McO7XlSAU4HzhYYFq+5D7hwBu/98OQLlIBCKnW39SlXNY+nqeiq2dkQg+gnGPb9/ZpT0lq6MV5D96gLCwgDmCwbdnCvZmCgY/dxy47xxg5SWuUjigYPHFbwA+fyGwfr2rXrMvPB+vp3L3GHCgi9JOHQCkRVPppeUBigXLFymyejYTB4YsgfA20ofRAlYB0FfAlvQqP0/TsX5PLOB5DNu471cmIwiBaRww/F01J+mz2pqChxUMZvpJlmBv3iTocsW4dzewfhkGFix+2febXDAeJO/YEILBB7pU1g8LQFo98QASVGYNQ6DZfEG3fnEqrgLhbf/HV15anbkFNCvohWSl9XPQ2XTM/2s3I4DwPIZwBEDfgitH0Ek6N6x+u/iD7T4g/YdBBYPpWHEaHlqwNw+AQa4Yj54JrJO+aQDB4pt+oCAyYvOPEIQDCgYfeF/9U3AbAMX7ItAlVtAspKZdz5SOlvA2pstxjES3wJ+92NgAGK2gwi78QoVfEhBeQACqNNP1RdoA18kKdgDhxkUI/zKIYDCnqyzB3jwAJnLFOEIW7QEEi1/1Y21ywVglCAcQDD5/Efj7M4CVrZ5AKlkhxeQUaxBI4nvFzxf8IfCVC4HV7cC6ZEX5nen3VX1vAGLZq8ysrvHY+QBwbGfI2E6JpLvdX+ksthpUvQrmX/sVDGZVUJZgb17vJHLFeGQcmCdVb5+Cxd/5xjZ6QzzMLOQBBIOfTV2Ps4HFHQ7CLQUQmUrV0rgKJMsCjsxGAqTn/hzw0EXA4tnAyg5gbTYBorKkUyLnkB9YVhTxu+kT13iccwtwdBewPAus+b2ar9xJAafqfgMQO4dh+J9+BHe5gqZZZzYok1JJUcpaR6bp93P+W/N6p0KuGIemgEWKgPQhWPxdP7NBLhiHKYHUp2DwpZ8rLOD8tmJQVplOLxAqmbRKC6EDYC7/CeCRPcCx3cDSrsISrs04CPm9ArZk55UvKAspYLqPaPdR4/H0g8DRHcDyVr/X6VabLHk2PhjpPVZY7d5xwF6CwS9y/4LbbVyQsEKIufGiKe0p2JvXOx3kinF0GjhOQY+oNRtljji9TQPf/fOV9IZY4Gq4D8Hgy/4W+Oo2YG5bUUy04vUcLCqSJVRWszJbNgxSmMau+q/Ao2cBR88EjtOqbgNWWaTkIFz3YiWrF4nAjtN0nBZrJnU+/8PA3CxwfMYB6LUra3oglL0tps6wlVha5rLiqd9AdDfB4Je6U0s/0BXTDYh80Sr2FOzNA2AXuWIszABL1JaKWq1R+nwGeM17OsoFY5XTVw/B4Cv+Djg0C8xvLYqJCECzgsxmZlq9T8e0XGUyaUizavPtxoFr/zvw2BnA0Z3A8e2FVV3x6c4sqwObckeyhiXAowUSADhD1XhceDMwx37lvU4XxVN2n3rJIocygkr/Vbs7fe+EdBLcfaXXQ3IPWIrpBB6XlnwpR76jYG9e7/SQKzarxM7qJFj8mg8UarMV9IZ4gvNDD8HgKx8HDs8A8zMFAFnPYQPDl0Co2g4fpDZLqKCxT0/7fhJ4fCdwbFvhRiwRgJruCOwUgCpeCvUjZmEFxhfk9W969kW/B8xvKQqnVgg+B6CB0MsI7P70AHgmd2n1NQ0rv7FvALIlVYK73MnQCDLThSGZoDpuP7uCeuX5n8zroB5yxThGnQ0CgyBMxY63Aq/5aBHG6EBviDlOLV0Eg1+0AByZLgbl+HRxnZXJoqqttA4ODovlJZVuSjTQFtq+NwNPbHMAzramdVpVs6wEoPtdNg37wJfvsYiJP9NFqvHY+7vAwjSwxAeNxVO8T6aNVRRRlT6hHrJ0Ovaw0WDJCKng7g86APvNB9wg2JvXO33IFWOBgn8EIf2nRLD4tbe1+AU7yAWbZeskGHwVdd2mgAUCcNKnJgLQrZ/V9/Jnn5JUYmnAE3hCmv3+t8AWQfSzyPK/POOgJgDdsgqA5nfJAvLdLV+bz0kK4RqPZ3wQWJxyAPqDVhZQyQr7gyaXI9axWCFVAGLvRUhV46PgLnUWBs0HbBPszeudPuWKsTRZAJDTo8l8ui/42juL5veQC7ZpsEow+OrZQlqVVuH4FLA8WVyDAOTAmHUQCAWQkOlsQAwDt/9/AE8SgPQpNa07+AhAA6HLXbb5Xr4IaAMfv/eGvP5NzyYA7UGjBWTWjh40v9fSyscHLtaxhJWxFVsNNAXH1khw983+DYPmA5aCvXkdNIBccemfceooAfhAAcA+6A2xLuAGucxrzgKOMexDfV9OwbS2BB/BEoqLSrBoYGgJ3E8qLcIEsP/ngCPuUy7S13L3wb6PU56/m/Xj4Ps0TKCXQA6AXuNeZY3HMz5QANAeND1kwcKXlj6wOZQ+b7R+Pi0PD0DeFAfk590CKg8qncfoFzIRVWVqfFfBhgn25vXOAHLFWCDbvPstBsJZ4LUPt+jdesgFg+qVptWq11bg2gtgfuLiRAAgQeg+oEmsOujsXb5SsAoCIN/3vx04OlNM6Yv0tdx1MKvK7/TFjVmeCD4HQQQhf159eV7/pmc/kwCcKABoeYvR0oept7SEoZQ0Tr1lPuPQFlAtO0nyAcWhpzw/FSjFzGjLx+RGvxzoSeC1hwsA9klvaFN5FAy+9mJgnhaQ0qqagglADo4c9AhCDpJPl5ZommQ8738HcGw6AJBW1VecZv0cePwOY0/wl1lAD/WUCx0mMlDLr8bjmb+Dwp3x4nkDYbD0thIO5aNtfmDi/xGEeRawxhs7Vb/q2huABQJwAlhyy2cC0xoggjAAUCWWAkksOiIY978TmOOqeqqwqAx3WGhHK06n7TDwOcAV/iipPAKjwgrZm2o8nkUA0gKmAHTrp+o9MTrEYvq44o9pZIOtgmu8mafCV72YAKT/RwAy5OPOuVlAAk9Oule6xQRTWUKlWtkU/IvAHAHti5oIwDK841ZPFtCmdr0U8PaC9hVultd4CIC8P2Ztt/m5/qC11TJXlJDGGpfGAmYODgFoCxACkLpuWh3KCgqE8gNVZK4KtxgjJAB/2X1Krao1rfN7CWZf3LSBT4uAEIyWBVpipL7GgwA0AW25GbGENBTRx3rm1M2w39mmrFVwjTd1Kn+VAZALEE5LtIDyMWUBvbLNLGHgd5H/V07BDp7r3uU+Jadgn3ptxekA5MBri0/Wp4wzBjDbCnkMWMqVpE8GJwLQqvfc0pqbkVj5aNk7gbCxgJno30cAjntowtXNaZ1suvSKNhsYTcVKmw9F5xGE+94dfEoP+JYhD/8OC8eIPUsUHokVVKB78XszbzAF4Pvd//PCKVGIpOAr78mn4DZOm8YC1jco+w6EFTDDPJqeCEBZBa5GffVbhmQ8DtZW5TYOvPhXip0GTuu22lTMLSw+aAVl9QhEWjurI/aQiLJkTMLsX9R3r/ymZ73fp1+37OU9hunXSkdl7T3QrhKCtlCM59k2i5CMMSIAGdqxEIwrmptzTsCEut5yilKoJLAcxCq3fe8tLCDBFwO+tKjyuxSCMdYEXoeDrHcHvu0tTwLzmwHA4N/Gh6zNCqqeOSxC2lb8tQSiMwbuqXIqAcjFh2JjBKGJyShQG6ygVbfJegULWBYcMR3rvb6oCRaQwFPgl1M5rR7/JtBZOIZWx/0+s4QeY5z/1/X2tFnAxPpFELaVkdLN8MWGVr4pCBsfMHN8bmTKfCjZ0Ncp456/x58zLzfw6Qf3ABd8pUgEYmqk5bGyek06IQl1bkXScnlN/u8L24Gdx1qVq91KQvrpgwaAAw9p+wnXPw1YjyWMGtDo2ASOFGMU7SIEUzdYD34vMPmXwLbHgdkFYAtlGiim6DpxJtvq9LtlVr/aWKEB8pUXAOOPAFPzwBTZ9r04vdQ9Ts4pAZ3cd+yHxgfMAOH+vcA69/9Uxijmz/AerYpdar1lNSMYzV+vWY/34I8DY58Gph8Bpo8A04vAFEFIknIHohGVR62QhFRSYjQE6qFri2z3iaPAhHNNlxKwArI0Q1IAxwfReacbC5gBPp66/5ICgLKCtqnsrKKlrFZUFPKOr7osMTtdsxzqQRZ93Q1MPARMPllohUxRqkEK6gShOP0S+dY2hlRv99y+ovRi7IiTnTvLqmg6xDPYpqAUgRgsoR7MxgJmgHD/c4E1FXu7FRRbvEgd7evXWlbPpp9EgUjiJpwe6zwOMlvpAWCMVusJYPIYMOlSDZRpoGiNxKzbdIQlXONMWJbGtw4svdgz3El47nzTRvPrrKptAJT6ZrzfintvAJgx4vsvdQvIXK5VYF3sUZxmJUvgA1FOvwF8spKyBtM1y6EepI4LqVMedbEaTp0EIKdPKh5FqYYqSxgo2jgFr13j6XXHnOiSZOeBVSvyC8qC2r05FVvVw9cAMAOA178AWPMp2LJaaekiCPXExwHw660n1oB/niGQazwOkkSepbJ/72I1x4CJ+cJ6lYI1riccrVicUuVSmIW82pkwnHHVOKbFsOozQGkFkwewnBES37ABYMaAX39ZAUCCb82nIlo+40p2gNnvsoKunxH1xGwA/LOzdQOQJPIuHzV2GBg7Cow7AI0l33XfjOsv6oVodes6ISbBsAZMX+kJxU56KY7pkmFVhOciuvTzSt05v0+ryuT/9gDrZNe4wPMsI7VJP3GcP7gUOOdvgL1rRYJ0ZI5IV3hV4/wrGYPPU3/AiRhYusy2K7mU999P+z90ObD7LuBZK0Xdkeq9NSX2+o4HLwfWlopFCC0fgciBMtAFC8CGrYXVoVjnU2G7rTXrzh4kfRzLY1kyGwBoeiGcPiXb5eAzdXWnazPCSScb4j3xfmav8Cx2p50lAMW0VXINitCogl2r9H2dcctWwQxQsn6ZTBbMNtcgdKIbiZj51VcBk38CXPxoQcfCUg8pjcYgZScw/momACnXyr4leBhs5QaBTHpf7X8dMPYJYO8XgAv9e8QJlAZZq8D4xSuANYKPJQn0AR2AHKy1MACKe9nfFI6IEqduEWoHIJ9wlsVKLekoMCa9EAegSTYQeM4TXco2SEMkAHEbBZoj4bbYtdyCVrFqGXgTSxgXYTZeHLi9AMjEQRCVUXP/n4KUaaT8vVTi+Rtg7GPAuYcAWlMCgUVkQfJ2Q12yBvPXMwHImhDWwf81imsTiLSEvHZkr+jY/p9CQRD4p8DOBwteItai05qn31FFdfLlFxYWgCDUIkRkj/TxbCEi/89jfPZ3X2VqYSJQbmUNQY3HQT7hbv2sLoerVwKQHNEEoCsm8R4MhPRjXUGzVEIKIoY7yaEYuY4dgGb5RXruoSgtSCLLarkICQ9f6QNykGjFdjsIBaI4kGlt8W+Rg5g0HJ8qAp47nihAzFpuWtPIMBZJlASILvR6fQ0DCVbJCkJOJCqnk4pGpb99tZ8MopyiKDX7WWDiwYKXiEQOehCrgKh+eJQ+EQHo1Lby/zRlyf8TIbf9XS5ftIb8I92YugH4ay2pLusorl7dAoonWtMwQSTdOFuQSLTGHyIC8kxSIQuA4hwU2WUAoO4/grBcDbsfWElSzg+JCoYDoEGM1ixSkHzgF/wG7y8sIa3J7JPAGWuFJSQIaU01iJHUiYP4e33BrPOHmG/JMaOfTZVYRhwGav87vWKPJ9/rSH4IOGO5sITqg/ggxXs4TOaBAECbeoOsgfl+DrQShFqcEIhyyt0MbMusEkx76iAZXKM8BvXiZAGlF+KaIbaadYpem4aDgpJZQz6YJABV5VcHAJZ0v4FxX6KG5UpYs0KnqjhRuagEVgPglYAl9ciHf8mdUrJh0Qx9vkDBzBywfbkYQIGwahA/kglATsHsDzKA0BATiPyZ4NEDwIeoa/uFYKKXL2f24nQoIgd9R3yQCMTFqwIAfdBWI7+yB5ZLECYLETd85YJl+2YAUNosLIel/xYlu4Jsl6bhNhD6it4WJCvA2Zc4Gxo73RcgJeOqFmGR6rcChLYACyGojmEYdj59KnZ+tIQRhH9IvWA2hiREjDeRI9Cly7fMF3EtWRFawhQIf5IJwE56wdTIYdt7tp9ys1K8JnoJvod9Wn682PNkP4hUy1ndWgstAtBDMLYN5/6PAc5DGNoF4SrZfN+4+IhT8jqwg2Cp8ThIJ5vfSWBXAVCrWN9SMxDK+skaOvhoAc8me654pmUB3f0wyt+E8FyRAGmPlOEoiSD2qgvmAKoOm52fAuiTDHSyIRxx+lI0QxxADubfF5vffMmSajrWlP7nmZ3dSy+4r/ZzAUEHnQ8R70HsXlK+PgJsW68G4XYGZj0EY2EYATCAT6tAhmE0DXcC4faapcwMgAIfLb0kuzT9Qmw5uwAAIABJREFUSi+EfeALkSrpBovbrQDnkm8wAo8/E3i+CCsZ98NCpAp8cUekZyBavI4ET/TnaAk/RQCyAXy6uNSPA0i+wMeB6ePA5HFgZq2wpNGK3FUDAHmv3fSCe7afX8CB4UNEEOolVi/3obastNwJ9cO5BOBKEQMsAcifHWzRAigWWAlCn5K2bQYAOe1KMjTIR2kRUhKVS7IrLia0v+3xwHMZMCbYNP0KfG79zAqK5DxOvyEuWu6VD5KSHy2YAEQAfpaRdl5UkuUctIpBnCIIl4psD03FtIIP1ADAlBuJM47EqqUX3LX9kSBQcuuyftK78xUkHyQ+RLqHZ3Fv1KcgLj5kAQ1s0Qo6IA1nHhNLQzA8ZxvBXuNx8DcS5UYpNnoYxsCnUIqvZo0F3wPTMa7Hv53HOJVbS/l+5bumX7d+5WLE44hxIRJB2NMCqj9ixwuE90svWCaIA6bAp959EKeWChAyA0PTOV2unGMQveCO7bfqHbcS4rJR7Ewqnw5AWhLuImg2uFQAXAVs8RGmntW4+g2hB3P79L/EJ9zGvqrxOPibiVihAOgrWQOf/EBfBcsPNBBqW9Hv6zzGqFzmoXz3B9AePgXiq6bgiv4YOB9QHS8AfpkAFMMjrWAcQA0iO9XJiQyAnos2vV7ESHOOQfWCO7Zf7F40mZFQScRKAYBaSU6vAVcTgN7xXHiUFpDTMK2dFh56912BTiDcvpkATIXzCL4g3WXTZ4jpGfjoF/oihL+fx+0yWUABLwIwtYKKIabgCzHQvi2ggBKn0McEQDaKT5cGkIOo6SuyYzEfjQB0EM5nZgAPoxe8of3sgSqCQM3jkdFLvpRvR13+7UVRuhUFSavNO6otwp88ZZ3+t4M6HLtch6OT9AG/q9cmtf//gV1JDYcnQ2zY6/YakfSrU+Pg1M45NqPt3IEtoM7WFHokyrWKkooglCMWLYjiUXMtK3g8Uzd1WL3gDe3vRRCoUEYCwGtYFxxqgA2E/jI20F5hhmQod98BHNnlxOTig1aGiDanO21yV4DygWuB8YeB6fnC9WEtiKVVKeE0ZGiXWczeJoWMIig5a9V5DA1ANoKDeDylZ9NSXxyAsiKawrQqmCv2HVf5e8aRoxfc1n7xs+khItAUvojvyWryxVcWJZksVSyZoQRA3dcAoHzax4Gj2wtu6FVKM7gMgti02jbV476oUJJs1j/AbA1mQ3Pm8eTRsoZDtR+xZKCiEKmMXTIeXHPGdhYArX8FwG4DGMEnAHIK4yvT58nWC2b73cexaZgWWaEKgU1gjNbPP7PvOYGsUSBkv3hBtmRWNzxjTk9RWktvxp6POj0vARjY9sWkFel8RWxegjIF4RjwAOnZWMPBTGjqvHmszxJOBUD3xyznL2bqROvoP3N3q84jG4C7M/PpcvMBef0cvV9k6hXv+2Yno5QfGArRbaCC0mWv2YtF3ecerNDhkNZIIsXQRv5dlTtGADJSz2gEE1EJQM//026HdIEZLC8B6A0tk0g1Ja8DuzJdphS82QBEZj5dbj7gxZN5er/IZI+67pscgE7QaDOUMyC0Wb8+gXjuR4F5J6YsaXnFhBoAGEVvUhb60jISgCQnoh/OLBgvIrL8v7DdFkEYM5dtNg97tvz5zJqzdfIBmJlPl5sP+DJP5xtW7xffnzeh7H+Z+3+RpkyWT1YxuURJYVtx6T0fCTocouQV85VkHRIGegEuEv/YKpkA/JceVmL8kv6t5/9pu62tfiPWcFQVEa0DZ9WcLJEPwMx8uvfnjT9IgZyj94t/ldeA/S9tMaGa9SNdmsIxbvVscVJ1GScoMt4UPwhAsmMZ0aXzQBsvdGRBjQz0FUpEJRAJQOq4KAnBdz+sfiPJ3bOYn8fsykyVWMfiN3BOzckS+QDMzKe7OW/88aqQzsfE5kH1fvGjeQ0wADodmVGwOeiMsUqHrGOnS4UFy9P/wAEojkEnI+IqOIJQNLgpCXhcmLAtD/D+kgQE235L93tj+YBqgTX9BiCeW/NedT4AmQ+YkU/3sbzxBymQuZhm8g1T+QbV+wWFdjKO/Te2mEFNlCb6gPF708VJ1TXHgKd91GnZpDfi1k/gM2vqU3DUnCuBmNQe3P9vw6pe229KOvB0K1k+ZS+rnrfM2AlA3JMZtah/EZKZT3drxuDz1O/yxAwu9JgJxr3lQfR+8aa8Buy/wdWQZAVl+ZzCrG3q9c/YrkmHy3IRYryAAqAkEBIlopJxNNUbER+fA/H+/+AAdP9PmS9dazicJybm7mlB8nR2dI1HvgVkOlZGPt2nM29GCamcGZjAwlQ+vvrV+8X/zGsAAUiLVPp/wd+zaTMFWw+/kAA0GQQnpCw5mDsAMIrcRB5mC/+MAffTwgfwKY2KfmCZ6ZIkUShrxXxBX4yYaV8Hzmcn13jUA8CMfDqWYeQcSkhVOl8U6uxH7xekrsg49h8oiCENgC5TUG5vKxxT8f2aRtOtcAKQ1s8soPuOVUIwpchNlEEIOyNSIrrvv3hwnckWIZPZsnbcDyzTpvg3lU8mpZQqozyfK74aj3wAKh1LgrsD5tMxiz/nkGD1sHq/YNFOxkEAcuW7oqmXlisuQOT7VV2jwi/kTgj1RkoZhBje8Z83SCAEEJZW0C3gff8tADCt4VASaWIBK0HI9q8BF5yUAMzIp8tNx5Jg9bB6v/jdDPSRns0BWIZeUitIo9IhHmhXTvzCPQddccnZ76U1V/IvC4SBCFyg26DFNg7c++Mhhb6qiCikT7WVUmr6lYn2nRKyrdZ51GMBlZIc07GUBdMjny6XCiUmpA6j94vMZbgBMFo552pu27PXAqXTyAUQcitOQjAm9xX0N9pIwIPmSCmH5QuPqER0L4kDYgp9zOUL6fYxkbZcFceyAreAF3GlV+NRDwAz8uksnT3jiILVSmpWNlhMze+k94vMZfgGAPJeHDjpCrgM01Tdry9OzvmYAzAqLVWIwEShwzbRwwSEn+MqP6bQK5tZlWyhjCCCsC19Xv7gOnBRbgp7cu/5AOyVjqVMmA75dJZ9nHF0yohWNlhMxKnS+0XmMtwAmFq4imnYbrEqNJPc+9kfd62RKh0On8qV9hXZ9askEPgAfI56ziocUgVbzGT28lEtRMoKtg7lBHtznfZNA+CQ+XQWM8k4uglWK/NLYKzS+8U9GReXD0g/Tyvh4Ne17Yb4Zbr6g6y7/aNWcoPpjKRTsJIags5IJwkEAv6en05S6GUBfRWsUExZyVZVQCQwrgN7Wfdd41GPBczIp8ODeXfTSbBa6YYxlY8/p3q/udc3C+jTbtvqt2oadnB2m4oNgMn0W0p+hYWHWbwg9yU/0Kb9EIy+5y2hiCit4UgKyTeAkN8Valk4Le/ldlONRz4AWWBRM6fdIPfHstw/G+SE5rMnVQ/kA5AkLHS0ak7V7reXfhgACaBqDtD3e/nmc5k9kA/A80JReq+U38zGVp3ObJo/BvAOD3dtwiWar9zEHsgHIGlFubqSx7+Jja36anLLcDvvgwA+NDpDfILv+qlzuXwAXuSjrkKemlO2e3U1uWUYnL8dwB/5e2apca9LNv+vsQfyAUheX4VguB+mzIsaG9ntqxhF4Xbe3QD+n7/uHLAW9wQ1tblMRQ/UA0CaHC7plXEh+q4T0OWcfhleYTSHBK0EH/mi+fcRuKQn4I6fWpeoB4AevCz3HOOm9yb3F5mBlZBNclYCj1aRfyfrbgPCTR6AzK+vD4CyglX7jpmN7HY66d1E0ctdIrEEE4wEIMlam+Pk7YF6AMj7EwAVbU82vTerCwhAXopJN9zVI+AYrOeULLZgErY2x8nZA/kAJGWr0naUWdFpy2cT+oCWjpdjLFxE5UzYIBBpEUX5nLnlvAktb76SPVAfAOUHpiAMm96bsVtCAMaKALICMyxDq6cXfycA+b/mOLl6oF4AiqBRIEzBp7/X2Af0+fi1XIioMIlAI+AIPIGPmeROWV3j1Zuvyu2B+gHoFfZiDS2lC0LiY52WUADkQoTTMH1BFSYRdHoRfKSu5v9qrizMHYPT+vx6ARhSuDcAzzmDo5ZGHT1PAKYMwQxME2jiSo/gEwBrrq+u41ZOy++oD4BaCcsXTPiSI3ey8s4KGoG8QwCMFM+0ggQhLR0BF19SXuD/ayakz7uR0/TsMcxg3SjfqWNA0hsrga/ojaq/8WPcC+YIk4Ke4CMSuB2XVht1Oj8zIfXlU8BtU8DhmYRXWdfrdF1fgr3+S8At48CD04DVjXQSDO70PTUnaJ5uOCwsIIFHSSFy1pKPWCDsZxCpw8UVgKSPxLXM937OzxxAljzcPAbcswU4Qh4V3UN8mKoeKm/bu78IfKJQa8VD48CylHQiL3O3/qg5Rf30BKACMtJXjXKQcfBSK8Dfqc3KVCwuN2VFGRnm/yKZtq4Re5ifyQQgM2A+BeB3GHaZBo5MAIue0l7Kt3cC4xhw+5eL7TuCkJk1jBtyerbUfYG5ExjZ/pqrxE5fAOrOq5SmowVIrRp1IyT2R6+fg0bgVYG4CsyZe2UsaiOGKXr4Sfp9k8CxCYAFSKyvXeY1o1BxQux91yMtfsHPutgnnyUuUvhc0ZsgUXib+nVkq6+ZKaABIHsgVZnuwD9sVo66rrR4ImdhLGSQ8zPL/JgBQxeU1ouWkO9PTgDzbgmXxrzMkatl3keivfG5x4r4IRcz5BfkO5vEZ0kgpIfBZ8yKjlL17syy0tMNcOn9dl4Fy6dLFabj1Mpvow9Ify+I4Nlo9Xt+ZqU9VdJpqZh4QDDyxUyYOYJwHDg+DhgI/WUVZl7aSEt93+GO9Ia2iuZKOfA7lhp9JpvAVy61w2mOwO5hmCgMHC1H9O24gu6UD9jP+ZmbtLRaSsei9SL4XDPbAEh/kGQ/pSUcc0lbApFWb67lQUhpVnLBsoKqqZclFMmUtrxPcwxl3X7vOCAtYLSCcugFQmqhdssH7HU+RznjiOlYXA8wqkOfkItTAom+oKygca4ES8jY+N3z7fSG4hfUtp3ihUHruVSsFy1iRvNP+1N7A5BdJACmVpAgZPhGOyCigEjlPLudn7kvFtOxuB4g6OjD8UWLRkCZFRwrLCEXJQQhp2K+37lQeBCRX1A7KPQto1prFEmSYn2mB9EAsO+kYfk8KQhZF8yjVz5gp/MztyOUjiW9bCUhEBhKRCCgSis45uQ/PhX/xfFWMgOnWu2gxB0TF/o0kEZ/kCDM1Ts+3RHYnwVUL6XhDFrAswfIB6w6P1MrTulY0sum1VICglKwCEACqvQFCUK3gHcsFQCM/ILayqP1k9JshVqrncMalOYYvgcGAyCvIwuod8YBJQmZpmGJeyRwkGw4n8jJOJQNw3idLFhMRNB0SgASTJyKoy/4ieXCeFfJBUeV2SoAclFyR0bbm1OHTUiN0/DTAwD7zQeM52dqj8VsGEkVE2jKetG7AEhQ0frJAv6RC0trC1skl+IWlNinGLbSaZg7Mc0xfA8MbgF1LQV1z08A2G8+oM7PVF9Ms2GUE0gQyp+Lwu2yagLgR9ZaYpkSypQ6a6Q2DCqzpkvietXIFdoZfuieGmcOD0DeP0HEbBhNwYPmA/L8zJQsATAKnguEqS+XTqkE4YfWWwCUFZTksYAYwZfIBeN9Tw0cjOwu8gDIZqsoSSvhEeQDiiGYFoyWiSDRypWgi69UP5sc5fIcquSCNeXqe2X9ZAHfM7Khe2pcOB+AT41+aO5iRD3QAHBEHd9ctuiBBoANEkbaAw0AR9r9zcUbADYYGGkPNAAcafc3F28A2GBgpD3QAHCk3d9cvAFgg4GR9kADwJF2f3PxBoANBkbaAw0AR9r9zcUbADYYGGkPNAAcafc3F28A2GBgpD3QAHCk3d9cfOxqYJ2au9RdPtdp/khoEOlglDYT39V1PzQFXLsMXAlgt9PCxJKPbufyf8/KHIPfBPAZABf79Xc5XQ0ZQ1Q7360NbxoHrlsDvs5ZRsgo0une06by6X1mZvtP99PNAp4F4LsBXA5gjw8EGTeqaGF4QhzQF80CX7cAvGIdeDYAfhdZ2sTKUcVrpE7nd31N5gj8e2dIo2osk7NZpMdK0Z19tv+bJ4F9K8D1ACj8yfNSikHeg+5Z969m57Y/8/ZP+dPLKZhP/rcA+AYAF7g1oRUhEMUzFMt6eSJfX78b2DkPfM0i8GIAX+uWlAMppreUUErn8p2gzTl+2flg/sDbTkvIOik+CP20//mzwAXzwDcCuNTPJeFXpEpM6QEjIHm/zTF8D7T5gATYNQCe69aAloRTGulfBESBSYNyxR5g/Bhw7hKwZwl4vk9LnM5JmsBzUyDGAX3B8G23Mz/g9BuUa/0IiutfMkj7zwKmngAuXSvOpUvAWYBtF4BTnspIj/O8zPaf7qdvWITw6eZA0JLQEhKEGgxZhUj/dz3NzSKwbR44exnYvVKcy+mM5Km0JhxInUtrGkmzCPicg3W5LMGkQiZZTm9xS9Z3+4m2o8C5c4X15pTKW2Lb+fCx7WLtjYxzqiql29Icw/dA5SqYf6RTTilg+lYCIXmICKQ4IK9wxfSJY8AZK8CuFWDnanEua9ZTAMsaCog3Dt92O/MvnRGBtGwkqKRmMEkqCaa+2k+0LQDTh4rP88UHj74kF1WaATo9QHQ7mmP4HugYhtEKj4PB6ZQ+FS0hQahpldPya1kXTOqNY8DscgG+HavAttUCvBxInitrkgL4lcO33c7spBdM3kAuSnq2nx9gQfAh4JyVwvrxwel2z3p4aMlzH6DM2z/lT+8aB+Q/OT4EEqckWQSBkGD6EQKQnDCLwBSnYgcf32fXioGUFawC4esyu7CXXnDP9tOCsyD4KLB1rmgvX7zfbu2WG/Jtme0/3U/vKxBNAMoi0KcjkATCN3HOEr3UAjDrwOP71rXixYEkeKMFlSX8ocwR6KUXTJ7AaNE2tF8WfA4Ye7Kw1mwvX/yZn+eKnvcrfzC6IK/ObP/pfnpfAGQnySoISBqUXyAASS1AK0JfagWYcRDOrAF66TxZQU7jBOEbM0egH71gcgXSFZAV54NQtj9YcNIpbONCyh8Ygi8CVospApDuB63g92W2/3Q/vW8AsqM4gLIKBBIH8bcJwMCNMX68BTqBb8s6sGWtsIA6jwDk662ZI9CvXjA5A6NVa2t/IAicnC/aGV+8T74IQPm/AmGuBc+8/VP+9IEAyLslAKMV/LgAyIUInfnjwPQqMOOgI/DstQ5Mr7UAqMF8V2YXDqoXXNl+EQQ6N9v29aKdesUpWJZbAPyPme0/3U8fGIDssDid/pUASCvCaXgJmFguAEfgEXT27gDkuwaUg/nbmSMwjF7whvbLhSDL5TwwvdRqo9oqHzACkCB8U2b7T/fThwIgO01T1IMCoAZxGRhbKoAXQUcQTjkI+a4B5e5FzjGsXvCG9gdqrLGFYrpVG/UuHzBOw2/LaXxzbh43DKeoJwlAHqLndSs4udoCoIBHQE45EPk3DuitmYOQoxdctp8+rFwIWsGFYiFFoLGNchcEQC6e+OJC5J2Z7T/dTx/aApYdJ37AyJK/DIwvFxYvWr0IwEn/H1Opco5sveDUhSAAF4HJpQJkWixp6k2n4IYfMGf0amDHev2I8+l4/UbvNw8Eozw72wJePOJ8und7EkKj9ztKGA1/7WwATo44n45pWI3e7/AAGPWZ2QBkYHCU+XTMfGGQmYIxjd7vqOE0+PXzATjifDrKtTZ6v4MP/MlyRj4AR5xPF+VaqZLJF1UzKdPV6P2eLDDr3I58AI44n07ZMARbo/d78gMubWE+AEecT8e9YOn2Uheu0fs9tUCYD8AR59MpG6bR+z21gKfW1gNAz4geRT5dTEZo9H5PPRDmAzBmRM8BJzqfLiYjSKKr0fs9dYBYDwBHmE9XtRfMsIz04aQZ1+j9npygrA+Akqs8wfl0BCCTWRq935MTYL1aVQ8Ao1zlAnAi8+kEQGZTNXq/vYb75Pt/fQAcUT5dBGCj93vyAaxXi+oDoFLyT3A+3Rcavd9eY3xS/z8fgCQX/LPR3SOzkon55jg1eyAfgD8M4NcAPD6aDmBtB1e4NMDNcer1QD4AbwbwxwDe4UvRE9wHZG1gNSXDLlwLNcep1QP5APxzzwj9IIAPnXhT5ORc5EYCA9HNcWr1QD4AmRH6FQBMTSZZH98ZmD5Bh5g1FopiNns1x6nTA/kAvAfAEwDudnI+EvQxPfkEzYfaCXRSBluQMB7YHKdGD+QDsBNBH/9+AkAobqTADGK7Inw1x8nfA/kA7EXQt8kgrGAGMfBxZ5Cv5ji5eyAfgL0I+r68uR0QmUFoBQU8vfNvzXHy9kA9AORoMw7CdGQCjoUZDwL4kv/+8OZ1gJhBIjGDgMh3vTavBc035/RAPgD7JegjODfhiMwgoqeJwNPPTaB6Ezq/hq+sB4AcXeXEP+ZhGVo9vRimIQD5v5oPAZCupgDI9wg8/qz/1Xz55usyeyAfgMMQ9GU2Op4eAchpOIJQQEz/VuPlm6/K7IH6AMjgGzdl6QtyX5jWjpQFevF3lq3xf6yhrOlIAUgQCojR8gmE+l9Nl2++JrMH6gEgR5UA5KYsc+AZmCbQCDi+IvgEQMob1XBEAHIajgBMLV+0kCdws6aGu3zqfkV9AGTwjftg3JRVVRAtHQEXX/wbAcoXP5d5CID8GoJKvqDAloKOoIz/y7x8c3pmD4zhaqwjRzCYyQg5gr2ZgsFTLweWr8XQgsXjbwLWrnNtMlKgNoLBmZAa7PTCAuYIBlMvlWQswwr2UlUw45jdDSx8HbD+Ctd+HVCwePKbgJV9aASDM8Yg59TWFDysYPBtmYK91IbNOHaPA/M7gUXKXA4hWDz79cA8+W0aweCMURj+1HYfcBjBYO54MMY3tGDv8I3nmWSHOzYOLJ0LLPGXAQWLz3oB8MQUsEa16kYwOG8whjh74yJkUMFgbsNlCfYO0epwissVY34bsHw2sEIRkAEEi/dcU0SP5qhF1ggG5w3GEGdXr4L5134Fg4kAjuDQgr1DtDqcUmZETwArZwAru4BVqsv0KVh8/o3F4v0QXZBGMDhvMIY4u3MYhv95Zh+Cu1xBcxuOU/HfeDIq5cv7FuwdotXhlCBXjOXZAnyrO4BV6in0IVh8wStLuWCsUAyvEQzOG5ABz+4eB+R/ewnu/kOP/3G/l4kJTERlljQtIot2e53/IwO2OPl4FLtcnCqAp9cahT56CBZf+LpSLhhz1N5qBIPzBmTAs/sLRHcTDKbiNHdBGGymOC/3hglEvgjAnoK9A7Y4+XgiV4zVWYDAs/etxaubYPFFP1QkLtCIP8neaASD8wZkwLP7AyC/tJNg8L/xLNBu+YBdBXsHbHEFAINcMVamgdWZAoRrfPdXm8KitLdmgYveWAq+2y7iMqfuRjA4b1AGOLt/APJLqwSD3+y5T1yI0AoSbAxMMzGV1o8/My2ro2DvAK2t+GgiV4zj4+3AIwDXtwBrVJeuECze+9aW4Dut4PxkIhYsdetGMDhvoDqcPRgA+SWp4O4veQ5Uv/mAGwR78+6rQq4Yq9PAOi2fA4/vBkKudKVU7VZw77uKvWFuZbtcMNb5v0YwOG9g+jx7cADyi6Pg7gccgIxlcA5TKhaD01yYKBmVFpBZMfx/m2Bvny3t8LGqoqTliZbVI+gMgHwnMAnCIFi897cLAAZ6QyzFzzSCwXkD1OPs4QDIL5XgLmk5JHk/SD5gKdibd38VcsVYGmuBTaAzEHLHgyCcaokB7/1IkUET5IKxwF5pBIPzBqbPs4cHIC/AaeqvPL9pmHxAE+zts6VdLCD/lcgVY3UyWD0Bj1ZwqgCggXA7sPfWAoAJvaEtZBrB4Lyx6efsPADyCtmCvf00s/NnOsgVY3m8BTRZPZuGBUACdArY+5lWDqGmYbIrLHEx0ggG5w1OH2fnA7CPizQfaXqgUw80AGywMdIeaAA40u5vLt4AsMHASHugAeBIu7+5eAPABgMj7YEGgCPt/ubiDQAbDIy0BxoAjrT7m4s3AGwwMNIeaAA40u5vLt4AsMHASHugAeBIu7+5eAPABgMj7YEGgCPt/ubiDQAbDIy0B8ZYNMbkX+ZekpuIiOQrPar+xs889HJg6jZg5jAwvVZ8B+ll9PlO5/Fc/o+ECjnHfi8zYfkvM5ulmp4qJXVqx5deD4zfAkw/CGxdAZgoHfuh131QkaI5hu8Bs4Ds8B0AWLnIRGCBsFfn87JffDMwdjOw5R5g8giwZa34jnQQUwDo99wBfJ4TM7COiNdlaj2rA/jeV/vfDeATAP4UGH8I2Lrc6gc+SHqY4oMZ74VSKM0xfA+UUzB/oBUUCKMl6zSQ/PsXqZD5KQC/A0w/DEwcAcYXgYnVwppwADuBkefnCim90FmBWXwnK87Uen53BI8sbuwqaz9p5UgnQhBS+ZN1zE8Ak0utviCwq8DI8/nx5hi+Bzb4gJzKZE1SEFZZgS9/2pWR/gTAJ4HJQ8DEMWB8ARhfBsaWCwDquwQKvvNgHXvOcYVbPFJPkw+dDxC/W1Y4tWDpw/Rlgo4lo1T4/KxTihDNpJwj3/UiMLXemprjffC7eWpzDN8DlYsQDiKtVxzEqoHkyX9HRizW+nIgaQnvAiaeBCbmC0s4tgSMu2rMePAR9X252jXklaTFU108K0MHav/nvJ6ZxVVk9OI7GR2IZoGQNc/HgbHgIwqILIVujuF7oOMqWFawCoRxkfEIB5CWgkREBCNf9wMTc8A4QciBWyoGz16rwNgaML5eWKpctYZL3N+TWLX0gvtuP0HHk2n16JDyxXmVhfU0qywbJbr5GSuXKxA/sV5Y9UYWdnjwyS3qKKgarWA69Wg6fjQOIK0HadnIjPVFB+AiME4AuiUkCFnESyCSkmAuU7Cjm15wX+2X2ifBRn9A8mKcW2UFjULVQcgVDl80u40SYh763FfvquhLCxitoBYUsoJfjXKttByMq9CKcHn4sPuCbgXNJwyWkECcz5Q376UX3LNncZyQAAADEklEQVT9fFgIJs6lBBwtn3Tt6FpIz4RWnuQxPh2XIGzm4CwQ9hWIFgBTK0gQHiIAJddKq0ELQh+KL1qUR4MvSEsoENIKrgALHNiMox+94K7tl9qnnMio8MSf6SNwGpYVjCDk/Ju7isq496fCqX0BkDeqlWwKwic1gAQSpzGREnFgREz01eALLvvq2Kfi45m6cf3qBXdsfxRbJMho8dimqOhEK8cXQRr9QVpvPoDNMXQP9A3ACELFxPh+jACkP0fLIKFCCRRqKuPUdqjlC9o07JZwKVNHeBC94DQcZO0XAAkmgotAk9QYrR9f/BvByYfMSATDVMzwTXMM3QMDAVAgVHCZ7/MaQK4QZUHiNCbBQlqUw74YCb7gcmYkelC9YFlwvVv7RRAorTuBkECU9asCID9/x9B935zYzyKkqpfiNHxcA0gLQgvBAaPVkCqm3h2AtC5m/RyEqzw/4xhGL3hD++MmslgqCbgUfLKAcRrmTlBzDN0DA1tAXUlWcDm1IOIIJAjlT/Fd05lbFQFwjdtgGcewesFt7Rc/Gx8iWjUCjGCT1YvWT1MwgUqrf3NG45tTbcu0aximWx9xENcEQHGbcYAEwtSXSqY0gnCdgeuMI0cvuGx/FUGgFhwEYrR80QckWN+X0fjm1DwAWv8RgJFilJZBznz0pQg+AZAAlVWh1GvGka0XzB0cCQi30aSGVa9AF62fLOB7MhrfnJoPwPER59Px+o3e76mL5Kwp2G57xPl0kxc3er+nLvyKtLmhfUC78RHn081ONnq/pzcAR5xPR9mRRu/31IVgvgUccT4dNaobvd/TGYAjzqejumqj93s6A3DE+XRUg2VSCjdaGr3fUw+I+VPwiPPpqJjO8J1Nw43e7ymHwHoAKMFd7QErAeEE5NNJMb3R+z3lsGcNzgfgiPPpomJ6o/d76oGwPgCOKJ8uKqY3er+nKwBHmE+noqRG7/fUA199U/AI8+kEwEbv93QHoEhZTnA+nYqSGr3fBoAtaiqBUImdm5hPJwA2er+nKwBHnE+X1gUzSbnR+z11wPj/AeCpPDD3t7rvAAAAAElFTkSuQmCC",$X={LOW:0,MEDIUM:1,HIGH:2,ULTRA:3},eQ=class extends FX{constructor(){let e,t,{preset:n=$X.MEDIUM,edgeDetectionMode:i=rX.COLOR,predicationMode:r=sX.DISABLED}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super("SMAAEffect","uniform sampler2D weightMap;varying vec2 vOffset0;varying vec2 vOffset1;void movec(const in bvec2 c,inout vec2 variable,const in vec2 value){if(c.x){variable.x=value.x;}if(c.y){variable.y=value.y;}}void movec(const in bvec4 c,inout vec4 variable,const in vec4 value){movec(c.xy,variable.xy,value.xy);movec(c.zw,variable.zw,value.zw);}void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec4 a;a.x=texture2D(weightMap,vOffset0).a;a.y=texture2D(weightMap,vOffset1).g;a.wz=texture2D(weightMap,uv).rb;vec4 color=inputColor;if(dot(a,vec4(1.0))>=1e-5){bool h=max(a.x,a.z)>max(a.y,a.w);vec4 blendingOffset=vec4(0.0,a.y,0.0,a.w);vec2 blendingWeight=a.yw;movec(bvec4(h),blendingOffset,vec4(a.x,0.0,a.z,0.0));movec(bvec2(h),blendingWeight,a.xz);blendingWeight/=dot(blendingWeight,vec2(1.0));vec4 blendingCoord=blendingOffset*vec4(texelSize,-texelSize)+uv.xyxy;color=blendingWeight.x*texture2D(inputBuffer,blendingCoord.xy);color+=blendingWeight.y*texture2D(inputBuffer,blendingCoord.zw);}outputColor=color;}",{vertexShader:"varying vec2 vOffset0;varying vec2 vOffset1;void mainSupport(const in vec2 uv){vOffset0=uv+texelSize*vec2(1.0,0.0);vOffset1=uv+texelSize*vec2(0.0,1.0);}",blendFunction:AX.NORMAL,attributes:PX.CONVOLUTION|PX.DEPTH,uniforms:new Map([["weightMap",new pE(null)]])}),arguments.length>1&&(e=arguments[0],t=arguments[1],arguments.length>2&&(n=arguments[2]),arguments.length>3&&(i=arguments[3])),this.renderTargetEdges=new Iv(1,1,{minFilter:dg,stencilBuffer:!1,depthBuffer:!1}),this.renderTargetEdges.texture.name="SMAA.Edges",this.renderTargetWeights=this.renderTargetEdges.clone(),this.renderTargetWeights.texture.name="SMAA.Weights",this.uniforms.get("weightMap").value=this.renderTargetWeights.texture,this.clearPass=new bX(!0,!1,!1),this.clearPass.overrideClearColor=new Ev(0),this.clearPass.overrideClearAlpha=1,this.edgeDetectionPass=new NX(new aX),this.edgeDetectionMaterial.edgeDetectionMode=i,this.edgeDetectionMaterial.predicationMode=r,this.weightsPass=new NX(new pX);let s=new ES;s.onLoad=()=>{let n=new Fv(e);n.name="SMAA.Search",n.magFilter=ug,n.minFilter=ug,n.generateMipmaps=!1,n.needsUpdate=!0,n.flipY=!0,this.weightsMaterial.searchTexture=n;let i=new Fv(t);i.name="SMAA.Area",i.magFilter=dg,i.minFilter=dg,i.generateMipmaps=!1,i.needsUpdate=!0,i.flipY=!1,this.weightsMaterial.areaTexture=i,this.dispatchEvent({type:"load"})},s.itemStart("search"),s.itemStart("area"),void 0!==e&&void 0!==t?(s.itemEnd("search"),s.itemEnd("area")):typeof Image<"u"&&(e=new Image,t=new Image,e.addEventListener("load",(()=>s.itemEnd("search"))),t.addEventListener("load",(()=>s.itemEnd("area"))),e.src=ZX,t.src=JX),this.applyPreset(n)}get edgesTexture(){return this.renderTargetEdges.texture}getEdgesTexture(){return this.edgesTexture}get weightsTexture(){return this.renderTargetWeights.texture}getWeightsTexture(){return this.weightsTexture}get edgeDetectionMaterial(){return this.edgeDetectionPass.fullscreenMaterial}get colorEdgesMaterial(){return this.edgeDetectionMaterial}getEdgeDetectionMaterial(){return this.edgeDetectionMaterial}get weightsMaterial(){return this.weightsPass.fullscreenMaterial}getWeightsMaterial(){return this.weightsMaterial}setEdgeDetectionThreshold(e){this.edgeDetectionMaterial.edgeDetectionThreshold=e}setOrthogonalSearchSteps(e){this.weightsMaterial.orthogonalSearchSteps=e}applyPreset(e){let t=this.edgeDetectionMaterial,n=this.weightsMaterial;switch(e){case $X.LOW:t.edgeDetectionThreshold=.15,n.orthogonalSearchSteps=4,n.diagonalDetection=!1,n.cornerDetection=!1;break;case $X.MEDIUM:t.edgeDetectionThreshold=.1,n.orthogonalSearchSteps=8,n.diagonalDetection=!1,n.cornerDetection=!1;break;case $X.HIGH:t.edgeDetectionThreshold=.1,n.orthogonalSearchSteps=16,n.diagonalSearchSteps=8,n.cornerRounding=25,n.diagonalDetection=!0,n.cornerDetection=!0;break;case $X.ULTRA:t.edgeDetectionThreshold=.05,n.orthogonalSearchSteps=32,n.diagonalSearchSteps=16,n.cornerRounding=25,n.diagonalDetection=!0,n.cornerDetection=!0}}setDepthTexture(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:jg;this.edgeDetectionMaterial.depthBuffer=e,this.edgeDetectionMaterial.depthPacking=t}update(e,t,n){this.clearPass.render(e,this.renderTargetEdges),this.edgeDetectionPass.render(e,t,this.renderTargetEdges),this.weightsPass.render(e,this.renderTargetEdges,this.renderTargetWeights)}setSize(e,t){this.edgeDetectionMaterial.setSize(e,t),this.weightsMaterial.setSize(e,t),this.renderTargetEdges.setSize(e,t),this.renderTargetWeights.setSize(e,t)}dispose(){let{searchTexture:e,areaTexture:t}=this.weightsMaterial;null!==e&&null!==t&&(e.dispose(),t.dispose()),super.dispose()}static get searchImageDataURL(){return ZX}static get areaImageDataURL(){return JX}},tQ={DEFAULT:0,ESKIL:1},nQ=class extends FX{constructor(){let{blendFunction:e=AX.NORMAL,technique:t=tQ.DEFAULT,eskil:n=!1,offset:i=.5,darkness:r=.5}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super("VignetteEffect","uniform float offset;uniform float darkness;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){const vec2 center=vec2(0.5);vec3 color=inputColor.rgb;\n#if VIGNETTE_TECHNIQUE == 0\nfloat d=distance(uv,center);color*=smoothstep(0.8,offset*0.799,d*(darkness+offset));\n#else\nvec2 coord=(uv-center)*vec2(offset);color=mix(color,vec3(1.0-darkness),dot(coord,coord));\n#endif\noutputColor=vec4(color,inputColor.a);}",{blendFunction:e,defines:new Map([["VIGNETTE_TECHNIQUE",t.toFixed(0)]]),uniforms:new Map([["offset",new pE(i)],["darkness",new pE(r)]])})}get technique(){return Number(this.defines.get("VIGNETTE_TECHNIQUE"))}set technique(e){this.technique!==e&&(this.defines.set("VIGNETTE_TECHNIQUE",e.toFixed(0)),this.setChanged())}get eskil(){return this.technique===tQ.ESKIL}set eskil(e){this.technique=e?tQ.ESKIL:tQ.DEFAULT}getTechnique(){return this.technique}setTechnique(e){this.technique=e}get offset(){return this.uniforms.get("offset").value}set offset(e){this.uniforms.get("offset").value=e}getOffset(){return this.offset}setOffset(e){this.offset=e}get darkness(){return this.uniforms.get("darkness").value}set darkness(e){this.uniforms.get("darkness").value=e}getDarkness(){return this.darkness}setDarkness(e){this.darkness=e}};new Float32Array(3),new Float32Array(3),new Float32Array(3),new Float32Array(3),new Float32Array(3),new Float32Array(3),new Float32Array([0,0,0]),new Float32Array([1,0,0]),new Float32Array([1,1,0]),new Float32Array([1,1,1]),new Float32Array([0,0,0]),new Float32Array([1,0,0]),new Float32Array([1,0,1]),new Float32Array([1,1,1]),new Float32Array([0,0,0]),new Float32Array([0,0,1]),new Float32Array([1,0,1]),new Float32Array([1,1,1]),new Float32Array([0,0,0]),new Float32Array([0,1,0]),new Float32Array([1,1,0]),new Float32Array([1,1,1]),new Float32Array([0,0,0]),new Float32Array([0,1,0]),new Float32Array([0,1,1]),new Float32Array([1,1,1]),new Float32Array([0,0,0]),new Float32Array([0,0,1]),new Float32Array([0,1,1]),new Float32Array([1,1,1]),new Float32Array(2),new Float32Array(2),new Float32Array([0,-.25,.25,-.125,.125,-.375,.375]),new Float32Array([0,0]),new Float32Array([.25,-.25]),new Float32Array([-.25,.25]),new Float32Array([.125,-.125]),new Float32Array([-.125,.125]),new Uint8Array([0,0]),new Uint8Array([3,0]),new Uint8Array([0,3]),new Uint8Array([3,3]),new Uint8Array([1,0]),new Uint8Array([4,0]),new Uint8Array([1,3]),new Uint8Array([4,3]),new Uint8Array([0,1]),new Uint8Array([3,1]),new Uint8Array([0,4]),new Uint8Array([3,4]),new Uint8Array([1,1]),new Uint8Array([4,1]),new Uint8Array([1,4]),new Uint8Array([4,4]),new Uint8Array([0,0]),new Uint8Array([1,0]),new Uint8Array([0,2]),new Uint8Array([1,2]),new Uint8Array([2,0]),new Uint8Array([3,0]),new Uint8Array([2,2]),new Uint8Array([3,2]),new Uint8Array([0,1]),new Uint8Array([1,1]),new Uint8Array([0,3]),new Uint8Array([1,3]),new Uint8Array([2,1]),new Uint8Array([3,1]),new Uint8Array([2,3]),new Uint8Array([3,3]),new Map([[rQ(0,0,0,0),new Float32Array([0,0,0,0])],[rQ(0,0,0,1),new Float32Array([0,0,0,1])],[rQ(0,0,1,0),new Float32Array([0,0,1,0])],[rQ(0,0,1,1),new Float32Array([0,0,1,1])],[rQ(0,1,0,0),new Float32Array([0,1,0,0])],[rQ(0,1,0,1),new Float32Array([0,1,0,1])],[rQ(0,1,1,0),new Float32Array([0,1,1,0])],[rQ(0,1,1,1),new Float32Array([0,1,1,1])],[rQ(1,0,0,0),new Float32Array([1,0,0,0])],[rQ(1,0,0,1),new Float32Array([1,0,0,1])],[rQ(1,0,1,0),new Float32Array([1,0,1,0])],[rQ(1,0,1,1),new Float32Array([1,0,1,1])],[rQ(1,1,0,0),new Float32Array([1,1,0,0])],[rQ(1,1,0,1),new Float32Array([1,1,0,1])],[rQ(1,1,1,0),new Float32Array([1,1,1,0])],[rQ(1,1,1,1),new Float32Array([1,1,1,1])]]);function iQ(e,t,n){return e+(t-e)*n}function rQ(e,t,n,i){let r=iQ(e,t,.75),s=iQ(n,i,.75);return iQ(r,s,.875)}var sQ=class{constructor(e,t){this.enabled=!1,this.effect=new e(t),Object.defineProperty(this,"opacity",{enumerable:!0,set(e){this.effect.blendMode.opacity.value=e},get(){return this.effect.blendMode.opacity.value}}),Object.defineProperty(this,"blendFunction",{enumerable:!0,set(e){this.effect.blendMode.setBlendFunction(Number(e))},get(){return this.effect.blendMode.blendFunction}}),this.blendFunction=AX.NORMAL}},aQ=class extends sQ{constructor(){super(HX),this.blendFunction=AX.SCREEN}set intensity(e){this.effect.intensity=e}get intensity(){return this.effect.intensity}set luminanceThreshold(e){this.effect.luminanceMaterial.threshold=e}get luminanceThreshold(){return this.effect.luminanceMaterial.threshold}set luminanceSmoothing(e){this.effect.luminanceMaterial.smoothing=e}get luminanceSmoothing(){return this.effect.luminanceMaterial.smoothing}set blurScale(e){this.effect.blurPass.scale=e}get blurScale(){return this.effect.blurPass.scale}set kernelSize(e){this.effect.blurPass.kernelSize=e}get kernelSize(){return this.effect.blurPass.kernelSize}},oQ=class extends sQ{constructor(){super(WX)}set contrast(e){this.effect.uniforms.get("contrast").value=e}get contrast(){return this.effect.uniforms.get("contrast").value}set brightness(e){this.effect.uniforms.get("brightness").value=e}get brightness(){return this.effect.uniforms.get("brightness").value}},lQ=class extends sQ{constructor(){super(qX),this.effect.offset=new lv(.01,.01)}set offset(e){this.effect.offset.set(e[0]/1e3,e[1]/1e3)}get offset(){return[1e3*this.effect.offset.x,1e3*this.effect.offset.y]}},uQ=class extends sQ{constructor(){super(GX)}},cQ=class extends sQ{constructor(){super(XX),this._hue=0}set hue(e){this._hue=e,this.effect.setHue(e)}get hue(){return this._hue}set saturation(e){this.effect.uniforms.get("saturation").value=e}get saturation(){return this.effect.uniforms.get("saturation").value}},hQ=class extends sQ{constructor(){super(QX),this.blendFunction=AX.OVERLAY}},dQ=class extends sQ{constructor(){super(nQ)}get eskil(){return this.effect.eskil}set eskil(e){this.effect.eskil=e}get darkness(){return this.effect.uniforms.get("darkness").value}set darkness(e){this.effect.uniforms.get("darkness").value=e}get offset(){return this.effect.uniforms.get("offset").value}set offset(e){this.effect.uniforms.get("offset").value=e}},pQ=class extends sQ{constructor(e){super(YX)}set focalLength(e){this.effect.circleOfConfusionMaterial.uniforms.focalLength.value=e/2e3}get focalLength(){return this.effect.circleOfConfusionMaterial.uniforms.focalLength.value}set focusDistance(e){this.effect.circleOfConfusionMaterial.uniforms.focusDistance.value=this.isPerspectiveCamera?e/2e3:(e+992)/2e3}get focusDistance(){return this.effect.circleOfConfusionMaterial.uniforms.focusDistance.value}get bokehScale(){return this.effect.bokehScale}set bokehScale(e){this.effect.bokehScale=e}setCamera(e){let t=!1;(e.isPerspectiveCamera&&!1===this.isPerspectiveCamera||!e.isPerspectiveCamera&&!0===this.isPerspectiveCamera)&&(t=!0),e.isPerspectiveCamera?(this.effect.circleOfConfusionMaterial.adoptCameraSettings(e.perspCamera),this.isPerspectiveCamera=!0):(this.effect.circleOfConfusionMaterial.adoptCameraSettings(e),this.isPerspectiveCamera=!1),t&&this.effect.setChanged()}},fQ=class extends sQ{constructor(){super(KX)}get granularity(){return this.effect.getGranularity()}set granularity(e){this.effect.setGranularity(e)}},mQ=class extends Ix{constructor(){super({name:"PassthroughMaterial",uniforms:{inputBuffer:new pE(null)},blending:0,depthWrite:!1,depthTest:!1,vertexShader:"#define GLSLIFY 1\nvarying vec2 vUv;void main(){gl_Position=vec4(position.xy,1.0,1.0);vUv=position.xy*0.5+0.5;}",fragmentShader:"#define GLSLIFY 1\nlayout(location=1)out vec4 gVelocity;varying vec2 vUv;uniform sampler2D inputBuffer;void main(){gl_FragColor=texture2D(inputBuffer,vUv);gVelocity=vec4(0.0);}"})}set inputBuffer(e){this.uniforms.inputBuffer.value=e}},gQ=class extends gX{constructor(){super("TAAResolvePass"),this.MRTCompatible=!0,this.needsSwap=!1,this.passThroughMaterial=new mQ,this.resolutionVector=new lv,this.resolveMaterial=new Ix({name:"TAAResolveMaterial",uniforms:{inputBuffer:new pE(null),historyBuffer:new pE(null),velocityBuffer:new pE(null),depthBuffer:new pE(null),resolution:new pE(new lv)},blending:0,depthWrite:!1,depthTest:!1,vertexShader:"#define GLSLIFY 1\nvarying vec2 vUv;varying vec2 vTexCoords[9];uniform vec2 resolution;void main(){vUv=position.xy*0.5+0.5;vec2 texelSize=vec2(1.0)/resolution;vTexCoords[0]=vUv+vec2(-texelSize.x,-texelSize.y);vTexCoords[1]=vUv+vec2(0.0,-texelSize.y);vTexCoords[2]=vUv+vec2(texelSize.x,-texelSize.y);vTexCoords[3]=vUv+vec2(-texelSize.x,0.0);vTexCoords[4]=vUv+vec2(0.0,0.0);vTexCoords[5]=vUv+vec2(texelSize.x,0.0);vTexCoords[6]=vUv+vec2(-texelSize.x,texelSize.y);vTexCoords[7]=vUv+vec2(0.0,texelSize.y);vTexCoords[8]=vUv+vec2(texelSize.x,texelSize.y);gl_Position=vec4(position.xy,1.0,1.0);}",fragmentShader:"#define GLSLIFY 1\n#include <common>\nvarying vec2 vUv;varying vec2 vTexCoords[9];uniform sampler2D inputBuffer;uniform sampler2D historyBuffer;uniform sampler2D velocityBuffer;uniform sampler2D depthBuffer;uniform vec2 resolution;\n#define USE_YCOCG\n#define USE_CATMULL_ROM\nconst float feedback_min=0.5;const float feedback_max=0.95;vec3 RGB_YCoCg(vec3 c){return vec3(c.x/4.0+c.y/2.0+c.z/4.0,c.x/2.0-c.z/2.0,-c.x/4.0+c.y/2.0-c.z/4.0);}vec3 YCoCg_RGB(vec3 c){return clamp(vec3(c.x+c.y-c.z,c.x+c.z,c.x-c.y-c.z),vec3(0.0),vec3(1.0));}vec4 sample_color(sampler2D tex,vec2 uv){\n#ifdef USE_YCOCG\nvec4 c=texture(tex,uv);return vec4(RGB_YCoCg(c.rgb),c.a);\n#else\nreturn texture(tex,uv);\n#endif\n}vec4 sample_catmull_rom(sampler2D tex,vec2 uv,vec2 texSize){vec2 samplePos=uv*texSize;vec2 texPos1=floor(samplePos-0.5)+0.5;vec2 f=samplePos-texPos1;vec2 w0=f*(-0.5+f*(1.0-0.5*f));vec2 w1=1.0+f*f*(-2.5+1.5*f);vec2 w2=f*(0.5+f*(2.0-1.5*f));vec2 w3=f*f*(-0.5+0.5*f);vec2 w12=w1+w2;vec2 offset12=w2/(w1+w2);vec2 texPos0=texPos1-1.0;vec2 texPos3=texPos1+2.0;vec2 texPos12=texPos1+offset12;texPos0/=texSize;texPos3/=texSize;texPos12/=texSize;vec4 result=vec4(0.0);result+=texture2D(tex,vec2(texPos12.x,texPos0.y))*w12.x*w0.y;result+=texture2D(tex,vec2(texPos0.x,texPos12.y))*w0.x*w12.y;result+=texture2D(tex,vec2(texPos12.x,texPos12.y))*w12.x*w12.y;result+=texture2D(tex,vec2(texPos3.x,texPos12.y))*w3.x*w12.y;result+=texture2D(tex,vec2(texPos12.x,texPos3.y))*w12.x*w3.y;return result;}vec3 choose_motion_vector(){\n#ifdef CHOOSE_LONGEST_MOTION_VECTOR\nfloat longest=-1.0;vec3 v_choose=vec3(-1.0);for(int i=0;i<9;i++){vec3 v=texture2D(velocityBuffer,vTexCoords[i]).rgb;float l=length(v.xy);if(l>longest){longest=l;v_choose=v;}}return v_choose;\n#else\nfloat closest_depth=1000.0;vec2 closest_uv_offset=vec2(0.0);for(int i=0;i<9;i++){float neighbor_depth=texture2D(depthBuffer,vTexCoords[i]).r;if(neighbor_depth<closest_depth){closest_uv_offset=vTexCoords[i];closest_depth=neighbor_depth;}}return texture2D(velocityBuffer,closest_uv_offset).rgb;\n#endif\n}vec4 clipAabb(vec3 aabb_min,vec3 aabb_max,vec4 avg,vec4 input_texel){const float FLT_EPS=0.00000001;vec3 p_clip=0.5*(aabb_max+aabb_min);vec3 e_clip=0.5*(aabb_max-aabb_min)+FLT_EPS;vec4 v_clip=input_texel-vec4(p_clip,avg.w);vec3 v_unit=v_clip.xyz/e_clip;vec3 a_unit=abs(v_unit);float ma_unit=max(a_unit.x,max(a_unit.y,a_unit.z));if(ma_unit>1.0){return vec4(p_clip,avg.w)+v_clip/ma_unit;}else{return input_texel;}}vec3 clip_aabb_variance(in vec3 cOld,in vec3 cNew,in vec3 centre,in vec3 halfSize){if(all(lessThanEqual(abs(cOld-centre),halfSize))){return cOld;}vec3 dir=(cNew-cOld);vec3 near=centre-sign(dir)*halfSize;vec3 tAll=(near-cOld)/dir;float t=0.0001;for(int i=0;i<3;i++){if(tAll[i]>=0.0&&tAll[i]<t){t=tAll[i];}}if(t>=0.0001){return cOld;}return cOld+dir*t;}void main(){vec3 v=choose_motion_vector();vec2 velocity=v.rg;vec2 previousPixelPos=vUv-velocity;vec4 currentColor=sample_color(inputBuffer,vUv);\n#ifdef USE_CATMULL_ROM\nvec4 previousColor=sample_catmull_rom(historyBuffer,previousPixelPos,resolution);\n#else\nvec4 previousColor=sample_color(historyBuffer,previousPixelPos);\n#endif\n#ifdef USE_YCOCG\npreviousColor=vec4(RGB_YCoCg(previousColor.rgb),previousColor.a);\n#endif\nvec4 ctl=sample_color(inputBuffer,vTexCoords[0]);vec4 ctc=sample_color(inputBuffer,vTexCoords[1]);vec4 ctr=sample_color(inputBuffer,vTexCoords[2]);vec4 cml=sample_color(inputBuffer,vTexCoords[3]);vec4 cmc=sample_color(inputBuffer,vTexCoords[4]);vec4 cmr=sample_color(inputBuffer,vTexCoords[5]);vec4 cbl=sample_color(inputBuffer,vTexCoords[6]);vec4 cbc=sample_color(inputBuffer,vTexCoords[7]);vec4 cbr=sample_color(inputBuffer,vTexCoords[8]);vec4 cmin=min(ctl,min(ctc,min(ctr,min(cml,min(cmc,min(cmr,min(cbl,min(cbc,cbr))))))));vec4 cmax=max(ctl,max(ctc,max(ctr,max(cml,max(cmc,max(cmr,max(cbl,max(cbc,cbr))))))));vec4 cavg=(ctl+ctc+ctr+cml+cmc+cmr+cbl+cbc+cbr)/9.0;vec4 cmin5=min(ctc,min(cml,min(cmc,min(cmr,cbc))));vec4 cmax5=max(ctc,max(cml,max(cmc,max(cmr,cbc))));vec4 cavg5=(ctc+cml+cmc+cmr+cbc)/5.0;cmin=0.5*(cmin+cmin5);cmax=0.5*(cmax+cmax5);cavg=0.5*(cavg+cavg5);\n#ifdef USE_YCOCG\nvec2 chroma_extent=vec2(0.25*0.5*(cmax.r-cmin.r));vec2 chroma_center=currentColor.gb;cmin.yz=chroma_center-chroma_extent;cmax.yz=chroma_center+chroma_extent;cavg.yz=chroma_center;\n#endif\nvec4 previousColorClipped=clamp(previousColor,cmin,cmax);\n#ifdef LUMINANCE_DIFFERENCES\n#ifdef USE_YCOCG\nfloat lum0=currentColor.r;float lum1=previousColorClipped.r;\n#else\nfloat lum0=luminance(currentColor.rgb);float lum1=luminance(previousColorClipped.rgb);\n#endif\nfloat unbiased_diff=abs(lum0-lum1)/max(lum0,max(lum1,0.2));float unbiased_weight=1.0-unbiased_diff;float unbiased_weight_sqr=unbiased_weight*unbiased_weight;float k_feedback=mix(feedback_min,feedback_max,unbiased_weight_sqr);vec4 result=mix(currentColor,previousColorClipped,vec4(k_feedback));\n#else\nconst float alpha=0.1;vec4 result=mix(currentColor,previousColorClipped,1.0-alpha);\n#endif\n#ifdef USE_YCOCG\ngl_FragColor=vec4(YCoCg_RGB(result.rgb).rgb,result.a);\n#else\ngl_FragColor=result;\n#endif\n}"}),this.historyRenderTarget=new Iv(1024,1024,{minFilter:dg,stencilBuffer:!1,depthBuffer:!1}),this.historyRenderTarget.texture.name="TAA.History",this.resultRenderTarget=new Iv(1024,1024,{minFilter:dg,stencilBuffer:!1,depthBuffer:!1}),this.resultRenderTarget.texture.name="TAA.Output"}setSize(e,t){this.historyRenderTarget.setSize(e,t),this.resultRenderTarget.setSize(e,t)}render(e,t){this.fullscreenMaterial=this.resolveMaterial,this.resolveMaterial.uniforms.inputBuffer.value=t.texture[0],this.resolveMaterial.uniforms.velocityBuffer.value=t.texture[1],this.resolveMaterial.uniforms.depthBuffer.value=t.depthTexture,this.resolveMaterial.uniforms.historyBuffer.value=this.historyRenderTarget.texture,this.resolveMaterial.uniforms.resolution.value.set(t.width,t.height),e.setRenderTarget(this.resultRenderTarget),e.render(this.scene,this.camera),this.fullscreenMaterial=this.passThroughMaterial,this.passThroughMaterial.inputBuffer=this.resultRenderTarget.texture,e.setRenderTarget(this.historyRenderTarget),e.render(this.scene,this.camera);let n=this.renderToScreen?null:t;this.fullscreenMaterial=this.passThroughMaterial,this.passThroughMaterial.inputBuffer=this.resultRenderTarget.texture,e.setRenderTarget(n),e.render(this.scene,this.camera)}dispose(){this.resultRenderTarget.dispose(),this.historyRenderTarget.dispose(),this.resolveMaterial.dispose(),this.passThroughMaterial.dispose()}},vQ=class extends gX{constructor(e,t,n){super("TransmissionPass",void 0,t),this.MRTCompatible=!0,this.depthPass=new CX(e,t,{renderTarget:n.transmissionDepthTarget}),this.passThroughMaterial=new mQ,this.splineScene=e,this.needsSwap=!1}updatePasses(e){this.passThroughMaterial=new mQ,this.depthPass=new CX(this.splineScene,this.camera,{renderTarget:e.transmissionDepthTarget})}setCamera(e){this.camera=e}setScene(e){this.splineScene=e}render(e,t,n){let i=this.camera.layers.mask,r=e;r.setRenderTarget(r.transmissionRenderTarget),this.fullscreenMaterial=this.passThroughMaterial,this.passThroughMaterial.inputBuffer=t.texture[0],r.clear(),r.render(this.scene,this.camera),this.camera.layers.disable(3),this.depthPass.render(e,t,n),r.shadowMap.needsUpdate=!1,r.shadowMap.autoUpdate=!1;let s=this.renderToScreen?null:t;this.camera.layers.set(3),e.setRenderTarget(s),e.render(this.splineScene,this.camera),this.camera.layers.mask=i}},yQ=new CD,xQ=new Ix({transparent:!0,vertexShader:"\n        void main() {\n            gl_Position = vec4(0.0);\n        }\n    ",fragmentShader:"\n        layout(location = 1) out vec4 gVelocity;\n\n        void main() {\n            gl_FragColor = vec4(0.0);\n\t\t\tgVelocity = vec4(0.0);\n        }\n    "}),bQ=class extends gX{constructor(e,t,n){super("OpaquePass",null!==t&&void 0!==t?t:yQ,n),this.MRTCompatible=!0,this.originalMaterials=[],this.hasTransmissionPass=!1,this.clear=!0,this.clearColorOnly=!1,this.clearDepth=!1,this.needsSwap=!1,this.MRTCompatible=e}setCamera(e){this.camera=e}setScene(e){this.scene=null!==e&&void 0!==e?e:yQ}getScene(){return this.scene}render(e,t){this.camera.layers.enable(3),this.hasTransmissionPass&&(this.originalMaterials.length=0,this.scene.traverse((e=>{e.layers.isEnabled(3)&&e instanceof FV&&(this.originalMaterials.push([e,e.material]),e.material=xQ)})),e.shadowMap.needsUpdate=!0,e.shadowMap.autoUpdate=!0),this.camera.layers.enable(8);let n=this.renderToScreen?null:t;e.setRenderTarget(n),this.clearColorOnly&&e.clear(!0,!1,!0),this.clear&&e.clear(),e.render(this.scene,this.camera),this.clearDepth&&e.clear(!1,!0,!1),this.hasTransmissionPass&&this.originalMaterials.forEach((e=>{e[0].material=e[1]}))}},wQ=class{constructor(e){let{depthBuffer:t=!0,stencilBuffer:n=!1,multisampling:i=0,frameBufferType:r=0}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.renderer=e,this.helperStartIndex=0,this.copyPass=new vX,this.depthTexture=null,this.timer=new UX,this._width=1,this._height=1,this.passes=[],this.helperPasses=[],this.autoRenderToScreen=!0,this.inputBuffer=this.createBuffer(t,n,r,i,!0,"input buffer mrt"),this.inputBufferSingle=this.createBuffer(t,n,r,i,!1," input buffer single"),this.inputBufferSingle.texture.dispose(),this.inputBufferSingle.depthTexture.dispose(),this.inputBufferSingle.texture=this.inputBuffer.texture[0],this.inputBufferSingle.depthTexture=this.inputBuffer.depthTexture,this.outputBuffer=this.inputBuffer.clone(),this.outputBuffer.name="output buffer mrt",this.outputBufferSingle=this.createBuffer(t,n,r,i,!1,"output buffer single"),this.outputBufferSingle.texture.dispose(),this.outputBufferSingle.depthTexture.dispose(),this.outputBufferSingle.texture=this.outputBuffer.texture[0],this.outputBufferSingle.depthTexture=this.outputBuffer.depthTexture,this.setRenderer(e)}get multisampling(){return this.inputBuffer.samples||0}set multisampling(e){let t=this.inputBuffer,n=this.multisampling;n>0&&e>0?(this.inputBuffer.samples=e,this.outputBuffer.samples=e,this.inputBuffer.dispose(),this.outputBuffer.dispose()):n!==e&&(this.inputBuffer.dispose(),this.outputBuffer.dispose(),console.log("creating new input buffer"),this.inputBuffer=this.createBuffer(t.depthBuffer,t.stencilBuffer,t.texture.type,e,!0,"new input buffer"),this.inputBuffer.depthTexture=this.depthTexture,this.outputBuffer=this.inputBuffer.clone())}getTimer(){return this.timer}getRenderer(){return this.renderer}setRenderer(e){if(this.renderer=e,null!==e){var t,n;let i=e.getSize(new lv),r=null!==(t=null===(n=e.getContext().getContextAttributes())||void 0===n?void 0:n.alpha)&&void 0!==t&&t,s=this.inputBuffer.texture[0].type;s===mg&&e.outputEncoding===Ng&&(this.inputBuffer.texture[0].encoding=Ng,this.outputBuffer.texture[0].encoding=Ng,this.inputBuffer.dispose(),this.outputBuffer.dispose(),console.log("doing some kinda dispose??")),e.autoClear=!1,this.setSize(i.width,i.height,!1);for(let t of this.passes)t.initialize(e,r,s)}}replaceRenderer(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=this.renderer,i=n.domElement.parentNode;return this.setRenderer(e),t&&null!==i&&(i.removeChild(n.domElement),i.appendChild(e.domElement)),n}createDepthTexture(){let e=this.depthTexture=new bD(this._width,this._height);return this.inputBuffer.depthTexture=e,this.inputBuffer.stencilBuffer?(e.format=Dg,e.type=xg):e.type=gg,e}deleteDepthTexture(){if(null!==this.depthTexture){this.depthTexture.dispose(),this.depthTexture=null,this.inputBuffer.depthTexture=null,this.inputBuffer.dispose();for(let e of this.passes)e.setDepthTexture(null)}}createBuffer(e,t,n,i,r,s){let a,o=this.renderer,l=null===o?new lv:o.getDrawingBufferSize(new lv),u={minFilter:dg,magFilter:dg,wrapS:og,wrapT:og,stencilBuffer:t,depthBuffer:e};return i>0?(a=new Iv(l.width,l.height,u),a.samples=i):(r?(a=new Bv(l.width,l.height,2,u),a.texture[1].type=yg):a=new Iv(l.width,l.height,u),a.depthTexture=new bD(2048,2048),a.depthTexture.type=vg),n===mg&&null!==o&&o.outputEncoding===Ng&&(Array.isArray(a.texture)?a.texture.forEach((e=>e.encoding=Ng)):a.texture.encoding=Ng),Array.isArray(a.texture)?a.texture.forEach(((e,t)=>{e.name="EffectComposer.Buffer ".concat(r," ").concat(t),e.generateMipmaps=!1})):(a.texture.name="EffectComposer.Buffer ".concat(r),a.texture.generateMipmaps=!1),a.name=s,a}addPass(e,t){var n,i;let r,s=this.passes,a=this.renderer,o=a.getDrawingBufferSize(new lv),l=null!==(n=null===(i=a.getContext().getContextAttributes())||void 0===i?void 0:i.alpha)&&void 0!==n&&n;if(e.MRTCompatible&&(r=this.inputBuffer.texture[0].type),e.MRTCompatible||(r=this.inputBuffer.texture.type),e.setRenderer(a),e.setSize(o.width,o.height),e.initialize(a,l,r),this.autoRenderToScreen&&(s.length>0&&(s[s.length-1].renderToScreen=!1),e.renderToScreen&&(this.autoRenderToScreen=!1)),void 0!==t?s.splice(t,0,e):s.push(e),this.autoRenderToScreen&&(s[s.length-1].renderToScreen=!0),e.needsDepthTexture||null!==this.depthTexture)if(null===this.depthTexture){let t=this.createDepthTexture();for(e of s)e.setDepthTexture(t)}else e.setDepthTexture(this.depthTexture)}setHelperStartIndex(e){this.helperStartIndex=e}removePass(e){let t=this.passes,n=t.indexOf(e);if(-1!==n&&t.splice(n,1).length>0){if(null!==this.depthTexture){let n=(e,t)=>e||t.needsDepthTexture;t.reduce(n,!1)||e.getDepthTexture()===this.depthTexture&&e.setDepthTexture(null)}this.autoRenderToScreen&&n===t.length&&(e.renderToScreen=!1,t.length>0&&(t[t.length-1].renderToScreen=!0))}}removeAllPasses(){let e=this.passes;e.length>0&&(this.autoRenderToScreen&&(e[e.length-1].renderToScreen=!1),this.passes=[])}render(e){let t,n,i,r,s=this.renderer,a=this.copyPass,o=this.inputBuffer,l=this.outputBuffer,u=this.inputBufferSingle,c=this.outputBufferSingle,h=!1;void 0===e&&(e=this.timer.update().getDelta());for(let d of this.passes)d.enabled&&(d.MRTCompatible?d.render(s,o,l,e,h):d.render(s,u,c,e,h),d.needsSwap&&(h&&(a.renderToScreen=d.renderToScreen,t=s.getContext(),n=s.state.buffers.stencil,n.setFunc(t.NOTEQUAL,1,4294967295),a.render(s,o,l,e,h),n.setFunc(t.EQUAL,1,4294967295)),i=o,r=u,o=l,u=c,l=i,c=r),d instanceof zX?h=!0:d instanceof yX&&(h=!1))}setSize(e,t,n){let i=this.renderer;if(this._width=e,this._height=t,void 0===e||void 0===t){let n=i.getSize(new lv);e=n.width,t=n.height}i.setSize(e,t,n);let r=i.getDrawingBufferSize(new lv);this.inputBuffer.setSize(r.width,r.height),this.outputBuffer.setSize(r.width,r.height),this.inputBufferSingle.setSize(r.width,r.height),this.outputBufferSingle.setSize(r.width,r.height);for(let s of this.passes)s.setSize(r.width,r.height)}reset(){let e=this.timer.isAutoResetEnabled();this.dispose(),this.autoRenderToScreen=!0,this.timer.setAutoResetEnabled(e)}dispose(){for(let e of this.passes)e.dispose();this.passes=[],null!==this.inputBuffer&&this.inputBuffer.dispose(),null!==this.outputBuffer&&this.outputBuffer.dispose(),null!==this.inputBufferSingle&&this.inputBufferSingle.dispose(),null!==this.outputBufferSingle&&this.outputBufferSingle.dispose(),this.deleteDepthTexture(),this.copyPass.dispose(),this.timer.dispose()}},DQ=new Ix({name:"CombineMaterial",uniforms:{inputBufferA:new pE(null),inputBufferB:new pE(null)},blending:0,depthWrite:!1,depthTest:!1,vertexShader:"\nvarying vec2 vUv;\nvoid main() {\n    gl_Position = vec4(position.xy, 1.0, 1.0);\n    vUv = position.xy * 0.5 + 0.5;\n}\n",fragmentShader:"\n    varying vec2 vUv;\n    uniform sampler2D inputBufferA;\n    uniform sampler2D inputBufferB;\n\n    // TODO: Why do we need these when postpro of framemode is enabled???\n    layout(location = 1) out vec4 gVelocity;\n\n    void main() {\n\tvec4 resA = texture2D(inputBufferA, vUv);\n\tvec4 resB = texture2D(inputBufferB, vUv);\n    float a = resA.a + resB.a * ( 1.0 - resA.a );\n\n\tvec4 res;\n\tres.rgb =  resA.rgb + (resB.rgb * (1.0 - resA.a));\n\tres.a = resA.a + resB.a * (1.0 - resA.a);\n\tgl_FragColor = res;\n    gVelocity = vec4(0.0);\n    }\n"}),_Q=class extends gX{constructor(e){super("HelperPass",void 0,e),this.MRTCompatible=!1,this.fullscreenMaterial=DQ,this.helperPass=new bQ(!1,void 0,this.camera),this.helperPass.hasTransmissionPass=!1,this.helperPass.clear=!1,this.helperPass.renderToScreen=!1,this.helperPassOnTop=new bQ(!1,void 0,this.camera),this.helperPassOnTop.hasTransmissionPass=!1,this.helperPassOnTop.clear=!1,this.helperPassOnTop.renderToScreen=!1;let t=new eQ({preset:$X.LOW,edgeDetectionMode:rX.COLOR});this.effectPass=new kX(this.camera,t),this.rt=new Iv(10,10,{minFilter:dg,magFilter:dg,wrapS:og,wrapT:og,depthBuffer:!0})}setSize(e,t){this.rt.setSize(e,t),this.effectPass.setSize(e,t)}set sceneHelpers(e){this.helperPass.setScene(e)}get sceneHelpers(){return this.helperPass.getScene()}set sceneHelpersOnTop(e){this.helperPassOnTop.setScene(e)}get sceneHelpersOnTop(){return this.helperPassOnTop.getScene()}setCamera(e){this.helperPass.setCamera(e),this.helperPassOnTop.setCamera(e)}initialize(e,t,n){super.initialize(e,t,n),this.effectPass.initialize(e,t,n)}dispose(){super.dispose(),this.rt.dispose(),this.effectPass.dispose()}render(e,t,n){this.rt.depthTexture=t.depthTexture;let i=e.getClearAlpha();e.setClearAlpha(0),this.helperPass.clearDepth=!0,this.helperPass.clearColorOnly=!0,this.helperPass.render(e,this.rt),this.helperPassOnTop.render(e,this.rt),this.effectPass.renderToScreen=!1,this.effectPass.render(e,this.rt,n),this.fullscreenMaterial.uniforms.inputBufferA.value=n.texture,this.fullscreenMaterial.uniforms.inputBufferB.value=t.texture,e.setClearAlpha(i),e.setRenderTarget(null),e.clear(),e.render(this.scene,this.camera)}},SQ=[[.478712,.875764],[-.337956,-.793959],[-.955259,-.028164],[.864527,.325689],[.209342,-.395657],[-.106779,.672585],[.156213,.235113],[-.413644,-.082856],[-.415667,.323909],[.141896,-.93998],[.954932,-.182516],[-.766184,.410799],[-.434912,-.458845],[.415242,-.078724],[.728335,-.491777],[-.058086,-.066401],[.20299,.686837],[-.808362,-.556402],[.507386,-.640839],[-.723494,-.22924],[.48974,.317826],[-.622663,.765301],[-.01064,.929347],[.663146,.647618],[-.096674,-.413835],[.525945,-.321063],[-.122533,.366019],[.195235,-.687983],[-.563203,.098748],[.418563,.561335],[-.378595,.800367],[.826922,.001024],[-.085372,-.766651],[-.92192,.183673],[-.590008,-.721799],[.167751,-.164393],[.032961,-.56253],[.6329,-.107059],[-.46408,.569669],[-.173676,-.958758],[-.242648,-.234303],[-.275362,.157163],[.382295,-.795131],[.562955,.115562],[.190586,.470121],[.770764,-.297576],[.237281,.93105],[-.666642,-.455871],[-.905649,-.298379],[.33952,.157829],[.701438,-.7041],[-.062758,.160346],[-.220674,.957141],[.642692,.432706],[-.77339,-.015272],[-.671467,.24688],[.158051,.062859],[.806009,.527232],[-.05762,-.247071],[.333436,-.51671],[-.550658,-.315773],[-.652078,.589846],[.008818,.530556],[-.210004,.519896]],EQ=new Ix({vertexShader:"#define GLSLIFY 1\n#include <skinning_pars_vertex>\n#include <morphtarget_pars_vertex>\nout vec3 n;void main(){\n#include <beginnormal_vertex>\n#include <morphnormal_vertex>\n#include <skinbase_vertex>\n#include <skinnormal_vertex>\n#include <defaultnormal_vertex>\n#include <begin_vertex>\n#include <morphtarget_vertex>\n#include <skinning_vertex>\nvec4 view_space=viewMatrix*modelMatrix*vec4(transformed,1.0);gl_Position=projectionMatrix*view_space;n=normalize(transformedNormal);}",fragmentShader:"#define GLSLIFY 1\nin vec3 n;void main(){gl_FragColor=vec4(n,1.0);}"}),CQ=new Ix({vertexShader:"#define GLSLIFY 1\nout vec2 v_uv;void main(){gl_Position=vec4(position.xy,1.0,1.0);v_uv=uv;}",fragmentShader:"#define GLSLIFY 1\nin vec2 v_uv;uniform sampler2D texture_ao_lrez;uniform sampler2D texture_depth_lrez;uniform sampler2D texture_depth_hrez;uniform float near;uniform float far;float linearize_depth(float depth_sampled){float z=depth_sampled*2.0-1.0;return(2.0*near*far)/(far+near-z*(far-near));}vec2 nearest_depth_filter(in vec2 uv){vec2 resolution=vec2(textureSize(texture_depth_lrez,0));vec2 texel_size=1.0/resolution;vec2 offset=uv-0.5*texel_size;float d_hrez=texture(texture_depth_hrez,uv).r;float a=abs(d_hrez-texture(texture_depth_lrez,offset).r);float b=abs(d_hrez-texture(texture_depth_lrez,offset+vec2(texel_size.x,0.0)).r);float c=abs(d_hrez-texture(texture_depth_lrez,offset+vec2(0.0,texel_size.y)).r);float d=abs(d_hrez-texture(texture_depth_lrez,offset+vec2(texel_size.x,texel_size.y)).r);float min_diff=min(a,min(b,min(c,d)));if(min_diff==a)return offset;if(min_diff==b)return offset+vec2(texel_size.x,0.0);if(min_diff==c)return offset+vec2(0.0,texel_size.y);if(min_diff==d)return offset+vec2(texel_size.x,texel_size.y);}void main(){\n#ifdef DEBUG\nfloat d_lrez=texture(texture_depth_lrez,v_uv).r;float d_hrez=texture(texture_depth_hrez,v_uv).r;float output_d=mix(linearize_depth(d_lrez)/far,linearize_depth(d_hrez)/far,step(0.5,v_uv.x));gl_FragColor=vec4(vec3(output_d),1.0);\n#else\nvec2 filtered_uv=nearest_depth_filter(v_uv);vec4 ao=texture(texture_ao_lrez,filtered_uv);gl_FragColor=vec4(ao.rgb,1.0);gl_FragColor=ao;\n#endif\n}",uniforms:{texture_ao_lrez:new pE(null),texture_depth_lrez:new pE(null),texture_depth_hrez:new pE(null),near:new pE(null),far:new pE(null)}}),AQ=class extends gX{constructor(e,t){super("AmbientOcclusionPass",void 0,t),this.fogEnabled=!1,this.fogNear=1,this.fogFar=1e3,this.frameIndex=0,this._runHalfRes=!0,this._width=1,this._height=1;let n=1024,i=1024;this.gBuffer=new Iv(n,i,{type:_F?yg:vg,depthTexture:new bD(n,i),minFilter:dg,magFilter:dg}),this.depthBufferHighRes=new Iv(n,i,{depthTexture:new bD(n,i)}),this.aoBuffer=new Iv(n,i,{minFilter:dg,magFilter:dg}),this.splineScene=e,this.splineCamera=t;let r=new Float32Array(2*SQ.length);for(let a=0;a<SQ.length;a++){let e=2*a;r[e+0]=SQ[a][0],r[e+1]=SQ[a][1]}this.blueNoiseInDiskTexture=new FD(r,SQ.length,1,Sg,vg),this.blueNoiseInDiskTexture.wrapS=ag,this.blueNoiseInDiskTexture.wrapT=ag,this.blueNoiseInDiskTexture.needsUpdate=!0,this.hbaoMaterial=new Ix({vertexShader:"#define GLSLIFY 1\nout vec2 v_uv;void main(){v_uv=uv;gl_Position=vec4(position.xy,1.0,1.0);}",fragmentShader:"#define GLSLIFY 1\nin vec2 v_uv;const float pi=3.14159265;const float num_steps=4.0;const float num_directions=4.0;uniform float near;uniform float far;uniform float fov;uniform vec4 proj_info;uniform bool is_ortho;uniform vec2 resolution;uniform float radius_of_influence;uniform float radius_in_screen_space;uniform float exponent;uniform vec3 ao_color;uniform float bias;uniform sampler2D texture_depth;uniform sampler2D texture_normals;uniform sampler2D texture_blue_noise;uniform sampler2D texture_blue_noise_in_disk;uniform sampler2D texture_color_pass;uniform int frame_index;uniform bool fog_enabled;uniform float fog_near;uniform float fog_far;vec3 uv_to_view_space(vec2 uv,float eye_z){return vec3((uv*proj_info.xy+proj_info.zw)*(is_ortho ? 1.0 : eye_z),eye_z);}float linearize_depth(float depth_sampled){float z=is_ortho ? depth_sampled : depth_sampled*2.0-1.0;return mix((2.0*near*far)/(far+near-z*(far-near)),near+z*(far-near),float(is_ortho));}vec3 get_view_position(vec2 uv_coords){float linear_depth=linearize_depth(texture(texture_depth,uv_coords).x);return uv_to_view_space(uv_coords,linear_depth);}vec3 min_difference(vec3 p,vec3 right,vec3 left){vec3 v1=right-p;vec3 v2=p-left;return(dot(v1,v1)<dot(v2,v2))? v1 : v2;}vec3 rebuild_normal(in vec2 uv,in vec3 p){vec2 one_over_resolution=1.0/resolution;vec3 r=get_view_position(uv+vec2(one_over_resolution.x,0));vec3 l=get_view_position(uv+vec2(-one_over_resolution.x,0));vec3 t=get_view_position(uv+vec2(0,one_over_resolution.y));vec3 b=get_view_position(uv+vec2(0,-one_over_resolution.y));return normalize(cross(min_difference(p,r,l),min_difference(p,t,b)));}float falloff(float distance_squared){float neg_inv_r2=-1.0/(radius_of_influence*radius_of_influence);return distance_squared*neg_inv_r2+1.0;}float ao_contribution(vec3 P,vec3 N,vec3 S){vec3 to_sample=S-P;float norm_squared=dot(to_sample,to_sample);float norm=sqrt(norm_squared);float cos_theta=dot(N,to_sample)/norm;return clamp(cos_theta-bias,0.0,1.0)*clamp(falloff(norm_squared),0.0,1.0);}float compute_ambient_occlusion(vec2 uv,float radius_in_screen_space,vec3 pc,vec3 view_space_n){vec2 one_over_resolution=1.0/resolution;ivec2 noise_uv=ivec2(int(mod(gl_FragCoord.x,128.0)),int(mod(gl_FragCoord.y,128.0)));float noise=texelFetch(texture_blue_noise,noise_uv,0).r;noise=fract(noise+0.61803398875*float(frame_index));float theta=noise*2.0*3.1415;float ct=cos(theta);float st=sin(theta);float step_size=radius_in_screen_space/(num_steps+1.0);const float angle_step=2.0*pi/num_directions;float contribution=0.0;for(int i=0;i<int(num_directions);++i){float current_pixel=step_size+1.0;for(int j=0;j<int(num_steps);++j){int index=i*int(num_steps)+j;vec2 blue_noise_sample=texelFetch(texture_blue_noise_in_disk,ivec2(index,0),0).rg;vec2 disk_point;disk_point.x=blue_noise_sample.x*ct-blue_noise_sample.y*st;disk_point.y=blue_noise_sample.x*st+blue_noise_sample.y*ct;vec2 sample_direction=disk_point;vec2 snapped_uv=round(current_pixel*sample_direction)*one_over_resolution+uv;vec3 ps=get_view_position(snapped_uv);current_pixel+=step_size;contribution+=ao_contribution(pc,view_space_n,ps);}}float mult=1.0/(1.0-bias);contribution*=mult/(num_directions*num_steps);return clamp(1.0-contribution*2.0,0.0,1.0);}\n#define USE_GBUFFER_NORMALS\nvoid main(){vec3 view_space_p=get_view_position(v_uv);\n#ifdef USE_GBUFFER_NORMALS\nvec3 view_space_n=texture(texture_normals,v_uv).rgb;view_space_n.z*=-1.0;\n#else\nvec3 view_space_n=-rebuild_normal(v_uv,view_space_p);\n#endif\nfloat radius_ss=radius_in_screen_space/(is_ortho ? 1.0 : view_space_p.z);float ao=compute_ambient_occlusion(v_uv,radius_ss,view_space_p,view_space_n);float final=pow(ao,exponent);if(view_space_p.z>=far){final=1.0;}vec3 color=mix(ao_color,vec3(1.0),final);if(fog_enabled){float fog_factor=smoothstep(fog_near,fog_far,view_space_p.z);color=mix(color,vec3(1.0),fog_factor);}gl_FragColor=vec4(color,1.0);}",uniforms:{near:new pE(null),far:new pE(null),fov:new pE(null),proj_info:new pE(new Ov),is_ortho:new pE(!1),resolution:new pE(new lv),radius_of_influence:new pE(8),radius_in_screen_space:new pE(1),exponent:new pE(1),ao_color:new pE(new Lv),bias:new pE(.5),texture_depth:new pE(null),texture_normals:new pE(null),texture_blue_noise:new pE(null),texture_blue_noise_in_disk:new pE(this.blueNoiseInDiskTexture),frame_index:new pE(0),fog_enabled:new pE(!1),fog_near:new pE(1),fog_far:new pE(1e3)}}),this.radius=128,this.aoColor={r:0,g:0,b:0},this.bias=.5,this.hbaoMaterial.uniforms.texture_depth.value=this.gBuffer.depthTexture,this.hbaoMaterial.uniforms.texture_normals.value=this.gBuffer.texture,this.needsSwap=!0,this.aaBuffer=new Iv(n,i,{minFilter:dg,magFilter:dg,wrapS:og,wrapT:og,depthBuffer:!1,type:vg});let s=new eQ({preset:$X.ULTRA,edgeDetectionMode:rX.COLOR});this.effectPass=new kX(this.camera,s)}initialize(e,t,n){super.initialize(e,t,n),this.effectPass.initialize(e,t,n)}setBlueNoiseTexture(e){this.hbaoMaterial.uniforms.texture_blue_noise.value=e}setSize(e,t){this._width=e,this._height=t,this.depthBufferHighRes.setSize(e,t);let n=this._runHalfRes?.5:1,i=e*n,r=t*n;this.gBuffer.setSize(i,r),this.aoBuffer.setSize(i,r),this.hbaoMaterial.uniforms.resolution.value.set(i,r),this.aaBuffer.setSize(i,r),this.effectPass.setSize(i,r)}get runHalfRes(){return this._runHalfRes}set runHalfRes(e){this._runHalfRes=e,this.setSize(this._width,this._height)}setCamera(e){this.splineCamera=e}setScene(e){this.splineScene=e}setDepthTexture(e){this.depthBufferHighRes.depthTexture=e,CQ.uniforms.texture_depth_hrez.value=e,CQ.needsUpdate=!0}render(e,t,n){this.splineScene.overrideMaterial=EQ;let i=this.splineCamera.layers.mask;if(this.splineCamera.layers.set(5),e.setRenderTarget(this.gBuffer),e.clear(),e.render(this.splineScene,this.splineCamera),e.setRenderTarget(this.depthBufferHighRes),e.clear(),e.render(this.splineScene,this.splineCamera),this.splineScene.overrideMaterial=null,this.splineCamera.layers.mask=i,this.hbaoMaterial.uniforms.radius_of_influence.value=this.radius,this.hbaoMaterial.uniforms.ao_color.value.set(this.aoColor.r,this.aoColor.g,this.aoColor.b),this.hbaoMaterial.uniforms.bias.value=this.bias,this.hbaoMaterial.uniforms.fog_enabled.value=this.fogEnabled,this.hbaoMaterial.uniforms.fog_near.value=this.fogNear,this.hbaoMaterial.uniforms.fog_far.value=this.fogFar,this.hbaoMaterial.uniforms.frame_index.value=this.frameIndex,this.frameIndex++,this.splineCamera.isPerspectiveCamera){this.hbaoMaterial.uniforms.near.value=this.splineCamera.perspCamera.near,this.hbaoMaterial.uniforms.far.value=this.splineCamera.perspCamera.far;let e=this.splineCamera.perspCamera.projectionMatrix.elements,t=2/e[0],n=2/e[5],i=-(1-e[8])/e[0],r=-(1+e[9])/e[5];this.hbaoMaterial.uniforms.proj_info.value.set(t,n,i,r);let s=this.splineCamera.perspCamera.fov*(Math.PI/180),a=this.hbaoMaterial.uniforms.resolution.value.y/(2*Math.tan(.5*s)),o=.5*this.hbaoMaterial.uniforms.radius_of_influence.value*a;this.hbaoMaterial.uniforms.radius_in_screen_space.value=o,this.hbaoMaterial.uniforms.is_ortho.value=!1}else{this.hbaoMaterial.uniforms.near.value=this.splineCamera.orthoCamera.near,this.hbaoMaterial.uniforms.far.value=this.splineCamera.orthoCamera.far;let e=this.splineCamera.orthoCamera.projectionMatrix.elements,t=2/e[0],n=2/e[5],i=-(1+e[12])/e[0],r=-(1-e[13])/e[5];this.hbaoMaterial.uniforms.proj_info.value.set(t,n,i,r);let s=this.hbaoMaterial.uniforms.resolution.value.y/n*.5,a=this.hbaoMaterial.uniforms.radius_of_influence.value*s;this.hbaoMaterial.uniforms.radius_in_screen_space.value=a,this.hbaoMaterial.uniforms.is_ortho.value=!0}this.runHalfRes?(this.fullscreenMaterial=this.hbaoMaterial,e.setRenderTarget(this.aoBuffer),e.clear(),e.render(this.scene,this.camera),this.fullscreenMaterial=CQ,CQ.uniforms.texture_ao_lrez.value=this.aoBuffer.texture,CQ.uniforms.texture_depth_lrez.value=this.gBuffer.depthTexture,CQ.uniforms.texture_depth_hrez.value=this.depthBufferHighRes.depthTexture,e.setRenderTarget(e.aoRenderTarget),e.clear(),e.render(this.scene,this.camera)):(this.fullscreenMaterial=this.hbaoMaterial,e.setRenderTarget(this.aaBuffer),e.clear(),e.render(this.scene,this.camera),this.effectPass.renderToScreen=!1,this.effectPass.render(e,this.aaBuffer,e.aoRenderTarget))}dispose(){this.gBuffer.dispose(),this.depthBufferHighRes.dispose(),this.aoBuffer.dispose()}},MQ=class extends NX{constructor(){super(new Ix({vertexShader:"\nvarying vec2 vUv;\nvoid main() {\n    vUv = uv;\n    gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",fragmentShader:"\nuniform sampler2D tInput;\nuniform sampler2D tMap;\nuniform vec2 resolution;\nvarying vec2 vUv;\n\nuniform vec2 uResolution;\nuniform vec2 uCoords;\n\n// Draws a rectangle at center <st> with size <size>\nfloat rectangle(vec2 st, vec2 size) {\n    size = vec2(0.5) - size * 0.5;\n    vec2 uv = vec2(step(size.x, st.x), step(size.y, st.y));\n    uv *= vec2(step(size.x, 1.0 - st.x), step(size.y, 1.0 - st.y));\n\n    return uv.x * uv.y;\n}\n\nuniform vec2 uSize;\nuniform float uScale;\nuniform float uDPR;\nuniform float uCurrent;\nuniform vec3 uSceneColor;\n\nvoid main() {\n    vec2 screenUv = gl_FragCoord.xy / uResolution.xy;\n    screenUv *= 1.0 / uDPR;\n\n    vec2 center = vec2(0.5, -0.5);\n    vec2 outsideUv = screenUv;\n    outsideUv += center;\n    outsideUv -= uCoords.xy / uResolution.xy;\n    outsideUv = (outsideUv - 0.5) + 0.5;\n    outsideUv -= center;\n    vec2 s = (uSize / uResolution) * uScale;\n    float isOutside = 1.0 - rectangle(outsideUv, s);\n    \n    vec2 mid = vec2(0.5);\n    vec2 insideUv = (screenUv - mid + s * mid) / s;\n    vec4 background = texture2D(tInput, screenUv);\n    vec4 image = texture2D(tMap, insideUv);\n    gl_FragColor = mix(image, background, isOutside);\n}\n",uniforms:{tInput:new pE(null),tMap:new pE(null),uResolution:new pE(new lv),uSize:new pE(new lv),uCoords:new pE(new lv),uScale:new pE(1),uSceneColor:new pE(new Ev(16711680)),uDPR:new pE(1),uCurrent:new pE(0)}}),"tInput"),this.needsSwap=!0}get uniforms(){return this.fullscreenMaterial.uniforms}get texture(){return this.uniforms.tMap.value}set texture(e){this.uniforms.tMap.value=e}},TQ=[],PQ=class extends NX{constructor(){super(new Ix({vertexShader:"\nvoid main() {\n    gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",fragmentShader:"\nuniform sampler2D toScene;\nuniform sampler2D fromScene;\nuniform vec2 resolution;\n\nuniform vec2 uResolution;\nuniform float uDPR;\n\nuniform float mixRatio;\nuniform sampler2D tMixTexture;\nuniform int useTexture;\nuniform float threshold;\n\nvoid main() {\n\tvec2 screenUv = gl_FragCoord.xy / uResolution.xy;\n\tscreenUv *= 1.0 / uDPR;\n\n\tvec4 texel1 = texture2D( fromScene, screenUv );\n\tvec4 texel2 = texture2D( toScene, screenUv );\n\n\tif (useTexture==1) {\n\t\t\n\t\tvec4 transitionTexel = texture2D( tMixTexture, screenUv );\n\t\tfloat r = mixRatio * (1.0 + threshold * 2.0) - threshold;\n\t\tfloat mixf=clamp((transitionTexel.r - r)*(1.0/threshold), 0.0, 1.0);\n\t\t\n\t\tgl_FragColor = mix( texel1, texel2, mixf );\n\t} else {\n\t\t\n\t\tgl_FragColor = mix( texel1, texel2, mixRatio );\n\t\t\n\t}\n}\n",uniforms:{toScene:new pE(null),fromScene:new pE(null),uResolution:new pE(new lv),uDPR:new pE(1),mixRatio:new pE(0),threshold:new pE(.1),useTexture:new pE(0),tMixTexture:{value:TQ[0]}}}),"toScene"),this.needsSwap=!0}get uniforms(){return this.fullscreenMaterial.uniforms}get texture(){return this.uniforms.fromScene.value}set texture(e){this.uniforms.fromScene.value=e}},FQ=class extends NX{constructor(){super(new Ix({vertexShader:"\nvoid main() {\n    gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",fragmentShader:"\nuniform sampler2D inputBuffer;\nuniform sampler2D blurredInputBuffer;\nuniform sampler2D overlay;\nuniform float blurIntensity;\n\nuniform vec2 uResolution;\nuniform float uDPR;\n\nvoid main() {\n\tvec2 screenUv = gl_FragCoord.xy / uResolution.xy;\n\tscreenUv *= 1.0 / uDPR;\n\n\tvec4 texel1 = texture2D( overlay, screenUv );\n\tvec4 texel2 = texture2D( inputBuffer, screenUv );\n\tvec4 texel3 = texture2D( blurredInputBuffer, screenUv );\n\n\tfloat blurMask2 = max(sign(texel1.a), 0.0) * blurIntensity;\n    gl_FragColor = mix( mix(texel2, texel3, blurMask2), texel1, texel1.a );\n}\n",uniforms:{inputBuffer:new pE(null),blurredInputBuffer:new pE(null),overlay:new pE(null),uResolution:new pE(new lv),uDPR:new pE(1),blurIntensity:new pE(0)}})),this._blurEnabled=!1,this.blurTarget=new Iv(1,1,{minFilter:dg,magFilter:dg,wrapS:og,wrapT:og}),this.blurPass=new RX({width:window.innerWidth,height:window.innerHeight,kernelSize:VX.HUGE,resolutionScale:.25}),this.blurPass.renderToScreen=!1,this.uniforms.blurredInputBuffer.value=this.blurTarget.texture}get uniforms(){return this.fullscreenMaterial.uniforms}get texture(){return this.uniforms.overlay.value}set texture(e){this.uniforms.overlay.value=e}setResolution(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;this.uniforms.uResolution.value.set(e,t),this.uniforms.uDPR.value=n,this.blurPass.setSize(e,t),this.blurTarget.setSize(e,t),this.blurPass.setSize(e,t)}get uiCanvas(){return this._uiCanvas}set uiCanvas(e){this._uiCanvas=e,e.texture&&(this.uniforms.overlay.value=e.texture);let t=e.frame;if(t){let e=t.data.backgroundBlur,n=e.radius;this._blurEnabled=e.enabled,this.uniforms.blurIntensity.value=this._blurEnabled?1:0,this.blurPass.scale=n/3}}render(e,t,n,i,r){this._blurEnabled&&(this.blurPass.setDepthTexture(this.getDepthTexture()),this.blurPass.render(e,t,this.blurTarget,i,r)),super.render(e,t,n,i,r)}},OQ=class extends NX{constructor(){super(new Ix({vertexShader:"\nvarying vec2 vUv;\nvoid main() {\n    vUv = uv;\n    gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",fragmentShader:"\nuniform sampler2D tInput;\nuniform sampler2D tOverlayImage;\nvarying vec2 vUv;\nuniform vec2 uResolution;\nuniform vec2 uRightBottom;\nuniform vec2 uImageSize;\nuniform float uScale;\nuniform float uDPR;\n\nvec3 blendNormal(vec3 base, vec3 blend) {\n\treturn blend;\n}\n\nvec3 blendNormal(vec3 base, vec3 blend, float opacity) {\n\treturn (blendNormal(base, blend) * opacity + base * (1.0 - opacity));\n}\n\nvec4 drawFixedSizeImage(sampler2D image, vec2 screenUV, vec2 imageSize, vec2 imageCoords, vec2 screenSize, float dpr) {\n\tvec2 uv = (screenUV * screenSize * dpr - imageCoords) / (imageSize * dpr);\n\tif (uv.x < 0.0 || uv.x > 1.0 || uv.y < 0.0 || uv.y > 1.0) {\n\t\treturn vec4(0.0);\n\t}\n\treturn texture2D(image, uv);\n}\n\nvoid main() {\n    vec2 screenUV = gl_FragCoord.xy / (uResolution.xy * uDPR);\n\tvec2 imageCoords = vec2(uResolution.x * uDPR - uImageSize.x * uScale * uDPR - uRightBottom.x * uDPR, uRightBottom.y * uDPR);\n    vec4 background = texture2D(tInput, screenUV);\n    vec4 image = drawFixedSizeImage(tOverlayImage, screenUV, uImageSize * uScale, imageCoords, uResolution, uDPR);\n    gl_FragColor = vec4(blendNormal(background.rgb, image.rgb, image.a), max(background.a, image.a));\n}\n",uniforms:{tInput:new pE(null),tOverlayImage:new pE(null),uResolution:new pE(new lv),uImageSize:new pE(new lv),uRightBottom:new pE(new lv(20,20)),uScale:new pE(.25),uDPR:new pE(1)}}),"tInput")}get uniforms(){return this.fullscreenMaterial.uniforms}get texture(){return this.uniforms.tOverlayImage.value}set texture(e){this.uniforms.tOverlayImage.value=e,this.uniforms.uImageSize.value.set(e.image.width,e.image.height)}};function IQ(e,t){return t&&t.enabled&&e.push(t.effect),e}var kQ=e=>Object.values(AX).includes(e)?e:AX.NORMAL,BQ=class extends Yg{constructor(e,t){super(),this._needsDOFResize=t,this.postprocessingState=FB.defaultData,this._scene=new CD,this._camera=new OY,this.effects=new Map,this.blueNoiseTexture=new FD,this._renderToScreen=!0,this._isUIOverlayEnabled=!1,this.clock=new KS,this.renderer=e,this.debug=!1,this.effects.set("bloom",new aQ),this.effects.set("chromaticAberration",new lQ),this.effects.set("vignette",new dQ),this.effects.set("noise",new hQ),this.effects.set("colorAverage",new uQ),this.effects.set("hueSaturation",new cQ),this.effects.set("brightnessContrast",new oQ),this.effects.set("depthOfField",new pQ),this.effects.set("pixelation",new fQ),this.effectComposer=new wQ(this.renderer),this.effectComposer.autoRenderToScreen=!1,this.opaquePass=new bQ(!0,this.scene,this.camera),this.opaquePass.clear=!0,this.transmissionPass=new vQ(this.scene,this.camera,this.renderer),this.aoPass=new AQ(this.scene,this.camera),this.taaPass=new gQ,this.taaPass.renderToScreen=!1,this.helperPass=new _Q(this.camera),this.helperPass.renderToScreen=!1,this.stylesOverlayPass=new MQ,this.stylesOverlayPass.enabled=!1,this.uiOverlayPass=new FQ,this.uiOverlayPass.enabled=!1,this.logoOverlayPass=new OQ,this.logoOverlayPass.enabled=!1,this.sceneTransitionPass=new PQ,this.sceneTransitionPass.enabled=!1,this._initCopyPass(),this._initPasses()}set overlayTexture(e){void 0!==e?(this.stylesOverlayPass.texture=e,this.stylesOverlayPass.enabled=!0):this.stylesOverlayPass.enabled=!1}get overlayTexture(){return this.stylesOverlayPass.texture}set sceneHelpers(e){this.helperPass.sceneHelpers=e}get sceneHelpers(){return this.helperPass.sceneHelpers}set sceneHelpersOnTop(e){this.helperPass.sceneHelpersOnTop=e}get sceneHelpersOnTop(){return this.helperPass.sceneHelpersOnTop}get scene(){return this._scene}set scene(e){this._scene=e,this.opaquePass.setScene(e),this.transmissionPass.setScene(e),this.aoPass.setScene(e)}get camera(){return this._camera}set camera(e){let t=this._camera!==e;this._camera=e,this.opaquePass.setCamera(e),this.transmissionPass.setCamera(e),t&&this.transmissionPass.updatePasses(this.renderer),this.aoPass.setCamera(e),this.helperPass.setCamera(e),this.effects.get("depthOfField").setCamera(e)}updateRenderToScreen(){let e=!1;for(let t=this.effectComposer.passes.length-1;t>=0;t--){let n=this.effectComposer.passes[t];!0!==n.enabled||e||!this._renderToScreen?n.renderToScreen=!1:(n.renderToScreen=!0,e=!0)}}get isUIOverlayEnabled(){return this._isUIOverlayEnabled}disableUIOverlay(){this._isUIOverlayEnabled=!1}enableUIOverlay(){this._isUIOverlayEnabled=!0}disableHelpers(){this.helperPass.enabled=!1,this.updateRenderToScreen()}enableHelpers(){this.helperPass.enabled=!0,this.updateRenderToScreen()}updateBlueNoiseTexture(e){this.blueNoiseTexture=new FD(e,128,128),this.blueNoiseTexture.wrapS=ag,this.blueNoiseTexture.wrapT=ag,this.blueNoiseTexture.minFilter=ug,this.blueNoiseTexture.magFilter=ug,this.blueNoiseTexture.needsUpdate=!0}setAmbientOcclusionParams(e,t,n,i,r,s,a,o){this.aoPass.enabled=e,this.aoPass.radius=t,this.aoPass.bias=n,this.aoPass.aoColor=i,this.aoPass.fogEnabled=r,this.aoPass.fogNear=s,this.aoPass.fogFar=a,this.aoPass.runHalfRes!==!o&&(this.aoPass.runHalfRes=!o)}setTransmissionPassEnabled(e){this.transmissionPass.enabled=e,this.opaquePass.hasTransmissionPass=e}_initPasses(){var e,t;if(null!==(e=this.uvEffectPass)&&void 0!==e&&e.dispose(),null!==(t=this.effectPass)&&void 0!==t&&t.dispose(),this.effectComposer.removeAllPasses(),this.transmissionPass.updatePasses(this.renderer),this.effectComposer.addPass(this.aoPass),this.effectComposer.addPass(this.opaquePass),this.effectComposer.addPass(this.transmissionPass),this.effectComposer.addPass(this.taaPass),this.postprocessingState.enabled){var n;let e=[this.effects.get("pixelation")].reduce(IQ,[]);e.length>0&&(this.uvEffectPass=new kX(this.camera,...e),this.uvEffectPass.renderToScreen=!1,this.effectComposer.addPass(this.uvEffectPass));let t=[this.effects.get("chromaticAberration"),this.effects.get("bloom"),this.effects.get("depthOfField"),this.effects.get("colorAverage"),this.effects.get("hueSaturation"),this.effects.get("brightnessContrast"),this.effects.get("vignette"),this.effects.get("noise")].reduce(IQ,[]);if(t.length>0&&(this.effectPass=new kX(this.camera,...t),this.effectPass.renderToScreen=!1,this.effectComposer.addPass(this.effectPass),this._needsDOFResize&&null!==(n=this.effects.get("depthOfField"))&&void 0!==n&&n.enabled&&void 0!==window)){let e=this.renderer.viewportWidth,t=this.renderer.viewportHeight;this.renderer.setSize(e-1,t-1),this.renderer.setSize(e,t)}}this.effectComposer.addPass(this.stylesOverlayPass),this.effectComposer.addPass(this.uiOverlayPass),this.effectComposer.addPass(this.sceneTransitionPass),this.effectComposer.addPass(this.helperPass),this.effectComposer.addPass(this.logoOverlayPass)}_initCopyPass(){if(this._savePass)return;let e=new lv;this.renderer.getDrawingBufferSize(e),this._rt=new Iv(e.x,e.y,{depthBuffer:!1,stencilBuffer:!1,wrapS:ag,wrapT:ag}),this._rt.samples=0,this._savePass=new vX(this._rt,!1),this._savePass.renderToScreen=!1}setCopyPass(e){this._rt=e,this._savePass=new vX(this._rt,!1),this.renderToScreen=!1}get renderToScreen(){return this._renderToScreen}set renderToScreen(e){if(this._renderToScreen===e)return;let t=this.effectComposer;!t||(!0===e?t.removePass(this._savePass):t.addPass(this._savePass),this._renderToScreen=e,this.updateRenderToScreen())}set sceneTransitionFromTexture(e){e!==this.sceneTransitionPass.texture&&(null!==e?this.sceneTransitionPass.enabled=!0:(this.sceneTransitionPass.enabled=!1,this.updateRenderToScreen()),this.sceneTransitionPass.texture=e)}setWatermark(e){this.logoOverlayPass.enabled=null!==e,e&&(this.logoOverlayPass.texture=e)}get texture(){return this._rt&&this._rt.texture}get renderTarget(){return this._rt}updatePostprocessing(e){let{enabled:t}=e,n=o(e,vm),i=!1;t!==this.postprocessingState.enabled&&(i=!0);for(let r of Object.entries(n)){let e=r[1],t=this.effects.get(r[0]);if(t){t.enabled!==e.enabled&&(i=!0),t.enabled=e.enabled;for(let[n,i]of Object.entries(e))"blendFunction"===n?t.blendFunction=kQ(i):t[n]=i}}this.postprocessingState=e,i&&this._initPasses()}render(){this.effectComposer.render(this.clock.getDelta())}setScissor(e,t,n,i){e instanceof Ov?(this.effectComposer.inputBuffer.scissor.set(e.x,e.y,e.z,e.w),this.effectComposer.outputBuffer.scissor.set(e.x,e.y,e.z,e.w)):(this.effectComposer.inputBuffer.scissor.set(e,t,n,i),this.effectComposer.outputBuffer.scissor.set(e,t,n,i));let r=this.renderer.getPixelRatio();this.effectComposer.inputBuffer.scissor.multiplyScalar(r),this.effectComposer.outputBuffer.scissor.multiplyScalar(r),this.renderer.setScissor(e,t,n,i)}setScissorTest(e){this.effectComposer.inputBuffer.scissorTest=e,this.effectComposer.outputBuffer.scissorTest=e,this.renderer.setScissorTest(e)}setViewport(e,t,n,i){e instanceof Ov?(this.effectComposer.inputBuffer.viewport.copy(e),this.effectComposer.outputBuffer.viewport.copy(e)):(this.effectComposer.inputBuffer.viewport.set(e,t,n,i),this.effectComposer.outputBuffer.viewport.set(e,t,n,i))}resize(e,t,n){if(this.effectComposer.setSize(e,t,n),this._rt){let n=this.renderer.getPixelRatio();this._rt.setSize(e*n,t*n)}}dispose(){var e,t;null!==(e=this.uvEffectPass)&&void 0!==e&&e.dispose(),null!==(t=this.effectPass)&&void 0!==t&&t.dispose(),this.effectComposer.dispose()}},RQ=Kx.lights_fragment_begin,LQ=Kx.shadowmask_pars_fragment,zQ=null,NQ=new Ix({vertexShader:"\nattribute vec3 randomColor;\nvarying vec3 vNormal;\nflat out vec3 vColor;\n#include <skinning_pars_vertex>\n#include <morphtarget_pars_vertex>\n\t\nvoid main()\n{\n#include <beginnormal_vertex>\n#include <morphnormal_vertex>\n#include <skinbase_vertex>\n#include <skinnormal_vertex>\nvec3 transformed = vec3(position);\n#include <morphtarget_vertex>\n#include <skinning_vertex>\n\nvNormal = normal;\nvColor = randomColor;\ngl_Position = projectionMatrix * (modelViewMatrix * vec4(transformed, 1.0));\n}\n",fragmentShader:"\nuniform float depthContrast;\nvarying vec3 vNormal;\nflat in vec3 vColor;\nvoid main()\n{\nvec3 normal = (normalize(vNormal)).rgb;\n\nfloat contrastDepth = (gl_FragCoord.z - 0.5) * depthContrast + 0.5;\n\nvec3 resultColor = mix(mix(vColor, normal, 0.2), vec3(contrastDepth), 0.4);\ngl_FragColor = vec4(resultColor, vColor.r);\ngl_FragColor = vec4(resultColor, vColor.r);\n}\n",uniforms:{depthContrast:{value:1}}}),jQ=new Fv,UQ=new lv,VQ=class extends SD{constructor(e){var t,n;super(e),t=this,this._pixelRatio=this.getPixelRatio(),this.viewportWidth=1,this.viewportHeight=1,this.resolution=new lv,this.dummyCamera=new OY,this.sceneTransitionDuration=0,this.sceneTransitionTimeRemaining=-1,this.isXRCopyPassSet=!1,this.clear=function(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=t.getContext(),s=0;e&&(s|=r.COLOR_BUFFER_BIT),n&&(s|=r.DEPTH_BUFFER_BIT),i&&(s|=r.STENCIL_BUFFER_BIT),r.clear(s),r.clearBufferfv(r.COLOR,1,[0,0,0,1])},this.pipeline=new BQ(this,null!==(n=null===e||void 0===e?void 0:e.needsDOFResize)&&void 0!==n&&n),this.autoClear=!1;let i=this.setPixelRatio.bind(this),r=this.setSize.bind(this);this.shadowMap.enabled=!0,this.shadowMap.type=1,this.dummyCamera.matrixAutoUpdate=!1,this.domElement.removeAttribute("data-engine");let s=this.getContext();if(s&&"drawingBufferColorSpace"in s)try{s.drawingBufferColorSpace="display-p3"}catch(a){console.warn(a)}this.setPixelRatio=e=>{this._pixelRatio!==e&&(this._pixelRatio=e,i(e))},this.setSize=function(e,n){var i,s;let a=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];(t.viewportWidth!==e||t.viewportHeight!==n)&&(t.viewportWidth=e,t.viewportHeight=n,r(e,n,a),null!==(i=t.normalRenderTarget)&&void 0!==i&&i.setSize(e*t._pixelRatio,n*t._pixelRatio),t._resizeTransmission(e,n),null!==(s=t.transmissionDepthTarget)&&void 0!==s&&s.setSize(e*t._pixelRatio/2,n*t._pixelRatio/2),t.pipeline.resize(e,n,a))},this._superDispose=this.dispose,this.dispose=this._currentDispose}createAORenderTarget(){void 0===this.aoRenderTarget&&(this.aoRenderTarget=new Iv(this.viewportWidth*this._pixelRatio,this.viewportHeight*this._pixelRatio,{generateMipmaps:!1,minFilter:dg,magFilter:dg,wrapS:og,wrapT:og,depthBuffer:!1}))}_resizeTransmission(e,t){var n,i;null!==(n=this.transmissionRenderTarget)&&void 0!==n&&n.setSize(e*this._pixelRatio/(this.hdTransmission?1:2),t*this._pixelRatio/(this.hdTransmission?1:2)),null===(i=this.aoRenderTarget)||void 0===i||i.setSize(e*this._pixelRatio/1,t*this._pixelRatio/1)}get hdTransmission(){return 1===hW.transmissionLod.value}set hdTransmission(e){hW.transmissionLod.value=!0===e?1:2,this._resizeTransmission(this.viewportWidth,this.viewportHeight)}createTransmissionRenderTarget(){void 0===this.transmissionRenderTarget&&(this.transmissionRenderTarget=new Iv(this.viewportWidth*this._pixelRatio/(this.hdTransmission?1:2),this.viewportHeight*this._pixelRatio/(this.hdTransmission?1:2),{generateMipmaps:!0,minFilter:fg,magFilter:dg,wrapS:og,wrapT:og,depthBuffer:!1}),this.transmissionDepthTarget=new Iv(this.viewportWidth*this._pixelRatio/2,this.viewportHeight*this._pixelRatio/2,{minFilter:ug,magFilter:ug,depthBuffer:!1}))}createNormalRenderTarget(){void 0===this.normalRenderTarget&&(this.normalRenderTarget=new Iv(this.viewportWidth*this._pixelRatio,this.viewportHeight*this._pixelRatio,{generateMipmaps:!1,minFilter:ug,magFilter:ug,type:vg,depthTexture:new bD(this.viewportWidth*this._pixelRatio,this.viewportHeight*this._pixelRatio)}))}renderNormal(e,t,n){this.normalRenderTarget&&(this.setClearColor(0),n.layers.enable(8),n.layers.disable(0),n.layers.disable(3),t.traverseEntity((e=>{e.layers.isEnabled(8)&&(e.copyPreviousMatrix=!1)})),this.setRenderTarget(this.normalRenderTarget),this.clear(),NQ.uniforms.depthContrast.value=n instanceof OY?(n.far-n.near)/1e4:1,t.overrideMaterial=NQ,this.render(t,n),this.setClearColor(t.bgColor,t.bgColor.a),this.setRenderTarget(null),t.overrideMaterial=e.wireframeState?fJ:null,n.layers.enable(0),n.layers.enable(3),t.traverseEntity((e=>{e.layers.isEnabled(8)&&(e.copyPreviousMatrix=!0)})))}renderSplineSceneWithDummyCamera(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;this.dummyCamera.updateCameraState(t.dataPatched),this.dummyCamera.matrix.copy(t.matrixWorld);let i=t.height,r=t.width,s=this.viewportWidth/this.viewportHeight;r<i?r=i*s:i=r/s,this.dummyCamera.setViewplaneSize(r,i);for(let a=0;a<n;a++)this.renderSplineScene(e,this.dummyCamera)}renderSplineScene(e,t){var n;let{sceneHelpers:i=this.sceneHelpers,sceneHelpersOnTop:r=this.sceneHelpersOnTop,overrideTransmission:s,overrideNormal:a}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=e instanceof gJ?e.activePage:e,l=o.visible;o.visible=!0;let u=o.scene;this.xr.enabled&&(!1===this.isXRCopyPassSet&&null!==this.getRenderTarget()&&(this.pipeline.setCopyPass(this.getRenderTarget()),this.isXRCopyPassSet=!0),this.xr.updateCamera(t)),this.setClearColor(o.bgColor,o.bgColor.a),o.penumbraSizeArray.forEach(((e,t)=>{hW.penumbraSize.value[t]=e})),hW.pixelRatioNode.value=this.getPixelRatio(),0!==this.resolution.x&&0!==this.resolution.y?hW.resolution.value.set(this.resolution.x,this.resolution.y):hW.resolution.value.set(this.viewportWidth*this._pixelRatio,this.viewportHeight*this._pixelRatio),void 0!==a?(hW.normalRenderTarget.value=a,hW.normalRenderTargetDepth.value=jQ):u.needsNormal()&&(this.createNormalRenderTarget(),hW.normalRenderTarget.value=this.normalRenderTarget.texture,hW.normalRenderTargetDepth.value=this.normalRenderTarget.depthTexture,this.renderNormal(u,o,t));let c=o.data.ao,h=c.occlusion;if(h&&(this.createAORenderTarget(),hW.aoRenderTarget.value=this.aoRenderTarget.texture),hW.aoEnabled.value=h,this.pipeline.setAmbientOcclusionParams(c.occlusion,c.radius,c.bias,o.aoColor,null!==o.fog,o.backupFog.near,o.backupFog.far,c.aoFullRes&&!_F),this.pipeline.aoPass.setBlueNoiseTexture(this.pipeline.blueNoiseTexture),this.pipeline.isUIOverlayEnabled&&null!==(n=o.uiCanvas)&&void 0!==n&&n.enabled&&o.uiCanvas.texture&&o.uiCanvas.texture.image.width>0){let e=this.getSize(UQ),t=this.getPixelRatio();(o.uiCanvas.width!==this.viewportWidth||o.uiCanvas.height!==this.viewportHeight||o.uiCanvas.dpr!==t)&&o.uiCanvas.applySize({width:this.viewportWidth,height:this.viewportHeight},t),o.uiCanvas.render(this),this.pipeline.uiOverlayPass.uiCanvas=o.uiCanvas,this.pipeline.uiOverlayPass.enabled=!0,this.pipeline.uiOverlayPass.setResolution(e.x,e.y,t),this.pipeline.updateRenderToScreen()}else this.pipeline.uiOverlayPass.enabled=!1,this.pipeline.updateRenderToScreen();if(this.pipeline.logoOverlayPass.enabled){let e=this.getSize(UQ),t=this.getPixelRatio();this.pipeline.logoOverlayPass.uniforms.uResolution.value.set(e.x,e.y),this.pipeline.logoOverlayPass.uniforms.uDPR.value=t}let d=!1;if(void 0!==s)hW.transmissionRenderTarget.value=s,hW.transmissionRenderTargetDepth.value=jQ,this.pipeline.setTransmissionPassEnabled(!1);else{let e=u.needsTransmission();e&&(void 0===this.transmissionRenderTarget&&(d=!0),this.createTransmissionRenderTarget(),hW.transmissionRenderTarget.value=this.transmissionRenderTarget.texture,hW.aspectRatio.value=function(e,t){return e>=t?new lv(t/e,1):new lv(1,e/t)}(this.viewportWidth,this.viewportHeight),hW.transmissionRenderTargetDepth.value=this.transmissionDepthTarget.texture),this.pipeline.setTransmissionPassEnabled(e)}t.layers.enable(3),t.layers.enable(8),this.pipeline.sceneHelpers=i,this.pipeline.sceneHelpersOnTop=r,this.pipeline.scene=o,this.pipeline.camera=t,d&&this.pipeline.transmissionPass.updatePasses(this),this.pipeline.postprocessingState!==o.postprocessing&&(this.pipeline.updatePostprocessing(o.postprocessing),!i&&!r&&this.pipeline.disableHelpers()),void 0!==this.clearAlphaOverride&&this.setClearAlpha(this.clearAlphaOverride),u.shapeBlendIntances.forEach((e=>{e.onBeforeShadowPass(this)})),o.overrideMaterial=u.wireframeState?fJ:null,this.pipeline.render(),hW.frameIndex.value=(hW.frameIndex.value+1)%16,t instanceof OY&&t.copyHistory(),o.visible=l}renderFromSceneForSceneTransitionPass(e,t,n){this.pipeline.renderToScreen=!1,this.pipeline.renderTarget,this.renderSplineScene(e,t),this.pipeline.sceneTransitionFromTexture=this.pipeline.renderTarget.texture,this.sceneTransitionDuration=n,this.sceneTransitionTimeRemaining=n,this.pipeline.renderToScreen=!0;let i=this.pipeline.sceneTransitionPass.uniforms;i.uDPR.value=window.devicePixelRatio,i.uResolution.value.set(this.domElement.width,this.domElement.height).divideScalar(window.devicePixelRatio)}_currentDispose(){var e,t,n,i,r;this._superDispose(),this.pipeline.dispose(),null!==(e=this.aoRenderTarget)&&void 0!==e&&e.dispose(),null!==(t=this.transmissionRenderTarget)&&void 0!==t&&t.dispose(),null!==(n=this.transmissionDepthTarget)&&void 0!==n&&n.dispose(),null!==(i=this.normalRenderTarget)&&void 0!==i&&i.dispose(),null===(r=this.normalRenderTarget)||void 0===r||null===(r=r.depthTexture)||void 0===r||r.dispose()}},HQ=class extends(fY(TE)){constructor(e){super(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:15,arguments.length>2&&void 0!==arguments[2]?arguments[2]:10066329),this.object=e,this.added=!1,this.name="DirectionalLightHelper: ".concat(e.uuid)}raycast(e,t){yY(this.object,HQ.geometryHelper,e,t)}},WQ=class extends(fY(EE)){constructor(e){super(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:15,arguments.length>2&&void 0!==arguments[2]?arguments[2]:6710886),this.object=e,this.name="PointLightHelper: ".concat(e.uuid)}raycast(e,t){yY(this.object,WQ.geometryHelper,e,t)}},GQ=class extends(fY(SE)){constructor(e){super(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:6710886),this.object=e,this.name="SpotLightHelper: ".concat(e.uuid)}raycast(e,t){yY(this.object,GQ.geometryHelper,e,t)}update(){if(void 0!==this.object){let e=GQ._vector,t=this.object.distance?this.object.distance:1e3,n=t*Math.tan(this.object.angle);this.cone.scale.set(n,n,t),e.setFromMatrixPosition(this.object.target.matrixWorld),this.cone.lookAt(e);let i=void 0!==this.color?this.color:this.light.color;if(this.cone.material instanceof Array)for(let r=0,s=this.cone.material.length;r<s;r++)this.cone.material[r].color.set(i);else this.cone.material.color.set(i)}}},qQ=GQ;qQ._vector=new Lv;var YQ=class extends vD{constructor(){super(),this.caretIndex=0,this._caretVisibleAlpha=1,this._selectionVisibleAlpha=.3,this.current={start:0,end:void 0},this.matrixAutoUpdate=!1,this.caretMesh=new Cx(new Qx(1,1),new Jy({transparent:!0,opacity:0,side:2})),this.add(this.caretMesh),this.selectionMesh=new Cx(new Qx(1,1),new Jy({color:2857471,transparent:!0,depthTest:!1,depthWrite:!1,opacity:0,side:2})),this.add(this.selectionMesh),this.hide()}get caretHeight(){var e,t;return null!==(e=null===(t=this.object)||void 0===t?void 0:t.AD)&&void 0!==e?e:0}show(e){this.visible=!0,this.object=e,this.caretMesh.scale.set(1,this.caretHeight,1),this.caretMesh.position.y=.5*-this.caretHeight,this.setCaretPosition(this.caretIndex),this.update()}hide(){this.visible=!1}update(){if(void 0===this.object)return;this.updateHelperMatrix();let{depth:e}=this.object.geometry.userData.parameters;this.caretMesh.position.z=e,this.selectionMesh.position.z=e}updateHelperMatrix(){if(void 0===this.object)return;let e=this.object,t=e.parent;null!==t&&t.updateWorldMatrix(!0,!1),e.matrixAutoUpdate&&e.updateMatrix(),null!==t?(this.matrixWorld.multiplyMatrices(t.matrixWorld,e.hiddenMatrix),this.matrixWorld.multiplyMatrices(this.matrixWorld,e.matrix)):this.matrixWorld.multiplyMatrices(e.hiddenMatrix,e.matrix),this.matrix.copy(this.matrixWorld);for(let n of this.children)n.matrixWorld.copy(this.matrixWorld);e.updateWorldMatrix(!0,!0)}setCaretColor(e){let t=this.caretMesh.material;t.color.setRGB(e.r,e.g,e.b);let n=this._caretVisibleAlpha===t.opacity;this._caretVisibleAlpha=e.a,n&&(t.opacity=this._caretVisibleAlpha)}setSelectionColor(e){this.selectionMesh.material.color.setRGB(e.r,e.g,e.b)}setCaretPosition(e){if(void 0===this.object)return;this.caretIndex=e;let t=this.object.wrappedText,[n,i]=QQ(t,e),[r,s]=e>0?QQ(t,e-1):[null,null];"\n"===(e>0&&t.length?t[r].charAt(s):null)&&(n++,i=0),this.current.start=e,this.current.end=void 0;let[a,o]=XQ(this.object,n,i),{AD:l,descender:u}=this.object,c=u+.5*l,{width:h,height:d,depth:p}=this.object.geometry.userData.parameters,f="string"==typeof h?0:h,m="string"==typeof d?0:d;this.caretMesh.scale.set(1,this.caretHeight,1),this.caretMesh.position.set(a-.5*f,o+c+.5*m,p),this.hideSelectionMesh(),this.showCaretMesh()}setSelection(e,t){if(void 0===this.object)return;let n=this.object.wrappedText;this.current.start=e,this.current.end=t;let i=[],r=[],s=function(e,t,n){let[i,r]=QQ(e,t),[s,a]=QQ(e,n),o=[];r>=e[i].length&&(i++,r=0);for(let l=i;l<=s;l++){let t=e[l],n=l===i?r:0,u=l===s?a:t.length;o.push([l,n,u])}return o}(n,e,t),{lineHeight:a,AD:o,descender:l}=this.object,u=l+.5*o-.5*a;for(let[g,v,y]of s)if(v!==y){let[e,t]=XQ(this.object,g,v),[n,s]=XQ(this.object,g,y);t+=u,s+=u,s+=a;let o=i.length/3;i.push(e,t,0),i.push(n,t,0),i.push(n,s,0),i.push(e,s,0),r.push(o+0,o+1,o+2),r.push(o+2,o+3,o+0)}let c=new dx;c.setIndex(r),c.setAttribute("position",new rx(i,3));let{width:h,height:d,depth:p}=this.object.geometry.userData.parameters,f="string"==typeof h?0:h,m="string"==typeof d?0:d;this.selectionMesh.geometry.dispose(),this.selectionMesh.geometry=c,this.selectionMesh.position.x=.5*-f,this.selectionMesh.position.y=.5*m,this.selectionMesh.position.z=p,this.showSelectionMesh(),this.hideCaretMesh()}getSelectionFromPosition(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"previous";if(void 0===this.object||void 0===this.object.font)return;let i=this.object.wrappedText,r=i.length,s=this.object.lineHeight,a=r*s,{height:o,verticalAlign:l}=this.object.geometry.userData.parameters,u="string"==typeof o?0:o,c=0;3===l?c=u-a:2===l&&(c=.5*u-.5*a);let h=Math.min(Math.floor(Math.max(Math.min(-t-c,a),0)/s),r-1),d=this.object.charCoords[h],p=this.object.charWidths[h],f=0,m=!1;if("previous"===n){for(let g=0;g<d.length;g++)if(d[g][0]+.5*p[g]-e>0){f=g,m=!0;break}}else if("closest"===n){let t=1/0;for(let n=0;n<d.length;n++){let i=d[n][0]+.5*p[n],r=Math.abs(i-e);r<t&&(t=r,f=n,m=!0)}}else for(let g=0;g<d.length;g++){let t=d[g][0],n=d[g][0]+p[g];if(e>=t&&e<n){f=g,m=!0;break}}return m||(f=d.length),{index:this.getGlobalIndexFromLineAndCharIndexes(i,h,f),lineIndex:h,characterIndex:f}}getGlobalIndexFromLineAndCharIndexes(e,t,n){return e.slice(0,t).reduce(((e,t)=>e+t.length),0)+n}showSelectionMesh(){this.selectionMesh.material.opacity=this._selectionVisibleAlpha}hideSelectionMesh(){this.selectionMesh.material.opacity=0}showCaretMesh(){this.caretMesh.material.opacity=this._caretVisibleAlpha}hideCaretMesh(){this.caretMesh.material.opacity=0}};function XQ(e,t,n){let{charCoords:i,charWidths:r,initialOffsetY:s,lineHeight:a}=e;if(i[t]&&0===i[t].length||0===i.length){let n=0,{horizontalAlign:i}=e.data.geometry,r=e.wrappedText,{width:o}=e.geometry.userData.parameters;return 1===r.length&&0===r[0].length&&(3===i?n=.5*o:2===i&&(n=o)),[n,s-a*t]}let o=i[t];if(void 0===o||0===o.length)return[0,0];let[l,u]=o[Math.min(n,o.length-1)];return n>=o.length&&(l+=r[t][n-1]),[l,u]}function QQ(e,t){var n,i;let r=0;for(let s=0;s<e.length;s++){let n=e[s],i=t-r;if(i<=n.length)return[s,i];r+=n.length}return[Math.max(0,e.length-1),null!==(n=null===(i=e[e.length-1])||void 0===i?void 0:i.length)&&void 0!==n?n:0]}function KQ(e,t){return"string"==typeof e?t.data.colors[e]:e}function ZQ(e){return e.colors[0]}var JQ,$Q=class extends(zY(YS,HQ)){constructor(e,t,n){super(),this.super_Entity(e,t),this.castShadow=!0,this.shadow.mapSize.width=2048,this.shadow.mapSize.height=2048,this.shadow.normalBias=1,this.layers.enable(3);let i=this.shadow.camera;i.top=1250,i.bottom=-1250,i.right=1250,i.left=-1250,i.near=-1e4,i.far=2500;let r=new OE(this.shadow.camera);r.visible=!1,this.gizmos.shadowmap=r}update(){this.shadow.camera.updateProjectionMatrix();for(let e in this.gizmos){let t=this.gizmos[e];t instanceof OE&&t.update()}}updateMatrixWorld(e){super.updateMatrixWorld(e),this.objectHelper&&this.objectHelper.update()}updateState(e,t){this.updateState_Light(e,t);let n=void 0!==e.depth&&e.depth!==this.shadow.camera.far||void 0!==e.size&&e.size/2!==this.shadow.camera.right;void 0!==e.size&&function(e,t){e.shadow.camera.right=t/2,e.shadow.camera.left=-t/2,e.shadow.camera.top=t/2,e.shadow.camera.bottom=-t/2,e.shadow.needsUpdate=!0}(this,e.size),void 0!==e.shadowRadius&&(this.shadow.radius=e.shadowRadius),void 0!==e.shadowResolution&&(this.shadow.mapSize.set(e.shadowResolution,e.shadowResolution),this.shadow.map&&(this.shadow.map.dispose(),this.shadow.map=null)),void 0!==e.penumbraSize&&t.scene.markPenumbraSizeDirty(),n&&this.update()}},eK=new Lv,tK=new Lv,nK=new Rv,iK=class extends(zY(jS,qQ)){constructor(e,t,n){super(),this.super_Entity(e,t),this.castShadow=!0,this.shadow.mapSize.width=1024,this.shadow.mapSize.height=1024,this.shadow.normalBias=1,this.layers.enable(3);let i=this.shadow.camera;i.fov=2*ov.RAD2DEG*this.angle,i.aspect=1,i.near=100,i.far=2500;let r=new OE(this.shadow.camera);r.visible=!1,this.gizmos.shadowmap=r,this.update()}update(){this.shadow.camera.updateProjectionMatrix();for(let e in this.gizmos){let t=this.gizmos[e];t instanceof OE&&t.update()}}updateMatrixWorld(e){super.updateMatrixWorld(e),tK.setFromMatrixPosition(this.matrixWorld),nK.setFromRotationMatrix(this.matrixWorld),eK.copy(this.up).applyQuaternion(nK).negate().multiplyScalar(this.distance),this.target.position.copy(tK).add(eK),this.target.updateMatrixWorld(),this.objectHelper&&this.objectHelper.update()}updateState(e,t){this.updateState_Light(e,t),void 0!==e.distance&&(this.distance=e.distance),void 0!==e.decay&&(this.decay=e.decay),void 0!==e.angle&&(this.angle=e.angle),void 0!==e.penumbra&&(this.penumbra=e.penumbra),void 0!==e.shadowRadius&&(this.shadow.radius=e.shadowRadius),void 0!==e.penumbraSize&&t.scene.markPenumbraSizeDirty(),void 0!==e.shadowResolution&&(this.shadow.mapSize.set(e.shadowResolution,e.shadowResolution),this.shadow.map&&(this.shadow.map.dispose(),this.shadow.map=null))}};function rK(e,t){return[[e[0][0]*t[0][0]+e[0][1]*t[1][0],e[0][0]*t[0][1]+e[0][1]*t[1][1]],[e[1][0]*t[0][0]+e[1][1]*t[1][0],e[1][0]*t[0][1]+e[1][1]*t[1][1]]]}function sK(e){return[[e[0][0],e[1][0]],[e[0][1],e[1][1]]]}function aK(e){let[t,n,i]=function(e){let t=(e[0][0]+e[1][1])/2,n=(e[0][0]-e[1][1])/2,i=(e[1][0]+e[0][1])/2,r=(e[1][0]-e[0][1])/2,s=Math.sqrt(t*t+r*r),a=Math.sqrt(n*n+i*i),o=s+a,l=s-a,u=Math.atan2(i,n),c=Math.atan2(r,t),h=(c-u)/2,d=(c+u)/2,p=[[Math.cos(d),Math.sin(d)],[-Math.sin(d),Math.cos(d)]],f=[[o,0],[0,l]],m=[[Math.cos(h),Math.sin(h)],[-Math.sin(h),Math.cos(h)]];return p[0][0]*=-1,p[0][1]*=-1,m[0][0]*=-1,m[1][0]*=-1,[p,f,m]}(e),r=rK(t,sK(i)),s=rK(rK(i,n),sK(i));return{rotation:Math.atan2(r[1][0],r[0][0]),scale:[s[0][0],s[1][1]],shear:[s[0][1]/s[1][1],s[1][0]/s[0][0]]}}(e=>{function t(e){return[e[0],e[3],e[1],e[4],e[2],e[5]]}e.identity=function(){return[1,0,0,0,1,0,0,0,1]},e.copy=function(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.identity();for(let e=0,i=t.length;e<i;e++)n[e]=t[e];return n},e.create=function(t,n,i,r,s,a){return e.setAbcdef(e.identity(),t,n,i,r,s,a)},e.setAbcdef=function(e,t,n,i,r,s,a){return e[0]=t,e[1]=i,e[2]=s,e[3]=n,e[4]=r,e[5]=a,e},e.append=function(n,i){let[r,s,a,o,l,u]=t(n),[c,h,d,p,f,m]=t(i),g=c*r+h*a,v=c*s+h*o,y=d*r+p*a,x=d*s+p*o,b=f*r+m*a+l,w=f*s+m*o+u;return e.create(g,v,y,x,b,w)},e.prepend=function(n,i){let[r,s,a,o,l,u]=t(n),[c,h,d,p,f,m]=t(i),g=r,v=s,y=a,x=o;(1!==c||0!==h||0!==d||1!==p)&&(g=r*c+s*d,v=r*h+s*p,y=a*c+o*d,x=a*h+o*p);let b=l*c+u*d+f,w=l*h+u*p+m;return e.create(g,v,y,x,b,w)},e.getAbcdef=t,e.invert=function(t){let[n,i,r,s,a,o]=e.getAbcdef(t),l=n*s-i*r,u=s/l,c=-i/l,h=-r/l,d=n/l,p=(r*o-s*a)/l,f=-(n*o-i*a)/l;return e.create(u,c,h,d,p,f)},e.apply=function(t,n){let[i,r]=t,[s,a,o,l,u,c]=e.getAbcdef(n);return[s*i+o*r+u,a*i+l*r+c]},e.applyInverse=function(t,n){let[i,r,s,a,o,l]=e.getAbcdef(n),u=1/(i*a+s*-r),[c,h]=t;return[a*u*c+-s*u*h+(l*s-o*a)*u,i*u*h+-r*u*c+(-l*i+o*r)*u]},e.scale=function(t,n){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:n,[r,s,a,o,l,u]=e.getAbcdef(t);return e.setAbcdef(t,r*n,s*i,a*n,o*i,l*n,u*i),t},e.rotate=function(t,n){let i=Math.cos(n),r=Math.sin(n),[s,a,o,l,u,c]=e.getAbcdef(t);return e.setAbcdef(t,s*i-a*r,s*r+a*i,o*i-l*r,o*r+l*i,u*i-c*r,u*r+c*i),t},e.rotateAround=function(t,n,i){let[r,s]=i,a=e.translate(t,-r,-s);return a=e.rotate(a,n),a=e.translate(a,r,s),a},e.translate=function(t,n,i){let[r,s,a,o,l,u]=e.getAbcdef(t);return e.setAbcdef(t,r,s,a,o,l+n,u+i),t},e.setTranslate=function(t,n,i){let[r,s,a,o]=e.getAbcdef(t);return e.setAbcdef(t,r,s,a,o,n,i),t},e.setPosition=function(t,n,i){let[r,s,a,o]=e.getAbcdef(t);return e.setAbcdef(t,r,s,a,o,n,i),t},e.getScale=function(t){let[n,i,r,s]=e.getAbcdef(t);return[Math.sqrt(n*n+i*i),Math.sqrt(r*r+s*s)]},e.getPosition=function(t){let[,,,,n,i]=e.getAbcdef(t);return[n,i]},e.getRotation=function(t,n){return e.decompose(t,n).rotation},e.decompose=function(t,n){let[i,r,s,a,o,l]=e.getAbcdef(t),{rotation:u,scale:c,shear:h}=aK([[i,s],[r,a]]);return{position:[o+(n[0]*i+n[1]*s)-n[0],l+(n[0]*r+n[1]*a)-n[1]],scale:c,rotation:u,shear:h,pivot:n}},e.compose=function(t,n,i,r){let s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[0,0],[a,o]=t,[l,u]=r,[c,h,d,p]=function(e){let{rotation:t,scale:n,shear:i}=e,r=Math.cos(t),s=Math.sin(t),a=rK([[r,-s],[s,r]],[[n[0],i[0]*n[1]],[i[1]*n[0],n[1]]]);return[a[0][0],a[1][0],a[0][1],a[1][1]]}({rotation:i,scale:n,shear:s}),f=a-(l*c+u*d)+l,m=o-(l*h+u*p)+u;return e.create(c,h,d,p,f,m)}})(JQ||(JQ={}));var oK=Math.PI/180;Math.PI;var lK=class{constructor(e,t,n){var i;this.uuid=e,this.data=t,this.localMatrix=JQ.identity(),this.worldMatrix=JQ.identity(),this.ignoreCameraZoom=!1,this.visible=!0,this._singleBBox=new yK,this._recursiveBBox=new yK,this.singleBBoxNeedsUpdate=!0,this.recursiveBBoxNeedsUpdate=!0,this.stateSelection=null,this.prevState=null,this.currentState=null,this.reversibleToState=null,this.currentTransitionEvent=null,this.previousAction=null,this.name="",this.position=[0,0],this.scale=[1,1],this.rotation=0,this.shear=[0,0],this.emitter=_U(),this.dpr=null!==(i=n.dpr)&&void 0!==i?i:1,this.dataPatched=t}project(e,t){let n=this.worldMatrix;return t&&(n=JQ.append(t.worldMatrix,n)),JQ.applyInverse(e,n)}intersects(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return this.visible&&!this.data.raycastLock&&this.intersectsInLocalSpace(...this.project([e,t],n),i)}intersectsInLocalSpace(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],{min:i,max:r}=n?this.recursiveBBox:this.singleBBox;return e>=i[0]&&e<=r[0]&&t>=i[1]&&t<=r[1]}applyTransforms(e){e.setTransform(this.worldMatrix,this.ignoreCameraZoom)}get singleBBox(){return this.singleBBoxNeedsUpdate&&(this.singleBBoxNeedsUpdate=!1,this._singleBBox.setFromObjectSize(this,!1),this._singleBBox.computeVertices(),this._singleBBox.computeEdges()),this._singleBBox}get recursiveBBox(){return this.recursiveBBoxNeedsUpdate&&(this.recursiveBBoxNeedsUpdate=!1,this._recursiveBBox.setFromObjectSize(this,!0),this._recursiveBBox.computeVertices(),this._recursiveBBox.computeEdges()),this._recursiveBBox}updateLocalMatrix(){this.localMatrix=JQ.compose(this.position,this.scale,function(e){return e*oK}(this.rotation),eL.getPivot(this.dataPatched),this.shear)}updateWorldMatrix(e,t,n){let i=this.parent;t&&null!==i&&void 0!==i&&i.updateWorldMatrix(e,!0,!1),e&&this.updateLocalMatrix(),this.parent?this.worldMatrix=JQ.append(this.parent.worldMatrix,this.localMatrix):this.worldMatrix=JQ.copy(this.localMatrix),this.singleBBoxNeedsUpdate=!0,this.recursiveBBoxNeedsUpdate=!0}get pivot(){return eL.getPivot(this.data)}getCenter(){return[0,0]}getHalfSize(){return[0,0]}get id(){return this.uuid}resetBBoxNeedsUpdateSelf(){this.singleBBoxNeedsUpdate=!0,this.recursiveBBoxNeedsUpdate=!0}resetBBoxNeedsUpdate(){this.resetBBoxNeedsUpdateSelf(),this.traverseAncestors((e=>{e.resetBBoxNeedsUpdateSelf()}))}updateTransformState(e){let t=!1;void 0!==e.position&&(t=!0,this.position=e.position),void 0!==e.rotation&&(t=!0,this.rotation=e.rotation),void 0!==e.scale&&(t=!0,this.scale=e.scale),void 0!==e.shear&&(t=!0,this.shear=e.shear),t&&(this.updateWorldMatrix(!0,!1,!0),this.resetBBoxNeedsUpdate())}updateByOp(e,t,n){0===e.type&&void 0!==e.props.visible&&(this.visible=e.props.visible),this.data=t,this.data=t;let i=e,r=zO(e.path,["states","*"]);if(null!==r){if(0===e.type){let[t]=r;if((null===this||void 0===this?void 0:this.stateSelection)===t){let t=d({},e.props);if(delete t.name,Object.values(e.props).some((e=>void 0===e))){let n=this.data;if(void 0!==n){let i=OO.zoom(n,e.path.slice(2));if(i)for(let n in e.props)void 0===e.props[n]&&n in i&&(t[n]=i[n])}}i=d(d({},e),{},{props:t,path:e.path.slice(2)})}}}else if(0===e.type){let t=this.stateSelection?this.data.states.data(this.stateSelection):void 0;if(void 0!==t){if(void 0!==e.props.name&&t.name){let{name:e}=t;t=o(t,ym)}let n=OO.removeOverridden(e.path,e.props,t);i=d(d({},e),{},{props:n})}}this.updateByPatchedOpBase(i,HR.patch(this.data,this.stateSelection?this.data.states.data(this.stateSelection):void 0),n)}changeSelectedState(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(0!==this.data.states.length||n){for(let e of this.data.states)HR.toOps(this.data,e.data).forEach((e=>{let n=lO.replaceProps(e,this.data);this.dataPatched=this.data,this.updateByPatchedOp(n,this.data,t)}));if(null!==e){let n=this.data.states.data(e);n&&(this.dataPatched=HR.patch(this.data,n),HR.toOps(this.data,n).forEach((e=>{this.updateByPatchedOp(e,this.dataPatched,t)})))}n&&this.updateTransformState(this.dataPatched),this.stateSelection=e}}updateState(e,t){void 0!==e.name&&(this.name=e.name),void 0!==e.visible&&(this.visible=e.visible),this.updateTransformState(e)}updateByPatchedOpBase(e,t,n){this.dataPatched=t,this.updateByPatchedOp(e,t,n)}updateByPatchedOp(e,t,n){0===e.path.length&&0===e.type&&this.updateState(e.props,n),this.requestRender()}traverseFrameAncestors(e){this.traverseAncestors((t=>{"frame2d"===t.data.type&&e(t)}))}traverseAncestors(e){let t=this.parent;for(;t;)e(t),t=t.parent}requestRender(){this.traverseFrameAncestors((e=>{e.requestRender()}))}clone(e){let t=new lK(this.uuid,this.data,e);return t.parent=void 0,t}addEventListener(e,t){this.emitter.on(e,t)}removeEventListener(e,t){this.emitter.off(e,t)}dispatchEvent(e){var t;this.emitter.emit(e.type,d(d({},e),{},{target:null!==(t=e.target)&&void 0!==t?t:this}))}traverseSortNextHelper(){let e=this.parent;if(e){let t=e.children;if(t){let n=t.indexOf(this)+1;return t[n]?t[n]:e.traverseSortNextHelper()}}}sortNext(){let e=this.children;return e&&e.length>0&&e[0]?e[0]:this.traverseSortNextHelper()}isDescendantOf(e){e instanceof lK&&(e=e.uuid);let t=this;for(;t.parent;){if(t.parent.uuid===e)return!0;t=t.parent}return!1}},uK=class extends lK{constructor(e,t,n){super(e,t,n),this.uuid=e,this.data=t,this.context=n,this.children=[]}add(e){e.parent&&e.parent instanceof uK&&e.parent.remove(e),this.children.push(e),e.parent=this}remove(e){let t=this.children.indexOf(e);t>=0&&(this.children.splice(t,1),e.parent=void 0)}traverse(e){let t=e(this);if(!0!==t)for(let n of this.children)n instanceof uK?n.traverse(e):t=e(n)}intersectsChildrenHelper(e,t,n,i,r){for(let s of this.children)if(s.intersects(e,t,n,!1)&&(r.push(s),i)||s instanceof uK&&s.intersectsChildrenHelper(e,t,n,i,r))return!0;return!1}intersectsChildren(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];return this.intersectsChildrenHelper(e,t,n,i,r),r}intersectsChildrenHelperReverse(e,t,n,i,r){for(let s of this.children)if(s instanceof uK&&s.intersectsChildrenHelperReverse(e,t,n,i,r)||s.intersects(e,t,n,!1)&&(r.push(s),i))return!0;return!1}intersectsChildrenReverse(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];return this.intersectsChildrenHelperReverse(e,t,n,i,r),r}updateWorldMatrix(e,t,n){if(super.updateWorldMatrix(e,t,n),n&&this.children)for(let i of this.children)i.updateWorldMatrix(e,!1,!0)}find(e){let t;return this.traverse((n=>{n.uuid===e&&(t=n)})),t}innerDrawChildren(e){for(let t=this.children.length-1;t>=0;t--)this.children[t].draw(e)}resetBBoxNeedsUpdate(){super.resetBBoxNeedsUpdate(),this.traverse((e=>{e.resetBBoxNeedsUpdateSelf()}))}clone(e){let t=new uK(this.uuid,this.data,e);t.parent=void 0;for(let n of this.children)t.add(n.clone(e));return t}},cK=class extends uK{constructor(e,t,n){super(e,t,n),this.uuid=e,this.data=t,this.updateState(t,n)}draw(e){!this.visible||(e.save(),this.applyTransforms(e),this.innerDrawChildren(e),e.restore())}clone(e){let t=new cK(this.uuid,this.data,e);t.parent=void 0;for(let n of this.children)t.add(n.clone(e));return t}};function hK(e,t){let[[n,i],[r,s]]=e,[[a,o],[l,u]]=t,c=(n-r)*(o-u)-(i-s)*(a-l);if(0===c)return!1;let h=((n-a)*(o-u)-(i-o)*(a-l))/c,d=-((n-r)*(i-o)-(i-s)*(n-a))/c;return h>=0&&h<=1&&d>=0&&d<=1}var dK,pK,fK,mK,gK=[[-1,1],[-1,-1],[1,-1],[1,1]],vK=(e,t,n)=>{let i=e.getCenter(),r=e.getHalfSize(),s=JQ.append(t,e.worldMatrix);0===r[0]&&0===r[1]?n.push(JQ.apply(i,s)):gK.forEach((e=>{let t=[e[0]*r[0]+i[0],e[1]*r[1]+i[1]];n.push(JQ.apply(t,s))}))},yK=class{constructor(){this.matrix=JQ.identity(),this.min=[1/0,1/0],this.max=[-1/0,-1/0],this.vertices=[],this.edges=[]}setFromObjectSize(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];e.updateWorldMatrix(),this.makeEmpty(),JQ.copy(e.worldMatrix,this.matrix);let n=JQ.invert(e.worldMatrix);this.expandByObjectSize(e,n,t)}expandByObjectSize(e,t){let n=[];!0===(arguments.length>2&&void 0!==arguments[2]&&arguments[2])&&e instanceof uK?e.traverse((e=>{e.visible&&vK(e,t,n)})):vK(e,t,n),this.setFromPoints(n)}setFromSize(e,t,n){this.makeEmpty(),JQ.copy(n,this.matrix),this.expandBySize(e,t,n)}expandBySize(e,t,n){[JQ.apply([0,0],n),JQ.apply([0,t],n),JQ.apply([e,t],n),JQ.apply([e,0],n)].forEach((e=>this.expandByPoint(e)))}getCenter(){let[e,t]=this.min,[n,i]=this.getHalfSize();return JQ.apply([e+n,t+i],this.matrix)}getSize(){return[this.max[0]-this.min[0],this.max[1]-this.min[1]]}getHalfSize(){return[.5*(this.max[0]-this.min[0]),.5*(this.max[1]-this.min[1])]}makeEmpty(){this.min=[1/0,1/0],this.max=[-1/0,-1/0]}setFromPoints(e){this.makeEmpty();for(let t of e)this.expandByPoint(t)}expandByPoint(e){this.min=[Math.min(this.min[0],e[0]),Math.min(this.min[1],e[1])],this.max=[Math.max(this.max[0],e[0]),Math.max(this.max[1],e[1])]}computeVertices(){let[e,t]=this.getHalfSize(),n=this.getCenter(),[i,r,s,a]=JQ.getAbcdef(this.matrix),o=JQ.create(i,r,s,a,n[0],n[1]);this.vertices=gK.map((n=>{let[i,r]=n;return JQ.apply([i*e,r*t],o)}))}computeEdges(){this.edges=[];for(let e=0,t=this.vertices.length;e<t;++e)this.edges.push([this.vertices[e],this.vertices[(e+1)%t]])}project(e,t){let n=this.matrix;return t&&(n=JQ.append(t.worldMatrix,n)),JQ.applyInverse(e,n)}intersects(e,t,n){return this.intersectsInLocalSpace(...this.project([e,t],n))}intersectsInLocalSpace(e,t){let{min:n,max:i}=this;return e>=n[0]&&e<=i[0]&&t>=n[1]&&t<=i[1]}containsPoint(e){let[t,n]=e,[i,r]=this.min,[s,a]=this.max;return t>=i&&t<=s&&n>=r&&n<=a}intersectsBBox2D(e){for(let t=0,n=this.edges.length;t<n;t++){let n=this.edges[t];for(let t=0,i=e.edges.length;t<i;t++){if(hK(n,e.edges[t]))return!0}}for(let t=0,n=e.vertices.length;t<n;t++){let n=e.vertices[t];if(this.containsPoint(n))return!0}return!1}ensureMinMax(){let e=this.min,t=this.max;this.min=[Math.min(e[0],t[0]),Math.min(e[1],t[1])],this.max=[Math.max(e[0],t[0]),Math.max(e[1],t[1])]}copy(e){this.min=[...e.min],this.max=[...e.max],JQ.copy(e.matrix,this.matrix),this.computeVertices(),this.computeEdges()}clone(){let e=new yK;return e.copy(this),e}},xK=new Promise((e=>{dK=e})),bK=!1;function wK(){if(!bK)return pK||(pK=async function(){var e;let t=await n.e(160).then(n.bind(n,160));dK(null!==(e=t.default)&&void 0!==e?e:t),bK=!0}(),pK)}function DK(e){let t=!1;return e.scene.objects.traverse(((e,n)=>{("Mesh"===n.type&&"UIGeometry"===n.geometry.type||"Page"===n.type&&void 0!==n.uiFrame)&&(t=!0)})),t}var _K=JQ.identity(),SK=class{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.canvas=e,this._dpr=t,this._width=0,this._height=0,this._strokeMode="inside",this._layerBlur=0,this._backgroundBlur=0,this._dropShadowBlur=0,this._dropShadowOffsetX=0,this._dropShadowOffsetY=0,this._dropShadowColor=Uk.transparent,this._innerShadowBlur=0,this._innerShadowOffsetX=0,this._innerShadowOffsetY=0,this._innerShadowSpread=0,this._innerShadowColor=Uk.transparent,this._fonts=new Map,this._isSizeDirty=!1;try{let n=e.getBoundingClientRect();e.width=n.width*t,e.height=n.height*t}catch(n){console.log(e.width,t)}this._currentM3Transform=_K,this._currentTransform=new Float32Array(_K)}get dpr(){return this._dpr}set dpr(e){this._dpr=e,this._isSizeDirty=!0}async init(){var e,t;if(!this.wasmURL)throw Error("Your must set the wasm binary url with renderer.wasmURL = ... before you can call renderer.init");await async function(e){let t=await xK;fK||(mK||(mK=t({locateFile:()=>e})),fK=await mK)}(this.wasmURL),this._surface=fK.MakeWebGLCanvasSurface(this.canvas),this.ctx=null===(e=this._surface)||void 0===e?void 0:e.getCanvas(),this._paint=new fK.Paint,this._paint.setAntiAlias(!0),this._paintFill=this._paint.copy(),this._paintFill.setStyle(fK.PaintStyle.Fill),this._paintStroke=this._paint.copy(),this._paintStroke.setStyle(fK.PaintStyle.Stroke),null===(t=this.ctx)||void 0===t||t.scale(this.dpr,this.dpr)}get currentTransform(){return this._currentM3Transform}get currentTransformBuffer(){return this._currentTransform}set currentTransform(e){this._currentM3Transform=e,this._currentTransform.set(e)}async loadFont(e,t){let n=await(await fetch(e)).arrayBuffer();this.registerFont(n,t)}registerFont(e,t){if(this._fonts.has(t))return;let n=fK.FontMgr.FromData(e);if(!n)throw new Error("Invalid font data for "+t);this._fonts.set(t,n)}get width(){return this._width}get height(){return this._height}set strokeColor(e){this._paintStroke&&this._paintStroke.setColor(CK(e),fK.ColorSpace.DISPLAY_P3)}set fillColor(e){this._paintFill&&this._paintFill.setColor(CK(e),fK.ColorSpace.DISPLAY_P3)}set lineWidth(e){this._paintStroke&&this._paintStroke.setStrokeWidth("center"===this._strokeMode?e:2*e)}set strokeMode(e){this._strokeMode=e}set dropShadowBlur(e){this._dropShadowBlur=e}set dropShadowColor(e){this._dropShadowColor=e}set dropShadowOffsetX(e){this._dropShadowOffsetX=e}set dropShadowOffsetY(e){this._dropShadowOffsetY=e}set innerShadowBlur(e){this._innerShadowBlur=e}set innerShadowColor(e){this._innerShadowColor=e}set innerShadowOffsetX(e){this._innerShadowOffsetX=e}set innerShadowOffsetY(e){this._innerShadowOffsetY=e}set innerShadowSpread(e){this._innerShadowSpread=e}set layerBlur(e){this._layerBlur=e}set backgroundBlur(e){this._backgroundBlur=e}clear(){var e;null===(e=this.ctx)||void 0===e||e.clear(fK.TRANSPARENT)}save(){var e;null===(e=this.ctx)||void 0===e||e.save()}restore(){var e;null===(e=this.ctx)||void 0===e||e.restore()}beginPath(){var e;null!==(e=this._currentPath)&&void 0!==e&&e.delete(),this._currentPath=new fK.Path}closePath(){let e=this._currentPath;if(e){if(e.isEmpty())return;let t=e.getBounds();(t[3]-t[1]||t[2]-t[0])&&e.close()}}fill(){this._paintInner(this._paintFill,!0)}stroke(){this._paintInner(this._paintStroke,!1)}clipRect(e,t,n,i){var r;let s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,l=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,u=fK.XYWHRect(e,t,n,i);if(0===s&&0===a&&0===l&&0===o)null===(r=this.ctx)||void 0===r||r.clipRect(u,fK.ClipOp.Intersect,!0);else{var c;let e=fK.RRectXY(u,s,s);e[4]=e[5]=s,e[6]=e[7]=a,e[8]=e[9]=o,e[10]=e[11]=l,null===(c=this.ctx)||void 0===c||c.clipRRect(e,fK.ClipOp.Intersect,!0)}}_applyShadowOffsetMatrix(){if(this.ctx){let e=JQ.invert(this.currentTransform);this.ctx.concat(e);let t=JQ.translate(JQ.identity(),this._dropShadowOffsetX,this._dropShadowOffsetY);this.ctx.concat(t),this.ctx.concat(this._currentTransform)}}_applyEffectsToPaint(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(this.ctx&&this._currentPath){let d,p=!1;if(n&&this._hasDropShadow()){var i,r,s;let n,a=e.copy();a.setColor(CK(this._dropShadowColor)),this._dropShadowBlur>0&&(n=fK.MaskFilter.MakeBlur(fK.BlurStyle.Normal,this._dropShadowBlur*this.dpr*(null!==(i=null===(r=this.camera)||void 0===r?void 0:r.scale)&&void 0!==i?i:1),!1),a.setMaskFilter(n)),this.ctx.save(),this.ctx.clipPath(this._currentPath,fK.ClipOp.Difference,!0),this._applyShadowOffsetMatrix(),t(a),this.ctx.restore(),a.delete(),null===(s=n)||void 0===s||s.delete()}if(this._backgroundBlur>0&&n){this.ctx.save(),this.ctx.clipPath(this._currentPath,fK.ClipOp.Intersect,!0);let t=fK.ImageFilter.MakeBlur(this._backgroundBlur,this._backgroundBlur,fK.TileMode.Clamp,null),n=e.copy();n.setImageFilter(t),n.setAlphaf(1);let i=this._currentPath.computeTightBounds();this.ctx.saveLayer(n,i,null,fK.SaveLayerInitWithPrevious),this.ctx.drawColor(e.getColor()),this.ctx.restore(),this.ctx.restore(),n.delete(),t.delete(),p=!0}if(this._layerBlur>0){var a,o;let n=e.copy();d=fK.MaskFilter.MakeBlur(fK.BlurStyle.Normal,this._layerBlur*this.dpr*(null!==(a=null===(o=this.camera)||void 0===o?void 0:o.scale)&&void 0!==a?a:1),!1),n.setMaskFilter(d),t(n),n.delete(),d.delete(),p=!0}if(p||t(e),n&&this._hasInnerShadow()){var l,u,c,h;let e,t=new fK.Paint;t.setAntiAlias(!0),t.setStyle(fK.PaintStyle.Fill),t.setColor(CK(this._innerShadowColor)),this._innerShadowBlur>0&&(e=fK.MaskFilter.MakeBlur(fK.BlurStyle.Normal,this._innerShadowBlur*this.dpr*(null!==(l=null===(u=this.camera)||void 0===u?void 0:u.scale)&&void 0!==l?l:1),!1),t.setMaskFilter(e));let n=this._currentPath.computeTightBounds(),[i,r,s,a]=n,o=s-i,d=a-r;this.ctx.save(),this.ctx.clipPath(this._currentPath,fK.ClipOp.Intersect,!0),this.ctx.saveLayer(t,n,null,fK.SaveLayerInitWithPrevious),null!==(c=this.ctx)&&void 0!==c&&c.translate(this._innerShadowOffsetX,this._innerShadowOffsetY),this.ctx.drawRect(fK.XYWHRect(-1e3-this._innerShadowOffsetX,-1e3-this._innerShadowOffsetY,2e3+o+Math.abs(2*this._innerShadowOffsetX),2e3+d+Math.abs(2*this._innerShadowOffsetY)),t),t.setBlendMode(fK.BlendMode.Clear),this.ctx.drawPath(this._currentPath,t),this.ctx.restore(),this.ctx.restore(),t.delete(),null===(h=e)||void 0===h||h.delete()}}}_paintInner(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(this.ctx&&this._currentPath&&e){let n=this.ctx,i=this._currentPath;this._applyEffectsToPaint(e,(e=>{let r=!1;!t&&"center"!==this._strokeMode&&(n.save(),n.clipPath(i,"outside"===this._strokeMode?fK.ClipOp.Difference:fK.ClipOp.Intersect,!0),r=!0),n.drawPath(i,e),r&&n.restore()}),t)}}_hasDropShadow(){var e;return(null===(e=this._dropShadowColor)||void 0===e?void 0:e.a)>0}_hasInnerShadow(){var e;return(null===(e=this._innerShadowColor)||void 0===e?void 0:e.a)>0}path(e){var t;null===(t=this._currentPath)||void 0===t||t.addPath(fK.Path.MakeFromSVGString(e))}ellipse(e,t,n,i,r,s,a,o){var l;if(!EK([e,t,n,i])||!this._currentPath)return;if(n<0||i<0)throw Error("radii cannot be negative");let u=fK.XYWHRect(e-n,t-i,2*n,2*i);null===(l=this._currentPath)||void 0===l||l.addOval(u)}rect(e,t,n,i){var r;let s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,l=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,u=fK.XYWHRect(e,t,n,i);if(EK(u))if(0===s&&0===a&&0===l&&0===o)null===(r=this._currentPath)||void 0===r||r.addRect(u);else{var c;let e=fK.RRectXY(u,s,s);e[4]=e[5]=s,e[6]=e[7]=a,e[8]=e[9]=o,e[10]=e[11]=l,null===(c=this._currentPath)||void 0===c||c.addRRect(e)}}getHorizontalAlign(e){switch(e){case 2:return fK.TextAlign.Right;case 3:return fK.TextAlign.Center;case 4:return fK.TextAlign.Justify;default:return fK.TextAlign.Left}}drawTextInner(e,t,n,i,r,s){let[a,o,l,u]=i,c=!(arguments.length>6&&void 0!==arguments[6])||arguments[6],h=0,{ctx:d}=this;if(!d)return h;let p=s.copy(),f=s.copy();return f.setAlphaf(0),this._applyEffectsToPaint(p,(i=>{t.pushPaintStyle(n,i,f),t.addText(e);let s=t.build();s.layout(l);let c=o;2===r?c+=(u-s.getHeight())/2:3===r&&(c+=u-s.getHeight()),d.drawParagraph(s,a,c),h=s.getHeight(),t.reset(),s.delete()}),c),p.delete(),f.delete(),h}drawText(e,t){let n=0,i=this._fonts.get(t.font),{ctx:r,_paintFill:s,_paintStroke:a}=this;if(i&&r){let r=new fK.TextStyle({fontFamilies:[t.font],fontSize:t.fontSize,heightMultiplier:t.lineHeight,letterSpacing:t.letterSpacing}),o=new fK.ParagraphStyle({textStyle:r,textAlign:this.getHorizontalAlign(t.horizontalAlign)}),l=fK.XYWHRect(t.x,t.y,t.width,t.height),u=fK.ParagraphBuilder.Make(o,i);s&&(n=this.drawTextInner(e,u,r,l,t.verticalAlign,s,!0)),a&&(n=this.drawTextInner(e,u,r,l,t.verticalAlign,a,!1)),u.delete()}return{height:n}}render(){var e;null===(e=this._surface)||void 0===e||e.flush()}moveTo(e,t){var n;null===(n=this._currentPath)||void 0===n||n.moveTo(e,t)}lineTo(e,t){var n;null===(n=this._currentPath)||void 0===n||n.lineTo(e,t)}bezierCurveTo(e,t,n,i,r,s){var a;null===(a=this._currentPath)||void 0===a||a.cubicTo(e,t,n,i,r,s)}quadraticCurveTo(e,t,n,i){var r;null===(r=this._currentPath)||void 0===r||r.quadTo(e,t,n,i)}setTransform(e){var t,n,i,r;let s=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!this.ctx)return;let a=this.ctx.getTotalMatrix(),o=JQ.invert(a);if(o&&this.ctx.concat(o),null!==(t=this.ctx)&&void 0!==t&&t.scale(this.dpr,this.dpr),null!==(n=this.camera)&&void 0!==n&&n.enabled&&(null!==(i=this.ctx)&&void 0!==i&&i.concat(this.camera.worldMatrix),s)){var l;let e=JQ.getScale(this.camera.worldMatrix);null===(l=this.ctx)||void 0===l||l.scale(1/e[0],1/e[1])}null!==(r=this.ctx)&&void 0!==r&&r.concat(e),this.currentTransform=e}transform(e){var t;null===(t=this.ctx)||void 0===t||t.concat(e)}setSize(e,t){var n;!this._isSizeDirty&&e===this._width&&t===this._height||(this._isSizeDirty=!1,this._width=e,this._height=t,this.canvas.style.width=e+"px",this.canvas.style.height=t+"px",this.canvas.width=e*this.dpr,this.canvas.height=t*this.dpr,this._surface&&(this._surface=fK.MakeWebGLCanvasSurface(this.canvas),this.ctx=null===(n=this._surface)||void 0===n?void 0:n.getCanvas()))}};function EK(e){for(let t=0;t<e.length;t++)if(void 0!==e[t]&&!Number.isFinite(e[t]))return!1;return!0}function CK(e){let{r:t,g:n,b:i,a:r}=e;return fK.Color4f(t,n,i,r)}var AK,MK,TK,PK=class{constructor(e,t,n){this.uuid=e,this.data=t,this.enabled=!1,this.color=Uk.transparent,this.blurRadius=0,this.offset=[0,0],this.spread=0,this.update(t)}update(e){void 0!==e.color&&(this.color=e.color),void 0!==e.enabled&&(this.enabled=e.enabled),void 0!==e.blurRadius&&(this.blurRadius=e.blurRadius),void 0!==e.offset&&(this.offset=e.offset),void 0!==e.spread&&(this.spread=e.spread)}},FK=class{constructor(e,t,n){this.uuid=e,this.data=t,this.enabled=!1,this.radius=0,this.update(t)}update(e){void 0!==e.enabled&&(this.enabled=e.enabled),void 0!==e.radius&&(this.radius=e.radius)}},OK=class{constructor(e,t,n){this.uuid=e,this.data=t,this.enabled=!1,this.color=Uk.transparent,this.update(t)}update(e){void 0!==e.enabled&&(this.enabled=e.enabled),void 0!==e.color&&(this.color=e.color)}},IK=class{constructor(e,t,n){this.uuid=e,this.data=t,this.enabled=!1,this.color=Uk.transparent,this.thickness=0,this.mode="inside",this.update(t)}update(e){void 0!==e.enabled&&(this.enabled=e.enabled),void 0!==e.color&&(this.color=e.color),void 0!==e.thickness&&(this.thickness=e.thickness),void 0!==e.mode&&(this.mode=e.mode)}},kK=class extends lK{constructor(e,t,n){super(e,t,n),this.uuid=e,this.data=t,this.autoClose=!0,this.fill=new OK(e+"-fill",t.fill,n),this.stroke=new IK(e+"-stroke",t.stroke,n),this.dropShadow=new PK(e+"-dropShadow",t.dropShadow,n),this.innerShadow=new PK(e+"-innerShadow",t.innerShadow,n),this.backgroundBlur=new FK(e+"-backgroundBlur",t.backgroundBlur,n),this.layerBlur=new FK(e+"-layerBlur",t.layerBlur,n)}applyFillStroke(e){e.fillColor=this.fill.enabled?this.fill.color:Uk.transparent,e.strokeColor=this.stroke.enabled&&this.stroke.thickness>0?this.stroke.color:Uk.transparent,e.strokeMode=this.stroke.mode,e.lineWidth=this.stroke.thickness}applyFilters(e){this.layerBlur.enabled?e.layerBlur=5*this.layerBlur.radius:e.layerBlur=0,this.backgroundBlur.enabled?e.backgroundBlur=5*this.backgroundBlur.radius:e.backgroundBlur=0,this.dropShadow.enabled?(e.dropShadowBlur=5*this.dropShadow.blurRadius,e.dropShadowColor=this.dropShadow.color,e.dropShadowOffsetX=this.dropShadow.offset[0],e.dropShadowOffsetY=this.dropShadow.offset[1]):e.dropShadowColor=Uk.transparent,this.innerShadow.enabled?(e.innerShadowSpread=this.innerShadow.spread,e.innerShadowBlur=5*this.innerShadow.blurRadius,e.innerShadowColor=this.innerShadow.color,e.innerShadowOffsetX=this.innerShadow.offset[0],e.innerShadowOffsetY=this.innerShadow.offset[1]):e.innerShadowColor=Uk.transparent}innerDraw(e){}draw(e){!this.visible||(e.save(),this.applyTransforms(e),this.applyFilters(e),this.applyFillStroke(e),e.beginPath(),this.innerDraw(e),this.autoClose&&e.closePath(),this.fill.enabled&&e.fill(),this.stroke.enabled&&e.stroke(),e.restore())}updateByPatchedOp(e,t,n){super.updateByPatchedOp(e,t,n),0===e.type&&(zO(e.path,["fill"])?this.fill.update(e.props):zO(e.path,["stroke"])?this.stroke.update(e.props):zO(e.path,["dropShadow"])?this.dropShadow.update(e.props):zO(e.path,["innerShadow"])?this.innerShadow.update(e.props):zO(e.path,["layerBlur"])?this.layerBlur.update(e.props):zO(e.path,["backgroundBlur"])?this.backgroundBlur.update(e.props):this.resetBBoxNeedsUpdate())}updateState(e,t){super.updateState(e,t),void 0!==e.fill&&this.fill.update(e.fill),void 0!==e.stroke&&this.stroke.update(e.stroke),void 0!==e.dropShadow&&this.dropShadow.update(e.dropShadow),void 0!==e.innerShadow&&this.innerShadow.update(e.innerShadow),void 0!==e.layerBlur&&this.layerBlur.update(e.layerBlur),void 0!==e.backgroundBlur&&this.backgroundBlur.update(e.backgroundBlur)}clone(e){let t=new kK(this.uuid,this.data,e);return t.parent=void 0,t}},BK=class extends kK{constructor(e,t,n){super(e,t,n),this.uuid=e,this.data=t,this.width=0,this.height=0,this.updateState(t,n)}innerDraw(e){e.ellipse(.5*this.width,.5*this.height,.5*this.width,.5*this.height,0,0,2*Math.PI)}intersectsInLocalSpace(e,t){return function(e,t,n,i,r,s){let a=e-n,o=t-i;return a*a/(r*r)+o*o/(s*s)<=1}(e,t,.5*this.width,.5*this.height,.5*this.width,.5*this.height)}getCenter(){return[.5*this.width,.5*this.height]}getHalfSize(){return[.5*this.width,.5*this.height]}updateSizeState(e){let t=!1;void 0!==e.width&&(this.width="number"==typeof e.width?e.width:this.width,t=!0),void 0!==e.height&&(this.height="number"==typeof e.height?e.height:this.height,t=!0),t&&this.updateWorldMatrix(!0,!1,!0)}updateState(e,t){super.updateState(e,t),this.updateSizeState(e)}clone(e){let t=new BK(this.uuid,this.data,e);return t.parent=void 0,t}},RK=class extends kK{constructor(e,t,n){super(e,t,n),this.uuid=e,this.data=t,this.width=0,this.height=0,this.cornerRadius=[0,0,0,0],this.updateState(t,n)}innerDraw(e){e.rect(0,0,this.width,this.height,...this.cornerRadius)}getCenter(){return[.5*this.width,.5*this.height]}getHalfSize(){return[.5*this.width,.5*this.height]}updateCornerState(e){void 0!==e.cornerRadius&&(this.cornerRadius=e.cornerRadius)}updateSizeState(e){let t=!1;void 0!==e.width&&(this.width="number"==typeof e.width?e.width:this.width,t=!0),void 0!==e.height&&(this.height="number"==typeof e.height?e.height:this.height,t=!0),t&&this.updateWorldMatrix(!0,!1,!0)}updateState(e,t){super.updateState(e,t),this.updateSizeState(e),this.updateCornerState(e)}clone(e){let t=new RK(this.uuid,this.data,e);return t.parent=void 0,t}},LK=class extends kK{constructor(e,t,n){super(e,t,n),this.uuid=e,this.data=t,this._textHeight=0,this._textHeightDirty=!0,this.width=0,this.height=0,this.updateState(t,n)}get textHeight(){return this._textHeight}applyFillStroke(e){e.fillColor=this.fill.enabled?this.fill.color:Uk.transparent,e.strokeColor=this.stroke.enabled&&this.stroke.thickness>0?this.stroke.color:Uk.transparent,e.strokeMode="center",e.lineWidth=this.stroke.thickness}innerDraw(e){var t,n,i;(null===(t=this._fontHolder)||void 0===t?void 0:t.arrayBuffer)&&this._fontHolder.arrayBuffer.byteLength>1&&this.data.font&&e.registerFont(this._fontHolder.arrayBuffer,this.data.font);let r=this.data.textTransform,s=this.data.text.textValue.toString(),a=2===r?s.toUpperCase():3===r?s.toLowerCase():s,{height:o}=e.drawText(a,{x:0,y:0,width:this.width,height:this.height,fontSize:this.data.fontSize,lineHeight:null!==(n=this.data.lineHeight)&&void 0!==n?n:1,letterSpacing:null!==(i=this.data.letterSpacing)&&void 0!==i?i:0,horizontalAlign:this.data.horizontalAlign,verticalAlign:this.data.verticalAlign,font:this.data.font});this._textHeight=o}getCenter(){return[.5*this.width,.5*this.height]}getHalfSize(){return[.5*this.width,.5*this.height]}updateSizeState(e){let t=!1;void 0!==e.width&&(this.width="number"==typeof e.width?e.width:this.width,t=!0),void 0!==e.height&&(this.height="number"==typeof e.height?e.height:this.height,t=!0),t&&this.updateWorldMatrix(!0,!1,!0)}updateFontState(e,t){let{shared:n}=t;void 0!==e.font&&(this._fontHolder=n.getFont(e.font),this._fontHolder&&!this._fontHolder.isLoaded&&this._fontHolder.loadingPromise.then((()=>{this.requestRender()})))}updateState(e,t){super.updateState(e,t),this.updateSizeState(e),this.updateFontState(e,t)}clone(e){let t=new LK(this.uuid,this.data,e);return t.parent=void 0,t}},zK=class extends kK{constructor(e,t,n){super(e,t,n),this.uuid=e,this.data=t,this.curves=[],this.extremasBBox={min:[0,0],max:[0,0]},this.updateState(t,n)}computeExtremas(){0===this.curves.length&&this.computeCurves();let e=this.curves.map((e=>AK.extremas(e))),t=[1/0,1/0],n=[-1/0,-1/0];for(let i=0,r=e.length;i<r;i++){let r=e[i];r[0][0]<t[0]&&(t[0]=r[0][0]),r[0][1]<t[1]&&(t[1]=r[0][1]),r[1][0]>n[0]&&(n[0]=r[1][0]),r[1][1]>n[1]&&(n[1]=r[1][1])}return this.extremasBBox.min=[t[0],t[1]],this.extremasBBox.max=[n[0],n[1]],this.extremasBBox}computeCurves(){this.curves=[];for(let n=1,i=this.data.points.length;n<i;n++){let e=this.data.points[n].data,t=this.data.points[n-1].data,i={start:t.position,cp1:t.controlNext.position,cp2:e.controlPrevious.position,end:e.position};this.curves.push(i)}let e=this.data.points[0].data,t=this.data.points[this.data.points.length-1].data;if(this.data.isClosed){let n={start:t.position,cp1:t.controlNext.position,cp2:e.controlPrevious.position,end:e.position};this.curves.push(n)}}getCenter(){let[e,t]=this.extremasBBox.min,[n,i]=this.getHalfSize();return[e+n,t+i]}getHalfSize(){let{min:e,max:t}=this.extremasBBox;return[.5*(t[0]-e[0]),.5*(t[1]-e[1])]}innerDraw(e){for(let i=0,r=this.data.points.length;i<r;i++){let t=this.data.points[i].data;if(0===i){let[n,i]=t.position;e.moveTo(n,i)}else{let n=this.data.points[i-1].data,[r,s]=n.controlNext.position,[a,o]=t.controlPrevious.position,[l,u]=t.position,c={start:n.position,cp1:n.controlNext.position,cp2:t.controlPrevious.position,end:t.position};AK.derive(c),e.bezierCurveTo(r,s,a,o,l,u)}}let t=this.data.points[0].data,n=this.data.points[this.data.points.length-1].data;if(this.data.isClosed){let[i,r]=n.controlNext.position,[s,a]=t.controlPrevious.position,[o,l]=t.position;e.bezierCurveTo(i,r,s,a,o,l)}}updateState(e,t){super.updateState(e,t),this.computeExtremas()}clone(e){let t=new zK(this.uuid,this.data,e);return t.parent=void 0,t}};(e=>{function t(e,t,n){let i=e-2*t+n;if(0!==i){let r=-Math.sqrt(Math.abs(t*t-e*n)),s=-e+t;return[-(r+s)/i,-(-r+s)/i]}return t!==n&&0===i?[(2*t-n)/(2*(t-n))]:[]}e.derive=function(e){let t=e.start,n=e.cp1,i=e.cp2,r=e.end,s={start:[3*(n[0]-t[0]),3*(n[1]-t[1])],cp:[3*(i[0]-n[0]),3*(i[1]-n[1])],end:[3*(r[0]-i[0]),3*(r[1]-i[1])]};return e.derivative=s,s.derivative=MK.derive(s),s},e.droot=function(n){var i;let r=null!==(i=n.derivative)&&void 0!==i?i:e.derive(n),s=r.start,a=r.cp,o=r.end;return[t(s[0],a[0],o[0]),t(s[1],a[1],o[1])]},e.extremas=function(t){let[n,i]=e.droot(t),r=[t.start[0],t.end[0]],s=[t.start[1],t.end[1]];for(let a of n)r.push(e.compute(t,Math.min(1,Math.max(0,a)))[0]);for(let a of i)s.push(e.compute(t,Math.min(1,Math.max(0,a)))[1]);return r.sort(((e,t)=>e-t)),s.sort(((e,t)=>e-t)),[[r[0],s[0]],[r[r.length-1],s[s.length-1]]]},e.compute=function(e,t){if(0===t)return[...e.start];if(1===t)return[...e.end];let n=1-t,i=n*n,r=t*t,s=i*n,a=i*t*3,o=n*r*3,l=t*r;return[s*e.start[0]+a*e.cp1[0]+o*e.cp2[0]+l*e.end[0],s*e.start[1]+a*e.cp1[1]+o*e.cp2[1]+l*e.end[1]]}})(AK||(AK={})),(e=>{e.derive=function(e){let t=e.start,n=e.cp,i=e.end,r={start:[2*(n[0]-t[0]),2*(n[1]-t[1])],end:[2*(i[0]-n[0]),2*(i[1]-n[1])]};return r.derivative=TK.derive(r),e.derivative=r,r},e.droot=function(t){var n;let i=null!==(n=t.derivative)&&void 0!==n?n:e.derive(t),r=i.start,s=i.end;return[r[0]!==s[0]?r[0]/(r[0]-s[0]):0,r[1]!==s[1]?r[1]/(r[1]-s[1]):0]},e.compute=function(e,t){if(0===t)return[...e.start];if(1===t)return[...e.end];let n=1-t,i=n*n,r=n*t*2,s=t*t;return[i*e.start[0]+r*e.cp[0]+s*e.end[0],i*e.start[1]+r*e.cp[1]+s*e.end[1]]}})(MK||(MK={})),(e=>{e.derive=function(e){let t=e.start,n=e.end,i=[n[0]-t[0],n[1]-t[1]];return e.derivative=i,e.derivative},e.compute=function(e,t){if(0===t)return[...e.start];if(1===t)return[...e.end];let n=e.start,i=e.end;return[n[0]+(i[0]-n[0])*t,n[1]+(i[1]-n[1])*t]}})(TK||(TK={}));var NK=class extends uK{constructor(e,t,n){super(e,t,n),this.uuid=e,this.width=0,this.height=0,this.clipped=!0,this.background=new RK(e+"-background",XR.defaultData,n),this.background.parent=this,this.updateState(t,n)}get fill(){return this.background.fill}get stroke(){return this.background.stroke}get backgroundBlur(){return this.background.backgroundBlur}get layerBlur(){return this.background.layerBlur}get dropShadow(){return this.background.dropShadow}get innerShadow(){return this.background.innerShadow}get cornerRadius(){return this.background.cornerRadius}set cornerRadius(e){this.background.cornerRadius=e}updateLocalMatrix(){var e;super.updateLocalMatrix(),null===(e=this.background)||void 0===e||e.updateLocalMatrix()}updateWorldMatrix(e,t,n){var i;super.updateWorldMatrix(e,t,n),null===(i=this.background)||void 0===i||i.updateWorldMatrix(e,t,n)}draw(e){if(!this.visible)return;e.save();let t=this.width,n=this.height;this.applyTransforms(e),this.background.width=t,this.background.height=n,this.background.draw(e),this.clipped&&e.clipRect(0,0,t,n,...this.cornerRadius),this.innerDrawChildren(e),e.restore()}getCenter(){return[.5*this.width,.5*this.height]}getHalfSize(){return[.5*this.width,.5*this.height]}updateCornerState(e){void 0!==e.cornerRadius&&(this.cornerRadius=e.cornerRadius)}updateSizeState(e){let t=!1;void 0!==e.width&&(this.width="number"==typeof e.width?e.width:this.width,t=!0),void 0!==e.height&&(this.height="number"==typeof e.height?e.height:this.height,t=!0),t&&this.updateWorldMatrix(!0,!1,!0)}updateState(e,t){super.updateState(e,t),this.updateSizeState(e),this.updateCornerState(e),void 0!==e.fill&&this.fill.update(e.fill),void 0!==e.stroke&&this.stroke.update(e.stroke),void 0!==e.dropShadow&&this.dropShadow.update(e.dropShadow),void 0!==e.innerShadow&&this.innerShadow.update(e.innerShadow),void 0!==e.layerBlur&&this.layerBlur.update(e.layerBlur),void 0!==e.backgroundBlur&&this.backgroundBlur.update(e.backgroundBlur),void 0!==e.clipped&&(this.clipped=e.clipped)}requestRender(){super.requestRender(),this.dispatchEvent({type:"render"})}dispose(){this.removeEventListener("render")}updateByPatchedOp(e,t,n){super.updateByPatchedOp(e,t,n),0===e.type&&(zO(e.path,["fill"])?this.fill.update(e.props):zO(e.path,["stroke"])?this.stroke.update(e.props):zO(e.path,["dropShadow"])?this.dropShadow.update(e.props):zO(e.path,["innerShadow"])?this.innerShadow.update(e.props):zO(e.path,["layerBlur"])?this.layerBlur.update(e.props):zO(e.path,["backgroundBlur"])?this.backgroundBlur.update(e.props):this.resetBBoxNeedsUpdate())}clone(e){let t=new NK(this.uuid,this.data,e);t.parent=void 0;for(let n of this.children)t.add(n.clone(e));return t}},jK=Cm(Im(),1),UK=class extends kK{constructor(e,t,n){super(e,t,n),this.uuid=e,this.data=t,this._pathBBox=new DOMRect,this.path="",this.updateState(t,n),this.autoClose=!1,this.computeSVGBBox()}computeSVGBBox(){let e=document.createElementNS("http://www.w3.org/2000/svg","svg"),t=document.createElementNS("http://www.w3.org/2000/svg","path");document.body.appendChild(e),t.setAttribute("d",this.path),e.appendChild(t),this._pathBBox=t.getBBox(),e.remove()}innerDraw(e){e.path(this.path)}intersectsInLocalSpace(e,t){return e>=this._pathBBox.x&&e<=this._pathBBox.x+this._pathBBox.width&&t>=this._pathBBox.y&&t<=this._pathBBox.y+this._pathBBox.height}getCenter(){return[(this._pathBBox.x+this._pathBBox.width)/2,(this._pathBBox.y+this._pathBBox.height)/2]}getHalfSize(){return[(this._pathBBox.x+this._pathBBox.width)/2,(this._pathBBox.y+this._pathBBox.height)/2]}updateState(e,t){super.updateState(e,t),void 0!==e.path&&(this.path=e.path,this.computeSVGBBox())}clone(e){let t=new UK(this.uuid,this.data,e);return t.parent=void 0,t}};var VK=class{constructor(e,t,n){this.uuid=e,this.data=t,this.group=new cK(VK.GROUP_ID,d({},JR.defaultData),n),this.createChildrenObjects(t.objects,this.group,n)}createObject(e,t,n,i,r,s){let a=function(e,t,n){switch(t.type){case"ellipse2d":return new BK(e,t,n);case"rectangle2d":return new RK(e,t,n);case"text2d":return new LK(e,t,n);case"vector2d":return new zK(e,t,n);case"path2d":return new UK(e,t,n);case"frame2d":return new NK(e,t,n);default:return new cK(e,t,n)}}(e,t,s);a&&(i.add(a),i.children.splice(r,0,i.children.pop()),a.updateWorldMatrix(),n.length>0&&(a instanceof cK||a instanceof NK)&&this.createChildrenObjects(n,a,s))}createChildrenObjects(e,t,n){let i=0;for(let r of e)this.createObject(r.id,r.data,r.children,t,i,n),i+=1}draw(e){this.group.draw(e)}updateEntityByOp(e,t,n,i){let r=this.find(e);if(r)try{r.updateByOp(t,n,{shared:i})}catch(s){console.error(s)}}updateTreeByOp(e,t){if(0===e.path.length&&7===e.type){let n=null===e.parent?this.group:this.find(e.parent);void 0!==n&&n instanceof uK&&(this.createObject(e.id,e.data,e.children,n,e.localIndex,t),n.requestRender())}else if(0===e.path.length&&8===e.type){let t=this.find(e.id);if(void 0!==t&&void 0!==t.parent&&t.parent instanceof uK){let e=t.parent;t.resetBBoxNeedsUpdate(),null!==e&&void 0!==e&&e.remove(t),null===e||void 0===e||e.requestRender()}}else if(0===e.path.length&&9===e.type){let t=this.find(e.id);if(void 0!==t){let n=t.parent,i=null===e.parent?this:this.find(e.parent);if(i instanceof uK||i===this){i.add(t);let r=e.localIndex;i.children.splice(r,0,i.children.pop()),t.updateWorldMatrix(!0,!1,!0),null!==n&&void 0!==n&&n.requestRender(),t.requestRender()}t.resetBBoxNeedsUpdate()}}}add(e){this.group.add(e)}remove(e){this.group.remove(e)}traverse(e){this.group.traverse((t=>{t!==this.group&&e(t)}))}intersectsChildren(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];return this.group.intersectsChildren(e,t,n,i,r,!0)}intersectsChildrenReverse(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];return this.group.intersectsChildrenReverse(e,t,n,i,r,!0)}find(e){return this.group.find(e)}get children(){return this.group.children}project(e,t){return this.group.project(e,t)}getWithSortKey(e){let t=this.find(e);if(void 0===t)return;let n=[],i=t;for(;i!==this.group;){let e=i;i=i.parent;let t=i.children.indexOf(e);n.splice(0,0,t)}return{entity:t,sortKey:n}}getAllSorted(e){let t=[];for(let n of e){let e=this.getWithSortKey(n.id);void 0!==e&&t.push(e)}return t.sort(((e,t)=>TF(e.sortKey,t.sortKey))),t.map((e=>e.entity))}},HK=VK;function WK(e){let{constraints:t,newParentWidth:n,newParentHeight:i,initialParentWidth:r,initialParentHeight:s,objectInitialWidth:a,objectInitialHeight:o,objectInitialPosition:l}=e,{horizontalConstraint:u,verticalConstraint:c}=t,h=n-r,d=i-s,p=a,f=o,m=l[0],g=l[1];if(0!==u)if(1===u)m+=h;else if(3===u)m+=h/2;else if(2===u)p=Math.max(1,p+h);else if(4===u){let e=n/r;p*=e,m*=e}if(0!==c)if(1===c)g+=d;else if(3===c)g+=d/2;else if(2===c)f=Math.max(1,f+d);else if(4===c){let e=i/s;f*=e,g*=e}return{width:p,height:f,position:[m,g]}}HK.GROUP_ID="scene2d";Cm(Im(),1);var GK=new ab(-1,1,1,-1,0,1),qK=new class extends dx{constructor(){super(),this.setAttribute("position",new rx([-1,3,0,-1,-1,0,3,-1,0],3)),this.setAttribute("uv",new rx([0,2,0,0,2,0],2))}},YK=new Ix({defines:{},uniforms:{tDiffuse:new pE(null)},vertexShader:"\n\tvarying vec2 vUv;\n\tvoid main() {\n\t\tvUv = uv;\n\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t}",fragmentShader:"\n\tuniform sampler2D tDiffuse;\n\tvarying vec2 vUv;\n\tvoid main() {\n\t\tvec4 texel = texture2D( tDiffuse, vUv );\n\t\tgl_FragColor = texel;\n\t}"}),XK=new class{constructor(e){this._mesh=new Cx(qK,e)}dispose(){this._mesh.geometry.dispose()}render(e){e.render(this._mesh,GK)}get material(){return this._mesh.material}set material(e){this._mesh.material=e}}(YK),QK=null,KK=null,ZK=JQ.identity(),JK=class{constructor(e,t,n,i){this.uuid=e,this.width=t,this.height=n,this.context=i,this.enabled=!0,this.isScreenSpace=!1,this.dpr=window.devicePixelRatio,this.isFrameDirty=!1,this.onRenderRequestedDownstream=()=>{this.isFrameDirty=!0,this.context.shared.requestRender()},this._innerApplySize=()=>{let e=this.width,t=this.height,n=this.dpr;this.renderer.dpr=this.isScreenSpace?n:Math.floor(2048/Math.max(e,t)),this.renderer.setSize(e,t)},this.onFrameOverrideObjectEvent=e=>{var t;if(void 0!==(null===(t=e.target)||void 0===t?void 0:t.uuid)){var n;let t=null===(n=this.frameRoot)||void 0===n?void 0:n.find(e.target.uuid);t&&t.dispatchEvent(d(d({},e),{},{target:t}))}},this.scene2d=new HK(ov.generateUUID(),tL.defaultData,{dpr:window.devicePixelRatio,shared:i.shared}),this.canvas=(null===QK&&(QK=document.createElement("canvas")),QK),this.renderer=(e=>(null===KK&&(KK=new SK(e)),KK))(this.canvas),this.promise=this.init(),this.renderTarget=new Iv(1,1,{type:yg,stencilBuffer:!1,depthBuffer:!1}),i.shared.addUIBuffer(this.uuid,this.renderTarget),this.textureHolder=i.shared.uiBuffer(this.uuid)}get canvasTexture(){return this._canvasTexture||(this._canvasTexture=new $D(this.canvas)),this._canvasTexture}async init(){this.renderer instanceof SK&&(this.renderer.wasmURL=pW.skiaWasmUrl),await this.renderer.init()}render(e){if(this.isFrameDirty){var t,n;this.isFrameDirty=!1,this._innerApplySize(),this.renderer.clear(),null!==(t=this.frameOverride)&&void 0!==t&&t.draw(this.renderer),this.renderer.render(),YK.uniforms.tDiffuse.value=this.canvasTexture,this.canvasTexture.needsUpdate=!0;let i=e.getRenderTarget();e.setRenderTarget(this.renderTarget),e.clear(),XK.render(e),e.setRenderTarget(i),null===(n=this.textureHolder)||void 0===n||n.setNeedsUpdate(!0)}}updateEntity2DByOp(e,t,n,i){this.scene2d.updateEntityByOp(e,t,n,i),this.applySize()}updateTreeByOp(e,t){this.scene2d.updateTreeByOp(e,t),this.applySize()}applyOverrides(e){if(this.frameOverride&&this.frameRoot){var t,n;this.frameOverride.position=[0,0],this.frameOverride.rotation=0;let i=null!==(t=null===e||void 0===e?void 0:e.width)&&void 0!==t?t:this.width,r=null!==(n=null===e||void 0===e?void 0:e.height)&&void 0!==n?n:this.height;this.frameOverride.width=i,this.frameOverride.height=r,this.frameOverride.localMatrix=ZK,this.isScreenSpace&&(this.frameOverride.fill.color=Uk.from0to1([0,0,0,0])),this.frameOverride.data=d(d({},this.frameOverride.data),{},{width:i,height:r}),$K({objectOverride:this.frameOverride,objectRoot:this.frameRoot,newParentWidth:this.frameOverride.width,newParentHeight:this.frameOverride.height,initialParentWidth:this.frameRoot.width,initialParentHeight:this.frameRoot.height}),this.frameOverride.updateWorldMatrix(!0,!1,!0)}}applySize(e){var t,n,i,r;let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window.devicePixelRatio,a=Math.max(1,null!==(t=null===e||void 0===e?void 0:e.width)&&void 0!==t?t:this.width),o=Math.max(1,null!==(n=null===e||void 0===e?void 0:e.height)&&void 0!==n?n:this.height);this.dpr=s,this.width=a,this.height=o,this._innerApplySize();let l=1;(a*s<512||o*s<512)&&(l=Math.max(512/(a*s),512/(o*s))),this.renderTarget.setSize(a*s*l,o*s*l),null!==(i=this._canvasTexture)&&void 0!==i&&i.dispose(),this._canvasTexture=void 0,this.applyOverrides(e),null===(r=this.frameOverride)||void 0===r||r.requestRender()}applyFrame(e){var t,n;let i=this.context.scene.find2D(e);if(i&&i instanceof NK)return this.disposeFrameOverride(),this.frameRoot=i,this.frameOverride=i.clone({dpr:this.renderer.dpr,shared:this.context.shared}),this.scene2d.add(this.frameOverride),this.applySize(),null!==(t=this.frame)&&void 0!==t&&t.addEventListener("render",this.onRenderRequestedDownstream),this.frameOverride.traverse((e=>{e.addEventListener("beginState",this.onFrameOverrideObjectEvent)})),this.frameOverride.traverse((e=>{e.addEventListener("completeState",this.onFrameOverrideObjectEvent)})),null!==(n=this.frame)&&void 0!==n&&n.requestRender(),i}get frame(){return this.frameOverride}get frameId(){var e;return null===(e=this.frame)||void 0===e?void 0:e.uuid}find(e){return this.scene2d.find(e)}get texture(){var e;return null===(e=this.textureHolder)||void 0===e?void 0:e.getTexture(1001)}disposeFrameOverride(){var e,t,n;null!==(e=this.frameOverride)&&void 0!==e&&e.removeEventListener("render",this.onRenderRequestedDownstream),null!==(t=this.frameOverride)&&void 0!==t&&t.traverse((e=>{e.removeEventListener("beginStateChange",this.onFrameOverrideObjectEvent)})),null!==(n=this.frameOverride)&&void 0!==n&&n.traverse((e=>{e.removeEventListener("completeState",this.onFrameOverrideObjectEvent)})),this.frameOverride&&this.scene2d.remove(this.frameOverride)}};function $K(e){let{objectOverride:t,objectRoot:n,newParentWidth:i,newParentHeight:r,initialParentWidth:s,initialParentHeight:a}=e;if(t instanceof NK&&n instanceof NK||t instanceof cK&&n instanceof cK)for(let o=0,l=t.children.length;o<l;o++){let e=t.children[o],l=n.children[o];e&&l&&e.uuid===l.uuid&&eZ({objectOverride:e,objectRoot:l,newParentWidth:i,newParentHeight:r,initialParentWidth:s,initialParentHeight:a})}}function eZ(e){let{objectOverride:t,objectRoot:n,newParentWidth:i,newParentHeight:r,initialParentWidth:s,initialParentHeight:a}=e,[o,l]=function(e){if(nZ(e))return[e.width,e.height];if(e instanceof UK){let[t,n]=e.getHalfSize();return[2*t,2*n]}if(e instanceof cK){let[t,n]=e.recursiveBBox.getHalfSize();return[2*t,2*n]}return[0,0]}(n),{width:u,height:c,position:h}=WK({constraints:t.data,newParentWidth:i,newParentHeight:r,initialParentWidth:s,initialParentHeight:a,objectInitialWidth:o,objectInitialHeight:l,objectInitialPosition:n.position});if(t.position=h,t.data=d(d({},t.data),{},{position:h}),t.states)for(let d in t.states)tZ({stateId:d,objectOverride:t,objectRoot:n,newParentWidth:i,newParentHeight:r,initialParentWidth:s,initialParentHeight:a});if(nZ(t)||t instanceof cK)nZ(t)&&(t.width=u,t.height=c,t.data=d(d({},t.data),{},{width:u,height:c})),$K({objectOverride:t,objectRoot:n,newParentWidth:u,newParentHeight:c,initialParentWidth:o,initialParentHeight:l});else if(t instanceof UK){let e=n,i=0!==o?u/o:1,r=0!==l?c/l:1;t.path=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;if(t<=0||n<=0)return e;let i=(0,jK.parseSVG)(e).map((e=>{let i=d({},e);return"x"in i&&(i.x=i.x*t),"y"in i&&(i.y=i.y*n),"x1"in i&&(i.x1=i.x1*t),"x2"in i&&(i.x2=i.x2*t),"y1"in i&&(i.y1=i.y1*n),"y2"in i&&(i.y2=i.y2*n),"rx"in i&&(i.rx=i.rx*t),"ry"in i&&(i.ry=i.ry*n),i}));return function(e){let t,n=["rx","ry","xAxisRotation","largeArc","sweep","x1","y1","x2","y2","x","y"];return e.map((e=>{let i=[];n.forEach((t=>{if(t in e){let n=1*e[t];i.length&&n>=0&&i.push(","),i.push(n)}}));let r=(t===e.code?i[0]<0?"":",":e.code)+i.join("");return t=e.code,r})).join("")}(i)}(e.path,i,r),t.data=d(d({},t.data),{},{path:t.path})}}function tZ(e){var t,n;let{stateId:i,objectOverride:r,objectRoot:s,newParentWidth:a,newParentHeight:o,initialParentWidth:l,initialParentHeight:u}=e,c=null===(t=r.states)||void 0===t?void 0:t[i],h=null===(n=s.states)||void 0===n?void 0:n[i];if(c&&h){let{width:e,height:t,position:n}=WK({constraints:r.data,newParentWidth:a,newParentHeight:o,initialParentWidth:l,initialParentHeight:u,objectInitialWidth:eL.isResizeable(h)?h.width:0,objectInitialHeight:eL.isResizeable(h)?h.height:0,objectInitialPosition:h.position});Object.assign(r.states[i],{position:n}),eL.isResizeable(c)&&Object.assign(r.states[i],{width:e,height:t})}}function nZ(e){return e instanceof RK||e instanceof NK||e instanceof BK||e instanceof LK}var iZ=class extends(lN(CD)){constructor(e,t,n){super(),this.data=t,this.bgColor=new jV(1,1,1,1),this.fog=null,this.backupFog=new ED(16777215,.1,2e3),this.fogUseBGColor=!1,this.isActive=!1,this.aoColor=new Ev,this.penumbraSizeArrayCache=null,this.super_Entity(e,t),this.personalCamera=new OY(Kk,d(d(d({},YB.defaultData),t.camera),{},{name:"Personal Camera"})),this.personalCamera.objectHelper.visible=!1,this.add(this.personalCamera),this.activeCamera=this.personalCamera,this.ambientLight=new kS(13882323,8553090,.75),this.ambientLight.name="Default Ambient Light",this.ambientLight.layers.enable(3),this.ambientLight.removeFromParent(),this.add(this.ambientLight),t.uiScene?this.uiScene=new HK((Array.isArray(e)?e[0]:e)+"-ui",t.uiScene,{dpr:window.devicePixelRatio,shared:n.shared}):t.uiFrame&&this.createUICanvas(t.uiFrame,n)}get scene(){return this.parent}get postprocessing(){return this.data.postprocessing}get frameId(){return this.data.uiFrame}get frame(){var e;return null===(e=this.uiCanvas)||void 0===e?void 0:e.frame}createUICanvas(e,t){this.uiCanvas=new JK(this.uuid+"-uiscreen",window.innerWidth,window.innerHeight,t),this.uiCanvas.isScreenSpace=!0,this.uiCanvas.promise.then((()=>{var t,n;null!==(t=this.uiCanvas)&&void 0!==t&&t.applyFrame(e),null===(n=this.uiCanvas)||void 0===n||n.applySize()}))}updateVisible(){}setBackgroundColor(e){this.bgColor=e,!0===this.fogUseBGColor&&(this.backupFog.color=e)}entityChildrenCount(){return this.uiScene?this.uiScene.children.length:super.entityChildrenCount()}updateAmbientLight(e,t){void 0!==e.color&&(this.ambientLight.color=QW(e.color,t)),void 0!==e.intensity&&(this.ambientLight.intensity=e.intensity),void 0!==e.enabled&&(e.enabled?this.add(this.ambientLight):this.remove(this.ambientLight))}onDeactive(){this.isActive=!1}onActive(e){this.isActive=!0,e.fog=this.fog,this.traverseEntity((e=>{e instanceof LY&&e.recomputeBoolean()})),this.updateShadow(this.data.shadow)}forceMaterialsUpdate(){this.traverseEntity((e=>{if(e instanceof yq)if(Array.isArray(e.material))for(let t of e.material)t.needsUpdate=!0;else e.material.needsUpdate=!0,e.material.dispose()}))}updateShadow(e){void 0!==e.softShadowQuality&&this.isActive&&function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"medium";if(zQ===e)return!1;zQ=e;let t=(e=>{switch(e){case"low":return 8;case"medium":default:return 16;case"high":return 32}})(e);Kx.shadowmap_pars_fragment=(e=>"\n\n// PCSS implementation based on:\n// https://www.gamedev.net/articles/programming/graphics/contact-hardening-soft-shadows-made-fast-r4906/\n// NOTE: This number affects how big the shadow blur can\n// possibly get. Bigger number == bigger blur, but less precise results\n\nconst float  gPenumbraFilterSize = 80.0;\nconst int   gPenumbraSamples = ".concat(e,";\nconst int gShadowSamples = ").concat(e,";\nconst float gShadowSamplesRpc = 1.0f / float(gShadowSamples);\n\n#ifdef USE_SHADOWMAP\n    #if NUM_DIR_LIGHT_SHADOWS > 0\n\n        uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n        varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\n        struct DirectionalLightShadow {\n            float shadowBias;\n            float shadowNormalBias;\n            float shadowRadius;\n            vec2 shadowMapSize;\n        };\n\n        uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\n    #endif\n\n    #if NUM_SPOT_LIGHT_SHADOWS > 0\n\n        uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n        varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\n        struct SpotLightShadow {\n            float shadowBias;\n            float shadowNormalBias;\n            float shadowRadius;\n            vec2 shadowMapSize;\n        };\n\n        uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\n    #endif\n\n    #if NUM_POINT_LIGHT_SHADOWS > 0\n\n        uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n        varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\n        struct PointLightShadow {\n            float shadowBias;\n            float shadowNormalBias;\n            float shadowRadius;\n            vec2 shadowMapSize;\n            float shadowCameraNear;\n            float shadowCameraFar;\n        };\n\n        uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\n    #endif\n\n    /*\n    #if NUM_RECT_AREA_LIGHTS > 0\n\n        // TODO (abelnation): create uniforms for area light shadows\n\n    #endif\n    */\n\nfloat computePenumbra(int index, sampler2D shadowMap, float temporalAngle, float texelSize, vec2 uv, float compare, float texelScalar, float shadowRadius)\n{\n    float penumbra = 1.0;\n    float blockerDepthAvg = 0.0;\n    float blockerCount = 0.0;\n\n    #pragma unroll_loop_start\n    for(int i = 0; i < gPenumbraSamples; i ++)\n    {\n        vec2 offset = (vogelDiskSample(i, gShadowSamples, temporalAngle) * texelSize) * texelScalar;\n        float depth = unpackRGBAToDepth( texture2D( shadowMap, uv + offset ) );\n\n        if(depth < compare + 0.0001)\n        {\n            blockerDepthAvg += depth;\n            blockerCount++;\n        }\n    }\n    #pragma unroll_loop_end\n\n    if (blockerCount > 0.0)\n    {\n        blockerDepthAvg /= blockerCount;\n\n        // Compute penumbra\n        penumbra = (compare - blockerDepthAvg) / (blockerDepthAvg);\n        penumbra *= penumbra;\n        penumbra *= 200.0 * penumbraSize[min(index, ",5," - 1)]; // Magic number that affects how quickly the penumbra grows\n\n        return clamp(penumbra, 0.00, 1.0);\n    }\n    return 0.0;\n}\n\nfloat vogelShadow(int index, sampler2D shadowMap, vec2 uv, float texelSize, float compare, float shadowRadius)\n{\n    float shadow         = 0.0f;\n\n    // NOTE: When using TAA, we should use screen space interleaved gradient noise\n    vec2 halton = haltonSequence[frameIndex];\n    float temporalOffset = getNoiseInterleavedGradient(gl_FragCoord.xy + halton);\n    float temporalAngle  = temporalOffset * PI2;\n\n    float texelScalar = (gPenumbraFilterSize) / (texelSize * 1024.);\n    float penumbra = computePenumbra(index, shadowMap, temporalAngle, texelSize, uv, compare, texelScalar, shadowRadius);\n    if (penumbra == -1.0) {\n        return 1.0;\n    }\n\n    #pragma unroll_loop_start\n    for (int i = 0; i < gShadowSamples; i++)\n    {\n        vec2 vogelSample =  vogelDiskSample(i, gShadowSamples, temporalAngle) * texelSize;\n        // Overall blurring offset\n        vec2 offset = vogelSample * (shadowRadius * 2.);\n\n        // Penumbra offset\n        offset += vogelSample * (penumbra * texelScalar);\n\n        shadow += step( compare, unpackRGBAToDepth( texture2D( shadowMap, uv + offset ) ) );\n    }\n    #pragma unroll_loop_end\n\n    return shadow * gShadowSamplesRpc;\n}\n\n\n    float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\n        return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\n    }\n\n    vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n\n        return unpackRGBATo2Half( texture2D( shadow, uv ) );\n\n    }\n\n    float VSMShadow (sampler2D shadow, vec2 uv, float compare ){\n\n        float occlusion = 1.0;\n\n        vec2 distribution = texture2DDistribution( shadow, uv );\n\n        float hard_shadow = step( compare , distribution.x ); // Hard Shadow\n\n        if (hard_shadow != 1.0 ) {\n\n            float distance = compare - distribution.x ;\n            float variance = max( 0.00000, distribution.y * distribution.y );\n            float softness_probability = variance / (variance + distance * distance ); // Chebeyshevs inequality\n            softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 ); // 0.3 reduces light bleed\n            occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n\n        }\n        return occlusion;\n\n    }\n\n    float getShadow( int i, sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\n        float shadow = 1.0;\n\n        shadowCoord.xyz /= shadowCoord.w;\n        shadowCoord.z += shadowBias;\n\n        // if ( something && something ) breaks ATI OpenGL shader compiler\n        // if ( all( something, something ) ) using this instead\n\n        bvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n        bool inFrustum = all( inFrustumVec );\n\n        bvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\n        bool frustumTest = all( frustumTestVec );\n\n        if ( frustumTest ) {\n\n        #if defined( SHADOWMAP_TYPE_PCF )\n\n            vec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n            return vogelShadow(i, shadowMap, shadowCoord.xy, texelSize.x, shadowCoord.z, shadowRadius );\n\n        #elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\n            vec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n            float dx = texelSize.x;\n            float dy = texelSize.y;\n\n            vec2 uv = shadowCoord.xy;\n            vec2 f = fract( uv * shadowMapSize + 0.5 );\n            uv -= f * texelSize;\n\n            shadow = (\n                texture2DCompare( shadowMap, uv, shadowCoord.z ) +\n                texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n                texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n                texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n                mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),\n                     texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n                     f.x ) +\n                mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),\n                     texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n                     f.x ) +\n                mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),\n                     texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n                     f.y ) +\n                mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),\n                     texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n                     f.y ) +\n                mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),\n                          texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n                          f.x ),\n                     mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),\n                          texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n                          f.x ),\n                     f.y )\n            ) * ( 1.0 / 9.0 );\n\n        #elif defined( SHADOWMAP_TYPE_VSM )\n\n            shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n\n        #else // no percentage-closer filtering:\n\n            shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\n        #endif\n\n        }\n\n        return shadow;\n\n    }\n\n    // cubeToUV() maps a 3D direction vector suitable for cube texture mapping to a 2D\n    // vector suitable for 2D texture mapping. This code uses the following layout for the\n    // 2D texture:\n    //\n    // xzXZ\n    //  y Y\n    //\n    // Y - Positive y direction\n    // y - Negative y direction\n    // X - Positive x direction\n    // x - Negative x direction\n    // Z - Positive z direction\n    // z - Negative z direction\n    //\n    // Source and test bed:\n    // https://gist.github.com/tschw/da10c43c467ce8afd0c4\n\n    vec2 cubeToUV( vec3 v, float texelSizeY ) {\n\n        // Number of texels to avoid at the edge of each square\n\n        vec3 absV = abs( v );\n\n        // Intersect unit cube\n\n        float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n        absV *= scaleToCube;\n\n        // Apply scale to avoid seams\n\n        // two texels less per square (one texel will do for NEAREST)\n        v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\n        // Unwrap\n\n        // space: -1 ... 1 range for each square\n        //\n        // #X##         dim    := ( 4 , 2 )\n        //  # #         center := ( 1 , 1 )\n\n        vec2 planar = v.xy;\n\n        float almostATexel = 1.5 * texelSizeY;\n        float almostOne = 1.0 - almostATexel;\n\n        if ( absV.z >= almostOne ) {\n\n            if ( v.z > 0.0 )\n                planar.x = 4.0 - v.x;\n\n        } else if ( absV.x >= almostOne ) {\n\n            float signX = sign( v.x );\n            planar.x = v.z * signX + 2.0 * signX;\n\n        } else if ( absV.y >= almostOne ) {\n\n            float signY = sign( v.y );\n            planar.x = v.x + 2.0 * signY + 2.0;\n            planar.y = v.z * signY - 2.0;\n\n        }\n\n        // Transform to UV space\n\n        // scale := 0.5 / dim\n        // translate := ( center + 0.5 ) / dim\n        return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\n    }\n\n    float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\n        float shadow = 1.0;\n        vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\n        // for point lights, the uniform @vShadowCoord is re-purposed to hold\n        // the vector from the light to the world-space position of the fragment.\n        vec3 lightToPosition = shadowCoord.xyz;\n\n        // dp = normalized distance from light to fragment position\n        float compare = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear ); // need to clamp?\n        compare += shadowBias;\n\n        // bd3D = base direction 3D\n        vec3 bd3D = normalize( lightToPosition );\n\n        vec2 halton = haltonSequence[frameIndex];\n        float temporalOffset = getNoiseInterleavedGradient(gl_FragCoord.xy + halton);\n        float temporalAngle  = temporalOffset * PI2;\n\n        #if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_VSM )\n            for (int i = 0; i < gShadowSamples; i++) {\n                vec2 vogelSample = vogelDiskSample(i, gShadowSamples, temporalAngle) * texelSize;\n\n                // Overall blurring offset\n                vec3 offset = vec3(vogelSample.x, vogelSample.y, -vogelSample.x) * (shadowRadius + 5.);\n\n                // NOTE: Removed for now\n                // Penumbra offset\n                //offset += vec3(vogelSample.x, vogelSample.y, vogelSample.y)  * (penumbra * gPenumbraFilterSize);\n\n                shadow += texture2DCompare( shadowMap, cubeToUV( bd3D + offset, texelSize.y ), compare );\n\n            }\n            return shadow * gShadowSamplesRpc;\n\n        #elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n            for (int i = 0; i < 16; i++) {\n                vec2 vogelSample = vogelDiskSample(i, gShadowSamples, temporalAngle) * texelSize;\n\n                // Overall blurring offset\n                vec3 offset = vec3(vogelSample.x, vogelSample.y, -vogelSample.x) * (shadowRadius + 5.);\n\n                shadow += texture2DCompare( shadowMap, cubeToUV( bd3D + offset, texelSize.y ), compare );\n\n            }\n            return shadow * (1.0 / 16.0);\n        #else // no percentage-closer filtering\n\n            return texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), compare );\n\n        #endif\n\n    }\n\n#endif\n"))(t);let n=RQ.slice();n=n.replace("getShadow( spotShadowMap[ i ]","getShadow( UNROLLED_LOOP_INDEX + ".concat(3,", spotShadowMap[ i ]")),n=n.replace("getShadow( directionalShadowMap[ i ]","getShadow( UNROLLED_LOOP_INDEX, directionalShadowMap[ i ]"),Kx.lights_fragment_begin=n;let i=LQ.slice();return i=i.replaceAll("getShadow(","getShadow( UNROLLED_LOOP_INDEX, "),Kx.shadowmask_pars_fragment=i,!0}(e.softShadowQuality)&&this.forceMaterialsUpdate()}updateFog(e,t){if(e.enabled?this.fog=this.backupFog:this.fog=null,this.isActive){this.scene.fog=this.fog}this.fogUseBGColor=e.useBackgroundColor,e.useBackgroundColor?this.backupFog.color.set(this.bgColor):this.backupFog.color=QW(e.color,t),this.backupFog.near=e.near,this.backupFog.far=e.far}updateAo(e,t){void 0!==e.aoColor&&(this.aoColor=QW(e.aoColor,t))}updateByOp(e,t,n,i){let r=this.data.uiFrame;super.updateByOp(e,t,n,i);let s=t;zO(e.path,["fog"])?this.updateFog(s.fog,n.shared):zO(e.path,["ao"])?this.updateAo(s.ao,n.shared):zO(e.path,["ambient"])?this.updateAmbientLight(s.ambient,n.shared):zO(e.path,["shadow"])?this.updateShadow(s.shadow):0===e.type&&0===e.path.length&&(void 0!==e.props.uiFrame||r!==s.uiFrame)&&this.updateUIFrame(e.props.uiFrame,n)}updateUIFrame(e,t){e?(this.uiCanvas||this.createUICanvas(e,t),this.uiCanvas.enabled=!0,this.uiCanvas.applyFrame(e)):this.uiCanvas&&(this.uiCanvas.enabled=!1)}updateState(e,t){this.updateState_Entity(e,t),void 0!==e.backgroundColor&&this.setBackgroundColor(QW(e.backgroundColor,t.shared)),void 0!==e.fog&&this.updateFog(e.fog,t.shared),void 0!==e.ambient&&this.updateAmbientLight(e.ambient,t.shared),void 0!==e.ao&&this.updateAo(e.ao,t.shared),void 0!==e.shadow&&this.updateShadow(e.shadow)}createFrame(e,t){}raycast(e,t){super.raycast(e,t)}switchActiveCamera(e){e&&e.isDescendantOf(this)&&(this.activeCamera!==this.personalCamera&&(this.activeCamera.objectHelper.visible=!0),this.activeCamera=e,e.objectHelper.visible=!1)}get playCamera(){var e,t;return null!==(e=null===(t=this.scene)||void 0===t?void 0:t.find(this.data.publish.playCamera))&&void 0!==e?e:this.personalCamera}switchToPlayCamera(){this.switchActiveCamera(this.playCamera)}get penumbraSizeArray(){return null===this.penumbraSizeArrayCache&&this.updatePenumbraSizeArray(),this.penumbraSizeArrayCache}updatePenumbraSizeArray(){this.penumbraSizeArrayCache=new Array(5).fill(.5);let e=0,t=0;this.traverseEntity((n=>{var i,r;if(!n.visible)return!0;n instanceof $Q&&n.visible&&e<3&&(this.penumbraSizeArrayCache[e]=null!==(i=n.data.penumbraSize)&&void 0!==i?i:.5,e+=1),n instanceof iK&&n.visible&&e<2&&(this.penumbraSizeArrayCache[3+t]=null!==(r=n.data.penumbraSize)&&void 0!==r?r:.5,t+=1)}))}raycastWithClones(e){let t=[],n=i=>{for(let r of i.children){let i=r.cloner;Nz.is(r)&&(r.visible||(null===i||void 0===i?void 0:i.object.data.visible))&&((NY(r)||UY(r)&&this.scene.enableHelpers&&r.objectHelper.visible)&&(e.intersectObject(r,!1,t),JZ(r,e,t,!0)),n(r))}};return n(this),t}updateEntity2DByOp(e,t,n,i){var r;null===(r=this.uiCanvas)||void 0===r||r.updateEntity2DByOp(e,t,n,i)}},rZ=class extends(zY(GS,WQ)){constructor(e,t,n){super(),this.super_Entity(e,t),this.castShadow=!0,this.shadow.mapSize.width=1024,this.shadow.mapSize.height=1024,this.shadow.normalBias=1,this.layers.enable(3);let i=this.shadow.camera;i.fov=90,i.aspect=1,i.near=100,i.far=2500;let r=new Lv(-i.far+this.position.x,-i.far+this.position.y,-i.far+this.position.z),s=new Lv(i.far+this.position.x,i.far+this.position.y,i.far+this.position.z),a=new jv(r,s),o=new kE(a,new Ev(16755200));o.visible=!1,this.gizmos.shadowmap=o,this.update()}update(){if(this.shadow&&(this.shadow.camera.updateProjectionMatrix(),this.gizmos))for(let e in this.gizmos){let t=this.gizmos[e];if(t instanceof kE){let e=this.shadow.camera,n=new Lv(-e.far+this.position.x,-e.far+this.position.y,-e.far+this.position.z),i=new Lv(e.far+this.position.x,e.far+this.position.y,e.far+this.position.z);t.box.set(n,i),t.updateMatrixWorld(!0)}}}updateMatrixWorld(e){super.updateMatrixWorld(e),this.objectHelper&&this.objectHelper.update()}updateState(e,t){this.updateState_Light(e,t),void 0!==e.distance&&(this.distance=e.distance),void 0!==e.decay&&(this.decay=e.decay),void 0!==e.shadowRadius&&(this.shadow.radius=e.shadowRadius),void 0!==e.shadowResolution&&(this.shadow.mapSize.set(e.shadowResolution,e.shadowResolution),this.shadow.map&&(this.shadow.map.dispose(),this.shadow.map=null))}},sZ=class extends Sq{get forceComputeSize(){return!0}get shape(){return this.geometry.userData.shape}updateEntityBoxSize(e,t){let n=this.geometry.getAttribute("position");void 0!==n?MV(n,this.geometry.drawRange.start,this.geometry.drawRange.count<1/0?this.geometry.drawRange.count:n.count,e,t):super.updateEntityBoxSize(e,t)}},aZ=class extends Sq{constructor(e,t,n){super(e,t,n),this._shapeId=null,this._context=n}updateState(e,t){super.updateState(e,t),this.updateShape(),this.refreshAttachedCloners(t)}updateShape(){let e,t=d({},this.data.geometry.extrusion.shape);for(let r in t)"string"==typeof t[r]&&(t[r]=this._context.shared.getVariable(t[r],[this.uuid,"geometry","extrusion","shape",r]));if("Custom"===t.type){let i=t.shapeId;if(i!==this._shapeId&&this.detachShape(),i){var n;this._shapeId=i;let t=this._context.scene.find(i);null!==t&&void 0!==t&&t.data&&(t.attachedPaths.add(this),e=null===(n=t.geometry.userData)||void 0===n?void 0:n.shape),e||this._context.scene.addPendingCommand((()=>this.updateShape()))}}else{let n;switch(t.type){case"Rectangle":n=mU;break;case"Ellipse":n=kj;break;case"Polygon":n=cU;break;case"Star":n=vU;break;default:throw new Error("Unknown shape type: ".concat(t.type))}e=n.create({parameters:t}).userData.shape}let i=this.geometry;e&&i.inputs&&(i.inputs.shapeData=e,i.build())}detachShape(){var e;null!==this._shapeId&&(null===(e=this._context.scene.find(this._shapeId))||void 0===e||e.attachedPaths.delete(this))}createGeometryDelayed(e){this.geometryCreateDeleyed=e.shared,this.updateShape(),this.refreshAttachedPaths(e)}updateTransformState(e,t){return super.updateTransformState(e,t)}updateGeometryInteractions(e,t){super.updateGeometryInteractions(e,t),this.updateShape()}updateEntityBoxSize(e,t){let n=this.geometry.getAttribute("position");void 0!==n?MV(n,this.geometry.drawRange.start,this.geometry.drawRange.count<1/0?this.geometry.drawRange.count:n.count,e,t):super.updateEntityBoxSize(e,t)}},oZ=class extends eY{constructor(e,t,n){super(e,t,n),this.data=t}},lZ=class extends(EY(vD,qY)){constructor(e,t,n){super(),"Instance"===t.type&&"string"==typeof e&&(t=this.transformAssignData(t,n)),this.super_Entity(e,t),this.objectHelper.update()}get isComponentRoot(){return"Component"===this.data.type&&"string"==typeof this.identity}get isInstanceRoot(){return"Instance"===this.data.type&&"string"==typeof this.identity}transformAssignData(e,t){let n=RR.getComponentData({scene:t.scene.data,shared:t.shared.data},e.component);if(n){let t,i;for(let r of KB.rootOverrideProps)void 0===e[r]?(void 0===t&&(t=d({},e)),t[r]=n.data[r]):(void 0===i&&(i={}),i[r]=e[r],void 0===t&&(t=d({},e)),t[r]=oO.apply(n.data[r],e[r]));return this.overrideData=i,t}return d(d(d({},UB.defaultData),e),vF(UB.defaultData,KB.rootOverrideProps))}updateByOp(e,t,n,i){let r;if(this.isInstanceRoot&&!i)if(t=this.transformAssignData(t,n),0===e.type&&0===e.path.length&&this.component)for(let s of KB.rootOverrideProps)s in e.props&&void 0===e.props[s]&&(void 0===r&&(r=d(d({},e),{},{props:d({},e.props)})),r.props[s]=this.component.data[s]);else if(0===e.type&&e.path.length>0&&KB.rootOverrideProps.includes(e.path[0])){let n=e.path[0];void 0===r&&(r=d(d({},e),{},{path:[],props:{[n]:t[n]}}))}super.updateByOp(null!==r&&void 0!==r?r:e,t,n,i)}updateState(e,t){this.updateState_Entity(e,t)}expandInstanceChildren(e){let t=this.data;if(void 0===this.component){var n;let i=null!==(n=e.scene.find(t.component))&&void 0!==n?n:null,r=!1;if(i!==this.oldComponent){if(this.oldComponent){let t=0;for(let n of this.children){if(!Nz.is(n))break;e.scene.disposeAndUnregisterEntityRecursivelyIfNotReregistered(n),uZ(n),t+=1}this.children.splice(0,t)}r=!0}if(i){let n={};hZ(e,[this.uuid],t.overrides,this,i,i,0,r,n);for(let t of this.children)if(Nz.is(t)){let i=t.data;"Empty"===i.type&&i.animations&&t.traverseEntity((t=>{let i=t.dataPatched;if(t instanceof Sq&&i.bones&&i.boneInverses){let i=t.dataPatched;if(i.bones&&i.boneInverses){let r=i.bones.map((t=>e.scene.find(n[t]))),s=i.boneInverses.map((e=>(new py).fromArray(e))),a=new kD(r,s);t.bind(a,t.bindMatrix)}}else t.matrixAutoUpdate=!0}))}}this.oldComponent=this.component}}};function uZ(e){if(e.component){let t=e.component.instances.indexOf(e);t>=0&&e.component.instances.splice(t,1);for(let n of e.children)Nz.is(n)&&uZ(n)}}function cZ(e,t,n,i){return e.component===t&&oF(e.identity,i)?e.overrideData===n?2:1:0}function hZ(e,t,n,i,r,s,a,o,l){if(a>50)return!1;if(i.component!==r){if(i.component){let e=i.component.instances.indexOf(i);e>=0&&i.component.instances.splice(e,1)}r.instances.find((e=>e===i))||r.instances.push(i),i.component=r}r instanceof lZ&&r.isInstanceRoot&&r.expandInstanceChildren(e);let u=0;for(let h of r.children)if(Nz.is(h)){let r=[...t,..."string"==typeof h.identity?[h.identity]:h.identity],p=QB.resolve(n,r,1);null==p||p instanceof hO||(Object.setPrototypeOf(p,hO.prototype),console.error("wrong prototype"));let f,m=null;if(!o){var c;let t=i.children[u];if(m=Nz.is(t)?t:null,null!==m){let e=cZ(m,h,p,r);f=e>=1?m.stateSelection:void 0,2!==e&&(m=null)}if(null===m&&(m=null!==(c=e.scene.findInstance(r))&&void 0!==c?c:null,null!==m)){let t=cZ(m,h,p,r);if(f=t>=1?m.stateSelection:void 0,2!==t)m=null;else{let t=m.parent.children.indexOf(m);m.parent.children.splice(t,1),i.children.splice(u,0,m),m.parent===i?t<=u&&console.error("not possible"):(m.parent=i,m.matrixWorldNeedsUpdate=!0,m.resetBBoxNeedsUpdate(),m.updateVisible(),e.pendingDeletes.delete(m))}}}if(null===m){let t=p?oO.apply(h.data,p):h.data;qk.is(t.type)&&(t=d(d({},t),{},{type:"Empty"})),m=Zz.createEntity(r,t,e),m.overrideData=p,i.add(m),i.children.splice(i.children.length-1,1),i.children.splice(u,0,m),m.updateState(m.data,e),f&&m.changeSelectedState(f,e),e.scene.registerInstanceAndSetUuid(m)}if(m.isBone){l[m.identity[m.identity.length-1]]=m.uuid}u+=1,hZ(e,t,n,m,h,s,a+1,o,l)}if(!o){let t=u;for(;;){let t=i.children[u];if(!Nz.is(t))break;e.pendingDeletes.add(t),u+=1}i.children.splice(t,u-t)}return!0}var dZ=class extends(EY(PD,qY)){constructor(e,t){super(),this.super_Entity(e,t),this.objectHelper.update(),this.matrixAutoUpdate=!0}updateState(e,t){this.updateState_Entity(e,t)}},pZ=class extends Sq{constructor(e,t,n){super(e,t,n),this.onBeforeRender=e=>{this.uiCanvas.render(e)},this.uiCanvas=new JK(e+"-canvas",t.geometry.width,t.geometry.height,n),this.uiCanvas.promise.then((()=>{this.applyFrame(this.dataPatched.geometry.frame,n.shared)}))}updateByPatchedOpGeometry(e,t,n){super.updateByPatchedOpGeometry(e,t,n),0===e.type&&(void 0!==e.props.frame&&this.applyFrame(e.props.frame,n.shared),(void 0!==e.props.width||void 0!==e.props.height)&&this.applySize(e.props,n.shared))}applySize(e,t){var n,i;let r=null!==(n=null===e||void 0===e?void 0:e.width)&&void 0!==n?n:this.dataPatched.geometry.width,s=null!==(i=null===e||void 0===e?void 0:e.height)&&void 0!==i?i:this.dataPatched.geometry.height;this.uiCanvas.applySize({width:r,height:s}),this.applyGeometryParametersFromFrame(t)}applyFrame(e,t){this.uiCanvas.applyFrame(e),this.applyGeometryParametersFromFrame(t),this.applyMaterialParametersFromFrame({shared:t})}applyGeometryParametersFromFrame(e){var t;let n=this.frame;n&&(Object.assign(this.data,{geometry:Object.assign(this.data.geometry,{cornerRadius:n.cornerRadius,cornerType:0})}),Object.assign(this.dataPatched,{geometry:Object.assign(this.dataPatched.geometry,{cornerRadius:n.cornerRadius,cornerType:0})}),null!==(t=this.localGeometry)&&void 0!==t&&t.dispose(),this.localGeometry=qU(this.dataPatched.geometry,e,this.data.flatShading,this))}applyMaterialParametersFromFrame(e){let t=this.frame;if(t){let n=t.data.backgroundBlur;Object.assign(this.data.material.layers[0].data.texture,{image:this.uiCanvas.uuid}),Object.assign(this.data.material.layers[1].data,{roughness:n.radius,alpha:n.enabled?1:0}),Object.assign(this.dataPatched.material.layers[0].data.texture,{image:this.uiCanvas.uuid}),Object.assign(this.dataPatched.material.layers[1].data,{roughness:n.radius,alpha:n.enabled?1:0}),this.material.reset(this.dataPatched.material,e,!0)}}updateEntity2DByOp(e,t,n,i){this.uiCanvas.updateEntity2DByOp(e,t,n,i),e===this.frameId&&0===t.type&&(void 0!==t.props.cornerRadius?this.applyGeometryParametersFromFrame(i):zO(t.path,["backgroundBlur"])&&this.applyMaterialParametersFromFrame({shared:i}))}get frame(){return this.uiCanvas.frame}get frameId(){var e;return null===(e=this.frame)||void 0===e?void 0:e.uuid}removeInteractionGeometry(e){super.removeInteractionGeometry(e),this.applySize({},e)}updateGeometryInteractions(e,t){super.updateGeometryInteractions(e,t),this.applySize({width:e.width,height:e.height},t)}},fZ=class{constructor(e,t,n){this.variables=[],this.currentTextureIndex=0;let i=vg,r=new CD,s=new kx;s.position.z=1;let a={passThruTexture:{value:null}},o=c("uniform sampler2D passThruTexture;\n\nvoid main() {\n\n\tvec2 uv = gl_FragCoord.xy / resolution.xy;\n\n\tgl_FragColor = texture2D( passThruTexture, uv );\n\n}\n",a),l=new Cx(new Qx(2,2),o);function u(n){n.defines.resolution="vec2( "+e.toFixed(1)+", "+t.toFixed(1)+" )"}function c(e,t){let n=new Ix({uniforms:t=t||{},vertexShader:"void main()\t{\n\n\tgl_Position = vec4( position, 1.0 );\n\n}\n",fragmentShader:e});return u(n),n}r.add(l),this.setDataType=function(e){return i=e,this},this.addVariable=function(e,t,n){let i={name:e,initialValueTexture:n,material:this.createShaderMaterial(t),dependencies:null,renderTargets:[],wrapS:null,wrapT:null,minFilter:ug,magFilter:ug};return this.variables.push(i),i},this.setVariableDependencies=function(e,t){e.dependencies=t},this.init=function(){if(!1===n.capabilities.isWebGL2&&!1===n.extensions.has("OES_texture_float"))return"No OES_texture_float support for float textures.";if(0===n.capabilities.maxVertexTextures)return"No support for vertex shader textures.";for(let n=0;n<this.variables.length;n++){let i=this.variables[n];i.renderTargets[0]=this.createRenderTarget(e,t,i.wrapS,i.wrapT,i.minFilter,i.magFilter),i.renderTargets[1]=this.createRenderTarget(e,t,i.wrapS,i.wrapT,i.minFilter,i.magFilter),this.renderTexture(i.initialValueTexture,i.renderTargets[0]),this.renderTexture(i.initialValueTexture,i.renderTargets[1]);let r=i.material,s=r.uniforms;if(null!==i.dependencies)for(let e=0;e<i.dependencies.length;e++){let t=i.dependencies[e];if(t.name!==i.name){let e=!1;for(let n=0;n<this.variables.length;n++)if(t.name===this.variables[n].name){e=!0;break}if(!e)return"Variable dependency not found. Variable="+i.name+", dependency="+t.name}s[t.name]={value:null},r.fragmentShader="\nuniform sampler2D "+t.name+";\n"+r.fragmentShader}}return this.currentTextureIndex=0,null},this.compute=function(){let e=this.currentTextureIndex,t=0===this.currentTextureIndex?1:0;for(let n=0,i=this.variables.length;n<i;n++){let i=this.variables[n];if(null!==i.dependencies){let t=i.material.uniforms;for(let n=0,r=i.dependencies.length;n<r;n++){let r=i.dependencies[n];t[r.name].value=r.renderTargets[e].texture}}this.doRenderTarget(i.material,i.renderTargets[t])}this.currentTextureIndex=t},this.getCurrentRenderTarget=function(e){return e.renderTargets[this.currentTextureIndex]},this.getAlternateRenderTarget=function(e){return e.renderTargets[0===this.currentTextureIndex?1:0]},this.dispose=function(){l.geometry.dispose(),l.material.dispose();let e=this.variables;for(let t=0;t<e.length;t++){let n=e[t];n.initialValueTexture&&n.initialValueTexture.dispose();let i=n.renderTargets;for(let e=0;e<i.length;e++)i[e].dispose()}},this.addResolutionDefine=u,this.createShaderMaterial=c,this.createRenderTarget=function(n,r,s,a,o,l){return new Iv(n=n||e,r=r||t,{wrapS:s=s||og,wrapT:a=a||og,minFilter:o=o||ug,magFilter:l=l||ug,format:bg,type:i,depthBuffer:!1})},this.createTexture=function(){let n=new Float32Array(e*t*4),i=new FD(n,e,t,bg,vg);return i.needsUpdate=!0,i},this.renderTexture=function(e,t){a.passThruTexture.value=e,this.doRenderTarget(o,t),a.passThruTexture.value=null},this.doRenderTarget=function(e,t){let i=n.getRenderTarget(),a=n.xr.enabled,u=n.shadowMap.autoUpdate,c=n.outputEncoding,h=n.toneMapping;n.xr.enabled=!1,n.shadowMap.autoUpdate=!1,n.outputEncoding=zg,n.toneMapping=0,l.material=e,n.setRenderTarget(t),n.render(r,s),l.material=o,n.xr.enabled=a,n.shadowMap.autoUpdate=u,n.outputEncoding=c,n.toneMapping=h,n.setRenderTarget(i)}}},mZ=new Qy,gZ=new Lv,vZ=class{constructor(e){let t=e.geometry;if(!t.isBufferGeometry||3!==t.attributes.position.itemSize)throw new Error("THREE.MeshSurfaceSampler: Requires BufferGeometry triangle mesh.");t.index&&(console.warn("THREE.MeshSurfaceSampler: Converting geometry to non-indexed BufferGeometry."),t=t.toNonIndexed()),this.geometry=t,this.randomFunction=Math.random,this.positionAttribute=this.geometry.getAttribute("position"),this.colorAttribute=this.geometry.getAttribute("color"),this.weightAttribute=null,this.distribution=null}setWeightAttribute(e){return this.weightAttribute=e?this.geometry.getAttribute(e):null,this}build(){let e=this.positionAttribute,t=this.weightAttribute,n=new Float32Array(e.count/3);for(let r=0;r<e.count;r+=3){let i=1;t&&(i=t.getX(r)+t.getX(r+1)+t.getX(r+2)),mZ.a.fromBufferAttribute(e,r),mZ.b.fromBufferAttribute(e,r+1),mZ.c.fromBufferAttribute(e,r+2),i*=mZ.getArea(),n[r/3]=i}this.distribution=new Float32Array(e.count/3);let i=0;for(let r=0;r<n.length;r++)i+=n[r],this.distribution[r]=i;return this}setRandomGenerator(e){return this.randomFunction=e,this}sample(e,t,n){let i=this.distribution[this.distribution.length-1],r=this.binarySearch(this.randomFunction()*i);return this.sampleFace(r,e,t,n)}binarySearch(e){let t=this.distribution,n=0,i=t.length-1,r=-1;for(;n<=i;){let s=Math.ceil((n+i)/2);if(0===s||t[s-1]<=e&&t[s]>e){r=s;break}e<t[s]?i=s-1:n=s+1}return r}sampleFace(e,t,n,i){let r=this.randomFunction(),s=this.randomFunction();return r+s>1&&(r=1-r,s=1-s),mZ.a.fromBufferAttribute(this.positionAttribute,3*e),mZ.b.fromBufferAttribute(this.positionAttribute,3*e+1),mZ.c.fromBufferAttribute(this.positionAttribute,3*e+2),t.set(0,0,0).addScaledVector(mZ.a,r).addScaledVector(mZ.b,s).addScaledVector(mZ.c,1-(r+s)),void 0!==n&&mZ.getNormal(n),void 0!==i&&void 0!==this.colorAttribute&&(mZ.a.fromBufferAttribute(this.colorAttribute,3*e),mZ.b.fromBufferAttribute(this.colorAttribute,3*e+1),mZ.c.fromBufferAttribute(this.colorAttribute,3*e+2),gZ.set(0,0,0).addScaledVector(mZ.a,r).addScaledVector(mZ.b,s).addScaledVector(mZ.c,1-(r+s)),i.r=gZ.x,i.g=gZ.y,i.b=gZ.z),this}};function yZ(e,t){let n=e,i=new Float32Array(4*t*t);for(let s=0;s<t*t;s++)i[4*s]=n[3*s],i[4*s+1]=n[3*s+1],i[4*s+2]=n[3*s+2],i[4*s+3]=0;let r=new FD(i,t,t,bg,vg);return r.needsUpdate=!0,r}var xZ="\n// uniform sampler2D uCurrentPosition; // Pass in the variable from GPGPU\n// uniform sampler2D uCurrentVelocity; // Pass in the variable from GPGPU\n// uniform sampler2D uCurrentEmissionRate; // Pass in the variable from GPGPU\nuniform sampler2D uOriginalPosition;\nuniform sampler2D uDirections;     \nuniform vec3 uDirectionsAxis;\nuniform vec4 uWorldQuaternion;\nuniform vec3 uGravity;        \nuniform float uNoiseStrength;     // Variation of the noise\nuniform float uNoiseScale;        // Scale of the noise\nuniform float uNoiseSeed;         // Seed of the noise\nuniform float particleSize;\nuniform float uSpeed;     // update speed of the particles\nuniform float uRandomMassFactor;\n\n// COLLIDER\nuniform vec3 uColliderPos;                // Collider Position\nuniform vec3 uColliderSize;               // Collider Dimension\nuniform vec4 uColliderQuaternion;         // Collider Rotation\nuniform vec4 uColliderQuaternionInvert;   // Collider Rotation\nuniform float uBounce;                    // Bounce factor\nuniform float uForceDamping;\nuniform float uForceIntensity;\n\n\n\n\n    vec3 mod289(vec3 x) {\n      return x - floor(x * (1.0 / 289.0)) * 289.0;\n    }\n    \n    vec4 mod289(vec4 x) {\n    return x - floor(x * (1.0 / 289.0)) * 289.0;\n    }\n    \n    vec4 permute(vec4 x) {\n        return mod289(((x*34.0)+1.0)*x);\n    }\n    \n    vec4 taylorInvSqrt(vec4 r)\n    {\n    return 1.79284291400159 - 0.85373472095314 * r;\n    }\n    \n    vec3 fade(vec3 t) {\n  return t*t*t*(t*(t*6.0-15.0)+10.0);\n}\n\n    float snoise(vec3 v)\n    {\n    const vec2  C = vec2(1.0/6.0, 1.0/3.0) ;\n    const vec4  D = vec4(0.0, 0.5, 1.0, 2.0);\n    vec3 i  = floor(v + dot(v, C.yyy) );\n    vec3 x0 =   v - i + dot(i, C.xxx) ;\n    vec3 g = step(x0.yzx, x0.xyz);\n    vec3 l = 1.0 - g;\n    vec3 i1 = min( g.xyz, l.zxy );\n    vec3 i2 = max( g.xyz, l.zxy );\n    vec3 x1 = x0 - i1 + C.xxx;\n    vec3 x2 = x0 - i2 + C.yyy; // 2.0*C.x = 1/3 = C.y\n    vec3 x3 = x0 - D.yyy;      // -1.0+3.0*C.x = -0.5 = -D.y\n    \n    // Permutations\n    i = mod289(i);\n    vec4 p = permute( permute( permute(\n                i.z + vec4(0.0, i1.z, i2.z, 1.0 ))\n              + i.y + vec4(0.0, i1.y, i2.y, 1.0 ))\n              + i.x + vec4(0.0, i1.x, i2.x, 1.0 ));\n    \n    // Gradients: 7x7 points over a square, mapped onto an octahedron.\n    // The ring size 17*17 = 289 is close to a multiple of 49 (49*6 = 294)\n    float n_ = 0.142857142857; // 1.0/7.0\n    vec3  ns = n_ * D.wyz - D.xzx;\n    \n    vec4 j = p - 49.0 * floor(p * ns.z * ns.z);  //  mod(p,7*7)\n    \n    vec4 x_ = floor(j * ns.z);\n    vec4 y_ = floor(j - 7.0 * x_ );    // mod(j,N)\n    \n    vec4 x = x_ *ns.x + ns.yyyy;\n    vec4 y = y_ *ns.x + ns.yyyy;\n    vec4 h = 1.0 - abs(x) - abs(y);\n    \n    vec4 b0 = vec4( x.xy, y.xy );\n    vec4 b1 = vec4( x.zw, y.zw );\n    \n    vec4 s0 = floor(b0)*2.0 + 1.0;\n    vec4 s1 = floor(b1)*2.0 + 1.0;\n    vec4 sh = -step(h, vec4(0.0));\n    \n    vec4 a0 = b0.xzyw + s0.xzyw*sh.xxyy ;\n    vec4 a1 = b1.xzyw + s1.xzyw*sh.zzww ;\n    \n    vec3 p0 = vec3(a0.xy,h.x);\n    vec3 p1 = vec3(a0.zw,h.y);\n    vec3 p2 = vec3(a1.xy,h.z);\n    vec3 p3 = vec3(a1.zw,h.w);\n    \n    //Normalise gradients\n    vec4 norm = taylorInvSqrt(vec4(dot(p0,p0), dot(p1,p1), dot(p2, p2), dot(p3,p3)));\n    p0 *= norm.x;\n    p1 *= norm.y;\n    p2 *= norm.z;\n    p3 *= norm.w;\n    \n    // Mix final noise value\n    vec4 m = max(0.6 - vec4(dot(x0,x0), dot(x1,x1), dot(x2,x2), dot(x3,x3)), 0.0);\n    m = m * m;\n    return 42.0 * dot( m*m, vec4( dot(p0,x0), dot(p1,x1),\n                                  dot(p2,x2), dot(p3,x3) ) );\n    }\n    \n    vec3 snoiseVec3( vec3 x ){\n    \n      float s  = snoise(vec3( x ));\n      float s1 = snoise(vec3( x.y - 19.1 , x.z + 33.4 , x.x + 47.2 ));\n      float s2 = snoise(vec3( x.z + 74.2 , x.x - 124.5 , x.y + 99.4 ));\n      vec3 c = vec3( s , s1 , s2 );\n      return c;\n    \n    }\n    \n      \n    vec3 curlNoise( vec3 p, float seed){\n      p += seed;\n      const float e = .1;\n      vec3 dx = vec3( e   , 0.0 , 0.0 );\n      vec3 dy = vec3( 0.0 , e   , 0.0 );\n      vec3 dz = vec3( 0.0 , 0.0 , e   );\n    \n      vec3 p_x0 = snoiseVec3( p - dx );\n      vec3 p_x1 = snoiseVec3( p + dx );\n      vec3 p_y0 = snoiseVec3( p - dy );\n      vec3 p_y1 = snoiseVec3( p + dy );\n      vec3 p_z0 = snoiseVec3( p - dz );\n      vec3 p_z1 = snoiseVec3( p + dz );\n    \n      float x = p_y1.z - p_y0.z - p_z1.y + p_z0.y;\n      float y = p_z1.x - p_z0.x - p_x1.z + p_x0.z;\n      float z = p_x1.y - p_x0.y - p_y1.x + p_y0.x;\n    \n      const float divisor = 1.0 / ( 2.0 * e );\n      return normalize( vec3( x , y , z ) * divisor );\n    \n    }\n\n\n// Classic Perlin noise\nfloat cnoise(vec3 P)\n{\n  vec3 Pi0 = floor(P); // Integer part for indexing\n  vec3 Pi1 = Pi0 + vec3(1.0); // Integer part + 1\n  Pi0 = mod289(Pi0);\n  Pi1 = mod289(Pi1);\n  vec3 Pf0 = fract(P); // Fractional part for interpolation\n  vec3 Pf1 = Pf0 - vec3(1.0); // Fractional part - 1.0\n  vec4 ix = vec4(Pi0.x, Pi1.x, Pi0.x, Pi1.x);\n  vec4 iy = vec4(Pi0.yy, Pi1.yy);\n  vec4 iz0 = Pi0.zzzz;\n  vec4 iz1 = Pi1.zzzz;\n\n  vec4 ixy = permute(permute(ix) + iy);\n  vec4 ixy0 = permute(ixy + iz0);\n  vec4 ixy1 = permute(ixy + iz1);\n\n  vec4 gx0 = ixy0 * (1.0 / 7.0);\n  vec4 gy0 = fract(floor(gx0) * (1.0 / 7.0)) - 0.5;\n  gx0 = fract(gx0);\n  vec4 gz0 = vec4(0.5) - abs(gx0) - abs(gy0);\n  vec4 sz0 = step(gz0, vec4(0.0));\n  gx0 -= sz0 * (step(0.0, gx0) - 0.5);\n  gy0 -= sz0 * (step(0.0, gy0) - 0.5);\n\n  vec4 gx1 = ixy1 * (1.0 / 7.0);\n  vec4 gy1 = fract(floor(gx1) * (1.0 / 7.0)) - 0.5;\n  gx1 = fract(gx1);\n  vec4 gz1 = vec4(0.5) - abs(gx1) - abs(gy1);\n  vec4 sz1 = step(gz1, vec4(0.0));\n  gx1 -= sz1 * (step(0.0, gx1) - 0.5);\n  gy1 -= sz1 * (step(0.0, gy1) - 0.5);\n\n  vec3 g000 = vec3(gx0.x,gy0.x,gz0.x);\n  vec3 g100 = vec3(gx0.y,gy0.y,gz0.y);\n  vec3 g010 = vec3(gx0.z,gy0.z,gz0.z);\n  vec3 g110 = vec3(gx0.w,gy0.w,gz0.w);\n  vec3 g001 = vec3(gx1.x,gy1.x,gz1.x);\n  vec3 g101 = vec3(gx1.y,gy1.y,gz1.y);\n  vec3 g011 = vec3(gx1.z,gy1.z,gz1.z);\n  vec3 g111 = vec3(gx1.w,gy1.w,gz1.w);\n\n  vec4 norm0 = taylorInvSqrt(vec4(dot(g000, g000), dot(g010, g010), dot(g100, g100), dot(g110, g110)));\n  g000 *= norm0.x;\n  g010 *= norm0.y;\n  g100 *= norm0.z;\n  g110 *= norm0.w;\n  vec4 norm1 = taylorInvSqrt(vec4(dot(g001, g001), dot(g011, g011), dot(g101, g101), dot(g111, g111)));\n  g001 *= norm1.x;\n  g011 *= norm1.y;\n  g101 *= norm1.z;\n  g111 *= norm1.w;\n\n  float n000 = dot(g000, Pf0);\n  float n100 = dot(g100, vec3(Pf1.x, Pf0.yz));\n  float n010 = dot(g010, vec3(Pf0.x, Pf1.y, Pf0.z));\n  float n110 = dot(g110, vec3(Pf1.xy, Pf0.z));\n  float n001 = dot(g001, vec3(Pf0.xy, Pf1.z));\n  float n101 = dot(g101, vec3(Pf1.x, Pf0.y, Pf1.z));\n  float n011 = dot(g011, vec3(Pf0.x, Pf1.yz));\n  float n111 = dot(g111, Pf1);\n\n  vec3 fade_xyz = fade(Pf0);\n  vec4 n_z = mix(vec4(n000, n100, n010, n110), vec4(n001, n101, n011, n111), fade_xyz.z);\n  vec2 n_yz = mix(n_z.xy, n_z.zw, fade_xyz.y);\n  float n_xyz = mix(n_yz.x, n_yz.y, fade_xyz.x); \n  return 2.2 * n_xyz;\n}\n\n\nvec3 fbm_vec3(vec3 p, float frequency, float offset)\n{\n  return vec3(\n    cnoise((p+vec3(offset))*frequency),\n    cnoise((p+vec3(offset+20.0))*frequency),\n    cnoise((p+vec3(offset-30.0))*frequency)\n  );\n}\n\n"+"\nfloat rand(vec2 co){\n    return fract(sin(dot(co, vec2(12.9898, 78.233))) * 43758.5453);\n}\nvec3 applyQuaternionToVector( vec4 q, vec3 v ){\n    return v + 2.0 * cross( q.xyz, cross( q.xyz, v ) + q.w * v );\n } \nvec3 applyForce(vec3 force, float mass) {\n  vec3 acceleration = force / mass;\n  \n  return acceleration;\n}\n\nvec4 conjugate(vec4 q) {\n  return vec4(q.w, -q.x, -q.y, -q.z);\n}\n\n// Function to compute the normal of the ellipsoid at a given point\nvec3 ellipsoidNormal(vec3 p, vec3 radii) {\n  return normalize(p / (radii * radii));\n}\n\nfloat friction = .3;\n\nvoid main() {\n    vec2 vUv = gl_FragCoord.xy / resolution.xy;\n    vec3 position = texture2D( uCurrentPosition, vUv ).xyz;\n    vec3 originalPosition = texture2D( uOriginalPosition, vUv ).xyz;\n    float timeLeft = texture2D( uCurrentPosition, vUv ).w;\n    vec3 directions = texture2D( uDirections, vUv ).xyz;    \n    vec3 velocity = texture2D( uCurrentVelocity, vUv ).xyz;\n    float mass = rand(originalPosition.xy) * 0.5 + 0.5;\n    float isSpawning = texture2D( uCurrentEmissionRate, vUv ).x;        // 1. = spawning, 0. = not spawning\n    float isActive = texture2D( uCurrentEmissionRate, vUv ).y;          // 1. = active, 0. = not active\n    float collisionFlag =texture2D( uCurrentVelocity, vUv ).w;          // Indicate collision\n\n    // Randomness Mass\n    mass = (1.0 - (uRandomMassFactor * mass));\n    \n    if (isActive == 1.0) {\n      // **************************************************************\n      // FORCES NOISES\n      // **************************************************************\n      #ifdef USE_CURL_NOISE\n        if (uNoiseScale > 0.0 ) {\n          velocity = curlNoise(position * uNoiseScale * .002, uNoiseSeed) * ( uNoiseStrength + 1.0) * .05 * uSpeed;\n        }\n        // Variation of the noise Over Time\n        if (uNoiseStrength > 0.0 && uNoiseScale == 0.0 ) {\n          velocity += curlNoise( position, uNoiseSeed)  * uNoiseStrength * 0.05 * uSpeed;\n        }\n      #endif\n      // **************************************************************\n      #ifdef USE_SIMPLEX_NOISE\n        if (uNoiseScale > 0.0 ) {\n          velocity = vec3(snoise(position * uNoiseScale * .001) * ( uNoiseStrength + 1.0) * .1);\n          velocity *= uSpeed;\n        }\n        // Variation of the noise Over Time\n        if (uNoiseStrength > 0.0 && uNoiseScale == 0.0) {\n          velocity += vec3(snoise(position * uNoiseStrength * .001) * .05 * uSpeed);\n        }\n      #endif\n      // ************************************************************** \n      #ifdef USE_FBM_NOISE\n        if (uNoiseScale > 0.0 ) {\n          velocity = fbm_vec3(position * uNoiseScale * .001, ( uNoiseStrength + 1.0), uNoiseSeed);\n          velocity *= uSpeed;\n        }\n        // Variation of the noise Over Time\n        if (uNoiseStrength > 0.0 && uNoiseScale == 0.0 ) {      \n          velocity += fbm_vec3(position * uNoiseStrength * .001, ( uNoiseStrength + 1.0), uNoiseSeed) * .1 * uSpeed;\n        }\n      #endif\n\n      // COLLIDER\n      ".concat("\n  #ifdef USE_COLLIDER\n    float restitution = max(uBounce * 2., .01); // Energy Loss\n    // SPHERE COLLIDER\n    // **************************************************************\n    #ifdef USE_SPHERE_COLLIDER       \n      // Convert collider size to radii (assuming uColliderSize is the diameter in each axis)\n      vec3 radii = uColliderSize;\n      // Adjust position relative to collider\n      vec3 relPos = position - uColliderPos;\n      // Apply rotation of the collider to the relative position\n      relPos = applyQuaternionToVector(uColliderQuaternionInvert, relPos);            \n      // Scale relative position by radii (for ellipsoid collision detection)\n      vec3 scaledPos = relPos / radii;\n      // Calculate ellipsoidal distance\n      float dist = length(scaledPos); // Distance in terms of ellipsoid\n      \n      // Check for collision\n      if (dist <= 1. + particleSize / length(radii) && collisionFlag == 0.0) {\n          // Compute the normal at the collision point, accounting for particle size\n        vec3 adjustedPos = scaledPos * (1.0 + particleSize / length(radii));          \n        // Compute the normal at the collision point\n        vec3 normal = ellipsoidNormal(adjustedPos, radii);\n        // Rotate the normal back to world space\n        normal = applyQuaternionToVector(uColliderQuaternion, normal);\n        // Reflect the velocity vector off the normal\n        velocity = reflect(velocity, normal) * restitution;\n\n        collisionFlag = 1.0;\n      } else {\n        collisionFlag = 0.0;\n      }\n    #endif\n\n    // BOX COLLIDER or PLANE COLLIDER \n    // **************************************************************\n    #ifdef USE_BOX_COLLIDER\n      // Box dimensions and repulsion variables\n      vec3 boxHalfSize = uColliderSize / 2.0;\n      // Convert world position to box's local space\n      vec3 localPos = applyQuaternionToVector(uColliderQuaternionInvert, position - uColliderPos);      \n      // Collision detection\n      vec3 localDistance = abs(localPos) - boxHalfSize;\n      float distToSurface = max(localDistance.x, max(localDistance.y, localDistance.z));    \n\n      // Collision Detected\n      if (distToSurface <= particleSize * 0.5 && collisionFlag == 0.0) {      \n        // Find the nearest face normal for bounce direction\n        vec3 normal;\n        if (localDistance.x > localDistance.y && localDistance.x > localDistance.z) {\n            normal = vec3(sign(localPos.x), 0.0, 0.0);\n        } else if (localDistance.y > localDistance.z) {\n            normal = vec3(0.0, sign(localPos.y), 0.0);\n        } else {\n            normal = vec3(0.0, 0.0, sign(localPos.z));\n        }            \n        // Rotate normal back to world space\n        normal = applyQuaternionToVector(uColliderQuaternion, normal);      \n        // Reflect velocity and apply repulsion force\n        velocity = reflect(velocity, normal) * restitution;\n        \n        collisionFlag = 1.0;\n      } else {\n        collisionFlag = 0.0;\n      }\n    #endif      \n  #endif      \n  // END COLLIDER    \n","\n      // ATTRACTION\n      ").concat("\n  #ifdef USE_ATTRACTOR\n\n      #ifdef USE_SPHERE_COLLIDER      \n        // Convert collider size to radii (assuming uColliderSize is the diameter in each axis)\n        vec3 radii = uColliderSize;\n        // Adjust position relative to collider\n        vec3 relPos = position - uColliderPos;\n        // Apply rotation of the collider to the relative position\n        relPos = applyQuaternionToVector(uColliderQuaternionInvert, relPos);            \n        // Scale relative position by radii (for ellipsoid collision detection)\n        vec3 scaledPos = relPos / radii;\n        // Calculate ellipsoidal distance\n        float distToSurface = length(scaledPos); // Distance in terms of ellipsoid\n        float insideCheck = 1.0;\n\n      #endif\n\n\n      #ifdef USE_BOX_COLLIDER\n        // Box dimensions\n        vec3 boxHalfSize = uColliderSize / 2.0;\n        // Convert world position to box's local space\n        vec3 localPos = applyQuaternionToVector(uColliderQuaternionInvert, position - uColliderPos);      \n        vec3 localDistance = abs(localPos) - boxHalfSize;\n        float distToSurface = max(localDistance.x, max(localDistance.y, localDistance.z));\n        float insideCheck = particleSize;\n      #endif      \n  \n      // Apply vortex force inside the Helper\n      #ifdef USE_FORCE_LOCAL_SPACE\n        if (distToSurface <= insideCheck ) {    \n            // Define parameters for the attractor field\n            #ifdef USE_SPHERE_COLLIDER      \n              float attractorStrength = (1.0 - distToSurface ) * uForceIntensity; // Adjust as needed\n            #endif\n\n            #ifdef USE_BOX_COLLIDER\n              float attractorStrength = max((1.0 - insideCheck / distToSurface), 0.) * uForceIntensity; // Adjust as needed\n              #endif\n\n            float attractorDamping = uForceDamping;  // Adjust as needed (higher values will attenuate velocity more)\n          \n            // Use the same radii calculation code as for the collider\n            vec3 attractorRadii = uColliderSize;\n            // Adjust position relative to attractor center\n            vec3 relPos = position - uColliderPos;\n            // Apply rotation of the collider to the relative position\n            relPos = applyQuaternionToVector(uColliderQuaternionInvert, relPos);            \n            // Scale relative position by radii (for ellipsoid attraction)\n            vec3 scaledPos = relPos / attractorRadii;\n\n            // Calculate ellipsoidal distance as attractor radius\n            float attractorRadius = length(scaledPos);\n            // Calculate the distance from the attractor center\n            vec3 relativePosition = position - uColliderPos;\n            // Calculate the force vector towards the attractor center\n            vec3 attractorForce = normalize(relativePosition) * attractorStrength;\n            // Apply the attractor force to the particle\n            velocity -= attractorForce;\n            // Attenuate the particle's velocity\n            velocity *= attractorDamping;\n        }\n      #else \n            // Calculate the distance from the attractor center\n            vec3 relativePosition = position - uColliderPos;\n            // Calculate the force vector towards the attractor center\n            vec3 attractorForce = normalize(relativePosition) * uForceIntensity;\n            // Apply the attractor force to the particle\n            velocity -= attractorForce;\n            // Attenuate the particle's velocity\n            velocity *= uForceDamping;\n      #endif    \n  #endif      \n","  \n      // VORTEX\n      ").concat("\n  #ifdef USE_VORTEX\n    // Box dimensions\n    vec3 boxHalfSize = uColliderSize / 2.0;\n    // Convert world position to box's local space\n    vec3 localPos = applyQuaternionToVector(uColliderQuaternionInvert, position - uColliderPos);      \n    vec3 localDistance = abs(localPos) - boxHalfSize;\n    float distToSurface = max(localDistance.x, max(localDistance.y, localDistance.z));\n\n    // Apply vortex force inside the box\n    if (distToSurface <= particleSize) {\n      float vortexStrength = uForceIntensity;\n      vec3 localTopCenter = vec3(0.0, 0., 0.0);\n\n      // Transform the local top center to the world space\n      vec3 vortexCenter = uColliderPos + applyQuaternionToVector(uColliderQuaternion, localTopCenter);\n      // Calculate the vector from particle to vortex center\n      vec3 vortexVector = vortexCenter - position;\n\n      // Calculate the rotation axis from the inverse of the collider's quaternion and the fixed up vector\n      // Note: important to add a tiny z component to the up vector to avoid instability\n      vec3 upVector = vec3(0.0, 1.0, 0.01);\n      vec3 rotationAxis = cross(upVector, applyQuaternionToVector(uColliderQuaternion, vortexVector));\n      rotationAxis = normalize(rotationAxis);\n\n      // Add rotational component to velocity\n      float rotationSpeed = length(vortexVector * vortexStrength * 3.0) ; \n\n      vec3 rotationVelocity = rotationAxis * rotationSpeed;\n      // velocity += rotationVelocity * 0.005 ;\n      velocity = rotationVelocity * 0.005 ;\n\n      // Calculate vortex force\n      // vec3 vortexForce = normalize(vortexVector) * uSpeed * .1 ;\n      // Apply the vortex force to the particle\n      vec3 originDirection = applyQuaternionToVector(uWorldQuaternion, directions);\n      velocity += applyForce( originDirection * uSpeed * (1. - uForceDamping) , mass * .5);\n    }\n  #endif      \n","\n    } \n    // End isActive\n\n    // SPAWN BIRTH \n    // **************************************************************\n    // if (isSpawning == 1.)\n    #ifdef USE_NORMALS\n      velocity = mix(velocity, applyQuaternionToVector(uWorldQuaternion, directions) * uSpeed, isSpawning);\n    #else\n      velocity = mix(velocity, applyQuaternionToVector(uWorldQuaternion, uDirectionsAxis) * uSpeed, isSpawning);    \n    #endif\n    \n    // if (collisionFlag == 0.0)\n    velocity += applyForce(uGravity, mass * .5) * (1.0 - collisionFlag);\n\n    gl_FragColor = vec4(velocity, collisionFlag);\n}\n"),bZ="\n\n  // Linear Fade In\n  float linearFadeIn(float t) {\n    return t;\n  }\n\n\n  // linear fade out\n  float linearFadeOut(float t) {\n    return 1.0 - t;\n  }\n  \n  float linearInOut(float t) {\n    return t < 0.5 ? t :  (1.0 - t);  \n  }\n\n    // lerp\n    float lerp(float a, float b, float t) {\n      return a + (b - a) * t;\n    }\n\n  // Ease In Out Quart\n  float exponentialInOut(float t) {\n    return t < 0.4 ? lerp(0.0, 1.0, t / 0.4) :\n    t > 0.6 ? lerp(1.0, 0.0, (t - 0.6) / 0.4) :\n    1.0;\n   }\n\n  // constant\n  float constant(float t) {\n    return 1.0;\n  } \n",wZ="\n  uniform sampler2D uPosition;\n  uniform float uSize;\n  uniform float uSizeEnd;\n  uniform vec3 uWorldOffset;\n  uniform vec4 uWorldQuaternion;\n  // Billboard Behavior - Currently at Zero, but we can change that\n  uniform float uRotation;\n  uniform float uRotationEnd;\n  uniform vec2 center;\n\n  // Randomness\n  uniform float uRandScaleFactor;\n  uniform float uRandRotationFactor;\n\n  attribute vec2 ref;\n\n  varying float v_LifeLeft;    // normalized lifetime 1 to 0\n  varying vec2 vUv;\n  varying vec2 vRef;\n\n  ".concat("\n\nfloat rand(vec3 co){\n  return fract(sin(dot(co.xy ,vec2(12.9898,78.233))) * 43758.5453);\n}\n\nvec3 applyQuaternionToVector( vec4 q, vec3 v ){\n  return v + 2.0 * cross( q.xyz, cross( q.xyz, v ) + q.w * v );\n}\n\nvec3 applyForce(vec3 force, float mass) {\n  vec3 acceleration = force / mass;\n    \n  return acceleration;\n}\n","\n  ").concat(bZ,"\n"),DZ="\n  uniform vec4 uColor;                // start color\n  uniform vec4 uColor2;               // end color\n  uniform sampler2D uTexture;         // texture\n  varying float v_LifeLeft;   // normalized lifetime 1 to 0\n  varying vec2 vUv;\n  varying vec2 vRef;\n\n  float random(vec2 co) {\n    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);\n  }\n  "+bZ+"  \n  ".concat("\nvec3 rgb2xyz (in vec3 rgb) {\n    float r = rgb.r;\n\tfloat g = rgb.g;\n\tfloat b = rgb.b;\n\n\tr = r > 0.04045 ? pow(((r + 0.055) / 1.055), 2.4) : (r / 12.92);\n\tg = g > 0.04045 ? pow(((g + 0.055) / 1.055), 2.4) : (g / 12.92);\n\tb = b > 0.04045 ? pow(((b + 0.055) / 1.055), 2.4) : (b / 12.92);\n\n\tfloat x = (r * 0.4124) + (g * 0.3576) + (b * 0.1805);\n\tfloat y = (r * 0.2126) + (g * 0.7152) + (b * 0.0722);\n\tfloat z = (r * 0.0193) + (g * 0.1192) + (b * 0.9505);\n    \n    vec3 xyz = vec3(\n        (r * 0.4124) + (g * 0.3576) + (b * 0.1805) * 100.0,\n        (r * 0.2126) + (g * 0.7152) + (b * 0.0722) * 100.0,\n        (r * 0.0193) + (g * 0.1192) + (b * 0.9505) * 100.0\n    );\n    return(xyz);\n}\n\nvec3 xyz2lab (in vec3 xyz) {\n\tfloat x = xyz.x / 95.047;\n\tfloat y = xyz.y / 100.0;\n\tfloat z = xyz.z / 108.883;\n\n\tx = x > 0.008856 ? pow(x, 1.0 / 3.0) : (7.787 * x) + (16.0 / 116.0);\n\ty = y > 0.008856 ? pow(y, 1.0 / 3.0) : (7.787 * y) + (16.0 / 116.0);\n\tz = z > 0.008856 ? pow(z, 1.0 / 3.0) : (7.787 * z) + (16.0 / 116.0);\n\n    vec3 lab = vec3((116.0 * y) - 16.0, 500.0 * (x - y), 200.0 * (y - z));\n    return(lab);\n}\n\nvec3 rgb2lab(in vec3 rgb) {\n    vec3 xyz = rgb2xyz(rgb);\n    vec3 lab = xyz2lab(xyz);\n    return(lab);\n}\n\nvec3 xyz2rgb (in vec3 xyz) {\n\tfloat x = xyz.x / 100.0;\n\tfloat y = xyz.y / 100.0;\n\tfloat z = xyz.z / 100.0;\n\t\n    \n\tfloat r = (x *  3.2406) + (y * -1.5372) + (z * -0.4986);\n\tfloat g = (x * -0.9689) + (y *  1.8758) + (z *  0.0415);\n\tfloat b = (x *  0.0557) + (y * -0.2040) + (z *  1.0570);\n\n\tr = r > 0.0031308 ? ((1.055 * pow(r, 1.0 / 2.4)) - 0.055) : r * 12.92;\n\tg = g > 0.0031308 ? ((1.055 * pow(g, 1.0 / 2.4)) - 0.055) : g * 12.92;\n\tb = b > 0.0031308 ? ((1.055 * pow(b, 1.0 / 2.4)) - 0.055) : b * 12.92;\n\n\tr = min(max(0.0, r), 1.0);\n\tg = min(max(0.0, g), 1.0);\n\tb = min(max(0.0, b), 1.0);\n\n\treturn(vec3(r, g, b));\n}\n\nvec3 lab2xyz (in vec3 lab) {\n    float l = lab.x;\n\tfloat a = lab.y;\n\tfloat b = lab.z;\n\n  \tfloat y = (l + 16.0) / 116.0;\n\tfloat x = a / 500.0 + y;\n\tfloat z = y - b / 200.0;\n\n\tfloat y2 = pow(y, 3.0);\n\tfloat x2 = pow(x, 3.0);\n\tfloat z2 = pow(z, 3.0);\n\n  \ty = y2 > 0.008856 ? y2 : (y - 16.0 / 116.0) / 7.787;\n\tx = x2 > 0.008856 ? x2 : (x - 16.0 / 116.0) / 7.787;\n\tz = z2 > 0.008856 ? z2 : (z - 16.0 / 116.0) / 7.787;\n\n\tx *= 95.047;\n\ty *= 100.0;\n\tz *= 108.883;\n\n\treturn(vec3(x, y, z));\n}\nvec3 lab2rgb (in vec3 lab) {\n    vec3 xyz = lab2xyz(lab);\n    vec3 rgb = xyz2rgb(xyz);\n    return(rgb);\n}\n\n","\n\n"),_Z=class extends Ix{constructor(e,t){super(),this.needsJitter=!0,this.type="ParticleMaterial",this.easeOpacity="linearFadeIn",this.easeSize="linearFadeIn",this.useSizeEnd=!1,this.isColoringRandom=!1,this.init(e,t),this.context=t}reset(){}init(e,t){this.transparent=!0,this.depthTest=!0,this.depthWrite=!1,this.easeOpacity=e.ease,this.easeSize=e.easeSize,this.layers=[],IV.startContext(IV.globalContext),this.lightLayer=new lG(0,"",d(d({},vB.defaultData("light","phong")),{},{visible:!1}),new fW,{},t.shared),IV.endContext(IV.globalContext),this.build()}updateState(e){void 0!==e.coloring&&(this.isColoringRandom="random"===e.coloring),void 0!==e.color&&(e.color instanceof Array?this.uniforms.uColor.value=e.color:this.uniforms.uColor.value=this.context.shared.color(e.color)),void 0!==e.color2&&(e.color2 instanceof Array?this.uniforms.uColor2.value=e.color2:this.uniforms.uColor2.value=this.context.shared.color(e.color2)),void 0!==e.size&&(this.uniforms.uSize.value=e.size[0],this.uniforms.uSizeEnd.value=e.size[1],e.size[0]!==e.size[1]?this.useSizeEnd=!0:this.useSizeEnd=!1),void 0!==e.ease&&(this.easeOpacity=e.ease,this.build()),void 0!==e.easeSize&&(this.easeSize=e.easeSize,this.build()),this.needsUpdate=!0}onBeforeCompile(e){this.build(),e.defines=this.defines,e.uniforms=this.uniforms,e.vertexShader=this.vertexShader,e.fragmentShader=this.fragmentShader}build(){let e=new DH;return e.needsJitter=this.needsJitter,e.addFragmentParsCode("\nlayout(location = 1) out vec4 gVelocity;\n"),e.buildShader("vertex",this.fragment),e.buildShader("fragment",this.fragment),e.addFragmentFinalCode("\n    // Discard fully transparent pixels \n    if (gl_FragColor.a <= 0.0) discard;\n\n    gVelocity = vec4(0.0, 0.0, 0.0, 1.0);\n"),this.isColoringRandom&&e.define("USE_RANDOM_COLORING"),this.useSizeEnd&&e.define("USE_SIZE_END"),e.addVertexParsCode(wZ),e.addFragmentParsCode(DZ),e.addVertexFinalCode((e=>{let{easeSize:t="linearFadeOut"}=e;return"\n  vUv = uv;  \n  vRef = ref;\n  // Normalized LifeTime 1 to 0\n  float lifeLeft = texture2D(uPosition, ref).w;\n  v_LifeLeft = lifeLeft;\n  // Position From DataTexture Simulation\n  vec3 pos = texture2D(uPosition, ref).rgb - uWorldOffset;\n  // Apply World Quaternion\n  pos = applyQuaternionToVector(uWorldQuaternion, pos);  \n            \n  #ifdef  USE_SIZE_END\n    // Scaled Over Time\n    float t = 1. - lifeLeft;\n    float currentSize = mix(uSize, uSizeEnd, t); // Linearly interpolate between uSize and uSizeEnd\n    vec3 scaledPosition = position * vec3(currentSize);\n  #else\n    // Change Size Behavior over LifeTime\n    float easeSize = ".concat(t,"(1. - lifeLeft);\n    // Scaled Over Time\n    vec3 scaledPosition = position * vec3(uSize * easeSize);\n  #endif\n\n  // Billboard Behavior\n  vec2 scale;\n  scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n  scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );    \n  // Randomness \n  float randRef = rand(ref);\n  scale *= (1.0 - (uRandScaleFactor * randRef));\n  // Rotation\n  float randRotation =  2.0 * PI * ( uRandRotationFactor * randRef);\n  float originalRotation = (1.0 - uRotation) * 2.0 * PI;\n  float originalRotationEnd = (1.0 - uRotationEnd) * 2.0 * PI;\n  // OverTime\n  float finalRotation = mix(originalRotation + randRotation, originalRotationEnd + randRotation, lifeLeft);\n\n  vec2 alignedPosition = ( scaledPosition.xy - ( center - vec2( 0.5 ) ) ) * scale;\n  vec2 rotatedPosition;\n  rotatedPosition.x = cos( finalRotation ) * alignedPosition.x - sin( finalRotation ) * alignedPosition.y;\n  rotatedPosition.y = sin( finalRotation ) * alignedPosition.x + cos( finalRotation ) * alignedPosition.y;\n  \n  mat4 instanceMatrix = mat4(\n    vec4(1.0, 0.0, 0.0, 0.0),\n    vec4(0.0, 1.0, 0.0, 0.0),\n    vec4(0.0, 0.0, 1.0, 0.0),\n    vec4(pos.x, pos.y, pos.z, 1.0)\n  );  \n\n  mvPosition = modelViewMatrix * instanceMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n  mvPosition.xy += rotatedPosition;\n  gl_Position = projectionMatrix  * mvPosition;   \n")})({easeSize:this.easeSize})),e.addFragmentFinalCode((e=>{let{easeOpacity:t="linearFadeOut"}=e;return"  \n  // if Particle is dead, hide it\n  if (v_LifeLeft <= 0.005 ) {\n    discard;\n  }\n\n  #ifdef USE_RANDOM_COLORING\n    float randVal = random(vRef); // Generate a random value based on the reference\n    vec4 color = mix(uColor, uColor2, randVal); // Interpolate between the two colors\n  #else\n    vec4 color = mix(uColor, uColor2, 1. - v_LifeLeft);\n  #endif\n\n  // Opacity over Life Time\n  float finalAlpha = ".concat(t,"(1. - v_LifeLeft);  \n  vec4 textureColor = texture2D(uTexture, vUv).rgba; \n  finalColor = textureColor.rgb * color.rgb;\n  finalAlpha = color.a * textureColor.a * finalAlpha;\n  \n  gl_FragColor = vec4(finalColor, finalAlpha);     \n\n")})({easeOpacity:this.easeOpacity})),this.vertexShader=e.getCode("vertex"),this.fragmentShader=e.getCode("fragment"),this.defines=e.defines,this.uniforms=d(d({},e.uniforms),this.uniforms),this.extensions=e.extensions,this}get nodeMaterial(){return this}get fragment(){return this.lightLayer.node}getDefines(){return this.defines}nodeMaterialDispose(){this.layers.forEach((e=>e.dispose())),super.dispose()}},SZ=class{constructor(e,t,n,i){var r;this.type="SphereEmitterShape",this.targetMesh=void 0,this.size=e,this.type=n,this.textureSize=function(e){let t=Math.ceil(Math.sqrt(e));return Math.max(t,1)}(t);this.targetMesh="Mesh"===(null===i||void 0===i?void 0:i.type)&&i?i:this.getMesh(n,1);let{positions:s,dataTexture:a,dataTextureNormals:o}=this.createPositions(this.textureSize,null!==(r=this.targetMesh)&&void 0!==r?r:this.getMesh(n,1));this.positionsTexture=a,this.positionsAttribute=s,this.directionsTexture=o}createPositions(e,t){let{positions:n,normals:i}=function(e,t){let n=new Cx(e.geometry,e.material),i=[],r=[],s=new Lv,a=new Lv;null!==n.geometry.index&&(n.geometry=n.geometry.toNonIndexed());let o=new vZ(n).build();for(let l=0;l<t;l++)o.sample(s,a),i.push(s.x,s.y,s.z),r.push(a.x,a.y,a.z);return{positions:new Float32Array(i),normals:new Float32Array(r)}}(t,e*e);return{dataTexture:yZ(n,e),positions:n,dataTextureNormals:yZ(i,e)}}getMesh(e,t){let n=null;switch(e){case"SphereEmitterShape":n=new eS(.5*t,32,32);break;case"TorusEmitterShape":n=new tS(.5*t,.3,15,40);break;case"ConeEmitterShape":n=new w_(t,t,15);break;case"BoxEmitterShape":n=new Mx(t,t,t);break;case"PlaneEmitterShape":n=new Qx(t,t),n.rotateX(-Math.PI/2);break;default:n=new eS(t,32,32)}return new Cx(n,new Jy({color:16711680}))}applyToShader(e,t){this.size=(new Lv).fromArray(t.size),e.uEmitterSize.value=this.size}dispose(){this.positionsTexture.dispose(),this.directionsTexture.dispose(),this.positionsAttribute=new Float32Array}};function EZ(e){let t=d({},e),n=nB.defaultData;t.forceFieldObjectId&&(t.colliderEntityId=t.forceFieldObjectId);let i=d(d({},n.shape),t.shape),r=d(d({},n.renderMaterial),t.renderMaterial);return d(d(d({},n),t),{},{shape:i,renderMaterial:r})}var CZ=class extends zy{constructor(e,t){var n,i,r,s;super(),this.type="ParticleEmitter",this.debugMode=!1,this.worldSpace=!0,this.rootObject=null,this.gpuCompute=null,this.positionSimRT=null,this.velocitySimRT=null,this.emissionRateSimRT=null,this.emitterShape=void 0,this.isEmitting=!1,this.hasBeenReset=!1,this.emittedParticlesAmount=0,this.lastEmitTime=0,this.globalTime=0,this.targetFPS=60,this.previousRatio=1,this.lerpFactor=.4,this.particlesAmount=0,this.noiseStrength=0,this.noiseScale=0,this.isBillboardBased=!0,this.simFeaturesDefinition={USE_COLLIDER:!1,USE_ATTRACTOR:!1,USE_VORTEX:!1,USE_SPHERE_COLLIDER:!1,USE_BOX_COLLIDER:!1,USE_FORCE_LOCAL_SPACE:!1,USE_NORMALS:!1,USE_CURL_NOISE:!0,USE_SIMPLEX_NOISE:!1,USE_FBM_NOISE:!1},this.textureLoader=new OS,this.currentWorldPosition=new Lv,this.systemQuaternion=new Rv,this.worldGravity=new Lv(0,0,0),this.directionAxis=new Lv(0,0,0),this.colliderV3=new Lv(0,0,0),this.colliderQuaternion=new Rv(0,0,0,1),this.matrixAutoUpdate=!0,this.renderer=e,this.system=t,this.shared=t.context.shared;let a=t.data;this.material=new _Z(a.renderMaterial,t.context),this.material.uniforms={uSize:{value:0},uSizeEnd:{value:0},uColor:{value:a.renderMaterial.color},uColor2:{value:a.renderMaterial.color2},uPosition:{value:new Lv(0,0,0)},uEmissionData:{value:new Lv(0,0,0)},uTexture:{value:this.defaultTexture},uWorldOffset:{value:new Lv(0,0,0)},uWorldQuaternion:{value:new Ov(0,0,0,1)},uRandScaleFactor:{value:null!==(n=a.randomScale)&&void 0!==n?n:0},uRandRotationFactor:{value:null!==(i=a.randomRotation)&&void 0!==i?i:0},uRotation:{value:null!==(r=a.renderMaterial.spriteRotation[0])&&void 0!==r?r:0},uRotationEnd:{value:null!==(s=a.renderMaterial.spriteRotation[1])&&void 0!==s?s:0}},this.setTexture(this.material.uniforms,a.renderMaterial.texture),this.init(a)}setTexture(e,t){let n=t.data;if("string"==typeof t){let n=this.shared.image(t),i=new Fv(n.img);return i.needsUpdate=!0,void(e.uTexture.value=i)}if("string"!=typeof n){let t=new Image;t.onload=()=>{let n=new Fv(t);n.needsUpdate=!0,e.uTexture.value=n};let i=new Blob([n],{type:"image/*"}),r=URL.createObjectURL(i);t.src=r}}updateGeometryAttributes(e,t){var n;let i=function(e){let t=new Float32Array(e*e*2);for(let n=0;n<e;n++)for(let i=0;i<e;i++){let r=n*e+i;t[2*r+0]=n/(e-1),t[2*r+1]=i/(e-1)}return t}(t);null===(n=this.emitterShape)||void 0===n||!n.positionsAttribute||e.geometry.setAttribute("ref",new BD(i,2))}applyWorldSpace(){if(!this.system.started||!this.worldSpace||!this.positionSimRT||!this.velocitySimRT)return;let e=this.system;e.getWorldQuaternion(this.systemQuaternion),this.systemQuaternion.invert(),e.getWorldPosition(this.currentWorldPosition),this.material.uniforms.uWorldOffset.value=this.currentWorldPosition,this.material.uniforms.uWorldQuaternion.value.copy(this.systemQuaternion.normalize()),this.positionSimRT.material.uniforms.uWorldOffset.value=this.currentWorldPosition,this.systemQuaternion.invert(),this.positionSimRT.material.uniforms.uWorldQuaternion.value.copy(this.systemQuaternion.normalize()),this.velocitySimRT.material.uniforms.uWorldQuaternion.value.copy(this.systemQuaternion.normalize())}update(e,t){var n;if(!this.gpuCompute||!this.positionSimRT||!this.velocitySimRT||!this.emissionRateSimRT||this.hasBeenReset)return;if(this.checkIfAllParticlesAreDead()&&!this.hasBeenReset)return void this.reset();this.applyWorldSpace(),this.globalTime=e,this.positionSimRT.material.uniforms.uTime.value=e,this.emissionRateSimRT.material.uniforms.uTime.value=e;let i=1e3/t,r=this.targetFPS/i,s=this.previousRatio+(r-this.previousRatio)*this.lerpFactor;this.positionSimRT.material.uniforms.uFPSRatio.value=s,this.previousRatio=s;let a=this.isEmitting?this.GoEmitSomeParticles(e,this.system.data.birthRatePerSec):0;this.emissionRateSimRT.material.uniforms.uLastIndexEmitted.value=this.emittedParticlesAmount,this.emissionRateSimRT.material.uniforms.uParticlesToEmit.value=a,this.material.uniforms.uPosition.value=null===(n=this.gpuCompute.getCurrentRenderTarget(this.positionSimRT))||void 0===n?void 0:n.texture,this.system.colliderEntities.length>0&&this.renderColliders(),this.gpuCompute.compute()}renderColliders(){if(!this.velocitySimRT)return;let e=this.system.colliderEntities[0],t=this.simFeaturesDefinition.USE_COLLIDER||this.simFeaturesDefinition.USE_ATTRACTOR||this.simFeaturesDefinition.USE_VORTEX;if(e.destroyedInAction&&t&&this.init(EZ(d(d({},this.system.data),{},{colliderEntityId:null}))),!e||e.destroyedInAction)return;e.getWorldPosition(this.colliderV3),0===this.colliderV3.y&&(this.colliderV3.y=1e-4),this.velocitySimRT.material.uniforms.uColliderPos.value.copy(this.colliderV3);let n=e.data.size;this.colliderV3.fromArray(n),this.velocitySimRT.material.uniforms.uColliderSize.value.copy(this.simFeaturesDefinition.USE_SPHERE_COLLIDER?this.colliderV3.multiplyScalar(.5):this.colliderV3),e.getWorldQuaternion(this.colliderQuaternion),this.velocitySimRT.material.uniforms.uColliderQuaternion.value.copy(this.colliderQuaternion.normalize()),this.velocitySimRT.material.uniforms.uColliderQuaternionInvert.value.copy(this.colliderQuaternion.normalize().invert())}updateState(e){!this.velocitySimRT||!this.positionSimRT||(e.renderMaterial&&this.updateMaterialState(e.renderMaterial),this.updateParticleState(e))}updateVariableState(e,t){if(!this.velocitySimRT||!this.positionSimRT)return;"size"===t[2]&&this.material.updateState({size:[e,this.material.uniforms.uSizeEnd.value]}),"sizeEnd"===t[2]&&this.material.updateState({size:[this.material.uniforms.uSize.value,e]});let n=(e,t)=>{let n=[...this.system.data.shape.size];n[e]=t,this.updateParticleState({shape:d(d({},this.system.data.shape),{},{size:n})})};"shape_size_0"===t[2]&&n(0,e),"shape_size_1"===t[2]&&n(1,e),"shape_size_2"===t[2]&&n(2,e),"speed"===t[2]&&(this.velocitySimRT.material.uniforms.uSpeed.value=e/10),"gravity"===t[2]&&this.worldGravity.set(0,e/100,0),"noiseStrength"===t[2]&&(this.noiseStrength=e,this.velocitySimRT.material.uniforms.uNoiseStrength.value=this.noiseStrength),"noiseScale"===t[2]&&(this.noiseScale=e,this.velocitySimRT.material.uniforms.uNoiseScale.value=this.noiseScale),"direction_x"===t[2]&&(this.directionAxis=this.getDirectionAxis([Number(e),this.system.data.direction[1],this.system.data.direction[2]])),"direction_y"===t[2]&&(this.directionAxis=this.getDirectionAxis([this.system.data.direction[0],Number(e),this.system.data.direction[2]])),"direction_z"===t[2]&&(this.directionAxis=this.getDirectionAxis([this.system.data.direction[0],this.system.data.direction[1],Number(e)]))}updateMaterialState(e){this.material.updateState(d(d({},e),{},{size:e.size?[Number(this.shared.getVariable(e.size[0],[this.uuid,"particles","size"])),Number(this.shared.getVariable(e.size[1],[this.uuid,"particles","sizeEnd"]))]:[0,0]})),e.texture&&(this.setTexture(this.material.uniforms,e.texture),this.material.needsUpdate=!0)}updateParticleState(e){if(this.positionSimRT&&this.velocitySimRT){var t,n;if(this.shouldReInitGPUCompute(e)&&this.init(EZ(this.system.data)),void 0!==e.life&&(this.positionSimRT.material.uniforms.uMaxLifeTime.value=e.life),void 0!==e.speed&&(this.velocitySimRT.material.uniforms.uSpeed.value=Number(this.shared.getVariable(e.speed,[this.uuid,"particles","speed"]))/10),void 0!==e.collisionBounce&&(this.velocitySimRT.material.uniforms.uBounce.value=e.collisionBounce),void 0!==e.noiseStrength&&(this.noiseStrength=Number(this.shared.getVariable(e.noiseStrength,[this.uuid,"particles","noiseStrength"])),this.velocitySimRT.material.uniforms.uNoiseStrength.value=this.noiseStrength),void 0!==e.noiseScale&&(this.noiseScale=Number(this.shared.getVariable(e.noiseScale,[this.uuid,"particles","noiseScale"])),this.velocitySimRT.material.uniforms.uNoiseScale.value=this.noiseScale),void 0!==e.noiseSeed&&(this.velocitySimRT.material.uniforms.uNoiseSeed.value=e.noiseSeed),void 0!==e.randomMass&&(this.velocitySimRT.material.uniforms.uRandomMassFactor.value=e.randomMass),void 0!==(null===(t=e.renderMaterial)||void 0===t?void 0:t.size)){let t=this.shared.getVariable(e.renderMaterial.size[0],[this.uuid,"particles","size"]);this.velocitySimRT.material.uniforms.particleSize.value=Number(t)}if(void 0!==(null===(n=e.renderMaterial)||void 0===n?void 0:n.spriteRotation)&&(this.material.uniforms.uRotation.value=e.renderMaterial.spriteRotation[0],this.material.uniforms.uRotationEnd.value=e.renderMaterial.spriteRotation[1]),void 0!==e.shape){var i,r;let t=null!==(i=e.shape.size)&&void 0!==i?i:this.system.data.shape.size,n=[Number(this.shared.getVariable(t[0],[this.uuid,"particles","shape_size_0"])),Number(this.shared.getVariable(t[1],[this.uuid,"particles","shape_size_1"])),Number(this.shared.getVariable(t[2],[this.uuid,"particles","shape_size_2"]))],s=d(d({},EZ(this.system.data).shape),{},{size:n});null===(r=this.emitterShape)||void 0===r||r.applyToShader(this.positionSimRT.material.uniforms,s)}if(void 0!==e.gravity&&(this.worldGravity.set(0,Number(this.shared.getVariable(this.system.data.gravity,[this.uuid,"particles","gravity"]))/100,0),this.velocitySimRT.material.uniforms.uGravity={value:this.worldGravity}),void 0!==e.direction){let t=this.getDirectionFromVariable(e.direction);this.directionAxis=this.getDirectionAxis(t),this.velocitySimRT.material.uniforms.uDirectionsAxis.value=this.directionAxis}void 0!==e.randomRotation&&(this.material.uniforms.uRandRotationFactor.value=e.randomRotation),void 0!==e.randomScale&&(this.material.uniforms.uRandScaleFactor.value=e.randomScale)}}updateForceFieldParameters(e){!this.velocitySimRT||(void 0!==e.forceIntensity&&(this.velocitySimRT.material.uniforms.uForceIntensity.value=e.forceIntensity),void 0!==e.forceDambing&&(this.velocitySimRT.material.uniforms.uForceDamping.value=e.forceDambing))}getDirectionAxis(e){let t=[Number(e[0])*ov.DEG2RAD,Number(e[1])*ov.DEG2RAD,Number(e[2])*ov.DEG2RAD],n=new _y(t[0],t[1],t[2],"XYZ");return this.directionAxis.set(0,1,0).applyEuler(n).normalize(),this.velocitySimRT&&(this.velocitySimRT.material.uniforms.uDirectionsAxis.value=this.directionAxis),this.directionAxis}shouldReInitGPUCompute(e){let{birthRatePerSec:t,rootObjectType:n,colliderEntityId:i,shape:r,emitTimeDuration:s,emitTimeCycle:a,life:o,directionMode:l,noiseType:u}=e;return void 0!==t||void 0!==n||i||null===i||void 0!==a||void 0!==r||void 0!==o||void 0!==s||void 0!==l||void 0!==u}init(e){this.dispose(),this.particlesAmount=this.getMaxParticlesAmount({birthRatePerSecond:e.birthRatePerSec,particleMaxLifeTime:e.life,loopDuration:"infinity"===e.emitTimeCycle?0:e.emitTimeDuration}),this.particlesAmount>1e5&&(console.warn("The maximum number of particles is limited to ".concat(1e5,".")),this.particlesAmount=1e5),this.emitterShape=this.createShape(e.shape,this.particlesAmount);let t=setInterval((()=>{if(this.emitterShape){if(isNaN(this.emitterShape.positionsTexture.source.data.data[0]))return void this.init(e);clearInterval(t)}}),100);if(!this.emitterShape)return;let n=new fZ(this.emitterShape.textureSize,this.emitterShape.textureSize,this.renderer),i=this.updateSimulationDefinition(e),r=n.addVariable("uCurrentPosition",i+"\n// uniform sampler2D uCurrentPosition; // Pass in the variable from GPGPU\n// uniform sampler2D uCurrentVelocity; // Pass in the variable from GPGPU\n// uniform sampler2D uCurrentEmissionRate; // Pass in the variable from GPGPU\nuniform sampler2D uOriginalPosition;\nuniform float uTime;\nuniform float uSpeed;     // update speed of the particles\nuniform vec3 uWorldOffset;    \nuniform vec4 uWorldQuaternion;\nuniform float uMaxLifeTime;\nuniform vec3 uEmitterSize;\nuniform float uFPSRatio;     // 1  for 60 FPS\n\nfloat random (vec2 st) {\n    return fract(sin(dot(st.xy,\n        vec2(12.9898,78.233)))*\n        43758.5453123);\n}\nvec3 applyQuaternionToVector( vec4 q, vec3 v ){\n    return v + 2.0 * cross( q.xyz, cross( q.xyz, v ) + q.w * v );\n}\n\nvec3 applyForce(vec3 force, float mass) {\n    vec3 acceleration = force / mass;\n    \n    return acceleration;\n  }\n  \n\nvoid main() {\n    vec2 vUv = gl_FragCoord.xy / resolution.xy;\n    vec3 position = texture2D( uCurrentPosition, vUv ).xyz;\n    float currentLife = texture2D( uCurrentPosition, vUv ).w;   // from 1 to 0\n    float isSpawning = texture2D( uCurrentEmissionRate, vUv ).r;        // 1. = spawning, 0. = not spawning\n    float isActive = texture2D( uCurrentEmissionRate, vUv ).g;          // 1. = active, 0. = not active\n    float timeStart = texture2D( uCurrentEmissionRate, vUv ).b;         // timeStart in seconds when the particle was emitted\n    vec3 originalPosition = ((texture2D( uOriginalPosition, vUv ).xyz) * uEmitterSize);\n    vec3 velocity = texture2D( uCurrentVelocity, vUv ).xyz;\n    float collisionFlag = texture2D( uCurrentVelocity, vUv ).w;             // 1. = collided, 0. = not collided\n    float lifeTime = uMaxLifeTime;\n\n    // Calculate the position adjustment based on collision\n    //     if (collisionFlag > .5) {  \n    float isColliding = step(0.5, collisionFlag); // 1.0 if collisionFlag > 0.5, otherwise 0.0\n    float bounceOffset = 3.0 * isColliding; // Becomes 3.0 if colliding, 0.0 otherwise\n    vec3 collisionAdjustedVelocity = velocity * (1.0 + bounceOffset);\n\n    // Update position based on collision or normal movement\n    vec3 fpsVelocity = velocity * min(uFPSRatio, 5.0);\n    position += mix(fpsVelocity, collisionAdjustedVelocity, isColliding);\n\n    // EMISSION RATE - BIRTH\n    // if (isSpawning == 1.0) {\n    // Better Approach to avoid If statement\n    vec3 newPosition = applyQuaternionToVector(uWorldQuaternion, originalPosition) + uWorldOffset;\n    originalPosition = mix(originalPosition, newPosition, isSpawning);\n    position = mix(position, originalPosition, isSpawning);;\n    timeStart = mix(timeStart, uTime, isSpawning);\n\n    // Calculate timeLeft for life normalization\n    float timeLeft = max(lifeTime - (uTime - timeStart), 0.0);\n    float life_Normalize = timeLeft / lifeTime;\n\n    // Use isActive to blend between the calculated color and black\n    vec4 activeColor = vec4(position, life_Normalize);\n    // if (isActive == 1.0) {\n    gl_FragColor = mix(vec4(0.0), activeColor, isActive);\n\n}\n",this.emitterShape.positionsTexture),s=n.addVariable("uCurrentVelocity",i+xZ,this.emitterShape.directionsTexture),a=n.addVariable("uCurrentEmissionRate","\n// uniform sampler2D uCurrentPosition; // Pass in the variable from GPGPU\n// uniform sampler2D uCurrentVelocity; // Pass in the variable from GPGPU\n// uniform sampler2D uCurrentEmissionRate; // Pass in the variable from GPGPU\n\nuniform sampler2D uIndex; // Texture with corresponding index\nuniform float uLastIndexEmitted; // Last emitted index\nuniform float uParticlesToEmit; // Number of particles to emit on that frame\nuniform float uTime;\n\nvoid main() {\n    vec2 vUv = gl_FragCoord.xy / resolution.xy;\n    float particleIndex = texture(uIndex, vUv).x;\n    float timeLeft = texture2D( uCurrentPosition, vUv ).w;\n    float isActive = texture2D( uCurrentEmissionRate, vUv ).g;    // 1. = active, 0. = not active\n    float timeStart = texture2D( uCurrentEmissionRate, vUv ).b;\n\n\n    // ********** Detect Colision to Create a flag and use it in position **********\n    // We are doing this here, so\n\n    // ********** Emit Particles **********\n    // X = isSpawning 0.0 or 1.0\n    // Y = isActive 0.0 or 1.0\n    // Check if the vertex index is between the first value and the last value\n    // if (particleIndex >= uLastIndexEmitted && particleIndex < uLastIndexEmitted + uParticlesToEmit) {\n    //     // Emit a particle by writing 1 to the red channel of the color output\n    //     // r: 1. == emit the particle\n    //     // g: 1. == particle is now active\n    //     timeStart = uTime;\n    //     gl_FragColor = vec4(1.0, 1.0, timeStart, 1.0);\n    // } else {\n    //     // The Particle is either already emitted or not in the range of the particles to emit\n    //     // Do not emit a particle by writing 0 to the red channel of the color output        \n    //     gl_FragColor = vec4(0.0, isActive, timeStart, 1.0);\n    // }\n    // Determine if the particle is within the emission range\n    float emitLowerBound = step(uLastIndexEmitted, particleIndex);\n    float emitUpperBound = step(particleIndex, uLastIndexEmitted + uParticlesToEmit - 1.0);\n    float emitParticle = emitLowerBound * emitUpperBound; // 1.0 if in range, 0.0 otherwise\n\n    // Set timeStart and color\n    timeStart = mix(timeStart, uTime, emitParticle);\n    gl_FragColor = vec4(emitParticle, mix(isActive, 1.0, emitParticle), timeStart, 1.0);\n\n\n}\n",function(e){let t=new Float32Array(4*e*e);for(let i=0;i<e*e;i++)t[4*i]=0,t[4*i+1]=0,t[4*i+2]=0,t[4*i+3]=0;let n=new FD(t,e,e,bg,vg);return n.needsUpdate=!0,n}(this.emitterShape.textureSize));n.setVariableDependencies(r,[r,s,a]),n.setVariableDependencies(s,[r,s,a]),n.setVariableDependencies(a,[r,s,a]);let o=function(e){let{size:t}=e,n=new Float32Array(4*t*t);for(let r=0;r<t*t;r++)n[4*r]=r,n[4*r+1]=0,n[4*r+2]=0,n[4*r+3]=0;let i=new FD(n,t,t,bg,vg);return i.needsUpdate=!0,i}({size:this.emitterShape.textureSize}),l={uOriginalPosition:{value:this.emitterShape.positionsTexture},uWorldOffset:{value:new Lv(0,0,0)},uWorldQuaternion:{value:new Ov(0,0,0,1)},uTime:{value:0},uFPSRatio:{value:1},uMaxLifeTime:{value:e.life},uEmitterSize:{value:new Lv(Number(this.shared.getVariable(e.shape.size[0],[this.uuid,"particles","shape_size_0"])),Number(this.shared.getVariable(e.shape.size[1],[this.uuid,"particles","shape_size_1"])),Number(this.shared.getVariable(e.shape.size[2],[this.uuid,"particles","shape_size_2"])))},particleSize:{value:0}};r.material.uniforms=l;let u=this.getDirectionFromVariable(e.direction);this.directionAxis=this.getDirectionAxis(u),this.worldGravity.set(0,Number(this.shared.getVariable(this.system.data.gravity,[this.uuid,"particles","gravity"]))/100,0),this.noiseStrength=Number(this.shared.getVariable(e.noiseStrength,[this.uuid,"particles","noiseStrength"])),this.noiseScale=Number(this.shared.getVariable(e.noiseScale,[this.uuid,"particles","noiseScale"]));let c=e.colliderEntityId&&this.system.getColliderData(e.colliderEntityId),h={uOriginalPosition:{value:this.emitterShape.positionsTexture},uDirections:{value:this.emitterShape.directionsTexture},uDirectionsAxis:{value:this.directionAxis},uWorldQuaternion:{value:new Ov(0,0,0,1)},uColliderPos:{value:new Lv(0,0,0)},uColliderSize:{value:new Lv(0,0,0)},uForceIntensity:{value:c?c.forceIntensity:0},uForceDamping:{value:c?c.forceDambing:0},uColliderQuaternion:{value:new Ov(0,0,0,1)},uColliderQuaternionInvert:{value:new Ov(0,0,0,1)},particleSize:{value:0},uGravity:{value:this.worldGravity},uNoiseStrength:{value:this.noiseStrength},uNoiseScale:{value:this.noiseScale},uNoiseSeed:{value:e.noiseSeed},uRandomMassFactor:{value:e.randomMass},uBounce:{value:e.collisionBounce},uSpeed:{value:Number(this.shared.getVariable(e.speed,[this.uuid,"particles","speed"]))/10}};s.material.uniforms=h;let p={uIndex:{value:o},uTime:{value:0},uLastIndexEmitted:{value:0},uParticlesToEmit:{value:0}};a.material.uniforms=p;let f=[Number(this.shared.getVariable(e.shape.size[0],[this.uuid,"particles","shape_size_0"])),Number(this.shared.getVariable(e.shape.size[1],[this.uuid,"particles","shape_size_1"])),Number(this.shared.getVariable(e.shape.size[2],[this.uuid,"particles","shape_size_2"]))],m=d(d({},EZ(this.system.data).shape),{},{size:f});this.emitterShape.applyToShader(r.material.uniforms,m),n.init(),this.gpuCompute=n,this.positionSimRT=r,this.velocitySimRT=s,this.emissionRateSimRT=a,this.rootObject=this.createPrimaryEmitter(this.emitterShape.textureSize),this.add(this.rootObject),this.material.needsUpdate=!0}getDirectionFromVariable(e){return[Number(this.shared.getVariable(e[0],[this.uuid,"particles","direction_x"])),Number(this.shared.getVariable(e[1],[this.uuid,"particles","direction_y"])),Number(this.shared.getVariable(e[2],[this.uuid,"particles","direction_z"]))]}updateSimulationDefinition(e){if(this.simFeaturesDefinition.USE_COLLIDER=!1,this.simFeaturesDefinition.USE_ATTRACTOR=!1,this.simFeaturesDefinition.USE_VORTEX=!1,this.simFeaturesDefinition.USE_SPHERE_COLLIDER=!1,this.simFeaturesDefinition.USE_BOX_COLLIDER=!1,this.simFeaturesDefinition.USE_FORCE_LOCAL_SPACE=!1,this.simFeaturesDefinition.USE_NORMALS=!1,this.simFeaturesDefinition.USE_CURL_NOISE=!1,this.simFeaturesDefinition.USE_SIMPLEX_NOISE=!1,this.simFeaturesDefinition.USE_FBM_NOISE=!1,e.colliderEntityId&&this.system.colliderEntities.length>0){let t=this.system.getColliderData(e.colliderEntityId);switch(null===t||void 0===t?void 0:t.forceType){case"attractor":this.simFeaturesDefinition.USE_ATTRACTOR=!0;break;case"collider":this.simFeaturesDefinition.USE_COLLIDER=!0;break;case"vortex":this.simFeaturesDefinition.USE_VORTEX=!0}let n=null===t||void 0===t?void 0:t.colliderType;"sphere"===n&&(this.simFeaturesDefinition.USE_SPHERE_COLLIDER=!0),"box"===n&&(this.simFeaturesDefinition.USE_BOX_COLLIDER=!0),"helper"===(null===t||void 0===t?void 0:t.forceRange)&&(this.simFeaturesDefinition.USE_FORCE_LOCAL_SPACE=!0)}"normals"===e.directionMode&&(this.simFeaturesDefinition.USE_NORMALS=!0),"curl"===e.noiseType&&(this.simFeaturesDefinition.USE_CURL_NOISE=!0),"simplex"===e.noiseType&&(this.simFeaturesDefinition.USE_SIMPLEX_NOISE=!0),"fbm"===e.noiseType&&(this.simFeaturesDefinition.USE_FBM_NOISE=!0);let t="";for(let[n,i]of Object.entries(this.simFeaturesDefinition))i&&(t+="#define ".concat(n,"\n"));return t}createShape(e,t){this.emitterShape&&this.emitterShape.dispose();let n=new Lv(Number(this.shared.getVariable(e.size[0],[this.uuid,"particles","shape_size_0"])),Number(this.shared.getVariable(e.size[1],[this.uuid,"particles","shape_size_1"])),Number(this.shared.getVariable(e.size[2],[this.uuid,"particles","shape_size_2"])));if("MeshEmitterShape"===e.type){let i=null;return this.system.context.scene.traverseEntity((t=>{t.uuid===e.fromMeshId&&(i=t)})),i?new SZ(n,t,e.type,i):new SZ(n,t,"SphereEmitterShape")}return new SZ(n,t,e.type)}createPrimaryEmitter(e){let t,n=e*e;return t=new UD(new Qx(1,1,1),this.material,n),this.updateGeometryAttributes(t,e),this.material.needsUpdate=!0,t.onBeforeRender=()=>{this.applyWorldSpace()},t}getMaxParticlesAmount(e){let{birthRatePerSecond:t,particleMaxLifeTime:n,loopDuration:i=0}=e;return Math.ceil(t*(n+i))}dispose(){var e,t;!this.gpuCompute||(null!==(e=this.rootObject)&&void 0!==e&&null!==(e=e.parent)&&void 0!==e&&e.remove(this.rootObject),this.gpuCompute.dispose(),this.material.nodeMaterialDispose(),null===(t=this.emitterShape)||void 0===t||t.dispose())}GoEmitSomeParticles(e,t){let n=e-this.lastEmitTime,i=1/t;if(n>=i){let t=Math.max(1,Math.floor(n/i));return this.lastEmitTime=e,this.emittedParticlesAmount+t>this.particlesAmount&&(this.emittedParticlesAmount=0),this.emittedParticlesAmount+=t,t}return 0}checkIfAllParticlesAreDead(){return this.lastEmitTime+this.system.data.life+1<this.globalTime}reset(){this.hasBeenReset=!0,this.lastEmitTime=0,this.emittedParticlesAmount=0,this.gpuCompute&&this.init(EZ(this.system.data))}startEmitting(e){this.isEmitting=!0,this.hasBeenReset=!1,this.lastEmitTime=e}stopEmitting(){this.isEmitting=!1}},AZ=class extends FV{constructor(e,t,n){super(e,t),this.type="ParticleSystem",this.geometry=new dx,this.actualTime=0,this.currentLoopTime=0,this.started=!1,this.stopped=!1,this.timeoutId=void 0,this.isFrozen=!1,this.isIdle=!0,this.emitter=null,this.colliderEntities=[],this.renderer=null,this.isPreWarm=!1,this._hasOnAfterRenderBeenCalled=!1,this.onAfterRender=e=>{this._hasOnAfterRenderBeenCalled||(this._hasOnAfterRenderBeenCalled=!0,this.init(e))},this.context=n,this.data=d(d({},t),EZ(t)),this.geometry.setAttribute("position",new rx([],3)),this.material=new Jy({colorWrite:!1}),this.frustumCulled=!1}init(e){this.renderer=e,this.emitter=new CZ(e,this),this.add(this.emitter),this.updateParticleState(this.data)}update(e){if(!this.isReady||!this.started||this.isFrozen||this.isIdle)return;this.actualTime+=e,this.stopped||(this.currentLoopTime+=e);let t="one_time"===this.data.emitTimeCycle;if(("loop"===this.data.emitTimeCycle||t)&&this.currentLoopTime>1e3*this.data.emitTimeDuration&&(this.stopped||(this.stop(),t||this.start(1e3*this.data.emitTimeDelay))),this.emitter&&this.started){let t=this.actualTime/1e3;this.emitter.update(t,e)}this.scale.set(1,1,1),this.updateMatrix()}isReady(){return!!this.emitter}hasCollider(e){return this.colliderEntities.some((t=>t.identity===e))}getColliderData(e){let t=this.colliderEntities.find((t=>t.identity===e));return t?t.data:null}updateByPatchedOp(e,t,n){super.updateByPatchedOp(e,t,n),zO(e.path,["renderMaterial"])&&this.updateParticleState({renderMaterial:d(d({},this.data.renderMaterial),uO.drop(e,1).props)}),zO(e.path,["shape"])&&this.updateParticleState({shape:d(d({},this.data.shape),uO.drop(e,1).props)})}updateState(e,t){super.updateState(e,t),this.updateParticleState(e)}updateParticleState(e){if(this.emitter){if(void 0!==e.colliderEntityId&&null!==e.colliderEntityId){let t=this.context.scene.find(e.colliderEntityId);this.colliderEntities=t?[t]:[]}null===e.colliderEntityId&&(this.colliderEntities=[]),this.emitter.updateState(e),e.emitTimeCycle&&this.started&&this.start()}}updateFromColliderEntity(e){!this.emitter||(this.emitter.updateForceFieldParameters(e),this.stop(),this.start())}start(){var e;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.currentLoopTime=0,t?this.timeoutId=window.setTimeout((()=>{this.start(0)}),t):(this.started=!0,this.stopped=!1,this.isFrozen=!1,null===(e=this.emitter)||void 0===e||e.startEmitting(this.actualTime/1e3))}froze(){this.isFrozen=!0}unFroze(){this.isFrozen=!1}stop(){var e;this.stopped=!0,this.currentLoopTime=0,null!==(e=this.emitter)&&void 0!==e&&e.stopEmitting(),clearTimeout(this.timeoutId)}reset(){var e;this.started=!1,this.stopped=!1,null===(e=this.emitter)||void 0===e||e.reset()}wakeUp(){this.isIdle=!1}sleep(){this.isIdle=!0,this.reset()}};var MZ=function(){try{let e=window.location.href;if(e.includes("reducesubdiv=")){let t=e.indexOf("reducesubdiv=")+13;return parseInt(e.slice(t,t+1))}}catch(e){}}();function TZ(e,t,n){return console.assert(void 0!==t.type),"Mesh"===t.type?function(e,t,n){var i,r;let s;return void 0!==MZ&&(null!==(i=null===t||void 0===t||null===(r=t.geometry)||void 0===r?void 0:r.subdivisions)&&void 0!==i?i:0)>MZ&&(console.log("reducing subdivisions",t.name,t.geometry.subdivisions),t.geometry.subdivisions=MZ),"TextGeometry"===t.geometry.type?new eY(e,t,n):"InputGeometry"===t.geometry.type?new oZ(e,t,n):(s="SubdivGeometry"===t.geometry.type?new Pq(e,t,n):"PathGeometry"===t.geometry.type?new aZ(e,t,n):"VectorGeometry"===t.geometry.type?new sZ(e,t,n):"BooleanGeometry"===t.geometry.type?new LY(e,t,n):"ShapeBlendGeometry"===t.geometry.type?new LZ(e,t,n):"UIGeometry"===t.geometry.type?new pZ(e,t,n):new Sq(e,t,n),s)}(e,t,n):"Empty"===t.type?new YY(e,t):"Particle"===t.type?new AZ(e,t,n):"ParticleCollider"===t.type?new XY(e,t,n):"Splat"===t.type?new YY(e,t):"Bone"===t.type?new dZ(e,t):"Page"===t.type?new iZ(e,t,n):"PointLight"===t.type?new rZ(e,t,n):"SpotLight"===t.type?new iK(e,t,n):"DirectionalLight"===t.type?new $Q(e,t,n):"Component"===t.type||"Instance"===t.type?new lZ(e,t,n):qk.is(t.type)?new OY(e,t):(console.error(t),new YY(e,t))}Zz.createEntity=TZ,Zz.changeEntityProptotype=function(e,t,n){let i=TZ(e.identity,t,n),r=e.children,s=e.attachedPaths,a=e.parent,o=e.component,l=e.instances,u=e.overrideData,c=e.uuid,h=e.stateSelection;e.dispose();for(let d of Object.keys(e))delete e[d];Object.setPrototypeOf(e,Object.getPrototypeOf(i));for(let d of Object.keys(i))e[d]=i[d];e.children=[...e.children,...r],e.attachedPaths=s,e.parent=a,e.component=o,e.instances=l,e.uuid=c,e.overrideData=u,e.updateState(e.data,n),h&&e.changeSelectedState(h,n),e.resetBBoxNeedsUpdate()},Zz.Cloner=pY;var PZ=new dx;PZ.setAttribute("position",new tx(new Float32Array([-1,-1,0,3,-1,0,-1,3,0]),3));var FZ=class extends iS{constructor(e){super(d(d({},e),{},{depthTest:!1,depthWrite:!1,glslVersion:Gg,vertexShader:"\n\t\t\t\tprecision highp float;\n\t\t\t\tin vec3 position;\n\t\t\t\tvoid main() {\n\t\t\t\t\tgl_Position = vec4(position, 1);\n\t\t\t\t}\n\t\t\t"}))}customProgramCacheKey(){return""}};var OZ=new kx,IZ=24,kZ=96,BZ={shapeInput:()=>"\n\t\t\tconst float posRowCoord = ".concat(.1,";  // vec4: px py pz opType\n\t\t\tconst float quatRowCoord = ").concat(.3,";  // vec4: qx qy qz qw\n\t\t\tconst float param1RowCoord = ").concat(.5,";// vec4: type param1 param2 param3\n\t\t\tconst float param2RowCoord = ").concat(.7,";// vec4: blendRange roundness scale param4\n\t\t\tconst float colorRowCoord = ").concat(.9,"; // vec4: r g b a\n\t\t\tuniform sampler2D shapesDataTexture;\n\t\t\tvec4 shapePos(float iin) { \n\t\t\t\tvec4 r = texture(shapesDataTexture, vec2(iin, posRowCoord));\n\t\t\t\treturn r;\n\t\t\t}\n\t\t\tvec4 shapeQuat(float iin) {\n\t\t\t\tvec4 r = texture(shapesDataTexture, vec2(iin, quatRowCoord));\n\t\t\t\treturn r;\n\t\t\t}\n\t\t\tvec4 shapeParams1(float iin) {\n\t\t\t\tvec4 r = texture(shapesDataTexture, vec2(iin, param1RowCoord));\n\t\t\t\treturn r;\n\t\t\t}\n\t\t\tvec4 shapeParams2(float iin) {\n\t\t\t\tvec4 r = texture(shapesDataTexture, vec2(iin, param2RowCoord));\n\t\t\t\treturn r;\n\t\t\t}\n\t\t\tvec4 shapeColor(float iin) {\n\t\t\t\tvec4 r = texture(shapesDataTexture, vec2(iin, colorRowCoord));\n\t\t\t\treturn r;\n\t\t\t}\n\t\t"),getxyzi:"\n\t\t\t// this code must complement lookup\n\t\t\tfloat xi = mod(gl_FragCoord.x - 0.5, VOXEL_RESOLUTION);\n\t\t\tfloat yi = mod(gl_FragCoord.y - 0.5, VOXEL_RESOLUTION);\n\t\t\tfloat zi = floor((gl_FragCoord.x - 0.5) * INV_VOXEL_RESOLUTION) + floor((gl_FragCoord.y - 0.5) * INV_VOXEL_RESOLUTION) * Z_LAYERS_PER_ROW;\n\t\t",lookup:"\n\t\t\tuniform sampler2D potentialPassTexture;\n\t\t\tuniform sampler2D voxelPassTexture; // includes normal (in xyz) and key (in w)\n\t\t\t\n\t\t\t// box or marching cube lookup value in value texture, integer box coord inputs\n\t\t\t// this code must complement codebits.getxyzi\n\t\t\tvec4 look(float xi, float yi, float zi, sampler2D rt) {// range 0 .. numv etc\n\t\t\t\tvec2 uv = vec2(\n\t\t\t\t\tmod(zi, Z_LAYERS_PER_ROW) + (xi + 0.5) / VOXEL_RESOLUTION,\n\t\t\t\t\tfloor(zi / Z_LAYERS_PER_ROW) + (yi + 0.5) / VOXEL_RESOLUTION\n\t\t\t\t); \n\t\t\t\tuv /= Z_LAYERS_PER_ROW;\n\t\t\t\treturn texture(rt, uv);\n\t\t\t}\n\t\t",getpart:"\n\t\t\tfloat getpart(inout float a, float b) {\n\t\t\t\tfloat t = floor(a/b);\n\t\t\t\tfloat r = a - t*b;\n\t\t\t\ta = t;\n\t\t\t\treturn r;\n\t\t\t}\n\t\t",triTable:new Float32Array([-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3,8,0,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,9,1,0,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3,8,1,1,8,9,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,10,2,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3,8,0,10,2,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,10,2,9,9,2,0,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3,8,2,8,10,2,8,9,10,-1,-1,-1,-1,-1,-1,-1,2,11,3,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,2,11,0,0,11,8,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,9,1,11,3,2,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,2,11,1,11,9,1,11,8,9,-1,-1,-1,-1,-1,-1,-1,1,10,3,3,10,11,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,10,0,10,8,0,10,11,8,-1,-1,-1,-1,-1,-1,-1,0,9,3,9,11,3,9,10,11,-1,-1,-1,-1,-1,-1,-1,10,8,9,11,8,10,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8,7,4,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,3,4,4,3,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,9,1,0,7,4,8,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,9,1,4,1,7,4,1,3,7,-1,-1,-1,-1,-1,-1,-1,10,2,1,7,4,8,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,7,4,3,4,0,3,10,2,1,-1,-1,-1,-1,-1,-1,-1,10,2,9,2,0,9,7,4,8,-1,-1,-1,-1,-1,-1,-1,9,10,2,7,9,2,3,7,2,4,9,7,-1,-1,-1,-1,7,4,8,2,11,3,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,7,4,11,4,2,11,4,0,2,-1,-1,-1,-1,-1,-1,-1,1,0,9,7,4,8,11,3,2,-1,-1,-1,-1,-1,-1,-1,11,7,4,11,4,9,2,11,9,1,2,9,-1,-1,-1,-1,1,10,3,10,11,3,4,8,7,-1,-1,-1,-1,-1,-1,-1,10,11,1,11,4,1,4,0,1,4,11,7,-1,-1,-1,-1,8,7,4,11,0,9,10,11,9,3,0,11,-1,-1,-1,-1,11,7,4,9,11,4,10,11,9,-1,-1,-1,-1,-1,-1,-1,4,5,9,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,5,9,3,8,0,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,5,0,0,5,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,5,8,5,3,8,5,1,3,-1,-1,-1,-1,-1,-1,-1,10,2,1,4,5,9,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8,0,3,10,2,1,5,9,4,-1,-1,-1,-1,-1,-1,-1,10,2,5,2,4,5,2,0,4,-1,-1,-1,-1,-1,-1,-1,5,10,2,5,2,3,4,5,3,8,4,3,-1,-1,-1,-1,4,5,9,11,3,2,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,2,11,0,11,8,0,5,9,4,-1,-1,-1,-1,-1,-1,-1,4,5,0,5,1,0,11,3,2,-1,-1,-1,-1,-1,-1,-1,5,1,2,8,5,2,11,8,2,5,8,4,-1,-1,-1,-1,11,3,10,3,1,10,4,5,9,-1,-1,-1,-1,-1,-1,-1,5,9,4,1,8,0,1,10,8,10,11,8,-1,-1,-1,-1,0,4,5,11,0,5,10,11,5,3,0,11,-1,-1,-1,-1,8,4,5,10,8,5,11,8,10,-1,-1,-1,-1,-1,-1,-1,8,7,9,9,7,5,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,3,9,3,5,9,3,7,5,-1,-1,-1,-1,-1,-1,-1,8,7,0,7,1,0,7,5,1,-1,-1,-1,-1,-1,-1,-1,3,5,1,7,5,3,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8,7,9,7,5,9,2,1,10,-1,-1,-1,-1,-1,-1,-1,2,1,10,0,5,9,0,3,5,3,7,5,-1,-1,-1,-1,2,0,8,5,2,8,7,5,8,2,5,10,-1,-1,-1,-1,5,10,2,3,5,2,7,5,3,-1,-1,-1,-1,-1,-1,-1,5,9,7,9,8,7,2,11,3,-1,-1,-1,-1,-1,-1,-1,7,5,9,2,7,9,0,2,9,11,7,2,-1,-1,-1,-1,11,3,2,8,1,0,8,7,1,7,5,1,-1,-1,-1,-1,1,2,11,7,1,11,5,1,7,-1,-1,-1,-1,-1,-1,-1,8,5,9,7,5,8,3,1,10,11,3,10,-1,-1,-1,-1,0,7,5,9,0,5,0,11,7,10,0,1,0,10,11,-1,0,10,11,3,0,11,0,5,10,7,0,8,0,7,5,-1,5,10,11,5,11,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,5,6,10,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3,8,0,6,10,5,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,0,9,6,10,5,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3,8,1,8,9,1,6,10,5,-1,-1,-1,-1,-1,-1,-1,5,6,1,1,6,2,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,5,6,1,6,2,1,8,0,3,-1,-1,-1,-1,-1,-1,-1,5,6,9,6,0,9,6,2,0,-1,-1,-1,-1,-1,-1,-1,8,9,5,2,8,5,6,2,5,8,2,3,-1,-1,-1,-1,11,3,2,5,6,10,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8,0,11,0,2,11,5,6,10,-1,-1,-1,-1,-1,-1,-1,9,1,0,11,3,2,6,10,5,-1,-1,-1,-1,-1,-1,-1,6,10,5,2,9,1,2,11,9,11,8,9,-1,-1,-1,-1,11,3,6,3,5,6,3,1,5,-1,-1,-1,-1,-1,-1,-1,11,8,0,5,11,0,1,5,0,6,11,5,-1,-1,-1,-1,6,11,3,6,3,0,5,6,0,9,5,0,-1,-1,-1,-1,9,5,6,11,9,6,8,9,11,-1,-1,-1,-1,-1,-1,-1,6,10,5,8,7,4,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,3,4,3,7,4,10,5,6,-1,-1,-1,-1,-1,-1,-1,0,9,1,6,10,5,7,4,8,-1,-1,-1,-1,-1,-1,-1,5,6,10,7,9,1,3,7,1,4,9,7,-1,-1,-1,-1,2,1,6,1,5,6,8,7,4,-1,-1,-1,-1,-1,-1,-1,5,2,1,6,2,5,4,0,3,7,4,3,-1,-1,-1,-1,7,4,8,5,0,9,5,6,0,6,2,0,-1,-1,-1,-1,9,3,7,4,9,7,9,2,3,6,9,5,9,6,2,-1,2,11,3,4,8,7,5,6,10,-1,-1,-1,-1,-1,-1,-1,6,10,5,2,7,4,0,2,4,11,7,2,-1,-1,-1,-1,9,1,0,8,7,4,11,3,2,6,10,5,-1,-1,-1,-1,1,2,9,2,11,9,11,4,9,4,11,7,6,10,5,-1,7,4,8,5,11,3,1,5,3,6,11,5,-1,-1,-1,-1,11,1,5,6,11,5,11,0,1,4,11,7,11,4,0,-1,9,5,0,5,6,0,6,3,0,3,6,11,7,4,8,-1,9,5,6,11,9,6,9,7,4,9,11,7,-1,-1,-1,-1,9,4,10,10,4,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,6,10,4,10,9,4,3,8,0,-1,-1,-1,-1,-1,-1,-1,1,0,10,0,6,10,0,4,6,-1,-1,-1,-1,-1,-1,-1,1,3,8,6,1,8,4,6,8,10,1,6,-1,-1,-1,-1,9,4,1,4,2,1,4,6,2,-1,-1,-1,-1,-1,-1,-1,8,0,3,9,2,1,9,4,2,4,6,2,-1,-1,-1,-1,4,2,0,6,2,4,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,2,3,8,4,2,8,6,2,4,-1,-1,-1,-1,-1,-1,-1,9,4,10,4,6,10,3,2,11,-1,-1,-1,-1,-1,-1,-1,2,8,0,11,8,2,10,9,4,6,10,4,-1,-1,-1,-1,2,11,3,6,1,0,4,6,0,10,1,6,-1,-1,-1,-1,1,4,6,10,1,6,1,8,4,11,1,2,1,11,8,-1,4,6,9,6,3,9,3,1,9,3,6,11,-1,-1,-1,-1,1,11,8,0,1,8,1,6,11,4,1,9,1,4,6,-1,6,11,3,0,6,3,4,6,0,-1,-1,-1,-1,-1,-1,-1,8,4,6,8,6,11,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,6,10,7,10,8,7,10,9,8,-1,-1,-1,-1,-1,-1,-1,3,7,0,7,10,0,10,9,0,10,7,6,-1,-1,-1,-1,7,6,10,7,10,1,8,7,1,0,8,1,-1,-1,-1,-1,7,6,10,1,7,10,3,7,1,-1,-1,-1,-1,-1,-1,-1,6,2,1,8,6,1,9,8,1,7,6,8,-1,-1,-1,-1,9,6,2,1,9,2,9,7,6,3,9,0,9,3,7,-1,0,8,7,6,0,7,2,0,6,-1,-1,-1,-1,-1,-1,-1,2,3,7,2,7,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,11,3,2,8,6,10,9,8,10,7,6,8,-1,-1,-1,-1,7,0,2,11,7,2,7,9,0,10,7,6,7,10,9,-1,0,8,1,8,7,1,7,10,1,10,7,6,11,3,2,-1,1,2,11,7,1,11,1,6,10,1,7,6,-1,-1,-1,-1,6,9,8,7,6,8,6,1,9,3,6,11,6,3,1,-1,1,9,0,7,6,11,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,8,7,6,0,7,0,11,3,0,6,11,-1,-1,-1,-1,6,11,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,11,6,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8,0,3,6,7,11,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,9,1,0,6,7,11,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,9,1,8,1,3,8,6,7,11,-1,-1,-1,-1,-1,-1,-1,2,1,10,7,11,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,10,2,1,8,0,3,7,11,6,-1,-1,-1,-1,-1,-1,-1,0,9,2,9,10,2,7,11,6,-1,-1,-1,-1,-1,-1,-1,7,11,6,3,10,2,3,8,10,8,9,10,-1,-1,-1,-1,3,2,7,7,2,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8,0,7,0,6,7,0,2,6,-1,-1,-1,-1,-1,-1,-1,6,7,2,7,3,2,9,1,0,-1,-1,-1,-1,-1,-1,-1,2,6,1,6,8,1,8,9,1,6,7,8,-1,-1,-1,-1,6,7,10,7,1,10,7,3,1,-1,-1,-1,-1,-1,-1,-1,6,7,10,10,7,1,7,8,1,8,0,1,-1,-1,-1,-1,7,3,0,10,7,0,9,10,0,7,10,6,-1,-1,-1,-1,10,6,7,8,10,7,9,10,8,-1,-1,-1,-1,-1,-1,-1,4,8,6,6,8,11,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,11,6,3,6,0,3,6,4,0,-1,-1,-1,-1,-1,-1,-1,11,6,8,6,4,8,1,0,9,-1,-1,-1,-1,-1,-1,-1,6,4,9,3,6,9,1,3,9,6,3,11,-1,-1,-1,-1,4,8,6,8,11,6,1,10,2,-1,-1,-1,-1,-1,-1,-1,10,2,1,11,0,3,11,6,0,6,4,0,-1,-1,-1,-1,8,11,4,11,6,4,9,2,0,9,10,2,-1,-1,-1,-1,3,9,10,2,3,10,3,4,9,6,3,11,3,6,4,-1,3,2,8,2,4,8,2,6,4,-1,-1,-1,-1,-1,-1,-1,2,4,0,2,6,4,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,9,1,4,3,2,6,4,2,8,3,4,-1,-1,-1,-1,4,9,1,2,4,1,6,4,2,-1,-1,-1,-1,-1,-1,-1,3,1,8,1,6,8,6,4,8,1,10,6,-1,-1,-1,-1,0,1,10,6,0,10,4,0,6,-1,-1,-1,-1,-1,-1,-1,3,6,4,8,3,4,3,10,6,9,3,0,3,9,10,-1,4,9,10,4,10,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,5,9,4,11,6,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3,8,0,5,9,4,6,7,11,-1,-1,-1,-1,-1,-1,-1,1,0,5,0,4,5,11,6,7,-1,-1,-1,-1,-1,-1,-1,6,7,11,4,3,8,4,5,3,5,1,3,-1,-1,-1,-1,4,5,9,2,1,10,11,6,7,-1,-1,-1,-1,-1,-1,-1,7,11,6,10,2,1,3,8,0,5,9,4,-1,-1,-1,-1,11,6,7,10,4,5,10,2,4,2,0,4,-1,-1,-1,-1,8,4,3,4,5,3,5,2,3,2,5,10,6,7,11,-1,3,2,7,2,6,7,9,4,5,-1,-1,-1,-1,-1,-1,-1,4,5,9,6,8,0,2,6,0,7,8,6,-1,-1,-1,-1,2,6,3,6,7,3,0,5,1,0,4,5,-1,-1,-1,-1,8,2,6,7,8,6,8,1,2,5,8,4,8,5,1,-1,4,5,9,6,1,10,6,7,1,7,3,1,-1,-1,-1,-1,10,6,1,6,7,1,7,0,1,0,7,8,4,5,9,-1,10,0,4,5,10,4,10,3,0,7,10,6,10,7,3,-1,10,6,7,8,10,7,10,4,5,10,8,4,-1,-1,-1,-1,5,9,6,9,11,6,9,8,11,-1,-1,-1,-1,-1,-1,-1,11,6,3,3,6,0,6,5,0,5,9,0,-1,-1,-1,-1,8,11,0,11,5,0,5,1,0,11,6,5,-1,-1,-1,-1,3,11,6,5,3,6,1,3,5,-1,-1,-1,-1,-1,-1,-1,10,2,1,11,5,9,8,11,9,6,5,11,-1,-1,-1,-1,3,11,0,11,6,0,6,9,0,9,6,5,10,2,1,-1,5,8,11,6,5,11,5,0,8,2,5,10,5,2,0,-1,3,11,6,5,3,6,3,10,2,3,5,10,-1,-1,-1,-1,9,8,5,8,2,5,2,6,5,2,8,3,-1,-1,-1,-1,6,5,9,0,6,9,2,6,0,-1,-1,-1,-1,-1,-1,-1,8,5,1,0,8,1,8,6,5,2,8,3,8,2,6,-1,6,5,1,6,1,2,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,6,3,1,10,6,1,6,8,3,9,6,5,6,9,8,-1,0,1,10,6,0,10,0,5,9,0,6,5,-1,-1,-1,-1,8,3,0,10,6,5,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,6,5,10,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,10,5,11,11,5,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,10,5,11,5,7,11,0,3,8,-1,-1,-1,-1,-1,-1,-1,7,11,5,11,10,5,0,9,1,-1,-1,-1,-1,-1,-1,-1,5,7,10,7,11,10,1,8,9,1,3,8,-1,-1,-1,-1,2,1,11,1,7,11,1,5,7,-1,-1,-1,-1,-1,-1,-1,3,8,0,7,2,1,5,7,1,11,2,7,-1,-1,-1,-1,5,7,9,7,2,9,2,0,9,7,11,2,-1,-1,-1,-1,2,5,7,11,2,7,2,9,5,8,2,3,2,8,9,-1,10,5,2,5,3,2,5,7,3,-1,-1,-1,-1,-1,-1,-1,0,2,8,2,5,8,5,7,8,5,2,10,-1,-1,-1,-1,1,0,9,3,10,5,7,3,5,2,10,3,-1,-1,-1,-1,2,8,9,1,2,9,2,7,8,5,2,10,2,5,7,-1,5,3,1,5,7,3,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,7,8,0,1,7,0,5,7,1,-1,-1,-1,-1,-1,-1,-1,3,0,9,5,3,9,7,3,5,-1,-1,-1,-1,-1,-1,-1,7,8,9,7,9,5,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,8,5,8,10,5,8,11,10,-1,-1,-1,-1,-1,-1,-1,4,0,5,0,11,5,11,10,5,0,3,11,-1,-1,-1,-1,9,1,0,10,4,8,11,10,8,5,4,10,-1,-1,-1,-1,4,11,10,5,4,10,4,3,11,1,4,9,4,1,3,-1,1,5,2,5,8,2,8,11,2,8,5,4,-1,-1,-1,-1,11,4,0,3,11,0,11,5,4,1,11,2,11,1,5,-1,5,2,0,9,5,0,5,11,2,8,5,4,5,8,11,-1,5,4,9,3,11,2,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,10,5,2,2,5,3,5,4,3,4,8,3,-1,-1,-1,-1,2,10,5,4,2,5,0,2,4,-1,-1,-1,-1,-1,-1,-1,2,10,3,10,5,3,5,8,3,8,5,4,9,1,0,-1,2,10,5,4,2,5,2,9,1,2,4,9,-1,-1,-1,-1,5,4,8,3,5,8,1,5,3,-1,-1,-1,-1,-1,-1,-1,5,4,0,5,0,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,5,4,8,3,5,8,5,0,9,5,3,0,-1,-1,-1,-1,5,4,9,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,7,11,4,11,9,4,11,10,9,-1,-1,-1,-1,-1,-1,-1,3,8,0,7,9,4,7,11,9,11,10,9,-1,-1,-1,-1,11,10,1,4,11,1,0,4,1,11,4,7,-1,-1,-1,-1,4,1,3,8,4,3,4,10,1,11,4,7,4,11,10,-1,7,11,4,4,11,9,11,2,9,2,1,9,-1,-1,-1,-1,4,7,9,7,11,9,11,1,9,1,11,2,3,8,0,-1,4,7,11,2,4,11,0,4,2,-1,-1,-1,-1,-1,-1,-1,4,7,11,2,4,11,4,3,8,4,2,3,-1,-1,-1,-1,10,9,2,9,7,2,7,3,2,9,4,7,-1,-1,-1,-1,7,10,9,4,7,9,7,2,10,0,7,8,7,0,2,-1,10,7,3,2,10,3,10,4,7,0,10,1,10,0,4,-1,2,10,1,4,7,8,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,9,4,7,1,4,3,1,7,-1,-1,-1,-1,-1,-1,-1,1,9,4,7,1,4,1,8,0,1,7,8,-1,-1,-1,-1,3,0,4,3,4,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,7,8,4,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8,10,9,8,11,10,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,9,0,3,11,9,3,10,9,11,-1,-1,-1,-1,-1,-1,-1,10,1,0,8,10,0,11,10,8,-1,-1,-1,-1,-1,-1,-1,10,1,3,10,3,11,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,11,2,1,9,11,1,8,11,9,-1,-1,-1,-1,-1,-1,-1,9,0,3,11,9,3,9,2,1,9,11,2,-1,-1,-1,-1,11,2,0,11,0,8,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,11,2,3,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8,3,2,10,8,2,9,8,10,-1,-1,-1,-1,-1,-1,-1,2,10,9,2,9,0,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8,3,2,10,8,2,8,1,0,8,10,1,-1,-1,-1,-1,2,10,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8,3,1,8,1,9,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,9,0,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8,3,0,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1]),numTrisTable:new Float32Array([0,1,1,2,1,2,2,3,1,2,2,3,2,3,3,2,1,2,2,3,2,3,3,4,2,3,3,4,3,4,4,3,1,2,2,3,2,3,3,4,2,3,3,4,3,4,4,3,2,3,3,2,3,4,4,3,3,4,4,3,4,5,5,2,1,2,2,3,2,3,3,4,2,3,3,4,3,4,4,3,2,3,3,4,3,4,4,5,3,4,4,5,4,5,5,4,2,3,3,4,3,4,2,3,3,4,4,5,4,5,3,2,3,4,4,3,4,5,3,2,4,5,5,4,5,2,4,1,1,2,2,3,2,3,3,4,2,3,3,4,3,4,4,3,2,3,3,4,3,4,4,5,3,2,4,3,4,3,5,2,2,3,3,4,3,4,4,5,3,4,4,5,4,5,5,4,3,4,4,3,4,5,5,4,4,3,5,2,5,4,2,1,2,3,3,4,3,4,4,5,3,4,4,5,2,3,3,2,3,4,4,5,4,5,5,2,4,3,5,4,3,2,4,1,3,4,4,5,4,5,3,4,4,5,5,2,3,4,2,1,2,3,3,2,3,4,2,1,3,2,4,1,2,1,1,0])},RZ=class extends Sq{constructor(e,t,n){super(e,t,n),this.data=t,this.needsRebuild=!0,this.customDepthMaterialNeedsUpdate=!1,this._npart=-1,this.spatialn=1,this.drawRangeNeedsForceUpdate=!0,this._resolutionLevel=-1,this.resolution=64,this.spatialDivisions=25,this.zLayersPerRow=8,this.basePyramidSize=512,this.pyramidTexture1Width=341,this.pyramidTexture1Height=256,this.pyramidTexture2Width=170,this.pyramidTexture2Height=128,this.numLevels=9,this.pyramidLevelSizes=[1,2,4,8,16,32,64,128,256,512],this.bboxSize=0,this.bboxOffset=0,this.shapesDataTexture={value:void 0},this.spatialscene=new CD,this.potentialPassScene=new CD,this.voxelPassScene=new CD,this._spatialPassRenderTargets=[],this._potentialPassRenderTargets=[],this._voxelPassRenderTargets=[],this._pyramidRenderTargets=[],this.geometry=new dx,this.geometry.drawRange.count=0,this.spatialPassUniforms={span:{value:-1},shapesDataTexture:this.shapesDataTexture,npart:{value:this.npart},spatialn:{value:this.spatialn}},this.spatialMesh=new Cx(PZ,this.spatialPassMaterial()),this.spatialMesh.frustumCulled=!1,this.spatialscene.add(this.spatialMesh);let i=new FD(BZ.triTable,16,256,_g,vg);i.needsUpdate=!0;let r=new FD(BZ.numTrisTable,256,1,_g,vg);r.needsUpdate=!0,this.voxelPassUniforms={potentialPassTexture:{value:void 0},numTrisTable:{value:r}},this.voxelMesh=new Cx(PZ,this.voxelPassMaterial()),this.voxelMesh.frustumCulled=!1,this.voxelPassScene.add(this.voxelMesh),this.potentialPassUniforms={shapesDataTexture:this.shapesDataTexture,spatialPassTexture:{value:void 0},npart:{value:this.npart},spatialn:{value:this.spatialn}},this.potentialMesh=new Cx(PZ,this.potentialPassMaterial()),this.potentialMesh.frustumCulled=!1,this.potentialPassScene.add(this.potentialMesh),this.marchPassUniforms={triTable:{value:i},potentialPassTexture:{value:void 0},voxelPassTexture:{value:void 0},pyramidTexture1:{value:void 0},pyramidTexture1Size:{value:void 0},pyramidTexture2:{value:void 0},pyramidTexture2Size:{value:void 0}},this.frustumCulled=!1,this.onBeforeShadowPass=e=>{if(qZ.call(this),0===this.npart)return void(this.geometry.drawRange.count=0);let t=this.material.root;if(t.shadersPatchedForShapeBlend){if(this.customDepthMaterialNeedsUpdate){this.customDepthMaterialNeedsUpdate=!1,this.customDepthMaterial=new Ix({vertexShader:t.vertexShader,fragmentShader:"\n\t\t\t\t\t\t#include <packing>\n\t\t\t\t\t\tvoid main()\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tgl_FragColor = packDepthToRGBA(gl_FragCoord.z);\n\t\t\t\t\t\t}\n\t\t\t\t\t",uniforms:t.uniforms,defines:this.material.defines}),this.isMeshDepthMaterial=!0,this.customDistanceMaterial=new Ix({vertexShader:t.vertexShader,fragmentShader:"\n\t\t\t\t\t#include <common>\n\t\t\t\t\t#include <packing>\n\t\t\t\t\tuniform vec3 referencePosition;\n\t\t\t\t\tuniform float nearDistance;\n\t\t\t\t\tuniform float farDistance;\n\t\t\t\t\t// World-space position\n\t\t\t\t\tvarying vec3 vWPosition;\n\t\t\t\t\tvoid main()\n\t\t\t\t\t{\n\t\t\t\t\t\tfloat dist = length(vWPosition - referencePosition);\n\t\t\t\t\t\tdist = (dist - nearDistance) / (farDistance - nearDistance);\n\t\t\t\t\t\tdist = saturate(dist);\n\t\t\t\t\t\t// Required by Three.js for this to work\n\t\t\t\t\t\tgl_FragColor = packDepthToRGBA( dist );\n\t\t\t\t\t}",uniforms:d({nearDistance:{value:0},farDistance:{value:0},referencePosition:{value:new Lv},opacity:{value:0}},t.uniforms),defines:this.material.defines});let e=this.customDistanceMaterial;e.referencePosition=new Lv,e.nearDistance=0,e.farDistance=0,e.opacity=1,e.isMeshDistanceMaterial=!0}}else this.patchVertexShaderForShapeBlend(t),t.shadersPatchedForShapeBlend=!0,this.customDepthMaterialNeedsUpdate=!0;if(this.spatialPassUniforms.npart.value=this.npart,this.spatialPassUniforms.spatialn.value=this.spatialn,this.potentialPassUniforms.npart.value=this.npart,this.potentialPassUniforms.spatialn.value=this.spatialn,this.needsRebuild){this.needsRebuild=!1,this.spatialMesh.material.defines.RES=this.resolutionLevel,this.spatialMesh.material.needsUpdate=!0,this.potentialMesh.material.defines.RES=this.resolutionLevel,this.potentialPassUniforms.spatialPassTexture.value=this.spatialPassRenderTarget.texture,this.potentialMesh.material.needsUpdate=!0,this.voxelMesh.material.defines.RES=this.resolutionLevel,this.voxelMesh.material.needsUpdate=!0,this.voxelPassUniforms.potentialPassTexture.value=this.potentialPassRenderTarget.texture,this.marchPassUniforms.potentialPassTexture.value=this.potentialPassRenderTarget.texture,this.marchPassUniforms.voxelPassTexture.value=this.voxelPassRenderTarget.texture[0],this.material.defines.RES=this.resolutionLevel,this.material.defines.LEVELS=this.pyramidLevelSizes.length,this.material.defines.LOOP=this.pyramidLevelSizes.length%2===0?this.pyramidLevelSizes.length-3:this.pyramidLevelSizes.length-2,this.material.defines.HALF=this.pyramidLevelSizes.length%2===0?1:0,this.material.needsUpdate=!0;let e=this.pyramidLevelSizes.length%2===0?0:1,t=this.pyramidLevelSizes.length%2===0?1:0;this.marchPassUniforms.pyramidTexture2.value=this.pyramidRenderTarget[e].texture,this.marchPassUniforms.pyramidTexture2Size.value=new lv(this.pyramidRenderTarget[e].width,this.pyramidRenderTarget[e].height),this.marchPassUniforms.pyramidTexture1.value=this.pyramidRenderTarget[t].texture,this.marchPassUniforms.pyramidTexture1Size.value=new lv(this.pyramidRenderTarget[t].width,this.pyramidRenderTarget[t].height),Object.assign(this.material.uniforms,this.marchPassUniforms)}let n=e.shadowMap.enabled;e.shadowMap.enabled=!1;let i=e.getRenderTarget();e.setRenderTarget(this.spatialPassRenderTarget),e.render(this.spatialscene,OZ),e.setRenderTarget(this.potentialPassRenderTarget),e.render(this.potentialPassScene,OZ),e.setRenderTarget(this.voxelPassRenderTarget),e.render(this.voxelPassScene,OZ),RZ.streamCompaction.renderPyramid(this.resolutionLevel,this.pyramidLevelSizes,e,this.voxelPassRenderTarget,this.pyramidRenderTarget).then((e=>{this.material.wireframe&&(3*e>this.geometry.attributes.position.count||this.drawRangeNeedsForceUpdate)&&(this.geometry.dispose(),this.geometry=new dx,this.geometry.userData.parameters={width:this.bboxSize,height:this.bboxSize,depth:this.bboxSize,centerOffset:[this.bboxOffset,this.bboxOffset,this.bboxOffset]},this.geometry.attributes.position=new tx(new Float32Array(3*e*2),3)),(3*e>this.geometry.drawRange.count||this.drawRangeNeedsForceUpdate)&&(this.geometry.drawRange.count=3*Math.floor(1.2*e)),this.drawRangeNeedsForceUpdate=!1})),e.shadowMap.enabled=n,e.setRenderTarget(i)}}set npart(e){e!==this._npart&&(this.drawRangeNeedsForceUpdate=!0,this._npart=e,this.spatialn=Math.ceil(e/96))}get npart(){return this._npart}set resolutionLevel(e){let t=Math.min(8,Math.max(5,e));if(t!==this._resolutionLevel){switch(this._resolutionLevel=t,this.resolution=Math.pow(2,t),this.resolutionLevel){case 5:this.pyramidLevelSizes=[1,2,4,6,12,24,48,96,192],this.bboxSize=496,this.bboxOffset=-8;break;case 6:this.pyramidLevelSizes=[1,2,4,8,16,32,64,128,256,512],this.bboxSize=504,this.bboxOffset=-4;break;case 7:this.pyramidLevelSizes=[1,2,4,6,12,24,48,96,192,384,768,1536],this.bboxSize=508,this.bboxOffset=-2;break;case 8:this.pyramidLevelSizes=[1,2,4,8,16,32,64,128,256,512,1024,2048,4096],this.bboxSize=510,this.bboxOffset=-1}this.pyramidTexture1Width=0,this.pyramidTexture2Width=0,this.pyramidTexture1Height=this.pyramidLevelSizes[this.pyramidLevelSizes.length-2],this.pyramidTexture2Height=this.pyramidLevelSizes[this.pyramidLevelSizes.length-3];for(let e=this.pyramidLevelSizes.length-2;e>=0;e--)(this.pyramidLevelSizes.length-2)%2===e%2?this.pyramidTexture1Width+=this.pyramidLevelSizes[e]:this.pyramidTexture2Width+=this.pyramidLevelSizes[e];this.basePyramidSize=this.pyramidLevelSizes[this.pyramidLevelSizes.length-1],this.zLayersPerRow=this.basePyramidSize/this.resolution,this.numLevels=this.pyramidLevelSizes.length-1,this.geometry.userData.parameters={width:this.bboxSize,height:this.bboxSize,depth:this.bboxSize,centerOffset:[this.bboxOffset,this.bboxOffset,this.bboxOffset]},this.needsRebuild=!0}}get resolutionLevel(){return this._resolutionLevel}get spatialPassRenderTarget(){let e=this._spatialPassRenderTargets[this.resolutionLevel];return e||(e=new Iv(this.spatialDivisions*this.spatialn,this.spatialDivisions**2,{format:bg,type:vg,stencilBuffer:!1,depthBuffer:!1,generateMipmaps:!1,minFilter:ug,magFilter:ug}),this._spatialPassRenderTargets[this.resolutionLevel]=e),e}get potentialPassRenderTarget(){let e=this._potentialPassRenderTargets[this.resolutionLevel];return e||(e=new Iv(this.basePyramidSize,this.basePyramidSize,{format:bg,type:vg,stencilBuffer:!1,depthBuffer:!1,generateMipmaps:!1,minFilter:ug,magFilter:ug}),this._potentialPassRenderTargets[this.resolutionLevel]=e),e}get voxelPassRenderTarget(){let e=this._voxelPassRenderTargets[this.resolutionLevel];return e||(e=new Bv(this.basePyramidSize,this.basePyramidSize,2,{stencilBuffer:!1,depthBuffer:!1,generateMipmaps:!1,minFilter:ug,magFilter:ug}),e.texture[0].format=bg,e.texture[0].type=vg,e.texture[1].format=_g,e.texture[1].type=vg,this._voxelPassRenderTargets[this.resolutionLevel]=e),e}get pyramidRenderTarget(){let e=this._pyramidRenderTargets[this.resolutionLevel];if(!e){e=[new Iv(this.pyramidTexture1Width,this.pyramidTexture1Height,{format:bg,type:vg,stencilBuffer:!1,depthBuffer:!1,magFilter:ug,minFilter:ug}),new Iv(this.pyramidTexture2Width,this.pyramidTexture2Height,{format:bg,type:vg,stencilBuffer:!1,depthBuffer:!1,magFilter:ug,minFilter:ug})],this._pyramidRenderTargets[this.resolutionLevel]=e}return e}updateState(e,t){let n=this.material;super.updateState(e,t),n!==this.material&&(this.needsRebuild=!0),e.geometry&&(this.resolutionLevel=e.geometry.resolutionLevel,this.geometry.userData.parameters={width:this.bboxSize,height:this.bboxSize,depth:this.bboxSize,centerOffset:[this.bboxOffset,this.bboxOffset,this.bboxOffset]}),e.wireframe&&!this.geometry.getAttribute("position")?this.geometry.setAttribute("position",new tx(new Float32Array(3*this.geometry.drawRange.count),3)):!e.wireframe&&this.geometry.getAttribute("position")&&this.geometry.deleteAttribute("position")}spatialPassMaterial(){let e="\n\t\t\tprecision highp float;\n\t\t\tout vec4 pc_FragColor;\n\t\t\tconst float spatialDivisions = ".concat(this.spatialDivisions,".;\n\t\t\tuniform float span;\n\t\t\tuniform float npart;\n\t\t\tuniform float spatialn;\n\t\t\t").concat(BZ.shapeInput(),"\n\n\t\t\tvec3 low, high;     // range of current div; subset of -1 .. 1 with span border\n\n\t\t\t// lookup one element/channel's worth of spheres for current division\n\t\t\t// stating with low sphere number lowi\n\t\t\t// gives a key to which spheres from lowi..lowi+23 are active within given div (low..high)\n\t\t\tfloat spatialKey(float lowi) {\n\t\t\t\tfloat t = 0.;\n\t\t\t\tfor (float ii = ").concat(23,".; ii >= 0.; ii--) {\n\t\t\t\t\tfloat i = ii + lowi;\n\t\t\t\t\tfloat iin = (i + 0.5) / ").concat(kZ,".;\n\t\t\t\t\tvec4 shape = shapePos(iin);\n\t\t\t\t\tvec3 d = shape.xyz;\n\t\t\t\t\tfloat op = shape.w;\n\t\n\t\t\t\t\tt *= 2.;\n\t\t\t\t\tt += (\n\t\t\t\t\t\tlow.x < d.x && d.x < high.x &&\n\t\t\t\t\t\tlow.y < d.y && d.y < high.y &&\n\t\t\t\t\t\tlow.z < d.z && d.z < high.z &&\n\t\t\t\t\t\ti < npart || op == -2. // always include if op is -2, which is the intersection operation\n\t\t\t\t\t) ? 1. : 0.;\n\t\t\t\t}\n\t\t\t\treturn t;\n\t\t\t}\n\n\t\t\t").concat(BZ.getpart,"\n\n\t\t\tvoid main() {               // spatialial fragment shader\n\t\t\t\t// find active div\n\t\t\t\tvec3 div;                               // which div is current\n\t\t\t\t// out holds x=> x, lowi faster moving and y=> z, y faster moving\n\t\t\t\tfloat yz = float(gl_FragCoord.y - 0.5);     // contains  z, y faster moving\n\t\t\t\tdiv.y = getpart(yz, spatialDivisions);\n\t\t\t\tdiv.z = yz; // getpart(yz, spatialDivisions.z); // what's left, should be the same as getpart\n\n\t\t\t\tfloat lx = float(gl_FragCoord.x - 0.5);     // contains x, lowi faster moving\n\t\t\t\tfloat lowi = getpart(lx, spatialn) * ").concat(96,".;\n\t\t\t\tdiv.x = lx;\n\n\t\t\t\tlow = div / spatialDivisions * 2. - 1. - span;\n\t\t\t\thigh = (div+1.) / spatialDivisions * 2. - 1. + span;\n\n\t\t\t\t// find active range of spheres\n\t\t\t\tpc_FragColor.x = spatialKey(lowi);\n\t\t\t\tpc_FragColor.y = spatialKey(lowi+").concat(IZ,".);\n\t\t\t\tpc_FragColor.z = spatialKey(lowi+").concat(48,".);\n\t\t\t\tpc_FragColor.w = spatialKey(lowi+").concat(72,".);\n\t\t\t}\n\t\t");return new FZ({name:"Spatial Pass",fragmentShader:e,uniforms:this.spatialPassUniforms})}potentialPassMaterial(){let e="\n\t\t\tprecision highp float;\n\t\t\tout vec4 pc_FragColor;\n\n\t\t\t".concat(BZ.shapeInput(),"\n\t\t\tuniform sampler2D spatialPassTexture;\n\n\t\t\tconst float res = float(RES);\n\t\t\tconst float VOXEL_RESOLUTION = pow(2., res);\n\t\t\tconst float Z_LAYERS_PER_ROW = ceil(pow(2., res / 2.));\n\t\t\tconst float VOXEL_RESOLUTION_SUB1 = VOXEL_RESOLUTION - 1.;\n\t\t\tconst float INV_VOXEL_RESOLUTION = 1.0 / VOXEL_RESOLUTION;\n\n\t\t\tuniform float npart;\n\t\t\tuniform float spatialn;\n\t\t\tconst float spatialDivisions = ").concat(this.spatialDivisions,".;\n\t\t\tconst float spatialDivisions2 = spatialDivisions * spatialDivisions;\n\t\t\tconst float spatialDivisionsSub1 = spatialDivisions - 1.;\n\n\t\t\t").concat(BZ.getpart,"\n\n\t\t\tvec3 packRGBAToVec3(vec4 color) {\n\t\t\t\tuint r = uint(color.r * 255.);\n\t\t\t\tuint g = uint(color.g * 255.);\n\t\t\t\tuint combined = (r << 8) | g; \n\t\t\t\treturn vec3(float(combined) * 0.00001525902, color.b, color.a); // 1/65535\n\t\t\t}\n\n\t\t\tvoid applyQuaternionToVector(in vec4 q, inout vec3 v) {\n\t\t\t\tv += 2.0 * cross(q.xyz, cross(q.xyz, v) + q.w * v);\n\t\t\t}\n\n\t\t\t/**\n\t\t\t * SDF functions (reference: https://iquilezles.org/articles/distfunctions/)\n\t\t\t */\n\n\t\t\t// branchless version of \"Smooth Union, Subtraction and Intersection - bound, bound, bound\" in above reference\n\t\t\tfloat smoothOperation(float op, float sdf, float d, float k) {\n\t\t\t  //        union: op =  1 => signSubtract =  1, signIntersection =  1\n\t\t\t  //     subtract: op = -1 => signSubtract = -1, signIntersection =  1\n\t\t\t\t// intersection: op = -2 => signSubtract = -1, signIntersection = -1\n\n\t\t\t\tfloat signSubtract = clamp(op, -1., 1.);\n\t\t\t\tfloat signIntersection = 2. * (op - signSubtract) + 1.;\n\t\t\t\tfloat h = clamp(\n\t\t\t\t\t0.5 + signSubtract * 0.5 * (sdf - signSubtract * signIntersection * d) / k,\n\t\t\t\t\t0.0,\n\t\t\t\t\t1.0\n\t\t\t\t);\n\t\t\t\treturn mix(sdf, signSubtract * signIntersection * d, h) - \n\t\t\t\t\t\t\t signSubtract * k * h * (1.0 - h);\n\t\t\t}\n\n\t\t\tfloat sdSphere( vec3 p, float s )\n\t\t\t{\n\t\t\t\treturn length(p)-s;\n\t\t\t}\n\n\t\t\tfloat sdEllipsoid( vec3 p, vec3 r )\n\t\t\t{\n\t\t\t\tfloat k0 = length(p/r);\n\t\t\t\tfloat k1 = length(p/(r*r));\n\t\t\t\treturn k0*(k0-1.0)/k1;\n\t\t\t}\n\n\t\t\tfloat sdBox( vec3 p, vec3 b )\n\t\t\t{\n\t\t\t\tvec3 q = abs(p) - b;\n\t\t\t\treturn length(max(q,0.0)) + min(max(q.x,max(q.y,q.z)),0.0);\n\t\t\t}\n\n\t\t\tfloat sdTorus( vec3 p, vec2 t )\n\t\t\t{\n\t\t\t\tvec2 q = vec2(length(p.xy)-t.x,p.z);\n\t\t\t\treturn length(q)-t.y;\n\t\t\t}\n\n\t\t\tfloat sdCappedTorus( vec3 p, vec2 sc, float ra, float rb)\n\t\t\t{\n\t\t\t\tp.x = abs(p.x);\n\t\t\t\tfloat k = (sc.y*p.x>sc.x*p.y) ? dot(p.xy,sc) : length(p.xy);\n\t\t\t\treturn sqrt( dot(p,p) + ra*ra - 2.0*ra*k ) - rb;\n\t\t\t}\n\n\t\t\tfloat dot2( in vec2 v ) { return dot(v,v); }\n\t\t\tfloat sdCappedCone( vec3 p, float h, float r1, float r2 )\n\t\t\t{\n\t\t\t\tvec2 q = vec2( length(p.xz), p.y );\n\t\t\t\tvec2 k1 = vec2(r2,h);\n\t\t\t\tvec2 k2 = vec2(r2-r1,2.0*h);\n\t\t\t\tvec2 ca = vec2(q.x-min(q.x,(q.y<0.0)?r1:r2), abs(q.y)-h);\n\t\t\t\tvec2 cb = q - k1 + k2*clamp( dot(k1-q,k2)/dot2(k2), 0.0, 1.0 );\n\t\t\t\tfloat s = (cb.x<0.0 && ca.y<0.0) ? -1.0 : 1.0;\n\t\t\t\treturn s*sqrt( min(dot2(ca),dot2(cb)) );\n\t\t\t}\n\n\t\t\tfloat sdCappedCylinder( vec3 p, float h, float r )\n\t\t\t{\n\t\t\t\tvec2 d = abs(vec2(length(p.xz),p.y)) - vec2(r,h);\n\t\t\t\treturn min(max(d.x,d.y),0.0) + length(max(d,0.0));\n\t\t\t}\n\n\t\t\tfloat maxBlend = 0.0;\n\t\t\t// compute potential from A (=24) spheres, using the bit flags in 'activeKey'\n\t\t\t// to avoid lookup/compute for inactive spheres\n\t\t\t// return field potential, side effect updates track,\n\t\t\t// compute and return +ve and -ve values separately\n\t\t\tvoid fillSpatialInner(\n\t\t\t\tfloat ii,\n\t\t\t\tfloat activeKey,\n\t\t\t\tvec3 corner,\n\t\t\t\tinout float sdf,\n\t\t\t\tinout float colorDivisor,\n\t\t\t\tinout vec4 trackColor\n\t\t\t) {\n\t\t\t\tfor (float i = 0.; i < ").concat(IZ,".; i++) {\n\t\t\t\t\tif (activeKey < 1.) break; // activeKey exhausted, no more active spheres\n\t\t\t\t\tactiveKey *= 0.5;\n\t\t\t\t\tif (fract(activeKey) < 0.5) continue;\n\n\t\t\t\t\tfloat iin = (i + ii + 0.5) * ").concat(1/kZ,";\n\t\t\t\t\tvec4 shape = shapePos(iin);\n\t\t\t\t\tvec4 quat = shapeQuat(iin);\n\t\t\t\t\tvec4 params1 = shapeParams1(iin);\n\t\t\t\t\tvec4 params2 = shapeParams2(iin);\n\n\t\t\t\t\tvec3 p = corner - shape.xyz;\n\t\t\t\t\tapplyQuaternionToVector(quat, p);\n\t\t\t\t\tp /= params2.z; // scale\n\t\t\t\t\tfloat d; // d in -1..1 coordinates\n\t\t\t\t\tswitch (int(params1.x)) {\n\t\t\t\t\t\tcase 0: d = sdSphere(p, params1.y); break;\n\t\t\t\t\t\tcase 1: d = sdEllipsoid(p, params1.yzw); break;\n\t\t\t\t\t\tcase 2: d = sdBox(p, params1.yzw); break;\n\t\t\t\t\t\tcase 3: d = sdCappedCylinder(p, params1.y, params1.z); break;\n\t\t\t\t\t\tcase 4: d = sdCappedCone(p, params1.y, params1.z, params1.w); break;\n\t\t\t\t\t\tcase 5: d = sdTorus(p, params1.yz); break;\n\t\t\t\t\t\tcase 6: d = sdCappedTorus(p, params1.yz, params1.w, params2.w); break;\n\t\t\t\t\t}\n\t\t\t\t\td -= params2.y; // rounded edge\n\t\t\t\t\td *= params2.z; // scale\n\n\t\t\t\t\tfloat k = params2.x;\n\t\t\t\t\tfloat op = shape.w;\n\n\t\t\t\t\tsdf = smoothOperation(shape.w, sdf, d, k);\n\n\t\t\t\t\tfloat isNegativeOne = step(-1.5, op) * step(op, -0.5); // 1 when op == -1, 0 otherwise\n\t\t\t\t\tfloat colorCull = smoothstep(maxBlend, 0., -d);\n\t\t\t\t\tfloat cullFactor = mix(1.0, colorCull, isNegativeOne);\n\t\t\t\t\ttrackColor *= cullFactor;\n\t\t\t\t\tcolorDivisor *= cullFactor;\n\n\t\t\t\t\tmaxBlend = max(maxBlend, k);\n\n\t\t\t\t\tk += 2. * INV_VOXEL_RESOLUTION; // avoid division by zero, and other color artifacts with very small k\n\t\t\t\t\tfloat nearness = smoothstep(k, 0., d);\n\n\t\t\t\t\tvec4 color = shapeColor(iin);\n\t\t\t\t\tnearness *= float(color.a >= 0.);\n\n\t\t\t\t\tcolorDivisor += nearness;\n\t\t\t\t\ttrackColor += color * nearness;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tvec3 div;\n\t\t\t// compute potential from all spheres; collect +ve and =ve values separately\n\t\t\t// work in blocks of A*4 (=96) spheres, using the bit flags in 4 float channel 'activeKey' values\n\t\t\t// TODO check if extra vec3 output useful, not really used at present\n\t\t\tfloat fillSpatial(vec3 corner, inout vec4 trackColor) {\n\t\t\t\tfloat sdf = 1e3; // hack: initialize to large value\n\t\t\t\tfloat colorDivisor = 0.;\n\t\t\t\t// spatialPassTexture holds x=> lowi, x faster moving and y=> z, y faster moving\n\t\t\t\tfloat divyz = (div.y + div.z * spatialDivisions + 0.5) / (spatialDivisions2);\n\t\t\t\tfor (float ii = 0.; ii < spatialn; ii++) {\n\t\t\t\t\tfloat i = ii * ").concat(96,".;\n\n\t\t\t\t\tvec4 activeKey = texture(spatialPassTexture, vec2((div.x * spatialn + ii + 0.5)/(spatialn * spatialDivisions), divyz));\n\t\t\t\t\tfillSpatialInner(i, activeKey.x, corner, sdf, colorDivisor, trackColor);\n\t\t\t\t\tfillSpatialInner(i+").concat(IZ,"., activeKey.y, corner, sdf, colorDivisor, trackColor);\n\t\t\t\t\tfillSpatialInner(i+").concat(48,"., activeKey.z, corner, sdf, colorDivisor, trackColor);\n\t\t\t\t\tfillSpatialInner(i+").concat(72,"., activeKey.w, corner, sdf, colorDivisor, trackColor);\n\t\t\t\t}\n\n\t\t\t\ttrackColor /= colorDivisor;\n\t\t\t\treturn mix(sdf, 0.0, step(1e20 - 0.1, sdf));\n\t\t\t}\n\n\t\t\tvoid main() {\n\t\t\t\t").concat(BZ.getxyzi,"    // get xi yi zi from 2d position\n\n\t\t\t\tvec3 xyzi = vec3(xi,yi,zi);\n\t\t\t\tvec3 corner = xyzi / VOXEL_RESOLUTION_SUB1 * 2. - 1.;  // -1..1 coords\n\n\t\t\t\tdiv = floor(xyzi / VOXEL_RESOLUTION_SUB1 * spatialDivisionsSub1);\n\n\t\t\t\tvec4 c = vec4(0.);\n\t\t\t\tfloat t = fillSpatial(corner, c);\n\n\t\t\t\tpc_FragColor = vec4(t, packRGBAToVec3(c)); // RGB texture\n\t\t\t}\n\t\t");return new FZ({name:"PotentialPass",fragmentShader:e,uniforms:this.potentialPassUniforms})}voxelPassMaterial(){let e="\n\t\t\tprecision highp float;\n\t\t\tlayout(location = 0) out vec4 pc_FragColor;\n\t\t\tlayout(location = 1) out vec4 numTris;\n\n\t\t\tconst float res = float(RES);\n\t\t\tconst float VOXEL_RESOLUTION = pow(2., res);\n\t\t\tconst float VOXEL_RESOLUTION_SUB1 = VOXEL_RESOLUTION - 1.; \n\t\t\tconst float Z_LAYERS_PER_ROW = ceil(pow(2., res / 2.));\n\t\t\tconst float INV_VOXEL_RESOLUTION = 1.0 / VOXEL_RESOLUTION;\n\t\t\tuniform sampler2D numTrisTable; // 256 x 1\n\n\t\t\tfloat keyi(float f000, float f100, float f010, float f110, float f001, float f101, float f011, float f111) {\n\t\t\t\treturn (float(f000 < 0.) * 1.) +\n\t\t\t\t\t\t\t (float(f100 < 0.) * 2.) +\n\t\t\t\t\t\t\t (float(f010 < 0.) * 8.) +\n\t\t\t\t\t\t\t (float(f110 < 0.) * 4.) +\n\t\t\t\t\t\t\t (float(f001 < 0.) * 16.) +\n\t\t\t\t\t\t\t (float(f101 < 0.) * 32.) +\n\t\t\t\t\t\t\t (float(f011 < 0.) * 128.) +\n\t\t\t\t\t\t\t (float(f111 < 0.) * 64.);\n\t\t\t}\n\n\t\t\t".concat(BZ.lookup,"\n\n\t\t\tvec3 compNormi(float xi, float yi, float zi) {\n\t\t\t\tfloat dx = look(xi + 1., yi, zi, potentialPassTexture).r - look(xi - 1., yi, zi, potentialPassTexture).r;\n\t\t\t\tfloat dy = look(xi, yi + 1., zi, potentialPassTexture).r - look(xi, yi - 1., zi, potentialPassTexture).r;\n\t\t\t\tfloat dz = look(xi, yi, zi + 1., potentialPassTexture).r - look(xi, yi, zi - 1., potentialPassTexture).r;\n\t\t\t\t// if we allow (common) 0,0,0 case through then NaN can spread\n\t\t\t\t// eg r = vec4(compNorm i(???), 1.) will pollute r.w\n\t\t\t\tif (dx == 0.0 && dy == 0.0 && dz == 0.0) {\n\t\t\t\t\treturn vec3(0.199, 0.299, 0.399);\n\t\t\t\t}\n\t\t\t\treturn normalize(vec3(dx, dy, dz));\n\t\t\t}\n\n\t\t\tvoid main() {\n\t\t\t\t").concat(BZ.getxyzi,"    // get xi yi zi from 2d\n\n\t\t\t\tvec3 normal = compNormi(xi, yi, zi);  // even if our key is -1 this may be needed by a neighbouring voxel\n\n\t\t\t\tif (xi >= VOXEL_RESOLUTION_SUB1 || yi >= VOXEL_RESOLUTION_SUB1 || zi >= VOXEL_RESOLUTION_SUB1) {\n\t\t\t\t\tpc_FragColor = vec4(normal, 0.);\n\t\t\t\t\tnumTris = vec4(0.);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tfloat\n\t\t\t\t\tf000 = look(xi, yi, zi, potentialPassTexture).r,\n\t\t\t\t\tf100 = look(xi+1., yi, zi, potentialPassTexture).r,\n\t\t\t\t\tf010 = look(xi, yi+1., zi, potentialPassTexture).r,\n\t\t\t\t\tf110 = look(xi+1., yi+1., zi, potentialPassTexture).r,\n\t\t\t\t\tf001 = look(xi, yi, zi+1., potentialPassTexture).r,\n\t\t\t\t\tf101 = look(xi+1., yi, zi+1., potentialPassTexture).r,\n\t\t\t\t\tf011 = look(xi, yi+1., zi+1., potentialPassTexture).r,\n\t\t\t\t\tf111 = look(xi+1., yi+1., zi+1., potentialPassTexture).r;\n\t\t\t\tfloat key = keyi(f000, f100, f010, f110, f001, f101, f011, f111);\n\n\t\t\t\tpc_FragColor = vec4(normal, key);\n\n\t\t\t\tnumTris = texture(numTrisTable, vec2((key + 0.5) / 256., 0.5));\n\t\t\t}\n\t\t");return new FZ({name:"VoxelPass",fragmentShader:e,uniforms:this.voxelPassUniforms})}patchVertexShaderForShapeBlend(e){let t="\n\t\t#ifdef SHAPEBLEND \n\t\t\tprecision highp sampler2D;\n\n\t\t\tuniform float isol;\n\n\t\t\tuniform sampler2D triTable;     // 256 x 16\n\t\t\tuniform sampler2D pyramidTexture1;\n\t\t\tuniform vec2 pyramidTexture1Size;\n\t\t\tuniform sampler2D pyramidTexture2;\n\t\t\tuniform vec2 pyramidTexture2Size;\n\n\t\t\tconst vec2 halfPixelOffset = vec2(0.5, 0.5);\n\n\t\t\tconst vec2 rShift = vec2(0., 1.);\n\t\t\tconst vec2 gShift = vec2(1., 1.);\n\t\t\tconst vec2 bShift = vec2(1., 0.);\n\n\t\t\tconst float res = float(RES);\n\t\t\tconst float VOXEL_RESOLUTION = pow(2., res);\n\t\t\tconst float Z_LAYERS_PER_ROW = ceil(pow(2., res / 2.));\n\t\t\tconst float INV_VOXEL_RESOLUTION = 1.0 / VOXEL_RESOLUTION;\n\n\t\t\tconst float scale_factor = ".concat(2,".;\n\n\t\t\t#if SHAPEBLEND == 5\n\t\t\t\tconst float levelShiftX[7] = float[7](4., 6., 12., 24., 48., 96., 192.);\n\t\t\t\tconst float scale = 8. * scale_factor;\n\t\t\t\tconst vec3 originOffset = vec3(16.);\n\t\t\t#elif SHAPEBLEND == 7\n\t\t\t\tconst float levelShiftX[10] = float[10](4., 6., 12., 24., 48., 96., 192., 384., 768., 1536.); \n\t\t\t\tconst float scale = 2. * scale_factor;\n\t\t\t\tconst vec3 originOffset = vec3(64.);\n\t\t\t#elif SHAPEBLEND == 8\n\t\t\t\tconst float levelShiftX[11] = float[11](4., 8., 16., 32., 64., 128., 256., 512., 1024., 2048., 4096.);\n\t\t\t\tconst float scale = scale_factor;\n\t\t\t\tconst vec3 originOffset = vec3(128.);\n\t\t\t#else\n\t\t\t\tconst float levelShiftX[8] = float[8](4., 8., 16., 32., 64., 128., 256., 512.);\n\t\t\t\tconst float scale = 4. * scale_factor;\n\t\t\t\tconst vec3 originOffset = vec3(32.);\n\t\t\t#endif\n\n\t\t\t").concat(BZ.lookup,"\n\n\t\t\tconst vec3 offsets[24] = vec3[](\n\t\t\t\tvec3(0., 0., 0.), vec3(1., 0., 0.),\n\t\t\t\tvec3(1., 0., 0.), vec3(1., 1., 0.),\n\t\t\t\tvec3(0., 1., 0.), vec3(1., 1., 0.),\n\t\t\t\tvec3(0., 0., 0.), vec3(0., 1., 0.),\n\t\t\t\tvec3(0., 0., 1.), vec3(1., 0., 1.),\n\t\t\t\tvec3(1., 0., 1.), vec3(1., 1., 1.),\n\t\t\t\tvec3(0., 1., 1.), vec3(1., 1., 1.),\n\t\t\t\tvec3(0., 0., 1.), vec3(0., 1., 1.),\n\t\t\t\tvec3(0., 0., 0.), vec3(0., 0., 1.),\n\t\t\t\tvec3(1., 0., 0.), vec3(1., 0., 1.),\n\t\t\t\tvec3(1., 1., 0.), vec3(1., 1., 1.),\n\t\t\t\tvec3(0., 1., 0.), vec3(0., 1., 1.)\n\t\t\t);\n\n\t\t\tvec2 computeShiftedPosition1(vec2 xy, float levelOriginX) {\n\t\t\t\tvec2 xyShifted = xy;\n\t\t\t\txyShifted.x += levelOriginX;\n\t\t\t\treturn (xyShifted + halfPixelOffset) / pyramidTexture1Size;\n\t\t\t}\n\n\t\t\tvec2 computeShiftedPosition2(vec2 xy, float levelOriginX) {\n\t\t\t\tvec2 xyShifted = xy;\n\t\t\t\txyShifted.x += levelOriginX;\n\t\t\t\treturn (xyShifted + halfPixelOffset) / pyramidTexture2Size;\n\t\t\t}\n\n\t\t\tvec4 unpackVec3ToRGBA(vec3 vec) {\n\t\t\t\tuint combined = uint(vec.x * 65535.0 + 0.5); // Add 0.5 for rounding\n\t\t\t\tfloat g = float(combined & uint(0xFF)) * 0.00392156862; // 1/255\n\t\t\t\tfloat r = float((combined >> 8) & uint(0xFF)) * 0.00392156862; \n\t\t\n\t\t\t\treturn vec4(r, g, vec.y, vec.z);\n\t\t\t}\n\n\t\t\tout vec4 marchColor;\n\t\t\t// end of marchvertPre\n\t\t#endif\n\t\t");e.vertexShader=t+e.vertexShader.replace("#include <project_vertex>","\n\t\t#ifdef SHAPEBLEND\n\t\t\tfloat triIndex = floor(float(gl_VertexID/3));\n\t\t\tfloat vertexIndex = float(gl_VertexID);\n\t\t\t\n\t\t\t// Initial pyramid lookup\n\t\t\tfloat levelOriginX1 = pyramidTexture1Size.x - 2.;\n\t\t\tfloat levelOriginX2 = pyramidTexture2Size.x - 1.;\n\t\t\tvec2 xy = vec2(0.);\n\t\t\tvec4 lookUp = texture(pyramidTexture2, computeShiftedPosition2(xy, levelOriginX2));\n\t\t\t\n\t\t\t// Early exit check\n\t\t\tif (triIndex >= lookUp.r) return;\n\t\t\t\n\t\t\t// Optimize loop variables\n\t\t\tfloat start = 0.;\n\t\t\tvec4 triIndexVec = vec4(triIndex);\n\t\t\t\n\t\t\t// Main position computation loop\n\t\t\tfor (int i = 0; i < LOOP;) {\n\t\t\t\t// Compute boundaries\n\t\t\t\tvec4 ends = lookUp + vec4(start);\n\t\t\t\tvec4 starts = vec4(ends.gba, start);\n\t\t\t\tvec4 check = vec4(greaterThanEqual(triIndexVec, starts)) * \n\t\t\t\t\t\t\t\t\t\t\tvec4(lessThan(triIndexVec, ends));\n\t\t\t\t\n\t\t\t\t// Update position\n\t\t\t\txy *= 2.;\n\t\t\t\txy += check.r * rShift + check.g * gShift + check.b * bShift;\n\t\t\t\t\n\t\t\t\t// Update loop variables\n\t\t\t\tstart = dot(check, starts);\n\t\t\t\tlevelOriginX2 -= levelShiftX[i];\n\t\t\t\t\n\t\t\t\t// Update lookup\n\t\t\t\tlookUp = texture(pyramidTexture1, computeShiftedPosition1(xy, levelOriginX1));\n\t\t\t\ti++;\n\n\t\t\t\tends = lookUp + vec4(start);\n\t\t\t\tstarts = vec4(ends.gba, start);\n\t\t\t\tcheck = vec4(greaterThanEqual(triIndexVec, starts)) * \n\t\t\t\t\t\t\t\t\t\t\tvec4(lessThan(triIndexVec, ends));\n\t\t\t\t\n\t\t\t\t// Update position\n\t\t\t\txy *= 2.;\n\t\t\t\txy += check.r * rShift + check.g * gShift + check.b * bShift;\n\t\t\t\t\n\t\t\t\t// Update loop variables\n\t\t\t\tstart = dot(check, starts);\n\t\t\t\tlevelOriginX1 -= levelShiftX[i];\n\t\t\t\t\n\t\t\t\t// Update lookup\n\t\t\t\tlookUp = texture(pyramidTexture2, computeShiftedPosition2(xy, levelOriginX2));\n\n\t\t\t\ti++;\n\t\t\t}\n\n\t\t\t#if HALF == 1\n\t\t\t\tvec4 ends = lookUp + vec4(start);\n\t\t\t\tvec4 starts = vec4(ends.gba, start);\n\t\t\t\tvec4 check = vec4(greaterThanEqual(triIndexVec, starts)) * vec4(lessThan(triIndexVec, ends));\n\t\t\t\n\t\t\t\t// Update position\n\t\t\t\txy *= 2.;\n\t\t\t\txy += check.r * rShift + check.g * gShift + check.b * bShift;\n\t\t\t\n\t\t\t\t// Update loop variables\n\t\t\t\tstart = dot(check, starts);\n\t\t\t#endif\n\t\t\t\n\t\t\t// Compute final coordinates\n\t\t\tvec3 gridPos;\n\t\t\tgridPos.x = mod(xy.x, VOXEL_RESOLUTION);\n\t\t\tgridPos.y = mod(xy.y, VOXEL_RESOLUTION);\n\t\t\tgridPos.z = floor(xy.x * INV_VOXEL_RESOLUTION) + \n\t\t\t\t\t\t\t\t\tfloor(xy.y * INV_VOXEL_RESOLUTION) * Z_LAYERS_PER_ROW;\n\t\t\t\n\t\t\t// Vertex key computation\n\t\t\tvertexIndex -= start * 3.;\n\t\t\tfloat vk = vertexIndex * 0.0625 + 0.03125; // Optimized division by 16 and addition of 1/32\n\t\t\t\n\t\t\t// Voxel lookup and edge computation\n\t\t\tvec4 voxel = look(gridPos.x, gridPos.y, gridPos.z, voxelPassTexture);\n\t\t\tfloat key = (voxel.w + 0.5) * 0.00390625; // Optimized division by 256\n\t\t\t\n\t\t\t// Edge lookup and offset computation\n\t\t\tfloat edgeNum = texture(triTable, vec2(vk, key)).x;\n\t\t\tint edgeIndex = int(edgeNum) * 2;\n\t\t\t\n\t\t\t// Compute edge positions\n\t\t\tvec3 p1 = gridPos + offsets[edgeIndex];\n\t\t\tvec3 p2 = gridPos + offsets[edgeIndex + 1];\n\t\t\t\n\t\t\t// Compute potentials and normals\n\t\t\tvec4 potential1 = look(p1.x, p1.y, p1.z, potentialPassTexture);\n\t\t\tvec4 potential2 = look(p2.x, p2.y, p2.z, potentialPassTexture);\n\t\t\t\n\t\t\t// Final position and normal computation\n\t\t\tfloat mu = potential1.r / (potential1.r - potential2.r);\n\n\t\t\tmarchColor = mix(\n\t\t\t\tunpackVec3ToRGBA(potential1.gba),\n\t\t\t\tunpackVec3ToRGBA(potential2.gba),\n\t\t\t\tmu\n\t\t\t);\n\n\t\t\ttransformed = p1 + (p2 - p1) * mu;\n\t\t\ttransformed -= originOffset;\n\t\t\ttransformed *= scale;\n\t\t\tvec4 data1 = look(p1.x, p1.y, p1.z, voxelPassTexture);\n\t\t\tvec4 data2 = look(p2.x, p2.y, p2.z, voxelPassTexture);\n\t\t\tobjectNormal = normalize(mix(data1.xyz, data2.xyz, mu));\n\t\t\ttransformedNormal = normalMatrix * objectNormal;\n\t\t\t#ifndef FLAT_SHADED\n\t\t\t\tvNormal = transformedNormal;\n\t\t\t#endif\n\t\t#endif\n\t\t\n#include <project_vertex>");let n=e.fragmentShader.match(/vec3 diffuseColor[^\n]*\n/);if(!n)return;let i="\n\t\t#ifdef SHAPEBLEND_C\n\t\t\t#if SHAPEBLEND_C == 1\n\t\t\t\t".concat(n[0].replace(/nodeU0,/g,"marchColor.rgb,").replace(/nodeU\d+(?=,g_uid\d+_calpha\))/g,"marchColor.a"),"\n\t\t\t#else\n\t\t\t\t").concat(n[0],"\n\t\t\t#endif\n\t\t#else\n\t\t\t").concat(n[0],"\n\t\t#endif\n\t\t");e.fragmentShader="in vec4 marchColor;\n"+e.fragmentShader.replace(n[0],i),Object.assign(e.uniforms,this.marchPassUniforms)}initDebugPass(e){console.log("fboToDebug.width",e.width,e.height),this.geometry=new Qx(e.width,e.height),this.geometry.userData={parameters:{width:4,height:4}};let t={inputTexture:{value:Array.isArray(e.texture)?e.texture[1]:e.texture},pyramidTextureSize:{value:void 0}},n=e=>{e.vertexShader="\n\t\t\t\tprecision highp float;\n\n\t\t\t\tvarying vec2 vUv;\n\n\t\t\t\tvoid main() {\n\t\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t\t\t\t\tvUv = uv;\n\t\t\t\t}\n\t\t\t",e.fragmentShader="\n\t\t\t\tlayout(location = 1) out vec4 gVelocity;\n\n\t\t\t\tprecision highp float;\n\t\t\t\t\n\t\t\t\tuniform sampler2D inputTexture;\n\t\t\t\tvarying vec2 vUv;\n\n\t\t\t\tuniform vec2 pyramidTextureSize;\n\n\t\t\t\tvoid main() {\n\t\t\t\t\t\t// Sample the input texture using UV coordinates\n\t\t\t\t\t\tgl_FragColor = texture(inputTexture, vUv);\n\t\t\t\t\t\tgVelocity = vec4(0.0);\n\t\t\t\t}\n\t\t\t",t.pyramidTextureSize.value=new lv(this.pyramidRenderTarget.width,this.pyramidRenderTarget.height),Object.assign(e.uniforms,t)};this.material.shapeBlendhack=n,this.material.root.shapeBlendhack=n}},LZ=RZ;LZ.streamCompaction=new class{constructor(){this.pyramidPassScene=new CD,this.pyramidPassMaterial=new FZ({name:"PyramidPass"}),this.pyramidPassUniforms={inputTexture:{value:void 0},inputWidth:{value:0},inputHeight:{value:0},inputShiftX:{value:0},outputShiftX:{value:0}},this.pyramidTopLevelReadPixelBuffer=new Float32Array(4);this.pyramidPassMaterial.fragmentShader="\n\t\t\tprecision highp float;\n\t\t\tprecision highp sampler2D;\n\t\t\tlayout(location = 0) out vec4 pc_FragColor;\n\t\t\tuniform sampler2D inputTexture;\n\t\t\tuniform float inputWidth;\n\t\t\tuniform float inputHeight;\n\t\t\tuniform float inputShiftX;\n\t\t\tuniform float outputShiftX;\n\t\t\tconst vec2 half_unit_coord = vec2(0.5);\n\t\t\tconst vec4 one = vec4(1.0);\n\t\t\tvoid main() {\n\t\t\t\tvec2 inputSize = vec2(inputWidth, inputHeight);\n\t\t\t\tvec2 input_pixel_uv = 1. / inputSize;\n\t\t\t\tvec2 coord = gl_FragCoord.xy - half_unit_coord;\n\t\t\t\tcoord.x -= outputShiftX;\n\t\t\t\tcoord = coord * 2. + half_unit_coord;\n\t\t\t\tcoord.x += inputShiftX;\n\n\t\t\t\t// sample bottom left corner\n\t\t\t\tvec2 input_uv = coord / inputSize;\n\t\t\t\tfloat bl = texture(inputTexture, input_uv).r;\n\n\t\t\t\t// sample bottom right corner\n\t\t\t\tinput_uv.x += input_pixel_uv.x;\n\t\t\t\tfloat br = texture(inputTexture, input_uv).r;\n\n\t\t\t\t// sample top right corner\n\t\t\t\tinput_uv.y += input_pixel_uv.y;\n\t\t\t\tfloat tr = texture(inputTexture, input_uv).r;\n\n\t\t\t\t// sample top left corner\n\t\t\t\tinput_uv.x -= input_pixel_uv.x;\n\t\t\t\tfloat tl = texture(inputTexture, input_uv).r;\n\n\t\t\t\tpc_FragColor.a = bl;\n\t\t\t\tpc_FragColor.b = pc_FragColor.a + br;\n\t\t\t\tpc_FragColor.g = pc_FragColor.b + tr;\n\t\t\t\tpc_FragColor.r = pc_FragColor.g + tl; \n\t\t\t}\n\t\t",this.pyramidPassMaterial.uniforms=this.pyramidPassUniforms,this.pyramidPassMaterial.depthTest=!1,this.pyramidPassMaterial.depthWrite=!1;let e=new Cx(PZ,this.pyramidPassMaterial);e.frustumCulled=!1,this.pyramidPassScene.add(e)}renderPyramid(e,t,n,i,r){(new xE).min.setScalar(0);let s=t.length-1,a=new Ov;n.getViewport(a),this.pyramidPassUniforms.inputShiftX.value=0,this.pyramidPassUniforms.outputShiftX.value=0;let o=s-1;for(let u=o;u>=0;u--){let s=u%2===o%2?r[0]:r[1],a=u===o?i:u%2===o%2?r[1]:r[0];this.pyramidPassUniforms.inputTexture.value=Array.isArray(a.texture)?a.texture[1]:a.texture,this.pyramidPassUniforms.inputWidth.value=a.width,this.pyramidPassUniforms.inputHeight.value=a.height,n.setRenderTarget(s);let l=t[u],c=n.getPixelRatio();n.setViewport(this.pyramidPassUniforms.outputShiftX.value/c,0,l/c,l/c),2===u&&e%2!==0&&n.setViewport(this.pyramidPassUniforms.outputShiftX.value/c,0,3/c,3/c),n.render(this.pyramidPassScene,OZ);let h=this.pyramidPassUniforms.inputShiftX.value;this.pyramidPassUniforms.inputShiftX.value=this.pyramidPassUniforms.outputShiftX.value,this.pyramidPassUniforms.outputShiftX.value=h,u<o&&(this.pyramidPassUniforms.outputShiftX.value+=t[u+1])}n.setViewport(a);let l=t.length%2===0?0:1;return n.readRenderTargetPixelsAsync(r[l],r[l].width-1,0,1,1,this.pyramidTopLevelReadPixelBuffer).then((()=>this.pyramidTopLevelReadPixelBuffer[0]))}};var zZ=new py,NZ=new py,jZ=new Rv,UZ=new Lv,VZ=new Lv,HZ=new Rv;function WZ(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this.children.length;for(;n--;){let i=this.children[n];Oz.is(i)&&GZ.call(i,e,t+1)}}function GZ(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(!0!==e(this,t)){let n=this.children.length;for(;n--;){let i=this.children[n];Oz.is(i)&&GZ.call(i,e,t+1)}}}function qZ(){if(void 0===this.shapesDataTexture.value){let e=new FD(new Float32Array(1920),kZ,5,bg,vg);this.shapesDataTexture.value=e}let e=this.shapesDataTexture.value,t=e.image.data;e.needsUpdate=!0;let n=0,i=this.data.geometry.blendRange,r=zZ.copy(this.matrixWorld).invert(),s=0;WZ.call(this,(e=>{var a;if(!1===e.visible)return!0;let o;if(e instanceof pY)return;if(e instanceof XY||e instanceof AZ)return;o=e instanceof Vz?e.object:e;let l=null===(a=e.data)||void 0===a?void 0:a.cloner;if(Nz.is(e)&&l&&!l.hideBase&&"radial"!==l.type&&!0!==l.disabled||!(o instanceof Sq))return;let u=o.geometry.userData.parameters,c=u.shapeBlendNode;if(void 0===c)return;if(NZ.multiplyMatrices(r,e.matrixWorld).decompose(VZ,jZ,UZ),"TorusGeometry"===u.type&&360!==u.arc){let e=u.arc*Math.PI/180;e/=4,jZ.multiply(HZ.set(0,0,Math.sin(e),Math.cos(e)))}let h=c.overrideGlobalBlend?c.blendRange:i;h=h/this.bboxSize*2,t[4*s]=(VZ.x-this.bboxOffset)/this.bboxSize*2,t[4*s+1]=(VZ.y-this.bboxOffset)/this.bboxSize*2,t[4*s+2]=(VZ.z-this.bboxOffset)/this.bboxSize*2,t[4*s+3]=0===c.operation?1:2===c.operation?-1:-2,t[384+4*s]=-jZ.x,t[384+4*s+1]=-jZ.y,t[384+4*s+2]=-jZ.z,t[384+4*s+3]=jZ.w;let d=new Float32Array(4),p=0;if("SphereGeometry"===u.type)u.width===u.height&&u.width===u.depth?d[0]=0:d[0]=1,d[1]=u.width/this.bboxSize,d[2]=u.height/this.bboxSize,d[3]=u.depth/this.bboxSize,n=Math.max(n,d[1]*UZ.x+h,d[2]*UZ.x+h,d[3]*UZ.x+h);else if("CubeGeometry"===u.type){p=u.cornerRadius;let e=u.width,t=u.height,i=u.depth;d[0]=2,d[1]=(e-2*p)/this.bboxSize,d[2]=(t-2*p)/this.bboxSize,d[3]=(i-2*p)/this.bboxSize,n=Math.max(n,Math.sqrt(e**2+t**2+i**2)/this.bboxSize*UZ.x+h)}else if("CylinderGeometry"===u.type){p=u.cornerRadius;let e=u.height,t=u.radiusBottom,i=u.radiusTop;if(i>=t){let n=Math.atan2(i-t,e),r=(Math.PI/2-n)/2;i-=p/Math.tan(r),t-=p*Math.tan(r)}else if(t>i){let n=Math.atan2(t-i,e),r=(Math.PI/2-n)/2;i-=p*Math.tan(r),t-=p/Math.tan(r)}d[1]=(u.height-2*p)/this.bboxSize,t===i?(d[0]=3,d[2]=t/this.bboxSize*2):(d[0]=4,d[2]=t/this.bboxSize*2,d[3]=i/this.bboxSize*2),n=Math.max(n,4*d[1]*UZ.x+h)}else if("TorusGeometry"===u.type){if(d[0]=5,d[1]=(u.width-u.depth)/this.bboxSize,d[2]=u.depth/this.bboxSize,360!==u.arc){d[0]=6,d[3]=d[1],t[1152+4*s+3]=d[2];let e=2*Math.atan2(d[2]/2,d[1]),n=u.arc*Math.PI/180/2-e;d[1]=Math.sin(n),d[2]=Math.cos(n)}n=Math.max(n,u.width*UZ.x/this.bboxSize+h)}t.set(d,768+4*s),t[1152+4*s]=h,t[1152+4*s+1]=p/this.bboxSize*2,t[1152+4*s+2]=UZ.x;let f=o.material,m=f.uniforms.nodeU0.node.value,g=f.uniforms.nodeU1.value;0!==c.operation&&!c.useColor&&(g=-1),t[1536+4*s]=m.r,t[1536+4*s+1]=m.g,t[1536+4*s+2]=m.b,t[1536+4*s+3]=g,g<1&&1===this.material.defines.SHAPEBLEND_C&&(this.material.transparent=!0),s++})),this.npart=s,this.spatialPassUniforms.span.value=1.4*n}function YZ(e,t){let n=!1,i=512&e.layers.mask,r=t.getLayersOfType("transmission"),s=t.getLayersOfType("outline");return s.length>0&&(e.layers.set(8),r.length>0&&e.layers.enable(3),n=!0,Cq(e),Eq(e)),0===r.length&&0===s.length&&e.layers.set(0),i&&e.layers.set(9),e instanceof yq&&e.needsAO&&e.layers.enable(5),n}function XZ(e,t){if(!t.layers)return!1;let n=512&e.layers.mask,i=!1,r=t.getLayersOfType("transmission").filter((e=>e.data.visible)),s=t.getLayersOfType("outline").filter((e=>e.data.visible));return r.length>0&&(e.layers.set(3),s.length>0&&e.layers.enable(8),i=!0),0===r.length&&0===s.length&&e.layers.set(0),n&&e.layers.set(9),e.needsAO&&e.layers.enable(5),i}var QZ=new fE,KZ=new py,ZZ=new dy;function JZ(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=e.cloner;if(r)for(let s of r.children){let r=KZ.copy(s.matrixWorld).invert(),a=ZZ.copy(t.ray).applyMatrix4(r),o=e.matrixWorld;a.applyMatrix4(o);let l=QZ;l.set(a.origin,a.direction),l.near=t.near,l.far=t.far;let u=l.intersectObject(e,!1);u.length>0&&n.push(d(d({},u[0]),{},{object:i?s:e}))}}var $Z=class{constructor(){this._constraints=new Map}setConstraint(e,t){null===t?this._constraints.delete(e):this._constraints.set(e,t)}removeDependencies(e){this._constraints.delete(e)}applyConstraints(e){let t=new Set;this._constraints.forEach(((n,i)=>{let r=[i,n],s=n;for(;this._constraints.has(s);){if(s=this._constraints.get(s),r.includes(s)){console.warn("circular dependency detected: ".concat(r.join(" -> ")));break}t.has(s)||r.push(s)}for(let a=r.length-2;a>=0;a--)if(!t.has(r[a])){let n=e.find(r[a]);n?n.applyPathSnapping(e):console.warn("missing entity ".concat(r[a])),t.add(r[a])}}))}findDependency(e,t){let n=e;for(;this._constraints.has(n);)if(n=this._constraints.get(n),n===t)return!0;return!1}},eJ=class{};function tJ(e){let t,n,i,r,s,a,o,l,u,c,h,d,p,f,m,g;function v(e,t,a){let o=new Float32Array(c,s,3*n);i=0;let l=new Uint32Array(c,r,n);for(let n=0;n<a.length-1;n++){let r=t[n],s=e[n].elements,u=r.filter((e=>e.enabled&&"Include"===e.mode)).map((e=>"Box"===e.type?x(e):w(e))),c=r.filter((e=>e.enabled&&"Exclude"===e.mode)).map((e=>"Box"===e.type?x(e):w(e)));for(let e=a[n];e<a[n+1];e++){let t=p[3*e],n=p[3*e+1],r=p[3*e+2];if((0===u.length||y(t,n,r,u))&&(0===c.length||!y(t,n,r,c))){let a=1/(s[3]*t+s[7]*n+s[11]*r+s[15]);o[3*i]=(s[0]*t+s[4]*n+s[8]*r+s[12])*a,o[3*i+1]=(s[1]*t+s[5]*n+s[9]*r+s[13])*a,o[3*i+2]=(s[2]*t+s[6]*n+s[10]*r+s[14])*a,l[i]=e,i++}}}}function y(e,t,n,i,r){return i["Intersect"===r?"every":"some"]((i=>{let r=function(e,t,n,i,r){let s=e-r[0],a=t-r[1],o=n-r[2],l=1/(i[3]*s+i[7]*a+i[11]*o+i[15]);return{x:(i[0]*s+i[4]*a+i[8]*o+i[12])*l+r[0],y:(i[1]*s+i[5]*a+i[9]*o+i[13])*l+r[1],z:(i[2]*s+i[6]*a+i[10]*o+i[14])*l+r[2]}}(e,t,n,i.invRotationMatrix,i.cropCenter);return Array.isArray(i)?function(e,t,n,i){return e>=i[0]&&e<=i[3]&&t>=i[1]&&t<=i[4]&&n>=i[2]&&n<=i[5]}(r.x,r.y,r.z,i):function(e,t,n,i){let r=(e-i.cropCenter[0])*i.invRadiusX,s=(t-i.cropCenter[1])*i.invRadiusY,a=(n-i.cropCenter[2])*i.invRadiusZ;return r*r+s*s+a*a<=1}(r.x,r.y,r.z,i)}))}function x(e){let t=e.cropSize[0]/2,n=e.cropSize[1]/2,i=e.cropSize[2]/2,r=[e.cropCenter[0]-t,e.cropCenter[1]-n,e.cropCenter[2]-i,e.cropCenter[0]+t,e.cropCenter[1]+n,e.cropCenter[2]+i],s=b(e.cropRotation);return Object.assign(r,{invRotationMatrix:s,cropCenter:e.cropCenter})}function b(e){let t=[],n=e[0]*Math.PI/180,i=e[1]*Math.PI/180,r=e[2]*Math.PI/180,s=Math.cos(n),a=Math.sin(n),o=Math.cos(i),l=Math.sin(i),u=Math.cos(r),c=Math.sin(r),h=s*u,d=s*c,p=a*u,f=a*c;return t[0]=o*u,t[1]=-o*c,t[2]=l,t[4]=d+p*l,t[5]=h-f*l,t[6]=-a*o,t[8]=f-h*l,t[9]=p+d*l,t[10]=s*o,t[12]=0,t[13]=0,t[14]=0,t[3]=0,t[7]=0,t[11]=0,t[15]=1,t}function w(e){let t=2/e.cropSize[0],n=2/e.cropSize[1],i=2/e.cropSize[2],r=b(e.cropRotation);return{invRadiusX:t,invRadiusY:n,invRadiusZ:i,cropCenter:e.cropCenter,invRotationMatrix:r}}e.onmessage=b=>{if(b.data.getCroppedIndexes){let t=new Uint32Array(function(e,t){let n=[],i=t.filter((e=>e.enabled&&"Include"===e.mode)).map((e=>"Box"===e.type?x(e):w(e))),r=t.filter((e=>e.enabled&&"Exclude"===e.mode)).map((e=>"Box"===e.type?x(e):w(e))),s=e.length;for(let a=0;a<s;a+=3){let t=e[a],s=e[a+1],o=e[a+2];(0===i.length||y(t,s,o,i))&&(0===r.length||!y(t,s,o,r))||n.push(a/3)}return n}(new Float32Array(b.data.positions),b.data.crops)).buffer;e.postMessage({outOfBoundsIndexes:t},[t])}else if(b.data.positions)h=b.data.positions,p=new Float32Array(h),m=b.data.meshMatrixWorlds,g=b.data.cropsArray,f=b.data.meshIndexIntervals,v(m,g,f),e.postMessage({sortSetupComplete:!0});else if(b.data.sort||b.data.newMatrixWorlds||b.data.newCropsArray)(b.data.newMatrixWorlds||b.data.newCropsArray)&&(g=b.data.newCropsArray||g,m=b.data.newMatrixWorlds||m,v(m,g,f)),function(h){let p,f=new Float64Array(c,a,16);for(let e=0;e<16;e++)f[e]=h[e];if(i>1){t.exports.sortIndexes(r,s,u,a,o,l,d.DepthMapRange,i);let e=new Uint32Array(i);p=e.buffer,e.set(new Uint32Array(c,l,i))}else if(1===i){let e=new Uint32Array(i);e[0]=new Uint32Array(c,r,n)[0],p=e.buffer}else p=new ArrayBuffer(0);e.postMessage({sortDone:!0,indexesBuffer:p},[p])}(b.data.sort.view,b.data.sort.cameraPosition);else if(b.data.init){d=b.data.init.Constants,n=b.data.init.splatCount;let i=d.BytesPerInt,h=3*d.BytesPerFloat,p=new Uint8Array(b.data.init.sorterWasmBytes),f=n*(i+h)+(n*d.BytesPerInt*2+d.DepthMapRange*d.BytesPerInt*2)+32*d.MemoryPageSize,m=Math.floor(f/d.MemoryPageSize)+1,g={module:{},env:{memory:new WebAssembly.Memory({initial:2*m,maximum:3*m,shared:!0})}};WebAssembly.compile(p).then((e=>WebAssembly.instantiate(e,g))).then((p=>{t=p,r=0,s=n*i,a=s+n*h,u=a+16*d.BytesPerFloat*2,o=u+n*d.BytesPerInt,l=o+d.DepthMapRange*d.BytesPerInt,c=g.env.memory.buffer,e.postMessage({sortSetupPhase1Complete:!0})}))}}}Am(eJ,"DepthMapRange",65536),Am(eJ,"MemoryPageSize",65536),Am(eJ,"BytesPerFloat",4),Am(eJ,"BytesPerInt",4);var nJ=function(){let e=new Float32Array(1),t=new Int32Array(e.buffer);return function(n){return e[0]=n,t[0]}}(),iJ=function(e,t,n,i){return e+(t<<8)+(n<<16)+(i<<24)},rJ=new lv;function sJ(e){let t=!1;return e.scene.objects.traverse(((e,n)=>{if(!1===n.visible)return!0;"Splat"===n.type&&(t=!0)})),t}var aJ,oJ,lJ,uJ=class extends Cx{constructor(e,t,n,i){let r=arguments.length>4&&void 0!==arguments[4]&&arguments[4],s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,a=arguments.length>6?arguments[6]:void 0,o=arguments.length>7?arguments[7]:void 0;super(n,i),this.splatCount=t,this.meshIndexIntervals=a,this.meshMatrixWorlds=o,this.splatBuffers=e,this.geometry=n,this.material=i,this.splatDataTextures=null,this.halfPrecisionCovariancesOnGPU=r,this.devicePixelRatio=s,this.resetLocalSplatDataAndTexturesFromSplatBuffer()}static buildMesh(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,r=arguments.length>4?arguments[4]:void 0,s=arguments.length>5?arguments[5]:void 0,a=uJ.buildGeomtery(t),o=uJ.buildMaterial(r);return new uJ(e,t,a,o,n,i,r,s)}static buildMaterial(e){let t={covariancesTexture:{type:"t",value:null},centersColorsTexture:{type:"t",value:null},meshIndexIntervals:{value:e},meshMatrixWorldsTexture:{type:"t",value:null},focal:{type:"v2",value:new lv},viewport:{type:"v2",value:new lv},basisViewport:{type:"v2",value:new lv},debugColor:{type:"v3",value:new Ev},covariancesTextureSize:{type:"v2",value:new lv(1024,1024)},centersColorsTextureSize:{type:"v2",value:new lv(1024,1024)},orthoZoom:{type:"f",value:-1}};return new Ix({uniforms:t,vertexShader:"\n            precision highp float;\n            #include <common>\n\n            attribute uint splatIndex;\n\n            uniform highp sampler2D covariancesTexture;\n            uniform highp usampler2D centersColorsTexture;\n            uniform vec2 focal;\n            uniform vec2 viewport;\n            uniform vec2 basisViewport;\n            uniform vec2 covariancesTextureSize;\n            uniform vec2 centersColorsTextureSize;\n\t\t\t\t\t\tuniform highp sampler2D meshMatrixWorldsTexture;\n\t\t\t\t\t\tuniform uint meshIndexIntervals[257];\n\t\t\t\t\t\tuniform float orthoZoom;\n\n            varying vec4 vColor;\n            varying vec2 vUv;\n\n            varying vec2 vPosition;\n\n            const vec4 encodeNorm4 = vec4(1.0 / 255.0, 1.0 / 255.0, 1.0 / 255.0, 1.0 / 255.0);\n            const uvec4 mask4 = uvec4(uint(0x000000FF), uint(0x0000FF00), uint(0x00FF0000), uint(0xFF000000));\n            const uvec4 shift4 = uvec4(0, 8, 16, 24);\n            vec4 uintToRGBAVec (uint u) {\n               uvec4 urgba = mask4 & u;\n               urgba = urgba >> shift4;\n               vec4 rgba = vec4(urgba) * encodeNorm4;\n               return rgba;\n            }\n\n            vec2 getDataUV(in int stride, in int offset, in vec2 dimensions) {\n                vec2 samplerUV = vec2(0.0, 0.0);\n                float d = float(splatIndex * uint(stride) + uint(offset)) / dimensions.x;\n                samplerUV.y = float(floor(d)) / dimensions.y;\n                samplerUV.x = fract(d);\n                return samplerUV;\n            }\n\n            void main () {\n                uvec4 sampledCenterColor = texture(centersColorsTexture, getDataUV(1, 0, centersColorsTextureSize));\n                vec3 splatCenter = uintBitsToFloat(uvec3(sampledCenterColor.gba));\n                vColor = uintToRGBAVec(sampledCenterColor.r);\n\n                vPosition = position.xy * 2.0;\n\n\t\t\t\t\t\t\t\tuint meshIndex;\n\t\t\t\t\t\t\t\tfor (int i = 1; i < 257; i++) {\n\t\t\t\t\t\t\t\t\tif (splatIndex < meshIndexIntervals[i]) {\n\t\t\t\t\t\t\t\t\t\tmeshIndex = uint(i - 1);\n\t\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\tfloat strideMulmeshIndex = float(4u*meshIndex);\n\t\t\t\t\t\t\t\tfloat meshMatrixWorldsTextureLength = float(256*4);\n\n\t\t\t\t\t\t\t\tmat4 modelMat = mat4(\n\t\t\t\t\t\t\t\t\ttexture(meshMatrixWorldsTexture, vec2((strideMulmeshIndex+0.0)/meshMatrixWorldsTextureLength, 0)),\n\t\t\t\t\t\t\t\t\ttexture(meshMatrixWorldsTexture, vec2((strideMulmeshIndex+1.0)/meshMatrixWorldsTextureLength, 0)),\n\t\t\t\t\t\t\t\t\ttexture(meshMatrixWorldsTexture, vec2((strideMulmeshIndex+2.0)/meshMatrixWorldsTextureLength, 0)),\n\t\t\t\t\t\t\t\t\ttexture(meshMatrixWorldsTexture, vec2((strideMulmeshIndex+3.0)/meshMatrixWorldsTextureLength, 0))\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\tmat4 modelViewMat = viewMatrix * modelMat;\n\t\t\t\t\t\t\t\tvec4 viewCenter = modelViewMat * vec4(splatCenter, 1.0); \n                vec4 clipCenter = projectionMatrix * viewCenter;\n\n                vec2 sampledCovarianceA = texture(covariancesTexture, getDataUV(3, 0, covariancesTextureSize)).rg;\n                vec2 sampledCovarianceB = texture(covariancesTexture, getDataUV(3, 1, covariancesTextureSize)).rg;\n                vec2 sampledCovarianceC = texture(covariancesTexture, getDataUV(3, 2, covariancesTextureSize)).rg;\n\n                vec3 cov3D_M11_M12_M13 = vec3(sampledCovarianceA.rg, sampledCovarianceB.r);\n                vec3 cov3D_M22_M23_M33 = vec3(sampledCovarianceB.g, sampledCovarianceC.rg);\n\n                // Compute the 2D covariance matrix from the upper-right portion of the 3D covariance matrix\n                mat3 Vrk = mat3(\n                    cov3D_M11_M12_M13.x, cov3D_M11_M12_M13.y, cov3D_M11_M12_M13.z,\n                    cov3D_M11_M12_M13.y, cov3D_M22_M23_M33.x, cov3D_M22_M23_M33.y,\n                    cov3D_M11_M12_M13.z, cov3D_M22_M23_M33.y, cov3D_M22_M23_M33.z\n                );\n                float s = 1.0 / (viewCenter.z * viewCenter.z);\n\n                mat3 W = transpose(mat3(modelViewMat));\n                mat3 T = orthoZoom > 0.0 ? W : W * mat3(\n\t\t\t\t\t\t\t\t\tfocal.x / viewCenter.z, 0., -(focal.x * viewCenter.x) * s,\n\t\t\t\t\t\t\t\t\t0., focal.y / viewCenter.z, -(focal.y * viewCenter.y) * s,\n\t\t\t\t\t\t\t\t\t0., 0., 0.\n\t\t\t\t\t\t\t\t);\n                mat3 cov2Dm = transpose(T) * Vrk * T;\n                cov2Dm[0][0] += 0.3;\n                cov2Dm[1][1] += 0.3;\n\n                // We are interested in the upper-left 2x2 portion of the projected 3D covariance matrix because\n                // we only care about the X and Y values. We want the X-diagonal, cov2Dm[0][0],\n                // the Y-diagonal, cov2Dm[1][1], and the correlation between the two cov2Dm[0][1]. We don't\n                // need cov2Dm[1][0] because it is a symetric matrix.\n                vec3 cov2Dv = vec3(cov2Dm[0][0], cov2Dm[0][1], cov2Dm[1][1]);\n\n                vec3 ndcCenter = clipCenter.xyz / clipCenter.w;\n\n                // We now need to solve for the eigen-values and eigen vectors of the 2D covariance matrix\n                // so that we can determine the 2D basis for the splat. This is done using the method described\n                // here: https://people.math.harvard.edu/~knill/teaching/math21b2004/exhibits/2dmatrices/index.html\n                //\n                // This is a different approach than in the original work at INRIA. In that work they compute the\n                // max extents of the 2D covariance matrix in screen space to form an axis aligned bounding rectangle\n                // which forms the geometry that is actually rasterized. They then use the inverse 2D covariance\n                // matrix (called 'conic') to determine fragment opacity.\n                float a = cov2Dv.x;\n                float d = cov2Dv.z;\n                float b = cov2Dv.y;\n                float D = a * d - b * b;\n                float trace = a + d;\n                float traceOver2 = 0.5 * trace;\n                float term2 = sqrt(trace * trace / 4.0 - D);\n                float eigenValue1 = traceOver2 + term2;\n\t\t\t\t\t\t\t\tfloat eigenValue2 = max(traceOver2 - term2, 0.00); // prevent negative eigen value\n\n                const float maxSplatSize = 1024.0;\n                vec2 eigenVector1 = normalize(vec2(b, eigenValue1 - a));\n                // since the eigen vectors are orthogonal, we derive the second one from the first\n                vec2 eigenVector2 = vec2(eigenVector1.y, -eigenVector1.x);\n                vec2 basisVector1 = eigenVector1 * min(sqrt(2.0 * eigenValue1), maxSplatSize);\n                vec2 basisVector2 = eigenVector2 * min(sqrt(2.0 * eigenValue2), maxSplatSize);\n\n                vec2 ndcOffset = vec2(vPosition.x * basisVector1 + vPosition.y * basisVector2) * basisViewport;\n\n\t\t\t\t\t\t\t\tif (orthoZoom > 0.0) {\n\t\t\t\t\t\t\t\t\tndcOffset *= orthoZoom;\n\t\t\t\t\t\t\t\t}\n\n                gl_Position = vec4(ndcCenter.xy + ndcOffset, ndcCenter.z, 1.0);\n            }",fragmentShader:"\n            precision highp float;\n            #include <common>\n\n            uniform vec3 debugColor;\n\n            varying vec4 vColor;\n            varying vec2 vUv;\n\n            varying vec2 vPosition;\n\t\t\t\t\t\tlayout(location = 1) out vec4 gVelocity; \n\n            void main () {\n                // compute the negative squared distance from the center of the splat to the\n                // current fragment in the splat's local space.\n                float A = -dot(vPosition, vPosition);\n                if (A < -4.0) discard;\n                vec3 color = vColor.rgb;\n                A = exp(A) * vColor.a;\n                gl_FragColor = vec4(color.rgb, A);\n\t\t\t\t\t\t\t\tgVelocity = vec4(0.0); // so it is ignored by TAA\n            }",transparent:!0,alphaTest:1,blending:1,depthTest:!0,depthWrite:!1,side:2})}static buildGeomtery(e){let t=new dx;t.setIndex([0,1,2,0,2,3]);let n=new Float32Array(12),i=new tx(n,3);t.setAttribute("position",i),i.setXYZ(0,-1,-1,0),i.setXYZ(1,-1,1,0),i.setXYZ(2,1,1,0),i.setXYZ(3,1,-1,0),i.needsUpdate=!0;let r=(new XS).copy(t),s=new Uint32Array(e),a=new BD(s,1,!1);return a.setUsage(35048),r.setAttribute("splatIndex",a),r.instanceCount=e,r}resetLocalSplatDataAndTexturesFromSplatBuffer(){this.updateLocalSplatDataFromSplatBuffer(),this.allocateAndStoreLocalSplatDataInTextures()}updateLocalSplatDataFromSplatBuffer(){this.splatBuffers.forEach((e=>e.buildPreComputedBuffers())),this.covariances=new Float32Array(6*this.splatCount),this.colors=new Uint8Array(4*this.splatCount),this.centers=new Float32Array(3*this.splatCount);let e=0,t=0,n=0;for(let i of this.splatBuffers){let r=i.nsplats;this.colors.subarray(e,e+4*r).set(i.colorsA),e+=4*r,this.centers.subarray(t,t+3*r).set(i.decoded.xyz.denormDequant().data),t+=3*r,this.covariances.subarray(n,n+6*r).set(new Float32Array(i.precomputedCovarianceBufferData)),n+=6*r}}allocateAndStoreLocalSplatDataInTextures(){let e=this.splatCount,t=new lv(4096,1024);for(;t.x*t.y*2<6*e;)t.y*=2;let n,i,r=new lv(4096,1024);for(;r.x*r.y*4<4*e;)r.y*=2;if(this.halfPrecisionCovariancesOnGPU){i=new Uint16Array(t.x*t.y*2);for(let e=0;e<this.covariances.length;e++)i[e]=LE.toHalfFloat(this.covariances[e]);n=new FD(i,t.x,t.y,Sg,yg)}else i=new Float32Array(t.x*t.y*2),i.set(this.covariances),n=new FD(i,t.x,t.y,Sg,vg);n.needsUpdate=!0,this.material.uniforms.covariancesTexture.value=n,this.material.uniforms.covariancesTextureSize.value.copy(t);let s=new Uint32Array(r.x*r.y*4);for(let u=0;u<e;u++){let e=4*u,t=3*u,n=4*u;s[n]=iJ(this.colors[e],this.colors[e+1],this.colors[e+2],this.colors[e+3]),s[n+1]=nJ(this.centers[t]),s[n+2]=nJ(this.centers[t+1]),s[n+3]=nJ(this.centers[t+2])}let a=new FD(s,r.x,r.y,1033,gg);a.internalFormat="RGBA32UI",a.needsUpdate=!0,this.material.uniforms.centersColorsTexture.value=a,this.material.uniforms.centersColorsTextureSize.value.copy(r);let o=new Float32Array(4096);for(let u=0;u<this.meshMatrixWorlds.length;u++)o.set(this.meshMatrixWorlds[u].elements,16*u);let l=new FD(o,1024,1,bg,vg);l.needsUpdate=!0,this.material.uniforms.meshMatrixWorldsTexture.value=l,this.material.uniformsNeedUpdate=!0,this.splatDataTextures={covariances:{data:i,texture:n,size:t},centerColors:{data:s,texture:a,size:r},meshMatrixWorlds:{data:o,texture:l}}}updateIndexes(e){let t=this.geometry;t.attributes.splatIndex.set(e),t.attributes.splatIndex.needsUpdate=!0,t.instanceCount=e.length}updateUniforms(e,t,n,i){this.splatCount>0&&(rJ.set(e.x*this.devicePixelRatio,e.y*this.devicePixelRatio),this.material.uniforms.viewport.value.copy(rJ),this.material.uniforms.basisViewport.value.set(2/rJ.x,2/rJ.y),this.material.uniforms.focal.value.set(t,n),this.material.uniforms.orthoZoom.value=i,this.material.uniformsNeedUpdate=!0)}getSplatDataTextures(){return this.splatDataTextures}getSplatCount(){return this.splatCount}getCenters(){return this.centers}getColors(){return this.colors}getCovariances(){return this.covariances}dispose(){this.geometry.dispose(),this.material.dispose(),this.splatDataTextures&&(this.splatDataTextures.covariances.texture.dispose(),this.splatDataTextures.centerColors.texture.dispose(),this.splatDataTextures.meshMatrixWorlds.texture.dispose()),this.removeFromParent()}},cJ=new Promise((e=>{aJ=e})),hJ=!1;function dJ(){if(!hJ)return oJ||(oJ=async function(){let e=await n.e(23).then(n.bind(n,23));aJ(e),hJ=!0}(),oJ)}cJ.then((e=>lJ=e));var pJ=class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Am(this,"updateView",function(){let e=new py,t=[],n=new Lv(0,0,-1),i=new Lv(0,0,-1),r=new Lv,s=new Lv;return function(){let a=arguments.length>0&&void 0!==arguments[0]&&arguments[0],o=arguments.length>1?arguments[1]:void 0,l=this.updateMatrixWorldsInWorkerIfNeeded(),u=this.cropsChanged();if(!a){i.set(0,0,-1).applyQuaternion(o.quaternion);let e=!1,t=!1;if(i.dot(n)<=.95&&(e=!0),s.copy(o.position).sub(r).length()>=1&&(t=!0),!e&&!t&&!l&&!u&&!this.needsInitialRender)return}this.needsInitialRender=!1,r.copy(o.position),n.copy(i),e.copy(o.matrixWorld).invert(),e.premultiply(this.dummyPerspectiveMatrix),t[0]=o.position.x,t[1]=o.position.y,t[2]=o.position.z;let c=d(d({sort:{view:e.elements,cameraPosition:t,splatRenderCount:this.splatRenderCount,splatSortCount:this.splatRenderCount}},l?{newMatrixWorlds:this.meshMatrixWorlds}:{}),u?{newCropsArray:this.cropsArray}:{});this.sortRunning?this.queuedMessage=c:(this.queuedMessage=null,this.sortRunning=!0,this.sortWorker.postMessage(c))}}()),this.scene=e.scene,this.currentPage=null,this.devicePixelRatio=window.devicePixelRatio,this.sortWorker=null,this.splatRenderCount=0,this.splatSortCount=0,this.splatMesh=null,this.sortRunning=!1,this.meshMatrixWorlds=null,this.meshMatrixWorldsOld=null,this.cropsArray=null,this.splatEntries=null,this.queuedMessage=null,this.needsInitialRender=!0,this.dummyPerspectiveMatrix=(new py).makePerspective(-1,1,-1,1,.1,1e3)}updateSplatMeshUniforms(e,t){let n=new lv;null!==this.splatMesh&&this.splatMesh.getSplatCount()>0&&(e.getSize(n),this.cameraFocalLengthX=t.projectionMatrix.elements[0]*this.devicePixelRatio*n.x*.45,this.cameraFocalLengthY=t.projectionMatrix.elements[5]*this.devicePixelRatio*n.y*.45,this.splatMesh.updateUniforms(n,this.cameraFocalLengthX,this.cameraFocalLengthY,t.isPerspectiveCamera?-1:t.zoom*this.devicePixelRatio))}loadSplat(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.activePage=this.scene.activePage,e.position&&(e.position=(new Lv).fromArray(e.position)),e.orientation&&(e.orientation=(new Rv).fromArray(e.orientation)),e.halfPrecisionCovariances=!!e.halfPrecisionCovariances;let t=[];if(this.splatEntries=t,this.activePage.traverseVisibleEntity((e=>{"Splat"===e.data.type&&t.push(e)})),this.splatMesh&&this.splatMesh.dispose(),0===t.length)return this.splatMesh=null,!1;this.meshMatrixWorlds=t.map((e=>e.matrixWorld)),this.meshMatrixWorldsOld=t.map((e=>e.matrixWorld.clone())),this.cropsArray=t.map((e=>e.data.crops.map((e=>e.data))));let n=t.map((e=>new lJ.GSplineBuffer(new Uint8Array(e.data.buffer).buffer))),i=0,r=[0];for(let s of n)i+=s.getSplatCount(),r.push(i);return this.setupSplatMesh(n,i,e.position,e.orientation,e.halfPrecisionCovariances,this.devicePixelRatio,r,this.meshMatrixWorlds),this.setupSortWorker(i),!0}updateMatrixWorldsInWorkerIfNeeded(){let e=this.splatDataTextures.meshMatrixWorlds.data;for(let t=0;t<this.meshMatrixWorlds.length;t++)e.set(this.meshMatrixWorlds[t].elements,16*t);return this.splatDataTextures.meshMatrixWorlds.texture.needsUpdate=!0,!this.meshMatrixWorlds.every(((e,t)=>e.equals(this.meshMatrixWorldsOld[t])))&&(this.meshMatrixWorldsOld=this.meshMatrixWorlds.map((e=>e.clone())),!0)}cropsChanged(){let e=!1;return this.splatEntries.forEach(((t,n)=>{var i;t.data.crops.forEach(((t,i)=>{void 0===this.cropsArray[n][i]?(e=!0,this.cropsArray[n][i]=t.data):Object.entries(t.data).forEach((t=>{var r;let[s,a]=t;(Array.isArray(a)&&a.some(((e,t)=>e!==this.cropsArray[n][i][s][t]))||a!==(null===(r=this.cropsArray[n][i])||void 0===r?void 0:r[s]))&&(e=!0,this.cropsArray[n][i][s]=a)}))})),t.data.crops.length!==(null===(i=this.cropsArray[n])||void 0===i?void 0:i.length)&&(this.cropsArray[n].length=t.data.crops.length,e=!0)})),e}setupSplatMesh(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Lv,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new Rv,r=arguments.length>4&&void 0!==arguments[4]&&arguments[4],s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,a=arguments.length>6?arguments[6]:void 0,o=arguments.length>7?arguments[7]:void 0;this.splatMesh=uJ.buildMesh(e,t,r,s,a,o),this.splatMesh.position.copy(n),this.splatMesh.quaternion.copy(i),this.splatMesh.frustumCulled=!1,this.splatMesh.renderOrder=99999,this.splatRenderCount=t,this.splatMesh.onBeforeRender=(e,t,n)=>this.update(e,n)}setupSortWorker(e){this.sortWorker=function(e){let t=new Worker(URL.createObjectURL(new Blob(["(",tJ.toString(),")(self)"],{type:"application/javascript"}))),n=atob("AGFzbQEAAAAADwhkeWxpbmsuMAEEAAAAAAETA2AAAGAIf39/f39/f38AYAABfwISAQNlbnYGbWVtb3J5AgMAgIAEAwQDAAECBzkDEV9fd2FzbV9jYWxsX2N0b3JzAAALc29ydEluZGV4ZXMAARNlbXNjcmlwdGVuX3Rsc19pbml0AAIK3gMDAwABC9IDAwF/BnwBfgJAIAdFDQAgAysDUCEMIAMrAzAhDSADKwMQIQ5BACEDRP///////+9/IQtEAAAAAAAAEAAhCgNAIAIgA0ECdGoCfyAOIAEgA0EMbGoiCCoCALuiIA0gCCoCBLuioCAMIAgqAgi7oqBEAAAAAAAAsECiIgmZRAAAAAAAAOBBYwRAIAmqDAELQYCAgIB4CzYCACAJIAsgCSALYxshCyAJIAogCSAKZBshCiADQQFqIgMgB0cNAAsgB0UNACAGuCAKIAuhoyEJQQAhAwNAAn8gCSACIANBAnRqIgEoAgC3IAuhoiIKmUQAAAAAAADgQWMEQCAKqgwBC0GAgICAeAshCCABIAg2AgAgBCAIQQJ0aiIBIAEoAgBBAWo2AgAgA0EBaiIDIAdHDQALCyAGQQJPBEAgBCgCACEIQQEhAwNAIAQgA0ECdGoiASABKAIAIAhqIgg2AgAgA0EBaiIDIAZHDQALCyAHQQFrIgGtIQ8DQCAEIAIgD6dBAnQiA2ooAgBBAnRqIgcgBygCAEEBayIHNgIAIAUgASAHa0ECdGogACADaigCADYCACAPUCEDIA9CAX0hDyADRQ0ACyAGBEAgBEEAIAZBAnT8CwALCwQAQQAL"),i=new Uint8Array(n.length);for(let r=0;r<n.length;r++)i[r]=n.charCodeAt(r);return t.postMessage({init:{sorterWasmBytes:i.buffer,splatCount:e,Constants:{BytesPerFloat:eJ.BytesPerFloat,BytesPerInt:eJ.BytesPerInt,DepthMapRange:eJ.DepthMapRange,MemoryPageSize:eJ.MemoryPageSize}}}),t}(e),this.sortWorker.onmessage=e=>{var t;e.data.sortDone?(this.sortRunning=!1,null!==(t=this.splatMesh)&&void 0!==t&&t.updateIndexes(new Uint32Array(e.data.indexesBuffer)),this.lastSortTime=e.data.sortTime,this.queuedMessage&&(this.sortWorker.postMessage(this.queuedMessage),this.queuedMessage=null)):e.data.sortCanceled?this.sortRunning=!1:e.data.sortSetupPhase1Complete?this.sortWorker.postMessage({positions:this.splatMesh.getCenters().buffer,meshMatrixWorlds:this.splatMesh.meshMatrixWorlds,meshIndexIntervals:this.splatMesh.meshIndexIntervals,cropsArray:this.cropsArray}):e.data.sortSetupComplete&&(this.splatDataTextures=this.splatMesh.getSplatDataTextures(),this.scene.activePage.add(this.splatMesh),this.needsInitialRender=!0)}}update(e,t){null!==this.splatMesh&&(this.updateSplatMeshUniforms(e,t),this.updateView(!1,t))}getSplatMesh(){return this.splatMesh}},fJ=new Jy;fJ.wireframe=!0;var mJ=new Lv,gJ=class extends CD{constructor(e,t){super(),this.data=e,this.sharedAssets=t,this.enableHelpers=!1,this.wireframeState=!1,this.needsTransmissionDirty=!0,this.needsNormalDirty=!0,this._needsTransmission=!1,this._needsNormal=!1,this.geometryCacheChanged=!1,this.splatViewer=null,this.shapeBlendIntances=[],this.entityByUuid={},this.entityIdentityToEntity={},this.toExpandCloner=new Set,this.toUpdateCloner=new Set,this.pendingCommands=[],this.pathConstraints=new $Z,this.invisibleObjects=new YY("jflkdsafjasdifjaslk",d(d({},VB.defaultData),{},{visible:!1,name:"buildin invisible"})),this.needsRecomputeInstances=!1,this.init(e,t),this.matrixAutoUpdate=!1,this.errorPage=new iZ("fdasfa",d(d({},ZB.defaultData),{},{name:""}),{shared:t,scene:this})}markGeometryCacheDirty(){this.geometryCacheChanged=!0}markNeedsUpdateRendererDirty(){this.needsTransmissionDirty=!0,this.needsNormalDirty=!0}needsTransmission(){return this.needsTransmissionDirty&&(this._needsTransmission=function(e){let t=!1;return e.traverseEntity((e=>{if(e instanceof yq)if(Array.isArray(e.material))for(let n=0;n<e.material.length;n++)XZ(e,e.material[n])&&(t=!0);else XZ(e,e.material)&&(t=!0)})),t}(this),this.needsTransmissionDirty=!1),this._needsTransmission}needsNormal(){return this.needsNormalDirty&&(this._needsNormal=function(e){let t=!1;return e.traverseEntity((e=>{if(e instanceof yq)if(Array.isArray(e.material))for(let n=0;n<e.material.length;n++)YZ(e,e.material[n])&&(t=!0);else YZ(e,e.material)&&(t=!0)})),t}(this),this.needsNormalDirty=!1),this._needsNormal}registerInstanceAndSetUuid(e){let t=e.identity.join("-"),n=this.entityIdentityToEntity[t];n&&(e.uuid=n.uuid),this.entityIdentityToEntity[t]=e,this.entityByUuid[e.uuid]=e}markPenumbraSizeDirty(){for(let e of this.children)e instanceof iZ&&(e.penumbraSizeArrayCache=null)}findInstance(e){return this.entityIdentityToEntity[e.join("-")]}get bgColor(){return this.activePage.bgColor}get postprocessing(){return this.activePage.data.postprocessing}getWithSortKey(e){let t=this.find(e);if(void 0===t)return;let n=[],i=t;for(;i!==this;){let e=i;i=i.parent;let t=i.children.indexOf(e);n.splice(0,0,t)}return{entity:t,sortKey:n}}getAllSorted(e){let t=[];for(let n of e){let e=this.getWithSortKey(n.id);void 0!==e&&t.push(e)}return t.sort(((e,t)=>TF(e.sortKey,t.sortKey))),t.map((e=>e.entity))}nonExistOrDescendantOf(e,t){let n=this.find(e);if(void 0===n)return!0;for(;n;){if(n.uuid===t)return!0;n=n.parent}return!1}find(e){if(this.activePage&&this.activePage.personalCamera.parent){if("f23858d0-4a3b-4bd8-8173-66ed0af7f6fb-personalCamera"===e)return this.activePage.personalCamera;if(e===Kk)return this.activePage.personalCamera}if(""===e||void 0===e)return;let t=this.entityByUuid[e];return void 0===t?this.getObjectByProperty("uuid",e):t}find2D(e){for(let t of this.children)if(t instanceof iZ&&t.uiScene){let n=t.uiScene.find(e);if(n)return n}}findScene2DfromObject2D(e){for(let t of this.children)if(t instanceof iZ&&t.uiScene&&t.uiScene.find(e))return t.uiScene}find2DInUIObjects(e){let t;return this.traverseEntity((n=>{void 0===t&&n instanceof pZ&&(t=n.uiCanvas.find(e))})),t}traverse2D(e){for(let t of this.children)t instanceof iZ&&t.uiScene&&t.uiScene.traverse(e)}debugEnsureEntity(e){let t=this.find(e);t?Array.isArray(t.identity)&&void 0===this.findInstance(t.identity)&&console.error("not found instance"):console.error("not found")}addPendingExpandCloner(e){this.toExpandCloner.add(e)}addPendingUpdateCloner(e){this.toUpdateCloner.add(e)}markToExpandCloner(e){this.toExpandCloner.add(e),e.traverseEntityAncestors((e=>{this.toExpandCloner.add(e)}))}doPendingExpandCloner(){this.toExpandCloner.forEach((e=>{e.expandCloner(this)})),this.toExpandCloner.clear()}doPendingUpdateCloner(){this.toUpdateCloner.forEach((e=>{var t;null===(t=e.cloner)||void 0===t||t.update()})),this.toUpdateCloner.clear()}doPendingUpdates(){this.doPendingExpandCloner(),this.doPendingUpdateCloner(),this.applyPendingCommands()}addPendingCommand(e){this.pendingCommands.push(e)}applyPendingCommands(){this.pendingCommands.forEach((e=>e())),this.pendingCommands.length=0}updateByLibOp(e,t){1===e.path.length&&"components"===e.path[0]&&1===e.type&&this.createChildrenObjects([d(d({},e.data.asset),{},{id:e.id})],this.invisibleObjects,t)}updateTreeByOp(e,t){if(0===e.path.length&&7===e.type){let n=null===e.parent?this:this.find(e.parent);if(void 0===n)throw new Error("unexpected");let i=this.createObject(e.id,e.data,e.children,n,e.localIndex,t);i.updateVisible(this),i.resetBBoxNeedsUpdate(),NY(i)&&jY(i.parent)&&(i.invalidateUpstreamBooleanData(),i.parent.invalidateDownstreamBooleanData().recomputeBoolean()),this.markNeedsRecomputeInstancesForAncessors(n),this.markNeedsRecomputeInstancesForChildren(i),this.markToExpandCloner(i),this.markPenumbraSizeDirty(),i.updatePathSnapping()}else if(0===e.path.length&&8===e.type){let t=this.find(e.id);if(void 0===t)throw new Error("unexpected");t.traverseEntity((e=>{e instanceof LZ&&(this.shapeBlendIntances=this.shapeBlendIntances.filter((t=>t!==e)))})),this.markToExpandCloner(t),t.resetBBoxNeedsUpdate(),this.unregisterObject(t);let n=t.parent;this.markNeedsRecomputeInstancesForAncessors(n),this.markNeedsRecomputeInstancesForChildren(t),this.markPenumbraSizeDirty(),t.parent.remove(t),jY(t.parent)&&(t.parent.invalidateUpstreamBooleanData(),t.parent.invalidateDownstreamBooleanData().recomputeBoolean()),NY(t)&&(t.freeBooleanPointer(),n instanceof LY&&n.invalidateDownstreamBooleanData().recomputeBoolean()),t instanceof aZ&&t.detachShape(),this.disposeAndUnregisterEntityRecursivelyIfNotReregistered(t),this.pathConstraints.removeDependencies(t.uuid),t.updatePathSnapping()}else if(0===e.path.length&&9===e.type){var n;let t=this.find(e.id);if(void 0===t)throw new Error("unexpected");this.markNeedsRecomputeInstancesForChildren(t);let i=t.parent;this.markNeedsRecomputeInstancesForAncessors(i),null!==(n=t.cloner)&&void 0!==n&&n.resetOnMove(),this.markToExpandCloner(t);let r=null===e.parent?this:this.find(e.parent);if(void 0===r)throw new Error("unexpected");r.add(t),this.markNeedsRecomputeInstancesForAncessors(r),this.markToExpandCloner(t),t.invalidateClonerTransform(t),t.updateVisible(this),t.resetBBoxNeedsUpdate(),this.markPenumbraSizeDirty();let s=e.localIndex;r.children.splice(s,0,r.children.pop()),NY(t)&&(t.invalidateUpstreamBooleanData(),jY(t.parent)?t.parent.invalidateDownstreamBooleanData().recomputeBoolean():i instanceof LY&&i.invalidateDownstreamBooleanData().recomputeBoolean()),t.updatePathSnapping()}this.markNeedsUpdateRendererDirty(),this.markGeometryCacheDirty()}get playPage(){var e;return null!==(e=this.find(this.data.publish.playPage))&&void 0!==e?e:this.errorPage}updatePage(e){var t;this.activePage&&this.activePage.onDeactive(),this.activePage=this.errorPage;for(let n of this.children)n instanceof iZ&&(n.visible=n.uuid===e,n.visible&&(this.activePage=n,this.activePage.onActive(this)));this.activePage!==(null===(t=this.splatViewer)||void 0===t?void 0:t.activePage)&&this.reloadSplats()}updateEntityByOp(e,t,n,i){if(0===t.type){if(("overrides"in t.props||"component"in t.props)&&this.markNeedsRecomputeInstances(),"visible"in t.props&&this.markPenumbraSizeDirty(),t.path.includes("overrides")&&"states"in t.props){let{rest:e}=t.props;t=d(d({},t),{},{props:e}),this.markNeedsRecomputeInstances()}"pathSnapping"===t.path[0]&&void 0!==t.props.pathId&&this.pathConstraints.setConstraint(e,t.props.pathId)}let r=this.find(e);if(r)try{(function(e,t,n,i){e.updateByOp(t,n,i,!1)})(r,t,n,{scene:this,shared:i}),r instanceof Sq&&r.updateGeometryGroupsIfNeeded()}catch(wi){console.error(wi)}}updateEntity2DByOp(e,t,n,i,r){let s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[];e.updateEntityByOp(t,n,i,r),this.traverseEntity((e=>{var a;(e instanceof pZ||e instanceof iZ)&&(s.includes(null!==(a=e.frameId)&&void 0!==a?a:"")||e.frameId===t)&&e.updateEntity2DByOp(t,n,i,r)}))}get activeCamera(){return this.activePage.activeCamera}switchActiveCamera(e){this.activePage.switchActiveCamera(e)}isInvisibleObjects(e){return e===this.invisibleObjects||e.hasAnccestor(this.invisibleObjects)}init(e,t){let n=Object.entries(t.data.lib.components).map(((e,t)=>({data:e[1].asset.data,children:e[1].asset.children,id:e[0],fi:t})));this.invisibleObjects.updateState(this.invisibleObjects.data,{scene:this,shared:t}),this.add(this.invisibleObjects),this.createChildrenObjects(n,this.invisibleObjects,t),this.createChildrenObjects(e.objects,this,t),this.updatePage(e.publish.playPage),this.activePage.switchToPlayCamera(),this.expandInstances(t,!0),this.traverseEntity((e=>{e instanceof OY&&e.updateUp()})),this.doPendingExpandCloner(),this.applyPendingCommands()}markNeedsRecomputeInstances(){this.needsRecomputeInstances=!0}markNeedsRecomputeInstancesForChildren(e){e.traverseEntity((e=>{("Component"===e.data.type||"Instance"===e.data.type)&&this.markNeedsRecomputeInstances()}))}markNeedsRecomputeInstancesForAncessors(e){Nz.is(e)&&("Component"===e.data.type&&this.markNeedsRecomputeInstances(),e.traverseAncestors((e=>{Nz.is(e)&&"Component"===e.data.type&&this.markNeedsRecomputeInstances()})))}relativeizeInner(e,t,n,i,r,s,a){if(e){let o=i.find(e);o&&o!==i&&r.forInstancesRec((i=>{i.data=RO(i.data,(r=>{let o=r.events.data(a.id),l=i.goUp(s);if(l){let i=[...MF(l.identity),e].join("-"),r=this.entityIdentityToEntity[i];if(r){let e=r.uuid;OO.zoom(o,t)[n]=e}else console.warn("cannot find instance")}})).data}))}}rewriteActions(e,t,n,i,r,s){e.forEach((e=>{"Transition"===e.data.type||"Animation"===e.data.type?this.relativeizeInner(e.data.object,[...t,e.id],"object",n,i,r,s):"Conditional"===e.data.type&&(this.rewriteActions(e.data.ifActions,[...t,e.id,"ifActions"],n,i,r,s),this.rewriteActions(e.data.elseActions,[...t,e.id,"elseActions"],n,i,r,s))}))}rewriteEventsBeforeGoToPlayMode(){this.traverseEntity((e=>{if(e instanceof lZ&&"string"==typeof e.identity&&"Component"===e.data.type)return e.traverseEntity(((t,n)=>{t.data.events.forEach((i=>{if("GameControl"===i.data.type){let r=!1;if(t.forInstancesRec((e=>{e.data=RO(e.data,(t=>{e.isInstanceRoot||(t.events.delete(i.id),r=!0)})).data})),!1===r)for(let s of gR.list)this.rewriteActions(i.data.gameActions[s],["gameActions",s],e,t,n,i)}else"Conditional"===i.data.type?("Distance"===i.data.condition.type?(this.relativeizeInner(i.data.condition.fromObject,["condition"],"fromObject",e,t,n,i),this.relativeizeInner(i.data.condition.toObject,["condition"],"toObject",e,t,n,i)):"State"===i.data.condition.type?this.relativeizeInner(i.data.condition.object,["condition"],"object",e,t,n,i):"Comparison"===i.data.condition.type&&("Property"===i.data.condition.lOperand.type&&this.relativeizeInner(i.data.condition.lOperand.value[0],["condition","lOperand","value"],0,e,t,n,i),"Property"===i.data.condition.rOperand.type&&this.relativeizeInner(i.data.condition.rOperand.value[0],["condition","rOperand","value"],0,e,t,n,i)),this.rewriteActions(i.data.inActions,["inActions"],e,t,n,i),this.rewriteActions(i.data.outActions,["outActions"],e,t,n,i)):"actions"in i.data&&this.rewriteActions(i.data.actions,["actions"],e,t,n,i)}))})),!0}))}expandInstances(e,t,n){let i=new Set;this.traverseEntity((r=>{if(r instanceof lZ&&r.isInstanceRoot)return r.expandInstanceChildren({scene:this,shared:e,pendingDeletes:i}),t||r.resetBBoxNeedsUpdate(),n&&r.traverseEntity((e=>{n.addClip(e)})),!0}));for(let r of i)this.disposeAndUnregisterEntityRecursivelyIfNotReregistered(r),uZ(r)}recomputeInstances(e,t){this.needsRecomputeInstances&&(this.needsRecomputeInstances=!1,this.traverseEntity((e=>{e instanceof lZ&&e.isInstanceRoot&&(e.component=void 0)})),this.expandInstances(e,!1,t))}disposeAndUnregisterEntityRecursivelyIfNotReregistered(e){e.traverseEntity((e=>{let t="string"==typeof e.identity?e.identity:e.identity.join("-");this.entityIdentityToEntity[t]===e&&(delete this.entityByUuid[e.uuid],delete this.entityIdentityToEntity[t]),e.dispose()}))}clearScene(){for(let e of this.children)Nz.is(e)&&e.disposeRecursively();this.children.length=0}resetAfterClear(e,t){this.init(e,t)}raycast(e){return this.raycast1(e,!1)}raycast1(e,t){let n=[],i=r=>{for(let s of r.children){let r=s.cloner;if(Nz.is(s)&&!s.raycastLock&&(s.visible||null!==r&&void 0!==r&&r.object.data.visible))if(!0===t&&s.isInstanceRoot){let t=[];if(e.intersectObject(s,!0,t),t.length){let e=t[0];e.object=s,e.point.applyMatrix4(e.object.matrixWorld);let i=s.matrixWorld.clone().invert();e.point.applyMatrix4(i),n.push(e)}}else(NY(s)||UY(s)&&this.enableHelpers&&s.objectHelper.visible)&&(e.intersectObject(s,!1,n),JZ(s,e,n)),i(s)}};return i(this.activePage),n}raycastWithClones(e){let t=[],n=i=>{for(let r of i.children){let i=r.cloner;Nz.is(r)&&(r.visible||(null===i||void 0===i?void 0:i.object.data.visible))&&((NY(r)||UY(r)&&this.enableHelpers&&r.objectHelper.visible)&&(e.intersectObject(r,!1,t),JZ(r,e,t,!0)),n(r))}};return n(this),t}forEachEntity(e){for(let t of this.children)Nz.is(t)&&e(t)}traverseConcreteEntity(e){for(let t of this.children)Nz.is(t)&&t.isConcreteEntity&&t.traverseEntity(e)}traverseEntity(e){for(let t of this.children)Nz.is(t)&&t.traverseEntity(e)}updateFont(e,t){this.traverseEntity((n=>{if(n instanceof Sq&&"Mesh"===n.data.type&&("TextGeometry"===n.data.geometry.type||"InputGeometry"===n.data.geometry.type)&&n.data.geometry.font===e){let i=n.geometry,r=n.data.geometry;i.updateFont(e,t).then((()=>{i.update(r);let e=n.invalidateDownstreamBooleanData();jY(e)&&e.recomputeBoolean()}))}}))}traverseObject(e){for(let t of this.children)Oz.is(t)&&t.traverseObject(e)}traverseVisibleEntity(e){for(let t of this.children)Nz.is(t)&&t.visible&&t.traverseVisibleEntity(e)}dispose(){this.clearScene()}createChildrenObjects(e,t,n){let i=0;for(let r of e)this.createObject(r.id,r.data,r.children,t,i,n),i+=1}registerObjectCreatedInLegacy(e){this.entityByUuid[e.uuid]=e}unregisterObject(e){delete this.entityByUuid[e.uuid];for(let t of e.children)this.unregisterObject(t)}createObject(e,t,n,i,r,s){var a;let o={scene:this,shared:s},l=TZ(e,t,o);return l instanceof LZ&&this.shapeBlendIntances.push(l),l&&(this.entityByUuid[e]=l,i.add(l),i.children.splice(r,0,i.children.pop()),n.length>0&&(l.isInstanceRoot?console.error("instance should not have children!"):this.createChildrenObjects(n,l,s)),l.updateState(t,o),l instanceof Sq&&l.updateGeometryGroupsIfNeeded(),l.updateVisible(this),l.cloner&&this.toExpandCloner.add(l),null!==(a=t.pathSnapping)&&void 0!==a&&a.pathId&&this.pathConstraints.setConstraint(e,t.pathSnapping.pathId)),"Empty"===t.type&&t.animations&&l.traverseEntity((e=>{let t=e.dataPatched;if(e instanceof Sq&&t.bones&&t.boneInverses){let n=t.bones.map((e=>this.find(e))),i=t.boneInverses.map((e=>(new py).fromArray(e))),r=new kD(n,i);e.bind(r,e.bindMatrix)}else e.matrixAutoUpdate=!0})),l}getCenter(e){let t=[];for(let i=0,r=e.length;i<r;++i){let{id:n,recursive:r}=e[i],s=this.find(n),a=r?s.recursiveBBox:s.singleBBox;t.push(...a.vertices)}let n=new jv;return n.setFromPoints(t),n.getCenter(mJ),mJ}copyMatrixWorld(e,t){if(null===e)return void t.identity();let n=this.find(e);n?t.copy(n.matrixWorld):t.identity()}copyParentMatrixWorld(e,t){var n;if(null===e)return void t.identity();let i=null===(n=this.find(e))||void 0===n?void 0:n.parent;i?t.copy(i.matrixWorld):t.identity()}traverseMaterial(e){this.traverseEntity((t=>{if(t instanceof FV)if(Array.isArray(t.material))for(let n=0;n<t.material.length;n++)t.material[n]instanceof dG&&e(t.material[n]);else t.material instanceof dG&&e(t.material)}))}updateViewPlaneSize(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.traverseConcreteEntity((i=>{i instanceof OY&&i.setViewplaneSize(e,t,n)}))}initializeSplatViewer(){this.splatViewer=new pJ({scene:this}),this.reloadSplats()}reloadSplats(){var e;null===(e=this.splatViewer)||void 0===e||e.loadSplat()}},vJ=(e,t)=>{let n=t.x-e.x,i=t.y-e.y;return Math.sqrt(n*n+i*i)},yJ=e=>e*(Math.PI/180),xJ=e=>e*(180/Math.PI),bJ=new Map,wJ=e=>{bJ.has(e)&&clearTimeout(bJ.get(e)),bJ.set(e,setTimeout(e,100))},DJ=(e,t,n)=>{let i,r=t.split(/[ ,]+/g);for(let s=0;s<r.length;s+=1)i=r[s],e.addEventListener?e.addEventListener(i,n,!1):e.attachEvent&&e.attachEvent(i,n)},_J=(e,t,n)=>{let i,r=t.split(/[ ,]+/g);for(let s=0;s<r.length;s+=1)i=r[s],e.removeEventListener?e.removeEventListener(i,n):e.detachEvent&&e.detachEvent(i,n)},SJ=e=>(e.preventDefault(),e.type.match(/^touch/)?e.changedTouches:e),EJ=()=>{if(typeof window>"u")return;return{x:void 0!==window.pageXOffset?window.pageXOffset:(document.documentElement||document.body.parentNode||document.body).scrollLeft,y:void 0!==window.pageYOffset?window.pageYOffset:(document.documentElement||document.body.parentNode||document.body).scrollTop}},CJ=(e,t)=>{t.top||t.right||t.bottom||t.left?(e.style.top=t.top,e.style.right=t.right,e.style.bottom=t.bottom,e.style.left=t.left):(e.style.left=t.x+"px",e.style.top=t.y+"px")},AJ=(e,t,n)=>{let i=MJ(e);for(let r in i)if(i.hasOwnProperty(r))if("string"==typeof t)i[r]=t+" "+n;else{let e="";for(let i=0,r=t.length;i<r;i+=1)e+=t[i]+" "+n+", ";i[r]=e.slice(0,-2)}return i},MJ=e=>{let t={};return t[e]="",["webkit","Moz","o"].forEach((function(n){t[n+e.charAt(0).toUpperCase()+e.slice(1)]=""})),t},TJ=(e,t)=>{for(let n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e},PJ=(e,t)=>{if(e.length)for(let n=0,i=e.length;n<i;n+=1)t(e[n]);else t(e)};typeof window<"u"&&(FJ="ontouchstart"in window,OJ=!!window.PointerEvent,IJ=!!window.MSPointerEvent);var FJ,OJ,IJ,kJ,BJ={start:"mousedown",move:"mousemove",end:"mouseup"},RJ={};function LJ(){}OJ?kJ={start:"pointerdown",move:"pointermove",end:"pointerup, pointercancel"}:IJ?kJ={start:"MSPointerDown",move:"MSPointerMove",end:"MSPointerUp"}:FJ?(kJ={start:"touchstart",move:"touchmove",end:"touchend, touchcancel"},RJ=BJ):kJ=BJ,LJ.prototype.on=function(e,t){var n,i=this,r=e.split(/[ ,]+/g);i._handlers_=i._handlers_||{};for(var s=0;s<r.length;s+=1)n=r[s],i._handlers_[n]=i._handlers_[n]||[],i._handlers_[n].push(t);return i},LJ.prototype.off=function(e,t){var n=this;return n._handlers_=n._handlers_||{},void 0===e?n._handlers_={}:void 0===t?n._handlers_[e]=null:n._handlers_[e]&&n._handlers_[e].indexOf(t)>=0&&n._handlers_[e].splice(n._handlers_[e].indexOf(t),1),n},LJ.prototype.trigger=function(e,t){var n,i=this,r=e.split(/[ ,]+/g);i._handlers_=i._handlers_||{};for(var s=0;s<r.length;s+=1)n=r[s],i._handlers_[n]&&i._handlers_[n].length&&i._handlers_[n].forEach((function(e){e.call(i,{type:n,target:i},t)}))},LJ.prototype.config=function(e){var t=this;t.options=t.defaults||{},e&&(t.options=((e,t)=>{let n={};for(let i in e)e.hasOwnProperty(i)&&t.hasOwnProperty(i)?n[i]=t[i]:e.hasOwnProperty(i)&&(n[i]=e[i]);return n})(t.options,e))},LJ.prototype.bindEvt=function(e,t){var n=this;return n._domHandlers_=n._domHandlers_||{},n._domHandlers_[t]=function(){"function"==typeof n["on"+t]?n["on"+t].apply(n,arguments):console.warn('[WARNING] : Missing "on'+t+'" handler.')},DJ(e,kJ[t],n._domHandlers_[t]),RJ[t]&&DJ(e,RJ[t],n._domHandlers_[t]),n},LJ.prototype.unbindEvt=function(e,t){var n=this;return n._domHandlers_=n._domHandlers_||{},_J(e,kJ[t],n._domHandlers_[t]),RJ[t]&&_J(e,RJ[t],n._domHandlers_[t]),delete n._domHandlers_[t],this};var zJ=LJ;function NJ(e,t){return this.identifier=t.identifier,this.position=t.position,this.frontPosition=t.frontPosition,this.collection=e,this.defaults={size:100,threshold:.1,color:"white",fadeTime:250,dataOnly:!1,restJoystick:!0,restOpacity:1,mode:"dynamic",zone:document.body,lockX:!1,lockY:!1,shape:"circle"},this.config(t),"dynamic"===this.options.mode&&(this.options.restOpacity=0),this.id=NJ.id,NJ.id+=1,this.buildEl().stylize(),this.instance={el:this.ui.el,on:this.on.bind(this),off:this.off.bind(this),show:this.show.bind(this),hide:this.hide.bind(this),add:this.addToDom.bind(this),remove:this.removeFromDom.bind(this),destroy:this.destroy.bind(this),setPosition:this.setPosition.bind(this),resetDirection:this.resetDirection.bind(this),computeDirection:this.computeDirection.bind(this),trigger:this.trigger.bind(this),position:this.position,frontPosition:this.frontPosition,ui:this.ui,identifier:this.identifier,id:this.id,options:this.options},this.instance}NJ.prototype=new zJ,NJ.constructor=NJ,NJ.id=0,NJ.prototype.buildEl=function(e){return this.ui={},this.options.dataOnly||(this.ui.el=document.createElement("div"),this.ui.back=document.createElement("div"),this.ui.front=document.createElement("div"),this.ui.el.className="nipple collection_"+this.collection.id,this.ui.back.className="back",this.ui.front.className="front",this.ui.el.setAttribute("id","nipple_"+this.collection.id+"_"+this.id),this.ui.el.appendChild(this.ui.back),this.ui.el.appendChild(this.ui.front)),this},NJ.prototype.stylize=function(){if(this.options.dataOnly)return this;var e=this.options.fadeTime+"ms",t=((e,t)=>{let n=MJ(e);for(let i in n)n.hasOwnProperty(i)&&(n[i]=t);return n})("borderRadius","50%"),n=AJ("transition","opacity",e),i={};return i.el={position:"absolute",opacity:this.options.restOpacity,display:"block",zIndex:999},i.back={position:"absolute",display:"block",width:this.options.size+"px",height:this.options.size+"px",marginLeft:-this.options.size/2+"px",marginTop:-this.options.size/2+"px",background:"rgba(255, 255, 255, .4)",border:"solid 2px rgba(0, 0, 0, .1)"},i.front={width:this.options.size/2+"px",height:this.options.size/2+"px",position:"absolute",display:"block",marginLeft:-this.options.size/4+"px",marginTop:-this.options.size/4+"px",background:"rgba(255, 255, 255, .8)",border:"solid 2px rgba(0, 0, 0, .1)"},TJ(i.el,n),"circle"===this.options.shape&&TJ(i.back,t),TJ(i.front,t),this.applyStyles(i),this},NJ.prototype.applyStyles=function(e){for(var t in this.ui)if(this.ui.hasOwnProperty(t))for(var n in e[t])this.ui[t].style[n]=e[t][n];return this},NJ.prototype.addToDom=function(){return this.options.dataOnly||document.body.contains(this.ui.el)||this.options.zone.appendChild(this.ui.el),this},NJ.prototype.removeFromDom=function(){return this.options.dataOnly||!document.body.contains(this.ui.el)||this.options.zone.removeChild(this.ui.el),this},NJ.prototype.destroy=function(){clearTimeout(this.removeTimeout),clearTimeout(this.showTimeout),clearTimeout(this.restTimeout),this.trigger("destroyed",this.instance),this.removeFromDom(),this.off()},NJ.prototype.show=function(e){var t=this;return t.options.dataOnly||(clearTimeout(t.removeTimeout),clearTimeout(t.showTimeout),clearTimeout(t.restTimeout),t.addToDom(),t.restCallback(),setTimeout((function(){t.ui.el.style.opacity=1}),0),t.showTimeout=setTimeout((function(){t.trigger("shown",t.instance),"function"==typeof e&&e.call(this)}),t.options.fadeTime)),t},NJ.prototype.hide=function(e){var t=this;if(t.options.dataOnly)return t;if(t.ui.el.style.opacity=t.options.restOpacity,clearTimeout(t.removeTimeout),clearTimeout(t.showTimeout),clearTimeout(t.restTimeout),t.removeTimeout=setTimeout((function(){var n="dynamic"===t.options.mode?"none":"block";t.ui.el.style.display=n,"function"==typeof e&&e.call(t),t.trigger("hidden",t.instance)}),t.options.fadeTime),t.options.restJoystick){let n=t.options.restJoystick,i={};i.x=!0===n||!1!==n.x?0:t.instance.frontPosition.x,i.y=!0===n||!1!==n.y?0:t.instance.frontPosition.y,t.setPosition(e,i)}return t},NJ.prototype.setPosition=function(e,t){var n=this;n.frontPosition={x:t.x,y:t.y};var i=n.options.fadeTime+"ms",r={};r.front=AJ("transition",["top","left"],i);var s={front:{}};s.front={left:n.frontPosition.x+"px",top:n.frontPosition.y+"px"},n.applyStyles(r),n.applyStyles(s),n.restTimeout=setTimeout((function(){"function"==typeof e&&e.call(n),n.restCallback()}),n.options.fadeTime)},NJ.prototype.restCallback=function(){var e=this,t={};t.front=AJ("transition","none",""),e.applyStyles(t),e.trigger("rested",e.instance)},NJ.prototype.resetDirection=function(){this.direction={x:!1,y:!1,angle:!1}},NJ.prototype.computeDirection=function(e){var t,n,i,r=e.angle.radian,s=Math.PI/4,a=Math.PI/2;if(r>s&&r<3*s&&!e.lockX?t="up":r>-s&&r<=s&&!e.lockY?t="left":r>3*-s&&r<=-s&&!e.lockX?t="down":e.lockY||(t="right"),e.lockY||(n=r>-a&&r<a?"left":"right"),e.lockX||(i=r>0?"up":"down"),e.force>this.options.threshold){var o,l={};for(o in this.direction)this.direction.hasOwnProperty(o)&&(l[o]=this.direction[o]);var u={};for(o in this.direction={x:n,y:i,angle:t},e.direction=this.direction,l)l[o]===this.direction[o]&&(u[o]=!0);if(u.x&&u.y&&u.angle)return e;(!u.x||!u.y)&&this.trigger("plain",e),u.x||this.trigger("plain:"+n,e),u.y||this.trigger("plain:"+i,e),u.angle||this.trigger("dir dir:"+t,e)}else this.resetDirection();return e};var jJ=NJ;function UJ(e,t){var n=this;n.nipples=[],n.idles=[],n.actives=[],n.ids=[],n.pressureIntervals={},n.manager=e,n.id=UJ.id,UJ.id+=1,n.defaults={zone:document.body,multitouch:!1,maxNumberOfNipples:10,mode:"dynamic",position:{top:0,left:0},catchDistance:200,size:100,threshold:.1,color:"white",fadeTime:250,dataOnly:!1,restJoystick:!0,restOpacity:1,lockX:!1,lockY:!1,shape:"circle",dynamicPage:!1,follow:!1},n.config(t),("static"===n.options.mode||"semi"===n.options.mode)&&(n.options.multitouch=!1),n.options.multitouch||(n.options.maxNumberOfNipples=1);let i=getComputedStyle(n.options.zone.parentElement);return i&&"flex"===i.display&&(n.parentIsFlex=!0),n.updateBox(),n.prepareNipples(),n.bindings(),n.begin(),n.nipples}UJ.prototype=new zJ,UJ.constructor=UJ,UJ.id=0,UJ.prototype.prepareNipples=function(){var e=this,t=e.nipples;t.on=e.on.bind(e),t.off=e.off.bind(e),t.options=e.options,t.destroy=e.destroy.bind(e),t.ids=e.ids,t.id=e.id,t.processOnMove=e.processOnMove.bind(e),t.processOnEnd=e.processOnEnd.bind(e),t.get=function(e){if(void 0===e)return t[0];for(var n=0,i=t.length;n<i;n+=1)if(t[n].identifier===e)return t[n];return!1}},UJ.prototype.bindings=function(){var e=this;e.bindEvt(e.options.zone,"start"),e.options.zone.style.touchAction="none",e.options.zone.style.msTouchAction="none"},UJ.prototype.begin=function(){var e=this,t=e.options;if("static"===t.mode){var n=e.createNipple(t.position,e.manager.getIdentifier());n.add(),e.idles.push(n)}},UJ.prototype.createNipple=function(e,t){var n=this,i=n.manager.scroll,r={},s=n.options,a=n.parentIsFlex?i.x:i.x+n.box.left,o=n.parentIsFlex?i.y:i.y+n.box.top;if(e.x&&e.y)r={x:e.x-a,y:e.y-o};else if(e.top||e.right||e.bottom||e.left){var l=document.createElement("DIV");l.style.display="hidden",l.style.top=e.top,l.style.right=e.right,l.style.bottom=e.bottom,l.style.left=e.left,l.style.position="absolute",s.zone.appendChild(l);var u=l.getBoundingClientRect();s.zone.removeChild(l),r=e,e={x:u.left+i.x,y:u.top+i.y}}var c=new jJ(n,{color:s.color,size:s.size,threshold:s.threshold,fadeTime:s.fadeTime,dataOnly:s.dataOnly,restJoystick:s.restJoystick,restOpacity:s.restOpacity,mode:s.mode,identifier:t,position:e,zone:s.zone,frontPosition:{x:0,y:0},shape:s.shape});return s.dataOnly||(CJ(c.ui.el,r),CJ(c.ui.front,c.frontPosition)),n.nipples.push(c),n.trigger("added "+c.identifier+":added",c),n.manager.trigger("added "+c.identifier+":added",c),n.bindNipple(c),c},UJ.prototype.updateBox=function(){this.box=this.options.zone.getBoundingClientRect()},UJ.prototype.bindNipple=function(e){var t,n=this,i=function(e,i){t=e.type+" "+i.id+":"+e.type,n.trigger(t,i)};e.on("destroyed",n.onDestroyed.bind(n)),e.on("shown hidden rested dir plain",i),e.on("dir:up dir:right dir:down dir:left",i),e.on("plain:up plain:right plain:down plain:left",i)},UJ.prototype.pressureFn=function(e,t,n){var i=this,r=0;clearInterval(i.pressureIntervals[n]),i.pressureIntervals[n]=setInterval(function(){var n=e.force||e.pressure||e.webkitForce||0;n!==r&&(t.trigger("pressure",n),i.trigger("pressure "+t.identifier+":pressure",n),r=n)}.bind(i),100)},UJ.prototype.onstart=function(e){var t=this,n=t.options,i=e;e=SJ(e),t.updateBox();return PJ(e,(function(r){t.actives.length<n.maxNumberOfNipples?t.processOnStart(r):i.type.match(/^touch/)&&(Object.keys(t.manager.ids).forEach((function(n){if(Object.values(i.touches).findIndex((function(e){return e.identifier===n}))<0){var r=[e[0]];r.identifier=n,t.processOnEnd(r)}})),t.actives.length<n.maxNumberOfNipples&&t.processOnStart(r))})),t.manager.bindDocument(),!1},UJ.prototype.processOnStart=function(e){var t,n=this,i=n.options,r=n.manager.getIdentifier(e),s=e.force||e.pressure||e.webkitForce||0,a={x:e.pageX,y:e.pageY},o=n.getOrCreate(r,a);o.identifier!==r&&n.manager.removeIdentifier(o.identifier),o.identifier=r;var l=function(t){t.trigger("start",t),n.trigger("start "+t.id+":start",t),t.show(),s>0&&n.pressureFn(e,t,t.identifier),n.processOnMove(e)};if((t=n.idles.indexOf(o))>=0&&n.idles.splice(t,1),n.actives.push(o),n.ids.push(o.identifier),"semi"!==i.mode)l(o);else{if(!(vJ(a,o.position)<=i.catchDistance))return o.destroy(),void n.processOnStart(e);l(o)}return o},UJ.prototype.getOrCreate=function(e,t){var n,i=this,r=i.options;return/(semi|static)/.test(r.mode)?(n=i.idles[0])?(i.idles.splice(0,1),n):"semi"===r.mode?i.createNipple(t,e):(console.warn("Coudln't find the needed nipple."),!1):n=i.createNipple(t,e)},UJ.prototype.processOnMove=function(e){var t=this,n=t.options,i=t.manager.getIdentifier(e),r=t.nipples.get(i),s=t.manager.scroll;if((e=>isNaN(e.buttons)?0!==e.pressure:0!==e.buttons)(e)){if(!r)return console.error("Found zombie joystick with ID "+i),void t.manager.removeIdentifier(i);if(n.dynamicPage){var a=r.el.getBoundingClientRect();r.position={x:s.x+a.left,y:s.y+a.top}}r.identifier=i;var o=r.options.size/2,l={x:e.pageX,y:e.pageY};n.lockX&&(l.y=r.position.y),n.lockY&&(l.x=r.position.x);var u,c,h=vJ(l,r.position),d=((e,t)=>{let n=t.x-e.x,i=t.y-e.y;return xJ(Math.atan2(i,n))})(l,r.position),p=yJ(d),f=h/o,m={distance:h,position:l};if("circle"===r.options.shape?(u=Math.min(h,o),c=((e,t,n)=>{let i={x:0,y:0};return n=yJ(n),i.x=e.x-t*Math.cos(n),i.y=e.y-t*Math.sin(n),i})(r.position,u,d)):(c=((e,t,n)=>({x:Math.min(Math.max(e.x,t.x-n),t.x+n),y:Math.min(Math.max(e.y,t.y-n),t.y+n)}))(l,r.position,o),u=vJ(c,r.position)),n.follow){if(h>o){let e=l.x-c.x,n=l.y-c.y;r.position.x+=e,r.position.y+=n,r.el.style.top=r.position.y-(t.box.top+s.y)+"px",r.el.style.left=r.position.x-(t.box.left+s.x)+"px",h=vJ(l,r.position)}}else l=c,h=u;var g=l.x-r.position.x,v=l.y-r.position.y;r.frontPosition={x:g,y:v},n.dataOnly||CJ(r.ui.front,r.frontPosition);var y={identifier:r.identifier,position:l,force:f,pressure:e.force||e.pressure||e.webkitForce||0,distance:h,angle:{radian:p,degree:d},vector:{x:g/o,y:-v/o},raw:m,instance:r,lockX:n.lockX,lockY:n.lockY};(y=r.computeDirection(y)).angle={radian:yJ(180-d),degree:180-d},r.trigger("move",y),t.trigger("move "+r.id+":move",y)}else this.processOnEnd(e)},UJ.prototype.processOnEnd=function(e){var t=this,n=t.options,i=t.manager.getIdentifier(e),r=t.nipples.get(i),s=t.manager.removeIdentifier(r.identifier);!r||(n.dataOnly||r.hide((function(){"dynamic"===n.mode&&(r.trigger("removed",r),t.trigger("removed "+r.id+":removed",r),t.manager.trigger("removed "+r.id+":removed",r),r.destroy())})),clearInterval(t.pressureIntervals[r.identifier]),r.resetDirection(),r.trigger("end",r),t.trigger("end "+r.id+":end",r),t.ids.indexOf(r.identifier)>=0&&t.ids.splice(t.ids.indexOf(r.identifier),1),t.actives.indexOf(r)>=0&&t.actives.splice(t.actives.indexOf(r),1),/(semi|static)/.test(n.mode)?t.idles.push(r):t.nipples.indexOf(r)>=0&&t.nipples.splice(t.nipples.indexOf(r),1),t.manager.unbindDocument(),/(semi|static)/.test(n.mode)&&(t.manager.ids[s.id]=s.identifier))},UJ.prototype.onDestroyed=function(e,t){var n=this;n.nipples.indexOf(t)>=0&&n.nipples.splice(n.nipples.indexOf(t),1),n.actives.indexOf(t)>=0&&n.actives.splice(n.actives.indexOf(t),1),n.idles.indexOf(t)>=0&&n.idles.splice(n.idles.indexOf(t),1),n.ids.indexOf(t.identifier)>=0&&n.ids.splice(n.ids.indexOf(t.identifier),1),n.manager.removeIdentifier(t.identifier),n.manager.unbindDocument()},UJ.prototype.destroy=function(){var e=this;for(var t in e.unbindEvt(e.options.zone,"start"),e.nipples.forEach((function(e){e.destroy()})),e.pressureIntervals)e.pressureIntervals.hasOwnProperty(t)&&clearInterval(e.pressureIntervals[t]);e.trigger("destroyed",e.nipples),e.manager.unbindDocument(),e.off()};var VJ=UJ;function HJ(e){var t=this;t.ids={},t.index=0,t.collections=[],t.scroll=EJ(),t.config(e),t.prepareCollections();var n=function(){var e;t.collections.forEach((function(n){n.forEach((function(n){e=n.el.getBoundingClientRect(),n.position={x:t.scroll.x+e.left,y:t.scroll.y+e.top}}))}))};if(typeof window>"u")return t.collections;DJ(window,"resize",(function(){wJ(n)}));var i=function(){t.scroll=EJ()};return DJ(window,"scroll",(function(){wJ(i)})),t.collections}HJ.prototype=new zJ,HJ.constructor=HJ,HJ.prototype.prepareCollections=function(){var e=this;e.collections.create=e.create.bind(e),e.collections.on=e.on.bind(e),e.collections.off=e.off.bind(e),e.collections.destroy=e.destroy.bind(e),e.collections.get=function(t){var n;return e.collections.every((function(e){return!(n=e.get(t))})),n}},HJ.prototype.create=function(e){return this.createCollection(e)},HJ.prototype.createCollection=function(e){var t=this,n=new VJ(t,e);return t.bindCollection(n),t.collections.push(n),n},HJ.prototype.bindCollection=function(e){var t,n=this,i=function(e,i){t=e.type+" "+i.id+":"+e.type,n.trigger(t,i)};e.on("destroyed",n.onDestroyed.bind(n)),e.on("shown hidden rested dir plain",i),e.on("dir:up dir:right dir:down dir:left",i),e.on("plain:up plain:right plain:down plain:left",i)},HJ.prototype.bindDocument=function(){var e=this;e.binded||(e.bindEvt(document,"move").bindEvt(document,"end"),e.binded=!0)},HJ.prototype.unbindDocument=function(e){var t=this;(!Object.keys(t.ids).length||!0===e)&&(t.unbindEvt(document,"move").unbindEvt(document,"end"),t.binded=!1)},HJ.prototype.getIdentifier=function(e){var t;return e?void 0===(t=void 0===e.identifier?e.pointerId:e.identifier)&&(t=this.latest||0):t=this.index,void 0===this.ids[t]&&(this.ids[t]=this.index,this.index+=1),this.latest=t,this.ids[t]},HJ.prototype.removeIdentifier=function(e){var t={};for(var n in this.ids)if(this.ids[n]===e){t.id=n,t.identifier=this.ids[n],delete this.ids[n];break}return t},HJ.prototype.onmove=function(e){return this.onAny("move",e),!1},HJ.prototype.onend=function(e){return this.onAny("end",e),!1},HJ.prototype.oncancel=function(e){return this.onAny("end",e),!1},HJ.prototype.onAny=function(e,t){var n,i=this,r="processOn"+e.charAt(0).toUpperCase()+e.slice(1);t=SJ(t);var s=function(e,t,n){n.ids.indexOf(t)>=0&&(n[r](e),e._found_=!0)};return PJ(t,(function(e){n=i.getIdentifier(e),PJ(i.collections,s.bind(null,e,n)),e._found_||i.removeIdentifier(n)})),!1},HJ.prototype.destroy=function(){var e=this;e.unbindDocument(!0),e.ids={},e.index=0,e.collections.forEach((function(e){e.destroy()})),e.off()},HJ.prototype.onDestroyed=function(e,t){var n=this;if(n.collections.indexOf(t)<0)return!1;n.collections.splice(n.collections.indexOf(t),1)};var WJ=new HJ,GJ=function(e){return WJ.create(e)},qJ=new Map,YJ=new Map,XJ=class{constructor(e,t,n,i){this.data=t;let{audio:r,volume:s,delay:a,loop:o}=t;if(!r)throw new Error("Missing property");let l="string"==typeof r?i.getAudio(r).src:r.data;this.audioPlayer=new AG({src:l,volume:s,delay:a,loop:o}),YJ.has(n.uuid)?YJ.get(n.uuid).push(this):YJ.set(n.uuid,[this]),qJ.set(e,this)}playByToggle(){"stop"===this.data.toggle?"playing"===this.audioPlayer.status?this.audioPlayer.stop():(this.audioPlayer.stop(),this.audioPlayer.play()):"pause"===this.data.toggle?"playing"===this.audioPlayer.status?this.audioPlayer.pause():this.audioPlayer.play():(this.audioPlayer.stop(),this.audioPlayer.play())}dispose(){this.audioPlayer.stop()}},QJ=class{constructor(e){this.data=e}dispatch(){this.data.playAudio?this.pauseAudio(this.data.playAudio):this.data.object?this.pauseAllAudiosFromObject(this.data.object):this.pauseAllAudios()}pauseAudio(e){let t=qJ.get(e);!t||(this.data.delay>0?(this.disposeDelay(),this.timeoutId=window.setTimeout((()=>{t.audioPlayer[this.data.interaction](),this.disposeDelay()}),this.data.delay)):t.audioPlayer[this.data.interaction]())}pauseAllAudiosFromObject(e){let t=YJ.get(e);null===t||void 0===t||!t.length||(this.data.delay>0?(this.disposeDelay(),this.timeoutId=window.setTimeout((()=>{t.forEach((e=>e.audioPlayer[this.data.interaction]())),this.disposeDelay()}),this.data.delay)):t.forEach((e=>e.audioPlayer[this.data.interaction]())))}pauseAllAudios(){let e=[...YJ.values()];!e.length||(this.data.delay>0?(this.disposeDelay(),this.timeoutId=window.setTimeout((()=>{e.forEach((e=>{e.forEach((e=>{e.audioPlayer[this.data.interaction]()}))})),this.disposeDelay()}),this.data.delay)):e.forEach((e=>{e.forEach((e=>{e.audioPlayer[this.data.interaction]()}))})))}disposeDelay(){clearTimeout(this.timeoutId),delete this.timeoutId}dispose(){clearTimeout(this.timeoutId),delete this.timeoutId}},KJ=class{constructor(e,t,n,i,r){if(this.data=t,this.shared=i,this.condition=r,"play"===t.interaction)this.interaction=new XJ(e,t,n,i);else{if("pause"!==t.interaction&&"stop"!==t.interaction)throw new Error("Missing property");this.interaction=new QJ(t)}}dispatchBasic(){if(!1===n1(this.shared,this.condition))return!1;this.interaction instanceof XJ?this.interaction.playByToggle():this.interaction.dispatch()}dispatchConditional(){if(!1===n1(this.shared,this.condition))return!1;this.interaction instanceof XJ?this.interaction.audioPlayer.play():this.interaction.dispatch()}dispatchGameControl(e){if(!1===n1(this.shared,this.condition))return!1;this.interaction instanceof XJ&&("start"===e?this.interaction.audioPlayer.play():this.interaction.audioPlayer.stop())}dispose(){this.interaction.dispose()}},ZJ=class{constructor(e,t,n,i){this.data=e,this.page=t,this.shared=n,this.condition=i,this.delay=0,this.emission=e.emission,void 0!==e.delay&&(this.delay=e.delay),this.particleSystem=this.page.scene.find(this.data.emitterObjectId)}toggleEmitting(){this.particleSystem.started&&!this.particleSystem.stopped?this.stop(this.delay):this.start(this.delay)}toggleFroze(){this.particleSystem.started&&!this.particleSystem.isFrozen?this.freeze(this.delay):this.unFreeze(this.delay)}start(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;e?this.delayTimerId=window.setTimeout((()=>{this.start(0),this.clearDelay()}),e):this.particleSystem.start()}stop(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;e?this.delayTimerId=window.setTimeout((()=>{this.stop(0),this.clearDelay()}),e):this.particleSystem.stop()}freeze(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;e?this.delayTimerId=window.setTimeout((()=>{this.freeze(0),this.clearDelay()}),e):this.particleSystem.froze()}unFreeze(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;e?this.delayTimerId=window.setTimeout((()=>{this.unFreeze(0),this.clearDelay()}),e):this.particleSystem.unFroze()}reset(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;e?this.delayTimerId=window.setTimeout((()=>{this.reset(0),this.clearDelay()}),e):this.particleSystem.reset()}reverseFromCurrent(){switch(this.emission){case"emitToggle":this.toggleEmitting();break;case"pauseToggle":this.toggleFroze()}}dispatchBasic(){if(!1===n1(this.shared,this.condition)||!this.particleSystem)return!1;switch(this.emission){case"start":this.start(this.delay);break;case"emitToggle":this.toggleEmitting();break;case"pause":this.freeze(this.delay);break;case"pauseToggle":this.toggleFroze();break;case"stop":this.stop(this.delay);break;case"reset":this.reset(this.delay)}}dispatchConditional(){if(!1===n1(this.shared,this.condition)||!this.particleSystem)return!1;switch(this.emission){case"start":this.start(this.delay);break;case"stop":this.stop(this.delay);break;case"reset":this.reset(this.delay)}}dispatchGameControl(e){if(!1===n1(this.shared,this.condition)||!this.particleSystem)return!1;"start"===e?this.start(this.delay):this.stop(this.delay)}dispose(){!this.particleSystem||(this.particleSystem.reset(),this.clearDelay())}clearDelay(){this.delayTimerId&&(clearTimeout(this.delayTimerId),delete this.delayTimerId)}},JJ=(e,t)=>t.some((t=>t instanceof RegExp?t.test(e):t===e));function $J(e,t){if(t=d({defaultProtocol:"http:",normalizeProtocol:!0,forceHttp:!1,forceHttps:!1,stripAuthentication:!0,stripHash:!1,stripTextFragment:!0,stripWWW:!0,removeQueryParameters:[/^utm_\w+/i],removeTrailingSlash:!0,removeSingleSlash:!0,removeDirectoryIndex:!1,sortQueryParameters:!0},t),e=e.trim(),/^data:/i.test(e))return((e,t)=>{let{stripHash:n}=t,i=dm(/^data:([^,]*?),([^#]*?)(?:#(.*))?$/,{type:1,data:2,hash:3}).exec(e);if(!i)throw new Error("Invalid URL: ".concat(e));let{type:r,data:s,hash:a}=i.groups,o=r.split(";");a=n?"":a;let l=!1;"base64"===o[o.length-1]&&(o.pop(),l=!0);let u=(o.shift()||"").toLowerCase(),c=[...o.map((e=>{let[t,n=""]=e.split("=").map((e=>e.trim()));return"charset"===t&&(n=n.toLowerCase(),"us-ascii"===n)?"":"".concat(t).concat(n?"=".concat(n):"")})).filter(Boolean)];return l&&c.push("base64"),(c.length>0||u&&"text/plain"!==u)&&c.unshift(u),"data:".concat(c.join(";"),",").concat(l?s.trim():s).concat(a?"#".concat(a):"")})(e,t);if(/^view-source:/i.test(e))throw new Error("`view-source:` is not supported as it is a non-standard protocol");let n=e.startsWith("//");!n&&/^\.*\//.test(e)||(e=e.replace(/^(?!(?:\w+:)?\/\/)|^\/\//,t.defaultProtocol));let i=new URL(e);if(t.forceHttp&&t.forceHttps)throw new Error("The `forceHttp` and `forceHttps` options cannot be used together");if(t.forceHttp&&"https:"===i.protocol&&(i.protocol="http:"),t.forceHttps&&"http:"===i.protocol&&(i.protocol="https:"),t.stripAuthentication&&(i.username="",i.password=""),t.stripHash?i.hash="":t.stripTextFragment&&(i.hash=i.hash.replace(/#?:~:text.*?$/i,"")),i.pathname){let e=/\b[a-z][a-z\d+\-.]{1,50}:\/\//g,t=0,n="";for(;;){let r=e.exec(i.pathname);if(!r)break;let s=r[0],a=r.index;n+=i.pathname.slice(t,a).replace(/\/{2,}/g,"/"),n+=s,t=a+s.length}n+=i.pathname.slice(t,i.pathname.length).replace(/\/{2,}/g,"/"),i.pathname=n}if(i.pathname)try{i.pathname=decodeURI(i.pathname)}catch(s){}if(!0===t.removeDirectoryIndex&&(t.removeDirectoryIndex=[/^index\.[a-z]+$/]),Array.isArray(t.removeDirectoryIndex)&&t.removeDirectoryIndex.length>0){let e=i.pathname.split("/"),n=e[e.length-1];JJ(n,t.removeDirectoryIndex)&&(e=e.slice(0,-1),i.pathname=e.slice(1).join("/")+"/")}if(i.hostname&&(i.hostname=i.hostname.replace(/\.$/,""),t.stripWWW&&/^www\.(?!www\.)[a-z\-\d]{1,63}\.[a-z.\-\d]{2,63}$/.test(i.hostname)&&(i.hostname=i.hostname.replace(/^www\./,""))),Array.isArray(t.removeQueryParameters))for(let o of[...i.searchParams.keys()])JJ(o,t.removeQueryParameters)&&i.searchParams.delete(o);if(!0===t.removeQueryParameters&&(i.search=""),t.sortQueryParameters){i.searchParams.sort();try{i.search=decodeURIComponent(i.search)}catch(a){}}t.removeTrailingSlash&&(i.pathname=i.pathname.replace(/\/$/,""));let r=e;return e=i.toString(),!t.removeSingleSlash&&"/"===i.pathname&&!r.endsWith("/")&&""===i.hash&&(e=e.replace(/\/$/,"")),(t.removeTrailingSlash||"/"===i.pathname)&&""===i.hash&&t.removeSingleSlash&&(e=e.replace(/\/$/,"")),n&&!t.normalizeProtocol&&(e=e.replace(/^http:\/\//,"//")),t.stripProtocol&&(e=e.replace(/^(?:https?:)?\/\//,"")),e}var e$=class{constructor(e,t,n,i){let{url:r,context:s}=e;if(this.controlsManager=t,this.shared=n,this.condition=i,!r)throw new Error("Missing property");this.url=r.startsWith("mailto:")?r:$J(r,{removeTrailingSlash:!1,removeSingleSlash:!1,stripWWW:!1}),this.context=null!==s&&void 0!==s?s:"tab"}dispatch(){var e;if(!1===n1(this.shared,this.condition))return!1;_F?window.location.assign(this.url):("tab"===this.context||wF&&"none"===this.context?window.open(this.url,"_blank"):"window"===this.context?window.open(this.url,"_blank","width=".concat(window.innerWidth,", height=").concat(window.innerHeight)):window.open(this.url,"_parent"),null!==(e=this.controlsManager.orbitControls)&&void 0!==e&&e.onPointerUp(FF[0]),FF.splice(0,FF.length))}},t$=class{constructor(e,t,n,i,r){this.data=e,this.page=t,this.controlsManager=n,this.shared=i,this.condition=r,this.timeoutIdQueue=[],this.dispatchInner=()=>{this.objects.forEach(this.destroyCallback)},this.destroyCallback=e=>{var t;this.timeoutIdQueue.shift();let n=this.page.scene.find(e);if(void 0===n)return;let i=this.controlsManager.sharedGameControlGlobals.rapierWorld,r=!i||(null===(t=n.dataPatched.physics)||void 0===t?void 0:t.fusedBody);if(n.cloner){for(let e of n.cloner.children){var s;r?(e.playModeVisible=!1,e.rigidBody&&"positioned"===(null===(s=n.dataPatched.physics)||void 0===s?void 0:s.rigidBody)&&(this.controlsManager.sharedGameControlGlobals.colliderToEntity.delete(e.rigidBody.collider(0).handle),i.removeRigidBody(e.rigidBody),e.rigidBody=void 0),e.bvhGeometry&&(e.bvhGeometry=void 0)):void 0===this.clone||this.clone===e?(e.playModeVisible=!1,e.rigidBody&&(this.controlsManager.sharedGameControlGlobals.colliderToEntity.delete(e.rigidBody.collider(0).handle),i.removeRigidBody(e.rigidBody),e.rigidBody=void 0)):void 0===e.playModeVisible&&(e.playModeVisible=!0)}(r||void 0===this.clone||!1===this.clone)&&(n.visible=!1,n.rigidBody&&(this.controlsManager.sharedGameControlGlobals.colliderToEntity.delete(n.rigidBody.collider(0).handle),i.removeRigidBody(n.rigidBody),n.rigidBody=void 0),n.bvhGeometry&&(n.bvhGeometry=void 0))}else n.rigidBody&&(this.controlsManager.sharedGameControlGlobals.colliderToEntity.delete(n.rigidBody.collider(0).handle),i.removeRigidBody(n.rigidBody),n.rigidBody=void 0),n.bvhGeometry&&(n.bvhGeometry=void 0),n.visible=!1;this.controlsManager.sharedGameControlGlobals.entitiesWithTransformAnim=void 0===i?this.controlsManager.sharedGameControlGlobals.entitiesWithTransformAnim.filter((e=>void 0!==e.bvhGeometry)):this.controlsManager.sharedGameControlGlobals.entitiesWithTransformAnim.filter((e=>void 0!==e.rigidBody)),n.destroyedInAction=!0,this.controlsManager.requestRender()},this.objects=[...e.objects]}dispatch(e){if(!1===n1(this.shared,this.condition))return!1;this.clone=e,this.data.delay?this.timeoutIdQueue.push(window.setTimeout(this.dispatchInner,1e3*this.data.delay)):this.dispatchInner()}dispatchFromStart(){if(!1===n1(this.shared,this.condition))return!1;this.timeoutIdQueue.push(window.setTimeout(this.dispatchInner,1e3*this.data.delay))}dispose(){this.timeoutIdQueue.forEach((e=>window.clearTimeout(e)))}},n$=class{constructor(e,t,n,i,r){this.data=e,this.page=t,this.shared=n,this.eventManager=i,this.condition=r,this.shared=n}dispatch(){var e;if(!1===n1(this.shared,this.condition))return!1;clearTimeout(this.timeoutId),delete this.timeoutId,this.timeoutId=window.setTimeout((()=>{var e;this.shared.reset(this.shared.data,!0),B0(this.page,this.shared,!0),this.eventManager.reset(),null!==(e=this.eventManager.controlsManager.gameControl)&&void 0!==e&&e.reset(!0),this.page.switchToPlayCamera(),this.eventManager.controlsManager.requestRender(),delete this.timeoutId}),1e3*(null!==(e=this.data.delay)&&void 0!==e?e:0))}dispose(){clearTimeout(this.timeoutId),delete this.timeoutId}},i$={update:null,begin:null,loopBegin:null,changeBegin:null,change:null,changeComplete:null,timelineChangeComplete:null,loopComplete:null,complete:null,loop:1,direction:"normal",autoplay:!0,timelineOffset:0,rewind:!0},r$={duration:1e3,delay:0,endDelay:0,startOnceDelay:0,pingPongDelayCorrection:0,pingPongEndDelayCorrection:0,easing:"easeOutElastic(1, .5)",round:0},s$=["translateX","translateY","translateZ","rotate","rotateX","rotateY","rotateZ","scale","scaleX","scaleY","scaleZ","skew","skewX","skewY","perspective","matrix","matrix3d"],a$={CSS:{},springs:{}};function o$(e,t,n){return Math.min(Math.max(e,t),n)}function l$(e,t){return e.indexOf(t)>-1}function u$(e,t){return e.apply(null,t)}var c$={arr:function(e){return Array.isArray(e)},obj:function(e){return l$(Object.prototype.toString.call(e),"Object")},pth:function(e){return c$.obj(e)&&e.hasOwnProperty("totalLength")},svg:function(e){return e instanceof SVGElement},inp:function(e){return e instanceof HTMLInputElement},dom:function(e){return!("isNode"in e)&&(e.nodeType||c$.svg(e))},str:function(e){return"string"==typeof e},fnc:function(e){return"function"==typeof e},und:function(e){return typeof e>"u"},hex:function(e){return/(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)/i.test(e)},rgb:function(e){return/^rgb/.test(e)},hsl:function(e){return/^hsl/.test(e)},col:function(e){return c$.hex(e)||c$.rgb(e)||c$.hsl(e)},key:function(e){return!i$.hasOwnProperty(e)&&!r$.hasOwnProperty(e)&&"targets"!==e&&"keyframes"!==e}};function h$(e){var t=/\(([^)]+)\)/.exec(e);return t?t[1].split(",").map((function(e){return parseFloat(e)})):[]}function d$(e,t){var n=h$(e),i=o$(c$.und(n[0])?1:n[0],.1,100),r=o$(c$.und(n[1])?100:n[1],.1,100),s=o$(c$.und(n[2])?10:n[2],.1,100),a=o$(c$.und(n[3])?0:n[3],.1,100),o=Math.sqrt(r/i),l=s/(2*Math.sqrt(r*i)),u=l<1?o*Math.sqrt(1-l*l):0,c=l<1?(l*o-a)/u:-a+o;function h(e){var n=t?t*e/1e3:e;return n=l<1?Math.exp(-n*l*o)*(1*Math.cos(u*n)+c*Math.sin(u*n)):(1+c*n)*Math.exp(-n*o),0===e||1===e?e:1-n}return t?h:function(){var t=a$.springs[e];if(t)return t;for(var n=1/6,i=0,r=0;;)if(1===h(i+=n)){if(++r>=16)break}else r=0;var s=i*n*1e3;return a$.springs[e]=s,s}}function p$(e){return void 0===e&&(e=10),function(t){return Math.ceil(o$(t,1e-6,1)*e)*(1/e)}}var f$=function(){var e=.1;function t(e,t){return 1-3*t+3*e}function n(e,t){return 3*t-6*e}function i(e){return 3*e}function r(e,r,s){return((t(r,s)*e+n(r,s))*e+i(r))*e}function s(e,r,s){return 3*t(r,s)*e*e+2*n(r,s)*e+i(r)}return function(t,n,i,a){if(0<=t&&t<=1&&0<=i&&i<=1){var o=new Float32Array(11);if(t!==n||i!==a)for(var l=0;l<11;++l)o[l]=r(l*e,t,i);return function(e){return t===n&&i===a||0===e||1===e?e:r(u(e),n,a)}}function u(n){for(var a=0,l=1;10!==l&&o[l]<=n;++l)a+=e;--l;var u=a+(n-o[l])/(o[l+1]-o[l])*e,c=s(u,t,i);return c>=.001?function(e,t,n,i){for(var a=0;a<4;++a){var o=s(t,n,i);if(0===o)return t;t-=(r(t,n,i)-e)/o}return t}(n,u,t,i):0===c?u:function(e,t,n,i,s){var a,o,l=0;do{(a=r(o=t+(n-t)/2,i,s)-e)>0?n=o:t=o}while(Math.abs(a)>1e-7&&++l<10);return o}(n,a,a+e,t,i)}}}(),m$=function(){var e={linear:function(){return function(e){return e}}},t={Sine:function(){return function(e){return 1-Math.cos(e*Math.PI/2)}},Circ:function(){return function(e){return 1-Math.sqrt(1-e*e)}},Back:function(){return function(e){return e*e*(3*e-2)}},Bounce:function(){return function(e){for(var t,n=4;e<((t=Math.pow(2,--n))-1)/11;);return 1/Math.pow(4,3-n)-7.5625*Math.pow((3*t-2)/22-e,2)}},Elastic:function(e,t){void 0===e&&(e=1),void 0===t&&(t=.5);var n=o$(e,1,10),i=o$(t,.1,2);return function(e){return 0===e||1===e?e:-n*Math.pow(2,10*(e-1))*Math.sin((e-1-i/(2*Math.PI)*Math.asin(1/n))*(2*Math.PI)/i)}}};return["Quad","Cubic","Quart","Quint","Expo"].forEach((function(e,n){t[e]=function(){return function(e){return Math.pow(e,n+2)}}})),Object.keys(t).forEach((function(n){var i=t[n];e["easeIn"+n]=i,e["easeOut"+n]=function(e,t){return function(n){return 1-i(e,t)(1-n)}},e["easeInOut"+n]=function(e,t){return function(n){return n<.5?i(e,t)(2*n)/2:1-i(e,t)(-2*n+2)/2}}})),e}();function g$(e,t){if(c$.fnc(e))return e;var n=e.split("(")[0],i=m$[n],r=h$(e);switch(n){case"spring":return d$(e,t);case"cubicBezier":return u$(f$,r);case"steps":return u$(p$,r);default:return u$(i,r)}}function v$(e){try{return document.querySelectorAll(e)}catch(t){return}}function y$(e,t){for(var n=e.length,i=arguments.length>=2?arguments[1]:void 0,r=[],s=0;s<n;s++)if(s in e){var a=e[s];t.call(i,a,s,e)&&r.push(a)}return r}function x$(e){return e.reduce((function(e,t){return e.concat(c$.arr(t)?x$(t):t)}),[])}function b$(e){return c$.arr(e)?e:(c$.str(e)&&(e=v$(e)||e),e instanceof NodeList||e instanceof HTMLCollection?[].slice.call(e):[e])}function w$(e,t){return e.some((function(e){return e===t}))}function D$(e){var t={};for(var n in e)t[n]=e[n];return t}function _$(e,t){var n=D$(e);for(var i in e)n[i]=t.hasOwnProperty(i)?t[i]:e[i];return n}function S$(e,t){var n=D$(e);for(var i in t)n[i]=c$.und(e[i])?t[i]:e[i];return n}function E$(e){return c$.rgb(e)?function(e){var t=/rgb\((\d+,\s*[\d]+,\s*[\d]+)\)/g.exec(e);return t?"rgba("+t[1]+",1)":e}(e):c$.hex(e)?function(e){var t=e.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,(function(e,t,n,i){return t+t+n+n+i+i})),n=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return"rgba("+parseInt(n[1],16)+","+parseInt(n[2],16)+","+parseInt(n[3],16)+",1)"}(e):c$.hsl(e)?function(e){var t,n,i,r=/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.exec(e)||/hsla\((\d+),\s*([\d.]+)%,\s*([\d.]+)%,\s*([\d.]+)\)/g.exec(e),s=parseInt(r[1],10)/360,a=parseInt(r[2],10)/100,o=parseInt(r[3],10)/100,l=r[4]||1;function u(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+6*(t-e)*n:n<.5?t:n<2/3?e+(t-e)*(2/3-n)*6:e}if(0==a)t=n=i=o;else{var c=o<.5?o*(1+a):o+a-o*a,h=2*o-c;t=u(h,c,s+1/3),n=u(h,c,s),i=u(h,c,s-1/3)}return"rgba("+255*t+","+255*n+","+255*i+","+l+")"}(e):void 0}function C$(e){var t=/[+-]?\d*\.?\d+(?:\.\d+)?(?:[eE][+-]?\d+)?(%|px|pt|em|rem|in|cm|mm|ex|ch|pc|vw|vh|vmin|vmax|deg|rad|turn)?$/.exec(e);if(t)return t[1]}function A$(e,t){return c$.fnc(e)?e(t.target,t.id,t.total):e}function M$(e,t){return e.getAttribute(t)}function T$(e,t,n){if(w$([n,"deg","rad","turn"],C$(t)))return t;var i=a$.CSS[t+n];if(!c$.und(i))return i;var r=document.createElement(e.tagName),s=e.parentNode&&e.parentNode!==document?e.parentNode:document.body;s.appendChild(r),r.style.position="absolute",r.style.width=100+n;var a=100/r.offsetWidth;s.removeChild(r);var o=a*parseFloat(t);return a$.CSS[t+n]=o,o}function P$(e,t,n){if(t in e.style){var i=t.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),r=e.style[t]||getComputedStyle(e).getPropertyValue(i)||"0";return n?T$(e,r,n):r}}function F$(e,t){return c$.dom(e)&&!c$.inp(e)&&(M$(e,t)||c$.svg(e)&&e[t])?"attribute":c$.dom(e)&&w$(s$,t)?"transform":c$.dom(e)&&"transform"!==t&&P$(e,t)?"css":null!=e[t]?"object":void 0}function O$(e){if(c$.dom(e)){for(var t,n=e.style.transform||"",i=/(\w+)\(([^)]*)\)/g,r=new Map;t=i.exec(n);)r.set(t[1],t[2]);return r}}function I$(e,t,n,i){var r=l$(t,"scale")?1:0+function(e){return l$(e,"translate")||"perspective"===e?"px":l$(e,"rotate")||l$(e,"skew")?"deg":void 0}(t),s=O$(e).get(t)||r;return n&&(n.transforms.list.set(t,s),n.transforms.last=t),i?T$(e,s,i):s}function k$(e,t,n,i){switch(F$(e,t)){case"transform":return I$(e,t,i,n);case"css":return P$(e,t,n);case"attribute":return M$(e,t);default:return e[t]||0}}function B$(e,t){var n=/^(\*=|\+=|-=)/.exec(e);if(!n)return e;var i=C$(e)||0,r=parseFloat(t),s=parseFloat(e.replace(n[0],""));switch(n[0][0]){case"+":return r+s+i;case"-":return r-s+i;case"*":return r*s+i}}function R$(e,t){if(c$.col(e))return E$(e);if(/\s/g.test(e))return e;var n=C$(e),i=n?e.substr(0,e.length-n.length):e;return t?i+t:i}function L$(e,t){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}function z$(e){for(var t,n=e.points,i=0,r=0;r<n.numberOfItems;r++){var s=n.getItem(r);r>0&&(i+=L$(t,s)),t=s}return i}function N$(e){if(e.getTotalLength)return e.getTotalLength();switch(e.tagName.toLowerCase()){case"circle":return function(e){return 2*Math.PI*M$(e,"r")}(e);case"rect":return function(e){return 2*M$(e,"width")+2*M$(e,"height")}(e);case"line":return function(e){return L$({x:M$(e,"x1"),y:M$(e,"y1")},{x:M$(e,"x2"),y:M$(e,"y2")})}(e);case"polyline":return z$(e);case"polygon":return function(e){var t=e.points;return z$(e)+L$(t.getItem(t.numberOfItems-1),t.getItem(0))}(e)}}function j$(e,t){var n=t||{},i=n.el||function(e){for(var t=e.parentNode;c$.svg(t)&&c$.svg(t.parentNode);)t=t.parentNode;return t}(e),r=i.getBoundingClientRect(),s=M$(i,"viewBox"),a=r.width,o=r.height,l=n.viewBox||(s?s.split(" "):[0,0,a,o]);return{el:i,viewBox:l,x:l[0]/1,y:l[1]/1,w:a/l[2],h:o/l[3]}}function U$(e,t){function n(n){void 0===n&&(n=0);var i=t+n>=1?t+n:0;return e.el.getPointAtLength(i)}var i=j$(e.el,e.svg),r=n(),s=n(-1),a=n(1);switch(e.property){case"x":return(r.x-i.x)*i.w;case"y":return(r.y-i.y)*i.h;case"angle":return 180*Math.atan2(a.y-s.y,a.x-s.x)/Math.PI}}function V$(e,t){var n=/[+-]?\d*\.?\d+(?:\.\d+)?(?:[eE][+-]?\d+)?/g,i=R$(c$.pth(e)?e.totalLength:e,t)+"";return{original:i,numbers:i.match(n)?i.match(n).map(Number):[0],strings:c$.str(e)||t?i.split(n):[]}}function H$(e){return y$(e?x$(c$.arr(e)?e.map(b$):b$(e)):[],(function(e,t,n){return n.indexOf(e)===t}))}function W$(e){var t=H$(e);return t.map((function(e,n){return{target:e,id:n,total:t.length,transforms:{list:O$(e)}}}))}function G$(e,t){var n=D$(t);if(/^spring/.test(n.easing)&&(n.duration=d$(n.easing)),c$.arr(e)){var i=e.length;2===i&&!c$.obj(e[0])?e={value:e}:c$.fnc(t.duration)||(n.duration=t.duration/i)}var r=c$.arr(e)?e:[e];return r.map((function(e,n){var i=c$.obj(e)&&!c$.pth(e)?e:{value:e};return c$.und(i.delay)&&(i.delay=n?0:t.delay),c$.und(i.endDelay)&&(i.endDelay=n===r.length-1?t.endDelay:0),i})).map((function(e){return S$(e,n)}))}function q$(e,t){var n=[],i=t.keyframes;for(var r in i&&(t=S$(function(e){for(var t=y$(x$(e.map((function(e){return Object.keys(e)}))),(function(e){return c$.key(e)})).reduce((function(e,t){return e.indexOf(t)<0&&e.push(t),e}),[]),n={},i=function(i){var r=t[i];n[r]=e.map((function(e){var t={};for(var n in e)c$.key(n)?n==r&&(t.value=e[n]):t[n]=e[n];return t}))},r=0;r<t.length;r++)i(r);return n}(i),t)),t)c$.key(r)&&n.push({name:r,tweens:G$(t[r],e)});return n}function Y$(e,t){var n;return e.tweens.map((function(i){var r=function(e,t){var n={};for(var i in e){var r=A$(e[i],t);c$.arr(r)&&(r=r.map((function(e){return A$(e,t)})),1===r.length&&(r=r[0])),n[i]=r}return n.duration=parseFloat(n.duration),n.delay=parseFloat(n.delay),n}(i,t),s=r.value,a=c$.arr(s)?s[1]:s,o=C$(a),l=k$(t.target,e.name,o,t),u=n?n.to.original:l,c=c$.arr(s)?s[0]:u,h=C$(c)||C$(l),d=o||h;return c$.und(a)&&(a=u),r.from=V$(c,d),r.to=V$(B$(a,c),d),r.start=n?n.end:0,r.end=r.start+r.delay+r.duration+r.endDelay,r.easing=g$(r.easing,r.duration),r.isPath=c$.pth(s),r.isColor=c$.col(r.from.original),r.isColor&&(r.round=1),n=r,r}))}var X$={css:function(e,t,n){return e.style[t]=n},attribute:function(e,t,n){return e.setAttribute(t,n)},object:function(e,t,n){return e[t]=n},transform:function(e,t,n,i,r){if(i.list.set(t,n),t===i.last||r){var s="";i.list.forEach((function(e,t){s+=t+"("+e+") "})),e.style.transform=s}}};function Q$(e,t){W$(e).forEach((function(e){for(var n in t){var i=A$(t[n],e),r=e.target,s=C$(i),a=k$(r,n,s,e),o=B$(R$(i,s||C$(a)),a),l=F$(r,n);X$[l](r,n,o,e.transforms,!0)}}))}function K$(e,t){return y$(x$(e.map((function(e){return t.map((function(t){return function(e,t){var n=F$(e.target,t.name);if(n){var i=Y$(t,e),r=i[i.length-1];return{type:n,property:t.name,animatable:e,tweens:i,duration:r.end,delay:i[0].delay,endDelay:r.endDelay}}}(e,t)}))}))),(function(e){return!c$.und(e)}))}function Z$(e,t){var n=e.length,i=function(e){return e.timelineOffset?e.timelineOffset:0},r={};return r.duration=n?Math.max.apply(Math,e.map((function(e){var t,n,r,s;let a=null!==(t=e.startOnceDelay)&&void 0!==t?t:0,o=null!==(n=e.pingPongDelayCorrection)&&void 0!==n?n:0,l=null!==(r=e.pingPongEndDelayCorrection)&&void 0!==r?r:0;return i(e)+a+o+l+e.duration*(null!==(s=e.loop)&&void 0!==s?s:1)}))):t.duration,r.delay=n?Math.min.apply(Math,e.map((function(e){var t,n;let r=null!==(t=e.startOnceDelay)&&void 0!==t?t:0,s=null!==(n=e.pingPongDelayCorrection)&&void 0!==n?n:0;return i(e)+r+s+e.delay}))):t.delay,r.endDelay=n?r.duration-Math.max.apply(Math,e.map((function(e){var t,n,r,s;let a=null!==(t=e.startOnceDelay)&&void 0!==t?t:0,o=null!==(n=e.pingPongDelayCorrection)&&void 0!==n?n:0,l=null!==(r=e.pingPongEndDelayCorrection)&&void 0!==r?r:0;return i(e)+a+o+e.duration*(null!==(s=e.loop)&&void 0!==s?s:1)-e.endDelay-l}))):t.endDelay,r}var J$=0;var $$,e0=[],t0=[],n0=function(){function e(){$$=requestAnimationFrame(t)}function t(t){var n=e0.length;if(n){for(var i=0;i<n;){var r=e0[i];r.paused?(e0.splice(i,1),n-=1):(r.tick(t),i++)}e()}else $$=cancelAnimationFrame($$)}return e}();function i0(e){void 0===e&&(e={});var t,n,i=0,r=0,s=0,a=0,o=null;function l(e){var t=window.Promise&&new Promise((function(e){return o=e}));return e.finished=t,t}var u=function(e){var t=_$(i$,e),n=_$(r$,e),i=q$(n,e),r=W$(e.targets),s=K$(r,i),a=Z$(s,n),o=J$;return J$++,S$(t,{id:o,children:[],animatables:r,animations:s,duration:a.duration,delay:a.delay,endDelay:a.endDelay,startOnceDelay:n.startOnceDelay,pingPongDelayCorrection:n.pingPongDelayCorrection,pingPongEndDelayCorrection:n.pingPongEndDelayCorrection})}(e);l(u);function c(){var e=u.direction;"alternate"!==e&&(u.direction="normal"!==e?"normal":"reverse"),u.reversed=!u.reversed,n.forEach((function(e){(1===e.loop||e.loop%2===0)&&(e.reversed=u.reversed)}))}function h(e){return u.reversed?u.duration-e:e}function d(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];t&&(u.reversed?t.seek(t.duration*t.loop-(e-t.timelineOffset-t.pingPongDelayCorrection),n):t.seek(e-t.timelineOffset-t.startOnceDelay-t.pingPongDelayCorrection,n))}function p(e){var t=0,n=u.animations,i=n.length;for("alternate"!==u.direction&&"alternate"===(null===(r=u.parent)||void 0===r?void 0:r.direction)?!1===(null===(s=u.parent)||void 0===s?void 0:s.rewind)&&!0===u.reversePlayback&&!1===u.rewind&&(e=null!==(a=u.parent)&&void 0!==a&&a.reversed&&"alternate"===u.direction?u.duration-u.delay+u.endDelay-e:u.duration+u.delay-u.endDelay-e):g(!1,null===(o=u.parent)||void 0===o?void 0:o.rewind,u.rewind,null===(l=u.parent)||void 0===l?void 0:l.reversePlayback,u.reversePlayback)&&(e=null!==(c=u.parent)&&void 0!==c&&c.reversed&&"alternate"===u.direction?u.duration-u.delay+u.endDelay-e:u.duration+u.delay-u.endDelay-e);t<i;){var r,s,a,o,l,c,h,d=n[t],p=d.animatable,f=d.tweens,m=f.length-1,v=f[m];let i;m&&(v=y$(f,(function(t){return e<t.end}))[0]||v),i=null!==(h=u.parent)&&void 0!==h&&h.reversed&&"alternate"===u.direction?o$(e-v.start-v.endDelay,0,v.duration)/v.duration:o$(e-v.start-v.delay,0,v.duration)/v.duration;for(var y=isNaN(i)?1:v.easing(i),x=v.to.strings,b=v.round,w=[],D=v.to.numbers.length,_=void 0,S=0;S<D;S++){var E,C,A,M=void 0;let e,t;"alternate"!==u.direction?!1===(null===(E=u.parent)||void 0===E?void 0:E.rewind)&&!0===u.reversePlayback&&!1===u.rewind?(e=v.to.numbers[S],t=v.from.numbers[S]||0):(t=v.to.numbers[S],e=v.from.numbers[S]||0):g(!0,null===(C=u.parent)||void 0===C?void 0:C.rewind,u.rewind,null===(A=u.parent)||void 0===A?void 0:A.reversePlayback,u.reversePlayback)?(e=v.to.numbers[S],t=v.from.numbers[S]||0):(t=v.to.numbers[S],e=v.from.numbers[S]||0),M=v.isPath?U$(v.value,y*t):e+y*(t-e),b&&(v.isColor&&S>2||(M=Math.round(M*b)/b)),w.push(M)}var T=x.length;if(T){_=x[0];for(var P=0;P<T;P++){x[P];var F=x[P+1],O=w[P];isNaN(O)||(_+=F?O+F:O+" ")}}else _=w[0];X$[d.type](p.target,d.property,_,p.transforms),d.currentValue=_,t++}}function f(e){u[e]&&!u.passThrough&&u[e](u)}let m={0:!1,1:!0,2:!1,3:!0,4:!1,5:!1,6:!1,7:!1,8:!1,9:!0,10:!0,11:!1,12:!1,13:!1,14:!0,15:!0,16:!1,17:!0,18:!0,19:!1,20:!1,21:!1,22:!0,23:!0,24:!1,25:!0,26:!1,27:!0,28:!1,29:!1,30:!1,31:!1};function g(e,t,n,i,r){return m[e<<4|t<<3|n<<2|i<<1|r]}function v(e){var t;let r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];var s=u.duration;let m=u.delay,g=s-u.endDelay;(null===(t=u.parent)||void 0===t?void 0:t.reversed)&&"alternate"===u.direction&&(m=u.endDelay,g=s-u.delay);var v=h(e);if(u.progress=o$(v/s*100,0,100),r||(u.reversePlayback=v<u.currentTime),a&&function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(u.reversed)for(var i=a;i--;)d(e,n[i],t);else for(var r=0;r<a;r++)d(e,n[r],t)}(v,r),!u.began&&u.currentTime>=0&&(u.began=!0,f("begin")),!u.loopBegan&&u.currentTime>0&&(u.loopBegan=!0,f("loopBegin")),(u.reversed||v>=0)&&v<=m&&0!==u.currentTime&&(p(0),f("change")),(v>=g&&u.currentTime!==s+u.pingPongDelayCorrection||!s)&&(p(s),f("change")),v>m&&v<g?(u.changeBegan||(u.changeBegan=!0,u.changeCompleted=!1,f("changeBegin")),p(v),f("change")):u.changeBegan?(u.changeCompleted=!0,u.changeBegan=!1,f("change"),a&&f("timelineChangeComplete")):u.began&&v>g&&f("changeComplete"),u.currentTime=o$(v,0,s+u.pingPongDelayCorrection),u.began&&f("update"),e>=s)if(u.remaining&&!0!==u.remaining&&u.remaining--,u.remaining){i+=a?u.duration/i0.speed:u.duration;for(let e of n)e.setStartTime(0),e.remaining=e.loop;f("loopComplete"),u.loopBegan=!1,"alternate"===u.direction?c():a&&(u.direction="normal",u.reversed=!1,n.forEach((function(e){return e.reversed=!1})))}else u.paused=!0,u.completed||(u.completed=!0,f("loopComplete"),f("complete"),!u.passThrough&&"Promise"in window&&(o(),l(u)))}return u.reset=function(){var e=u.direction;u.passThrough=!1,u.currentTime=0,u.progress=0,u.paused=!0,u.began=!1,u.loopBegan=!1,u.changeBegan=!1,u.completed=!1,u.changeCompleted=!1,u.reversePlayback=!1,u.reversed="reverse"===e,u.remaining=u.loop,n=u.children;for(var t=a=n.length;t--;)u.children[t].reset();p(u.reversed?u.duration:0)},u.setStartTime=function(e){i=e},u.set=function(e,t){return Q$(e,t),u},u.tick=function(e){s=e,i||(i=s),v((s+(r-i))*i0.speed)},u.seek=function(e){v(e-i,arguments.length>1&&void 0!==arguments[1]&&arguments[1])},u.pause=function(e){u.paused=!0,a&&(t=null!==e&&void 0!==e?e:performance.now())},u.play=function(e){!u.paused||(u.completed&&u.reset(),u.paused=!1,e0.push(u),a&&void 0!==t&&(i+=(null!==e&&void 0!==e?e:performance.now())-t),$$||n0())},u.reverse=function(){c(),u.completed=!u.reversed,i=0,r=h(u.currentTime)*(1/i0.speed)},u.restart=function(){u.reset(),u.play()},u.reset(),u.autoplay&&u.play(),u}function r0(e,t){for(var n=t.length;n--;)w$(e,t[n].animatable.target)&&t.splice(n,1)}typeof document<"u"&&document.addEventListener("visibilitychange",(function(e){document.hidden?(e0.forEach((function(t){return t.pause(e.timeStamp)})),t0=e0.slice(0),i0.running=e0=[]):t0.forEach((function(t){return t.play(e.timeStamp)}))})),i0.version="3.2.0",i0.speed=1,i0.running=e0,i0.remove=function(e){for(var t=H$(e),n=e0.length;n--;){var i=e0[n],r=i.animations,s=i.children;r0(t,r);for(var a=s.length;a--;){var o=s[a],l=o.animations;r0(t,l),!l.length&&!o.children.length&&s.splice(a,1)}!r.length&&!s.length&&i.pause()}},i0.get=k$,i0.set=Q$,i0.convertPx=T$,i0.path=function(e,t){var n=c$.str(e)?v$(e)[0]:e,i=t||100;return function(e){return{property:e,el:n,svg:j$(n),totalLength:N$(n)*(i/100)}}},i0.setDashoffset=function(e){var t=N$(e);return e.setAttribute("stroke-dasharray",t),t},i0.stagger=function(e,t){void 0===t&&(t={});var n=t.direction||"normal",i=t.easing?g$(t.easing):null,r=t.grid,s=t.axis,a=t.from||0,o="first"===a,l="center"===a,u="last"===a,c=c$.arr(e),h=parseFloat(c?e[0]:e),d=c?parseFloat(e[1]):0,p=C$(c?e[1]:e)||0,f=t.start||0+(c?h:0),m=[],g=0;return function(e,t,v){if(o&&(a=0),l&&(a=(v-1)/2),u&&(a=v-1),!m.length){for(var y=0;y<v;y++){if(r){var x=l?(r[0]-1)/2:a%r[0],b=l?(r[1]-1)/2:Math.floor(a/r[0]),w=x-y%r[0],D=b-Math.floor(y/r[0]),_=Math.sqrt(w*w+D*D);"x"===s&&(_=-w),"y"===s&&(_=-D),m.push(_)}else m.push(Math.abs(a-y));g=Math.max.apply(Math,m)}i&&(m=m.map((function(e){return i(e/g)*g}))),"reverse"===n&&(m=m.map((function(e){return s?e<0?-1*e:-e:Math.abs(g-e)})))}return f+(c?(d-h)/g:h)*(Math.round(100*m[t])/100)+p}},i0.timeline=function(e){void 0===e&&(e={});var t=i0(e);return t.duration=0,t.add=function(n,i){var r=e0.indexOf(t),s=t.children;function a(e){e.passThrough=!0}r>-1&&e0.splice(r,1);for(var o=0;o<s.length;o++)a(s[o]);var l=S$(n,_$(r$,e));l.targets=l.targets||e.targets;var u=t.duration;l.autoplay=!1,l.timelineOffset=c$.und(i)?u:B$(i,u),a(t);var c=i0(l);a(c),s.push(c),c.parent=t;var h=Z$(s,e);return t.delay=h.delay,t.endDelay=h.endDelay,t.duration=h.duration,!0===c.loop&&(t.duration=1/0),t.seek(0),t.reset(),t.autoplay&&t.play(),t},t},i0.easing=g$,i0.penner=m$,i0.random=function(e,t){return Math.floor(Math.random()*(t-e+1))+e};var s0=i0,a0=new Lv,o0=new Lv,l0=new Rv;function u0(e,t,n,i,r,s){var a,o;let l=void 0!==n[e]?n[e]:void 0,u=i[e];if(null==u)return;let c=null!=l?"string"==typeof l?Number(null!==(a=r.getVariable(l))&&void 0!==a?a:0):l:t[e],h="string"==typeof u?Number(null!==(o=r.getVariable(u))&&void 0!==o?o:0):u;return c!==h?{update:n=>{let i=ov.lerp(c,h,n);t[e]=s?Math.trunc(i):i},start:()=>{t[e]=c},end:()=>{t[e]=h}}:void 0}function c0(e,t,n,i,r,s){let a=n[e]?n[e]:void 0,o=i[e];if(!o)return;let l=t[e],u=[...null!==a&&void 0!==a?a:l].map((e=>{var t;return"string"==typeof e?Number(null!==(t=r.getVariable(e))&&void 0!==t?t:0):e})),c=[...o].map((e=>{var t;return"string"==typeof e?Number(null!==(t=r.getVariable(e))&&void 0!==t?t:0):e}));return u.length!==c.length||oF(u,c)?void 0:{update:n=>{u.forEach(((i,r)=>{let a=ov.lerp(i,c[r],n);t[e][r]=s?Math.trunc(a):a}))},start:()=>{Object.assign(t[e],u)},end:()=>{Object.assign(t[e],c)}}}function h0(e,t,n){return t.forEach(((t,i)=>{var r;e.setComponent(i,"string"==typeof t?Number(null!==(r=n.getVariable(t))&&void 0!==r?r:0):t)})),e}function d0(e,t,n,i,r){let s=n[e]?n[e]:void 0,a=i[e];if(!a)return;let o=t[e],l=s?h0(new Lv,s,r):o.clone(),u=h0(new Lv,a,r);return l.equals(u)?void 0:{update:e=>{o.lerpVectors(l,u,e)},start:()=>{o.copy(l)},end:()=>{o.copy(u)}}}function p0(e,t,n){return t.forEach(((t,i)=>{var r;e.setComponent(i,"string"==typeof t?Number(null!==(r=n.getVariable(t))&&void 0!==r?r:0):t)})),e}function f0(e,t,n,i,r){let s=n[e]?n[e]:void 0,a=i[e];if(!a)return;let o=t[e],l=!(o instanceof lv),u=o instanceof lv?o:(new lv).fromArray(o),c=s?p0(new lv,s,r):u.clone(),h=p0(new lv,a,r);return c.equals(h)?void 0:{update:n=>{u.lerpVectors(c,h,n),l&&(t[e]=u.toArray())},start:()=>{u.copy(c),l&&(t[e]=u.toArray())},end:()=>{u.copy(h),l&&(t[e]=u.toArray())}}}function m0(e,t,n,i,r){let s=n[e]?n[e]:void 0,a=i[e];if(!a)return;let o=t[e],l=new jV(o.r,o.g,o.b,o.a),u=s?"string"==typeof s?r.getColor(s).clone():new jV(s.r,s.g,s.b,s.a):l.clone(),c="string"==typeof a?r.getColor(a).clone():new jV(a.r,a.g,a.b,a.a);return u.equals(c)?void 0:{update:n=>{l.lerpColors(u,c,n);let i=ov.lerp(u.a,c.a,n);l.a=i,t[e]={r:l.r,g:l.g,b:l.b,a:l.a}},start:()=>{l.copy(u)},end:()=>{l.copy(c)}}}function g0(e,t,n,i,r){return"number"==typeof t[e]?u0(e,t,null!==n&&void 0!==n?n:{},i,r):Array.isArray(t[e])?c0(e,t,null!==n&&void 0!==n?n:{},i,r):void 0}function v0(e,t,n,i){let r=[];if(!("geometry"in n))return r;let s=e.geometry.userData.parameters,a="geometry"in t?t.geometry:{},o=n.geometry;if(e instanceof Pq){let t=function(e,t,n,i){var r;if(void 0===n.scaleBaked)return;let s=(null!==(r=t.scaleBaked)&&void 0!==r?r:e.data.geometry.scaleBaked).map((e=>{var t;return"string"==typeof e?Number(null!==(t=i.getVariable(e))&&void 0!==t?t:0):e})),a=n.scaleBaked.map((e=>{var t;return"string"==typeof e?Number(null!==(t=i.getVariable(e))&&void 0!==t?t:0):e}));if(Rk.isEqual(s,a))return;let o=[];return o.push({update:t=>{e.updateGeometryInteractions({scaleBaked:[ov.lerp(s[0],a[0],t),ov.lerp(s[1],a[1],t),ov.lerp(s[2],a[2],t)]},i),e.invalidateDownstreamBooleanData(),e.refreshAttachedClonersInteractions()},start:()=>{e.updateGeometryInteractions({scaleBaked:s},i),e.invalidateDownstreamBooleanData(),e.refreshAttachedClonersInteractions()},end:()=>{e.updateGeometryInteractions({scaleBaked:a},i),e.invalidateDownstreamBooleanData(),e.refreshAttachedClonersInteractions()}}),o}(e,a,o,i);t&&r.push(...t)}else{let t={};if(Object.assign(t,vF(s,yR),vF(a,yR)),yR.forEach((e=>{let n=g0(e,t,a,o,i);n&&r.push(n)})),e instanceof aZ){Object.assign(t,{extrusion:d({},s.extrusion)});let e=function(e,t,n,i){var r;if(!n.extrusion)return;let s=e.extrusion,a=null!==(r=t.extrusion)&&void 0!==r?r:{},o=n.extrusion,l=[];return TB.forEach((e=>{let t=g0(e,s,a,o,i);t&&l.push(t)})),l}(t,a,o,i);e&&r.push(...e)}r.length&&r.push({update:n=>{e.updateGeometryInteractions(t,i),e.updateGeometryGroupsIfNeeded(),e.refreshAttachedClonersInteractions()},start:n=>{e.updateGeometryInteractions(t,i),e.updateGeometryGroupsIfNeeded(),e.refreshAttachedClonersInteractions()},end:n=>{e.updateGeometryInteractions(t,i),e.updateGeometryGroupsIfNeeded(),e.refreshAttachedClonersInteractions()}})}return r}function y0(e,t,n,i){let r=[];if(void 0!==n.intensity){let s=u0("intensity",e,t,n,i);s&&r.push(s)}if(void 0!==n.color){let s=function(e,t,n,i,r){let s=n[e]?n[e]:void 0,a=i[e];if(!a)return;let o=t[e],l=s?"string"==typeof s?r.getColor(s).clone():(new Ev).setRGB(s.r,s.g,s.b):o.clone(),u="string"==typeof a?r.getColor(a).clone():(new Ev).setRGB(a.r,a.g,a.b);if(l.equals(u))return;let c=o.clone();return{update:n=>{var i,r;c.lerpColors(l,u,n),null===(i=t[e])||void 0===i||null===(r=i.copy)||void 0===r||r.call(i,c)},start:()=>{c.copy(l)},end:()=>{c.copy(u)}}}("color",e,t,n,i);s&&r.push(s)}return r}function x0(e,t,n,i){let r=[],s=hG(n,i)||!!t.layers&&hG(t,i);r.push(function(e,t){return{update:()=>{e.transparent=t}}}(e,s));for(let u of e.layers){var a,o,l;let e=null===(a=t.layers)||void 0===a?void 0:a.data(u.uuid),s=n.layers.data(u.uuid);if(!s||"light"!==u.type&&(null!==(o=u.visible)&&void 0!==o&&!o||null!==(l=s.visible)&&void 0!==l&&!l))continue;let c=u.getNames().filter((e=>!wB.some((t=>e.includes(t)))));for(let t of c)try{let n,a=u.getValue(t);if("colors"===t)n=C0(u,e,s,t);else if(Array.isArray(a))"steps"===t&&(n=E0(u,e,s,t));else if("number"==typeof a)n=b0(u,e,s,t,i);else{if("boolean"==typeof a)continue;a instanceof lv?n=w0(u,e,s,t):a instanceof Lv?n=D0(u,e,s,t,i):a instanceof jV?n=S0(u,e,s,t,i):a instanceof Ev?n=_0(u,e,s,t,i):"isTexture"in a&&(n=A0(u,e,s,t))}n&&(Array.isArray(n)?r.push(...n):r.push(n))}catch(Zn){console.error("lerpMaterial: unexpected material layer for ".concat(t),Zn)}}return r}function b0(e,t,n,i,r){var s,a;if(!e.hasValue(i)||!(i in n))return;let o=t?t[i]:e.getValue(i),l=n[i],u="string"==typeof o?Number(null!==(s=r.getVariable(o))&&void 0!==s?s:0):o,c="string"==typeof l?Number(null!==(a=r.getVariable(l))&&void 0!==a?a:0):l;return u!==c?{update:t=>{e.setValue(i,ov.lerp(u,c,t))},start:()=>{e.setValue(i,u)},end:()=>{e.setValue(i,c)}}:void 0}function w0(e,t,n,i){if(!e.hasValue(i)||!(i in n))return;let r=e.getValue(i),s=t?(new lv).fromArray(t[i]):r.clone(),a=(new lv).fromArray(n[i]);return s.equals(a)?void 0:{update:e=>{r.lerpVectors(s,a,e)},start:()=>{r.copy(s)},end:()=>{r.copy(a)}}}function D0(e,t,n,i,r){if(!e.hasValue(i)||!(i in n))return;let s=e.getValue(i),a=t?t[i]:void 0,o=n[i],l=a?h0(new Lv,a,r):s.clone(),u=h0(new Lv,o,r);return l.equals(u)?void 0:{update:e=>{s.lerpVectors(l,u,e)},start:()=>{s.copy(l)},end:()=>{s.copy(u)}}}function _0(e,t,n,i,r){if(!e.hasValue(i)||!(i in n))return;let s=t?t[i]:void 0,a=n[i],o=e.getValue(i),l=s?"string"==typeof s?r.getColor(s).clone():(new Ev).setRGB(s.r,s.g,s.b):o.clone(),u="string"==typeof a?r.getColor(a).clone():(new Ev).setRGB(a.r,a.g,a.b);if(l.equals(u))return;let c=o.clone();return{update:t=>{e.getValue(i)!==c&&e.setValue(i,c),c.lerpColors(l,u,t)},start:()=>{c.copy(l)},end:()=>{c.copy(u)}}}function S0(e,t,n,i,r){if(!e.hasValue(i)||!(i in n))return;let s=t?t[i]:void 0,a=n[i],o=e.getValue(i),l=s?"string"==typeof s?r.getColor(s).clone():(new Ev).setRGB(s.r,s.g,s.b):o.clone(),u="string"==typeof a?r.getColor(a).clone():new jV(a.r,a.g,a.b,a.a);if(l.equals(u))return;let c=o.clone();return{update:t=>{e.getValue(i)!==c&&e.setValue(i,c),c.lerpColors(l,u,t)},start:()=>{c.copy(l)},end:()=>{c.copy(u)}}}function E0(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"steps";if(!e.hasValue(i)||!(i in n))return;let r=[],s=e.getValue(i),a=t?t[i]:s,o=n[i];return oF(a,o)||r.push({update:t=>{let n=[...s];for(let e=0;e<s.length;++e){let i=a[e],r=o[e];n[e]=ov.lerp(i,r,t)}e.setValue(i,n)},start:()=>{e.setValue(i,a)},end:()=>{e.setValue(i,o)}}),r.length?r:void 0}function C0(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"colors";if(!e.hasValue(i)||!(i in n))return;let r=[],s=e.getValue(i),a=t?t[i]:s.map((e=>e.toArray())),o=n[i];for(let l=0;l<s.length;++l){let e=[...a[l]],t=[...o[l]];Lk.isEqual(e,t)||r.push({update:n=>{s[l].fromArray(Lk.lerp(e,t,n))},start:()=>{s[l].fromArray(e)},end:()=>{s[l].fromArray(t)}})}return r.length?r:void 0}function A0(e,t,n){var i,r,s,a,o,l;let u=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"texture";if(!e.hasValue(u)||!(u in n))return;let c=e.getNode("rotation"),h=null!==(i=null===t||void 0===t||null===(r=t[u])||void 0===r?void 0:r.rotation)&&void 0!==i?i:0,d=null!==(s=null===(a=n[u])||void 0===a?void 0:a.rotation)&&void 0!==s?s:0;if(c&&h!==d)return{update:e=>{c.value=ov.lerp(h,d,e)*ov.DEG2RAD},start:()=>{c.value=h*ov.DEG2RAD},end:()=>{c.value=d*ov.DEG2RAD}};let p=e.getNode("mat");if(!p)return;let f=t?t[u]:p,m=n[u],g=[...f.repeat],v=[...f.offset],y=[...m.repeat],x=[...m.offset],b=null!==(o=f.rotation)&&void 0!==o?o:0,w=null!==(l=m.rotation)&&void 0!==l?l:0;return Bk.isEqual(g,y)&&Bk.isEqual(v,x)&&b===w?void 0:{update:e=>{p.repeat=Bk.lerp(g,y,e),p.offset=Bk.lerp(v,x,e),p.rotation=ov.lerp(b,w,e),p.updateMatrix()},start:()=>{p.repeat=[...g],p.offset=[...v],p.rotation=b,p.updateMatrix()},end:()=>{p.repeat=[...y],p.offset=[...x],p.rotation=w,p.updateMatrix()}}}var M0=new Lv,T0=new _y;function P0(e,t,n,i,r){var s,a,o,l,u,c,h,d,p,f,m,g,v,y,x,b,w,D;let _,S,E,C,A,M,T,P,F=[];if(e instanceof lK?(_=f0("position",e,t,n,r),_&&F.push(_),E=u0("rotation",e,t,n,r),E&&F.push(E),C=f0("shear",e,t,n,r),C&&F.push(C)):(P={slide:null!==(s=null!==(a=null!==(o=null===(l=t.pathSnapping)||void 0===l?void 0:l.slide)&&void 0!==o?o:null===(u=e.updatedPathSnapping)||void 0===u?void 0:u.slide)&&void 0!==a?a:null===(c=e.dataPatched.pathSnapping)||void 0===c?void 0:c.slide)&&void 0!==s?s:0,offset:null!==(h=null!==(d=null!==(p=null===(f=t.pathSnapping)||void 0===f?void 0:f.offset)&&void 0!==p?p:null===(m=e.updatedPathSnapping)||void 0===m?void 0:m.offset)&&void 0!==d?d:null===(g=e.dataPatched.pathSnapping)||void 0===g?void 0:g.offset)&&void 0!==h?h:0},M=u0("slide",P,null!==(v=null!==(y=t.pathSnapping)&&void 0!==y?y:e.updatedPathSnapping)&&void 0!==v?v:e.dataPatched.pathSnapping,null!==(x=n.pathSnapping)&&void 0!==x?x:e.dataPatched.pathSnapping,r),M&&F.push(M),T=u0("offset",P,null!==(b=null!==(w=t.pathSnapping)&&void 0!==w?w:e.updatedPathSnapping)&&void 0!==b?b:e.dataPatched.pathSnapping,null!==(D=n.pathSnapping)&&void 0!==D?D:e.dataPatched.pathSnapping,r),T&&F.push(T),!M&&!T&&(_=d0("position",e,t,n,r),_&&F.push(_),S=d0("scale",e,t,n,r),S&&F.push(S),E=function(e,t,n,i,r){var s;let a=null!==t&&void 0!==t&&t.rotation?t.rotation.map((e=>{var t;return("string"==typeof e?Number(null!==(t=r.getVariable(e))&&void 0!==t?t:0):e)*ov.DEG2RAD})):void 0,o=null===(s=n.rotation)||void 0===s?void 0:s.map((e=>{var t;return("string"==typeof e?Number(null!==(t=r.getVariable(e))&&void 0!==t?t:0):e)*ov.DEG2RAD}));if(!o)return;let l=a?(new Lv).fromArray(a):(new Lv).setFromEuler(e.rotation),u=(new Lv).fromArray(o);if(l.equals(u))return;let c=M0.subVectors(u,l);if(i&&c.toArray().every((e=>Math.abs(e)<2*Math.PI))){let t=(new Rv).setFromEuler(T0.setFromVector3(l)),n=(new Rv).setFromEuler(T0.setFromVector3(u));return{update:i=>{!function(e,t,n,i){if(0===i)return n.copy(e);if(1===i)return n.copy(t);let r=e.w*t.w+e.x*t.x+e.y*t.y+e.z*t.z;if(r>=1)return n.copy(e);let s=1-r*r;if(s<=Number.EPSILON){let r=1-i;return n.w=r*e.w+i*t.w,n.x=r*e.x+i*t.x,n.y=r*e.y+i*t.y,n.z=r*e.z+i*t.z,n.normalize(),n}let a=Math.sqrt(s),o=Math.atan2(a,r),l=Math.sin((1-i)*o)/a,u=Math.sin(i*o)/a;n.w=e.w*l+t.w*u,n.x=e.x*l+t.x*u,n.y=e.y*l+t.y*u,n.z=e.z*l+t.z*u}(t,n,e.quaternion,i)},start:()=>{e.rotation.setFromVector3(l)},end:()=>{e.rotation.setFromVector3(u)}}}return{update:t=>{M0.lerpVectors(l,u,t),e.rotation.setFromVector3(M0)},start:()=>{e.rotation.setFromVector3(l)},end:()=>{e.rotation.setFromVector3(u)}}}(e,t,n,i,r),E&&F.push(E),A=function(e,t,n,i){let r=n[e]?n[e]:void 0,s=i[e];if(!s)return;let a=t[e],o=r?(new py).fromArray(r):a.clone(),l=new Lv,u=new Rv,c=new Lv;o.decompose(l,u,c);let h=(new py).fromArray(s),d=new Lv,p=new Rv,f=new Lv;return h.decompose(d,p,f),o.equals(h)?void 0:{update:e=>{l0.slerpQuaternions(u,p,e),a0.lerpVectors(l,d,e),o0.lerpVectors(c,f,e),a.compose(a0,l0,o0)},start:()=>{a.compose(l,u,c)},end:()=>{a.compose(d,p,f)}}}("hiddenMatrix",e,t,n),A&&F.push(A))),_||S||E||A||M||T){let n=e instanceof lK?()=>{e.updateWorldMatrix(!0,!1,!0),e.resetBBoxNeedsUpdate()}:()=>{var n;e.updateMatrix(),e.hasNonUniformScale&&(e.updateMatrixWorld(),e.updateMatrixWorldSVD()),null!==(n=e.parent)&&void 0!==n&&n.matrixWorldFusedFalse&&(e.matrixWorld.multiplyMatrices(e.parent.matrixWorldFusedFalse,e.matrix),e.matrixWorldNeedsUpdate=!1),NY(e)&&jY(e.parent)&&e.invalidateDownstreamBooleanData(!0),e.updatePathSnapping(Object.assign({},t.pathSnapping,P))};F.push({update:n,start:n,end:n})}return F}function F0(e,t,n,i){let r=[];if(!("cloner"in n)||!e.cloner)return r;let s=e.cloner,a="cloner"in t?t.cloner:{},o=n.cloner;hB.forEach((e=>{let t;t="count"===e?u0("count",s.parameters,a,o,i,!0):g0(e,s.parameters,null!==a&&void 0!==a?a:{},o,i),t&&r.push(t)}));let l=function(e,t,n,i){if("radial"!==e.parameters.type)return;let r=t.radial,s=n.radial;if(!s)return;let a=e.parameters.radial,o=[];return dB.forEach((e=>{let t=g0(e,a,null!==r&&void 0!==r?r:{},s,i);t&&o.push(t)})),o}(s,a,o,i);(null===l||void 0===l?void 0:l.length)&&r.push(...l);let u=function(e,t,n,i){if("linear"!==e.parameters.type)return;let r=t.linear,s=n.linear;if(!s)return;let a=[],o=e.parameters.linear;return pB.forEach((e=>{let t=g0(e,o,null!==r&&void 0!==r?r:{},s,i);t&&a.push(t)})),a}(s,a,o,i);(null===u||void 0===u?void 0:u.length)&&r.push(...u);let c=function(e,t,n,i){if("grid"!==e.parameters.type)return;let r=t.grid,s=n.grid;if(!s)return;let a=[],o=e.parameters.grid;return fB.forEach((e=>{let t;t="count"===e?c0(e,o,null!==r&&void 0!==r?r:{},s,i,!0):g0(e,o,null!==r&&void 0!==r?r:{},s,i),t&&a.push(t)})),a}(s,a,o,i);(null===c||void 0===c?void 0:c.length)&&r.push(...c);let h=function(e,t,n,i){if("toObject"!==e.parameters.type)return;let r=t.toObject,s=n.toObject;if(!s)return;let a=[],o=e.parameters.toObject;return mB.forEach((e=>{let t;t="count"===e?u0(e,o,null!==r&&void 0!==r?r:{},s,i,!0):g0(e,o,null!==r&&void 0!==r?r:{},s,i),t&&a.push(t)})),a}(s,a,o,i);(null===h||void 0===h?void 0:h.length)&&r.push(...h);let d=function(e,t,n,i){if(!e.parameters.randomness)return;let r=t.randomnessObject,s=n.randomnessObject;if(!s)return;let a=[],o=e.parameters.randomnessObject;return gB.forEach((e=>{let t=g0(e,o,null!==r&&void 0!==r?r:{},s,i);t&&a.push(t)})),a}(s,a,o,i);return null!==d&&void 0!==d&&d.length&&r.push(...d),r.length&&r.push({update:()=>{s.update()}}),r}function O0(e,t,n,i,r){let s,a,o,l,u,c,h,p,f,m,g,v,y,x,b,w=[];if("width"in e&&(s=u0("width",e,t,n,r),s&&w.push(s)),"height"in e&&(a=u0("height",e,t,n,r),a&&w.push(a)),e instanceof kK||e instanceof NK){let i=d({},t.fill),s=d({},n.fill);void 0!==i.enabled&&i.enabled!==s.enabled&&(w.push(function(e,t){return{update:()=>{e instanceof kK&&(e.fill.enabled=t)}}}(e,!0)),i.enabled||Object.assign(i,{enabled:!0,color:d(d({},i.color),{},{a:0})}),s.enabled||Object.assign(s,{enabled:!0,color:d(d({},s.color),{},{a:0})})),o=m0("color",e.fill,i,s,r),o&&w.push(o)}if(e instanceof kK){let i=d({},t.stroke),s=d({},n.stroke);(i.enabled||s.enabled)&&(w.push(function(e,t){return{update:()=>{e instanceof kK&&(e.stroke.enabled=t)}}}(e,!0)),i.enabled||Object.assign(i,{enabled:!0,color:d(d({},i.color),{},{a:0})}),s.enabled||Object.assign(s,{enabled:!0,color:d(d({},s.color),{},{a:0})})),l=m0("color",e.stroke,i,s,r),l&&w.push(l),u=u0("thickness",e.stroke,i,s,r),u&&w.push(u)}if(e instanceof kK){let i=d({},t.dropShadow),s=d({},n.dropShadow);(i.enabled||s.enabled)&&(w.push(function(e,t){return{update:()=>{e instanceof kK&&(e.dropShadow.enabled=t)}}}(e,!0)),i.enabled||Object.assign(i,{enabled:!0,color:d(d({},i.color),{},{a:0})}),s.enabled||Object.assign(s,{enabled:!0,color:d(d({},s.color),{},{a:0})})),c=m0("color",e.dropShadow,i,s,r),c&&w.push(c),h=u0("blurRadius",e.dropShadow,i,s,r),h&&w.push(h),f=u0("spread",e.dropShadow,i,s,r),f&&w.push(f),p=f0("offset",e.dropShadow,i,s,r),p&&w.push(p)}if(e instanceof kK){let i=d({},t.innerShadow),s=d({},n.innerShadow);(i.enabled||s.enabled)&&(w.push(function(e,t){return{update:()=>{e instanceof kK&&(e.innerShadow.enabled=t)}}}(e,!0)),i.enabled||Object.assign(i,{enabled:!0,color:d(d({},i.color),{},{a:0})}),s.enabled||Object.assign(s,{enabled:!0,color:d(d({},s.color),{},{a:0})})),m=m0("color",e.innerShadow,i,s,r),m&&w.push(m),g=u0("blurRadius",e.innerShadow,i,s,r),g&&w.push(g),y=u0("spread",e.innerShadow,i,s,r),y&&w.push(y),v=f0("offset",e.innerShadow,i,s,r),v&&w.push(v)}if(e instanceof kK||e instanceof NK){let i=d({},t.backgroundBlur),s=d({},n.backgroundBlur);(i.enabled||s.enabled)&&(w.push(function(e,t){return{update:()=>{e instanceof kK&&(e.backgroundBlur.enabled=t)}}}(e,!0)),i.enabled||Object.assign(i,{enabled:!0,radius:0}),s.enabled||Object.assign(s,{enabled:!0,radius:0})),x=u0("radius",e.backgroundBlur,i,s,r),x&&w.push(x)}if(e instanceof kK){let i=d({},t.layerBlur),s=d({},n.layerBlur);(i.enabled||s.enabled)&&(w.push(function(e,t){return{update:()=>{e instanceof kK&&(e.layerBlur.enabled=t)}}}(e,!0)),i.enabled||Object.assign(i,{enabled:!0,radius:0}),s.enabled||Object.assign(s,{enabled:!0,radius:0})),b=u0("radius",e.layerBlur,i,s,r),b&&w.push(b)}if(e instanceof NK||e instanceof RK){let i=c0("cornerRadius",e,t,n,r);i&&w.push(i)}return w}function I0(e,t,n,i,r){let s=[];return e.data.visible&&s.push(...P0(e,t,n,r,i)),e instanceof lK?s.push(...O0(e,t,n,0,i)):(e.data.visible&&s.push(...F0(e,t,n,i)),NY(e)?(e instanceof Sq&&e.data.visible&&s.push(...v0(e,t,n,i)),e.data.visible&&s.push(...function(e,t,n,i){let r=[];if(Array.isArray(e.material)){if(!("materials"in n)||!n.materials)return r;let s="materials"in t&&t.materials?t.materials:[],a=n.materials;e.material.forEach(((e,t)=>{var n;if(!a[t])return;let o=null!==(n=s[t])&&void 0!==n?n:{},l=a[t];"string"==typeof o||"string"==typeof l||r.push(...x0(e,o,l,i))}))}else{if(!("material"in n)||!n.material)return r;let s="material"in t&&t.material?t.material:{},a=n.material;if("string"==typeof s||"string"==typeof a)return r;r.push(...x0(e.material,s,a,i))}return r}(e,t,n,i))):(e=>RY.is(e))(e)?e.data.visible&&s.push(...y0(e,t,n,i)):(e=>e instanceof OY)(e)&&s.push(...function(e,t,n,i){var r,s,a,o;let l=[],u="OrthographicCamera"===e.cameraType?null===(r=t.orthographic)||void 0===r?void 0:r.zoom:null===(s=t.perspective)||void 0===s?void 0:s.zoom,c="OrthographicCamera"===e.cameraType?null===(a=n.orthographic)||void 0===a?void 0:a.zoom:null===(o=n.perspective)||void 0===o?void 0:o.zoom;if(void 0!==c){let t=null!==u&&void 0!==u?u:e.zoom,n=c;t!==n&&l.push({update:i=>{e.zoom=ov.lerp(t,n,i),e.updateProjectionMatrix()},start:()=>{e.zoom=t,e.updateProjectionMatrix()},end:()=>{e.zoom=n,e.updateProjectionMatrix()}})}if(void 0!==n.targetOffset){let r=u0("targetOffset",e,t,n,i);r&&l.push(r)}return l}(e,t,n,i))),s.length?{update:e=>{s.forEach((t=>t.update(e)))},start:e=>{s.forEach((t=>{var n;return null===(n=t.start)||void 0===n?void 0:n.call(t,e)}))},end:e=>{s.forEach((t=>{var n;return null===(n=t.end)||void 0===n?void 0:n.call(t,e)}))}}:void 0}var k0=new Lv;function B0(e,t){var n;let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=[],s=n=>{let i=n.data;delete n.states,n.currentState=null,n.reversibleToState=null,n.currentTransitionEvent=null;for(let e of i.states){let t=d({},e.data);n.states||(n.states={}),n.states[e.id]=HR.patch(i,t)}L0(e.scene,n,null,t,void 0!==i.events.find((e=>"Follow"===e.data.type||"LookAt"===e.data.type))),R0(e)};e.scene.traverse2D(s),e.traverseChildren((n=>{var a,o,l,u,c,h;if(i&&(null!==(a=n.rigidBody)&&void 0!==a&&a.setTranslation(n.position0,!0),null!==(o=n.rigidBody)&&void 0!==o&&o.setRotation(n.rotation0,!0),null!==(l=n.rigidBody)&&void 0!==l&&l.setLinvel(k0,!0),null!==(u=n.rigidBody)&&void 0!==u&&u.setAngvel(k0,!0)),!Nz.is(n))return;let p=n.uuid,f=n.data;if(delete n.states,n.uuid===Kk)return;let m=!1;r.some((t=>{var n;return null===(n=e.scene.find(p))||void 0===n?void 0:n.isDescendantOf(t)}))?m=!0:!0===(null===(c=f.physics)||void 0===c?void 0:c.fusedBody)&&"dynamic"===f.physics.rigidBody&&r.push(p),n.data=f,n.currentState=null,n.reversibleToState=null,n.currentTransitionEvent=null;for(let t of f.states){let i=d({},t.data);!0===e.data.globalPhysics.usePhysics&&f.physics&&("dynamic"===f.physics.rigidBody||m)&&(void 0!==t.data.position&&delete i.position,void 0!==t.data.rotation&&delete i.rotation,void 0!==t.data.hiddenMatrix&&delete i.hiddenMatrix),n.states||(n.states={}),n.states[t.id]=$B.patch(f,i)}L0(e.scene,n,null,t,void 0!==f.events.find((e=>"Follow"===e.data.type||"LookAt"===e.data.type))),n instanceof pZ&&n.frame&&(n.frame.traverse((e=>s(e))),null===(h=n.uiCanvas)||void 0===h||h.applySize())})),R0(e),e.frame&&(e.frame.traverse((e=>s(e))),null===(n=e.uiCanvas)||void 0===n||n.applySize())}function R0(e){e.traverseEntity((t=>{for(let n of t.data.events){let t=[];switch(n.data.type){case"Follow":case"MouseHover":case"Scroll":case"MouseDown":case"MouseUp":case"MousePress":case"KeyUp":case"KeyDown":case"KeyPress":case"Collision":t.push(...n.data.actions);break;case"GameControl":for(let e of Object.values(n.data.gameActions))t.push(...e);break;case"DragDrop":t.push(...n.data.dragDropActions.drag,...n.data.dragDropActions.drop);break;case"Conditional":t.push(...n.data.inActions,...n.data.outActions)}for(let n of t)if("Create"===n.data.type&&"Yes"===n.data.hideBase){let t=e.scene.find(n.data.object);t&&(t.visible=!1)}}}))}function L0(e,t,n,i){let r=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(t instanceof Sq&&!(t instanceof LZ)&&t.removeInteractionGeometry(i),t instanceof lK?t.changeSelectedState(n,{shared:i},r):t.changeSelectedState(n,{scene:e,shared:i},r),t instanceof Sq&&t.updateGeometryGroupsIfNeeded(),t instanceof OY&&t.updateCameraState(t.dataPatched,{scene:e,shared:i}),!(t instanceof lK)){if(t.cloner)for(let e of t.cloner.children)e.playModeVisible=void 0;t.updateVisible()}}function z0(e){let t;if(5===e.easing){let{control1:n,control2:i}=e;t="cubicBezier(\n\t\t\t".concat(n[0],", ").concat(n[1],", ").concat(i[0],", ").concat(i[1],"\n\t\t)")}else if(6===e.easing){let{mass:n,stiffness:i,damping:r,velocity:s}=e;t="spring( ".concat(n,", ").concat(i,", ").concat(r,", ").concat(s," )")}else{let n;switch(e.easing){case 0:default:n=Gk.linear;break;case 1:n=Gk.ease;break;case 2:n=Gk.easeIn;break;case 3:n=Gk.easeOut;break;case 4:n=Gk.easeInOut}let[i,r,s,a]=n;t="cubicBezier( ".concat(i,", ").concat(r,", ").concat(s,", ").concat(a," )")}return{duration:Math.max(e.duration,1e-4),easing:t}}function N0(e){let t={delay:0,loop:-1===e.repeat||e.repeat+1};if(0===e.repeat)t.direction="normal",t.rewind=!1;else switch(e.direction){case"pingpong":t.direction="alternate",t.rewind=!1;break;case"pingpong-rewind":t.direction="alternate",t.rewind=!0;break;default:t.direction="normal",t.rewind=!1}switch(t.delay=0,t.endDelay=0,t.startOnceDelay=0,t.pingPongDelayCorrection=0,t.pingPongEndDelayCorrection=0,e.delayDirection){case"start-once":t.startOnceDelay=e.delay;break;case"start":t.delay=e.delay;break;case"end":t.endDelay=e.delay;break;case"start-end":case void 0:t.delay=e.delay,t.endDelay=e.delay}return"alternate"===t.direction&&(t.delay/=2,t.endDelay/=2,"start"===e.delayDirection?(t.pingPongDelayCorrection=t.delay,"number"==typeof t.loop&&t.loop%2===0&&(t.pingPongEndDelayCorrection=t.delay)):"end"===e.delayDirection?"number"==typeof t.loop&&t.loop%2!==0&&(t.pingPongEndDelayCorrection=t.endDelay):"start-end"===e.delayDirection&&(t.pingPongDelayCorrection=t.delay,t.pingPongEndDelayCorrection=t.endDelay)),t}var j0={type:"beginState"},U0={type:"completeState",isfromEntity:!1},V0=class{constructor(e,t,n,i,r,s){if(this.object=e,this.data=i,this.sharedAssets=r,this.allowSlerp=s,this.targets={t:0},this.firstLoop=!0,this._changeBegan=!1,this._changeCompleted=!0,this.onChange=()=>{this.callback&&(this.callback.update(this.targets.t),this.object.requestRender()),0===this.targets.t||1===this.targets.t?this._changeCompleted||(this._changeCompleted=!0,this._changeBegan=!1,this.onChangeComplete()):(this._changeCompleted&&(this._changeCompleted=!1),this._changeBegan||(this._changeBegan=!0,this.onChangeBegin()))},this.onChangeBegin=()=>{this.object.reversibleToState=this.to.id;let e=this.targets.t>.5?this.from.id:this.to.id;this.object.prevState!==this.object.currentState&&(this.object.prevState=this.object.currentState),this.object.currentState=e,this.object.dispatchEvent({type:"beginState",state:e}),this.object instanceof lK||this.object.traverseEntity((e=>{e!==this.object&&e instanceof OY&&e.dispatchEvent(j0)}))},this.onChangeComplete=()=>{this.firstLoop&&(this.onFirstLoop(),this.firstLoop=!1),this.object.reversibleToState=this.to.id;let e=this.targets.t<.5?this.from.id:this.to.id;this.object.prevState!==this.object.currentState&&(this.object.prevState=this.object.currentState),this.object.currentState=e,this.object.dispatchEvent({type:"completeState",state:e}),this.object instanceof lK||this.object.traverseEntity((e=>{e!==this.object&&e instanceof OY&&e.dispatchEvent(U0)}))},this.onFirstLoop=()=>{this.useCurrentState&&(this.callback=I0(this.object,this.from.data,this.to.data,this.sharedAssets,this.allowSlerp))},void 0===t){let e=W0(this.object,this.object.currentState===n?this.object.prevState:this.object.currentState);if(!e)throw new Error("Missing property");this.from=e}else{let e=W0(this.object,t);if(!e)throw new Error("Missing property");this.from=e}if(void 0===n)throw new Error("Missing property");{let e=W0(this.object,n);if(!e)throw new Error("Missing property");this.to=e}this.useCurrentState=void 0===t||void 0===n,this.params=d(d(d({targets:this.targets,t:1,autoplay:!1},N0(i)),z0(i)),{},{change:this.onChange}),this.callback=I0(this.object,void 0===t?{}:this.from.data,void 0===n?{}:this.to.data,this.sharedAssets,this.allowSlerp)}get changeBegan(){return this._changeBegan}get changeCompleted(){return this._changeCompleted}},H0=class extends Yg{constructor(e,t,n,i,r){var s,a,o;if(super(),this.eventType=e,this.data=t,this.page=n,this.shared=i,this.condition=r,this.toggleIsForward=!1,this.timelineNeedsRebuild=!1,this.hasPlayedOnce=!1,this.onTimelineChangeComplete=()=>{var e;"normal"!==this.data.tweens[0].data.direction&&(this.toggleIsForward=!this.toggleIsForward),!1!==this.timelineNeedsRebuild&&(null!==(e=this.timeline)&&void 0!==e&&e.pause(),this.buildTimeline({isForward:this.toggleIsForward,needsRebuild:!1,isRebuild:!0}),this.timeline.play())},!t.object)throw new Error("Missing property");let l=null!==(s=null!==(a=this.page.scene.find(t.object))&&void 0!==a?a:null===(o=this.page.uiCanvas)||void 0===o?void 0:o.find(t.object))&&void 0!==s?s:this.page.scene.find2DInUIObjects(t.object);if(!l)throw new Error("Missing property");if(!l.states)throw new Error("Missing property");if(this.object=l,t.tweens.length<2)throw new Error("Missing property");this.tweens=Array(this.data.tweens.length-1),this.startOnceDelay="start-once"===t.tweens[0].data.delayDirection?t.tweens[0].data.delay:0,this.init()}get playing(){var e;return!1===(null===(e=this.timeline)||void 0===e?void 0:e.paused)}get changeBegan(){var e;return null!==(e=this.tweens.some((e=>e.changeBegan)))&&void 0!==e&&e}init(){this.initialCurrentState=W0(this.object,this.object.currentState).id,this.toggleIsForward=!1}get currentState(){return"Toggle"===this.data.runMode&&fk(this.eventType)?this.initialCurrentState:this.object.currentState}buildTimeline(){var e;let{isForward:t=!0,needsRebuild:n=!1,isRebuild:i=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};try{var r;let e=N0(this.data.tweens[0].data);i&&"number"==typeof e.loop&&e.loop--,null!==(r=this.timeline)&&void 0!==r&&r.pause(),this.timeline=s0.timeline(d(d({autoplay:!1},e),!0===e.loop||e.loop>1?{timelineChangeComplete:this.onTimelineChangeComplete}:{}));let u=this.tweens.findIndex((e=>null===e||void 0===e?void 0:e.changeBegan));if(!0===n&&(this.timelineNeedsRebuild=!0),t){let t=-1===u?0:u;for(let n=t;n<this.data.tweens.length-1;n++){var s,a;let i,r=this.data.tweens[n],o=this.data.tweens[n+1];n!==t||!0!==this.object.wasMovedByUser&&!0!==(null===(s=this.object.previousAction)||void 0===s?void 0:s.changeBegan)?i=void 0===r.data.state?this.currentState:r.data.state:(i=void 0,this.object instanceof OY&&(this.object.wasMovedByUser=!1));let l=new V0(this.object,i,void 0===o.data.state?this.currentState:o.data.state,o.data,this.shared,null!==(a=this.data.allowSlerp)&&void 0!==a&&a);-1!==u&&n===t&&Object.assign(l.params,{startOnceDelay:0}),this.tweens[n]=l,this.timeline.add(l.params,this.timeline.duration+(n===t?e.delay:0))}this.timeline.duration+=e.endDelay}else{let t=-1===u?this.data.tweens.length-1:u+1;for(let n=t;n>0;n--){var o,l;let i,r=this.data.tweens[n],s=this.data.tweens[n-1];n!==t||!0!==this.object.wasMovedByUser&&!0!==(null===(o=this.object.previousAction)||void 0===o?void 0:o.changeBegan)?i=void 0===r.data.state?this.currentState:r.data.state:(i=void 0,this.object instanceof OY&&(this.object.wasMovedByUser=!1));let a=new V0(this.object,i,void 0===s.data.state?this.currentState:s.data.state,r.data,this.shared,null!==(l=this.data.allowSlerp)&&void 0!==l&&l);-1!==u&&n===t&&Object.assign(a.params,{startOnceDelay:0}),this.tweens[n-1]=a,this.timeline.add(a.params,this.timeline.duration+(n===t?e.endDelay:0))}this.timeline.duration+=e.delay}}catch(u){u instanceof Error&&console.error(u.message)}!0===(null===(e=this.object.previousAction)||void 0===e?void 0:e.playing)&&this.object.previousAction.pause(),this.object.previousAction=this}play(){if(!1===n1(this.shared,this.condition)||fk(this.eventType)&&"Once"===this.data.runMode&&this.hasPlayedOnce||(this.hasPlayedOnce=!0,this.playing))return!1;clearTimeout(this.timeoutId);let e=N0(this.data.tweens[0].data).pingPongDelayCorrection;this.timeoutId=window.setTimeout((()=>{try{this.buildTimeline(),this.timeline.play()}catch(un){un instanceof Error&&console.error(un.message)}}),this.startOnceDelay+e)}pause(){var e;null!==(e=this.timeline)&&void 0!==e&&e.pause(),clearTimeout(this.timeoutId),this.tweens=Array(this.data.tweens.length-1),delete this.timeoutId}stop(){this.pause();let e=void 0===this.data.tweens[0].data.state?this.initialCurrentState:this.data.tweens[0].data.state;this.object instanceof lK?this.object.changeSelectedState(e,{shared:this.shared}):this.object.changeSelectedState(e,{scene:this.page.scene,shared:this.shared}),this.object.currentState=e}seek(e){var t;if(!1===n1(this.shared,this.condition))return!1;void 0===this.timeline&&this.buildTimeline(),null===(t=this.timeline)||void 0===t||t.seek(e*this.timeline.duration,!0)}toggle(e){var t;if(!1===n1(this.shared,this.condition))return!1;clearTimeout(this.timeoutId),this.toggleIsForward=null!==e&&void 0!==e?e:!this.toggleIsForward,this.playing?(null!==(t=this.timeline)&&void 0!==t&&t.pause(),this.buildTimeline({isForward:this.toggleIsForward,needsRebuild:!0}),this.timeline.play()):this.timeoutId=window.setTimeout((()=>{var e;null!==(e=this.timeline)&&void 0!==e&&e.pause(),this.buildTimeline({isForward:this.toggleIsForward}),this.timeline.play()}),this.startOnceDelay)}playFromCurrent(){this.toggle(!0)}reverseFromCurrent(){this.toggle(!1)}dispose(){this.pause()}};function W0(e,t){var n;let i,r;if("string"==typeof t?(i=t,r=null===(n=e.states)||void 0===n?void 0:n[i]):null===t&&(i=null,r=e.data),void 0!==i&&void 0!==r)return{id:i,data:r}}var G0={type:"beginState"},q0={type:"completeState",isfromEntity:!1},Y0={type:"requestRender"},X0=class extends Yg{constructor(e,t,n,i){super(),this.data=e,this.page=t,this.shared=n,this.condition=i,this.toggleIsForward=!1,this.posStart=new Lv,this.posEnd=new Lv,this.qStart=new Rv,this.qEnd=new Rv,this.zoomStart=1,this.zoomEnd=1}init(){}get playing(){return this.animation&&this.animation.began&&!this.animation.completed}buildAnimation(){if(!this.data.animate)return;let e=this.page.scene.find(this.data.targetCamera);if(!e||!e.visible)throw new ReferenceError("Target camera not founded or not visible");let t={t:0};this.posStart.copy(this.page.activeCamera.position),this.qStart.copy(this.page.activeCamera.quaternion),this.zoomStart=this.page.activeCamera.zoom,this.animation=s0(d(d({targets:t,t:1},z0(this.data)),{},{update:()=>{0===t.t&&("Toggle"!==this.data.runMode||this.toggleIsForward?(this.posEnd.copy(e.position),this.qEnd.copy(e.quaternion),this.zoomEnd=e.zoom,this.fromCamera=this.page.activeCamera,this.switchCamera(e.uuid)):this.fromCamera&&(this.posEnd.copy(this.fromCamera.position),this.qEnd.copy(this.fromCamera.quaternion),this.zoomEnd=this.fromCamera.zoom,this.switchCamera(this.fromCamera.uuid)),this.page.activeCamera.dispatchEvent(G0));let n=this.page.activeCamera;n.position.lerpVectors(this.posStart,this.posEnd,t.t),n.quaternion.slerpQuaternions(this.qStart,this.qEnd,t.t),n.zoom=this.zoomStart+(this.zoomEnd-this.zoomStart)*t.t,n.wasMovedBySwitchCameraAction=!0,n.updateMatrix(),n.updateMatrixWorld(),n.updateProjectionMatrix(),n.dispatchEvent(Y0),1===t.t&&n.dispatchEvent(q0)}}))}switchCamera(e){let t=this.page.activeCamera,n=this.page.scene.find(e);if(!n||!n.visible)throw new ReferenceError("Target camera not founded or not visible");this.page.switchActiveCamera(n),t.dispatchEvent({type:"cameraChange",camera:n})}play(){if(!1===n1(this.shared,this.condition))return!1;if(!this.playing&&this.page.activeCamera.uuid!==this.data.targetCamera)try{clearTimeout(this.timeoutId),this.timeoutId=window.setTimeout((()=>{var e;delete this.timeoutId,this.data.animate?(this.buildAnimation(),null===(e=this.animation)||void 0===e||e.play()):this.switchCamera(this.data.targetCamera)}),1e3*this.data.delay)}catch(e){}}pause(){var e;null!==(e=this.animation)&&void 0!==e&&e.pause(),clearTimeout(this.timeoutId),delete this.timeoutId}toggle(e){if(!1===n1(this.shared,this.condition))return!1;if(window.clearTimeout(this.timeoutId),delete this.timeoutId,e!==this.toggleIsForward)try{var t,n;this.playing?(null!==(t=this.animation)&&void 0!==t&&t.pause(),this.toggleIsForward=null!==e&&void 0!==e?e:!this.toggleIsForward,this.buildAnimation(!0),null===(n=this.animation)||void 0===n||n.play()):this.timeoutId=window.setTimeout((()=>{var t,n;this.toggleIsForward=null!==e&&void 0!==e?e:!this.toggleIsForward,this.data.animate?(null!==(t=this.animation)&&void 0!==t&&t.pause(),this.buildAnimation(),null===(n=this.animation)||void 0===n||n.play()):(this.toggleIsForward?(this.fromCamera=this.page.activeCamera,this.switchCamera(this.data.targetCamera)):this.fromCamera&&this.switchCamera(this.fromCamera.uuid),this.page.activeCamera.dispatchEvent(q0),this.page.activeCamera.dispatchEvent(Y0))}),1e3*this.data.delay)}catch(i){}}playFromCurrent(){this.toggle(!0)}reverseFromCurrent(){this.toggle(!1)}dispose(){this.pause(),this.toggleIsForward=!1}};function Q0(e){let t=null===e||void 0===e?void 0:e.tracks.filter((e=>"vector"===e.ValueTypeName||"quaternion"===e.ValueTypeName)).map((e=>e.times.length));if(null!==t&&void 0!==t&&t.length){let e=uF(t);return e&&e>2?e:2}return 2}var K0=class extends Yg{constructor(e,t,n,i,r){var s,a;super(),this.data=e,this.page=t,this.animationControls=n,this.shared=i,this.condition=r,this.startOnceDelay=0,this.toggleIsForward=!1;let o=e.object,l=t.scene.find(e.object);l&&Array.isArray(l.identity)&&(o=l.identity[0]),this.data=d(d({},e),{},{object:o});let u=this.animationControls.clipIdToAction[e.clipId+"/"+o];if(this.duration=null!==(s=null===u||void 0===u||null===(a=u.getClip())||void 0===a?void 0:a.duration)&&void 0!==s?s:1,this.data.crop2){let e=Q0(null===u||void 0===u?void 0:u.getClip());this.leftFrameTime=this.data.crop2[0]/(e-1)*this.duration,this.rightFrameTime=this.data.crop2[1]/(e-1)*this.duration}else{var c;let e=null===u||void 0===u||null===(c=u.getClip())||void 0===c||null===(c=c.tracks[0])||void 0===c?void 0:c.times.length;e&&e>1?(this.leftFrameTime=this.data.crop[0]/e*this.duration,this.rightFrameTime=this.data.crop[1]/e*this.duration):(this.leftFrameTime=0,this.rightFrameTime=this.duration)}this.startOnceDelay=e.delay}get playing(){var e,t;return null!==(e=null===(t=this.threeAnimAction)||void 0===t?void 0:t.isRunning())&&void 0!==e&&e}play(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!1===n1(this.shared,this.condition))return!1;window.clearTimeout(this.timeoutId),this.timeoutId=window.setTimeout((()=>{var t;if(this.threeAnimAction=this.animationControls.play(this.data),!this.threeAnimAction)return;this.threeAnimAction.reset(),this.threeAnimAction.time=this.leftFrameTime,this.threeAnimAction._clip.start=this.leftFrameTime,this.threeAnimAction._clip.duration=this.rightFrameTime;let n=this.data.object;Object.entries(this.animationControls.clipIdToAction).forEach((t=>{let[i,r]=t,s=i.split("/")[1];this.threeAnimAction!==r&&s===n&&r.isRunning()&&(e?r.fadeOut(.2):r.stop())})),e&&(null===(t=this.threeAnimAction)||void 0===t||t.fadeIn(.2))}),this.startOnceDelay)}pause(){this.threeAnimAction&&(this.threeAnimAction.paused=!0),window.clearTimeout(this.timeoutId),delete this.timeoutId}stop(){var e;null===(e=this.threeAnimAction)||void 0===e||e.fadeOut(.2)}seek(e){this.threeAnimAction=this.animationControls.play(this.data),this.threeAnimAction&&(this.threeAnimAction.paused=!0,this.threeAnimAction.time=ov.clamp(this.threeAnimAction.time+1/60*e,this.leftFrameTime,this.rightFrameTime-16e-5),this.animationControls.needsUpdate=!0,this.animationControls.requestRender())}toggle(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!1===n1(this.shared,this.condition))return!1;this.toggleIsForward=null!==e&&void 0!==e?e:!this.toggleIsForward,this.threeAnimAction&&(this.threeAnimAction._loopCount=0),this.playing?this.threeAnimAction&&(this.threeAnimAction.timeScale=this.toggleIsForward?1:-1,this.toggleIsForward?(this.threeAnimAction._clip.start=this.leftFrameTime,this.threeAnimAction._clip.duration=this.rightFrameTime):(this.threeAnimAction._clip.start=this.rightFrameTime,this.threeAnimAction._clip.duration=this.leftFrameTime)):this.timeoutId=window.setTimeout((()=>{if(this.threeAnimAction=this.animationControls.play(this.data),this.threeAnimAction){var e;this.toggleIsForward?(this.threeAnimAction.time=this.leftFrameTime,this.threeAnimAction._clip.start=this.leftFrameTime,this.threeAnimAction._clip.duration=this.rightFrameTime):(this.threeAnimAction.time=this.rightFrameTime,this.threeAnimAction._clip.start=this.rightFrameTime,this.threeAnimAction._clip.duration=this.leftFrameTime),this.threeAnimAction.paused=!1,this.threeAnimAction.timeScale=this.toggleIsForward?1:-1;let n=this.data.clipId.split("/")[1];Object.entries(this.animationControls.clipIdToAction).forEach((e=>{let[i,r]=e,s=i.split("/")[1];this.threeAnimAction!==r&&s===n&&r.isRunning()&&(t?r.fadeOut(.2):r.stop())})),t&&(null===(e=this.threeAnimAction)||void 0===e||e.fadeIn(.2))}}),this.startOnceDelay)}playFromCurrent(){this.toggle(!0)}reverseFromCurrent(){this.toggle(!1)}dispose(){var e;let t=null===(e=this.animationControls.clipIdToAction[this.data.clipId+"/"+this.data.object])||void 0===e?void 0:e.getClip();t&&(t.duration=this.duration),this.pause()}},Z0=class{constructor(e,t,n,i,r){this.data=e,this.page=t,this.eventManager=n,this.shared=i,this.condition=r,this.timeOutId=-1,this.scene=t.scene}dispatch(){if(!1===n1(this.shared,this.condition))return!1;this.data.target!==this.page.uuid&&(window.clearTimeout(this.timeOutId),this.timeOutId=window.setTimeout((()=>{this.play()}),1e3*this.data.delay))}dispose(){window.clearTimeout(this.timeOutId)}play(){if(this.scene.children.every((e=>e.uuid!==this.data.target||e.data.uiScene)))return;"fade"===this.data.transition&&this.data.duration>0&&this.eventManager.eventContext.renderer.renderFromSceneForSceneTransitionPass(this.scene,this.scene.activeCamera,1e3*this.data.duration),this.eventManager.deactivate(),this.eventManager.controlsManager.deactivate();let e=this.scene.activeCamera;this.scene.updatePage(this.data.target),this.scene.traverseVisibleEntity((e=>{"ParticleSystem"===e.type&&(e.sleep(),e.wakeUp(),e.data.autoPlay?e.start():e.stop())})),this.scene.activePage.switchToPlayCamera(),this.scene.activeCamera.copyViewPlaneSize(e),B0(this.scene.activePage,this.shared),this.eventManager.activate(),this.eventManager.controlsManager.activate(this.eventManager)}},J0=class{constructor(e,t,n,i){this.data=e,this.page=t,this.shared=n,this.condition=i,this.evaluatedCondition=!1}checkConditions(){this.evaluatedCondition=n1(this.shared,this.condition)}dispatch(){if(!1===this.evaluatedCondition)return!1;let e=this.shared.getVariable(this.data.variableId),t=OU(this.data.expression,this.shared,cR.typeOfVariable(e));void 0!==t&&this.shared.updateVariable(this.data.variableId,"string"==typeof t?{textValue:t}:t)}dispose(){}},$0=class{constructor(e,t,n,i){this.data=e,this.page=t,this.shared=n,this.condition=i,this.timeoutId=null}dispatchInner(){if(!1===n1(this.shared,this.condition))return!1;let e=this.shared.getDynamicVariablePlayState(this.data.variableId);if("PlayPause"===this.data.mode)void 0===this.shared.getDynamicVariableToggleIsForward(this.data.variableId)&&this.shared.setDynamicVariableToggleIsForward(this.data.variableId,!0),this.shared.setDynamicVariablePlayState(this.data.variableId,"Playing"===e?"Paused":"Playing");else if("Play"===this.data.mode&&"Playing"!==e)void 0===this.shared.getDynamicVariableToggleIsForward(this.data.variableId)&&this.shared.setDynamicVariableToggleIsForward(this.data.variableId,!0),this.shared.setDynamicVariablePlayState(this.data.variableId,"Playing");else if("Stop"===this.data.mode&&"Stopped"!==e)this.shared.setDynamicVariablePlayState(this.data.variableId,"Stopped");else if("Pause"===this.data.mode&&"Paused"!==e)this.shared.setDynamicVariablePlayState(this.data.variableId,"Paused");else if("Restart"===this.data.mode)this.shared.setDynamicVariablePlayState(this.data.variableId,"Restarted");else if("Toggle"===this.data.mode){let t=this.shared.getDynamicVariableToggleIsForward(this.data.variableId);"Playing"===e?this.shared.setDynamicVariableToggleIsForward(this.data.variableId,void 0!==t&&!t):(this.shared.setDynamicVariableToggleIsForward(this.data.variableId,!t),this.shared.setDynamicVariablePlayState(this.data.variableId,"Playing"))}}dispatch(){let e=this.data.delay,t=this.shared.getDynamicVariablePlayState(this.data.variableId);"PlayPause"===this.data.mode&&"Playing"===t&&(e=this.data.pauseDelay),0!==e?(this.timeoutId&&window.clearTimeout(this.timeoutId),this.timeoutId=window.setTimeout((()=>{this.timeoutId=null,this.dispatchInner()}),e)):this.dispatchInner()}dispose(){this.timeoutId&&window.clearTimeout(this.timeoutId)}},e1=class{constructor(e,t,n,i){this.data=e,this.page=t,this.shared=n,this.condition=i}dispatch(){if(!1===n1(this.shared,this.condition))return!1;("single"===this.data.target?this.data.variableId?[this.data.variableId]:[]:Object.keys(this.shared.getVariables())).forEach((e=>{var t;this.shared.getVariable(e);let n=null===(t=this.shared.data.variables.data(e))||void 0===t?void 0:t.value;void 0!==n&&this.shared.updateVariable(e,n),this.shared.enableLocalStorageForPersistentVariables&&localStorage.removeItem(mq(e))}))}dispose(){}},t1=class{constructor(e,t,n,i){this.data=e,this.page=t,this.shared=n,this.condition=i}dispatch(){var e;if(!1===n1(this.shared,this.condition))return!1;this.data.userAPIId&&(null===(e=this.shared.getUserAPI(this.data.userAPIId))||void 0===e||e.callUserAPI(this.shared))}dispose(){}};function n1(e,t){if(void 0===t)return!0;if(0===t.expression.length)return!1;let n=OU(t.expression,e,"boolean");return t.negate?!n:!!n}function i1(e,t,n,i,r,s){let a={Audio:[],Video:[],Particles:[],Link:[],Destroy:[],Create:[],Reset:[],Transition:[],SwitchCamera:[],Animation:[],SceneTransition:[],SetVariable:[],DynamicVariablePlay:[],ClearLocalStorage:[],UserAPI:[]},o=t=>l=>{let{id:u,data:c}=l;try{"Audio"===c.type?kk[e.type].includes("Audio")&&a.Audio.push(new KJ(u,c,s,i,t)):"Video"!==c.type||s instanceof lK?"Particles"===c.type?kk[e.type].includes("Particles")&&a.Particles.push(new ZJ(c,n,i,t)):"Link"===c.type?kk[e.type].includes("Link")&&a.Link.push(new e$(c,r.controlsManager,i,t)):"Create"===c.type?kk[e.type].includes("Create")&&a.Create.push(new m1(c,n,r.controlsManager,i,t)):"Destroy"===c.type?kk[e.type].includes("Destroy")&&a.Destroy.push(new t$(c,n,r.controlsManager,i,t)):"Reset"===c.type?kk[e.type].includes("Reset")&&a.Reset.push(new n$(c,n,i,r,t)):"Transition"===c.type?kk[e.type].includes("Transition")&&a.Transition.push(new H0(e.type,c,n,i,t)):"SwitchCamera"===c.type?kk[e.type].includes("SwitchCamera")&&a.SwitchCamera.push(new X0(c,n,i,t)):"SceneTransition"===c.type?kk[e.type].includes("SceneTransition")&&a.SceneTransition.push(new Z0(c,n,r,i,t)):"Animation"===c.type?kk[e.type].includes("Animation")&&a.Animation.push(new K0(c,n,r.animationControls,i,t)):"SetVariable"===c.type?kk[e.type].includes("SetVariable")&&a.SetVariable.push(new J0(c,n,i,t)):"DynamicVariablePlay"===c.type?kk[e.type].includes("DynamicVariablePlay")&&a.DynamicVariablePlay.push(new $0(c,n,i,t)):"Conditional"===c.type?kk[e.type].includes("Conditional")&&(c.ifActions.forEach(o({expression:c.condition,negate:!1})),c.elseActions.forEach(o({expression:c.condition,negate:!0}))):"ClearLocalStorage"===c.type?kk[e.type].includes("ClearLocalStorage")&&a.ClearLocalStorage.push(new e1(c,n,i,t)):"UserAPI"===c.type&&kk[e.type].includes("UserAPI")&&a.UserAPI.push(new t1(c,n,i,t)):kk[e.type].includes("Video")&&a.Video.push(new u1(u,c,s,i,t))}catch(Zn){}};return t.forEach(o()),a}function r1(e){Object.values(e).forEach((e=>{e.forEach((e=>{(e instanceof KJ||e instanceof u1||e instanceof ZJ||e instanceof K0||e instanceof H0||e instanceof m1||e instanceof t$||e instanceof X0||e instanceof Z0||e instanceof n$||e instanceof J0||e instanceof $0)&&e.dispose()}))}))}var s1=new Map,a1=new Map,o1=class{constructor(e,t,n){this.data=t,this.delay=0,this.status="stopped";let{layerId:i,loop:r,volume:s,delay:a}=t;if(this.object=n,void 0===i)throw new Error("Missing property");let o=function(e,t){let n;if("material"in e){let i=e.material;n=Array.isArray(i)?e.material[0].layers.find((e=>e.uuid===t)):e.material.layers.find((e=>e.uuid===t))}if(n)return n.color.texture.image.img instanceof HTMLVideoElement?n.color.texture.image.img:void 0}(n,i);o&&(this.videoElement=o,this.videoElement.loop=r===1/0,_F&&(this.videoElement.autoplay=!0),void 0!==s&&(this.videoElement.volume=s)),void 0!==a&&(this.delay=a),a1.has(n.uuid)?a1.get(n.uuid).push(this):a1.set(n.uuid,[this]),s1.set(e,this),this.pause()}mute(){!this.videoElement||(this.videoElement.muted=!0)}unMute(){!this.videoElement||(this.videoElement.muted=!1)}play(e){if(!this.videoElement)return;let t=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);e?(this.mute(),this.delay+=150):t?(this.mute(),window.setTimeout((()=>{this.unMute()}),100)):this.unMute(),this.delayTimerId=window.setTimeout((()=>{if(!this.videoElement)return;let e=this.videoElement.play();void 0!==e&&e.then((e=>{})).catch((e=>{this.play()})),this.clearDelay()}),this.delay),this.status="playing"}clearDelay(){this.delayTimerId&&(clearTimeout(this.delayTimerId),delete this.delayTimerId)}pause(){!this.videoElement||(this.videoElement.pause(),this.status="paused")}stop(){!this.videoElement||(this.videoElement.pause(),this.videoElement.currentTime=0,this.status="stopped",this.clearDelay())}playByToggle(){"stop"===this.data.toggle?"playing"===this.status?this.stop():(this.stop(),this.play()):"pause"===this.data.toggle?"playing"===this.status?this.pause():this.play():(this.stop(),this.play())}dispose(){!this.videoElement||(this.stop(),this.videoElement.muted=!0)}},l1=class{constructor(e){this.data=e}dispatch(){this.data.playVideo?this.pauseVideo(this.data.playVideo):this.data.object?this.pauseAllVideosFromObject(this.data.object):this.pauseAllVideos()}pauseVideo(e){let t=s1.get(e);!t||(this.data.delay>0?(this.disposeDelay(),this.timeoutId=window.setTimeout((()=>{t[this.data.interaction](),this.disposeDelay()}),this.data.delay)):t[this.data.interaction]())}pauseAllVideosFromObject(e){let t=a1.get(e);null===t||void 0===t||!t.length||(this.data.delay>0?(this.disposeDelay(),this.timeoutId=window.setTimeout((()=>{t.forEach((e=>e[this.data.interaction]())),this.disposeDelay()}),this.data.delay)):t.forEach((e=>e[this.data.interaction]())))}pauseAllVideos(){let e=[...a1.values()];!e.length||(this.data.delay>0?(this.disposeDelay(),this.timeoutId=window.setTimeout((()=>{e.forEach((e=>{e.forEach((e=>{e[this.data.interaction]()}))})),this.disposeDelay()}),this.data.delay)):e.forEach((e=>{e.forEach((e=>{e[this.data.interaction]()}))})))}disposeDelay(){clearTimeout(this.timeoutId),delete this.timeoutId}dispose(){clearTimeout(this.timeoutId),delete this.timeoutId}},u1=class{constructor(e,t,n,i,r){if(this.data=t,this.shared=i,this.condition=r,"play"===t.interaction)this.interaction=new o1(e,t,n);else{if("pause"!==t.interaction&&"stop"!==t.interaction)throw new Error("Missing property");this.interaction=new l1(t)}}dispatchBasic(){if(!1===n1(this.shared,this.condition))return!1;this.interaction instanceof o1?this.interaction.playByToggle():this.interaction.dispatch()}dispatchConditional(){if(!1===n1(this.shared,this.condition))return!1;this.interaction instanceof o1?this.interaction.play():this.interaction.dispatch()}dispose(){this.interaction.dispose()}},c1=(()=>{let e,t,n,i;function r(n){var r;!e&&!h1()&&(null===(r=t)||void 0===r?void 0:r.sharedGameControlGlobals.createdObjects.length)>0&&(e=requestAnimationFrame(s)),n&&(t=n,i=n.requestRender)}function s(r){let a=n?r-n:0,o=t.sharedGameControlGlobals.createdObjects,l=t.sharedGameControlGlobals.nCreatedPerAction,u=o.length,c=0;for(;c<u;){let e=o[c];void 0===e.userData.createdTime&&(e.userData.createdTime=r),void 0===e.userData.lifetime&&void 0===e.userData.quantity||e.userData.lifetime&&r-e.userData.createdTime<e.userData.lifetime||e.userData.quantity&&l[e.userData.actionId]<=e.userData.quantity?(e.userData.velocity&&(e.position.addScaledVector(e.userData.velocity,a/1e3),e.updateMatrix(),i()),c++):(l[e.userData.actionId]>e.userData.quantity&&l[e.userData.actionId]--,o.splice(c,1),e.removeFromParent(),t.sharedGameControlGlobals.rapierWorld&&e.rigidBody?(t.sharedGameControlGlobals.colliderToEntity.delete(e.rigidBody.collider(0).handle),t.sharedGameControlGlobals.rapierWorld.removeRigidBody(e.rigidBody)):(e.bvhGeometry=void 0,t.sharedGameControlGlobals.entitiesWithTransformAnim=t.sharedGameControlGlobals.entitiesWithTransformAnim.filter((e=>void 0!==e.bvhGeometry))),u--,i())}e=c>0?requestAnimationFrame(s):void 0,n=c>0?r:void 0}return typeof document<"u"&&document.addEventListener("visibilitychange",(function(){h1()?e&&(cancelAnimationFrame(e),e=void 0,n=void 0):r()})),r})();function h1(){return!!document&&document.hidden}var d1=new Rv,p1=new Lv,f1=new Lv,m1=class{constructor(e,t,n,i,r){this.data=e,this.page=t,this.controlsManager=n,this.shared=i,this.condition=r,this.intervalId=null,this.timeoutIdQueue=[],this.uniqueId=ov.generateUUID(),this.dispatch=()=>{if(!1===n1(this.shared,this.condition))return!1;this.data.delay?this.timeoutIdQueue.push(window.setTimeout(this.dispatchInner,1e3*this.data.delay)):this.dispatchInner()},this.dispatchFromStart=()=>{if(!1===n1(this.shared,this.condition))return!1;this.timeoutIdQueue.push(window.setTimeout(this.dispatchInner,1e3*this.data.delay))},this.dispatchThrottled=yF(this.dispatch,1e3/this.data.creationSpeed),this.dispatchStart=()=>{null===this.intervalId&&(this.intervalId=window.setInterval(this.dispatch,1e3/this.data.creationSpeed))},this.dispatchStop=()=>{null!==this.intervalId&&(window.clearInterval(this.intervalId),this.intervalId=null)},this.dispatchInner=()=>{this.timeoutIdQueue.shift();let e=new Vz(this.object);if(e.playModeVisible=!0,e.expand(),"world"!==this.data.coordinateSystem){let t=this.data.coordinateSystem,n=this.page.scene.find(t);n&&(n.updateMatrixWorldSVD(),e.hiddenMatrix.copy(n.matrixWorldRigid))}e.scale.copy(this.object.scale),e.position.fromArray(this.data.position),e.rotation.fromArray(this.data.rotation),e.updateMatrix(),this.page.add(e);let t=this.controlsManager.sharedGameControlGlobals;t.createdObjects.push(e),void 0===t.nCreatedPerAction[this.uniqueId]?t.nCreatedPerAction[this.uniqueId]=1:t.nCreatedPerAction[this.uniqueId]++,e.updateWorldMatrix(!0,!0),e.traverseObject(this.traverseObjectCB),c1(),this.controlsManager.requestRender()},this.traverseObjectCB=e=>{var t,n,i;let r;if(e.hasNonUniformScale&&e.updateMatrixWorldSVD(),this.controlsManager.sharedGameControlGlobals.rapierWorld){var s;if(e instanceof pY){if(!e.objectForSample)return!0===e.object.dataPatched.physics.fusedBody&&"dynamic"===e.object.dataPatched.physics.rigidBody||void 0;if(e.objectForSample.dataPatched.physics.fusedBody)return;r=e.object}else if(e instanceof Vz)r=e.object;else if(r=e,null!==(s=r.dataPatched.cloner)&&void 0!==s&&s.hideBase)return!0}else{if(e instanceof pY)return;r=e instanceof Vz?e.object:e}"Time"===this.data.destroy?e.userData.lifetime=1e3*this.data.lifetime:"Quantity"===this.data.destroy&&(e.userData.quantity=this.data.destroyAfterQuantity,e.userData.actionId=this.uniqueId);let a=(new Lv).fromArray(this.data.velocity),o=r.dataPatched;if(!("visibility"===o.physics.enabled?!o.visible:!o.physics.enabled)&&(this.controlsManager.sharedGameControlGlobals.rapierWorld?(this.controlsManager.addRigidBody(e,r,{fromCreate:!0,dynamic:this.data.dynamic}),"Collision"===this.data.destroy&&(null!==(t=e.rigidBody)&&void 0!==t&&t.collider(0).setActiveEvents(1),e.userData.hasCollisionDestroy=!0),e.matrixWorld.decompose(p1,d1,f1),a.applyQuaternion(d1),this.data.velocity.some((e=>0!==e))&&this.data.dynamic&&(null===(n=e.rigidBody)||void 0===n||n.setLinvel(a.divideScalar(this.controlsManager.pixelsPerMeter),!0))):("geometry"in e.object&&this.controlsManager.addBoundsTree(e),this.data.velocity.some((e=>0!==e))&&this.data.dynamic&&(e.userData.velocity=a)),!0===(null===(i=r.dataPatched.physics)||void 0===i?void 0:i.fusedBody)))return!0};let s=this.page.scene.find(this.data.object);if(!s)throw new Error("Missing Property");if(this.object=s,"world"!==this.data.coordinateSystem&&!this.page.scene.find(this.data.coordinateSystem))throw new Error("Missing Property");c1(n)}dispose(){null!==this.intervalId&&(window.clearInterval(this.intervalId),this.intervalId=null),this.timeoutIdQueue.forEach((e=>window.clearTimeout(e))),this.dispatchThrottled.cancel(),this.page.remove(...this.controlsManager.sharedGameControlGlobals.createdObjects),this.controlsManager.sharedGameControlGlobals.createdObjects=[]}},g1=.02,v1=(new Lv,new Lv),y1=new Lv,x1=new Lv,b1=new Lv,w1=new Lv,D1=new Lv,_1=new py,S1=new py,E1=new py,C1=(new py,new Rv),A1=new Rv,M1=new _y(0,0,0,"YXZ"),T1=new Lv(1,0,0),P1=new Lv(0,1,0),F1=new Lv(0,0,1),O1=new Lv(1,1,1),I1=(new ry,new DE),k1=new jv,B1={type:"requestRender"},R1={type:"updateMatrix"},L1=Math.PI/6,z1=class extends Yg{constructor(e,t,n,i,r,s,a,o,l){var u,c,h,p,f,m,g,v,y,x,b,w,D,_,S,E,C,A,M;super(),this.object=e,this.domElement=t,this.data=n,this.gloabalPhysics=i,this.controlsManager=r,this.cameraFollow=s,this.camera=a,this.page=o,this.sharedAssets=l,this.enableDamping=!0,this.hiddenMatrix0=new py,this.target0=new Lv,this.zoom0=1,this.rotForce=1,this.moveForce=1,this.pixelsPerMeter=200,this.euler0=new _y(0,0,0,"YXZ"),this.position0Cam=new Lv,this.quat0Cam=new Rv,this.scale0Cam=new Lv,this.hiddenMatrix0Cam=new py,this.threshEndTranslate=.01,this.threshEndRotate=1e-8,this.threshEndRotVel=.005,this.collider={type:"capsule",radius:40,segment:new DE(new Lv(0,-40,0),new Lv(0,40,0)),matrix:new py,position:new Lv,rotation:new Rv},this.euler=new _y(0,0,0,"YXZ"),this.eulerDelta=new Lv,this.lastPosition=new Lv,this.lastCameraQuaternion=new Rv,this.lastCameraPosition=new Lv,this.PI_2=Math.PI/2,this.prevMouse=new lv,this.velocityTarget=new Lv,this.velocity=new Lv,this.directionXZ=new Lv,this.rotVelocityStick=new Lv,this.rotVelocityTarget=new Lv,this.rotVelocity=new Lv,this.rotDirection=new Lv,this.nonColliderRotOffset=new py,this.nonColliderPosOffset=new py,this.firstPointerId=-1,this.rot=new Lv,this.path=[],this.movementState={moveNegZ:0,movePosZ:0,moveNegX:0,movePosX:0,moveNegY:0,movePosY:0,rotPosX:0,rotNegX:0,rotPosY:0,rotNegY:0,jump:0,run:0},this.vrEulerYOffset=0,this.onObject=!1,this.actionState={},this.keyAssignments=[["moveNegZ","W"],["moveNegX","A"],["movePosZ","S"],["movePosX","D"],["rotPosX","ArrowUp"],["rotPosY","ArrowLeft"],["rotNegX","ArrowDown"],["rotNegY","ArrowRight"],["jump"," "]],this.collisionEnabled=!0,this.offsetMatrix=new py,this.objectToTarget=new Lv,this.objectToTarget0=new Lv,this.objectToCamXZ=new Lv,this.objectToCamXZ0=new Lv,this.targetToCamera=new Lv,this.targetToCamera0=new Lv,this.cameraPolarAxis0=new Lv,this.targetPos=new Lv,this.targetQuat=new Rv,this.lerpFactorPos=(new Lv).setScalar(.3),this.lerpFactorPosStart=.3,this.lerpFactorPosEnd=.3,this.lerpFactorRotStart=.3,this.lerpFactorRotEnd=.3,this.lerpFactorPosCamera=.3,this.lerpFactorRotCamera=.3,this.objXZQuat=new Rv,this.objXZQuatInv=new Rv,this.objXZRotMat=new py,this.isFirstPerson=!1,this.didHit=!1,this.groundVelocity=new Lv,this.pushedVelocity=new Lv,this.groundYRotation=0,this.objectRealQuat=new Rv,this.colliderWorldQuat=new Rv,this.groundNormal=new Lv,this.groundTilt=new Rv,this.groundTiltInv=new Rv,this.lastHitObj=null,this.isFirstFrame=!0,this.rotationAccumWhenOrientWithCamera=0,this.navMeshPathDest=null,this.position=new Lv,this.quaternion=new Rv,this.scale=new Lv,this.initialAction=!0,this.onPointerDown=e=>{var t;!(e.target===this.domElement||e.target instanceof HTMLElement&&"SPLINE-VIEWER"===e.target.tagName&&null!==(t=e.target.shadowRoot)&&void 0!==t&&t.contains(this.domElement))||-1!==this.firstPointerId||(this.firstPointerId=e.pointerId,this.domElement.ownerDocument.addEventListener("pointermove",this.onPointerMove),this.domElement.ownerDocument.addEventListener("pointerup",this.onPointerUp),"keys"!==this.rotBy&&!EF&&!CF&&this.domElement.requestPointerLock(),this.prevMouse.set(e.clientX,e.clientY))},this.onPointerUp=e=>{this.firstPointerId=-1,this.domElement.ownerDocument.removeEventListener("pointermove",this.onPointerMove),this.domElement.ownerDocument.removeEventListener("pointerup",this.onPointerUp),"mouse"===e.pointerType&&this.domElement.ownerDocument.exitPointerLock()},this.onPointerMove=e=>{if(e.pointerId!==this.firstPointerId)return;let t=e.clientX-this.prevMouse.x,n=e.clientY-this.prevMouse.y;this.prevMouse.set(e.clientX,e.clientY),"mouse"===e.pointerType&&"keys"!==this.rotBy&&(CF&&AF<15.5&&!EF?(this.eulerDelta.y=-t*this.mouseOrbitSensitivity,this.eulerDelta.x=-n*this.mouseOrbitSensitivity):(this.eulerDelta.y=-e.movementX*this.mouseOrbitSensitivity,this.eulerDelta.x=-e.movementY*this.mouseOrbitSensitivity)),"mouse"!==e.pointerType&&"drag"===this.rotByTouch&&(this.eulerDelta.y=-t*this.mouseOrbitSensitivity*5,this.eulerDelta.x=-n*this.mouseOrbitSensitivity*5),this.controlsManager.requestRender()},this.onPointerlockChange=e=>{this.domElement.ownerDocument.pointerLockElement===this.domElement?z1.isLocked=!0:z1.isLocked=!1},this.onPointerlockError=()=>{console.error("SPE.GameControls: Unable to use Pointer Lock API")},this.handleVisibilityChange=()=>{var e;if(null!==(e=document)&&void 0!==e&&e.hidden)for(let t in this.movementState)this.movementState[t]=0},this.onKeyDown=e=>{!(e.target instanceof HTMLInputElement)&&("ArrowLeft"===e.code||"ArrowUp"===e.code||"ArrowRight"===e.code||"ArrowDown"===e.code||"Space"===e.code)&&e.preventDefault();for(let t of this.keyAssignments)if(e.key.toUpperCase()===t[1]||e.key===t[1]){this.movementState[t[0]]=1;break}this.controlsManager.requestRender()},this.onKeyUp=e=>{for(let t of this.keyAssignments)if(e.key.toUpperCase()===t[1]||e.key===t[1]||e.code.slice(3,e.code.length).toUpperCase()===t[1]){this.movementState[t[0]]=0;break}},this.copyVRGamePadValues=(e,t)=>{for(let n=2;n<4;n++){let i=e.axes[n];0===t?2===n?this.movementState.movePosX=i:this.movementState.movePosZ=i:(e.buttons[3].pressed?this.movementState.jump=1:this.movementState.jump=0,2===n?(Math.abs(this.movementState.rotPosY)<.3&&Math.abs(i)>=.3&&(this.vrEulerYOffset+=i<0?1:-1),this.movementState.rotPosY=i):"fly"===this.moveMode&&(this.movementState.moveNegY=i))}},this.sharedGameControlGlobals=r.sharedGameControlGlobals,e===a&&(this.isFirstPerson=!0),this.hiddenMatrix0.copy(this.object.hiddenMatrix),this.object.parent?this.object.hiddenMatrix.copy(this.object.parent.matrixWorld).invert():this.object.hiddenMatrix.identity(),this.object.matrix.copy(this.object.matrixWorld),this.object.matrix.decompose(this.position,this.quaternion,this.scale),this.euler0.setFromQuaternion(this.quaternion,"YXZ");let T=this.euler0.clone(),P=T.y;if(this.objectRealQuat.copy(this.quaternion),T.y=0,this.quaternion.setFromEuler(T),this.objXZQuat.copy(this.quaternion),this.objXZQuatInv.copy(this.objXZQuat).invert(),this.objXZRotMat.makeRotationFromQuaternion(this.quaternion),T.set(0,P,0),this.quaternion.setFromEuler(T),this.rot.setFromEuler(T),this.object.matrixAutoUpdate=!1,(this.isFirstPerson||!0===this.cameraFollow)&&(this.target0.copy(this.camera.getTarget()),this.zoom0=this.camera.zoom),!0===this.cameraFollow){var F;this.position0Cam.copy(this.camera.position),this.quat0Cam.copy(this.camera.quaternion),this.scale0Cam.copy(this.camera.scale),this.hiddenMatrix0Cam.copy(this.camera.hiddenMatrix),this.camera.parent?(this.camera.hiddenMatrix.copy(null===(F=this.camera)||void 0===F?void 0:F.parent.matrixWorld),this.camera.matrix.copy(this.camera.matrixWorld)):this.camera.hiddenMatrix.identity(),this.camera.matrix.copy(this.camera.matrixWorld),this.camera.matrix.decompose(this.camera.position,this.camera.quaternion,this.camera.scale),this.camera.matrixAutoUpdate=!1,this.offsetMatrix.copy(this.object.matrix).invert().multiply(this.camera.matrix);let e,t,n=new Lv(0,0,-1).applyQuaternion(this.camera.quaternion),i=(new Lv).subVectors(this.position,this.camera.position);this.objectToCamXZ.copy(i),this.objectToCamXZ.y=0,this.objectToCamXZ0.copy(this.objectToCamXZ),Math.abs(n.y)<1e-6?(i.y=0,n.y=0,t=i.projectOnVector(n)):t=i.y/n.y>0?n.multiplyScalar(i.y/n.y):n.multiplyScalar(i.length()),this.targetToCamera0.copy(t).negate(),e=this.camera.position.clone().add(t),this.objectToTarget0.subVectors(e,this.position);let r=(new _y).setFromQuaternion(this.camera.quaternion,"YXZ");this.cameraPolarOffset=-r.x,r.x=0,r.z=0,r.y-=Math.PI/2,this.cameraPolarAxis0.set(0,0,-1).applyEuler(r)}if(this.object instanceof OY&&(this.object.matrixAutoUpdate=!1),this.euler.setFromQuaternion(this.quaternion,"YXZ"),this.rotByTouch=null!==(u=n.rotByTouch)&&void 0!==u?u:"joystick",this.rotBy=null!==(c=n.rotBy)&&void 0!==c?c:"keys",this.rotationMode=null!==(h=n.rotationMode)&&void 0!==h?h:"normal",this.moveMode=null!==(p=n.moveMode)&&void 0!==p?p:"walk",this.collisionEnabled=n.collisionEnabled,this.speedTranslate=1*(null!==(f=n.speedTranslate)&&void 0!==f?f:250),this.speedOrbit=.025*(null!==(m=n.speedRotate)&&void 0!==m?m:100),this.mouseOrbitSensitivity=16e-6*(null!==(g=n.speedRotate)&&void 0!==g?g:100),this.keyAssignments=n.keyAssignments.map((e=>{let t=[e[0],e[1]];return"\u25b2"===t[1]?t[1]="ArrowUp":"\u25c0"===t[1]?t[1]="ArrowLeft":"\u25bc"===t[1]?t[1]="ArrowDown":"\u25b6"===t[1]?t[1]="ArrowRight":"\u21e7"===t[1]?t[1]="Shift":"\u21b5"===t[1]?t[1]="Enter":"Space"===t[1]?t[1]=" ":"\u2318"===t[1]?t[1]="Meta":"Ctrl"===t[1]?t[1]="Control":"Esc"===t[1]&&(t[1]="Escape"),t})),"mouse"===n.rotBy){let e;e=this.keyAssignments.findIndex((e=>"rotNegX"===e[0])),-1!==e&&(this.keyAssignments[e][1]=""),e=this.keyAssignments.findIndex((e=>"rotPosX"===e[0])),-1!==e&&(this.keyAssignments[e][1]=""),e=this.keyAssignments.findIndex((e=>"rotPosY"===e[0])),-1!==e&&(this.keyAssignments[e][1]=""),e=this.keyAssignments.findIndex((e=>"rotNegY"===e[0])),-1!==e&&(this.keyAssignments[e][1]="")}this.lerpFactorPosStart=1-.02**(1/(60*(null!==(v=n.delayPos[0])&&void 0!==v?v:.3))),this.lerpFactorPosEnd=1-.02**(1/(60*(null!==(y=n.delayPos[1])&&void 0!==y?y:.3))),this.lerpFactorPos.setScalar(this.lerpFactorPosStart),this.lerpFactorRotStart=1-.02**(1/(60*(null!==(x=n.delayRot[0])&&void 0!==x?x:.3))),this.lerpFactorRotEnd=1-.02**(1/(60*(null!==(b=n.delayRot[1])&&void 0!==b?b:.3))),this.lerpFactorPosCamera=1-.02**(1/(60*(null!==(w=n.delayPosCamera)&&void 0!==w?w:.3))),this.lerpFactorRotCamera=1-.02**(1/(60*(null!==(D=n.delayRotCamera)&&void 0!==D?D:.3))),this.gravity=12*(null!==(_=this.gloabalPhysics.gravity)&&void 0!==_?_:BB.defaultData.gravity),this.usePhysics=null!==(S=this.gloabalPhysics.usePhysics)&&void 0!==S?S:BB.defaultData.usePhysics,this.jumpPower=20*n.jumpPower,this.resetYPosition=this.position.y+Math.abs(n.resetYPosition)*(this.gravity>0?1:-1),this.alignToGround=null!==(E=n.alignToGround)&&void 0!==E&&E,this.orientMode=n.autoOrientMove?n.orientMode:"none",this.orientWith=null!==(C=n.orientWith)&&void 0!==C?C:vR.defaultDataThirdPerson.orientWith,this.slopeThresh=65*Math.PI/180,"capsule"===n.collider.type?(this.collider.radius=n.collider.radius,this.collider.segment.start.y=n.collider.height/2-n.collider.radius,this.collider.segment.end.y=-this.collider.segment.start.y,this.offset=n.collider.height*g1/this.pixelsPerMeter,this.stepThresh=.3*n.collider.height/this.pixelsPerMeter,this.colliderHeight=n.collider.height):"sphere"===n.collider.type?(this.collider.radius=n.collider.radius,this.collider.segment.start.y=0,this.collider.segment.end.y=0,this.offset=2*n.collider.radius*g1/this.pixelsPerMeter,this.stepThresh=2*n.collider.radius*.3/this.pixelsPerMeter,this.colliderHeight=2*n.collider.radius):(this.offset=n.collider.height*g1/this.pixelsPerMeter,this.stepThresh=.3*n.collider.height/this.pixelsPerMeter,this.colliderHeight=n.collider.height),this.collider.type=n.collider.type;let O=(new Lv).fromArray(n.collider.position),I=(new Rv).setFromEuler((new _y).fromArray([...n.collider.rotation,"XYZ"]));this.collider.position.copy(O).multiply(this.scale),this.collider.rotation.copy(I),this.collider.matrix.compose(O,I,O1),void 0!==n.cameraXAxis&&(this.cameraXAxis=n.cameraXAxis,this.cameraYAxis=n.cameraYAxis,this.minPolarAngle=n.cameraRotXLimits[0],this.maxPolarAngle=n.cameraRotXLimits[1],this.minAzimuthAngleRel=n.cameraRotYLimits[0],this.maxAzimuthAngleRel=n.cameraRotYLimits[1]),this.forwardDir=null!==(A=n.forwardDirection)&&void 0!==A?A:"-z",this.isFirstPerson&&(this.forwardDir="-z"),this.runMultiplier=null!==(M=n.runMultiplier)&&void 0!==M?M:2;let k=2*n.navmesh.destinationHelperRadius;if(k>0){let e=new sO;e.push({fi:0,data:d(d({},vB.defaultData("light","phong")),{},{alpha:0}),id:"layer1"}),e.push({fi:0,data:d(d({},vB.defaultData("color")),{},{color:n.navmesh.destinationHelperColor,alpha:n.navmesh.destinationHelperColor.a}),id:"layer2"});let t=new fG({layers:e},{scene:this.page.scene,shared:this.sharedAssets});this.navMeshPathDest=new Cx(uN.create({parameters:{width:k,height:k/10,hollow:.7}}),t),this.navMeshPathDest.material.userData.opacity0=n.navmesh.destinationHelperColor.a}this.activate()}reset(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.object.hiddenMatrix.copy(this.hiddenMatrix0),e){this.object.updateMatrix(),this.object.updateMatrixWorld(),this.object.matrix.copy(this.object.matrixWorld),this.object.matrix.decompose(this.position,this.quaternion,this.scale),this.object.parent?this.object.hiddenMatrix.copy(this.object.parent.matrixWorld).invert():this.object.hiddenMatrix.identity();let e=(new _y).setFromQuaternion(this.quaternion,"YXZ"),t=e.y;this.objectRealQuat.copy(this.quaternion),e.y=0,this.quaternion.setFromEuler(e),this.objXZQuat.copy(this.quaternion),this.objXZQuatInv.copy(this.objXZQuat).invert(),this.objXZRotMat.makeRotationFromQuaternion(this.quaternion),e.set(0,t,0),this.quaternion.setFromEuler(e),this.rot.setFromEuler(e),this.euler.setFromQuaternion(this.quaternion,"YXZ"),this.velocityTarget.set(0,0,0),this.velocity.set(0,0,0)}else this.object instanceof OY?this.object.matrixAutoUpdate=!0:this.object.updateMatrix();!0===this.cameraFollow&&(this.camera.quaternion.copy(this.quat0Cam),this.camera.position.copy(this.position0Cam),this.camera.scale.copy(this.scale0Cam),this.camera.hiddenMatrix.copy(this.hiddenMatrix0Cam),this.camera.matrixAutoUpdate=!0),this.controlsManager.requestRender()}activate(){this.instantiateActions(),this.domElement.ownerDocument.addEventListener("pointerdown",this.onPointerDown),this.domElement.ownerDocument.addEventListener("keydown",this.onKeyDown),this.domElement.ownerDocument.addEventListener("keyup",this.onKeyUp),this.domElement.ownerDocument.addEventListener("pointerlockchange",this.onPointerlockChange),this.domElement.ownerDocument.addEventListener("pointerlockerror",this.onPointerlockError),this.domElement.ownerDocument.addEventListener("visibilitychange",this.handleVisibilityChange)}deactivate(){this.disposeActions(),this.domElement.ownerDocument.removeEventListener("pointerdown",this.onPointerDown),this.domElement.ownerDocument.removeEventListener("keydown",this.onKeyDown),this.domElement.ownerDocument.removeEventListener("keyup",this.onKeyUp),this.domElement.ownerDocument.removeEventListener("pointerlockchange",this.onPointerlockChange),this.domElement.ownerDocument.removeEventListener("pointerlockerror",this.onPointerlockError),this.domElement.ownerDocument.removeEventListener("visibilitychange",this.handleVisibilityChange)}dispose(){var e;this.deactivate(),(null===(e=this.navMeshPathDest)||void 0===e?void 0:e.parent)&&this.page.remove(this.navMeshPathDest)}instantiateActions(){let e=this.data,t=this.sharedAssets;void 0!==e.gameActions&&(this.actions={},gR.list.forEach((n=>{this.actions[n]=i1(d(d({},e),{},{disabled:!1,type:"GameControl"}),e.gameActions[n],this.page,t,this.controlsManager.eventManager,this.object)}))),this.dispatchStopEvent("move"),this.dispatchStopEvent("run"),this.dispatchStopEvent("jump"),this.dispatchStartEvent("idle"),this.initialAction&&(this.initialAction=!1)}disposeActions(){this.initialAction=!1,this.dispatchStopEvent("idle"),this.dispatchStopEvent("move"),this.dispatchStopEvent("run"),this.dispatchStopEvent("jump"),r1(this.actions.idle),r1(this.actions.move),r1(this.actions.run),r1(this.actions.jump)}dispatchStartEvent(e){void 0!==this.actions[e]&&(this.actionState[e]||(this.actionState[e]=!0,this.actions[e].Transition.forEach((e=>{e.play()})),this.actions[e].Animation.forEach((e=>{e.play(!1===this.initialAction)})),this.actions[e].Create.forEach((e=>{e.dispatchStart()})),this.actions[e].Audio.forEach((e=>{e.dispatchGameControl("start")})),this.actions[e].Particles.forEach((e=>{e.dispatchGameControl("start")}))))}dispatchStopEvent(e){void 0!==this.actions[e]&&(!this.actionState[e]||(this.actionState[e]=!1,this.actions[e].Transition.forEach((e=>{e.stop(),null!==e.object.currentState&&e.object.changeSelectedState(null,{scene:this.page.scene,shared:this.sharedAssets})})),this.actions[e].Create.forEach((e=>{e.dispatchStop()})),this.actions[e].Audio.forEach((e=>{e.dispatchGameControl("stop")})),this.actions[e].Particles.forEach((e=>{e.dispatchGameControl("stop")}))))}get colliderWorldPosition(){return b1.copy(this.collider.position).applyQuaternion(this.objectRealQuat).add(this.position)}update(e,t,n){var i;if(this.gravity<0?this.position.y<this.resetYPosition:this.position.y>this.resetYPosition)return this.reset(!0),!0;this.sharedGameControlGlobals.gamePads.forEach(this.copyVRGamePadValues);let r=(this.isFirstFrame?16.6:e)/1e3;this.isFirstFrame&&(this.isFirstFrame=!1);let s=60*r,a=!1;if(this.usePhysics&&this.collisionEnabled){var o;let e=w1.set(0,(0===this.velocity.y?this.pixelsPerMeter*Math.max(Math.abs(this.gravity)/120,1)*(this.gravity>0?1:-1):this.velocity.y)*r,0).divideScalar(this.pixelsPerMeter),t=this.sharedGameControlGlobals.rapierWorld.castShape(this.colliderWorldPosition.divideScalar(this.pixelsPerMeter),this.colliderWorldQuat,e,null===(o=this.object.rigidBody)||void 0===o?void 0:o.collider(0).shape,1,!1,16,void 0,void 0,this.object.rigidBody);if(t){var l;this.onObject=!0,this.groundNormal.set(t.normal2.x,t.normal2.y,t.normal2.z).applyQuaternion(this.colliderWorldQuat).negate(),this.alignToGround&&this.groundTiltAdjustment(this.groundNormal),Math.acos(this.groundNormal.y)<this.slopeThresh&&(a=!0),0===(null===(l=t.collider.parent())||void 0===l?void 0:l.bodyType())&&Math.acos(this.groundNormal.y)*(180/Math.PI)>45&&(this.onObject=!1);let e=t.collider.parent();this.groundYRotation=0,this.groundVelocity.set(0,0,0);for(let t of this.sharedGameControlGlobals.entitiesWithTransformAnim)if(t.rigidBody===e&&t.userData.isFollowingObj!==this.object.uuid){(t.hasNonUniformScale?t.matrixWorldRigid:t.matrixWorld).decompose(b1,A1,w1),this.groundVelocity.subVectors(b1,t.prevT),this.object.getWorldPosition(w1).add(this.collider.position).sub(b1),this.groundYRotation=M1.setFromQuaternion(A1).y-t.prevR.y,D1.copy(w1).applyAxisAngle(P1,this.groundYRotation),this.groundVelocity.add(D1.sub(w1)).divideScalar(r);break}}else this.onObject=!1}if("walk"===this.moveMode&&this.collisionEnabled&&(1===this.movementState.jump&&this.onObject&&(this.velocityTarget.y=this.jumpPower,this.movementState.jump=0,this.dispatchStopEvent("idle"),this.dispatchStopEvent("move"),this.dispatchStopEvent("run"),this.dispatchStopEvent("jump"),this.dispatchStartEvent("jump"),this.onObject=!1),this.onObject?this.velocityTarget.y/=2:this.velocityTarget.y+=this.gravity*s),"fly"===this.moveMode&&(this.velocityTarget.y=(this.movementState.movePosY-this.movementState.moveNegY)*this.speedTranslate),this.directionXZ.z=this.movementState.movePosZ-this.movementState.moveNegZ,this.directionXZ.x=this.movementState.movePosX-this.movementState.moveNegX,"+z"===this.forwardDir&&this.directionXZ.multiplyScalar(-1),this.directionXZ.manhattanLength()>0&&(this.path=[]),this.navMeshPathDest){let e=this.navMeshPathDest.material;if("walk"===this.moveMode&&this.path.length>1){this.navMeshPathDest.position.copy(this.path[this.path.length-1]),this.navMeshPathDest.parent||this.page.add(this.navMeshPathDest);let t=b1.subVectors(this.path[1],this.position),n=w1.subVectors(this.path[1],this.path[0]);t.dot(n)<0?this.path.shift():(this.directionXZ.x=n.x,this.directionXZ.z=n.z),e.opacity=e.userData.opacity0}else e.opacity-=.05*e.userData.opacity0,this.navMeshPathDest.material.opacity<=0&&this.navMeshPathDest.parent&&this.page.remove(this.navMeshPathDest)}this.directionXZ.normalize(),this.movementState.run?this.moveForce=this.runMultiplier:this.moveForce=1,this.velocityTarget.z=this.directionXZ.z*this.speedTranslate*this.moveForce,this.velocityTarget.x=this.directionXZ.x*this.speedTranslate*this.moveForce,("walk"===this.moveMode?this.velocityTarget.x+this.velocityTarget.z===0:0===this.velocityTarget.manhattanLength())?this.lerpFactorPos.setScalar(this.lerpFactorPosEnd):this.lerpFactorPos.setScalar(this.lerpFactorPosStart),"walk"===this.moveMode&&(this.lerpFactorPos.y=1),!1===this.didHit&&0===this.pushedVelocity.manhattanLength()||!1===this.usePhysics?(this.velocity.x+=(this.velocityTarget.x-this.velocity.x)*(1-(1-this.lerpFactorPos.x)**s),this.velocity.y+=(this.velocityTarget.y-this.velocity.y)*(1-(1-this.lerpFactorPos.y)**s),this.velocity.z+=(this.velocityTarget.z-this.velocity.z)*(1-(1-this.lerpFactorPos.z)**s)):this.velocity.copy(this.velocityTarget),("walk"===this.moveMode?this.velocity.x**2+this.velocity.z**2<this.speedTranslate:this.velocity.lengthSq()<this.speedTranslate)?(this.dispatchStopEvent("move"),this.dispatchStopEvent("run"),this.onObject&&(this.dispatchStopEvent("jump"),this.dispatchStartEvent("idle"))):(this.dispatchStopEvent("idle"),this.onObject&&(this.dispatchStopEvent("jump"),this.movementState.run?(this.dispatchStopEvent("move"),this.dispatchStartEvent("run")):(this.dispatchStopEvent("run"),this.dispatchStartEvent("move"))));let u=x1.copy(this.velocity);if("none"!==this.orientMode&&!1===this.isFirstPerson){let e=w1.copy(u);e.y=0,u.set(0,u.y,e.length()*("+z"===this.forwardDir?1:-1))}if(this.directionXZ.manhattanLength()>0&&"none"!==this.orientMode&&!1===this.isFirstPerson)if("camera"===this.orientWith&&this.path.length<=1){let e=b1;this.camera.getWorldDirection(e);let t=D1.copy(P1).multiplyScalar(e.dot(P1));e.sub(t);let n=w1.copy(this.directionXZ);n.x*=-1,this.rot.y=e.angleTo(n)*(e.cross(n).y>0?-1:1)+this.rotationAccumWhenOrientWithCamera}else this.rot.y=(this.path.length>1?0:this.euler.y)+Math.atan2(-this.directionXZ.z,this.directionXZ.x)+Math.PI/2*("+z"===this.forwardDir?1:-1);if(M1.setFromVector3(this.rot),"walk"===this.moveMode&&(M1.x=0),u.applyEuler(M1),a&&(A1.setFromUnitVectors(P1,this.groundNormal),u.applyQuaternion(A1)),n){let e=M1.set(0,this.vrEulerYOffset*L1,0);n.applyEuler(e),u.x+=n.x,u.z+=n.z,this.nonColliderPosOffset.elements[13]+=n.y*r}if(!0===this.usePhysics){let e=w1;this.pushedVelocity.set(0,0,0);for(let t of this.sharedGameControlGlobals.entitiesWithTransformAnim){let n=D1.setFromMatrixPosition(t.matrixWorld).sub(t.prevT).divideScalar(r).divideScalar(this.pixelsPerMeter),i=t.rigidBody.collider(0).castCollider(n,this.object.rigidBody.collider(0),b1.copy(u).divideScalar(this.pixelsPerMeter),r,!1);n.multiplyScalar(this.pixelsPerMeter);let s=Nz.is(t)?t:t.object;if(null!==i&&this.lastHitObj!==s){let e;t instanceof Vz&&(e=t);let n=this.sharedGameControlGlobals.entityToCollisionEvents[s.uuid];if(n)for(let t of n)"character"===t.data.target&&(t.dispatch(e),s.dispatchEvent(u4));this.lastHitObj=s}if(null!==i){this.pushedVelocity.copy(n),e.copy(i.normal1).applyQuaternion(t.quaternion);break}}if(0!==this.pushedVelocity.manhattanLength()){let t=e.dot(u);t<0&&u.addScaledVector(e,-t),u.add(this.pushedVelocity)}else u.add(this.groundVelocity)}if(this.rotDirection.y=Number(this.movementState.rotPosY)-Number(this.movementState.rotNegY),this.rotDirection.x=Number(this.movementState.rotPosX)-Number(this.movementState.rotNegX),this.rotDirection.normalize(),"normal"===this.rotationMode&&(this.movementState.rotPosX||this.movementState.rotNegX)||"steer"===this.rotationMode&&(this.movementState.rotPosX||this.movementState.rotNegX)&&(this.movementState.movePosZ||this.movementState.moveNegZ||"walk"===this.moveMode)?this.rotVelocityStick.x=-this.rotDirection.x*this.speedOrbit*this.rotForce:this.rotVelocityStick.x=0,"normal"===this.rotationMode&&(this.movementState.rotPosY||this.movementState.rotNegY)||"steer"===this.rotationMode&&(this.movementState.rotPosY||this.movementState.rotNegY)&&(this.movementState.movePosZ||this.movementState.moveNegZ)?this.rotVelocityStick.y=-this.rotDirection.y*this.speedOrbit*this.rotForce:this.rotVelocityStick.y=0,this.rotVelocityTarget.subVectors(this.eulerDelta.divideScalar(r),this.rotVelocityStick),0===this.rotVelocityTarget.manhattanLength()?this.rotVelocity.lerp(this.rotVelocityTarget,1-(1-this.lerpFactorRotEnd)**s):this.rotVelocity.lerp(this.rotVelocityTarget,1-(1-this.lerpFactorRotStart)**s),this.euler.x+=this.rotVelocity.x*r,this.euler.y+=this.rotVelocity.y*r+this.groundYRotation,0===this.rotVelocityTarget.y&&0===this.directionXZ.manhattanLength()?this.rotationAccumWhenOrientWithCamera=0:(!1===this.cameraFollow||"Locked"===this.cameraYAxis)&&(this.rotationAccumWhenOrientWithCamera+=this.rotVelocity.y*r),!1===this.isFirstPerson&&"none"!==this.orientMode&&this.directionXZ.manhattanLength()>0){if("radial"===this.orientMode){this.objectToCamXZ.copy(this.objectToCamXZ0).applyAxisAngle(P1,this.euler.y-this.euler0.y);let e=w1.copy(this.objectToCamXZ).normalize(),t=D1.copy(u).multiplyScalar(r);t.y=0;let n=t.sub(b1.copy(e).multiplyScalar(t.dot(e))).cross(e).y;this.euler.y-=Math.atan2(n,this.objectToCamXZ.length())}}else this.rot.y+=this.rotVelocity.y*r+this.groundYRotation,0!==this.rotVelocityTarget.y&&(!1===this.cameraFollow||"Locked"===this.cameraYAxis)&&(this.euler.y=this.rot.y);if(!0===this.cameraFollow&&("walk"===this.moveMode?"Limit"===this.cameraXAxis?this.euler.x=ov.clamp(this.euler.x,-this.maxPolarAngle+this.cameraPolarOffset+1e-6,-this.minPolarAngle+this.cameraPolarOffset-1e-6):this.euler.x=ov.clamp(this.euler.x,-this.PI_2+this.cameraPolarOffset,this.PI_2+this.cameraPolarOffset):"Limit"===this.cameraXAxis&&(this.euler.x=ov.clamp(this.euler.x,-this.PI_2,this.PI_2))),"fly"===this.moveMode?this.rot.x=this.euler.x:this.isFirstPerson&&(t?(M1.copy(t),M1.y=0):(M1.copy(this.euler),M1.y=0),this.nonColliderRotOffset.makeRotationFromEuler(M1)),t&&("walk"===this.moveMode?(this.rot.y=t.y,this.rot.x=0,this.rot.z=0):this.rot.setFromEuler(t),this.rot.y+=this.vrEulerYOffset*L1),C1.setFromAxisAngle(T1,this.rot.x),A1.setFromAxisAngle(P1,this.rot.y),A1.multiply(C1),C1.setFromAxisAngle(F1,this.rot.z),A1.multiply(C1),this.quaternion.copy(A1),this.objectRealQuat.multiplyQuaternions(this.quaternion,this.objXZQuat),this.colliderWorldQuat.copy(this.objectRealQuat).multiply(this.collider.rotation),this.collisionEnabled)if(this.usePhysics){var c,h;let e=w1.copy(u).multiplyScalar(r/this.pixelsPerMeter),t=null;this.didHit=!1;let n=new Lv;for(let i=0;i<5;i++){var d;let r=e.length(),s=D1.copy(e).normalize();if(t=this.sharedGameControlGlobals.rapierWorld.castShape(this.colliderWorldPosition.divideScalar(this.pixelsPerMeter).add(n),this.colliderWorldQuat,s,null===(d=this.object.rigidBody)||void 0===d?void 0:d.collider(0).shape,r,!1,24,void 0,void 0,this.object.rigidBody),null===t){0===i&&0!==this.directionXZ.manhattanLength()&&(this.lastHitObj=null),n.add(e);break}{this.didHit=!0;let a=this.sharedGameControlGlobals.colliderToEntity.get(t.collider.handle);if(a!==this.lastHitObj&&0===i){this.lastHitObj=a;let e=this.sharedGameControlGlobals.entityToCollisionEvents[null===a||void 0===a?void 0:a.uuid];if(e)for(let n of e)if("character"===n.data.target){var p;let e,i=(null===(p=this.sharedGameControlGlobals.rapierWorld)||void 0===p?void 0:p.getCollider(t.collider.handle))._parent;if(a.cloner)for(let t of a.cloner.children)if(t.rigidBody===i){e=t;break}n.dispatch(e),a.dispatchEvent(u4)}}let o=v1.set(t.normal2.x,t.normal2.y,t.normal2.z).applyQuaternion(this.colliderWorldQuat),l=y1.copy(s).multiplyScalar(t.toi).dot(o),u=t.toi;if(0===u&&(this.position.y+=this.offset*this.pixelsPerMeter),l>this.offset&&(u=t.toi*(l-this.offset)/l,n.addScaledVector(s,u)),e.copy(s).multiplyScalar(r-u),Math.acos(-o.y)>this.slopeThresh){var f;let i=this.colliderWorldPosition.divideScalar(this.pixelsPerMeter).add(n),r=D1.copy(t.witness2).applyQuaternion(this.colliderWorldQuat);r.y=0;let s=i.add(r);s.y+=this.stepThresh;let a=this.sharedGameControlGlobals.rapierWorld.castShape(s,this.colliderWorldQuat,e,null===(f=this.object.rigidBody)||void 0===f?void 0:f.collider(0).shape,1,!1,24,void 0,void 0,this.object.rigidBody);null!==a&&0===a.toi&&(o.y=0,o.normalize())}e.addScaledVector(o,-e.dot(o))}}this.position.addScaledVector(n,this.pixelsPerMeter),null!==(c=this.object.rigidBody)&&void 0!==c&&c.setTranslation(b1.copy(this.position).divideScalar(this.pixelsPerMeter),!0),null===(h=this.object.rigidBody)||void 0===h||h.setRotation(C1.copy(this.quaternion).premultiply(this.groundTilt).multiply(this.objXZQuat),!0)}else{let e=this.onObject?1:5,t=u.multiplyScalar(r/e);for(let n=0;n<e;n++)this.position.add(t),this.collisionAdjustment(r/e)}else this.position.addScaledVector(u,r);if("walk"===this.moveMode&&this.onObject&&(this.velocityTarget.y=0,this.velocity.y=0),this.quaternion.premultiply(this.groundTilt).multiply(this.objXZQuat),this.object.matrix.compose(this.position,this.quaternion,this.scale),this.object.matrixWorldNeedsUpdate=!0,this.object.matrix.multiply(this.nonColliderPosOffset).multiply(this.nonColliderRotOffset),this.quaternion.premultiply(this.groundTiltInv).multiply(this.objXZQuatInv),!0===this.cameraFollow){this.updateFollowArms();let e=this.objectToTarget.add(this.position),t=this.targetToCamera.add(e);_1.lookAt(t,e,P1).setPosition(t),_1.decompose(this.targetPos,this.targetQuat,b1),this.camera.quaternion.slerp(this.targetQuat,1-(1-this.lerpFactorRotCamera)**s),this.camera.position.lerp(this.targetPos,1-(1-this.lerpFactorPosCamera)**s),this.camera.updateMatrix(),this.camera.updateMatrixWorld(),"Limit"===this.cameraYAxis&&"cartesian"===this.orientMode&&(this.euler.y=ov.clamp(this.euler.y,this.minAzimuthAngleRel,this.maxAzimuthAngleRel)),this.euler.x=ov.clamp(this.euler.x,-this.PI_2+(this.cameraPolarOffset<0?this.cameraPolarOffset:0),this.PI_2+(this.cameraPolarOffset>0?this.cameraPolarOffset:0))}return this.eulerDelta.set(0,0,0),this.object.dispatchEvent(R1),(!(this.path.length<2&&this.lastPosition.distanceToSquared(this.position)<this.threshEndTranslate&&Math.abs(this.rotVelocity.x)<this.threshEndRotVel&&Math.abs(this.rotVelocity.y)<this.threshEndRotVel&&(void 0===this.camera||this.isFirstPerson||this.lastCameraPosition.distanceToSquared(this.camera.position)<this.threshEndTranslate&&8*(1-this.lastCameraQuaternion.dot(this.camera.quaternion))<this.threshEndRotate))||"fly"!==this.moveMode&&!0!==this.onObject&&!1!==this.collisionEnabled||!(null===this.navMeshPathDest||this.navMeshPathDest.material.opacity<-.04*(null===(i=this.navMeshPathDest)||void 0===i||null===(i=i.material)||void 0===i?void 0:i.userData.opacity0)))&&(this.camera&&(this.lastCameraPosition.copy(this.camera.position),this.lastCameraQuaternion.copy(this.camera.quaternion)),this.lastPosition.copy(this.position),this.object.dispatchEvent(B1),!0)}updateFollowArms(){this.objectToTarget.copy(this.objectToTarget0),this.targetToCamera.copy(this.targetToCamera0);let e,t=C1.setFromAxisAngle(P1,"Limit"===this.cameraYAxis&&"radial"!==this.orientMode?ov.clamp(this.euler.y-this.euler0.y,this.minAzimuthAngleRel,this.maxAzimuthAngleRel):this.euler.y-this.euler0.y);("Locked"!==this.cameraYAxis||"radial"===this.orientMode)&&this.objectToTarget.applyQuaternion(t),e="Limit"===this.cameraXAxis?ov.clamp(this.euler.x,-this.maxPolarAngle+this.cameraPolarOffset+1e-6,-this.minPolarAngle+this.cameraPolarOffset-1e-6):ov.clamp(this.euler.x,-this.PI_2+this.cameraPolarOffset+1e-6,this.PI_2+this.cameraPolarOffset-1e-6);let n=b1.copy(this.cameraPolarAxis0);("Locked"!==this.cameraYAxis||"radial"===this.orientMode)&&n.applyQuaternion(t);let i=A1.setFromAxisAngle(n,e);"Locked"!==this.cameraYAxis&&this.targetToCamera.applyQuaternion(t),"Locked"!==this.cameraXAxis&&this.targetToCamera.applyQuaternion(i)}groundTiltAdjustment(e){180*P1.angleTo(e)/Math.PI<15||180*P1.angleTo(e)/Math.PI>85?C1.identity():C1.setFromUnitVectors(P1,e),this.groundTilt.slerp(C1,.06),this.groundTiltInv.copy(this.groundTilt).invert()}collisionAdjustment(e){var t;let n=y1.set(0,0,0);this.object.matrix.compose(this.position,this.quaternion,this.scale);let i=_1.multiplyMatrices(this.object.matrix,this.objXZRotMat).multiply(this.collider.matrix).decompose(b1,C1,w1).compose(b1,C1,O1);this.sharedGameControlGlobals.entitiesWithTransformAnim.forEach((e=>{if(e===this.object||e.isDescendantOf(this.object))return;k1.makeEmpty(),e.updateMatrixWorldSVD();let t=e.matrixWorldRigid,r=S1.copy(t).invert(),s=E1.copy(S1).multiply(i);I1.copy(this.collider.segment),I1.start.applyMatrix4(s),I1.end.applyMatrix4(s);let a=v1.copy(this.position).applyMatrix4(r);k1.expandByPoint(I1.start),k1.expandByPoint(I1.end),k1.min.addScalar(-this.collider.radius),k1.max.addScalar(this.collider.radius),e.bvhGeometry.boundsTree.shapecast({traverseBoundsOrder:e=>e.distanceToPoint(I1.end),intersectsBounds:e=>e.intersectsBox(k1),intersectsTriangle:e=>{let i=b1,r=w1,s=e.closestPointToSegment(I1,i,r);if(s<this.collider.radius){let e=this.collider.radius-s,o=r.sub(i).normalize(),l=D1.copy(a);l.addScaledVector(o,e);let u=l.applyMatrix4(t).sub(this.position);n.add(u),I1.start.addScaledVector(o,e),I1.end.addScaledVector(o,e)}}})})),k1.makeEmpty(),I1.copy(this.collider.segment),I1.start.applyMatrix4(i),I1.end.applyMatrix4(i),k1.expandByPoint(I1.start),k1.expandByPoint(I1.end),k1.min.addScalar(-this.collider.radius),k1.max.addScalar(this.collider.radius),null!==(t=this.sharedGameControlGlobals.staticMeshBVH)&&void 0!==t&&t.shapecast({traverseBoundsOrder:e=>e.distanceToPoint(I1.end),intersectsBounds:e=>e.intersectsBox(k1),intersectsTriangle:e=>{let t=b1,i=w1,r=e.closestPointToSegment(I1,t,i);if(r<this.collider.radius){let e=this.collider.radius-r,s=i.sub(t).normalize();this.alignToGround&&this.groundTiltAdjustment(s),n.addScaledVector(s,e),I1.start.addScaledVector(s,e),I1.end.addScaledVector(s,e)}}}),this.onObject=Math.abs(n.y)>Math.abs(e*this.velocity.y*.25),this.onObject&&this.dispatchStopEvent("jump");let r=Math.max(0,n.length()-1e-5);n.normalize().multiplyScalar(r),this.position.add(n)}},N1=z1;N1.isLocked=!1;var j1=Cm(Tm());function U1(e){let t=e.elements,n=t[0]**2+t[1]**2+t[2]**2,i=t[4]**2+t[5]**2+t[6]**2,r=t[8]**2+t[9]**2+t[10]**2,s=t[0]**2+t[4]**2+t[8]**2,a=t[1]**2+t[5]**2+t[9]**2,o=t[2]**2+t[6]**2+t[10]**2,l=1e-8;return n<l||i<l||r<l||s<l||a<l||o<l}function V1(e,t){let n=new dx;if(t&&U1(t))return n.setAttribute("position",new rx([],3)),n.setIndex([]),n;if(!e.getAttribute("position"))return n.setAttribute("position",new rx([],3)),n.setIndex([]),n;let{positions:i,triIndices:r}=iV(e.getAttribute("position"),e.getIndex());return n.setAttribute("position",new rx(i,3)),n.setIndex(r),t&&n.applyMatrix4(t),n}var H1=new py,W1=new py,G1=[[0,0,0],[0,0,0],[0,0,0]];function q1(e){let t=e.elements;G1[0][0]=t[0],G1[0][1]=t[4],G1[0][2]=t[8],G1[1][0]=t[1],G1[1][1]=t[5],G1[1][2]=t[9],G1[2][0]=t[2],G1[2][1]=t[6],G1[2][2]=t[10];let{u:n,v:i}=(0,j1.SVD)(G1),r=H1.set(n[0][0],n[0][1],n[0][2],0,n[1][0],n[1][1],n[1][2],0,n[2][0],n[2][1],n[2][2],0,0,0,0,1),s=W1.set(i[0][0],i[0][1],i[0][2],0,i[1][0],i[1][1],i[1][2],0,i[2][0],i[2][1],i[2][2],0,0,0,0,1);return r.multiply(s.transpose())}var Y1=class extends fE{constructor(){super(),this.layers.enable(3),this.layers.enable(8),this.layers.enable(9)}setFromCamera(e,t){t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,-1).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):t.isPerspectiveCamera?(this.ray.origin.set(e.x,e.y,-1).unproject(t),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):console.error("Raycaster: Unsupported camera type.")}intersectVisibleObjects(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];return e.forEach((e=>{e.visible&&this.intersectObject(e,t,n)})),n}createRaycastLineHelper(){let e=new VD({color:65280,linewidth:10}),t=new Lv(this.ray.origin.x,this.ray.origin.y,this.ray.origin.z),n=new Lv(this.ray.direction.x,this.ray.direction.y,this.ray.direction.z),i=this.camera.far-this.camera.near,r=(new Lv).addVectors(t,n.multiplyScalar(i)),s=new dx;return s.setFromPoints([t,r]),new XD(s,e)}},X1=e=>e instanceof YY||e instanceof lZ;function Q1(e,t){return e.distance-t.distance}function K1(e,t,n){if(iN(t)&&t.visible){NY(t)&&t.raycast(e,n);for(let i of t.children)K1(e,i,n)}}function Z1(e,t,n){if(!(arguments.length>3&&void 0!==arguments[3]&&arguments[3])&&!n.some((t=>void 0!==e2(e,t))))return[];let i=[];return t.children.forEach((t=>K1(e,t,i))),i.sort(Q1),i}function J1(e){let t=[];if(e.length){let n=e[0].object;iN(n)&&t.push(n);let i=n.parent;for(;i;)X1(i)&&t.push(i),i=i.parent}return t}function $1(e,t,n,i){let r=e.frame;if(r){let e=t[0]*r.width,s=(1-t[1])*r.height;for(let t of n){let n=t===r.uuid?r:r.find(t);if(null!==n&&void 0!==n&&n.intersects(e,s))return i(n),!0}}return!1}function e2(e,t){if(NY(t)){if(t.visible){let n=[];return t.raycast(e,n),n.length?n[0]:void 0}}else if(X1(t))return t2(e,t)}function t2(e,t){if(iN(t)&&t.visible){if(NY(t)){let n=[];if(t.raycast(e,n),n.length)return n[0]}for(let n of t.children){let t=t2(e,n);if(t)return t}}}var n2=class{constructor(e,t,n,i,r,s,a,o){this.renderer=e,this.publish=t,this.scene=n,this.getCamera=i,this.sharedAssets=r,this.requestRender=s,this.isExport=a,this.frame=o,this.raycaster=new Y1,this._useWindowEvents=!1,this.pointerWorld={x:0,y:0},this.pointerScreen={x:0,y:0},this._useWindowEvents="window"===t.mouseEventTarget,this.domElement=e.domElement,this.eventElement=this._useWindowEvents?window:e.domElement,this._domRect=this.domElement.getBoundingClientRect()}get stopRaycast(){return this.publish.stopRaycast}get page(){return this.scene.activePage}set useWindowEvents(e){this._useWindowEvents=e,this.eventElement=e?window:this.renderer.domElement}get useWindowEvents(){return this._useWindowEvents}set domRect(e){this._domRect=e}get domRect(){return this._domRect}updateRaycaster(e){var t;let{pageX:n,pageY:i}=(null===(t=e.touches)||void 0===t?void 0:t.length)>0?e.touches[0]:e;this.pointerWorld=function(e,t,n){return{x:(e-(n.left+window.scrollX))/n.width*2-1,y:-(t-(n.top+window.scrollY))/n.height*2+1}}(n,i,this._domRect),this.pointerScreen=function(e,t,n){return{x:(e-(n.left+window.scrollX))/n.width,y:1-(t-(n.top+window.scrollY))/n.height}}(n,i,this._domRect),this.raycaster.setFromCamera(this.pointerWorld,this.getCamera())}},i2=class{constructor(e){this.eventContext=e,this.domEventsNeeded=new Set,this.hasVideoAction=!1}connect(){}disconnect(){}},r2=[["start","Start"],["keyDown","KeyDown"],["keyUp","KeyUp"],["mouseDown","MouseDown"],["mouseUp","MouseUp"],["mouseHover","MouseHover"],["collision","Collision"],["lookAt","LookAt"],["follow","Follow"],["scroll","Scroll"]],s2=e=>{var t;return null===(t=r2.find((t=>{let[n,i]=t;return i===e})))||void 0===t?void 0:t[0]},a2=e=>{var t;return null===(t=r2.find((t=>{let[n]=t;return n===e})))||void 0===t?void 0:t[1]},o2=(e,t)=>{let n=s2(e);if(n){let e=new CustomEvent(n,{bubbles:!0});return Object.defineProperty(e,"target",{writable:!1,value:t}),e}},l2=class extends i2{constructor(){super(...arguments),this.objectsPerEvents=new Map,this.splineEvents={},this.onBeginEvent=e=>{var t;if(!e.eventName||!e.target||"Scroll"===e.eventName)return;let n=null===(t=this.splineEvents[s2(e.eventName)])||void 0===t?void 0:t[e.target.uuid];if(!n)return;"Scroll"===e.eventName&&void 0!==e.deltaY&&Object.assign(n,{deltaY:e.deltaY});let{domElement:i}=this.eventContext;i.dispatchEvent(n)}}connect(){let{page:e}=this.eventContext;e.traverseEntity((e=>{var t;if(null!==(t=e.data)&&void 0!==t&&t.events.length)for(let[i,r]of r2)if(e.data.events.some((e=>e.data.type===r&&!e.data.disabled))){var n;this.objectsPerEvents.has(i)?null===(n=this.objectsPerEvents.get(i))||void 0===n||n.push(e):this.objectsPerEvents.set(i,[e]);let t={id:e.uuid,name:e.name},s=o2(r,t),a=this.splineEvents[i];a?a[e.uuid]=s:this.splineEvents[i]={[e.uuid]:s}}})),this.objectsPerEvents.forEach((e=>{e.forEach((e=>{e.addEventListener("beginEvent",this.onBeginEvent)}))}))}disconnect(){this.objectsPerEvents.forEach((e=>{e.forEach((e=>{e.removeEventListener("beginEvent",this.onBeginEvent)}))}))}},u2=class{constructor(e,t,n,i,r,s){if(this.id=e,this.data=t,this.object=n,this.entered=!1,("KeyDown"===t.type||"KeyUp"===t.type||"KeyPress"===t.type)&&!t.key)throw new Error("Missing property");this.actions=i1(t,t.actions,i,r,s,n)}disconnect(){r1(this.actions)}dispatchHeld(e){this.actions.Create.forEach((t=>{e&&t.dispatchThrottled.cancel(),t.dispatchThrottled()}))}dispatch(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.actions.Transition.forEach((e=>{e.object.currentTransitionEvent!==this&&(e.object.currentTransitionEvent=this,e.init())})),"MousePress"===this.data.type||"KeyPress"===this.data.type?this.entered||(this.entered=!0,this.actions.Transition.forEach((e=>e.playFromCurrent())),this.actions.Animation.forEach((e=>e.playFromCurrent())),this.actions.SwitchCamera.forEach((e=>e.playFromCurrent())),this.actions.Create.forEach((e=>e.dispatchStart()))):(this.actions.Transition.some((e=>e.playing&&"Toggle"!==e.data.runMode))||this.actions.Transition.forEach((e=>{"Toggle"===e.data.runMode?e.toggle():e.play()})),this.actions.SwitchCamera.some((e=>e.playing&&"Toggle"!==e.data.runMode))||this.actions.SwitchCamera.forEach((e=>{"Toggle"===e.data.runMode?e.toggle():e.play()})),this.actions.Animation.forEach((e=>{"Toggle"===e.data.runMode?e.toggle():e.play()}))),this.actions.Link.forEach((e=>{e.dispatch()})),this.actions.SceneTransition.forEach((e=>{e.dispatch()})),!1===e&&this.actions.Create.forEach((e=>{e.dispatch()})),this.actions.Destroy.forEach((e=>{e.dispatch()})),this.actions.Reset.forEach((e=>{e.dispatch()})),this.actions.Audio.forEach((e=>{e.dispatchBasic()})),this.actions.Video.forEach((e=>{e.dispatchBasic()})),this.actions.Particles.forEach((e=>{e.dispatchBasic()})),this.actions.SetVariable.forEach((e=>e.checkConditions())),this.actions.SetVariable.forEach((e=>e.dispatch())),this.actions.DynamicVariablePlay.forEach((e=>e.dispatch())),this.actions.ClearLocalStorage.forEach((e=>e.dispatch())),this.actions.UserAPI.forEach((e=>e.dispatch()))}dispatchRelease(){this.entered&&(this.entered=!1,this.actions.Transition.forEach((e=>e.reverseFromCurrent())),this.actions.Particles.forEach((e=>e.reverseFromCurrent())),this.actions.Animation.forEach((e=>e.reverseFromCurrent())),this.actions.SwitchCamera.forEach((e=>e.reverseFromCurrent())),this.actions.Create.forEach((e=>e.dispatchStop())))}dispatchUserEvent(e){this.actions.Transition.forEach((e=>{e.object.currentTransitionEvent!==this&&(e.object.currentTransitionEvent=this,e.init())})),e?(this.actions.Transition.forEach((e=>e.reverseFromCurrent())),this.actions.Animation.forEach((e=>e.reverseFromCurrent())),this.actions.SwitchCamera.forEach((e=>e.reverseFromCurrent()))):(this.actions.Transition.forEach((e=>e.playFromCurrent())),this.actions.Animation.forEach((e=>e.playFromCurrent())),this.actions.SwitchCamera.forEach((e=>e.playFromCurrent()))),this.actions.Link.forEach((e=>{e.dispatch()})),this.actions.SceneTransition.forEach((e=>{e.dispatch()})),this.actions.Create.forEach((e=>{e.dispatch()})),this.actions.Destroy.forEach((e=>{e.dispatch()})),this.actions.Reset.forEach((e=>{e.dispatch()})),this.actions.Audio.forEach((e=>{e.dispatchBasic()})),this.actions.Video.forEach((e=>{e.dispatchBasic()})),this.actions.Particles.forEach((e=>{e.dispatchBasic()})),this.actions.SetVariable.forEach((e=>e.checkConditions())),this.actions.SetVariable.forEach((e=>e.dispatch())),this.actions.DynamicVariablePlay.forEach((e=>e.dispatch())),this.actions.ClearLocalStorage.forEach((e=>e.dispatch())),this.actions.UserAPI.forEach((e=>e.dispatch()))}},c2=class extends i2{constructor(e,t,n){super(e),this.eventManager=t,this.useForRaycastProperty=n,this.objectsPerTypes={MouseDown:[],MouseUp:[],MousePress:[],KeyDown:[],KeyUp:[],KeyPress:[]},this.canvasMouseEvents=[],this.eventsPerObjects={MouseDown:{},MouseUp:{},MousePress:{},KeyDown:{},KeyUp:{},KeyPress:{}},this.heldKeys={},this.heldKeysPress={},this._prevObjects=[],this.sceneInterects=null,this.onCanvasRaycast=e=>{if(!0===this.useForRaycastProperty&&null===this.sceneInterects){this.eventContext.updateRaycaster(e);let{raycaster:t,page:n}=this.eventContext,i=Z1(t,n,[],!0);this.sceneInterects=i,i.length&&(this.eventContext.sharedAssets.raycastProperty={x:i[0].point.x,y:i[0].point.y,z:i[0].point.z,objX:i[0].object.matrixWorld.elements[12],objY:i[0].object.matrixWorld.elements[13],objZ:i[0].object.matrixWorld.elements[14]})}},this.onCanvasMouseDown=e=>{(e.target===this.eventContext.domElement||"SPLINE-VIEWER"===e.target.tagName)&&this.canvasMouseEvents.forEach((t=>{("MouseDown"===t.data.type||"MousePress"===t.data.type)&&(this.onCanvasRaycast(e),t.dispatch())}))},this.onCanvasMouseUp=e=>{(e.target===this.eventContext.domElement||"SPLINE-VIEWER"===e.target.tagName)&&this.canvasMouseEvents.forEach((t=>{"MouseUp"===t.data.type?(this.onCanvasRaycast(e),t.dispatch()):"MousePress"===t.data.type&&t.dispatchRelease()}))},this.onMouseDown=e=>{FF.length>1||(this.eventContext.updateRaycaster(e),this.handleMouseEvent("MouseDown"))},this.onMouseUp=e=>{FF.length>1||(this.eventContext.updateRaycaster(e),this.handleMouseEvent("MouseUp"))},this.onMousePressDown=e=>{FF.length>1||(this.eventContext.updateRaycaster(e),this.handleMousePressEvent())},this.onMousePressRelease=e=>{FF.length>1||(this.eventContext.updateRaycaster(e),this.handleMousePressEvent(!0))},this.onKeyDown=e=>{this.heldKeys[e.key]||(this.handleKeyEvent(e,"KeyDown"),this.handleKeyEventHeld(e,"KeyDown",!0)),this.heldKeys[e.key]=!0},this.onKeyUp=e=>{this.handleKeyEvent(e,"KeyUp"),this.handleKeyEventHeld(e,"KeyUp",!0)},this.onKeyPressDown=e=>{this.heldKeysPress[e.key]?this.handleKeyEventHeld(e,"KeyPress"):(this.handleKeyEvent(e,"KeyPress"),this.handleKeyEventHeld(e,"KeyPress",!0)),this.heldKeysPress[e.key]=!0},this.onKeyPressUp=e=>{this.handleKeyEvent(e,"KeyPress",!0)},this.releaseHeldKey=e=>{delete this.heldKeys[e.key]},this.releaseHeldKeyPress=e=>{delete this.heldKeysPress[e.key]},this._onUserEvent=e=>{var t,n;let{eventName:i,target:r,reverse:s}=e;if(!i||!r)return;let a=a2(i);a&&("MouseDown"===a||"MouseUp"===a||"MousePress"===a?(r.dispatchEvent({type:"beginEvent",eventName:a}),null===(t=this.eventsPerObjects[a])||void 0===t||null===(t=t[r.uuid])||void 0===t||t.forEach((e=>{e.dispatchUserEvent(s)}))):("KeyDown"===a||"KeyUp"===a||"KeyPress"===a)&&(r.dispatchEvent({type:"beginEvent",eventName:a}),null===(n=this.eventsPerObjects[a])||void 0===n||null===(n=n[r.uuid])||void 0===n||n.forEach((e=>{e.dispatchUserEvent()}))))}}connect(){var e,t,n,i,r,s;let{page:a,sharedAssets:o,domElement:l}=this.eventContext,u=(e,t)=>{var n;if(null===(n=e.data)||void 0===n||!n.events.length)return;let i=["MouseDown","MouseUp","MousePress","KeyDown","KeyUp","KeyPress"];for(let s of i){var r;let n=this.eventsPerObjects[s];if(e.data.events.filter((e=>{let{data:t}=e;return t.type===s&&!0!==t.disabled})).forEach((t=>{let{id:i,data:r}=t;try{let t=new u2(i,r,e,a,o,this.eventManager);t.actions.Video.length&&(this.hasVideoAction=!0),"MouseDown"!==r.type&&"MouseUp"!==r.type&&"MousePress"!==r.type||"Canvas"!==r.mode&&"Window"!==r.mode?(n[e.uuid]?n[e.uuid].some((e=>e.id===t.id))||n[e.uuid].push(t):n[e.uuid]=[t],e instanceof LZ&&e.traverseChildren((e=>{var i;if(!e.visible)return!0;e instanceof Sq&&2!==(null===(i=e.data.geometry.shapeBlendNode)||void 0===i?void 0:i.operation)&&(n[e.uuid]?n[e.uuid].push(t):n[e.uuid]=[t])}))):this.canvasMouseEvents.push(t)}catch(s){}})),null!==(r=n[e.uuid])&&void 0!==r&&r.length&&(this.objectsPerTypes[s].push(e instanceof lK&&("MouseDown"===s||"MouseUp"===s||"MousePress"===s)?t:e),e instanceof LZ)){let t=this.objectsPerTypes[s];e.traverseChildren((e=>{if(!e.visible)return!0;e instanceof Sq&&-1===t.indexOf(e)&&t.push(e)}))}}};a.traverseEntity((e=>{var t;(e instanceof pZ||e instanceof iZ)&&null!==(t=e.frame)&&void 0!==t&&t.traverse((t=>{u(t,e)})),u(e)})),this.heldKeys={},this.heldKeysPress={},this.domEventsNeeded.clear(),l.addEventListener("pointerdown",this.onCanvasMouseDown),l.addEventListener("pointerup",this.onCanvasMouseUp),(null!==(e=this.objectsPerTypes.MouseDown)&&void 0!==e&&e.length||this.useForRaycastProperty)&&(this.domEventsNeeded.add("pointerdown"),l.addEventListener("pointerdown",this.onMouseDown)),null!==(t=this.objectsPerTypes.MouseUp)&&void 0!==t&&t.length&&(this.domEventsNeeded.add("pointerup"),l.addEventListener("pointerup",this.onMouseUp)),null!==(n=this.objectsPerTypes.MousePress)&&void 0!==n&&n.length&&(this.domEventsNeeded.add("pointerdown"),l.addEventListener("pointerdown",this.onMousePressDown),this.domEventsNeeded.add("pointerup"),l.addEventListener("pointerup",this.onMousePressRelease)),null!==(i=this.objectsPerTypes.KeyDown)&&void 0!==i&&i.length&&(this.domEventsNeeded.add("keydown"),document.addEventListener("keydown",this.onKeyDown),document.addEventListener("keyup",this.releaseHeldKey)),null!==(r=this.objectsPerTypes.KeyUp)&&void 0!==r&&r.length&&(this.domEventsNeeded.add("keyup"),document.addEventListener("keyup",this.onKeyUp)),null!==(s=this.objectsPerTypes.KeyPress)&&void 0!==s&&s.length&&(this.domEventsNeeded.add("keydown"),document.addEventListener("keydown",this.onKeyPressDown),document.addEventListener("keyup",this.releaseHeldKeyPress),this.domEventsNeeded.add("keyup"),document.addEventListener("keyup",this.onKeyPressUp)),Object.entries(this.objectsPerTypes).forEach((e=>{let[t,n]=e;n.forEach((e=>{e.addEventListener("userEvent",this._onUserEvent)}))}))}disconnect(){let{domElement:e}=this.eventContext;this.domEventsNeeded.clear(),this.heldKeys={},this.heldKeysPress={},e.removeEventListener("pointerdown",this.onCanvasMouseDown),e.removeEventListener("pointerup",this.onCanvasMouseUp),e.removeEventListener("pointerdown",this.onMouseDown),e.removeEventListener("pointerdown",this.onMousePressDown),e.removeEventListener("pointerup",this.onMouseUp),e.removeEventListener("pointerup",this.onMousePressRelease),document.removeEventListener("keydown",this.onKeyDown),document.removeEventListener("keyup",this.onKeyUp),document.removeEventListener("keydown",this.onKeyPressDown),document.removeEventListener("keyup",this.onKeyPressUp),document.removeEventListener("keyup",this.releaseHeldKey),Object.values(this.eventsPerObjects).forEach((e=>{Object.values(e).forEach((e=>{e.forEach((e=>{e.disconnect()}))}))})),this.canvasMouseEvents.forEach((e=>{e.disconnect()})),Object.entries(this.objectsPerTypes).forEach((e=>{let[t,n]=e;n.forEach((e=>{e.removeEventListener("userEvent",this._onUserEvent)}))}))}handleMouseEvent(e){let{stopRaycast:t,raycaster:n,page:i,pointerScreen:r}=this.eventContext,s=this.objectsPerTypes[e],a=s.filter((e=>!(e instanceof lK)));if((s.length||this.useForRaycastProperty)&&(!i.uiCanvas||!$1(i,[r.x,r.y],Object.keys(this.eventsPerObjects[e]),(t=>{this.handleObjectMouseEventDispatch(t,e)})))){if(t||this.useForRaycastProperty){let r;if(null===this.sceneInterects?r=Z1(n,i,a,this.useForRaycastProperty):(r=this.sceneInterects,this.sceneInterects=null),this.useForRaycastProperty&&r.length&&(this.eventContext.sharedAssets.raycastProperty={x:r[0].point.x,y:r[0].point.y,z:r[0].point.z,objX:r[0].object.matrixWorld.elements[12],objY:r[0].object.matrixWorld.elements[13],objZ:r[0].object.matrixWorld.elements[14]}),t){var o,l,u,c;let t=[null!==(o=null===(l=r[0])||void 0===l||null===(l=l.uv)||void 0===l?void 0:l.x)&&void 0!==o?o:0,null!==(u=null===(c=r[0])||void 0===c||null===(c=c.uv)||void 0===c?void 0:c.y)&&void 0!==u?u:0];J1(r).forEach((n=>{n instanceof pZ&&$1(n,t,Object.keys(this.eventsPerObjects[e]),(t=>{this.handleObjectMouseEventDispatch(t,e)})),this.eventsPerObjects[e][n.uuid]&&this.handleObjectMouseEventDispatch(n,e)}))}}t||a.forEach((t=>{var i,r,s,a;let o=e2(n,t);o&&(this.handleObjectMouseEventDispatch(t,e),t instanceof pZ&&$1(t,[null!==(i=null===o||void 0===o||null===(r=o.uv)||void 0===r?void 0:r.x)&&void 0!==i?i:0,null!==(s=null===o||void 0===o||null===(a=o.uv)||void 0===a?void 0:a.y)&&void 0!==s?s:0],Object.keys(this.eventsPerObjects[e]),(t=>{this.handleObjectMouseEventDispatch(t,e)})))}))}}handleMousePressEvent(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t="MousePress",n=this.objectsPerTypes[t],i=n.filter((e=>!(e instanceof lK))),r=[];if(n.length){if(!e){let{stopRaycast:e,raycaster:n,page:s,pointerScreen:a}=this.eventContext,o=!1;if(s.uiCanvas&&(o=$1(s,[a.x,a.y],Object.keys(this.eventsPerObjects[t]),(e=>{r.push(e)}))),e&&!o){let e=Z1(n,s,i);r=J1(e),e.forEach((e=>{var n,i,s,a;e.object instanceof pZ&&$1(e.object,[null!==(n=null===e||void 0===e||null===(i=e.uv)||void 0===i?void 0:i.x)&&void 0!==n?n:0,null!==(s=null===e||void 0===e||null===(a=e.uv)||void 0===a?void 0:a.y)&&void 0!==s?s:0],Object.keys(this.eventsPerObjects[t]),(e=>{r.push(e)}))}))}else i.forEach((e=>{var i,s,a,o;let l=e2(n,e);l&&(r.push(e),e instanceof pZ&&$1(e,[null!==(i=null===l||void 0===l||null===(s=l.uv)||void 0===s?void 0:s.x)&&void 0!==i?i:0,null!==(a=null===l||void 0===l||null===(o=l.uv)||void 0===o?void 0:o.y)&&void 0!==a?a:0],Object.keys(this.eventsPerObjects[t]),(e=>{r.push(e)})))}))}this._prevObjects.length&&this._prevObjects.forEach((e=>{r.includes(e)||this.handleObjectMouseEventDispatchRelease(e,t)})),r.length&&r.forEach((e=>{this.handleObjectMouseEventDispatch(e,t)})),this._prevObjects=r}}handleObjectMouseEventDispatch(e,t){var n;e.dispatchEvent({type:"beginEvent",eventName:t}),null===(n=this.eventsPerObjects[t])||void 0===n||null===(n=n[e.uuid])||void 0===n||n.forEach((e=>{e.dispatch()}))}handleObjectMouseEventDispatchRelease(e,t){var n;e.dispatchEvent({type:"beginEvent",eventName:t}),null===(n=this.eventsPerObjects[t])||void 0===n||null===(n=n[e.uuid])||void 0===n||n.forEach((e=>{e.dispatchRelease()}))}handleKeyEvent(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.objectsPerTypes[t].forEach((i=>{let r=this.eventsPerObjects[t][i.uuid];r.some((t=>{let{data:n}=t;return"key"in n&&n.key===e.key}))&&i.dispatchEvent({type:"beginEvent",eventName:t}),r.forEach((t=>{"key"in t.data&&t.data.key===e.key&&(n?t.dispatchRelease():t.dispatch(!0))}))}))}handleKeyEventHeld(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.objectsPerTypes[t].forEach((i=>{this.eventsPerObjects[t][i.uuid].forEach((t=>{"key"in t.data&&t.data.key===e.key&&t.dispatchHeld(n)}))}))}},h2=new Lv,d2=new Lv,p2=class{constructor(e,t,n,i,r){this.actionsIn=i1(e,e.inActions,n,i,r,t),this.actionsOut=i1(e,e.outActions,n,i,r,t)}disconnect(){r1(this.actionsIn),r1(this.actionsOut)}},f2=class extends p2{constructor(e,t,n,i,r,s){super(t,n,i,r,s),this.id=e,this.data=t,this.object=n,this.stage="out",this.objects=[],this.onUpdateMatrixWorld=()=>{for(let i of this.objects)if(!i.visible)return;let e=h2.setFromMatrixPosition(this.objects[0].matrixWorld),t=d2.setFromMatrixPosition(this.objects[1].matrixWorld),n=e.distanceTo(t)<=this.distance?"in":"out";if(this.stage!==n){this.stage=n;let e="in"===n?this.actionsIn:this.actionsOut;e.Audio.forEach((e=>e.dispatchConditional())),e.Particles.forEach((e=>e.dispatchConditional())),e.Video.forEach((e=>e.dispatchConditional())),e.Link.forEach((e=>e.dispatch())),e.Create.forEach((e=>e.dispatch())),e.Destroy.forEach((e=>e.dispatch())),e.Reset.forEach((e=>e.dispatch())),e.Transition.forEach((e=>{e.object.currentTransitionEvent!==this&&(e.object.currentTransitionEvent=this),e.init()})),e.Transition.forEach((e=>e.play())),e.Animation.forEach((e=>e.play())),e.SwitchCamera.forEach((e=>e.play())),e.SceneTransition.forEach((e=>e.dispatch())),e.SetVariable.forEach((e=>e.checkConditions())),e.SetVariable.forEach((e=>e.dispatch())),e.DynamicVariablePlay.forEach((e=>e.dispatch())),e.ClearLocalStorage.forEach((e=>e.dispatch())),e.UserAPI.forEach((e=>e.dispatch()))}};let{distance:a,fromObject:o,toObject:l}=t.condition;this.distance=a;for(let u of[o,l]){if(!u)throw new Error("Missing property");let e=i.find(u);if(!e)throw new Error("Missing property");this.objects.push(e)}}connect(){window.setTimeout((()=>{this.objects.forEach((e=>{e.addEventListener("updateMatrixWorld",this.onUpdateMatrixWorld)})),this.onUpdateMatrixWorld()}),0)}disconnect(){super.disconnect(),this.stage="out",this.objects.forEach((e=>{e.removeEventListener("updateMatrixWorld",this.onUpdateMatrixWorld)}))}},m2=class extends p2{constructor(e,t,n,i,r,s){var a,o;super(t,n,i,r,s),this.id=e,this.data=t,this.object=n,this.onBegin=e=>{let{target:t,state:n}=e;this.toState!==n&&(this.actionsOut.Audio.forEach((e=>e.dispatchConditional())),this.actionsOut.Particles.forEach((e=>e.dispatchConditional())),this.actionsOut.Video.forEach((e=>e.dispatchConditional())),this.actionsOut.Link.forEach((e=>e.dispatch())),this.actionsOut.Create.forEach((e=>e.dispatch())),this.actionsOut.Destroy.forEach((e=>e.dispatch())),this.actionsOut.Reset.forEach((e=>e.dispatch())),this.actionsIn.Transition.forEach((e=>e.pause())),this.object.currentTransitionEvent=this,this.actionsOut.Transition.forEach((e=>e.play())),this.actionsOut.Animation.forEach((e=>e.play())),this.actionsIn.SwitchCamera.forEach((e=>e.pause())),this.actionsOut.SwitchCamera.forEach((e=>e.play())),this.actionsOut.SceneTransition.forEach((e=>e.dispatch())),this.actionsOut.SetVariable.forEach((e=>e.checkConditions())),this.actionsOut.SetVariable.forEach((e=>e.dispatch())),this.actionsOut.DynamicVariablePlay.forEach((e=>e.dispatch())),this.actionsOut.ClearLocalStorage.forEach((e=>e.dispatch())),this.actionsOut.UserAPI.forEach((e=>e.dispatch())))},this.onComplete=e=>{let{target:t,state:n}=e;this.toState===n&&(this.actionsIn.Audio.forEach((e=>e.dispatchConditional())),this.actionsIn.Particles.forEach((e=>e.dispatchConditional())),this.actionsIn.Video.forEach((e=>e.dispatchConditional())),this.actionsIn.Link.forEach((e=>e.dispatch())),this.actionsIn.Create.forEach((e=>e.dispatch())),this.actionsIn.Destroy.forEach((e=>e.dispatch())),this.actionsIn.Reset.forEach((e=>e.dispatch())),this.actionsOut.Transition.forEach((e=>e.pause())),this.actionsOut.Transition.forEach((e=>e.pause())),this.object.currentTransitionEvent=this,this.actionsIn.Transition.forEach((e=>e.play())),this.actionsIn.Animation.forEach((e=>e.play())),this.actionsOut.SwitchCamera.forEach((e=>e.pause())),this.actionsIn.SwitchCamera.forEach((e=>e.play())),this.actionsIn.SceneTransition.forEach((e=>e.dispatch())),this.actionsIn.SetVariable.forEach((e=>e.checkConditions())),this.actionsIn.SetVariable.forEach((e=>e.dispatch())),this.actionsIn.DynamicVariablePlay.forEach((e=>e.dispatch())),this.actionsOut.ClearLocalStorage.forEach((e=>e.dispatch())),this.actionsOut.UserAPI.forEach((e=>e.dispatch())))};let{condition:l}=t;if(!l.object)throw new Error("Missing property");let u=null!==(a=i.find(l.object))&&void 0!==a?a:i.scene.find2D(l.object);if(!u)throw new Error("Missing property");if(this.toObject=u,l.state&&(null===(o=this.toObject.states)||void 0===o||!o[l.state]))throw new Error("Missing property");this.toState=l.state}connect(){mM(this.actionsOut).forEach((e=>{var t;(null===(t=this.actionsOut[e])||void 0===t?void 0:t.length)&&this.toObject.addEventListener("beginState",this.onBegin)})),mM(this.actionsIn).forEach((e=>{var t;(null===(t=this.actionsIn[e])||void 0===t?void 0:t.length)&&this.toObject.addEventListener("completeState",this.onComplete)}))}disconnect(){super.disconnect(),mM(this.actionsOut).forEach((e=>{var t;(null===(t=this.actionsIn[e])||void 0===t?void 0:t.length)&&this.toObject.removeEventListener("beginState",this.onBegin)})),mM(this.actionsIn).forEach((e=>{var t;(null===(t=this.actionsIn[e])||void 0===t?void 0:t.length)&&this.toObject.removeEventListener("completeState",this.onComplete)}))}},g2=class extends i2{constructor(e,t){super(e),this.eventManager=t,this.eventsPerConditions={Comparison:[],Distance:[],State:[]},this.hasVideoAction=!1}connect(){super.connect();let{page:e,sharedAssets:t}=this.eventContext;e.traverseEntity((n=>{var i;if(null!==(i=n.data)&&void 0!==i&&i.events.length)for(let{id:r,data:s}of n.data.events)if(!s.disabled&&"Conditional"===s.type)try{let i;"Comparison"===s.condition.type||("Distance"===s.condition.type?i=new f2(r,s,n,e,t,this.eventManager):"State"===s.condition.type&&(i=new m2(r,s,n,e,t,this.eventManager))),i&&(this.eventsPerConditions[s.condition.type].push(i),(i.actionsIn.Video.length||i.actionsOut.Video.length)&&(this.hasVideoAction=!0))}catch(wi){}})),Object.values(this.eventsPerConditions).forEach((e=>e.forEach((e=>e.connect()))))}disconnect(){super.disconnect(),Object.values(this.eventsPerConditions).forEach((e=>e.forEach((e=>e.disconnect()))))}},v2=new Lv,y2=new Lv,x2=new Lv,b2=new Hx,w2=new Lv,D2=new Lv,_2=new Lv,S2=new Rv,E2=new _y,C2=new py,A2=new uv,M2=new Lv,T2=new Lv,P2=.2;function F2(e,t){!t||(t[0]<t[1]&&(e.x=Math.min(Math.max(e.x,t[0]),t[1])),t[2]<t[3]&&(e.y=Math.min(Math.max(e.y,t[2]),t[3])),t[4]<t[5]&&(e.z=Math.min(Math.max(e.z,t[4]),t[5])))}var O2=function(){let e=new py;return(t,n,i)=>{let r=t.obj;e.copy(r.hiddenMatrix),null!==r.parent&&e.premultiply(r.parent.matrixWorld),e.invert(),r.position.copy(n),"global"===t.reference&&F2(r.position,t.limits),r.position.applyMatrix4(e),"parent"===t.reference?F2(r.position,t.limits):"local"===t.reference&&(S2.copy(t.quat0).invert(),r.position.sub(t.position0),r.position.applyQuaternion(S2),F2(r.position,t.limits),S2.invert(),r.position.applyQuaternion(S2),r.position.add(t.position0)),e.multiply(null!==i&&void 0!==i?i:r.matrixWorld).decompose(w2,r.quaternion,D2),r.updateMatrix(),r.hasNonUniformScale&&(r.updateMatrixWorld(),r.updateMatrixWorldSVD()),r instanceof FV&&jY(r.parent)&&r.invalidateDownstreamBooleanData(!0)}}(),I2=class{constructor(e,t,n,i,r,s,a){this.object=e,this.id=t,this.data=n,this.dropDestIds=[],this.activeIdx=null,this.wasDragEventTriggered=!1,this.resetDampingFactor=0===this.data.resetSpeed?1:8/this.data.resetSpeed+1,this.snapDampingFactor=0===this.data.snapSpeed?1:8/this.data.snapSpeed+1,this.actionsDrag=i1(n,n.dragDropActions.drag,i,r,s,this.object),this.actionsDrop=i1(n,n.dragDropActions.drop,i,r,s,this.object);let o=[];this.data.objects.forEach((e=>{let t=i.find(e);!t||!1!==t.data.visible&&(o.push(t),a[t.uuid]&&a[t.uuid].forEach((e=>{let t=i.find(e);!t||!1!==t.data.visible&&o.push(t)})))})),this.data.dropDestinations.forEach((e=>{let t=i.find(e);!t||!1!==t.data.visible&&(this.dropDestIds.push(t.uuid),a[t.uuid]&&a[t.uuid].forEach((e=>{let t=i.find(e);!t||!1!==t.data.visible&&this.dropDestIds.push(t.uuid)})))})),this.dragItems=o.map((e=>("locked"===this.data.planeMode&&(e.userData.lockedPlane=!0),e.userData.worldPosition0=(new Lv).setFromMatrixPosition(e.matrixWorld),{obj:e,fromPosition:(new Lv).setFromMatrixPosition(e.matrixWorld),pointStart:new Lv,pointEnd:new Lv,paused:!0,currentDampingFactor:this.data.dampingFactor,reset:!1,position0:(new Lv).copy(e.position),quat0:(new Rv).copy(e.quaternion),snapped:!1,orientationMatrix:new py,limits:this.data.limits,reference:this.data.referenceFrame})))}get activeDragItem(){return null!==this.activeIdx?this.dragItems[this.activeIdx]:null}dispose(){r1(this.actionsDrag),r1(this.actionsDrop),this.dragItems.forEach((e=>{e.fromPosition.copy(e.obj.userData.worldPosition0),e.pointStart.copy(e.fromPosition),e.pointEnd.copy(e.pointStart),e.obj.recursiveBBoxNeedsUpdate=!0,e.obj.userData.lockedPlane=void 0,e.obj.position.copy(e.position0),e.obj.quaternion.copy(e.quat0),e.obj.updateMatrix()}))}},k2=class extends i2{constructor(e,t){super(e),this.eventManager=t,this.events=[],this.lastDropDestination=null,this.dragTimeout=null,this.onPointerDown=e=>{if(FF.length>1)return;this.eventContext.updateRaycaster(e);let{raycaster:t,page:n}=this.eventContext,i=n.raycastWithClones(t);if(this.lastDropDestination=null,0!==i.length){for(let e of this.events){let t=0;for(let{obj:n,pointEnd:s,pointStart:a}of e.dragItems){if(n===i[0].object||n===i[0].object.object||Nz.is(n)&&n.isAncestorOf(i[0].object.uuid)){var r;if(e.activeIdx=t,e.activeDragItem.reset=!1,e.activeDragItem.currentDampingFactor=e.data.dampingFactor,e.activeDragItem.snapped=!1,"hand"===e.data.cursor&&this.setCursor("grabbing"),this.eventManager.controlsManager.usePhysics){e.activeDragItem.obj.rigidBody&&e.activeDragItem.obj.rigidBody.setBodyType(2,!0);let t=e.activeDragItem.obj;n.hasNonUniformScale&&n.updateMatrixWorldSVD(),(t.hasNonUniformScale?t.matrixWorldRigid:t.matrixWorld).decompose(w2,S2,D2),E2.setFromQuaternion(S2),void 0===t.prevR?(t.prevR=E2.clone(),t.prevT=w2.clone()):(t.prevR.copy(E2),t.prevT.copy(w2)),this.eventManager.controlsManager.sharedGameControlGlobals.entitiesWithTransformAnim.push(e.activeDragItem.obj)}return this.calcPlaneIntersectPos(n,a,e.data.plane,e.data.referenceFrame),s.copy(a),(this.eventManager.controlsManager.usePhysics&&"dynamic"===(null===(r=n.data.physics)||void 0===r?void 0:r.rigidBody)||!1===e.data.drop||!1===e.data.resetOnSnapFail)&&e.activeDragItem.fromPosition.setFromMatrixPosition(e.activeDragItem.obj.matrixWorld),this.activeEvent=e,void(this.eventManager.controlsManager.orbitControls&&(this.eventManager.controlsManager.orbitControls.enabled=!1))}t++}}this.activeEvent=null}else this.activeEvent=null},this.onPointerMove=e=>{if(FF.length>1)return;this.eventContext.updateRaycaster(e);let{raycaster:t,page:n}=this.eventContext,i=n.raycastWithClones(t);if(0!==FF.length){if(this.activeEvent&&this.activeEvent.activeDragItem){let e,t=this.activeEvent.activeDragItem;if(t.snapped=!1,this.activeEvent.data.drop&&(e=i.filter((e=>t.obj!==e.object&&!t.obj.isAncestorOf(e.object.uuid)&&!(e.object instanceof YY)&&("all"===this.activeEvent.data.dropOn||this.activeEvent.dropDestIds.some((t=>t===e.object.uuid||n.scene.find(t).isAncestorOf(e.object.uuid))))))[0]),e){let n=_2.copy(e.face.normal).applyMatrix3(A2.getNormalMatrix(e.object.matrixWorld));if("center"===this.activeEvent.data.snapTo)t.fromPosition.setFromMatrixPosition(e.object.matrixWorld);else if("surface"===this.activeEvent.data.snapTo){if(t.fromPosition.copy(e.point),"bbox"===this.activeEvent.data.snapSurfaceMode){w2.copy(n).applyMatrix3(A2.setFromMatrix4(t.obj.matrixWorld).transpose());let e=t.obj;w2.x>P2?D2.x=-e.recursiveBBox.min.x:w2.x<-P2&&(D2.x=-e.recursiveBBox.max.x),w2.y>P2?D2.y=-e.recursiveBBox.min.y:w2.y<-P2&&(D2.y=-e.recursiveBBox.max.y),w2.z>P2?D2.z=-e.recursiveBBox.min.z:w2.z<-P2&&(D2.z=-e.recursiveBBox.max.z),D2.applyMatrix3(A2.invert())}else D2.copy(n).multiplyScalar(this.activeEvent.data.snapSurfaceOffset);t.fromPosition.add(D2)}this.activeEvent.data.autoOrient&&(w2.set(0,1,0).cross(n),w2.length()<1e-4&&w2.set(-1,0,0).cross(n),D2.crossVectors(_2,w2),t.orientationMatrix.makeBasis(w2,D2,n)),t.pointStart.copy(t.fromPosition),t.pointEnd.copy(t.pointStart),t.currentDampingFactor=this.activeEvent.snapDampingFactor,t.snapped=!0,this.lastDropDestination!==e.object&&(this.lastDropDestination=e.object,this.activeEvent.actionsDrop.Transition.forEach((e=>{e.play()})),this.activeEvent.actionsDrop.Animation.forEach((e=>{e.play()})),this.activeEvent.actionsDrop.Audio.forEach((e=>{e.dispatchGameControl("start")})),this.activeEvent.actionsDrop.Particles.forEach((e=>{e.dispatchGameControl("start")})),this.activeEvent.actionsDrop.Create.forEach((e=>{e.dispatchThrottled()})))}else t.orientationMatrix.makeRotationFromQuaternion(t.quat0),this.lastDropDestination=null,t.currentDampingFactor=this.activeEvent.data.dampingFactor,this.calcPlaneIntersectPos(t.obj,t.pointEnd,this.activeEvent.data.plane,this.activeEvent.data.referenceFrame),this.activeEvent.actionsDrop.Transition.forEach((e=>{e.stop(),null!==e.object.currentState&&e.object.changeSelectedState(null,{scene:this.eventContext.page.scene,shared:this.eventContext.sharedAssets})})),this.activeEvent.actionsDrop.Animation.forEach((e=>{e.stop()})),this.activeEvent.actionsDrop.Audio.forEach((e=>{e.dispatchGameControl("stop")})),this.activeEvent.actionsDrop.Particles.forEach((e=>{e.dispatchGameControl("stop")}));this.activeEvent.actionsDrag.Create.forEach((e=>{e.dispatchThrottled()})),this.activeEvent.actionsDrag.SetVariable.forEach((e=>e.checkConditions())),this.activeEvent.actionsDrag.SetVariable.forEach((e=>e.dispatch())),this.activeEvent.actionsDrag.DynamicVariablePlay.forEach((e=>e.dispatch())),this.activeEvent.actionsDrag.ClearLocalStorage.forEach((e=>e.dispatch())),this.activeEvent.actionsDrag.UserAPI.forEach((e=>e.dispatch())),!1===this.activeEvent.wasDragEventTriggered&&(this.activeEvent.wasDragEventTriggered=!0,this.activeEvent.actionsDrag.Transition.forEach((e=>{e.play()})),this.activeEvent.actionsDrag.Animation.forEach((e=>{e.play()})),this.activeEvent.actionsDrag.Audio.forEach((e=>{e.dispatchGameControl("start")})),this.activeEvent.actionsDrag.Particles.forEach((e=>{e.dispatchGameControl("start")}))),this.dragTimeout&&window.clearTimeout(this.dragTimeout),this.dragTimeout=window.setTimeout((()=>{!this.activeEvent||(this.activeEvent.wasDragEventTriggered=!1,this.activeEvent.actionsDrag.Audio.forEach((e=>{e.dispatchGameControl("stop")})),this.activeEvent.actionsDrag.Particles.forEach((e=>{e.dispatchGameControl("stop")})),this.activeEvent.actionsDrag.Transition.forEach((e=>{e.stop(),null!==e.object.currentState&&e.object.changeSelectedState(null,{scene:this.eventContext.page.scene,shared:this.eventContext.sharedAssets})})),this.activeEvent.actionsDrag.Animation.forEach((e=>{e.stop()})))}),500),this.updateDragItem(t),t.obj.dispatchEvent({type:"requestRender"})}}else{let e=!1;for(let t of this.events){for(let{obj:n}of t.dragItems){var r,s,a;if(n===(null===(r=i[0])||void 0===r?void 0:r.object)||n===(null===(s=i[0])||void 0===s||null===(s=s.object)||void 0===s?void 0:s.object)||Nz.is(n)&&n.isAncestorOf(null===(a=i[0])||void 0===a?void 0:a.object.uuid)){switch(e=!0,t.data.cursor){case"hand":this.setCursor("grab");break;case"move":this.setCursor("move")}break}}if(e)break}e||this.setCursor("default")}},this.onPointerUp=e=>{if(this.activeEvent&&this.activeEvent.activeDragItem){var t;"hand"===this.activeEvent.data.cursor&&this.setCursor("grab");let e="dynamic"===(null===(t=this.activeEvent.activeDragItem.obj.data.physics)||void 0===t?void 0:t.rigidBody);!1===this.activeEvent.activeDragItem.snapped&&this.activeEvent.data.drop&&this.activeEvent.data.resetOnSnapFail&&(!1===this.eventManager.controlsManager.usePhysics||!e)&&(this.activeEvent.activeDragItem.reset=this.activeEvent.data.resetOnSnapFail,this.activeEvent.activeDragItem.paused=!1,this.activeEvent.activeDragItem.currentDampingFactor=this.activeEvent.resetDampingFactor),this.eventManager.controlsManager.usePhysics&&e&&(this.eventManager.controlsManager.sharedGameControlGlobals.entitiesWithTransformAnim.pop(),this.activeEvent.activeDragItem.obj.rigidBody.setBodyType(0,!0),this.activeEvent.activeDragItem.paused=!0),!0===this.activeEvent.wasDragEventTriggered&&(this.activeEvent.wasDragEventTriggered=!1,this.activeEvent.actionsDrag.Transition.forEach((e=>{e.stop(),null!==e.object.currentState&&e.object.changeSelectedState(null,{scene:this.eventContext.page.scene,shared:this.eventContext.sharedAssets})})),this.activeEvent.actionsDrag.Animation.forEach((e=>{e.stop()})),this.activeEvent.actionsDrag.Audio.forEach((e=>{e.dispatchGameControl("stop")})),this.activeEvent.actionsDrag.Particles.forEach((e=>{e.dispatchGameControl("stop")})),this.activeEvent.actionsDrop.SetVariable.forEach((e=>e.checkConditions())),this.activeEvent.actionsDrop.SetVariable.forEach((e=>e.dispatch())),this.activeEvent.actionsDrop.DynamicVariablePlay.forEach((e=>e.dispatch())),this.activeEvent.actionsDrop.ClearLocalStorage.forEach((e=>e.dispatch())),this.activeEvent.actionsDrop.UserAPI.forEach((e=>e.dispatch()))),this.eventManager.controlsManager.orbitControls&&(this.eventManager.controlsManager.orbitControls.enabled=!0)}}}connect(){let e={};if(this.eventContext.page.traverseEntity((t=>{t.component&&(e[t.component.uuid]?e[t.component.uuid].push(t.uuid):e[t.component.uuid]=[t.uuid])})),this.eventContext.page.traverseEntity((t=>{var n;null===(n=t.data)||void 0===n||n.events.filter((e=>"DragDrop"===e.data.type&&!e.data.disabled)).forEach((n=>{this.events.push(new I2(t,n.id,n.data,this.eventContext.page,this.eventContext.sharedAssets,this.eventManager,e))}))})),!this.events.length)return;this.domEventsNeeded.clear(),this.domEventsNeeded.add("pointerdown");let t=this.eventContext.domElement;t.addEventListener("pointerdown",this.onPointerDown),t.addEventListener("pointermove",this.onPointerMove),t.addEventListener("pointerup",this.onPointerUp),this.domEventsNeeded.add("pointermove")}disconnect(){if(!this.events.length)return;this.domEventsNeeded.clear();let e=this.eventContext.domElement;e.removeEventListener("pointerdown",this.onPointerDown),e.removeEventListener("pointermove",this.onPointerMove),e.removeEventListener("pointerup",this.onPointerUp),this.events.forEach((e=>e.dispose()))}setCursor(e){this.eventContext.domElement.style.cursor=e}onAnimationFrameDamping(){for(let e of this.events)for(let t of e.dragItems)t.paused||this.updateDragItem(t,!0)}calcPlaneIntersectPos(e,t,n,i){let{getCamera:r,raycaster:s}=this.eventContext;r().getWorldDirection(y2),y2.negate();let a=S2.identity();switch("parent"===i?C2.multiplyMatrices(e.parent.matrixWorld,e.hiddenMatrix).decompose(w2,a,D2):"local"===i&&e.matrixWorld.decompose(w2,a,D2),n){case"x":w2.set(1,0,0).applyQuaternion(a),M2.copy(y2).cross(w2),T2.copy(w2).cross(M2);break;case"y":w2.set(0,1,0).applyQuaternion(a),M2.copy(y2).cross(w2),T2.copy(w2).cross(M2);break;case"z":w2.set(0,0,1).applyQuaternion(a),M2.copy(y2).cross(w2),T2.copy(w2).cross(M2);break;case"xy":T2.set(0,0,1).applyQuaternion(a);break;case"yz":T2.set(1,0,0).applyQuaternion(a);break;case"xz":T2.set(0,1,0).applyQuaternion(a);break;case"adaptive":y2.angleTo(D2.set(0,1,0))>Math.PI/6?(w2.crossVectors(D2.set(0,1,0),y2),T2.crossVectors(w2,D2)):T2.set(0,1,0);break;default:T2.copy(y2)}x2.setFromMatrixPosition(e.matrixWorld);let o=e.userData.lockedPlane?e.userData.worldPosition0:x2;if(b2.setFromNormalAndCoplanarPoint(T2,o),s.ray.intersectPlane(b2,t)&&("x"===n||"y"===n||"z"===n)){let e=D2.subVectors(t,o).dot(w2);t.copy(o).addScaledVector(w2,e)}}updateDragItem(e){var t,n;let i=arguments.length>1&&void 0!==arguments[1]&&arguments[1];x2.setFromMatrixPosition(e.obj.matrixWorld),"current"===e.reset?v2.subVectors(e.fromPosition,x2).divideScalar(e.currentDampingFactor):"original"===e.reset?(v2.subVectors(e.obj.userData.worldPosition0,x2).divideScalar(e.currentDampingFactor),e.fromPosition.copy(e.obj.userData.worldPosition0),e.pointStart.copy(e.fromPosition),e.pointEnd.copy(e.pointStart)):v2.subVectors(e.pointEnd,e.pointStart).add(e.fromPosition).sub(x2).divideScalar(e.currentDampingFactor),e.paused=!(e.currentDampingFactor>1)||v2.length()<.01,(this.activeEvent&&1===this.activeEvent.data.dampingFactor||i)&&O2(e,v2.add(x2),null!==(t=this.activeEvent)&&void 0!==t&&t.data.drop&&null!==(n=this.activeEvent)&&void 0!==n&&n.data.autoOrient?e.orientationMatrix:null),e.obj.dispatchEvent({type:"beginEvent",eventName:"DragDrop"}),this.eventManager.requestRender()}},B2=new Lv,R2=new Lv,L2=new Lv,z2=new Lv,N2=new Hx,j2={type:"requestRender"},U2=function(){let e=new Lv,t=new Lv;return(n,i,r)=>r>0?(e.subVectors(n,i),e.length()<=r?n:t.copy(i).add(e.normalize().multiplyScalar(r))):i}(),V2=function(){let e=new py;return(t,n)=>{t.position.copy(n),null!==t.parent&&(e.copy(t.parent.matrixWorld).invert(),t.position.applyMatrix4(e)),e.copy(t.hiddenMatrix).invert(),t.position.applyMatrix4(e),t.updateMatrix(),t.hasNonUniformScale&&(t.updateMatrixWorld(),t.updateMatrixWorldSVD()),t instanceof FV&&jY(t.parent)&&t.invalidateDownstreamBooleanData(!0)}}(),H2=class{constructor(e,t,n,i,r,s){this.data=e,this.id=t,this.object=n,this.paused=!1,this.currentDampingFactor=1,this.snapComplete=!1,this.isReset=!1,this.worldPosition0=new Lv,this.timeoutId=null,this.delayFinished=!0,this.wasOutside=!1,this.data=d(d(d({},wk.defaultData),e),void 0===e.resetOnPointerLeave&&{resetOnPointerLeave:!1}),void 0===e.target||"cursor"===e.target||(this.target=i.find(e.target)),this.data.dampingFactor&&(this.currentDampingFactor=this.data.dampingFactor),this.resetDampingFactor=80/this.data.resetSpeed+1,this.object.getWorldPosition(this.worldPosition0),this.actions=i1(e,e.actions,i,r,s,n)}},W2=class extends i2{constructor(e,t){super(e),this.eventManager=t,this.events=[],this.pairOfEventListeners=[],this.onMouseMove=e=>{if(!(FF.length>1)){this.eventContext.updateRaycaster(e);for(let e of this.events)void 0===e.target&&this.updateSingleEvent(e)}},this.onMouseEnter=e=>{for(let t of this.events)void 0===t.target&&(t.isReset=!1,t.currentDampingFactor=t.data.dampingFactor)},this.onMouseLeave=e=>{for(let t of this.events)void 0===t.target&&(t.data.resetOnPointerLeave&&(t.isReset=!0,t.currentDampingFactor=t.resetDampingFactor),this.updateSingleEvent(t))},this.onTargetChange=e=>()=>{this.updateSingleEvent(e)}}connect(){let{page:e}=this.eventContext;if(e.traverseEntity((t=>{var n,i;let r=null===(n=t.data)||void 0===n?void 0:n.events.find((e=>"Follow"===e.data.type&&!e.data.disabled));r&&(!e.data.globalPhysics.usePhysics||"dynamic"!==(null===(i=t.dataPatched.physics)||void 0===i?void 0:i.rigidBody))&&this.events.push(new H2(r.data,r.id,t,e,this.eventContext.sharedAssets,this.eventManager))})),!this.events.length)return;let{domElement:t,eventElement:n}=this.eventContext;this.domEventsNeeded.clear(),EF&&(this.domEventsNeeded.add("pointerdown"),t.addEventListener("pointerdown",this.onMouseMove)),this.domEventsNeeded.add("pointermove"),n.addEventListener("pointermove",this.onMouseMove),this.eventContext.useWindowEvents||(t.addEventListener("pointerenter",this.onMouseEnter),t.addEventListener("pointerleave",this.onMouseLeave));for(let i of this.events)if(void 0!==i.target){let e=i.target,t=this.onTargetChange(i);this.pairOfEventListeners.push([e,t]),e.addEventListener("requestRender",t)}}disconnect(){if(!this.events.length)return;let{domElement:e,eventElement:t}=this.eventContext;this.domEventsNeeded.clear(),EF&&e.removeEventListener("pointerdown",this.onMouseMove),t.removeEventListener("pointermove",this.onMouseMove),e.removeEventListener("pointerenter",this.onMouseEnter),e.removeEventListener("pointerleave",this.onMouseLeave);for(let[n,i]of this.pairOfEventListeners)n.removeEventListener("requestRender",i);for(let n of this.events)n.paused=!0,n.isReset=!1,r1(n.actions)}onAnimationFrameDamping(){for(let e of this.events)e.paused||this.updateSingleEvent(e,!0)}updateSingleEvent(e){var t;let n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.events.forEach((e=>{e.actions.Create.forEach((e=>{e.dispatchThrottled()}))}));let{plane:i,limitDistance:r,limitDistanceEnabled:s}=e.data;if(e.object.getWorldPosition(L2),e.isReset)z2.copy(e.worldPosition0);else if(e.target)e.target.getWorldPosition(z2);else{let{getCamera:e,raycaster:t}=this.eventContext;if("custom"===i?(e().getWorldDirection(R2),R2.negate(),B2.copy(R2)):"xy"===i?B2.set(0,0,1):"xz"===i?B2.set(0,1,0):"yz"===i&&B2.set(1,0,0),N2.setFromNormalAndCoplanarPoint(B2,L2),!t.ray.intersectPlane(N2,z2))return}if(!e.isReset)if(z2.distanceTo(e.worldPosition0)>r&&s&&e.target){if(e.snapComplete=!1,e.data.snapDelay&&(e.delayFinished=!1,typeof window<"u"&&null!==e.timeoutId&&(window.clearTimeout(e.timeoutId),e.timeoutId=null)),e.wasOutside=!0,!e.data.resetAfterDistanceLimit)return;z2.copy(e.worldPosition0),e.currentDampingFactor=e.resetDampingFactor}else if(e.wasOutside&&(e.data.snapDelay&&typeof window<"u"&&(e.timeoutId=window.setTimeout((()=>{e.delayFinished=!0,e.paused=!1,this.updateSingleEvent(e)}),1e3*e.data.snapDelay)),e.currentDampingFactor=e.data.dampingFactor,e.wasOutside=!1),!1===e.delayFinished)return;!1===e.data.enabledTranslation[0]&&(z2.x=L2.x),!1===e.data.enabledTranslation[1]&&(z2.y=L2.y),!1===e.data.enabledTranslation[2]&&(z2.z=L2.z);let a=U2(L2,z2,e.wasOutside?0:e.data.maxDelta);if(e.currentDampingFactor>1){let t=B2.subVectors(a,L2).divideScalar(e.currentDampingFactor);L2.add(t),n&&V2(e.object,L2),e.paused=t.length()<.01}else V2(e.object,a),e.paused=!0;null!==(t=e.object)&&void 0!==t&&t.dispatchEvent({type:"beginEvent",eventName:"Follow"}),e.object.dispatchEvent(j2)}},G2=new Lv,q2=new Lv,Y2=new py,X2=new Rv,Q2=new Rv,K2=new Lv,Z2=new Lv,J2=new Lv,$2=new Lv,e3=new Hx,t3={type:"requestRender"},n3={type:"changeRotation"},i3=function(){let e=new py;return function(t,n){null!==t.parent?e.multiplyMatrices(t.parent.matrixWorld,t.hiddenMatrix):e.copy(t.hiddenMatrix),n.premultiply(q1(e).invert()),t.rotation.setFromRotationMatrix(n),t.updateMatrix(),t instanceof FV&&jY(t.parent)&&t.invalidateDownstreamBooleanData(!0)}}(),r3=class{constructor(e,t,n,i){this.id=t,this.object=n,this.paused=!1,this.currentDampingFactor=1,this.isReset=!1,this.worldQuaternion0=new Rv,this.timeoutId=null,this.delayFinished=!0,this.wasOutside=!1,this.data=d(d(d({},Dk.defaultData),e),void 0===e.resetOnPointerLeave&&{resetOnPointerLeave:!1}),void 0===e.target||"cursor"===e.target||(this.target=i.find(e.target)),this.data.dampingFactor&&(this.currentDampingFactor=this.data.dampingFactor),this.object.getWorldQuaternion(this.worldQuaternion0),this.resetDampingFactor=80/this.data.resetSpeed+1}},s3=class extends i2{constructor(){super(...arguments),this.events=[],this.pairOfEventListeners=[],this.pairOfUserEventListeners=[],this.onMouseMove=e=>{if(!(FF.length>1)){this._lastMouseEvent=e,this.eventContext.updateRaycaster(e);for(let e of this.events)void 0===e.target&&this.updateSingleEvent(e)}},this.onMouseEnter=e=>{for(let t of this.events)void 0===t.target&&(t.isReset=!1,t.currentDampingFactor=t.data.dampingFactor)},this.onMouseLeave=e=>{for(let t of this.events)void 0===t.target&&(t.data.resetOnPointerLeave&&(t.isReset=!0,t.currentDampingFactor=t.resetDampingFactor),this.updateSingleEvent(t))},this.onScroll=e=>{if(this._lastMouseEvent){let e=new PointerEvent("pointermove",{clientX:this._lastMouseEvent.clientX,clientY:this._lastMouseEvent.clientY,bubbles:!0,cancelable:!0,view:window});this.eventContext.eventElement.dispatchEvent(e)}},this.onTargetChange=e=>()=>{this.updateSingleEvent(e)},this.createUserEventListener=e=>t=>{let{eventName:n,target:i}=t;if(!n||!i)return;let r=a2(n);r&&"LookAt"===r&&this.updateSingleEvent(e)}}connect(){let{page:e}=this.eventContext;if(e.traverseEntity((t=>{var n,i;let r=null===(n=t.data)||void 0===n?void 0:n.events.find((e=>"LookAt"===e.data.type&&!e.data.disabled));r&&(!e.data.globalPhysics.usePhysics||"dynamic"!==(null===(i=t.dataPatched.physics)||void 0===i?void 0:i.rigidBody))&&this.events.push(new r3(r.data,r.id,t,e))})),!this.events.length)return;let{domElement:t,eventElement:n}=this.eventContext;this.domEventsNeeded.clear(),EF&&(this.domEventsNeeded.add("pointerdown"),t.addEventListener("pointerdown",this.onMouseMove)),this.domEventsNeeded.add("pointermove"),n.addEventListener("pointermove",this.onMouseMove),this.eventContext.useWindowEvents?n.addEventListener("scroll",this.onScroll):(t.addEventListener("pointerenter",this.onMouseEnter),t.addEventListener("pointerleave",this.onMouseLeave));for(let i of this.events){if(void 0!==i.target){let e=this.onTargetChange(i),t=i.target;this.pairOfEventListeners.push([t,e]),t.addEventListener("requestRender",e)}let e=this.createUserEventListener(i),t=i.object;this.pairOfUserEventListeners.push([t,e]),t.addEventListener("userEvent",e)}}disconnect(){if(!this.events.length)return;let{domElement:e,eventElement:t}=this.eventContext;this.domEventsNeeded.clear(),EF&&e.removeEventListener("pointerdown",this.onMouseMove),t.removeEventListener("pointermove",this.onMouseMove),e.removeEventListener("pointerenter",this.onMouseEnter),e.removeEventListener("pointerleave",this.onMouseLeave),t.removeEventListener("scroll",this.onScroll);for(let[n,i]of this.pairOfEventListeners)n.removeEventListener("requestRender",i);for(let[n,i]of this.pairOfUserEventListeners)n.removeEventListener("userEvent",i);for(let n of this.events)n.paused=!0,n.isReset=!1}onAnimationFrameDamping(){for(let e of this.events)e.paused||this.updateSingleEvent(e)}updateSingleEvent(e){var t;let{tilt:n,axis:i,distance:r,plane:s,limitDistance:a,enabledRotation:o,limitDistanceEnabled:l}=e.data,{getCamera:u,raycaster:c}=this.eventContext,{object:h,target:d}=e;if(h.getWorldPosition(K2),!e.isReset)if(e.target)e.target.getWorldPosition(Z2);else{if("custom"===s?(u().getWorldDirection(q2),q2.negate(),e3.setFromNormalAndCoplanarPoint(q2,K2)):("xy"===s?G2.set(0,0,1):"xz"===s?G2.set(0,1,0):"yz"===s&&G2.set(1,0,0),e3.setFromNormalAndCoplanarPoint(G2,K2)),!c.ray.intersectPlane(e3,Z2))return;r>0&&("custom"===s||void 0===s)&&Z2.addScaledVector(q2,r)}if(e.isReset||(d?"target"===n?J2.copy(d.up).applyMatrix4(Y2.extractRotation(d.matrixWorld)).normalize():o.some((e=>!1===e))?("x"===i?($2.set(0,0,1),!1===o[2]&&$2.set(0,1,0)):"y"===i?($2.set(1,0,0),!1===o[0]&&$2.set(0,0,1)):($2.set(0,1,0),!1===o[1]&&$2.set(1,0,0)),J2.copy($2).applyQuaternion(e.worldQuaternion0).normalize()):J2.set(0,1,0):"custom"===s?J2.set(0,1,0):J2.copy(G2)),e.isReset)Q2.copy(e.worldQuaternion0);else if(K2.distanceTo(Z2)>a&&l&&d){if(e.data.snapDelay&&(e.delayFinished=!1,typeof window<"u"&&null!==e.timeoutId&&(window.clearTimeout(e.timeoutId),e.timeoutId=null)),e.wasOutside=!0,!e.data.resetAfterDistanceLimit)return;Q2.copy(e.worldQuaternion0),e.currentDampingFactor=e.resetDampingFactor}else{if(e.wasOutside&&(e.data.snapDelay&&typeof window<"u"&&(e.timeoutId=window.setTimeout((()=>{e.delayFinished=!0,e.paused=!1,this.updateSingleEvent(e)}),1e3*e.data.snapDelay)),e.currentDampingFactor=e.data.dampingFactor,e.wasOutside=!1),!1===e.delayFinished)return;(function(e,t,n,i,r,s){let a=e.elements;l3.subVectors(t,n),0===l3.lengthSq()&&(l3.z=1),l3.normalize(),o3.crossVectors(i,l3),0===o3.lengthSq()&&(1===Math.abs(i.z)?l3.x+=1e-4:l3.z+=1e-4,l3.normalize(),o3.crossVectors(i,l3)),o3.normalize(),a3.crossVectors(l3,o3),"x"===r?1===s.z?[o3,a3,l3]=[l3,o3,a3]:(o3.negate(),[o3,l3]=[l3,o3]):"y"===r?1===s.x?[o3,a3,l3]=[a3,l3,o3]:(o3.negate(),[a3,l3]=[l3,a3]):1===s.x&&(o3.negate(),[o3,a3]=[a3,o3]),a[0]=o3.x,a[4]=a3.x,a[8]=l3.x,a[1]=o3.y,a[5]=a3.y,a[9]=l3.y,a[2]=o3.z,a[6]=a3.z,a[10]=l3.z})(Y2,Z2,K2,J2,i,$2),Q2.setFromRotationMatrix(Y2),X2.setFromUnitVectors($2.applyQuaternion(Q2),J2),o.some((e=>!1===e))&&"target"!==n&&Q2.premultiply(X2).normalize()}e.currentDampingFactor>1?(h.updateWorldMatrix(!0,!1),X2.setFromRotationMatrix(q1(h.matrixWorld)),X2.slerp(Q2,1/e.currentDampingFactor),i3(h,Y2.makeRotationFromQuaternion(X2)),e.paused=8*(1-X2.dot(Q2))<1e-6):(i3(h,Y2.makeRotationFromQuaternion(Q2)),e.paused=!0),null!==(t=e.object)&&void 0!==t&&t.dispatchEvent({type:"beginEvent",eventName:"LookAt"}),h.dispatchEvent(t3),h.dispatchEvent(n3)}},a3=new Lv,o3=new Lv,l3=new Lv;var u3=class{constructor(e,t,n,i,r,s){this.id=e,this.data=t,this.object=n,this.entered=!1,this.actions=i1(t,t.actions,i,r,s,n)}disconnect(){r1(this.actions)}dispatchEnter(){this.actions.Transition.forEach((e=>{e.object.currentTransitionEvent!==this&&(e.object.currentTransitionEvent=this,e.init())})),this.entered||(this.entered=!0,this.actions.Transition.forEach((e=>e.playFromCurrent())),this.actions.Animation.forEach((e=>e.play())),this.actions.Create.forEach((e=>e.dispatchStart())),this.actions.Particles.forEach((e=>e.dispatchBasic())),this.actions.Destroy.forEach((e=>e.dispatch())),this.actions.SwitchCamera.forEach((e=>e.playFromCurrent())),this.actions.SceneTransition.forEach((e=>e.dispatch())),this.actions.SetVariable.forEach((e=>e.checkConditions())),this.actions.SetVariable.forEach((e=>e.dispatch())),this.actions.DynamicVariablePlay.forEach((e=>e.dispatch())),this.actions.ClearLocalStorage.forEach((e=>e.dispatch())),this.actions.UserAPI.forEach((e=>e.dispatch())))}dispatchLeave(){this.actions.Transition.forEach((e=>{e.object.currentTransitionEvent!==this&&(e.object.currentTransitionEvent=this,e.init())})),this.entered&&(this.entered=!1,this.actions.Create.forEach((e=>e.dispatchStop())),this.actions.Transition.forEach((e=>e.reverseFromCurrent())),this.actions.Particles.forEach((e=>e.reverseFromCurrent())),this.actions.SwitchCamera.forEach((e=>e.reverseFromCurrent())))}dispatchUserEvent(e){this.actions.Transition.forEach((e=>{e.object.currentTransitionEvent!==this&&(e.object.currentTransitionEvent=this,e.init())})),e?(this.actions.Transition.forEach((e=>e.reverseFromCurrent())),this.actions.Particles.forEach((e=>e.reverseFromCurrent())),this.actions.Animation.forEach((e=>e.reverseFromCurrent())),this.actions.SwitchCamera.forEach((e=>e.reverseFromCurrent()))):(this.actions.Transition.forEach((e=>e.playFromCurrent())),this.actions.Animation.forEach((e=>e.playFromCurrent())),this.actions.Create.forEach((e=>e.dispatch())),this.actions.Particles.forEach((e=>e.dispatchBasic())),this.actions.Destroy.forEach((e=>e.dispatch())),this.actions.SwitchCamera.forEach((e=>e.playFromCurrent()))),this.actions.SceneTransition.forEach((e=>e.dispatch())),this.actions.SetVariable.forEach((e=>e.checkConditions())),this.actions.SetVariable.forEach((e=>e.dispatch())),this.actions.DynamicVariablePlay.forEach((e=>e.dispatch())),this.actions.ClearLocalStorage.forEach((e=>e.dispatch())),this.actions.UserAPI.forEach((e=>e.dispatch()))}},c3=class extends i2{constructor(e,t){super(e),this.eventManager=t,this.eventsPerObjects={},this.objects=[],this.objects2D=[],this._prevObjects=[],this.onMouseDown=e=>{FF.length>1||(this.eventContext.updateRaycaster(e),this.handleMouseHoverEvent())},this.onMouseUp=e=>{FF.length>1||this.handleMouseHoverEvent(!0)},this.onMouseMove=e=>{FF.length>1||(this.eventContext.updateRaycaster(e),this.handleMouseHoverEvent())},this.onUserEvent=e=>{var t;let{eventName:n,target:i,reverse:r}=e;if(!n||!i)return;let s=a2(n);s&&"MouseHover"===s&&(i.dispatchEvent({type:"beginEvent",eventName:"MouseHover"}),null===(t=this.eventsPerObjects[i.uuid])||void 0===t||t.forEach((e=>e.dispatchUserEvent(r))))}}connect(){let{page:e,sharedAssets:t}=this.eventContext,n=(n,i)=>{var r;if(n.visible&&null!==(r=n.data)&&void 0!==r&&r.events.length){var s;for(let{id:i,data:r}of n.data.events)if(!r.disabled&&"MouseHover"===r.type)try{let s=new u3(i,r,n,e,t,this.eventManager);this.eventsPerObjects[n.uuid]?this.eventsPerObjects[n.uuid].push(s):this.eventsPerObjects[n.uuid]=[s]}catch(a){}(null===(s=this.eventsPerObjects[n.uuid])||void 0===s?void 0:s.length)&&this.objects.push(n instanceof lK?i:n)}};if(e.traverseEntity((e=>{var t;(e instanceof pZ||e instanceof iZ)&&null!==(t=e.frame)&&void 0!==t&&t.traverse((t=>{n(t,e)})),n(e)})),!this.objects.length)return;let{domElement:i}=this.eventContext;this.domEventsNeeded.clear(),EF&&(this.domEventsNeeded.add("pointerdown"),i.addEventListener("pointerdown",this.onMouseDown),this.domEventsNeeded.add("pointerup"),i.addEventListener("pointerup",this.onMouseUp)),this.domEventsNeeded.add("pointermove"),i.addEventListener("pointermove",this.onMouseMove),this.objects.forEach((e=>{e.addEventListener("userEvent",this.onUserEvent)}))}disconnect(){if(!this.objects.length)return;let{domElement:e}=this.eventContext;this.domEventsNeeded.clear(),EF&&(e.removeEventListener("pointerdown",this.onMouseDown),e.removeEventListener("pointerup",this.onMouseUp)),e.removeEventListener("pointermove",this.onMouseMove),Object.values(this.eventsPerObjects).forEach((e=>{e.forEach((e=>{e.disconnect()}))})),this.objects.forEach((e=>{e.removeEventListener("userEvent",this.onUserEvent)}))}handleMouseHoverEvent(){let e=[];if(!(arguments.length>0&&void 0!==arguments[0]&&arguments[0])){let{stopRaycast:t,raycaster:n,page:i,pointerScreen:r}=this.eventContext,s=!1;if(i.uiCanvas&&(s=$1(i,[r.x,r.y],Object.keys(this.eventsPerObjects),(t=>{e.push(t)}))),t&&!s){let t=Z1(n,i,this.objects);e=J1(t),t.forEach((t=>{var n,i,r,s;t.object instanceof pZ&&$1(t.object,[null!==(n=null===t||void 0===t||null===(i=t.uv)||void 0===i?void 0:i.x)&&void 0!==n?n:0,null!==(r=null===t||void 0===t||null===(s=t.uv)||void 0===s?void 0:s.y)&&void 0!==r?r:0],Object.keys(this.eventsPerObjects),(t=>{e.push(t)}))}))}else this.objects.forEach((t=>{var i,r,s,a;let o=e2(n,t);o&&(e.push(t),t instanceof pZ&&$1(t,[null!==(i=null===o||void 0===o||null===(r=o.uv)||void 0===r?void 0:r.x)&&void 0!==i?i:0,null!==(s=null===o||void 0===o||null===(a=o.uv)||void 0===a?void 0:a.y)&&void 0!==s?s:0],Object.keys(this.eventsPerObjects),(t=>{e.push(t)})))}))}this._prevObjects.length&&this._prevObjects.forEach((t=>{var n;e.includes(t)||(t.dispatchEvent({type:"beginEvent",eventName:"MouseHover"}),null===(n=this.eventsPerObjects[t.uuid])||void 0===n||n.forEach((e=>e.dispatchLeave())))})),e.length&&e.forEach((e=>{var t;e.dispatchEvent({type:"beginEvent",eventName:"MouseHover"}),null===(t=this.eventsPerObjects[e.uuid])||void 0===t||t.forEach((e=>e.dispatchEnter()))})),this._prevObjects=e}},h3=class{constructor(e,t,n,i,r,s){this.id=e,this.data=t,this.object=n,this.scrollCounter=0,this.actions=i1(t,t.actions,i,r,s,n)}connect(){this.scrollCounter=0}disconnect(){r1(this.actions)}dispatch(e){this.actions.Transition.forEach((e=>{e.object.currentTransitionEvent!==this&&(e.object.currentTransitionEvent=this,e.init())}));let t=e>0?1:-1;this.scrollCounter+=t,this.scrollCounter=Math.min(Math.max(this.scrollCounter,0),this.data.steps);let n=this.scrollCounter/this.data.steps;this.actions.Transition.forEach((e=>e.seek(n))),this.actions.Animation.forEach((e=>e.seek(t))),this.actions.Create.forEach((e=>e.dispatchThrottled())),this.actions.SetVariable.forEach((e=>e.checkConditions())),this.actions.SetVariable.forEach((e=>e.dispatch())),this.actions.DynamicVariablePlay.forEach((e=>e.dispatch())),this.actions.ClearLocalStorage.forEach((e=>e.dispatch())),this.actions.UserAPI.forEach((e=>e.dispatch()))}dispatchUserEvent(e){this.actions.Transition.forEach((e=>{e.object.currentTransitionEvent!==this&&(e.object.currentTransitionEvent=this,e.init())})),e?(this.actions.Transition.forEach((e=>e.reverseFromCurrent())),this.actions.Animation.forEach((e=>e.reverseFromCurrent()))):(this.actions.Transition.forEach((e=>{e.playFromCurrent()})),this.actions.Animation.forEach((e=>{e.playFromCurrent()}))),this.actions.Create.forEach((e=>e.dispatchThrottled())),this.actions.SetVariable.forEach((e=>e.checkConditions())),this.actions.SetVariable.forEach((e=>e.dispatch())),this.actions.DynamicVariablePlay.forEach((e=>e.dispatch())),this.actions.ClearLocalStorage.forEach((e=>e.dispatch())),this.actions.UserAPI.forEach((e=>e.dispatch()))}},d3=class{constructor(e,t,n,i,r,s,a){this.id=e,this.data=t,this.object=n,this.domElement=s,this.eventManager=a,this.scrollStart=0,this.scrollEnd=0,this.actions=i1(t,t.actions,i,r,a,n)}getStickyParentElement(){let e=this.domElement;for(;e;){if("sticky"===window.getComputedStyle(e).position)return e;e=e.parentElement}return null}computeScrollBounds(){var e,t;let n=this.getStickyParentElement(),i=null===n||void 0===n?void 0:n.parentElement,r=this.domElement.getBoundingClientRect(),s={top:r.top,bottom:r.bottom,left:r.left,right:r.right,width:r.width,height:r.height};if(i){let e=i.getBoundingClientRect(),t=window.getComputedStyle(n),l=parseFloat(t.marginTop)+parseFloat(t.marginBottom),u=parseFloat(t.top),c=parseFloat(t.bottom),h=e.height-l;if(isNaN(u)){if(!isNaN(c)){var a,o;let t=null!==(a=document.body.clientHeight)&&void 0!==a?a:window.innerHeight,n=window.innerWidth-(null!==(o=document.documentElement.clientWidth)&&void 0!==o?o:window.innerWidth);r.bottom===t-c?(s.top+=e.top-r.height+c+n,s.bottom+=e.top-r.height+c+n):r.bottom<t-c&&(s.top-=h-r.height,s.bottom-=h-r.height)}}else r.top===u?(s.top+=e.top-u,s.bottom+=e.top-u):r.top<0&&(s.top-=h-r.height,s.bottom-=h-r.height)}let l=document.body,u=document.documentElement,c=window.pageYOffset||u.scrollTop||l.scrollTop,h=u.clientTop||l.clientTop||0,d=Math.round(s.top+c-h);if("enter"===this.data.startFrom){let e=window.innerHeight,t=s.height,n=this.data.enterAnchor,i="top"===n?e:"bottom"===n?e-t:e-.5*t;this.scrollStart=d-i}else this.scrollStart=0;this.scrollStart+=null!==(e=this.data.startOffset)&&void 0!==e?e:0,this.scrollEnd=this.scrollStart+(null!==(t=this.data.endAfter)&&void 0!==t?t:400),this.box=s,this.computeScroll({x:window.scrollX,y:window.scrollY})}connect(){this.computeScrollBounds()}disconnect(){r1(this.actions)}handleResize(){this.computeScrollBounds()}get isInvalidBox(){return void 0===this.box||0===this.box.width&&0===this.box.height&&0===this.box.top&&0===this.box.bottom}computeScroll(e){let{x:t,y:n}=e;this.actions.Transition.forEach((e=>{e.object.currentTransitionEvent!==this&&(e.object.currentTransitionEvent=this,e.init())}));let i=this.scrollEnd-this.scrollStart,r=Math.min(1,Math.max(0,(n-this.scrollStart)/i));this.actions.Transition.forEach((e=>e.seek(r))),this.actions.Animation.forEach((e=>e.seek(r))),this.actions.Create.forEach((e=>e.dispatchThrottled())),this.actions.SetVariable.forEach((e=>e.checkConditions())),this.actions.SetVariable.forEach((e=>e.dispatch())),this.actions.DynamicVariablePlay.forEach((e=>e.dispatch())),this.actions.ClearLocalStorage.forEach((e=>e.dispatch())),this.actions.UserAPI.forEach((e=>e.dispatch()))}dispatch(e){this.isInvalidBox&&this.computeScrollBounds(),this.computeScroll(e)}dispatchUserEvent(e){this.actions.Transition.forEach((e=>{e.object.currentTransitionEvent!==this&&(e.object.currentTransitionEvent=this,e.init())})),e?(this.actions.Transition.forEach((e=>e.reverseFromCurrent())),this.actions.Animation.forEach((e=>e.reverseFromCurrent()))):(this.actions.Transition.forEach((e=>{e.playFromCurrent()})),this.actions.Animation.forEach((e=>{e.playFromCurrent()}))),this.actions.Create.forEach((e=>e.dispatchThrottled())),this.actions.SetVariable.forEach((e=>e.checkConditions())),this.actions.SetVariable.forEach((e=>e.dispatch())),this.actions.DynamicVariablePlay.forEach((e=>e.dispatch())),this.actions.ClearLocalStorage.forEach((e=>e.dispatch())),this.actions.UserAPI.forEach((e=>e.dispatch()))}},p3=class extends i2{constructor(e,t){super(e),this.managers=t,this.wheelEventsPerObject=new Map,this.scrollEventsPerObject=new Map,this.isInview=!0,this.handleResize=()=>{[...this.scrollEventsPerObject.entries()].forEach((e=>{let[t,n]=e;n.forEach((e=>e.handleResize()))}))},this.onScroll=e=>{if(!this.isInview)return;let t={y:window.scrollY,x:window.scrollX};[...this.scrollEventsPerObject.entries()].forEach((e=>{let[n,i]=e;n.dispatchEvent({type:"beginEvent",eventName:"Scroll",scroll:t}),i.forEach((e=>e.dispatch(t)))}))},this.onWheel=e=>{!this.isInview||e.ctrlKey||[...this.wheelEventsPerObject.entries()].forEach((t=>{let[n,i]=t;n.dispatchEvent({type:"beginEvent",eventName:"Scroll",deltaY:e.deltaY}),i.forEach((t=>t.dispatch(e.deltaY)))}))},this.onUserEvent=e=>{var t;let{eventName:n,target:i,reverse:r}=e;if(!n||!i)return;let s=a2(n);s&&"Scroll"===s&&(i.dispatchEvent({type:"beginEvent",eventName:"Scroll"}),null===(t=this.wheelEventsPerObject.get(i))||void 0===t||t.forEach((e=>{e.dispatchUserEvent(r)})))}}connect(){let{page:e,sharedAssets:t,domElement:n,isExport:i}=this.eventContext,r=r=>{var s;if(null!==(s=r.data)&&void 0!==s&&s.events.length)for(let{id:l,data:u}of r.data.events)if(!u.disabled&&"Scroll"===u.type)if("load"!==u.trigger&&i){var a;let i=new d3(l,u,r,e,t,n,this.managers);this.scrollEventsPerObject.has(r)?null===(a=this.scrollEventsPerObject.get(r))||void 0===a||a.push(i):this.scrollEventsPerObject.set(r,[i])}else{var o;let n=new h3(l,u,r,e,t,this.managers);this.wheelEventsPerObject.has(r)?null===(o=this.wheelEventsPerObject.get(r))||void 0===o||o.push(n):this.wheelEventsPerObject.set(r,[n])}};e.traverseEntity((e=>{var t;(e instanceof pZ||e instanceof iZ)&&null!==(t=e.frame)&&void 0!==t&&t.traverse((e=>{r(e)})),r(e)})),this.intersectionObserver=new IntersectionObserver((e=>{let t=e[0];t&&(this.isInview=t.isIntersecting)}),{root:null}),this.intersectionObserver.observe(this.eventContext.domElement),[...this.wheelEventsPerObject.entries()].forEach((e=>{let[t,n]=e;n.forEach((e=>e.connect())),t.addEventListener("userEvent",this.onUserEvent)})),[...this.scrollEventsPerObject.entries()].forEach((e=>{let[t,n]=e;n.forEach((e=>e.connect())),t.addEventListener("userEvent",this.onUserEvent)})),[...this.wheelEventsPerObject.values()].some((e=>e.length))&&(this.domEventsNeeded.add("wheel"),window.addEventListener("wheel",this.onWheel)),[...this.scrollEventsPerObject.values()].some((e=>e.length))&&(this.domEventsNeeded.add("scroll"),window.addEventListener("scroll",this.onScroll),window.addEventListener("resize",this.handleResize))}disconnect(){window.removeEventListener("wheel",this.onWheel),window.removeEventListener("scroll",this.onScroll),window.removeEventListener("resize",this.handleResize),this.intersectionObserver.unobserve(this.eventContext.domElement),this.domEventsNeeded.clear(),[...this.wheelEventsPerObject.entries()].forEach((e=>{let[t,n]=e;n.forEach((e=>e.disconnect())),t.removeEventListener("userEvent",this.onUserEvent)})),[...this.scrollEventsPerObject.entries()].forEach((e=>{let[t,n]=e;n.forEach((e=>e.disconnect())),t.removeEventListener("userEvent",this.onUserEvent)}))}},f3=class{constructor(e,t,n,i,r,s){this.id=e,this.data=t,this.object=n,this.actions=i1(t,t.actions,i,r,s,n)}disconnect(){r1(this.actions)}dispatch(){this.actions.Transition.forEach((e=>{e.play()})),this.actions.Animation.forEach((e=>{e.play()})),this.actions.SwitchCamera.forEach((e=>{e.play()})),this.actions.SceneTransition.forEach((e=>{e.dispatch()})),this.actions.Reset.forEach((e=>e.dispatch())),this.actions.SetVariable.forEach((e=>e.checkConditions())),this.actions.SetVariable.forEach((e=>e.dispatch())),this.actions.DynamicVariablePlay.forEach((e=>e.dispatch())),this.actions.ClearLocalStorage.forEach((e=>e.dispatch())),this.actions.UserAPI.forEach((e=>e.dispatch())),this.actions.Create.forEach((e=>{e.dispatchFromStart()})),this.actions.Destroy.forEach((e=>{e.dispatchFromStart()}))}dispatchAfter(e){this.actions.Audio.forEach((t=>{var n;(null!==(n=t.interaction.data.triggerAfter)&&void 0!==n?n:"any")===e&&(t.interaction instanceof XJ?t.interaction.audioPlayer.play():t.interaction instanceof QJ&&t.interaction.dispatch())})),this.actions.Video.forEach((t=>{var n;let i=null!==(n=t.interaction.data.triggerAfter)&&void 0!==n?n:"autoplay";i===e&&(t.interaction instanceof o1?t.interaction.play("autoplay"===i):t.interaction instanceof l1&&t.interaction.dispatch())})),this.actions.Particles.forEach((t=>{var n;(null!==(n=t.data.triggerAfter)&&void 0!==n?n:"any")===e&&t.dispatchBasic()}))}dispatchUserEvent(e){this.actions.Transition.forEach((e=>{e.object.currentTransitionEvent!==this&&(e.object.currentTransitionEvent=this,e.init())})),e?(this.actions.Transition.forEach((e=>e.reverseFromCurrent())),this.actions.Animation.forEach((e=>e.reverseFromCurrent())),this.actions.SwitchCamera.forEach((e=>e.reverseFromCurrent()))):(this.actions.Transition.forEach((e=>e.playFromCurrent())),this.actions.Animation.forEach((e=>e.playFromCurrent())),this.actions.SwitchCamera.forEach((e=>e.playFromCurrent()))),this.actions.SceneTransition.forEach((e=>e.dispatch())),this.actions.Reset.forEach((e=>e.dispatch())),this.actions.SetVariable.forEach((e=>e.checkConditions())),this.actions.SetVariable.forEach((e=>e.dispatch())),this.actions.DynamicVariablePlay.forEach((e=>e.dispatch())),this.actions.ClearLocalStorage.forEach((e=>e.dispatch())),this.actions.UserAPI.forEach((e=>e.dispatch())),this.actions.Create.forEach((e=>{e.dispatch()})),this.actions.Destroy.forEach((e=>{e.dispatch()})),this.actions.Audio.forEach((e=>{e.interaction instanceof XJ?e.interaction.audioPlayer.play():e.interaction instanceof QJ&&e.interaction.dispatch()})),this.actions.Video.forEach((e=>{e.interaction instanceof o1?e.interaction.play():e.interaction instanceof l1&&e.interaction.dispatch()})),this.actions.Particles.forEach((e=>{e.dispatchBasic()}))}},m3=class extends i2{constructor(e,t){super(e),this.eventManager=t,this.eventsPerObject=new Map,this.eventsAfterPerObject=new Map,this.onMouseDown=()=>{[...this.eventsAfterPerObject.entries()].forEach((e=>{let[t,n]=e;t.dispatchEvent({type:"beginEvent",eventName:"Start"}),n.forEach((e=>{e.dispatchAfter("mouseDown")}))}))},this.onKeyDown=()=>{[...this.eventsAfterPerObject.entries()].forEach((e=>{let[t,n]=e;t.dispatchEvent({type:"beginEvent",eventName:"Start"}),n.forEach((e=>{e.dispatchAfter("keyDown")}))}))},this.onAny=()=>{let{domElement:e,isExport:t}=this.eventContext,n=t?document:e;n.removeEventListener("pointerdown",this.onAny),n.removeEventListener("mousedown",this.onAny),document.removeEventListener("keydown",this.onAny),[...this.eventsAfterPerObject.entries()].forEach((e=>{let[t,n]=e;t.dispatchEvent({type:"beginEvent",eventName:"Start"}),n.forEach((e=>{e.dispatchAfter("any")}))}))},this.onSceneTransitionAudioVideoPlay=()=>{[...this.eventsAfterPerObject.entries()].forEach((e=>{let[t,n]=e;t.dispatchEvent({type:"beginEvent",eventName:"Start"}),n.forEach((e=>{e.actions.Audio.forEach((e=>{e.interaction instanceof XJ&&e.interaction.audioPlayer.play()})),e.actions.Video.forEach((e=>{var t;let n=null!==(t=e.interaction.data.triggerAfter)&&void 0!==t?t:"autoplay";e.interaction instanceof o1&&e.interaction.play("autoplay"===n)})),e.actions.Particles.forEach((e=>{e.dispatchBasic()}))}))}))},this.onPlay=()=>{[...this.eventsAfterPerObject.entries()].forEach((e=>{let[t,n]=e;t.dispatchEvent({type:"beginEvent",eventName:"Start"}),n.forEach((e=>{e.dispatchAfter("autoplay")}))}))},this.onUserEvent=e=>{var t,n;let{eventName:i,target:r,reverse:s}=e;if(!i||!r)return;let a=a2(i);a&&"Start"===a&&(r instanceof lK||r.dispatchEvent({type:"beginEvent",eventName:"Start"}),null!==(t=this.eventsPerObject.get(r))&&void 0!==t&&t.forEach((e=>{e.dispatchUserEvent(s)})),null===(n=this.eventsAfterPerObject.get(r))||void 0===n||n.forEach((e=>{e.dispatchUserEvent(s)})))}}connect(){let{sharedAssets:e,page:t}=this.eventContext,n=n=>{var i;if(null!==(i=n.data)&&void 0!==i&&i.events.length)for(let{id:l,data:u}of n.data.events){var r,s,a,o;if(u.disabled||"Start"!==u.type)continue;let i=new f3(l,u,n,t,e,this.eventManager);(i.actions.Transition.length||i.actions.Animation.length||i.actions.SwitchCamera.length||i.actions.Create.length||i.actions.Destroy.length||i.actions.SceneTransition.length||i.actions.Reset.length||i.actions.SetVariable.length||i.actions.DynamicVariablePlay.length||i.actions.ClearLocalStorage.length||i.actions.UserAPI.length)&&(this.eventsPerObject.has(n)?null===(r=this.eventsPerObject.get(n))||void 0===r||r.push(i):this.eventsPerObject.set(n,[i])),i.actions.Audio.length&&(this.eventsAfterPerObject.has(n)?null===(s=this.eventsAfterPerObject.get(n))||void 0===s||s.push(i):this.eventsAfterPerObject.set(n,[i])),i.actions.Video.length&&(this.hasVideoAction=!0,this.eventsAfterPerObject.has(n)?null===(a=this.eventsAfterPerObject.get(n))||void 0===a||a.push(i):this.eventsAfterPerObject.set(n,[i])),i.actions.Particles.length&&(this.eventsAfterPerObject.has(n)?null===(o=this.eventsAfterPerObject.get(n))||void 0===o||o.push(i):this.eventsAfterPerObject.set(n,[i]))}};if(t.traverseEntity((e=>{var t;(e instanceof pZ||e instanceof iZ)&&null!==(t=e.frame)&&void 0!==t&&t.traverse((e=>{n(e)})),n(e)})),[...this.eventsAfterPerObject.values()].some((e=>e.length))){if(0===this.eventManager.activateCount){let{domElement:e,isExport:t}=this.eventContext,n=t?document:e;n.addEventListener("pointerdown",this.onMouseDown,{once:!0}),n.addEventListener("mousedown",this.onMouseDown,{once:!0}),document.addEventListener("keydown",this.onKeyDown,{once:!0}),n.addEventListener("pointerdown",this.onAny),n.addEventListener("mousedown",this.onAny),document.addEventListener("keydown",this.onAny),[...this.eventsAfterPerObject.entries()].forEach((e=>{let[t,n]=e;t.addEventListener("userEvent",this.onUserEvent)}))}else this.onSceneTransitionAudioVideoPlay();this.onPlay()}[...this.eventsPerObject.entries()].forEach((e=>{let[t,n]=e;t.dispatchEvent({type:"beginEvent",eventName:"Start"}),n.forEach((e=>e.dispatch())),t.addEventListener("userEvent",this.onUserEvent)}))}disconnect(){if([...this.eventsAfterPerObject.values()].some((e=>e.length))){let{domElement:e,isExport:t}=this.eventContext,n=t?document:e;n.removeEventListener("pointerdown",this.onMouseDown),n.removeEventListener("mousedown",this.onMouseDown),document.removeEventListener("keydown",this.onKeyDown),n.removeEventListener("pointerdown",this.onAny),n.removeEventListener("mousedown",this.onAny),document.removeEventListener("keydown",this.onAny),[...this.eventsAfterPerObject.entries()].forEach((e=>{let[t,n]=e;t.removeEventListener("userEvent",this.onUserEvent),n.forEach((e=>e.disconnect()))}))}[...this.eventsPerObject.entries()].forEach((e=>{let[t,n]=e;t.removeEventListener("userEvent",this.onUserEvent),n.forEach((e=>e.disconnect()))})),this.eventsPerObject.clear(),this.eventsAfterPerObject.clear()}},g3=class{constructor(e,t,n,i,r,s){this.id=e,this.data=t,this.object=n,this.initialDisabled=!1,this.actions=i1(t,t.actions,i,r,s,n),this.target=t.target}disconnect(){r1(this.actions)}dispatch(e){this.initialDisabled||(this.actions.Transition.forEach((e=>{e.object.currentTransitionEvent!==this&&(e.object.currentTransitionEvent=this,e.init())})),this.object.dispatchEvent({type:"beginEvent",eventName:"Collision"}),this.actions.Transition.forEach((e=>{"Toggle"===e.data.runMode?e.toggle():e.play()})),this.actions.Animation.forEach((e=>{"Toggle"===e.data.runMode?e.toggle():e.play()})),this.actions.Reset.forEach((e=>{e.dispatch()})),this.actions.Link.forEach((e=>{e.dispatch()})),this.actions.Reset.forEach((e=>{e.dispatch()})),this.actions.Create.forEach((e=>{e.dispatch()})),this.actions.Destroy.forEach((t=>{t.dispatch(null!==e&&void 0!==e&&e)})),this.actions.SetVariable.forEach((e=>e.checkConditions())),this.actions.SetVariable.forEach((e=>e.dispatch())),this.actions.DynamicVariablePlay.forEach((e=>e.dispatch())),this.actions.Audio.forEach((e=>{e.dispatchBasic()})),this.actions.Particles.forEach((e=>{e.dispatchBasic()})),this.actions.Video.forEach((e=>{e.dispatchBasic()})),this.actions.ClearLocalStorage.forEach((e=>e.dispatch())),this.actions.UserAPI.forEach((e=>e.dispatch())))}},v3=class extends i2{constructor(e,t,n,i,r){super(e),this.sharedVariables=t,this.eventManager=n,this.needsMouse=i,this.needsRaycast=r,this.dynamicVars=[],this.variablesToWatch=[],this.prevMouseProperty=null,this.prevRaycastProperty=null,this.pauseTime=0,this.isOutOfFocus=!1,this.events=[],this.onFrame=e=>{let t=this.eventContext.sharedAssets;if(this.rafId=window.requestAnimationFrame(this.onFrame),this.isOutOfFocus)return;let n=new Date,i=[],r=[];for(let u=0;u<this.propertiesToWatch.length;u++){let{objectId:e,property:t,prevValue:n}=this.propertiesToWatch[u],i=this.eventContext.scene.find(e),s=Tk.propertyPaths[t];if("width"===s[0]||"height"===s[0]||"depth"===s[0])i=i.geometry.userData.parameters[s[0]];else for(let r=0;r<s.length;r++)i=i[s[r]];null===n?this.propertiesToWatch[u].prevValue=i instanceof Lv?i.clone():i:(i instanceof Lv?!i.equals(n):n!==i)&&(r.push({objId:e,property:t}),i instanceof Lv?this.propertiesToWatch[u].prevValue.copy(i):this.propertiesToWatch[u].prevValue=i)}for(let u=0;u<this.variablesToWatch.length;u++){let{id:e,prevValue:n}=this.variablesToWatch[u],r=t.getVariable(e);r!==n&&(i.push(e),this.variablesToWatch[u].prevValue=r)}for(let u=0;u<this.dynamicVars.length;u++){let{id:r,expectedTime:o,last:l,data:c,timerSeconds:h,startValue:d}=this.dynamicVars[u],p=1e3;if("timer"!==c.dynamicVariableType&&"stopwatch"!==c.dynamicVariableType||"number3decimal"!==c.format?"counter"===c.dynamicVariableType?p=c.updateInterval:"random"===c.dynamicVariableType&&(p=c.isStatic?1/0:c.updateInterval):p=1,-1!==o){if("Stopped"!==t.getDynamicVariablePlayState(r)&&"Restarted"!==t.getDynamicVariablePlayState(r)||(this.dynamicVars[u].last=e,this.dynamicVars[u].expectedTime=e+p,"counter"===c.dynamicVariableType&&t.getVariable(r)!==d&&(t.updateVariable(r,d),this.eventManager.requestRender()),("timer"===c.dynamicVariableType||"stopwatch"===c.dynamicVariableType)&&this.dynamicVars[u].timerSeconds!==d&&(this.dynamicVars[u].timerSeconds=d,t.updateVariable(r,mR.getFormattedTimerTime(d,c)),this.eventManager.requestRender()),"Restarted"===t.getDynamicVariablePlayState(r)&&t.setDynamicVariablePlayState(r,"Playing"),"Stopped"!==t.getDynamicVariablePlayState(r))){if("Paused"===t.getDynamicVariablePlayState(r)){void 0===this.dynamicVars[u].deltaToExpectedTime&&(this.dynamicVars[u].deltaToExpectedTime=Math.max(this.dynamicVars[u].expectedTime-e,0)),this.dynamicVars[u].last=e-(p-this.dynamicVars[u].deltaToExpectedTime),this.dynamicVars[u].expectedTime=e+this.dynamicVars[u].deltaToExpectedTime;continue}if(this.dynamicVars[u].deltaToExpectedTime=void 0,e>=o)if(this.dynamicVars[u].last=e,this.dynamicVars[u].expectedTime+=p,"random"===c.dynamicVariableType){let e=c.min+Math.random()*(c.max-c.min),n=c.decimals;e=Math.round(e*Math.pow(10,n))/Math.pow(10,n),t.updateVariable(r,e),i.push(r),this.eventManager.requestRender()}else if("counter"===c.dynamicVariableType){var s;let e=t.getVariable(r),n=null===(s=t.getDynamicVariableToggleIsForward(r))||void 0===s||s,a=t.getVariable(r)+c.increment*(n?1:-1);c.hasEnd&&(a=c.increment>0?ov.clamp(a,d,c.endValue):ov.clamp(a,c.endValue,d),a===d&&t.setDynamicVariableToggleIsForward(r,void 0),c.repeat?a===c.endValue&&(a=d):(a===d||a===c.endValue)&&t.setDynamicVariablePlayState(r,"Paused")),a!==e&&(i.push(r),t.updateVariable(r,a),this.eventManager.requestRender())}else if("time"===c.dynamicVariableType){let e=t.getVariable(r),s=KW(n,c);if("object"==typeof e&&"textValue"in e&&"object"==typeof s&&"textValue"in s){if(Array.isArray(e.textValue)&&Array.isArray(s.textValue)){if(e.textValue.every(((e,t)=>e===s.textValue[t])))continue}else if(e.textValue===s.textValue)continue}else if(e===s)continue;t.updateVariable(r,s),i.push(r),this.eventManager.requestRender()}else{var a;let n=cR.isTextValue(c.endValue)?x3(c.endValue.textValue):c.endValue,s=null===(a=t.getDynamicVariableToggleIsForward(r))||void 0===a||a,o=h+(e-l)/1e3*("timer"===c.dynamicVariableType?-1:1)*(s?1:-1);o=Math.max(o,0),c.hasEnd&&(o="stopwatch"===c.dynamicVariableType?ov.clamp(o,d,n):ov.clamp(o,n,d),o===d&&t.setDynamicVariableToggleIsForward(r,void 0),c.repeat?Math.abs(o-n)<("number3decimal"===c.format?1e-4:.1)&&(o=d):(Math.abs(o-d)<("number3decimal"===c.format?1e-4:.1)||Math.abs(o-n)<("number3decimal"===c.format?1e-4:.1))&&t.setDynamicVariablePlayState(r,"Paused")),o!==h&&(i.push(r),this.dynamicVars[u].timerSeconds=o,t.updateVariable(r,mR.getFormattedTimerTime(o,c)),this.eventManager.requestRender())}}}else this.dynamicVars[u].last=e,this.dynamicVars[u].expectedTime=e+p}let o=!1;t.mouseProperty!==this.prevMouseProperty&&(this.prevMouseProperty=t.mouseProperty,o=!0);let l=!1;t.raycastProperty!==this.prevRaycastProperty&&(this.prevRaycastProperty=t.raycastProperty,l=!0),this.events.forEach((e=>{(i.includes(e.data.variableId)||r.find((t=>t.objId===e.data.objectId&&t.property===e.data.property))||"mouseProperty"===e.data.variableId&&o||"raycastProperty"===e.data.variableId&&l)&&(e.dispatch(),this.eventManager.requestRender())}))},this.onBlur=()=>{this.pause()},this.onFocus=()=>{this.resume()}}pause(){this.isOutOfFocus||(this.isOutOfFocus=!0,this.pauseTime=Date.now())}resume(){if(!this.isOutOfFocus)return;this.isOutOfFocus=!1;let e=Date.now()-this.pauseTime;for(let t=0;t<this.dynamicVars.length;t++)this.dynamicVars[t].last+=e,this.dynamicVars[t].expectedTime+=e}connect(){this.eventContext.page.traverseEntity((e=>{var t;null===(t=e.data)||void 0===t||t.events.filter((e=>"VariableChange"===e.data.type&&!e.data.disabled)).forEach((t=>{this.events.push(new y3(t.id,t.data,e,this.eventContext.page,this.eventContext.sharedAssets,this.eventManager))}))})),this.propertiesToWatch=this.events.filter((e=>"objectProperty"===e.data.variableId&&null!==e.data.objectId)).map((e=>({objectId:e.data.objectId,property:e.data.property,prevValue:null})));let e=this.eventContext.sharedAssets;this.sharedVariables.forEach((t=>{let n,{id:i,data:r}=t;if("dynamicVariableType"in r)if("timer"===r.dynamicVariableType||"stopwatch"===r.dynamicVariableType){let e;if(cR.isTextValue(r.value)&&Array.isArray(r.value.textValue)){let t=r.value.textValue;e=3===t.length?t[2]+60*t[1]+3600*t[0]:t[1]+60*t[0]}else e=r.value;n=e,this.dynamicVars.push({id:i,last:-1,expectedTime:-1,data:r,timerSeconds:e,startValue:n})}else"time"===r.dynamicVariableType&&e.updateVariable(i,KW(new Date,r)),"counter"===r.dynamicVariableType&&(n=cR.isTextValue(r.value)?x3(r.value.textValue):r.value),this.dynamicVars.push({id:i,last:-1,expectedTime:-1,data:r,startValue:n});else this.events.find((e=>e.data.variableId===i))&&this.variablesToWatch.push({id:i,prevValue:e.getVariable(i)})})),this.rafId=window.requestAnimationFrame(this.onFrame),window.addEventListener("blur",this.onBlur),window.addEventListener("focus",this.onFocus)}disconnect(){window.removeEventListener("blur",this.onBlur),window.removeEventListener("focus",this.onFocus),this.rafId&&(window.cancelAnimationFrame(this.rafId),this.rafId=void 0),this.events.forEach((e=>e.dispose()))}},y3=class{constructor(e,t,n,i,r,s){this.id=e,this.data=t,this.object=n,this.actions=i1(t,t.actions,i,r,s,n)}dispatch(){let e=this.actions;e.Audio.forEach((e=>e.dispatchConditional())),e.Particles.forEach((e=>e.dispatchConditional())),e.Video.forEach((e=>e.dispatchConditional())),e.Create.forEach((e=>e.dispatch())),e.Destroy.forEach((e=>e.dispatch())),e.Reset.forEach((e=>e.dispatch())),e.Transition.forEach((e=>{e.object.currentTransitionEvent!==this&&(e.object.currentTransitionEvent=this),e.init()})),e.Transition.forEach((e=>e.play())),e.Animation.forEach((e=>e.play())),e.SwitchCamera.forEach((e=>e.play())),e.SceneTransition.forEach((e=>e.dispatch())),e.SetVariable.forEach((e=>e.checkConditions())),e.SetVariable.forEach((e=>e.dispatch())),e.DynamicVariablePlay.forEach((e=>e.dispatch())),e.ClearLocalStorage.forEach((e=>e.dispatch())),e.UserAPI.forEach((e=>e.dispatch()))}dispose(){r1(this.actions)}};function x3(e){return 3===e.length?e[2]+60*e[1]+3600*e[0]:e[1]+60*e[0]}var b3,w3,D3,_3="\n(async function() {\n\tconst [wasmImport, wasmBinary] = await Promise.all([\n\t\timport('".concat("https://unpkg.com/@splinetool/runtime@1.9.59/build/","' + 'navmesh.js'),\n\t\tfetch('").concat("https://unpkg.com/@splinetool/navmesh-wasm@1.9.59/build/","' + 'navmesh.wasm').then((res) => res.arrayBuffer()),\n\t]);\n\tconst wasmModule = wasmImport.default;\n\tself.module = await wasmModule({ wasmBinary });\n\tpostMessage('ready');\n})();\n"),S3={cs:6,ch:2,walkableSlopeAngle:90,walkableHeight:20,walkableClimb:5,walkableRadius:0,maxEdgeLen:12,maxSimplificationError:1.3,minRegionArea:8,mergeRegionArea:20,maxVertsPerPoly:6,detailSampleDist:6,detailSampleMaxError:1};HF.then((e=>{b3=e,w3=new e.Vec3,D3=new e.Vec3}));var E3=new Lv,C3=class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.usePhysics=e,this.isExport=t,this.onPointerDown=e=>{if(1!==FF.length)return;let{raycaster:t,page:n}=this.eventContext;this.eventContext.updateRaycaster(e);let i=n.raycastWithClones(t);if(0!==i.length){if(this.gameControl){let e=E3.copy(this.gameControl.colliderWorldPosition);e.y-=this.gameControl.colliderHeight/2,this.gameControl.path=this.computePath(e,i[0].point)}this.eventContext.requestRender()}},this.traverseWithPhysics=(e,t)=>n=>{var i,r,s,a,o,l;let u;if(n instanceof pY){if(!n.objectForSample)return!0===n.object.dataPatched.physics.fusedBody&&"dynamic"===n.object.dataPatched.physics.rigidBody||void 0;if(n.objectForSample.dataPatched.physics.fusedBody)return;u=n.object}else if(n instanceof Vz)u=n.object;else if(u=n,!1===(null===(i=u.dataPatched.cloner)||void 0===i?void 0:i.disabled)&&null!==(r=u.dataPatched.cloner)&&void 0!==r&&r.hideBase&&!0!==(null===(s=u.dataPatched.physics)||void 0===s?void 0:s.fusedBody))return!0;if(t&&!u.userData.navmesh)return;let c=u.dataPatched;if(!c.visible&&!0!==(null===(a=c.physics)||void 0===a?void 0:a.enabled))return!0;n.updateMatrixWorldSVD();let h=h4(c),d=u.userData.hasDestroy,p=u.userData.hasDrag,f=!1,m=!1;for(let e of c.events)!0!==e.data.disabled&&("GameControl"===e.data.type?f=!0:"Follow"===e.data.type&&(m=!0));if(f||h||m||d||p)return!0;var g;if(this.usePhysics&&"dynamic"===(null===(o=c.physics)||void 0===o?void 0:o.rigidBody)){if(this.usePhysics&&null!==(g=c.physics)&&void 0!==g&&g.fusedBody)return!0}else if("geometry"in n&&n.geometry&&e.push(V1(n.geometry,n.matrixWorld)),this.usePhysics&&null!==(l=c.physics)&&void 0!==l&&l.fusedBody)return n.traverseObject(((t,n)=>{var i,r;if(0===n)return;let s;if(t instanceof pY){if(!t.objectForSample)return!0===t.object.dataPatched.physics.fusedBody&&"dynamic"===t.object.dataPatched.physics.rigidBody||void 0;if(t.objectForSample.dataPatched.physics.fusedBody)return;s=t.object}else if(t instanceof Vz)s=t.object;else if(s=t,null!==(i=t.dataPatched.cloner)&&void 0!==i&&i.hideBase)return!0;let a=s.dataPatched;if(!a.visible&&!0!==(null===(r=a.physics)||void 0===r?void 0:r.enabled))return!0;"geometry"in t&&t.geometry&&e.push(V1(t.geometry,t.matrixWorld))})),!0},this.traverseNoPhysics=(e,t)=>n=>{let i;if(n instanceof pY)return;i=n instanceof Vz?n.object:n;let r=i.dataPatched;if("visibility"===r.physics.enabled?!r.visible:!r.physics.enabled)return!0;if(t&&!i.userData.navmesh)return;let s=n.geometry,a=!0===i.userData.hasDestroy,o=!0===i.userData.hasDrag;if(h4(r)||a||o||i.dataPatched.events.some((e=>!0!==e.data.disabled&&"GameControl"===e.data.type)))return!0;s&&e.push(V1(s,n.matrixWorld))},this.navmeshWasm=b3,this.navMesh=new this.navmeshWasm.NavMesh,this._workerURL=URL.createObjectURL(new Blob([(t?_3:"\n(async function() {\n\tconst [wasmImport, wasmBinary] = await Promise.all([\n\t\timport(self.location.origin + '/_libraries/navmesh.js'),\n\t\tfetch(self.location.origin + '/_libraries/navmesh.wasm').then((res) => res.arrayBuffer()),\n\t]);\n\tconst wasmModule = wasmImport.default;\n\tself.module = await wasmModule({ wasmBinary });\n\tpostMessage('ready');\n})();\n")+"\n\nonmessage = function(messageEvent) {\n\tconst meshData = messageEvent.data;\n\tconst positions = meshData[0];\n\tconst offset = meshData[1];\n\tconst indices = meshData[2];\n\tconst indicesLength = meshData[3];\n\tconst parameters = meshData[4];\n\n\tconst module = self.module;\n\tconst rc = new module.rcConfig();\n\trc.cs = parameters.cs;\n\trc.ch = parameters.ch;\n\trc.borderSize = parameters.borderSize ? parameters.borderSize : 0;\n\trc.tileSize = parameters.tileSize ? parameters.tileSize : 0;\n\trc.walkableSlopeAngle = parameters.walkableSlopeAngle;\n\trc.walkableHeight = parameters.walkableHeight;\n\trc.walkableClimb = parameters.walkableClimb;\n\trc.walkableRadius = parameters.walkableRadius;\n\trc.maxEdgeLen = parameters.maxEdgeLen;\n\trc.maxSimplificationError = parameters.maxSimplificationError;\n\trc.minRegionArea = parameters.minRegionArea;\n\trc.mergeRegionArea = parameters.mergeRegionArea;\n\trc.maxVertsPerPoly = parameters.maxVertsPerPoly;\n\trc.detailSampleDist = parameters.detailSampleDist;\n\trc.detailSampleMaxError = parameters.detailSampleMaxError;\n\n\tif (!self.navMesh) {\n\t\tself.navMesh = new module.NavMesh();\n\t}\n\tself.navMesh.build(positions, offset, indices, indicesLength, rc);\n\n\tconst navmeshData = navMesh.getNavmeshData();\n\tconst arrView = new Uint8Array(module.HEAPU8.buffer, navmeshData.dataPointer, navmeshData.size);\n\tconst ret = new Uint8Array(navmeshData.size);\n\tret.set(arrView);\n\tnavMesh.freeNavmeshData(navmeshData);\n\n\tpostMessage(ret);\n}\n"])),this._worker=new Worker(this._workerURL)}init(e,t,n){this.gameControl=t,this.eventContext=n,this.setDefaultQueryExtent((new Lv).setScalar(e.ch*e.walkableRadius*1.2)),this._worker.onmessage=()=>{this.createNavMesh(n.page,e,(e=>{this.buildFromNavmeshData(e.data)}))},this.eventContext.renderer.domElement.addEventListener("pointerdown",this.onPointerDown)}createNavMesh(e,t,n){t.objects.forEach((t=>{var n;let i=e.scene.find(t);i.traverseEntity((e=>{e.userData.navmesh=!0})),null===(n=i.cloner)||void 0===n||n.traverseObject((e=>{e.userData.navmesh=!0}))}));let i=[],r=(this.usePhysics?this.traverseWithPhysics:this.traverseNoPhysics)(i,"custom"===t.zones);if(e.traverseChildren(r),t.objects.forEach((t=>{var n;let i=e.scene.find(t);i.traverseEntity((e=>{e.userData.navmesh=void 0})),null===(n=i.cloner)||void 0===n||n.traverseObject((e=>{e.userData.navmesh=void 0}))})),0===i.length)return!1;let s=aL(i),{positions:a,triIndices:o}=iV(s.getAttribute("position"),s.getIndex());return this._worker.postMessage([a,a.length/3,o,o.length,d(d({},S3),t)]),this._worker.onmessage=n,!0}createDebugNavGeometry(){let e,t,n=this.navMesh.getDebugNavMesh(),i=n.getTriangleCount(),r=new Uint32Array(3*i),s=new Float32Array(3*i*3);for(e=0;e<3*i;e++)r[e]=e;for(e=0;e<i;e++)for(t=0;t<3;t++){let i=n.getTriangle(e).getPoint(t);s[9*e+3*t+0]=i.x,s[9*e+3*t+1]=i.y,s[9*e+3*t+2]=i.z}let a=new dx;return a.setIndex(new tx(r,1)),a.setAttribute("position",new tx(s,3)),a}getClosestPoint(e){return w3.x=e.x,w3.y=e.y,w3.z=e.z,this.navMesh.getClosestPoint(w3)}getClosestPointToRef(e,t){w3.x=e.x,w3.y=e.y,w3.z=e.z;let n=this.navMesh.getClosestPoint(w3);t.set(n.x,n.y,n.z)}getRandomPointAround(e,t){return w3.x=e.x,w3.y=e.y,w3.z=e.z,this.navMesh.getRandomPointAround(w3,t)}getRandomPointAroundToRef(e,t,n){w3.x=e.x,w3.y=e.y,w3.z=e.z;let i=this.navMesh.getRandomPointAround(w3,t);n.set(i.x,i.y,i.z)}moveAlong(e,t){return w3.x=e.x,w3.y=e.y,w3.z=e.z,D3.x=t.x,D3.y=t.y,D3.z=t.z,this.navMesh.moveAlong(w3,D3)}moveAlongToRef(e,t,n){return w3.x=e.x,w3.y=e.y,w3.z=e.z,D3.x=t.x,D3.y=t.y,D3.z=t.z,this.navMesh.moveAlong(w3,D3)}computePath(e,t){let n=this.getClosestPoint(t);if(D3.x=n.x,D3.y=n.y,D3.z=n.z,Math.sqrt(Math.pow(t.x-n.x,2)+Math.pow(t.y-n.y,2)+Math.pow(t.z-n.z,2))>this.getDefaultQueryExtent().y)return[];this.getClosestPoint(e);let i=this.navMesh.computePath(w3,D3),r=i.getPointCount(),s=[];for(let a=0;a<r;a++){let e=i.getPoint(a);s.push(new Lv(e.x,e.y,e.z))}return s}createCrowd(e,t){return new A3(this,e,t)}setDefaultQueryExtent(e){w3.x=e.x,w3.y=e.y,w3.z=e.z,this.navMesh.setDefaultQueryExtent(w3)}getDefaultQueryExtent(){return this.navMesh.getDefaultQueryExtent()}buildFromNavmeshData(e){let t=e.length*e.BYTES_PER_ELEMENT,n=this.navmeshWasm._malloc(t),i=new Uint8Array(this.navmeshWasm.HEAPU8.buffer,n,t);i.set(e);let r=new this.navmeshWasm.NavmeshData;r.dataPointer=i.byteOffset,r.size=e.length,this.navMesh.buildFromNavmeshData(r),this.navmeshWasm._free(i.byteOffset)}getNavmeshData(){let e=this.navMesh.getNavmeshData(),t=new Uint8Array(this.navmeshWasm.HEAPU8.buffer,e.dataPointer,e.size),n=new Uint8Array(e.size);return n.set(t),this.navMesh.freeNavmeshData(e),n}getDefaultQueryExtentToRef(e){let t=this.navMesh.getDefaultQueryExtent();e.set(t.x,t.y,t.z)}dispose(){var e;this.navMesh.destroy(),this._worker.terminate(),URL.revokeObjectURL(this._workerURL),null===(e=this.eventContext)||void 0===e||e.renderer.domElement.removeEventListener("pointerdown",this.onPointerDown)}addCylinderObstacle(e,t,n){return w3.x=e.x,w3.y=e.y,w3.z=e.z,this.navMesh.addCylinderObstacle(w3,t,n)}addBoxObstacle(e,t,n){return w3.x=e.x,w3.y=e.y,w3.z=e.z,D3.x=t.x,D3.y=t.y,D3.z=t.z,this.navMesh.addBoxObstacle(w3,D3,n)}removeObstacle(e){this.navMesh.removeObstacle(e)}isSupported(){return void 0!==this.navmeshWasm}},A3=class{constructor(e,t,n){this.navmeshWasmWrapper=e,this.transforms=[],this.agents=new Array,this.reachRadii=new Array,this._agentDestinationArmed=new Array,this._agentDestination=new Array,this.crowd=new this.navmeshWasmWrapper.navmeshWasm.Crowd(t,n,this.navmeshWasmWrapper.navMesh.getNavMesh())}onReachTarget(e,t){}addAgent(e,t,n){let i=new this.navmeshWasmWrapper.navmeshWasm.dtCrowdAgentParams;i.radius=t.radius,i.height=t.height,i.maxAcceleration=t.maxAcceleration,i.maxSpeed=t.maxSpeed,i.collisionQueryRange=t.collisionQueryRange,i.pathOptimizationRange=t.pathOptimizationRange,i.separationWeight=t.separationWeight,i.updateFlags=7,i.obstacleAvoidanceType=0,i.queryFilterType=0,i.userData=0;let r=this.crowd.addAgent(new this.navmeshWasmWrapper.navmeshWasm.Vec3(e.x,e.y,e.z),i);return this.transforms.push(n),this.agents.push(r),this.reachRadii.push(t.reachRadius?t.reachRadius:t.radius),this._agentDestinationArmed.push(!1),this._agentDestination.push(new Lv(0,0,0)),r}getAgentPosition(e){return this.crowd.getAgentPosition(e)}getAgentPositionToRef(e,t){let n=this.crowd.getAgentPosition(e);t.set(n.x,n.y,n.z)}getAgentVelocity(e){return this.crowd.getAgentVelocity(e)}getAgentVelocityToRef(e,t){let n=this.crowd.getAgentVelocity(e);t.set(n.x,n.y,n.z)}getAgentNextTargetPath(e){return this.crowd.getAgentNextTargetPath(e)}getAgentNextTargetPathToRef(e,t){let n=this.crowd.getAgentNextTargetPath(e);t.set(n.x,n.y,n.z)}getAgentState(e){return this.crowd.getAgentState(e)}overOffmeshConnection(e){return this.crowd.overOffmeshConnection(e)}agentGoto(e,t){this.crowd.agentGoto(e,new this.navmeshWasmWrapper.navmeshWasm.Vec3(t.x,t.y,t.z));let n=this.agents.indexOf(e);n>-1&&(this._agentDestinationArmed[n]=!0,this._agentDestination[n].set(t.x,t.y,t.z))}agentTeleport(e,t){this.crowd.agentTeleport(e,new this.navmeshWasmWrapper.navmeshWasm.Vec3(t.x,t.y,t.z))}updateAgentParameters(e,t){let n=this.crowd.getAgentParameters(e);void 0!==t.radius&&(n.radius=t.radius),void 0!==t.height&&(n.height=t.height),void 0!==t.maxAcceleration&&(n.maxAcceleration=t.maxAcceleration),void 0!==t.maxSpeed&&(n.maxSpeed=t.maxSpeed),void 0!==t.collisionQueryRange&&(n.collisionQueryRange=t.collisionQueryRange),void 0!==t.pathOptimizationRange&&(n.pathOptimizationRange=t.pathOptimizationRange),void 0!==t.separationWeight&&(n.separationWeight=t.separationWeight),this.crowd.setAgentParameters(e,n)}removeAgent(e){this.crowd.removeAgent(e);let t=this.agents.indexOf(e);t>-1&&(this.agents.splice(t,1),this.transforms.splice(t,1),this.reachRadii.splice(t,1),this._agentDestinationArmed.splice(t,1),this._agentDestination.splice(t,1))}getAgents(){return this.agents}update(e){if(this.navmeshWasmWrapper.navMesh.update(),e<=.001)return;let t=1/60;{let n=Math.floor(e/t);n>10&&(n=10),n<1&&(n=1);let i=e/n;for(let e=0;e<n;e++)this.crowd.update(i)}for(let n=0;n<this.agents.length;n++){let e=this.agents[n],t=this.getAgentPosition(e);if(this.transforms[n].copy(t),this._agentDestinationArmed[n]){let i=t.x-this._agentDestination[n].x,r=t.z-this._agentDestination[n].z,s=this.reachRadii[n],a=this._agentDestination[n].y-this.reachRadii[n],o=this._agentDestination[n].y+this.reachRadii[n],l=i*i+r*r;t.y>a&&t.y<o&&l<s*s&&(this.onReachTarget(e,this._agentDestination[n]),this._agentDestinationArmed[n]=!1)}}}setDefaultQueryExtent(e){let t=new this.navmeshWasmWrapper.navmeshWasm.Vec3(e.x,e.y,e.z);this.crowd.setDefaultQueryExtent(t)}getDefaultQueryExtent(){return this.crowd.getDefaultQueryExtent()}getDefaultQueryExtentToRef(e){let t=this.crowd.getDefaultQueryExtent();e.set(t.x,t.y,t.z)}getCorners(e){let t,n=this.crowd.getCorners(e),i=n.getPointCount(),r=[];for(t=0;t<i;t++){let e=n.getPoint(t);r.push(new Lv(e.x,e.y,e.z))}return r}dispose(){this.crowd.destroy()}};function M3(e){let t=!1;return e.scene.objects.forEach((n=>{"Page"===n.data.type&&!t&&n.data.publish.gameControlObject&&sR.traverseModuleInstances(e,n.id,((e,n,i)=>{for(let r of i)"GameControl"===r.data.type&&r.data.navmesh.enabled&&(t=!0)}))})),t}var T3={type:"change"},P3={type:"changeZoom"},F3={type:"changePan"},O3={type:"start"},I3={type:"end",changed:!0},k3={type:"end",changed:!1},B3=new Rv,R3=new lv,L3=2*Math.PI,z3=new Lv,N3=new lv,j3=new Lv,U3=new Rv,V3=new py,H3={type:"requestRender"},W3=class extends Yg{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{isPlayMode:!1,isExport:!1};super(),this.object=e,this.domElement=t,this.options=n,this.enabled=!0,this.useKeyEvents=!0,this.enableDamping=!1,this.enableZoom=!0,this.enableRotate=!0,this.enablePan=!0,this.autoRotate=!1,this.rotationLimitsMode=0,this.panLimitsMode=0,this.rotationSoftLimit=2,this.panSoftLimit=2,this.hoverRotatePanMode=0,this.zoomLimitsEnabled=!1,this.mouseButtons=[0,5],this.mouseButtonsPlay=[3,4,5],this.touches=[null,Nm,Lm],this.offset=new Lv,this.eye=new Lv,this.lastPosition=new Lv,this.lastQuaternion=new Rv,this.current=new lv,this.overShoot=new lv,this.overRatio=new lv,this.spherical=new vE,this.sphericalDelta=new vE,this.panOffset=new Lv,this.panLeftV=new Lv,this.panUpV=new Lv,this.panV=new Lv,this.rotateStart=new lv,this.rotateEnd=new lv,this.rotateDelta=new lv,this.panStart=new lv,this.panEnd=new lv,this.panDelta=new lv,this.dollyStart=new lv,this.dollyEnd=new lv,this.dollyDelta=new lv,this.rotationRangeFactor=new lv,this.panRangeFactor=new lv,this.state=-1,this.zoomChanged=!1,this.isPointerDown=!1,this.isThetaFlipped=!1,this.prevScale=0,this.scale=1,this.gesture=!1,this.timer=-1,this.timerHover=-1,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minPhi=0,this.maxPhi=Math.PI,this.minTheta=-1/0,this.maxTheta=1/0,this.minH=0,this.maxH=Math.PI,this.minV=-1/0,this.maxV=1/0,this.autoRotateClockwise=!0,this.isPanOverShoot=!1,this.isRotateOverShoot=!1,this.resetHoverEffectOnPointerLeave=!1,this.hasChange=!1,this.useWindowEvents=!1,this.isTouchZoom=!0,this.autoRotateSpeed=2,this.dampingFactor=.125,this.zoomSpeed=2,this.rotateSpeed=1,this.panSpeed=1,this.hoverRotatePanStrength=.1,this.hoverRotateDamping=this.dampingFactor,this.thetaIsFree=!1,this.phiIsFree=!1,this.needsUpdate=!0,this.onCameraChange=e=>{this.object.removeEventListener("beginState",this.onBeginState),this.object.removeEventListener("completeState",this.onCompleteState),this.object.removeEventListener("cameraChange",this.onCameraChange),this.object=e.camera,this.object.addEventListener("beginState",this.onBeginState),this.object.addEventListener("completeState",this.onCompleteState),this.object.addEventListener("cameraChange",this.onCameraChange)},this.update=()=>{this.object.updateWorldMatrix(!0,!1),this.object.matrixWorld.decompose(j3,U3,z3),this.offset.copy(j3).sub(this.target),this.spherical.setFromVector3(this.offset),this.object.isUpVectorFlipped&&(this.spherical.phi*=-1,this.spherical.theta-=Math.PI),this.autoRotate&&-1===this.state&&this.rotateLeft((!0===this.autoRotateClockwise?1:-1)*this.getAutoRotationAngle()),0!==this.rotationLimitsMode&&this.applyLimits(this.sphericalDelta,this.rotationLimitsMode,this.rotationSoftLimit,this.maxTheta,this.minTheta,this.maxPhi,this.minPhi,this.rotationRangeFactor),2!==this.rotationLimitsMode&&(this.spherical.phi+=this.sphericalDelta.phi),(1!==this.rotationLimitsMode||!0===this.autoRotate)&&(this.spherical.theta+=this.sphericalDelta.theta),this.spherical.radius*=this.scale,this.zoomLimitsEnabled&&this.object.isPerspectiveCamera&&(this.spherical.radius=Math.max(this.minDistance,Math.min(this.maxDistance,this.spherical.radius))),0!==this.panLimitsMode&&(this.target.applyQuaternion(B3.copy(U3).invert()),this.panOffset.applyQuaternion(B3),this.applyLimits(this.panOffset,this.panLimitsMode,this.panSoftLimit,this.maxH,this.minH,this.maxV,this.minV,this.panRangeFactor),this.target.applyQuaternion(U3),this.panOffset.applyQuaternion(U3)),2===this.panLimitsMode&&(this.panOffset.y=0),1===this.panLimitsMode&&(this.panOffset.x=0),-1!==this.state||this.gesture?(this.target.add(this.panOffset),this.panOffset.set(0,0,0)):(this.panOffset.multiplyScalar(1-this.dampingFactor),this.target.add(this.panOffset)),this.offset.setFromSpherical(this.spherical),j3.copy(this.target).add(this.offset),this.object.position.copy(this.target).add(this.offset),this.object.parent&&(V3.copy(this.object.parent.matrixWorld).invert(),this.object.position.applyMatrix4(V3));let e=this.spherical.phi%L3;if(this.eye.copy(this.offset).normalize(),this.object.up.copy(zy.DEFAULT_UP).applyAxisAngle(this.eye,this.object.angleOffsetFromUp),e>0&&e>Math.PI||e<0&&e>-Math.PI?(this.object.up.negate(),this.object.lookAt(this.target),this.object.isUpVectorFlipped=!0):(this.object.lookAt(this.target),this.object.isUpVectorFlipped=!1),-1===this.state||!0===this.enableDamping){let e=1===this.hoverRotatePanMode?this.hoverRotateDamping:this.dampingFactor;this.sphericalDelta.theta*=1-e,this.sphericalDelta.phi*=1-e}else this.sphericalDelta.set(0,0,0);return this.scale=1,this.zoomChanged||this.lastPosition.distanceToSquared(this.object.position)>.01||8*(1-this.lastQuaternion.dot(this.object.quaternion))>1e-8?(this.dispatchEvent(T3),this.object.dispatchEvent(H3),this.lastPosition.copy(this.object.position),this.lastQuaternion.copy(this.object.quaternion),this.zoomChanged=!1,!0):(this.isPanOverShoot=!1,this.isRotateOverShoot=!1,this.object.wasMovedBySwitchCameraAction=!1,this.sphericalDelta.set(0,0,0),this.panOffset.set(0,0,0),!1)},this.onPointerDown=e=>{!1!==this.enabled&&("touch"===e.pointerType||"pen"===e.pointerType&&EF?this.onPointerDownTouch(e):this.onPointerDownMouse(e),-1!==this.state&&(this.isPointerDown=!0,this.dispatchEvent(O3),this.domElement.addEventListener("pointermove",this.onPointerMove),this.domElement.addEventListener("pointerup",this.onPointerUp),e.stopPropagation(),"touch"===e.pointerType||"pen"===e.pointerType&&EF||this.domElement.setPointerCapture(e.pointerId)))},this.onPointerLeave=e=>{this.resetHoverEffectOnPointerLeave&&!this.useWindowEvents?(1===this.hoverRotatePanMode?(this.sphericalDelta.theta=-this.spherical.theta,this.sphericalDelta.phi=-this.spherical.phi,z3.subVectors(this.position0,this.target0),this.spherical.setFromVector3(z3),this.sphericalDelta.theta+=this.spherical.theta,this.sphericalDelta.phi+=this.spherical.phi,this.sphericalDelta.theta/=8,this.sphericalDelta.phi/=8):2===this.hoverRotatePanMode&&this.panOffset.subVectors(this.target0,this.target).divideScalar(8),this.update()):this.pointerLeaveEvent=e},this.onPointerEnter=e=>{this.resetHoverEffectOnPointerLeave||void 0===this.pointerLeaveEvent?N3.set(e.clientX-this.domElement.clientWidth/2,e.clientY-this.domElement.clientHeight/2):N3.set(e.clientX-this.pointerLeaveEvent.clientX,e.clientY-this.pointerLeaveEvent.clientY),1===this.hoverRotatePanMode?(this.rotateDelta.copy(N3).multiplyScalar(this.rotateSpeed*this.hoverRotatePanStrength).rotateAround(R3,-this.object.angleOffsetFromUp),this.rotateLeft(2*Math.PI*this.rotateDelta.x/this.domElement.clientHeight),this.rotateUp(2*Math.PI*this.rotateDelta.y/this.domElement.clientHeight),this.rotateStart.set(e.clientX,e.clientY)):2===this.hoverRotatePanMode&&(this.panDelta.copy(N3).multiplyScalar(this.panSpeed*this.hoverRotatePanStrength),this.pan(this.panDelta.x,this.panDelta.y),this.panStart.set(e.clientX,e.clientY)),this.update()},this.onPointerMove=e=>{!1!==this.enabled&&(this.checkRaycastLock()||("touch"===e.pointerType||"pen"===e.pointerType&&EF?this.onPointerMoveTouch(e):this.onPointerMoveMouse(e),e.stopPropagation()))},this.onPointerUp=e=>{this.isPointerDown=!1,0===FF.length&&(this.domElement.removeEventListener("pointermove",this.onPointerMove),this.domElement.removeEventListener("pointerup",this.onPointerUp)),FF.length>1&&e.preventDefault(),this.hasChange?this.dispatchEvent(I3):this.dispatchEvent(k3),this.state=-1,e&&(e.stopPropagation(),"touch"===e.pointerType||"pen"===e.pointerType&&EF||this.domElement.releasePointerCapture(e.pointerId))},this.onPointerDownMouse=e=>{let t;switch(t=this.useKeyEvents?this.mouseButtons[e.button]:this.mouseButtonsPlay[e.button],t){case 0:if(!0!==e.altKey||e.shiftKey||PF(e)){if(" "===this.key){if(!1===this.enablePan)return;this.handleMouseDownPan(e),this.state=2}}else{if(!1===this.enableRotate)return;this.handleMouseDownRotate(e),this.state=0}break;case 4:if(!1===this.enablePan)return;this.handleMouseDownPan(e),this.state=2;break;case 3:if(PF(e)||e.shiftKey){if(!1===this.enablePan)return;this.handleMouseDownPan(e),this.state=2}else{if(!1===this.enableRotate)return;this.handleMouseDownRotate(e),this.state=0}break;case 5:if(PF(e)||e.shiftKey){if(!1===this.enableRotate)return;this.handleMouseDownRotate(e),this.state=0}else{if(!1===this.enablePan)return;this.handleMouseDownPan(e),this.state=2}break;default:this.state=-1}},this.onPointerMoveMouse=e=>{switch(this.state){case 0:if(!1===this.enableRotate)return;this.handleMouseMoveRotate(e);break;case 1:if(!1===this.enableZoom)return;this.handleMouseMoveDolly(e);break;case 2:if(!1===this.enablePan)return;this.handleMouseMovePan(e)}this.object.wasMovedByUser=!0},this.onPointerDownTouch=e=>{switch(FF.length>1&&e.preventDefault(),this.touches[FF.length-1]){case Rm:if(!1===this.enableRotate)return void(this.state=-1);this.handleTouchStartRotate(),this.state=3;break;case Lm:if(!1===this.enablePan)return void(this.state=-1);this.handleTouchStartPan(),this.state=4;break;case zm:if(!1===this.enableZoom&&!1===this.enablePan)return;this.handleTouchStartDollyPan(),this.state=5;break;case Nm:if(!1===this.enableZoom&&!1===this.enableRotate)return;this.handleTouchStartDollyRotate(),this.state=6;break;default:this.state=-1}},this.onPointerMoveTouch=e=>{switch(FF.length>1&&e.preventDefault(),this.state){case 3:if(!1===this.enableRotate)return;this.handleTouchMoveRotate(e),this.update();break;case 4:if(!1===this.enablePan)return;this.handleTouchMovePan(e),this.update();break;case 5:if(!1===this.enableZoom&&!1===this.enablePan)return;this.handleTouchMoveDollyPan(e),this.update();break;case 6:if(!1===this.enableZoom&&!1===this.enableRotate)return;this.handleTouchMoveDollyRotate(e),this.update();break;default:this.state=-1}this.object.wasMovedByUser=!0},this.dispatchEndDebounced=iF((()=>this.dispatchEvent(I3)),33),this.onMouseWheel=e=>{!1===this.enabled||!1===this.enableZoom&&!1===this.enablePan||this.checkRaycastLock()||(!this.options.isExport&&this.domElement.clientHeight===document.body.clientHeight&&this.domElement.clientWidth===document.body.clientWidth&&e.preventDefault(),this.dispatchEvent(O3),this.handleMouseWheel(e),this.dispatchEndDebounced(),this.object.wasMovedByUser=!0)},this.onGesture=e=>{if(e.preventDefault(),!1!==this.enabled&&!this.checkRaycastLock()&&!_F)if("gesturechange"===e.type){if(!1===this.enableZoom||!1===this.isTouchZoom)return;this.dispatchEvent(O3),e.scale>this.prevScale?this.dollyIn(this.getZoomScale()):e.scale<this.prevScale&&this.dollyOut(this.getZoomScale()),this.prevScale=e.scale,this.update(),this.object.wasMovedByUser=!0}else this.dispatchEvent(I3)},this.onContextMenu=e=>{e.preventDefault()},this.onTouchEnd=e=>{e.preventDefault()},this.onKeyDown=e=>{!1!==this.enabled&&(this.key=e.key," "===e.key&&this.dispatchEvent(O3))},this.onKeyUp=e=>{!1!==this.enabled&&(this.key=void 0,-1!==this.state&&"Alt"===e.key&&this.onPointerUp(FF[0])," "===e.key&&this.dispatchEvent(I3))},this.onPointerHover=e=>{"mouse"!==e.pointerType||!1===this.enabled||-1!==this.state||2===this.hoverRotatePanMode&&this.isPanOverShoot||1===this.hoverRotatePanMode&&this.isRotateOverShoot||(this.isPointerDown=!0,2===this.hoverRotatePanMode?this.handleMouseMovePan(e,this.hoverRotatePanStrength):1===this.hoverRotatePanMode&&this.handleMouseMoveRotate(e,this.hoverRotatePanStrength))},this.onBeginState=()=>{this.enabled=!1,this.needsUpdate=!1},this.onCompleteState=e=>{e.isfromEntity&&this.options.isPlayMode||(this.enabled=!0,this.needsUpdate=!0,this.object.updateUp(),this.object.getTarget(this.target))},this.target=this.object.getTarget(),this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.quat0=this.object.quaternion.clone(),this.isUpVectorFlipped0=this.object.isUpVectorFlipped,this.offset.copy(this.object.position).sub(this.target),this.spherical.setFromVector3(this.offset),this.object.isUpVectorFlipped&&(this.spherical.phi*=-1,this.spherical.theta-=Math.PI),this.initialSphericalRadius=this.spherical.radius,this.addEventListenersToCamera()}dispatchEvent(e){"start"===e.type?this.hasChange=!1:this.hasChange=!0,super.dispatchEvent(e)}addEventListenersToCamera(){this.object.addEventListener("beginState",this.onBeginState),this.object.addEventListener("completeState",this.onCompleteState),this.object.addEventListener("cameraChange",this.onCameraChange)}removeEventListenersFromCamera(){this.object.removeEventListener("beginState",this.onBeginState),this.object.removeEventListener("completeState",this.onCompleteState),this.object.removeEventListener("cameraChange",this.onCameraChange)}updateUseWindowEvents(e){if(window.removeEventListener("pointermove",this.onPointerHover),this.domElement.removeEventListener("pointermove",this.onPointerHover),this.useWindowEvents=e,0!==this.hoverRotatePanMode&&(this.useWindowEvents?window.addEventListener("pointermove",this.onPointerHover):this.domElement.addEventListener("pointermove",this.onPointerHover)),this.domElement.removeEventListener("pointerleave",this.onPointerLeave),this.domElement.removeEventListener("pointerenter",this.onPointerEnter),window.removeEventListener("pointerleave",this.onPointerLeave),window.removeEventListener("pointerenter",this.onPointerEnter),0!==this.hoverRotatePanMode&&!this.useWindowEvents){let e=this.useWindowEvents?window:this.domElement;e.addEventListener("pointerleave",this.onPointerLeave),e.addEventListener("pointerenter",this.onPointerEnter)}}fromJSON(e,t){var n,i;this.setEnableDampingSpeed(e.enableDamping),this.enablePan=e.enablePan,this.enableZoom=e.enableZoom,this.enableRotate=e.enableRotate,this.rotationLimitsMode=e.rotationLimitsMode,this.thetaIsFree=e.rotationHorizontalOffset.min===e.rotationHorizontalOffset.max&&e.rotationHorizontalOffset.min===Math.PI,this.phiIsFree=e.rotationVerticalOffset.min===e.rotationVerticalOffset.max&&e.rotationVerticalOffset.min===Math.PI,this.panLimitsMode=e.panLimitsMode,this.panSoftLimit=e.panSoftLimit,this.rotationSoftLimit=e.rotationSoftLimit,this.hoverRotatePanMode=e.hoverRotatePanMode,this.hoverRotateDamping=null!==(n=e.hoverRotateDamping)&&void 0!==n?n:this.dampingFactor,this.useWindowEvents="window"===t,0!==this.hoverRotatePanMode&&(this.useWindowEvents?window.addEventListener("pointermove",this.onPointerHover):this.domElement.addEventListener("pointermove",this.onPointerHover));let r=e.hoverRotatePanStrength/100;this.hoverRotatePanStrength=r**2,this.zoomLimitsEnabled=e.zoomLimitsEnabled,this.minZoom=e.zoomLimits.min,this.maxZoom=Math.max(e.zoomLimits.min,e.zoomLimits.max),this.minDistance=1e3/e.zoomLimits.max,this.maxDistance=Math.max(this.minDistance,1e3/e.zoomLimits.min),this.autoRotate=e.autoRotate,this.autoRotateSpeed=e.autoRotateSpeed,this.autoRotateClockwise=e.autoRotateClockwise;let s=this.object.getTarget().applyQuaternion(B3.copy(this.object.quaternion).invert());this.minV=-e.panVerticalOffset.min+s.y,this.maxV=e.panVerticalOffset.max+s.y,this.minH=-e.panHorizontalOffset.min+s.x,this.maxH=e.panHorizontalOffset.max+s.x,this.panRangeFactor.set(this.maxH-this.minH,this.maxV-this.minV).divideScalar(2),this.rotationRangeFactor.setScalar(Math.PI).divideScalar(4),this.minPhi=G3(this.spherical.phi-e.rotationVerticalOffset.min),this.maxPhi=G3(this.spherical.phi+e.rotationVerticalOffset.max),this.minTheta=G3(G3(this.spherical.theta)-e.rotationHorizontalOffset.min),this.maxTheta=G3(G3(this.spherical.theta)+e.rotationHorizontalOffset.max),this.isThetaFlipped=this.minTheta>this.maxTheta,1===e.orbitTouches&&(this.touches[0]=Rm),1===e.panTouches&&(this.touches[0]=Lm),2===e.orbitTouches&&(this.touches[1]=Nm),2===e.panTouches&&(this.touches[1]=zm),3===e.orbitTouches&&(this.touches[2]=Rm),3===e.panTouches&&(this.touches[2]=Lm),this.isTouchZoom=e.isTouchZoom,this.resetHoverEffectOnPointerLeave=null!==(i=e.resetHoverEffectOnPointerLeave)&&void 0!==i&&i}connect(){if(this.domElement.addEventListener("contextmenu",this.onContextMenu),this.domElement.addEventListener("pointerdown",this.onPointerDown),this.domElement.addEventListener("wheel",this.onMouseWheel),window.addEventListener("keydown",this.onKeyDown,!1),window.addEventListener("keyup",this.onKeyUp,!1),this.domElement.addEventListener("gesturestart",this.onGesture),this.domElement.addEventListener("gesturechange",this.onGesture),this.domElement.addEventListener("gestureend",this.onGesture),this.domElement.addEventListener("touchend",this.onTouchEnd),0!==this.hoverRotatePanMode&&!this.useWindowEvents){let e=this.useWindowEvents?window:this.domElement;e.addEventListener("pointerleave",this.onPointerLeave),e.addEventListener("pointerenter",this.onPointerEnter)}this.pointerLeaveEvent=void 0}dispose(){this.removeEventListenersFromCamera(),this.domElement.removeEventListener("contextmenu",this.onContextMenu),this.domElement.removeEventListener("pointerdown",this.onPointerDown),this.domElement.removeEventListener("wheel",this.onMouseWheel),window.removeEventListener("keydown",this.onKeyDown,!1),window.removeEventListener("keyup",this.onKeyUp,!1),this.domElement.removeEventListener("pointermove",this.onPointerHover),window.removeEventListener("pointermove",this.onPointerHover),this.domElement.removeEventListener("gesturestart",this.onGesture),this.domElement.removeEventListener("gesturechange",this.onGesture),this.domElement.removeEventListener("gestureend",this.onGesture),this.domElement.removeEventListener("touchend",this.onTouchEnd),this.domElement.removeEventListener("pointerleave",this.onPointerLeave),this.domElement.removeEventListener("pointerenter",this.onPointerEnter),window.removeEventListener("pointerleave",this.onPointerLeave),window.removeEventListener("pointerenter",this.onPointerEnter),this.domElement.removeEventListener("pointermove",this.onPointerMove),this.domElement.removeEventListener("pointerup",this.onPointerUp)}applyLimits(e,t,n,i,r,s,a,o){let l,u,c;this.overShoot.set(0,0),e instanceof Lv?(l=e.x,u=e.y,this.current.set(this.target.x,this.target.y),c=!0):(l=e.theta,u=e.phi,this.current.set(G3(this.spherical.theta),G3(this.spherical.phi)),c=!1),0===n&&(this.current.x+=l,this.current.y+=u),(3===t||2===t)&&(!c&&this.isThetaFlipped?this.current.x>i&&this.current.x<0?this.overShoot.x=i-this.current.x:this.current.x<r&&this.current.x>0&&(this.overShoot.x=r-this.current.x):this.current.x>i?this.overShoot.x=i-this.current.x:this.current.x<r&&(this.overShoot.x=r-this.current.x)),(3===t||1===t)&&(this.current.y>s?this.overShoot.y=s-this.current.y:this.current.y<a&&(this.overShoot.y=a-this.current.y)),c||(this.overShoot.x=G3(this.overShoot.x),this.overShoot.y=G3(this.overShoot.y)),0!==n?(this.overRatio.copy(this.overShoot).divide(o),this.overRatio.x=Math.min(Math.abs(this.overRatio.x),1),this.overRatio.y=Math.min(Math.abs(this.overRatio.y),1),1===n&&(this.overRatio.x=q3(Math.abs(this.overRatio.x)),this.overRatio.y=q3(Math.abs(this.overRatio.y))),this.isPointerDown||1===n?2===n&&(this.overRatio.x>.9&&!this.thetaIsFree||this.overRatio.y>.9&&!this.phiIsFree)?this.isPointerDown=!1:(l*this.overShoot.x<0&&!this.thetaIsFree&&(l*=1-this.overRatio.x),u*this.overShoot.y<0&&!this.phiIsFree&&(u*=1-this.overRatio.y)):2===n&&(!c&&(this.overRatio.x>.002&&!this.thetaIsFree||this.overRatio.y>.002&&!this.phiIsFree)||c&&(Math.abs(this.overShoot.x)>2||Math.abs(this.overShoot.y)>2)?(this.thetaIsFree||(l=.05*this.overShoot.x),this.phiIsFree||(u=.05*this.overShoot.y),c?this.isPanOverShoot=!0:this.isRotateOverShoot=!0):c?this.isPanOverShoot=!1:this.isRotateOverShoot=!1)):(l+=this.overShoot.x,u+=this.overShoot.y),e instanceof Lv?(e.x=l,e.y=u):(this.thetaIsFree||(e.theta=l),this.phiIsFree||(e.phi=u))}setEnableDampingSpeed(e){this.enableDamping=e,this.rotateSpeed=!0===e?.2:1}stopDamping(){this.sphericalDelta.theta=0,this.sphericalDelta.phi=0}getAutoRotationAngle(){return 2*Math.PI/60/60*this.autoRotateSpeed}getZoomScale(){return Math.pow(.95,this.zoomSpeed)}rotateLeft(e){this.sphericalDelta.theta-=e}rotateUp(e){this.sphericalDelta.phi-=e}panLeft(e,t){this.panLeftV.setFromMatrixColumn(t,0),this.panLeftV.multiplyScalar(-e),this.panOffset.add(this.panLeftV)}panUp(e,t){this.panUpV.setFromMatrixColumn(t,1),this.panUpV.multiplyScalar(e),this.panOffset.add(this.panUpV)}pan(e,t){let n=this.domElement;if(n&&this.object.isPerspectiveCamera){let i=this.object.position;this.panV.copy(i).sub(this.target);let r=this.panV.length();r*=Math.tan(this.object.fov/2*Math.PI/180),this.panLeft(2*e*r/n.clientHeight,this.object.matrixWorld),this.panUp(2*t*r/n.clientHeight,this.object.matrixWorld)}else n&&this.object.isOrthographicCamera&&(this.panLeft(e*(this.object.right-this.object.left)/this.object.zoom/n.clientWidth,this.object.matrixWorld),this.panUp(t*(this.object.top-this.object.bottom)/this.object.zoom/n.clientHeight,this.object.matrixWorld));this.dispatchEvent(F3)}dollyOut(e){this.object.isPerspectiveCamera?this.scale/=e:this.object.isOrthographicCamera&&(this.object.zoom*=e,this.zoomLimitsEnabled&&(this.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom))),this.object.updateProjectionMatrix(),this.zoomChanged=!0),this.dispatchEvent(P3)}dollyIn(e){this.object.isPerspectiveCamera?this.scale*=e:this.object.isOrthographicCamera&&(this.object.zoom/=e,this.zoomLimitsEnabled&&(this.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom))),this.object.updateProjectionMatrix(),this.zoomChanged=!0),this.dispatchEvent(P3)}zoomOut(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getZoomScale();this.dispatchEvent(O3),this.dollyOut(e),this.dispatchEvent(I3)}zoomIn(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getZoomScale();this.dispatchEvent(O3),this.dollyIn(e),this.dispatchEvent(I3)}setZoom(e){if(this.dispatchEvent(O3),this.object.isPerspectiveCamera){let t=this.initialSphericalRadius/e/this.spherical.radius;this.scale=t}else this.object.isOrthographicCamera&&(this.object.zoom=e,this.zoomLimitsEnabled&&(this.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom))),this.object.updateProjectionMatrix(),this.zoomChanged=!0);this.dispatchEvent(I3)}handleMouseDownRotate(e){this.rotateStart.set(e.clientX,e.clientY)}handleMouseDownDolly(e){this.dollyStart.set(e.clientX,e.clientY)}handleMouseDownPan(e){this.panStart.set(e.clientX,e.clientY)}handleMouseMoveRotate(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;void 0!==e.movementX?this.rotateDelta.set(e.movementX,e.movementY):(this.rotateEnd.set(e.clientX,e.clientY),this.rotateDelta.subVectors(this.rotateEnd,this.rotateStart),this.rotateStart.copy(this.rotateEnd)),this.rotateDelta.multiplyScalar(this.rotateSpeed*t).rotateAround(R3,-this.object.angleOffsetFromUp);let n=this.domElement,i=this.useWindowEvents?window.innerHeight:n.clientHeight,r=2*Math.PI*this.rotateDelta.x/i,s=2*Math.PI*this.rotateDelta.y/i;this.rotateLeft(r),this.rotateUp(s),this.update()}handleMouseMoveDolly(e){this.dollyEnd.set(e.clientX,e.clientY),this.dollyDelta.subVectors(this.dollyEnd,this.dollyStart),this.dollyDelta.y>0?this.dollyOut(this.getZoomScale()):this.dollyDelta.y<0&&this.dollyIn(this.getZoomScale()),this.dollyStart.copy(this.dollyEnd),this.update()}handleMouseMovePan(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;void 0!==e.movementX?this.panDelta.set(e.movementX,e.movementY):(this.panEnd.set(e.clientX,e.clientY),this.panDelta.subVectors(this.panEnd,this.panStart),this.panStart.copy(this.panEnd)),this.panDelta.multiplyScalar(this.panSpeed*t),this.pan(this.panDelta.x,this.panDelta.y),this.update()}handleMouseWheel(e){if(!1===SF&&!1===PF(e)&&!0===function(e){return 0===e.wheelDeltaY||0===e.deltaY?!(DF&&e.shiftKey&&Math.abs(e.wheelDeltaX)>=120)&&(e.wheelDeltaX?e.wheelDeltaX===-3*e.deltaX||e.wheelDeltaX===-3*window.devicePixelRatio*e.deltaX:0===e.deltaMode):e.wheelDeltaY?e.wheelDeltaY===-3*e.deltaY||e.wheelDeltaY===-3*window.devicePixelRatio*e.deltaY:0===e.deltaMode}(e)){if(!1===this.enablePan)return;this.gesture?(this.panDelta.set(-e.deltaX,-e.deltaY).multiplyScalar(this.panSpeed),this.panDelta.x=Math.min(Math.abs(this.panDelta.x),100)*(this.panDelta.x<0?-1:1),this.panDelta.y=Math.min(Math.abs(this.panDelta.y),100)*(this.panDelta.y<0?-1:1),e.altKey?this.pan(0,this.panDelta.y):e.shiftKey?this.pan(this.panDelta.x,0):this.pan(this.panDelta.x,this.panDelta.y),this.update()):(this.gesture=!0,this.isPointerDown=!0),window.clearTimeout(this.timer),this.timer=window.setTimeout((()=>{this.gesture=!1,this.isPointerDown=!1}),30)}else{if(!1===this.enableZoom||this.gesture)return;0===e.deltaY?e.deltaX<0?this.dollyIn(this.getZoomScale()):e.deltaX>0&&this.dollyOut(this.getZoomScale()):e.deltaY<0?this.dollyIn(this.getZoomScale()):e.deltaY>0&&this.dollyOut(this.getZoomScale()),this.update(),this.gesture=!1,this.isPointerDown=!1}}handleTouchStartRotate(){if(2===FF.length){let e=.5*(FF[0].pageX+FF[1].pageX),t=.5*(FF[0].pageY+FF[1].pageY);this.rotateStart.set(e,t)}else this.rotateStart.set(FF[0].pageX,FF[0].pageY)}handleTouchStartPan(){if(2===FF.length){let e=.5*(FF[0].pageX+FF[1].pageX),t=.5*(FF[0].pageY+FF[1].pageY);this.panStart.set(e,t)}else this.panStart.set(FF[0].pageX,FF[0].pageY)}handleTouchStartDolly(){let e=FF[0].pageX-FF[1].pageX,t=FF[0].pageY-FF[1].pageY,n=Math.sqrt(e*e+t*t);this.dollyStart.set(0,n)}handleTouchStartDollyPan(){this.enableZoom&&!0===this.isTouchZoom&&this.handleTouchStartDolly(),this.enablePan&&this.handleTouchStartPan()}handleTouchStartDollyRotate(){this.enableZoom&&!0===this.isTouchZoom&&this.handleTouchStartDolly(),this.enableRotate&&this.handleTouchStartRotate()}handleTouchMoveRotate(e){if(2===FF.length){let t=zF(e),n=.5*(e.pageX+t.x),i=.5*(e.pageY+t.y);this.rotateEnd.set(n,i)}else{if(e.pointerId!==FF[0].pointerId)return;this.rotateEnd.set(e.pageX,e.pageY)}this.rotateDelta.subVectors(this.rotateEnd,this.rotateStart).multiplyScalar(this.rotateSpeed);let t=this.domElement;t&&(this.rotateLeft(2*Math.PI*this.rotateDelta.x/t.clientHeight),this.rotateUp(2*Math.PI*this.rotateDelta.y/t.clientHeight)),this.rotateStart.copy(this.rotateEnd)}handleTouchMovePan(e){if(2===FF.length){let t=zF(e),n=.5*(e.pageX+t.x),i=.5*(e.pageY+t.y);this.panEnd.set(n,i)}else{if(e.pointerId!==FF[0].pointerId)return;this.panEnd.set(e.pageX,e.pageY)}this.panDelta.subVectors(this.panEnd,this.panStart).multiplyScalar(this.panSpeed),this.pan(this.panDelta.x,this.panDelta.y),this.panStart.copy(this.panEnd)}handleTouchMoveDolly(e){let t=zF(e),n=e.pageX-t.x,i=e.pageY-t.y,r=Math.sqrt(n*n+i*i);this.dollyEnd.set(0,r),this.dollyDelta.set(0,Math.pow(this.dollyEnd.y/this.dollyStart.y,this.zoomSpeed)),this.dollyOut(this.dollyDelta.y),this.dollyStart.copy(this.dollyEnd)}handleTouchMoveDollyPan(e){this.enableZoom&&!0===this.isTouchZoom&&this.handleTouchMoveDolly(e),this.enablePan&&this.handleTouchMovePan(e)}handleTouchMoveDollyRotate(e){this.enableZoom&&!0===this.isTouchZoom&&this.handleTouchMoveDolly(e),this.enableRotate&&this.handleTouchMoveRotate(e)}checkRaycastLock(){if(this.object.data.raycastLock){if(this.options.isPlayMode)return!1;{var e;let t=null===(e=this.options)||void 0===e?void 0:e.showCameraLock;return t&&t(),!0}}return!1}};function G3(e){let t=2*Math.PI;for(;e<=-Math.PI;)e+=t;for(;e>Math.PI;)e-=t;return e}function q3(e){return 1-Math.pow(1-e,4)}var Y3,X3=class{constructor(e,t,n,i,r,s){this.id=e,this.data=t,this.object=n,this.page=i,this.currentIntersectedObjects=[],this.actions=i1(t,t.actions,i,r,s,n),this.target=t.target,this.triggeringObjects=[];for(let a of t.triggeringObjects){let e=i.scene.find(a);e&&this.triggeringObjects.push(e)}}isValidTriggeringObject(e){return"all"===this.target||this.triggeringObjects.some((t=>t===e||t.isAncestorOf(e.uuid)||e.isAncestorOf(t.uuid)))}disconnect(){r1(this.actions)}dispatch(){this.object.destroyedInAction||(this.actions.Transition.forEach((e=>{e.object.currentTransitionEvent!==this&&(e.object.currentTransitionEvent=this,e.init())})),this.object.dispatchEvent({type:"beginEvent",eventName:"Trigger"}),this.actions.Transition.forEach((e=>{"Toggle"===e.data.runMode?e.toggle():e.play()})),this.actions.SwitchCamera.forEach((e=>{"Toggle"===e.data.runMode?e.toggle():e.play()})),this.actions.Link.forEach((e=>{e.dispatch()})),this.actions.Reset.forEach((e=>{e.dispatch()})),this.actions.Create.forEach((e=>{e.dispatch()})),this.actions.Destroy.forEach((e=>{e.dispatch(!1)})),this.actions.Audio.forEach((e=>{e.dispatchBasic()})),this.actions.Particles.forEach((e=>{e.dispatchBasic()})),this.actions.Video.forEach((e=>{e.dispatchBasic()})),this.actions.SceneTransition.forEach((e=>{e.dispatch()})),this.actions.SetVariable.forEach((e=>e.checkConditions())),this.actions.SetVariable.forEach((e=>e.dispatch())),this.actions.DynamicVariablePlay.forEach((e=>e.dispatch())),this.actions.ClearLocalStorage.forEach((e=>e.dispatch())),this.actions.UserAPI.forEach((e=>e.dispatch())))}};YF.then((e=>Y3=e));var Q3=new Lv,K3=new Rv,Z3=new Lv,J3=new _y(0,0,0,"YXZ"),$3=new _y(0,0,0,"XYZ"),e4=new Lv,t4=new Lv,n4=new Lv(1,1,1),i4=new Rv,r4=new py,s4=new py,a4={type:"updateMatrix"},o4=new Rv,l4=new ry,u4={type:"beginEvent",eventName:"Collision"},c4={type:"beginEvent",eventName:"Trigger"};var h4=e=>e.states.some((e=>void 0!==e.data.position||void 0!==e.data.rotation||void 0!==e.data.hiddenMatrix||void 0!==e.data.cloner||void 0!==e.data.pathSnapping)),d4=class{constructor(e){this.eventContext=e,this.isEnabled=!1,this.gameControl=null,this.joysticks=[],this.joystickToGameControls=[],this.sharedGameControlGlobals={entitiesWithTransformAnim:[],entityToCollisionEvents:{},colliderToEntity:new Map,triggers:[],gamePads:[],createdObjects:[],nCreatedPerAction:{}},this.sensorToTriggerEvent={},this.eventManager=void 0,this.needsCollisionDetection=!1,this.initializationCounter=-1,this.rigidBodyToMesh=new Map,this.nActiveRigidBodies=0,this.collisionEvents=[],this.isExport=!1,this.processRigidBody=e=>{if(e.bodyType()!==Y3.RigidBodyType.Dynamic)return;e.isSleeping()||this.nActiveRigidBodies++;let[t,n,i]=this.rigidBodyToMesh.get(e.handle);if(Q3.copy(e.translation()).multiplyScalar(this.pixelsPerMeter),K3.copy(e.rotation()),t.matrixWorld.compose(Q3,K3,n),t.hasNonUniformScale&&t.matrixWorld.multiply(t.shearScale),t.dispatchEvent(a4),i){let e=t.cloner;if(e&&void 0===e.objectForSample){e.matrixWorld.copy(t.matrixWorld);for(let t of e.children)t.updateMatrixWorld(!0)}for(let n of t.children)n.updateMatrixWorld(!0)}},this.accumulator=0,this.handleCollisionEvents=(e,t,n)=>{var i,r;if(!1===n)return;let s,a;if(this.sensorToTriggerEvent[e]?(s=this.sensorToTriggerEvent[e],a=this.sharedGameControlGlobals.colliderToEntity.get(t)):this.sensorToTriggerEvent[t]&&(s=this.sensorToTriggerEvent[t],a=this.sharedGameControlGlobals.colliderToEntity.get(e)),s&&a&&s.isValidTriggeringObject(a))s.dispatch();else{for(let n=this.sharedGameControlGlobals.createdObjects.length-1;n>=0;n--){var o,l;let i=this.sharedGameControlGlobals.createdObjects[n];if(i.userData.hasCollisionDestroy&&((null===(o=i.rigidBody)||void 0===o?void 0:o.collider(0).handle)===e||(null===(l=i.rigidBody)||void 0===l?void 0:l.collider(0).handle)===t)){this.sharedGameControlGlobals.createdObjects.splice(n,1),i.removeFromParent(),requestAnimationFrame((()=>{var e;return null===(e=this.sharedGameControlGlobals.rapierWorld)||void 0===e?void 0:e.removeRigidBody(i.rigidBody)}));break}}if(void 0!==(null===(i=this.gameControl)||void 0===i?void 0:i.object)&&this.gameControl.object===this.sharedGameControlGlobals.colliderToEntity.get(e)){let e=this.sharedGameControlGlobals.colliderToEntity.get(t),n=this.sharedGameControlGlobals.entityToCollisionEvents[e.uuid];if(void 0===n)return;for(let i of n)"character"===i.data.target&&this.dispatchCollisionEvent(i,e,t)}else if(void 0!==(null===(r=this.gameControl)||void 0===r?void 0:r.object)&&this.gameControl.object===this.sharedGameControlGlobals.colliderToEntity.get(t)){let t=this.sharedGameControlGlobals.colliderToEntity.get(e),n=this.sharedGameControlGlobals.entityToCollisionEvents[t.uuid];if(void 0===n)return;for(let i of n)"character"===i.data.target&&this.dispatchCollisionEvent(i,t,e)}else{let n=this.sharedGameControlGlobals.colliderToEntity.get(e),i=this.sharedGameControlGlobals.entityToCollisionEvents[n.uuid];if(void 0!==i)for(let t of i)"scene"===t.data.target&&this.dispatchCollisionEvent(t,n,e);let r=this.sharedGameControlGlobals.colliderToEntity.get(t),s=this.sharedGameControlGlobals.entityToCollisionEvents[null===r||void 0===r?void 0:r.uuid];if(void 0!==s)for(let e of s)"scene"===e.data.target&&this.dispatchCollisionEvent(e,r,t)}}},this.isExport=e.isExport,this.sharedAssets=e.sharedAssets,this.renderer=e.renderer,this.requestRender=e.requestRender,this.domElement=this.renderer.domElement,this.pixelsPerMeter=200,this.gravity=this.page.data.globalPhysics.gravity}get page(){return this.eventContext.page}attachVRControllers(e){e.forEach((e=>{e.addEventListener("connected",(e=>{"gamepad"in e.data&&"axes"in e.data.gamepad&&this.sharedGameControlGlobals.gamePads.push(e.data.gamepad)}))}))}markIsDestroyTarget(){this.page.traverseVisibleEntity((e=>{let t=e.dataPatched;for(let i of t.events){var n;if(!0===i.data.disabled)continue;let e=null===(n=i.data.actions)||void 0===n||null===(n=n.find((e=>"Destroy"===e.data.type)))||void 0===n?void 0:n.data;if(e)for(let t of e.objects){let e=this.page.scene.find(t);e&&(e.userData.hasDestroy=!0)}}}))}markIsDragObject(){this.page.traverseVisibleEntity((e=>{let t=e.dataPatched;for(let n of t.events)if(!0!==n.data.disabled&&"DragDrop"===n.data.type)for(let e of n.data.objects){let t=this.page.scene.find(e);t&&(t.userData.hasDrag=!0)}}))}initBVH(){let e=[];if(this.page.traverseChildren((t=>{var n,i;let r;if(t instanceof pY||t instanceof XY||t instanceof AZ)return;r=t instanceof Vz?t.object:t;let s=r.dataPatched;if("visibility"===(null===(n=s.physics)||void 0===n?void 0:n.enabled)?!s.visible:null===(i=s.physics)||void 0===i||!i.enabled)return!0;let a=t.geometry,o=!0===r.userData.hasDestroy,l=!0===r.userData.hasDrag;if(h4(s)||o||l||r.dataPatched.events.some((e=>!0!==e.data.disabled&&("GameControl"===e.data.type||"Follow"===e.data.type))))return t.updateMatrixWorldSVD(),this.addBoundsTree(t),!0;a&&e.push(V1(a,t.matrixWorld))})),e.length>0){let t=aL(e,!1);this.sharedGameControlGlobals.staticMeshBVH=new Dz(t)}}addRigidBody(e,t,n){if(U1(e.matrixWorld))return;let i=[],r="geometry"in e?e.geometry:void 0,s=t.dataPatched;if(void 0!==(null===r||void 0===r?void 0:r.getAttribute("position"))&&i.push(V1(r,e.shearScale)),s.physics.fusedBody){let t=this.gatherChildrenGeom(e,i);e.traverseObject(t),e.children.forEach((e=>e.updateMatrixWorld(!0)));let n=e.cloner;n&&void 0===n.objectForSample&&"dynamic"===s.physics.rigidBody&&(n.traverseObject(t),n.children.forEach((e=>e.updateMatrixWorld(!0))))}if(i.length>0){let l,u=!n.fromCreate&&"dynamic"===s.physics.rigidBody||n.fromCreate&&n.dynamic;u?(l=Y3.RigidBodyDesc.dynamic(),l.setLinearDamping(s.physics.damping).setAngularDamping(s.physics.damping).setAdditionalMass(1e-9).setGravityScale(s.physics.gravityScale).enabledRotations(...s.physics.enabledRotation).enabledTranslations(...s.physics.enabledTranslation)):(n.hasTransformAnim||n.hasFollow||n.hasDrag)&&!n.fromCreate?(l=Y3.RigidBodyDesc.kinematicPositionBased(),this.sharedGameControlGlobals.entitiesWithTransformAnim.push(e)):l=Y3.RigidBodyDesc.fixed();let c=aL(i);(e.hasNonUniformScale?e.matrixWorldRigid:e.matrixWorld).decompose(Q3,K3,Z3),e.position0=Q3.clone().divideScalar(this.pixelsPerMeter),e.rotation0=K3.clone(),Q3.divideScalar(this.pixelsPerMeter),l.setTranslation(Q3.x,Q3.y,Q3.z).setRotation(K3),r?null===c||void 0===c||c.scale(1/this.pixelsPerMeter,1/this.pixelsPerMeter,1/this.pixelsPerMeter):null===c||void 0===c||c.scale(Z3.x/this.pixelsPerMeter,Z3.y/this.pixelsPerMeter,Z3.z/this.pixelsPerMeter);let h=this.sharedGameControlGlobals.rapierWorld.createRigidBody(l);u&&this.rigidBodyToMesh.set(h.handle,[e,Z3.clone(),s.physics.fusedBody]);let d=!(void 0===s.geometry||"SubdivGeometry"===s.geometry.type||"NonParametricGeometry"===s.geometry.type||"BooleanGeometry"===s.geometry.type||"VectorGeometry"===s.geometry.type||"StarGeometry"===s.geometry.type||"RectangleGeometry"===s.geometry.type||"EllipseGeometry"===s.geometry.type||"TriangleGeometry"===s.geometry.type||"TorusGeometry"===s.geometry.type||"HelixGeometry"===s.geometry.type);try{this.addCollider(h,s.physics,c,t,d)}catch(a){try{this.addCollider(h,s.physics,c,t,!1)}catch(o){console.error(o)}}e.rigidBody=h}}addBoundsTree(e){var t,n;let i=[];if(void 0!==(null===(t=e.geometry)||void 0===t?void 0:t.getAttribute("position"))&&(null===(n=e.geometry)||void 0===n?void 0:n.getAttribute("position").count)>0&&i.push(V1(e.geometry,e.shearScale)),e.traverseObject(this.gatherChildrenGeom(e,i)),e.children.forEach((e=>e.updateMatrixWorld(!0))),i.length>0){let t=aL(i,!1);e.bvhGeometry=t,t.getAttribute("position").count>0&&(e.bvhGeometry.boundsTree=new Dz(t),this.sharedGameControlGlobals.entitiesWithTransformAnim.push(e))}}addCollider(e,t,n,i){var r,s;let a,o=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];if(0===(null===n||void 0===n?void 0:n.getAttribute("position").count)||0===(null===n||void 0===n||null===(r=n.getIndex())||void 0===r?void 0:r.count))return;n&&(a="trimesh"===t.colliderType?Y3.ColliderDesc.trimesh(n.getAttribute("position").array,n.getIndex().array):Y3.ColliderDesc.convexMesh(n.getAttribute("position").array,o?n.getIndex().array:void 0)),a.setFrictionCombineRule(Y3.CoefficientCombineRule.Average).setRestitutionCombineRule(Y3.CoefficientCombineRule.Average).setDensity(t.density).setFriction(t.friction).setRestitution(t.restitution);let l=this.sharedGameControlGlobals.rapierWorld.createCollider(a,e);this.sharedGameControlGlobals.colliderToEntity.set(l.handle,i),(null===(s=this.sharedGameControlGlobals.entityToCollisionEvents[i.uuid])||void 0===s?void 0:s.some((e=>"scene"===e.target)))&&l.setActiveEvents(Y3.ActiveEvents.COLLISION_EVENTS)}gatherChildrenGeom(e,t){return(n,i)=>{var r;if(0===i)return;let s;if(n instanceof pY){if(!n.objectForSample)return!0===n.object.dataPatched.physics.fusedBody&&"dynamic"===n.object.dataPatched.physics.rigidBody||void 0;if(n.objectForSample.dataPatched.physics.fusedBody)return;s=n.object}else if(n instanceof Vz)s=n.object;else if(s=n,null!==(r=s.dataPatched.cloner)&&void 0!==r&&r.hideBase)return!0;let a=s.dataPatched;if("visibility"===a.physics.enabled?!a.visible:!a.physics.enabled)return!0;1===i?e.hasNonUniformScale?n.matrixWorld.multiplyMatrices(e.shearScale,n.hiddenMatrix):n.matrixWorld.copy(n.hiddenMatrix):n.matrixWorld.multiplyMatrices(n.parent.matrixWorld,n.hiddenMatrix),n.matrixWorld.multiply(n.matrix);let o=n.geometry;void 0!==(null===o||void 0===o?void 0:o.getAttribute("position"))&&t.push(V1(o,n.matrixWorld))}}activate(e){if(this.isEnabled)return;this.isEnabled=!0,this.eventManager=e,this.usePhysics=this.page.data.globalPhysics.usePhysics;let t=this.page.playCamera,n=!1,i=5,r=8,s=9,a="drag",o=this.page.data.publish.gameControlObject,l=null!==o?this.page.find(o):null,u=null;if(l)for(let d of l.data.events){if(d.data.disabled||"GameControl"!==d.data.type)continue;let e=l;for(;this.usePhysics&&null!==(null===(c=e=e.parent)||void 0===c?void 0:c.parent);){var c,h;null===(h=e.data.physics)||void 0===h||h.fusedBody}d.data.collisionEnabled&&(this.needsCollisionDetection=!0),null===u&&(u=d.data)}if(this.page.traverseEntity((e=>{for(let t of e.dataPatched.events)if(!1===t.data.disabled&&"Trigger"===t.data.type)return this.needsCollisionDetection=!0,!0})),l&&u&&(!0===l.data.visible||!0===l.data.physics.enabled)){n=n||u.camera===t.uuid||l.uuid===t.uuid;let e=new N1(l,this.renderer.domElement,u,this.eventContext.page.data.globalPhysics,this,l.uuid!==t.uuid&&u.camera===t.uuid,t,this.page,this.sharedAssets);this.gameControl=e,i=u.joystickPosLoc,r=u.joystickRotLoc,s=u.jumpTouchButtonLoc,a=u.rotByTouch,EF&&u.touchControl&&(this.joystickToGameControls[i]="pos","walk"===u.moveMode&&(this.joystickToGameControls[s]="jmp"),"joystick"===a&&(this.joystickToGameControls[r]="rot"))}if(this.gameControl&&this.gameControl.data.navmesh.enabled){let e=this.gameControl.data;if(!this.navigationMeshWrapper){let t;this.navigationMeshWrapper=new C3(this.usePhysics,this.isExport),t="sphere"===e.collider.type?2*e.collider.radius:e.collider.height,t=Math.floor(t/e.navmesh.ch-1),this.navigationMeshWrapper.init(d(d({},e.navmesh),{},{walkableHeight:t}),this.gameControl,this.eventContext)}}if(!1===n){let{enableRotate:e,enablePan:n,enableZoom:i,autoRotate:r,hoverRotatePanMode:s}=this.eventManager.publish.orbitControls;(e||n||i||r||0!==s)&&(this.orbitControls=new W3(t,this.renderer.domElement,{isExport:this.isExport,isPlayMode:!0}),this.orbitControls.addEventListener("change",this.requestRender),this.orbitControls.addEventListener("end",this.requestRender),this.orbitControls.addEventListener("start",this.requestRender),this.orbitControls.fromJSON(this.eventManager.publish.orbitControls,this.eventManager.publish.mouseEventTarget),this.orbitControls.useKeyEvents=!1,this.orbitControls.addEventListenersToCamera(),this.orbitControls.connect(),this.orbitControls.update())}let p=this.renderer.domElement.width/this.renderer.getPixelRatio(),f=this.renderer.domElement.height/this.renderer.getPixelRatio();this.joystickToGameControls.forEach(((e,t)=>{let n=document.body.appendChild(document.createElement("div")),[i,r,s]=this.eventManager.eventContext.publish.joystickSizeAndXYOffset[t],a=(p-5*i)/4+i,o={},l="jmp"===e,u=l?0:i;t<10?(t<5?o.top=u/2:o.bottom=u/2,o.left=u/2+t%5*a):10===t?(o.left=u/2,o.top=f/2):(o.right=u/2,o.top=f/2),o.top?o.top-=r[1]:o.bottom+=r[1],o.left?o.left+=r[0]:o.right-=r[0];for(let d in o)o[d]+="px";if(l){let e=n.appendChild(document.createElement("div"));Object.assign(e.style,o,{position:"absolute",width:i+"px",height:i+"px",backgroundColor:"rgba(255,255,255,".concat("show"===s?.4:0,")"),zIndex:"9999",borderRadius:i+"px",border:"show"===s?"solid 2px rgba(0, 0, 0, .1)":"none",display:"flex",alignItems:"center",justifyContent:"center",touchAction:"none"});let r=i/16*16*.4;return"show"===s&&(e.innerHTML='\n\t\t\t\t\t\t<svg width="'.concat(r,'" height="').concat(.4*i,'" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">\n\t\t\t\t\t\t\t<path d="M2 10L8 4L14 10" stroke="black" stroke-opacity="40%" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>\n\t\t\t\t\t\t</svg>\n\t\t\t\t\t')),e.addEventListener("pointerdown",(()=>{this.gameControl.movementState.jump=1,this.requestRender()})),e.addEventListener("touchend",(e=>e.preventDefault())),void(this.joysticks[t]=[void 0,n])}let c={zone:n,mode:"static",position:o,size:i};"hide"===s&&(c.restOpacity=0);let h=GJ(c);h.on("move",((t,n)=>{let i=this.gameControl;"pos"===e?n.force<.2?i.moveForce=0:(i.movementState.movePosZ=Math.sin(-n.angle.radian),i.movementState.movePosX=Math.cos(-n.angle.radian),n.force>1.2?i.movementState.run=1:i.movementState.run=0,n.force<.3?i.moveForce=(n.force-.2)/.1:i.moveForce=1):"rot"===e&&(n.force<.2?i.rotForce=0:(i.movementState.rotPosX=n.vector.y,i.movementState.rotPosY=-n.vector.x,n.force<.3?i.rotForce=(n.force-.2)/.1:i.rotForce=1)),this.requestRender()})),h.on("end",((t,n)=>{let i=this.gameControl;"pos"===e?(i.movementState.movePosZ=0,i.movementState.movePosX=0,i.moveForce=1):"rot"===e&&(i.movementState.rotPosX=0,i.movementState.rotPosY=0,i.rotForce=1)})),this.joysticks[t]=[h,n]})),this.markIsDestroyTarget(),this.markIsDragObject(),this.rebuildBVH(),this.initializationCounter++,window.setTimeout((()=>{this.collisionEvents.forEach((e=>e.initialDisabled=!1))}),80)}initPhysics(){var e;null!==(e=this.sharedGameControlGlobals.rapierWorld)&&void 0!==e&&e.free(),this.sharedGameControlGlobals.rapierWorld=new Y3.World(new Y3.Vector3(0,this.gravity,0)),this.events=new Y3.EventQueue(!0);let t=[],n=[];if(this.page.traverseChildren((e=>{var i;let r;if(e instanceof pY){if(!e.objectForSample)return!0===e.object.dataPatched.physics.fusedBody&&"dynamic"===e.object.dataPatched.physics.rigidBody||void 0;if(e.objectForSample.dataPatched.physics.fusedBody)return;r=e.object}else if(e instanceof Vz)r=e.object;else{var s,a,o;if(e instanceof AZ||e instanceof XY)return;if(r=e,!1===(null===(s=r.dataPatched.cloner)||void 0===s?void 0:s.disabled)&&null!==(a=r.dataPatched.cloner)&&void 0!==a&&a.hideBase&&!0!==(null===(o=r.dataPatched.physics)||void 0===o?void 0:o.fusedBody))return!0}let l,u=r.dataPatched;for(let t of u.events)!0!==t.data.disabled&&"GameControl"===t.data.type&&(l=t.data);if(!u.physics||("visibility"===u.physics.enabled?!u.visible:!u.physics.enabled))return!0;e.updateMatrixWorldSVD();let c=h4(u),h=!1,d=r.userData.hasDestroy,p=r.userData.hasDrag,f=!1;for(let t of u.events)if(!0!==t.data.disabled)if("Collision"===t.data.type){h=!0;let e=new g3(t.id,t.data,r,this.page,this.sharedAssets,this.eventManager);e.initialDisabled=!0,this.collisionEvents.push(e),this.sharedGameControlGlobals.entityToCollisionEvents[r.uuid]&&this.sharedGameControlGlobals.entityToCollisionEvents[r.uuid].every((e=>e.id!==t.id))?this.sharedGameControlGlobals.entityToCollisionEvents[r.uuid].push(e):this.sharedGameControlGlobals.entityToCollisionEvents[r.uuid]=[e]}else if("Follow"===t.data.type){f=!0;let n=t.data.target;e.traverseVisible((e=>{e.userData.isFollowingObj=n}))}"dynamic"===u.physics.rigidBody&&!1===u.physics.fusedBody&&(e.matrixWorldFusedFalse=e.matrixWorld.clone());let m=e.geometry;if(void 0!==l){let t=Y3.RigidBodyDesc.kinematicPositionBased();(e.hasNonUniformScale?e.matrixWorldRigid:e.matrixWorld).decompose(Q3,K3,Z3),e.position0=Q3.clone().divideScalar(this.pixelsPerMeter),e.rotation0=K3.clone(),Q3.divideScalar(this.pixelsPerMeter),t.setTranslation(Q3.x,Q3.y,Q3.z).setRotation(K3);let n,i=this.sharedGameControlGlobals.rapierWorld.createRigidBody(t);e.rigidBody=i,n="sphere"===l.collider.type?Y3.ColliderDesc.ball(l.collider.radius/this.pixelsPerMeter):"capsule"===l.collider.type?Y3.ColliderDesc.capsule((l.collider.height/2-l.collider.radius)/this.pixelsPerMeter,l.collider.radius/this.pixelsPerMeter):Y3.ColliderDesc.cuboid(l.collider.width/this.pixelsPerMeter/2,l.collider.height/this.pixelsPerMeter/2,l.collider.depth/this.pixelsPerMeter/2),n.setFrictionCombineRule(Y3.CoefficientCombineRule.Average).setRestitutionCombineRule(Y3.CoefficientCombineRule.Average).setDensity(u.physics.density).setFriction(u.physics.friction).setRestitution(u.physics.restitution);let s=this.sharedGameControlGlobals.rapierWorld.createCollider(n,i);this.sharedGameControlGlobals.colliderToEntity.set(s.handle,r),Q3.fromArray(l.collider.position).multiply(Z3.setFromMatrixScale(r.matrixWorld)).divideScalar(this.pixelsPerMeter),s.setTranslationWrtParent(Q3);let a=(new Rv).setFromEuler((new _y).setFromVector3((new Lv).fromArray(l.collider.rotation)));s.setRotationWrtParent(a),s.setActiveEvents(Y3.ActiveEvents.COLLISION_EVENTS),this.generateSensorColliderDescs(r,!0)}else"dynamic"===u.physics.rigidBody||c||f||d||p||h?(this.addRigidBody(e,r,{hasFollow:f,hasTransformAnim:c,hasDrag:p}),this.generateSensorColliderDescs(r,u.physics.fusedBody)):(m&&t.push(V1(m,e.matrixWorld)),u.physics.fusedBody&&e.traverseObject(((e,n)=>{if(0===n)return;let i;if(e instanceof pY){if(!e.objectForSample)return!0===e.object.dataPatched.physics.fusedBody&&"dynamic"===e.object.dataPatched.physics.rigidBody||void 0;if(e.objectForSample.dataPatched.physics.fusedBody)return;i=e.object}else{var r;if(e instanceof AZ||e instanceof XY)return;if(e instanceof Vz)i=e.object;else if(i=e,null!==(r=i.dataPatched.cloner)&&void 0!==r&&r.hideBase)return!0}let s=i.dataPatched;if("visibility"===s.physics.enabled?!s.visible:!s.physics.enabled)return!0;let a=e.geometry;void 0!==(null===a||void 0===a?void 0:a.getAttribute("position"))&&t.push(V1(a,e.matrixWorld))})),this.generateSensorColliderDescs(r,u.physics.fusedBody,n));return!(!0!==(null===(i=u.physics)||void 0===i?void 0:i.fusedBody)&&!l)||void 0})),0===t.length)return;let i=aL(t);i.scale(1/this.pixelsPerMeter,1/this.pixelsPerMeter,1/this.pixelsPerMeter);let r=Y3.RigidBodyDesc.fixed(),s=this.sharedGameControlGlobals.rapierWorld.createRigidBody(r),a=Y3.ColliderDesc.trimesh(i.getAttribute("position").array,i.getIndex().array).setFrictionCombineRule(Y3.CoefficientCombineRule.Multiply).setRestitutionCombineRule(Y3.CoefficientCombineRule.Multiply).setFriction(1).setRestitution(1);this.sharedGameControlGlobals.rapierWorld.createCollider(a,s);for(let[o,l]of n){let e=this.sharedGameControlGlobals.rapierWorld.createCollider(o,s);this.sensorToTriggerEvent[e.handle]=l}}updatePositions(){return this.nActiveRigidBodies=0,this.sharedGameControlGlobals.rapierWorld.forEachRigidBody(this.processRigidBody),this.nActiveRigidBodies>0}rebuildBVH(){this.usePhysics?this.initPhysics():(this.page.traverseEntity((e=>{for(let t of e.dataPatched.events)if("Trigger"===t.data.type&&!0!==t.data.disabled){let n=new X3(t.id,t.data,e,this.page,this.sharedAssets,this.eventManager),i=(new py).compose(e4.fromArray(t.data.position),i4.setFromEuler($3.fromArray(t.data.rotation)),n4);if("box"===t.data.triggerZone){let r=new jv;r.min.fromArray(t.data.size).multiplyScalar(-.5),r.max.fromArray(t.data.size).multiplyScalar(.5),this.sharedGameControlGlobals.triggers.push([r,i,e,n])}else this.sharedGameControlGlobals.triggers.push([t.data.radius,i,e,n])}})),this.needsCollisionDetection&&this.initBVH())}disconnectEvents(){this.collisionEvents.forEach((e=>e.disconnect())),this.sharedGameControlGlobals.triggers.forEach((e=>e[3].disconnect())),this.sharedGameControlGlobals.triggers.length=0}deactivate(){if(this.isEnabled){var e,t,n,i;this.isEnabled=!1,this.page.traverse((e=>{let t=e;t.matrixWorldFusedFalse&&(t.matrixWorldFusedFalse=void 0),t.rigidBody&&(t.rigidBody=void 0),t.position0&&(t.position0=void 0),t.rotation0&&(t.rotation0=void 0)})),null!==(e=this.sharedGameControlGlobals.rapierWorld)&&void 0!==e&&e.free(),this.sharedGameControlGlobals.rapierWorld=void 0,this.sharedGameControlGlobals.staticMeshBVH=void 0,this.accumulator=0,this.sharedGameControlGlobals.entitiesWithTransformAnim=[],this.disconnectEvents(),null!==(t=this.gameControl)&&void 0!==t&&t.reset(),null!==(n=this.gameControl)&&void 0!==n&&n.dispose(),this.gameControl=null,this.initializationCounter=-1,this.joysticks.forEach((e=>{let[t,n]=e;null!==t&&void 0!==t&&t.destroy(),n.remove()})),this.joystickToGameControls=[],this.joysticks=[],this.orbitControls&&(this.orbitControls.dispose(),this.orbitControls=void 0),null!==(i=this.navigationMeshWrapper)&&void 0!==i&&i.dispose(),this.navigationMeshWrapper=void 0;for(let e of Object.values(this.sharedGameControlGlobals.entityToCollisionEvents))e.forEach((e=>e.disconnect()));this.sharedGameControlGlobals.entityToCollisionEvents={},this.page.updateMatrixWorld(!0)}}update(e,t,n){if(!this.isEnabled)return!0;let i=!0;if(void 0!==this.orbitControls&&this.orbitControls.needsUpdate&&(i=!this.orbitControls.update()),this.initializationCounter>=0&&this.initializationCounter<2?(this.initializationCounter++,i=!1):2===this.initializationCounter&&this.gameControl&&(i=!this.gameControl.update(e,t,n)&&i),!1===this.usePhysics&&this.checkTrigger(),this.usePhysics){let t=.016666666666666666;if(0===e)i=this.stepPhysics()&&i;else{let n=e/1e3;n<t&&n>.55*t&&(n=t),this.accumulator+=n;let r=performance.now(),s=0,a=6;for(;this.accumulator>=t&&s<a&&(i=this.stepPhysics()&&i,this.accumulator-=t,s++,!(performance.now()-r>1e3*t)););this.accumulator=this.accumulator%t}}return i}stepPhysics(){var e;for(let t of this.sharedGameControlGlobals.entitiesWithTransformAnim){(t.hasNonUniformScale?t.matrixWorldRigid:t.matrixWorld).decompose(Q3,K3,Z3),J3.setFromQuaternion(K3);let e=t;void 0===e.prevR?(e.prevR=J3.clone(),e.prevT=Q3.clone()):(e.prevR.copy(J3),e.prevT.copy(Q3)),t.rigidBody&&(t.rigidBody.setNextKinematicTranslation(Q3.divideScalar(this.pixelsPerMeter)),t.rigidBody.setNextKinematicRotation(K3))}return this.sharedGameControlGlobals.rapierWorld.step(this.events),null!==(e=this.events)&&void 0!==e&&e.drainCollisionEvents(this.handleCollisionEvents),!this.updatePositions()}dispatchCollisionEvent(e,t,n){var i;let r,s=(null===(i=this.sharedGameControlGlobals.rapierWorld)||void 0===i?void 0:i.getCollider(n))._parent;if(t.cloner)for(let a of t.cloner.children)if(a.rigidBody===s){r=a;break}e.dispatch(r),t.dispatchEvent(u4)}updateUseWindowEvents(e){var t;null===(t=this.orbitControls)||void 0===t||t.updateUseWindowEvents(e)}generateSensorColliderDescs(e,t,n){let i=s4.copy(e.matrixWorld).invert();e.traverseEntity(((r,s)=>{if(!1===t&&1===s)return!0;for(let t of r.dataPatched.events)if("Trigger"===t.data.type&&!0!==t.data.disabled){let s,a=new X3(t.id,t.data,r,this.page,this.sharedAssets,this.eventManager);if(s="box"===t.data.triggerZone?Y3.ColliderDesc.cuboid(...t.data.size.map((e=>e/(2*this.pixelsPerMeter)))):Y3.ColliderDesc.ball(t.data.radius/this.pixelsPerMeter),s.setDensity(0).setSensor(!0).setActiveEvents(Y3.ActiveEvents.COLLISION_EVENTS),e4.fromArray(t.data.position),i4.setFromEuler($3.fromArray(t.data.rotation)),r4.compose(e4,i4,n4).premultiply(r.matrixWorld),n?(r4.decompose(e4,i4,t4),s.setActiveCollisionTypes(Y3.ActiveCollisionTypes.KINEMATIC_FIXED|Y3.ActiveCollisionTypes.DYNAMIC_FIXED)):(r4.premultiply(i).decompose(e4,i4,t4),e.rigidBody.bodyType()===Y3.RigidBodyType.Dynamic||(e.rigidBody.bodyType()===Y3.RigidBodyType.Fixed?s.setActiveCollisionTypes(Y3.ActiveCollisionTypes.KINEMATIC_FIXED|Y3.ActiveCollisionTypes.DYNAMIC_FIXED):s.setActiveCollisionTypes(Y3.ActiveCollisionTypes.KINEMATIC_KINEMATIC|Y3.ActiveCollisionTypes.DYNAMIC_KINEMATIC))),e4.divideScalar(this.pixelsPerMeter),s.setTranslation(e4.x,e4.y,e4.z),s.setRotation(i4),n)n.push([s,a]);else{let t=this.sharedGameControlGlobals.rapierWorld.createCollider(s,e.rigidBody);this.sensorToTriggerEvent[t.handle]=a}}}))}checkTrigger(){let e;for(let t=0;t<this.sharedGameControlGlobals.triggers.length;t++){let[n,i,r,s]=this.sharedGameControlGlobals.triggers[t];for(let t=0;t<this.sharedGameControlGlobals.entitiesWithTransformAnim.length;t++){let a=this.sharedGameControlGlobals.entitiesWithTransformAnim[t];if(r===a||!1===s.isValidTriggeringObject(Nz.is(a)?a:a.object))continue;let o=s4.copy(r.matrixWorld).decompose(e4,o4,t4).compose(e4,o4,n4).multiply(i),l=r4.copy(a.matrixWorld).invert().multiply(o);n instanceof jv?e=a.bvhGeometry.boundsTree.intersectsBox(n,l):(l4.radius=n,l4.center.setFromMatrixPosition(l),e=a.bvhGeometry.boundsTree.intersectsSphere(l4)),e?-1===s.currentIntersectedObjects.indexOf(a)&&(s.currentIntersectedObjects.push(a),s.dispatch(),r.dispatchEvent(c4)):s.currentIntersectedObjects=s.currentIntersectedObjects.filter((e=>e!==a))}}}};function p4(e){var t;let n=this._clip.duration,i=null!==(t=this._clip.start)&&void 0!==t?t:0,r=this.loop,s=this.time+e,a=this._loopCount,o=r===Pg;if(0===e)return-1===a?s:o&&1===(1&a)?n-(s-i):s;if(2200===r){-1===a&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(s>=n)s=n;else{if(!(s<0)){this.time=s;break e}s=0}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=s,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(-1===a&&(e>=0?(a=0,this._setEndings(!0,0===this.repetitions,o)):this._setEndings(0===this.repetitions,!0,o)),s>=n||s<i){let t=Math.floor((s-i)/(n-i));s-=(n-i)*t,a+=Math.abs(t);let r=this.repetitions-a;if(r<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,o||(s=e>0?n:i,1===this.repetitions&&(s=n)),this.time=s,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(1===r){let t=e<0;this._setEndings(t,!t,o)}else this._setEndings(!1,!1,o);this._loopCount=a,this.time=s,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:t})}}else this.time=s;if(o&&1===(1&a))return n-(s-i)}return s}var f4,m4=!1,g4=class{constructor(e,t,n,i){this.scene=e,this.requestRender=t,this.updateDisplayProgress=n,this.animationInspectorState=i,this.clipIdToAction={},this.activeClip=null,this.needsUpdate=!1,this.addClip=e=>{"Empty"===e.data.type&&e.data.animations&&e.data.animations.forEach(((t,n)=>{let i=t[0]+"/";if(Array.isArray(e.identity)?i+=e.identity[0]:i+=e.uuid,this.clipIdToAction[i])return;let r=DS.parse(JSON.parse(t[2]));e.animations[n]=r;let s=this.mixer.clipAction(r,e);!1===m4&&(Object.getPrototypeOf(s)._updateTime=p4,m4=!0),s.clampWhenFinished=!0,this.clipIdToAction[i]=s}))},this.mixer=new dE(e),this.scene.traverseEntity(this.addClip)}deleteClip(e,t){let n=this.scene.find(t);if(!n)return;let i=n.animations.find((t=>t.uuid===e));if(!i)return;let r=this.clipIdToAction[e];!r||(r.stop(),this.mixer.uncacheClip(i),delete this.clipIdToAction[e],n.animations=n.animations.filter((t=>t.uuid!==e)))}get isPlaying(){return Object.values(this.clipIdToAction).some((e=>e.isRunning()))}playFromInspector(e){this.mixer.stopAllAction();let t=this.clipIdToAction[e];!t||(t.play(),this.activeClip=t.getClip(),this.requestRender())}onExitPlayMode(){Object.values(this.clipIdToAction).forEach((e=>{e.repetitions=1/0,e.loop=2201})),this.mixer.stopAllAction(),this.requestRender()}play(e){let t=e.clipId+"/"+e.object,n=this.clipIdToAction[t];if(n)return e&&(e.repeat>=0&&(n.repetitions=e.repeat+1),"pingpong"===e.direction&&0!==e.repeat&&(n.loop=Pg)),n.play(),n.paused=!1,this.requestRender(),n}resumeFromInspector(e){let t=this.clipIdToAction[e];!t||(t.play(),t.paused=!1,this.requestRender())}pauseFromInspector(e){let t=this.clipIdToAction[e];!t||(t.paused=!0)}stop(){this.mixer.stopAllAction(),this.requestRender()}update(e){var t;if(this.needsUpdate)this.needsUpdate=!1;else if(!1===this.isPlaying||null!==(t=this.animationInspectorState)&&void 0!==t&&t.isScrubbing)return;this.mixer.update(e/1e3),this.activeClip&&this.updateDisplayProgress(Math.round(this.mixer.time/this.activeClip.duration*(this.maxFrames-1)%(this.maxFrames-1))),this.requestRender()}get maxFrames(){var e;return Q0(null!==(e=this.activeClip)&&void 0!==e?e:void 0)}setProgressFromInspector(e,t){if(!this.clipIdToAction[t])return;this.activeClip!==this.clipIdToAction[t].getClip()&&this.playFromInspector(t);let n=this.clipIdToAction[t].paused;this.clipIdToAction[t].paused=!1,this.mixer.setTime(Math.min(e/(this.maxFrames-1),.9999)*this.activeClip.duration),this.requestRender(),n&&(this.clipIdToAction[t].paused=!0)}},v4=new WeakMap,y4=class extends AS{constructor(e){super(e),this.decoderPath="",this.decoderConfig={},this.decoderBinary=null,this.decoderPending=null,this.workerLimit=4,this.workerPool=[],this.workerNextTaskID=1,this.workerSourceURL="",this.defaultAttributeIDs={position:"POSITION",normal:"NORMAL",color:"COLOR",uv:"TEX_COORD"},this.defaultAttributeTypes={position:"Float32Array",normal:"Float32Array",color:"Float32Array",uv:"Float32Array"}}setDecoderPath(e){return this.decoderPath=e,this}setDecoderConfig(e){return this.decoderConfig=e,this}setWorkerLimit(e){return this.workerLimit=e,this}load(e,t,n,i){let r=new PS(this.manager);r.setPath(this.path),r.setResponseType("arraybuffer"),r.setRequestHeader(this.requestHeader),r.setWithCredentials(this.withCredentials),r.load(e,(e=>{this.decodeDracoFile(e,t).catch(i)}),n,i)}decodeDracoFile(e,t,n,i){let r={attributeIDs:n||this.defaultAttributeIDs,attributeTypes:i||this.defaultAttributeTypes,useUniqueIDs:!!n};return this.decodeGeometry(e,r).then(t)}decodeGeometry(e,t){let n=JSON.stringify(t);if(v4.has(e)){let t=v4.get(e);if(t.key===n)return t.promise;if(0===e.byteLength)throw new Error("THREE.DRACOLoader: Unable to re-decode a buffer with different settings. Buffer has already been transferred.")}let i,r=this.workerNextTaskID++,s=e.byteLength,a=this._getWorker(r,s).then((n=>(i=n,new Promise(((n,s)=>{i._callbacks[r]={resolve:n,reject:s},i.postMessage({type:"decode",id:r,taskConfig:t,buffer:e},[e])}))))).then((e=>this._createGeometry(e.geometry)));return a.catch((()=>!0)).then((()=>{i&&r&&this._releaseTask(i,r)})),v4.set(e,{key:n,promise:a}),a}_createGeometry(e){let t=new dx;e.index&&t.setIndex(new tx(e.index.array,1));for(let n=0;n<e.attributes.length;n++){let i=e.attributes[n],r=i.name,s=i.array,a=i.itemSize;t.setAttribute(r,new tx(s,a))}return t}_loadLibrary(e,t){let n=new PS(this.manager);return n.setPath(this.decoderPath),n.setResponseType(t),n.setWithCredentials(this.withCredentials),new Promise(((t,i)=>{n.load(e,t,void 0,i)}))}preload(){return this._initDecoder(),this}_initDecoder(){if(this.decoderPending)return this.decoderPending;let e="object"!=typeof WebAssembly||"js"===this.decoderConfig.type,t=[];return e?t.push(this._loadLibrary("draco_decoder.js","text")):(t.push(this._loadLibrary("draco_wasm_wrapper.js","text")),t.push(this._loadLibrary("draco_decoder.wasm","arraybuffer"))),this.decoderPending=Promise.all(t).then((t=>{let n=t[0];e||(this.decoderConfig.wasmBinary=t[1]);let i=x4.toString(),r=["/* draco decoder */",n,"","/* worker */",i.substring(i.indexOf("{")+1,i.lastIndexOf("}"))].join("\n");this.workerSourceURL=URL.createObjectURL(new Blob([r]))})),this.decoderPending}_getWorker(e,t){return this._initDecoder().then((()=>{if(this.workerPool.length<this.workerLimit){let e=new Worker(this.workerSourceURL);e._callbacks={},e._taskCosts={},e._taskLoad=0,e.postMessage({type:"init",decoderConfig:this.decoderConfig}),e.onmessage=function(t){let n=t.data;switch(n.type){case"decode":e._callbacks[n.id].resolve(n);break;case"error":e._callbacks[n.id].reject(n);break;default:console.error('THREE.DRACOLoader: Unexpected message, "'+n.type+'"')}},this.workerPool.push(e)}else this.workerPool.sort((function(e,t){return e._taskLoad>t._taskLoad?-1:1}));let n=this.workerPool[this.workerPool.length-1];return n._taskCosts[e]=t,n._taskLoad+=t,n}))}_releaseTask(e,t){e._taskLoad-=e._taskCosts[t],delete e._callbacks[t],delete e._taskCosts[t]}debug(){console.log("Task load: ",this.workerPool.map((e=>e._taskLoad)))}dispose(){for(let e=0;e<this.workerPool.length;++e)this.workerPool[e].terminate();return this.workerPool.length=0,""!==this.workerSourceURL&&URL.revokeObjectURL(this.workerSourceURL),this}};function x4(){let e,t;function n(e,t,n,i,r,s){let a=s.num_components(),o=n.num_points()*a,l=o*r.BYTES_PER_ELEMENT,u=function(e,t){switch(t){case Float32Array:return e.DT_FLOAT32;case Int8Array:return e.DT_INT8;case Int16Array:return e.DT_INT16;case Int32Array:return e.DT_INT32;case Uint8Array:return e.DT_UINT8;case Uint16Array:return e.DT_UINT16;case Uint32Array:return e.DT_UINT32}}(e,r),c=e._malloc(l);t.GetAttributeDataArrayForAllPoints(n,s,u,l,c);let h=new r(e.HEAPF32.buffer,c,o).slice();return e._free(c),{name:i,array:h,itemSize:a}}onmessage=function(i){let r=i.data;switch(r.type){case"init":e=r.decoderConfig,t=new Promise((function(t){e.onModuleLoaded=function(e){t({draco:e})},DracoDecoderModule(e)}));break;case"decode":let i=r.buffer,s=r.taskConfig;t.then((e=>{let t=e.draco,a=new t.Decoder,o=new t.DecoderBuffer;o.Init(new Int8Array(i),i.byteLength);try{let e=function(e,t,i,r){let s,a,o=r.attributeIDs,l=r.attributeTypes,u=t.GetEncodedGeometryType(i);if(u===e.TRIANGULAR_MESH)s=new e.Mesh,a=t.DecodeBufferToMesh(i,s);else{if(u!==e.POINT_CLOUD)throw new Error("THREE.DRACOLoader: Unexpected geometry type.");s=new e.PointCloud,a=t.DecodeBufferToPointCloud(i,s)}if(!a.ok()||0===s.ptr)throw new Error("THREE.DRACOLoader: Decoding failed: "+a.error_msg());let c={index:null,attributes:[]};for(let h in o){let i,a,u=self[l[h]];if(r.useUniqueIDs)a=o[h],i=t.GetAttributeByUniqueId(s,a);else{if(a=t.GetAttributeId(s,e[o[h]]),-1===a)continue;i=t.GetAttribute(s,a)}c.attributes.push(n(e,t,s,h,u,i))}return u===e.TRIANGULAR_MESH&&(c.index=function(e,t,n){let i=3*n.num_faces(),r=4*i,s=e._malloc(r);t.GetTrianglesUInt32Array(n,r,s);let a=new Uint32Array(e.HEAPF32.buffer,s,i).slice();return e._free(s),{array:a,itemSize:1}}(e,t,s)),e.destroy(s),c}(t,a,o,s),i=e.attributes.map((e=>e.array.buffer));e.index&&i.push(e.index.array.buffer),self.postMessage({type:"decode",id:r.id,geometry:e},i)}catch(Si){console.error(Si),self.postMessage({type:"error",id:r.id,error:Si.message})}finally{t.destroy(o),t.destroy(a)}}))}}}async function b4(e){if(f4){let t,n={attributeIDs:f4.defaultAttributeIDs,attributeTypes:f4.defaultAttributeTypes,useUniqueIDs:!1};try{t=await f4.decodeGeometry(new Int8Array(e).buffer,n)}catch(un){console.error(un)}if(t)return{index:t.index?{array:t.index.array}:void 0,attributes:Object.entries(t.attributes).map((e=>{let[t,n]=e;return{name:t,itemSize:n.itemSize,array:n.array}}))}}return null}var w4=class{constructor(){this._clickCount=0,this._lastTime=0,this._lastPosition=[0,0],this._delay=500,this._distance=2,this._onMouseDown=e=>{let t=[e.clientX,e.clientY],n=(new Date).getTime();if(this._clickCount>0){let e=t[0]-this._lastPosition[0],n=t[1]-this._lastPosition[1];Math.sqrt(e*e+n*n)>this._distance&&(this._clickCount=0)}this._lastPosition=t,this._clickCount=n-this._lastTime>this._delay?1:this._clickCount+1,this._lastTime=n},this._onMouseUp=e=>{}}start(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:500,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2;this._target&&this.stop(),this.reset(),this._delay=t,this._distance=n,this._target=e,this._target.addEventListener("pointerdown",this._onMouseDown,!1),this._target.addEventListener("pointerup",this._onMouseUp,!1)}stop(){this._target&&(this._target.removeEventListener("pointerdown",this._onMouseDown,!1),this._target.removeEventListener("pointerup",this._onMouseUp,!1),this._target=void 0)}get clickCount(){return this._clickCount}reset(){this._clickCount=0,this._lastTime=0,this._lastPosition=[0,0]}},D4=class{constructor(e,t,n,i,r,s,a,o){this.eventId=e,this.id=t,this.data=n,this.dataEvent=i,this.object=r,this.stage=!1,this.actions=i1(i,n.actions,s,a,o,r)}disconnect(){r1(this.actions)}dispatchIn(){this.actions.Audio.forEach((e=>e.dispatchBasic())),this.actions.Particles.forEach((e=>e.dispatchBasic())),this.actions.Video.forEach((e=>e.dispatchBasic())),this.actions.Create.forEach((e=>e.dispatch())),this.actions.Destroy.forEach((e=>e.dispatch())),this.actions.Reset.forEach((e=>e.dispatch())),this.actions.Link.forEach((e=>e.dispatch())),this.actions.Transition.forEach((e=>{e.object.currentTransitionEvent!==this&&(e.object.currentTransitionEvent=this,e.init())})),this.actions.Transition.forEach((e=>e.toggle())),this.actions.Animation.forEach((e=>e.play())),this.actions.SwitchCamera.forEach((e=>e.play())),this.actions.SceneTransition.forEach((e=>e.dispatch())),this.actions.SetVariable.forEach((e=>e.checkConditions())),this.actions.SetVariable.forEach((e=>e.dispatch())),this.actions.DynamicVariablePlay.forEach((e=>e.dispatch())),this.actions.ClearLocalStorage.forEach((e=>e.dispatch())),this.actions.UserAPI.forEach((e=>e.dispatch()))}dispatchOut(){this.actions.Transition.forEach((e=>{e.toggle()}))}},_4=class extends i2{constructor(e,t){super(e),this.eventManager=t,this.breakpoints=[],this.resize=(e,t)=>{this.breakpoints.forEach((n=>{let i,r=Mk.deviceToSize(n.data.size),s="horizontal"===n.dataEvent.orientation?e:t;switch(n.data.operator){case"<":i=s<r[0];break;case">":i=s>r[0];break;case"<>":i=s>r[0]&&s<r[1]}n.stage!==i&&(n.stage=i,n.stage?n.dispatchIn():n.dispatchOut())}))},this.onResizeObserver=new ResizeObserver((e=>{for(let t of e){let{width:e,height:n}=t.contentRect;this.resize(e,n)}}))}connect(){let{page:e,sharedAssets:t,domElement:n}=this.eventContext;this.onResizeObserver.observe(n);let i=n=>{var i;if(n.visible&&null!==(i=n.data)&&void 0!==i&&i.events.length)for(let{data:r,id:s}of n.data.events)r.disabled||"Resize"===r.type&&r.breakpoints.forEach((i=>{let{data:a,id:o}=i;try{let i=new D4(s,o,a,r,n,e,t,this.eventManager);this.breakpoints.push(i)}catch(Zn){}}))};e.traverseEntity((e=>{var t;(e instanceof pZ||e instanceof iZ)&&null!==(t=e.frame)&&void 0!==t&&t.traverse((e=>{i(e)})),i(e)}))}disconnect(){this.onResizeObserver.disconnect(),this.breakpoints.forEach((e=>{e.disconnect()})),this.breakpoints=[]}},S4=class extends i2{constructor(e,t){super(e),this.eventManager=t,this.userAPIs={},this.events=[],this.onSuccess=e=>{let{userAPIId:t}=e;this.events.forEach((e=>{e.data.userAPIId===t&&e.dispatchSuccess()}))},this.onError=e=>{let{userAPIId:t}=e;this.events.forEach((e=>{e.data.userAPIId===t&&e.dispatchError()}))},this.userAPIs=e.sharedAssets.getUserAPIs()}connect(){this.eventContext.page.traverseEntity((e=>{var t;null===(t=e.data)||void 0===t||t.events.filter((e=>"API"===e.data.type&&!e.data.disabled)).forEach((t=>{this.events.push(new E4(t.id,t.data,e,this.eventContext.page,this.eventContext.sharedAssets,this.eventManager))}))})),Object.entries(this.userAPIs).forEach((e=>{let[t,n]=e;n.on("success",this.onSuccess),n.on("error",this.onError),n.autostart&&n.callUserAPI(this.eventContext.sharedAssets)}))}disconnect(){Object.entries(this.userAPIs).forEach((e=>{let[t,n]=e;n.off("success",this.onSuccess),n.off("error",this.onError)}))}},E4=class{constructor(e,t,n,i,r,s){this.id=e,this.data=t,this.object=n,this.successActions=i1(t,t.successActions,i,r,s,n),this.errorActions=i1(t,t.errorActions,i,r,s,n)}dispatchSuccess(){this.dispatchActions(this.successActions)}dispatchError(){this.dispatchActions(this.errorActions)}dispatchActions(e){e.Audio.forEach((e=>e.dispatchConditional())),e.Particles.forEach((e=>e.dispatchConditional())),e.Video.forEach((e=>e.dispatchConditional())),e.Create.forEach((e=>e.dispatch())),e.Destroy.forEach((e=>e.dispatch())),e.Reset.forEach((e=>e.dispatch())),e.Transition.forEach((e=>{e.object.currentTransitionEvent!==this&&(e.object.currentTransitionEvent=this),e.init()})),e.Transition.forEach((e=>e.play())),e.Animation.forEach((e=>e.play())),e.SwitchCamera.forEach((e=>e.play())),e.SceneTransition.forEach((e=>e.dispatch())),e.SetVariable.forEach((e=>e.checkConditions())),e.SetVariable.forEach((e=>e.dispatch())),e.DynamicVariablePlay.forEach((e=>e.dispatch())),e.ClearLocalStorage.forEach((e=>e.dispatch())),e.UserAPI.forEach((e=>e.dispatch()))}},C4=class extends i2{constructor(e,t){super(e),this.eventManager=t,this.userWebhooks={},this.events=[],this.onMessage=e=>{let{userWebhookId:t}=e;this.events.forEach((e=>{e.data.userWebhookId===t&&e.dispatch()}))},this.userWebhooks=e.sharedAssets.getUserWebhooks()}connect(){this.eventContext.page.traverseEntity((e=>{var t;null===(t=e.data)||void 0===t||t.events.filter((e=>"WEBHOOK"===e.data.type&&!e.data.disabled)).forEach((t=>{this.events.push(new A4(t.id,t.data,e,this.eventContext.page,this.eventContext.sharedAssets,this.eventManager))}))})),Object.entries(this.userWebhooks).forEach((e=>{let[t,n]=e;n.connect(),n.on("message",this.onMessage)}))}disconnect(){Object.entries(this.userWebhooks).forEach((e=>{let[t,n]=e;n.off("message",this.onMessage),n.disconnect()}))}},A4=class{constructor(e,t,n,i,r,s){this.id=e,this.data=t,this.object=n,this.actions=i1(t,t.actions,i,r,s,n)}dispatch(){let e=this.actions;e.Audio.forEach((e=>e.dispatchConditional())),e.Particles.forEach((e=>e.dispatchConditional())),e.Video.forEach((e=>e.dispatchConditional())),e.Create.forEach((e=>e.dispatch())),e.Destroy.forEach((e=>e.dispatch())),e.Reset.forEach((e=>e.dispatch())),e.Transition.forEach((e=>{e.object.currentTransitionEvent!==this&&(e.object.currentTransitionEvent=this),e.init()})),e.Transition.forEach((e=>e.play())),e.Animation.forEach((e=>e.play())),e.SwitchCamera.forEach((e=>e.play())),e.SceneTransition.forEach((e=>e.dispatch())),e.SetVariable.forEach((e=>e.checkConditions())),e.SetVariable.forEach((e=>e.dispatch())),e.DynamicVariablePlay.forEach((e=>e.dispatch())),e.ClearLocalStorage.forEach((e=>e.dispatch())),e.UserAPI.forEach((e=>e.dispatch()))}};var M4=new Lv(0,0,1),T4=new Lv,P4=new Lv,F4=new uv,O4=class{constructor(e,t,n,i,r){this.containerScene=e,this.raycaster=t,this.sharedAssets=n,this.requestRender=i,this.onExit=r,this.htmlInput=null,this.virtualInput=null,this.helper=new YQ,this.doubleClickHandler=new w4,this.isDragging=!1,this.plane=new Hx,this.caretInterval=0,this.planeIntersection=new Lv,this.projected=new lv,this._lastIndex=0,this._isFirstDragMove=!1,this.selectionOnDragStart=0,this.onTextMaterialChanged=()=>{var e;let t=null===(e=this.virtualInput)||void 0===e?void 0:e.data;if(void 0!==this.virtualInput&&t){let e=t.material,n=function(e,t){let n=jk.fromHex(3223857),i=.8;for(let r of e.layers){if("light"===r.data.type||"displace"===r.data.type||"fresnel"===r.data.type||"matcap"===r.data.type||"texture"===r.data.type||"toon"===r.data.type||"outline"===r.data.type||"transmission"===r.data.type||"noise"===r.data.type)continue;let e="string"==typeof r.data.alpha?Number(t.getVariable(r.data.alpha)):r.data.alpha;if("color"===r.data.type&&e>.3){n=KQ(r.data.color,t),i=e;break}if(("depth"===r.data.type||"gradient"===r.data.type)&&e>.3){let e=ZQ(r.data);n={r:e[0],g:e[1],b:e[2]},i="string"==typeof r.data.alpha?1:r.data.alpha;break}}return d(d({},n),{},{a:i})}("string"==typeof e?this.sharedAssets.data.materials[e]:e,this.sharedAssets);this.helper.setCaretColor(n)}},this.stopAnimateTextCursor=()=>{clearInterval(this.caretInterval),this.helper&&(this.helper.caretMesh.visible=!1)},this.startAnimateTextCursor=()=>{this.stopAnimateTextCursor(),this.helper&&(this.helper.caretMesh.visible=!0,this.caretInterval=setInterval((()=>{this.helper&&(this.helper.caretMesh.visible=!this.helper.caretMesh.visible),this.requestRender()}),600))},this.handleCaretUpdate=e=>{if(!this.htmlInput||!this.virtualInput)return;let t=this.helper,n="ArrowLeft"===(null===e||void 0===e?void 0:e.key)||"ArrowRight"===(null===e||void 0===e?void 0:e.key),i="ArrowUp"===(null===e||void 0===e?void 0:e.key)||"ArrowDown"===(null===e||void 0===e?void 0:e.key);this.htmlInput.selectionStart===this.htmlInput.selectionEnd?(t.setCaretPosition(this.htmlInput.selectionStart,{horizontalKeyMove:n,verticalKeyMove:i}),this.startAnimateTextCursor()):t.setSelection(this.htmlInput.selectionStart,this.htmlInput.selectionEnd),this.requestRender()},this.containerScene.add(this.helper)}createInput(){return this.htmlInput=function(){let e=document.createElement("textarea");return e.style.position="fixed",e.style.top="200px",e.style.left="400px",e.style.zIndex="-1",e.style.border="1px solid rgba(255,0,0,0.5)",e.style.width="10px",e.style.height="500px",e.style.color="white",e.style.opacity="0.5",e.style.background="transparent",e.style.display="none",e.style.margin="0px",e.style.padding="0px",e.style.boxSizing="content-box",e.style.pointerEvents="none",e}(),this.htmlInput}connect(){}disconnect(){var e;this.stopAnimateTextCursor(),this.helper.hide(),null!==(e=this.htmlInput)&&void 0!==e&&e.remove(),this.doubleClickHandler.stop()}handleMouseDown(){var e,t;if(!this.htmlInput||!this.virtualInput)return!0;this.getPointOnPlane();let n=this.doubleClickHandler.clickCount,{index:i,lineIndex:r,characterIndex:s}=null!==(e=this.helper.getSelectionFromPosition(this.projected.x,this.projected.y,n>1?"inside":"previous"))&&void 0!==e?e:{index:0,lineIndex:0,characterIndex:0};null!==(t=this.virtualInput)&&void 0!==t&&null!==(t=t.wrappedText)&&void 0!==t&&t.length&&"\n"===this.virtualInput.wrappedText[r][Math.max(0,s-1)]&&(i--,s--),this._lastIndex=i,this._isFirstDragMove=!0;let a=this.checkClickedObject();if(1===n){if(null===a)return this.onExit(this.virtualInput),!0;this.selectionOnDragStart=i,this.isDragging=!0,this.setInputSelection(i)}else a===this.virtualInput&&(2===n?this.selectClosestWord(r,s):n>2&&(this.setInputSelection(0,this.htmlInput.value.length),this.doubleClickHandler.reset()))}handleMouseUp(){this.applyRangeToTextInput(),this.isDragging=!1,this._isFirstDragMove=!1}handleMouseMove(){!this.virtualInput||(this._isFirstDragMove&&this.doubleClickHandler.clickCount>1&&(this.selectionOnDragStart=this._lastIndex,this.isDragging=!0,this.setInputSelection(this._lastIndex)),this._isFirstDragMove=!1,this.getPointOnPlane(),this.applyRangeToTextInput())}focus(e){if(this.virtualInput=e,this.updateTextInputStyles(),this.htmlInput)if(e){var t,n;let e=null===(t=this.data)||void 0===t?void 0:t.geometry.text;this.htmlInput.value="string"==typeof e?"":null!==(n=null===e||void 0===e?void 0:e.textValue.toString())&&void 0!==n?n:""}else this.htmlInput.value=""}blur(){}get data(){let{virtualInput:e}=this;if(e)return e.dataPatched}applyRangeToTextInput(){var e,t;if(!this.isDragging||!this.virtualInput||!this.htmlInput)return;let n=this.selectionOnDragStart,{index:i,lineIndex:r,characterIndex:s}=null!==(e=this.helper.getSelectionFromPosition(this.projected.x,this.projected.y,this.doubleClickHandler.clickCount>2?"inside":"previous"))&&void 0!==e?e:{index:0};void 0!==r&&void 0!==s&&"\n"===(null===(t=this.virtualInput)||void 0===t?void 0:t.wrappedText[r][s-1])&&i--,this.htmlInput.setSelectionRange(Math.min(n,i),Math.max(n,i))}checkClickedObject(){if(this.virtualInput){let e=this.raycaster.intersectObject(this.virtualInput,!1);if(e.length>0){let t=e[0];if(t.object instanceof oZ)return t.object}}return null}selectClosestWord(e,t){if(!this.virtualInput)return;let n=this.virtualInput.wrappedText,i=n[e],r=t+1,s=t;" "!==i[t]&&(r=this.findNextCharOccurence(i,t,"forward"," "),s=this.findNextCharOccurence(i,t,"backward"," "),s>0&&s++,r>=i.length-1&&e===n.length-1&&r++);let a=this.helper,o=a.getGlobalIndexFromLineAndCharIndexes(n,e,s),l=a.getGlobalIndexFromLineAndCharIndexes(n,e,r);this.setInputSelection(o,l)}findNextCharOccurence(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:" ",r=Math.max(0,e.length-1),s="forward"===n?r:0,a="forward"===n?1:-1,o=Math.max(Math.min(t,r),0);for(;o!==s;)if(o+=a,e.charAt(o)===i)return o;return s}getPointOnPlane(){var e;let t=null===(e=this.virtualInput)||void 0===e?void 0:e.data;if(this.virtualInput&&t&&this.raycaster.ray.intersectsPlane(this.plane)){null===this.planeIntersection&&(this.planeIntersection=new Lv);let e=this.raycaster.ray.intersectPlane(this.plane,this.planeIntersection);if(e){this.planeIntersection.copy(this.virtualInput.worldToLocal(e));let n="number"==typeof t.geometry.width?t.geometry.width:1,i="number"==typeof t.geometry.height?t.geometry.height:1;this.projected.set(e.x+.5*n,e.y-.5*i)}}}updatePlane(){var e;let t=null===(e=this.virtualInput)||void 0===e?void 0:e.data;this.virtualInput&&t&&(F4.getNormalMatrix(this.virtualInput.matrixWorld),T4.copy(M4).applyMatrix3(F4).normalize(),this.virtualInput.localToWorld(P4.set(0,0,t.geometry.depth)),this.plane.setFromNormalAndCoplanarPoint(T4,P4))}setInputSelection(e){var t;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e;null!==(t=this.htmlInput)&&void 0!==t&&t.setSelectionRange(e,n),setTimeout((()=>{var e;null===(e=this.htmlInput)||void 0===e||e.focus()}))}updateTextInputStyles(){var e;let t=null===(e=this.virtualInput)||void 0===e?void 0:e.data;this.virtualInput&&t&&this.htmlInput&&(this.htmlInput.style.fontSize=t.geometry.fontSize+"px",this.htmlInput.style.letterSpacing=t.geometry.letterSpacing*t.geometry.fontSize+"px",this.htmlInput.style.lineHeight=t.geometry.fontSize*t.geometry.lineHeight+"px",this.htmlInput.style.width=t.geometry.width+"px",this.htmlInput.style.height=t.geometry.height+"px",this.htmlInput.style.textAlign=function(e){return 4===e?"justify":2===e?"right":3===e?"center":"left"}(t.geometry.horizontalAlign))}};var I4=(e,t)=>{if("string"==typeof e){let n=t.data(e);if(n)return I4(n.value,t)}return cR.getDisplayedValue(e)};function k4(e,t){let n=e.text,i="";if("string"==typeof n){let e=t.variables.data(i);e&&(i=I4(e.value,t.variables))}else i=n.textValue.toString();return i}var B4=class extends i2{constructor(e,t){super(e),this.eventManager=t,this._textInputs=[],this.sceneHelpers=new CD,this.helper=new YQ,this._onMouseDownFocusIn=e=>{if(FF.length>1)return;this.eventContext.updateRaycaster(e);let t=null;if(this.eventContext.raycaster)for(let n of this._textInputs)if(this.eventContext.raycaster.intersectObject(n,!0).length>0){t=n;break}this.focusOnTextInput(t),this._onCaretUpdate(),this._onMouseUp(),this.textInputManager.doubleClickHandler.start(this.eventContext.domElement),this.textInputManager.doubleClickHandler._onMouseDown(e),this._onMouseDown(e)},this.onExit=()=>{let{virtualInput:e}=this.textInputManager;if(null===e)return;let t=this.textInputManager.htmlInput;this.helper.hide(),null!==t&&void 0!==t&&t.setSelectionRange(t.value.length,t.value.length),this.eventManager.controlsManager.orbitControls&&(this.eventManager.controlsManager.orbitControls.enabled=!0);let{domElement:n}=this.eventContext;n.removeEventListener("pointerdown",this._onMouseDown,!1),n.removeEventListener("pointerup",this._onMouseUp,!1),n.removeEventListener("pointermove",this._onMouseMove,!1),window.removeEventListener("keydown",this._onKeyPress),this.textInputManager.doubleClickHandler.reset(),n.addEventListener("pointerdown",this._onMouseDownFocusIn),this.eventContext.renderer.sceneHelpersOnTop=void 0,this.eventContext.renderer.pipeline.disableHelpers()},this._onMouseDown=e=>{this.eventContext.updateRaycaster(e),this.textInputManager.handleMouseDown(),this.textInputManager.virtualInput&&this.eventContext.raycaster.intersectObject(this.textInputManager.virtualInput,!0).length>0&&this.eventManager.controlsManager.orbitControls&&(this.eventManager.controlsManager.orbitControls.enabled=!1)},this._onMouseUp=()=>{this.textInputManager.handleMouseUp(),this.eventManager.controlsManager.orbitControls&&!this.eventManager.controlsManager.orbitControls.enabled&&(this.eventManager.controlsManager.orbitControls.enabled=!0)},this._onMouseMove=e=>{this.eventContext.updateRaycaster(e),this.textInputManager.handleMouseMove()},this._onTextEdit=e=>{let{htmlInput:t,virtualInput:n,helper:i}=this.textInputManager;if(!t||!n)return;let r=t.value;n.textGeometry.setText(r).then((()=>{this.eventContext.requestRender()}));let s=n.data;i.update();let a=s.geometry.text;if("string"==typeof a){let e=a;this.eventContext.sharedAssets.updateVariable(e,{textValue:r})}this.textInputManager.updateTextInputStyles(),this._onCaretUpdate()},this._onCaretUpdate=e=>{this.textInputManager.handleCaretUpdate(e)},this._onKeyPress=e=>{"Escape"===e.key&&this.onExit()},this.textInputManager=new O4(this.sceneHelpers,e.raycaster,e.sharedAssets,e.requestRender,this.onExit)}connect(){let e=[];if(this.eventContext.scene.traverseEntity((t=>{t instanceof oZ&&e.push(t)})),this._textInputs=e,0===e.length)return;let{domElement:t}=this.eventContext;t.addEventListener("pointerdown",this._onMouseDownFocusIn),this.textInputManager.connect();let n=this.textInputManager.createInput();document.body.appendChild(n),n.style.display="none",n.addEventListener("keyup",this._onCaretUpdate),n.addEventListener("keydown",this._onCaretUpdate),n.addEventListener("beforeinput",this._onCaretUpdate),n.addEventListener("paste",this._onCaretUpdate),n.addEventListener("cut",this._onCaretUpdate),n.addEventListener("select",this._onCaretUpdate),n.addEventListener("selectstart",this._onCaretUpdate)}disconnect(){let e=this.textInputManager.htmlInput,{domElement:t}=this.eventContext;t.removeEventListener("pointerdown",this._onMouseDownFocusIn),null!==e&&void 0!==e&&e.removeEventListener("keyup",this._onCaretUpdate),null!==e&&void 0!==e&&e.removeEventListener("keydown",this._onCaretUpdate),null!==e&&void 0!==e&&e.removeEventListener("beforeinput",this._onCaretUpdate),null!==e&&void 0!==e&&e.removeEventListener("paste",this._onCaretUpdate),null!==e&&void 0!==e&&e.removeEventListener("cut",this._onCaretUpdate),null!==e&&void 0!==e&&e.removeEventListener("select",this._onCaretUpdate),null!==e&&void 0!==e&&e.removeEventListener("selectstart",this._onCaretUpdate),this._textInputs.forEach((e=>{let t=k4(e.data.geometry,this.eventContext.sharedAssets.data);e.textGeometry.setText(t)})),t.removeEventListener("pointerdown",this._onMouseDown,!1),t.removeEventListener("pointerup",this._onMouseUp,!1),t.removeEventListener("pointermove",this._onMouseMove,!1),window.addEventListener("keydown",this._onKeyPress),this.eventContext.renderer.sceneHelpersOnTop=void 0,this.eventContext.renderer.pipeline.disableHelpers(),this.textInputManager.disconnect()}focusOnTextInput(e){this.textInputManager.focus(e),this.textInputManager.onTextMaterialChanged();let t=this.textInputManager.htmlInput;if(!t||null===e)return;this.textInputManager.updateTextInputStyles(),this.eventContext.renderer.sceneHelpersOnTop=this.sceneHelpers,this.eventContext.renderer.pipeline.enableHelpers(),this.textInputManager.isDragging=!1;let n=k4(e.textGeometry.userData.parameters,this.eventContext.sharedAssets.data);t.value=n,t.setSelectionRange(0,0),this.textInputManager.helper.show(e),t.style.display="block",t.addEventListener("input",this._onTextEdit),this.textInputManager.updatePlane();let{domElement:i}=this.eventContext;i.removeEventListener("pointerdown",this._onMouseDownFocusIn),i.addEventListener("pointerdown",this._onMouseDown,!1),i.addEventListener("pointerup",this._onMouseUp,!1),i.addEventListener("pointermove",this._onMouseMove,!1),window.addEventListener("keydown",this._onKeyPress)}},R4=class extends i2{constructor(e,t){super(e),this.eventManager=t,this.events=[],this.onVoice=e=>{let{value:t,frequencies:n}=e;this.events.forEach((e=>{e.dispatch()}))}}connect(){this.openAIRealtime=this.eventContext.sharedAssets.openAIRealtime,this.openAIRealtime&&(this.eventContext.page.traverseEntity((e=>{var t;null===(t=e.data)||void 0===t||t.events.filter((e=>"AIAssistantListener"===e.data.type&&!e.data.disabled)).forEach((t=>{this.events.push(new L4(t.id,t.data,e,this.eventContext.page,this.eventContext.sharedAssets,this.eventManager))}))})),this.openAIRealtime.on("voice",this.onVoice))}disconnect(){var e;null===(e=this.openAIRealtime)||void 0===e||e.off("voice",this.onVoice)}},L4=class{constructor(e,t,n,i,r,s){this.id=e,this.data=t,this.object=n,this.actions=i1(t,t.actions,i,r,s,n)}dispatch(){this.dispatchActions(this.actions)}dispatchActions(e){e.Audio.forEach((e=>e.dispatchConditional())),e.Particles.forEach((e=>e.dispatchConditional())),e.Video.forEach((e=>e.dispatchConditional())),e.Create.forEach((e=>e.dispatch())),e.Destroy.forEach((e=>e.dispatch())),e.Reset.forEach((e=>e.dispatch())),e.Transition.forEach((e=>{e.object.currentTransitionEvent!==this&&(e.object.currentTransitionEvent=this),e.init()})),e.Transition.forEach((e=>e.play())),e.Animation.forEach((e=>e.play())),e.SwitchCamera.forEach((e=>e.play())),e.SceneTransition.forEach((e=>e.dispatch())),e.SetVariable.forEach((e=>e.checkConditions())),e.SetVariable.forEach((e=>e.dispatch())),e.DynamicVariablePlay.forEach((e=>e.dispatch())),e.ClearLocalStorage.forEach((e=>e.dispatch())),e.UserAPI.forEach((e=>e.dispatch()))}},z4=class extends i2{constructor(e,t){super(e),this.eventManager=t,this.events=[],this.onTriggerEvent=e=>{let{description:t,direction:n}=e,i=this.events.find((e=>e.data.description===t));i&&("backward"===n?i.dispatchReverse():i.dispatch())}}connect(){this.openAIRealtime=this.eventContext.sharedAssets.openAIRealtime,this.openAIRealtime&&(this.eventContext.page.traverseEntity((e=>{var t;null===(t=e.data)||void 0===t||t.events.filter((e=>"AIAssistantTrigger"===e.data.type&&!e.data.disabled)).forEach((t=>{this.events.push(new N4(t.id,t.data,e,this.eventContext.page,this.eventContext.sharedAssets,this.eventManager))}))})),this.openAIRealtime.on("trigger_event",this.onTriggerEvent))}disconnect(){var e;null===(e=this.openAIRealtime)||void 0===e||e.off("trigger_event",this.onTriggerEvent)}},N4=class{constructor(e,t,n,i,r,s){this.id=e,this.data=t,this.object=n,this.actions=i1(t,t.actions,i,r,s,n)}dispatch(){let e=this.actions;e.Audio.forEach((e=>e.dispatchConditional())),e.Particles.forEach((e=>e.dispatchConditional())),e.Video.forEach((e=>e.dispatchConditional())),e.Create.forEach((e=>e.dispatch())),e.Destroy.forEach((e=>e.dispatch())),e.Reset.forEach((e=>e.dispatch())),e.Transition.forEach((e=>{e.object.currentTransitionEvent!==this&&(e.object.currentTransitionEvent=this),e.init()})),e.Transition.forEach((e=>e.play())),e.Animation.forEach((e=>e.play())),e.SwitchCamera.forEach((e=>e.play())),e.SceneTransition.forEach((e=>e.dispatch())),e.SetVariable.forEach((e=>e.checkConditions())),e.SetVariable.forEach((e=>e.dispatch())),e.DynamicVariablePlay.forEach((e=>e.dispatch())),e.ClearLocalStorage.forEach((e=>e.dispatch())),e.UserAPI.forEach((e=>e.dispatch()))}dispatchReverse(){let e=this.actions;e.Transition.forEach((e=>e.reverseFromCurrent())),e.Particles.forEach((e=>e.reverseFromCurrent())),e.Animation.forEach((e=>e.reverseFromCurrent())),e.SwitchCamera.forEach((e=>e.reverseFromCurrent())),e.Create.forEach((e=>e.dispatchStop()))}},j4=class{constructor(e,t,n,i,r){this.publish=e,this.controlsManager=t,this.animationControls=n,this.eventContext=i,this.sharedVariables=r,this.isEnabled=!1,this.activateCount=0,this.needsMouse=!1,this.needsRaycast=!1,this.onTouchMovePreventScroll=e=>{let t=window.parent!==window,n=document.documentElement.scrollHeight>document.documentElement.clientHeight||document.documentElement.scrollWidth>document.documentElement.clientWidth;(e.touches.length>1||this.preventTouchScroll||!1===t&&!1===n)&&e.preventDefault()},this.onMouseWheelPreventScroll=e=>{this.preventScroll&&e.preventDefault()},this.onMouseMove=e=>{this.eventContext.sharedAssets.mouseProperty=d(d({},this.getMousePosition(e)),{},{pressed:e.buttons>0})},this.onMouseDown=e=>{this.eventContext.sharedAssets.mouseProperty=d(d({},this.getMousePosition(e)),{},{pressed:!0})},this.onMouseUp=e=>{this.eventContext.sharedAssets.mouseProperty=d(d({},this.getMousePosition(e)),{},{pressed:!1})},this.getMousePosition=e=>{var t;let{domRect:n}=this.eventContext,{pageX:i,pageY:r}=(null===(t=e.touches)||void 0===t?void 0:t.length)>0?e.touches[0]:e;return{x:i-(n.left+window.scrollX),y:r-(n.top+window.scrollY)}},this.stopRaycast=e.stopRaycast,this.preventScroll=e.preventScroll,this.preventTouchScroll=e.preventTouchScroll,this.hideCursor=e.hideCursor,this.requestRender=i.requestRender}activate(){var e,t;let n=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.isEnabled)return;this.isEnabled=!0,this.initializeActionsDependentStates(),this.needsMouse&&(this.eventContext.domElement.addEventListener("pointermove",this.onMouseMove),this.eventContext.domElement.addEventListener("pointerdown",this.onMouseDown)),this.handlers={Spline:new l2(this.eventContext),VariableChange:new v3(this.eventContext,this.sharedVariables,this,this.needsMouse,this.needsRaycast),API:new S4(this.eventContext,this),WEBHOOK:new C4(this.eventContext,this),AIAssistantListener:new R4(this.eventContext,this),AIAssistantTrigger:new z4(this.eventContext,this),Conditional:new g2(this.eventContext,this),Start:new m3(this.eventContext,this),Basic:new c2(this.eventContext,this,this.needsRaycast),MouseHover:new c3(this.eventContext,this),Scroll:new p3(this.eventContext,this),Follow:new W2(this.eventContext,this),DragDrop:new k2(this.eventContext,this),LookAt:new s3(this.eventContext),Resize:new _4(this.eventContext,this),Textfields:new B4(this.eventContext,this)};let{page:i,domElement:r}=this.eventContext;this.hideCursor&&(r.style.cursor="none"),i.traverseEntity((e=>{e.addEventListener("requestRender",this.requestRender)})),Object.values(this.handlers).forEach((e=>e.connect())),r.addEventListener("wheel",this.onMouseWheelPreventScroll),r.addEventListener("touchmove",this.onTouchMovePreventScroll),this.activateCount++,n||(null!==(e=this.eventContext.sharedAssets.openAIRealtime)&&void 0!==e&&e.connect(),null===(t=this.eventContext.sharedAssets.openAIRealtime)||void 0===t||t.start())}deactivate(){var e;let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this.isEnabled)return;this.isEnabled=!1,this.eventContext.domElement.removeEventListener("pointermove",this.onMouseMove),this.eventContext.domElement.removeEventListener("pointerdown",this.onMouseDown),this.eventContext.domElement.removeEventListener("pointerup",this.onMouseUp),this.eventContext.sharedAssets.mouseProperty=null,this.eventContext.sharedAssets.raycastProperty=null;let{page:n,domElement:i}=this.eventContext;if(i.style.cursor="",Object.values(this.handlers).forEach((e=>e.disconnect())),null!==(e=this.controlsManager.gameControl)&&void 0!==e&&e.disposeActions(),this.controlsManager.disconnectEvents(),n.traverseEntity((e=>{e.removeEventListener("requestRender",this.requestRender),e.destroyedInAction=!1})),i.removeEventListener("touchmove",this.onTouchMovePreventScroll),i.removeEventListener("wheel",this.onMouseWheelPreventScroll),this.animationControls.onExitPlayMode(),!t){let e=this.eventContext.sharedAssets.openAIRealtime;null!==e&&void 0!==e&&e.disconnect(),null===e||void 0===e||e.stop().then((()=>{null===e||void 0===e||e.disconnect()}))}}get isPaused(){return this.isEnabled}pause(){this.deactivate()}resume(){this.activate()}reset(){this.deactivate(!0),this.activate(!0),this.controlsManager.deactivate(),this.controlsManager.activate(this),this.controlsManager.page.updateMatrixWorld(!0),this.controlsManager.rebuildBVH()}updateUseWindowEvents(e){let t=this.isEnabled;t&&this.deactivate(),this.eventContext.useWindowEvents=e,t&&this.activate()}initializeActionsDependentStates(){let e=this.eventContext.sharedAssets;e.resetDynamicVariablePlayState();let t=n=>{if("Conditional"===n.data.type&&(n.data.ifActions.forEach(t),n.data.elseActions.forEach(t)),"Conditional"===n.data.type||"SetVariable"===n.data.type)for(let e of"Conditional"===n.data.type?n.data.condition:n.data.expression)"id"in e&&Array.isArray(e.id)&&("mouse"===e.id[0]&&(this.needsMouse=!0),"raycast"===e.id[0]&&(this.needsRaycast=!0));"DynamicVariablePlay"===n.data.type&&""!==n.data.variableId&&("Play"===n.data.mode||"PlayPause"===n.data.mode||"Toggle"===n.data.mode)&&e.setDynamicVariablePlayState(n.data.variableId,"Stopped")};this.eventContext.page.traverseEntity((e=>{var n;if(null!==(n=e.data)&&void 0!==n&&n.events.length)for(let i of e.data.events)if("VariableChange"===i.data.type&&("mouseProperty"===i.data.variableId&&(this.needsMouse=!0),"raycastProperty"===i.data.variableId&&(this.needsRaycast=!0)),"Conditional"===i.data.type)for(let e of["inActions","outActions"])i.data[e].forEach(t);else if("DragDrop"===i.data.type)for(let e of["drag","drop"])i.data.dragDropActions[e].forEach(t);else if("GameControl"===i.data.type)for(let e of["idle","move","jump","run"])i.data.gameActions[e].forEach(t);else if("Resize"===i.data.type)for(let e of i.data.breakpoints)e.data.actions.forEach(t);else"LookAt"===i.data.type||"API"===i.data.type||i.data.actions.forEach(t)}))}},U4=class{constructor(e,t,n,i,r){this._aspect=1,this.enableResponsive=!1,this._renderer=e,this._camera=t,this._frameSize=(new lv).copy(n),this._editorSize=(new lv).copy(i),this._aspect=t.aspect,this._fov=null!==r&&void 0!==r?r:t.fov}set frameSize(e){this._frameSize.copy(e)}updateRenderer(){!this._renderer||this._renderer.setSize(this._frameSize.x,this._frameSize.y)}updateViewport(){if(!this._renderer||!this._camera||"PerspectiveCamera"!==this._camera.cameraType)return;let e=this._frameSize.x,t=this._frameSize.y,n=this._editorSize.y;this._aspect=e/t,t<=n&&(this._camera.zoom*=n/t),this._renderer.setViewport(0,0,e,t)}updateCamera(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(this._camera)if("PerspectiveCamera"===this._camera.cameraType){let t=this._frameSize.y,n=this._editorSize.y,i=this._fov;if(e&&t>n){let e=function(e,t,n,i,r){return(e-t)/(n-t)*(r-i)+i}(t,1080,2160,1,15)/100;i*=t/n,i*=1-e}this._camera.aspect=this._aspect,this._camera.fov=i,this._camera.updateProjectionMatrix()}else this._camera.setViewplaneSize(this._frameSize.x,this._frameSize.y,this.enableResponsive)}setCamera(e){this._camera=e,this._aspect=e.aspect,this._fov=e.fov}revert(){let e=window.innerWidth,t=window.innerHeight;this._renderer&&(this._renderer.setViewport(0,0,e,t),this._renderer.setSize(e,t)),this._camera&&(this._camera.aspect=e/t,this._camera.fov=this._fov,this._camera.setViewplaneSize(e,t,this.enableResponsive),this._camera.updateProjectionMatrix())}};var V4=class{get sharedAssets(){return this.shared}constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];this.shared=new vq(e.shared,t,!0,n),this.scene=new gJ(e.scene,this.sharedAssets),this.shared.setEntityOpContext({scene:this.scene,shared:this.shared})}reset(e,t){this.scene.clearScene(),this.sharedAssets.reset(e.shared),this.scene.resetAfterClear(e.scene,this.sharedAssets)}resetPersonalCameraFromDocumentData(){for(let e of this.scene.children)e instanceof iZ&&!e.uiScene&&e.personalCamera.updateState(e.data.camera,{scene:this.scene,shared:this.shared})}dispose(){this.scene.dispose(),this.shared.dispose()}gc(){this.shared.geometryCache.startGc(),this.shared.geometryCache2.startGc(),this.scene.traverseEntity((e=>{e instanceof Sq&&e.markGeometryAsReachable(this.shared)})),this.shared.geometryCache.endGc(),this.shared.geometryCache2.endGc()}},H4=class{constructor(e){let{x:t=10,y:n=10}=e;this._startTime=0;let i=document.getElementById("spe-perfs");i?this.element=i:(this.element=document.createElement("div"),document.body.appendChild(this.element),this.element.style.position="absolute",this.element.style.zIndex="10000",this.element.style.fontFamily="monospace",this.element.style.background="black",this.element.style.color="white",this.element.style.padding="10px",this.element.style.opacity="0.5",this.element.style.fontSize="11px",this.element.setAttribute("id","spe-perfs")),this.element.style.left="".concat(t,"px"),this.element.style.top="".concat(n,"px")}dispose(){var e;null===(e=this.element.parentElement)||void 0===e||e.removeChild(this.element)}start(){this._startTime=performance.now()}end(){let e=performance.now()-this._startTime;this.element.innerHTML=e.toFixed(3)+" ms"}};function W4(e){let t;if(e.index)for(let n=0;n<e.index.array.length;n+=3)t=e.index.array[n],e.index.array[n]=e.index.array[n+2],e.index.array[n+2]=t}function G4(e){return e instanceof Pq?"SubdivObject":"NonParametricGeometry"===e.geometry.type?"NonParametric":"Mesh"}function q4(e,t){let n=function(e,t){let n={};return e.traverseEntity((e=>{if(!e.visible||!(e instanceof FV)||"Mesh"!==e.type||Array.isArray(e.material)||e.states&&Object.keys(e.states).length)return;let i=e.parent;for(;i;){if(i instanceof FV&&e.states&&Object.keys(e.states).length)return;i=i.parent}let r=e.material.uuid,s=t.shared.materials[r];if(s){if(!yB.isMergable(s))return}else{var a;let n=null===(a=t.scene.objects.get(e.uuid))||void 0===a?void 0:a.data;if(n&&"material"in n&&"string"!=typeof n.material){if(!yB.isMergable(n.material))return;r=yB.getHash(n.material)}}n[r]||(n[r]={});let o=n[r][G4(e)];if(o){if(o.push(e),e.cloner)for(let t of e.cloner.children)o.push(t)}else if(n[r][G4(e)]=[e],e.cloner)for(let t of e.cloner.children)n[r][G4(e)].push(t)})),n}(t,e),i=function(e){let t=0;return Object.values(e).forEach((e=>{Object.values(e).forEach((e=>{let n=e.length;n>t&&(t=n)}))})),t}(n),r=new Array(i),s=0,a=new Array(i),o=0,l=new Array(i),u=0,c=new Array(i),h=0;for(let[d,p]of Object.entries(n))for(let e of Object.values(p)){if(o=0,u=0,e.forEach((e=>{e instanceof FV&&(a[o++]=e.geometry.clone(),l[u++]=e)})),u<2)continue;for(let e=0;e<u;e++)l[e].updateWorldMatrix(!0,!1),a[e].applyMatrix4(l[e].matrixWorld),l[e].matrixWorld.determinant()<0&&W4(a[e]);let i=aL(a.slice(0,o),!1);if(i){let e;if("SubdivObject"===d)console.warn("Turning subdiv object into mesh"),e=new Cx(i,l[0].material);else e=new Cx(i,l[0].material);e.castShadow=l[0].castShadow,e.receiveShadow=l[0].receiveShadow,t.add(e);let a=e=>{h=0;for(let t of e)t.children&&a(t.children),t instanceof FV&&(Array.isArray(t.material)||n[t.material.uuid]&&n[t.material.uuid][G4(t)]&&n[t.material.uuid][G4(t)].length>1||(c[h++]=t));for(let n=0;n<h;n++)t.attach(c[n])};for(let t=0;t<u;t++){let e=l[t];a(e.children),r[s++]=e}}}for(let d=0;d<s;d++)r[d].removeFromParent()}var Y4=Cm(km(),1),X4=new lv;var Q4=class{constructor(e){let{renderOnDemand:t,renderMode:n="auto"}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this._viewportMode=1,this._viewportWidth=window.innerWidth,this._viewportHeight=window.innerHeight,this._proxyObjectCache=new Map,this._variablesCache=new Map,this._isPaused=!1,this._renderRequested=!1,this._skipRender=!1,this.time=performance.now(),this.dt=0,this.currentTAAFrame=0,this.disposed=!1,this._requestRenderAutoMode=()=>{this._skipRender=!1},this.requestRender=()=>{this._renderRequested=!0},this.render=e=>{var t,n,i,r,s,a,o,l,u,c,h,d;if(this.time=e,this._lastTime&&(this.dt=this.time-this._lastTime),this._lastTime=this.time,null!==(t=this._perfs)&&void 0!==t&&t.start(),this._renderer)if(this._isPaused||!("manual"===this.renderMode&&!this._renderRequested||"auto"===this.renderMode&&this._skipRender)){if(this._renderRequested=!1,this._skipRender=!0,this._controls&&(this._skipRender=this._controls.update(this.dt)),this._eventManager&&(null!==(n=this._eventManager.handlers)&&void 0!==n&&n.Start.hasVideoAction||null!==(i=this._eventManager.handlers)&&void 0!==i&&i.Basic.hasVideoAction||null!==(r=this._eventManager.handlers)&&void 0!==r&&r.Conditional.hasVideoAction)&&(this._skipRender=!1),null!==(s=this._animationControls)&&void 0!==s&&s.update(this.dt),this._skipRender?(this.currentTAAFrame++,this.currentTAAFrame<32?this._skipRender=!1:this.currentTAAFrame=0):this.currentTAAFrame=0,null!==(a=this._scene)&&void 0!==a&&a.traverseVisibleEntity((e=>{"ParticleSystem"===e.type&&(e.update(this.dt),this._skipRender=!1)})),this._scene&&this._scene.activeCamera!==this._camera&&(this._camera=this._scene.activeCamera),null!==(o=this._eventManager)&&void 0!==o&&o.isEnabled&&((null===(l=this._eventManager.handlers)||void 0===l?void 0:l.Follow).onAnimationFrameDamping(),(null===(u=this._eventManager.handlers)||void 0===u?void 0:u.LookAt).onAnimationFrameDamping(),(null===(c=this._eventManager.handlers)||void 0===c?void 0:c.DragDrop).onAnimationFrameDamping()),this._scene&&this._camera){if(this._scene.pathConstraints.applyConstraints(this._scene),this._renderer.sceneTransitionTimeRemaining>0){this._renderer.sceneTransitionTimeRemaining-=this.dt;let e=1-this._renderer.sceneTransitionTimeRemaining/this._renderer.sceneTransitionDuration;this._renderer.pipeline.sceneTransitionPass.uniforms.mixRatio.value=e,this._skipRender=!1}else this._renderer.pipeline.sceneTransitionFromTexture=null;this._renderer.renderSplineScene(this._scene,this._camera)}this.canvas.dispatchEvent(this._renderedEvent),null===(h=this._perfs)||void 0===h||h.end()}else{var p;null===(p=this._perfs)||void 0===p||p.end()}else null===(d=this._perfs)||void 0===d||d.end()},this._resize=e=>{if(this._renderer){var t,n,i,r,s,a,o,l;if(1===this._viewportMode&&this._frameView&&(this._frameView.frameSize=X4.set(this._viewportWidth,this._viewportHeight)),e){let e=this._viewportWidth,t=this._viewportHeight;this._renderer.setSize(e-1,t-1,!1),this._renderer.setSize(e,t,!1)}else this._renderer.setSize(this._viewportWidth,this._viewportHeight,!1);if(this._camera=null===(t=this._scene)||void 0===t?void 0:t.activeCamera,null!==(n=this._scene)&&void 0!==n&&n.updateViewPlaneSize(null!==(i=null===(r=this._frameView)||void 0===r||null===(r=r.frameSize)||void 0===r?void 0:r.x)&&void 0!==i?i:this._viewportWidth,null!==(s=null===(a=this._frameView)||void 0===a||null===(a=a.frameSize)||void 0===a?void 0:a.y)&&void 0!==s?s:this._viewportHeight,null!==(o=null===(l=this._frameView)||void 0===l?void 0:l.enableResponsive)&&void 0!==o&&o),this._camera){var u,c,h,d,p;let e=null!==(u=Object.values(null!==(c=null===(h=this._data)||void 0===h?void 0:h.frames)&&void 0!==c?c:{})[0].preset)&&void 0!==u?u:"fullscreen";null!==(d=this._frameView)&&void 0!==d&&d.setCamera(this._camera),null!==(p=this._frameView)&&void 0!==p&&p.updateCamera("fullscreen"!==e),"PerspectiveCamera"===this._camera.cameraType&&(this._camera.aspect=this._viewportWidth/this._viewportHeight),this._camera.updateProjectionMatrix()}this.eventManager&&(this.eventManager.eventContext.domRect=this.canvas.getBoundingClientRect()),this._requestRenderAutoMode()}},this._debouncedResize=iF(this._resize,10),this._onScroll=e=>{this.eventManager&&(this.eventManager.eventContext.domRect=this.canvas.getBoundingClientRect())},this.canvas=e,this.renderMode=t?"auto":n,this._renderedEvent=new CustomEvent("rendered",{bubbles:!0}),Object.defineProperty(this._renderedEvent,"target",{writable:!1,value:this}),window.location.search.includes("perfs")&&(this._perfs=new H4({x:10,y:10})),function(e){e.addEventListener("pointerdown",BF,!0),e.addEventListener("pointerdown",LF,!0),e.addEventListener("pointermove",LF,!0),e.addEventListener("pointerup",RF,!0),e.addEventListener("pointercancel",RF,!0),e.addEventListener("pointerleave",RF,!0),window.addEventListener("keydown",NF,!0),window.addEventListener("keyup",jF,!0)}(e)}async load(e,t,n){(function(e){let t="The Spline Runtime only accepts .splinecode files that are generated from Spline export panel.";e.endsWith(".spline")?console.warn(t+" The .spline files are only meant to be used by the Editor."):e.endsWith(".splinecode")||console.warn(t)})(e),this.disposed=!1;let i=await(await fetch(e,n)).arrayBuffer();await this.start(i,{variables:t})}async start(e){var t,n,i,r,s;let{interactive:a=!0,variables:o}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this.disposed)return;let l=await async function(e,t){let[n,i]=BO(ik.deserialize(new Uint8Array(e)));return sL(n),t&&t(n),i.result().data}(e);this._data=l;let u=function(e){let t=[];return e.scene.objects.traverse(((e,n)=>{"Mesh"===n.type&&"NonParametricGeometry"===n.geometry.type&&void 0!==n.geometry.data.draco&&t.push(n)})),t}(l);l.version&&(0,Y4.default)(l.version,"1.9.59")>0&&console.warn("Your .splinecode file is more recent than the library. Please upgrade @splinetool/runtime to the latest version."),await Promise.all([u.length&&(f4||(f4=new y4).setDecoderPath("https://www.gstatic.com/draco/versioned/decoders/1.5.2/").preload(),f4.decoderPending),BY(l)&&fV(),Tq(l)&&WU(),sR.physicsEnabled(l.scene.objects)&&XF(),Qq(l)&&OG(),sJ(l)&&dJ(),SG(l)&&_G(),DK(l)&&wK(),M3(l)&&WF()].filter(Boolean)),u.length&&await async function(e){for(let t of e){let e=await b4(t.geometry.data.draco);if(e){let n=t.geometry.data;e.index&&(n.index={array:e.index.array,itemSize:1,normalized:!1,type:"Uint32Array"});let i={};e.attributes.forEach((e=>{let{name:t,array:n,itemSize:r}=e;i[t]={array:n,itemSize:r,type:"Float32Array",normalized:!1}})),n.attributes=i,n.draco=void 0}}}(u),null!==(t=this._eventManager)&&void 0!==t&&t.deactivate(),null!==(n=this._controls)&&void 0!==n&&n.deactivate(),null===(i=this._scene)||void 0===i||i.dispose();let c=new V4(l);if(c.resetPersonalCameraFromDocumentData(),this._scene=c.scene,this._sharedAssetsManager=c.sharedAssets,this._camera=this._scene.activeCamera,window.location.search.includes("merge-geometries")){let e=performance.now();q4(l,c.scene);let t=performance.now();console.log("Merged geometries in ",t-e," ms")}BY(l)&&this._scene.traverse((e=>{jY(e)&&e.recomputeBoolean()})),this._sharedAssetsManager.setRequestRender((()=>{var e;this._requestRenderAutoMode(),null===(e=this._scene)||void 0===e||e.traverse((e=>{e instanceof pY&&e.pendingMediaLoad&&e.update()}))})),null===(r=this._scene)||void 0===r||r.traverse((e=>{"ParticleSystem"===e.type&&(e.wakeUp(),e.data.autoPlay?e.start():e.stop())}));let h=Object.keys(l.shared.fonts).map((e=>this._sharedAssetsManager.getFont(e).loadingPromise));if(Promise.all(h).then((()=>{c.scene.markNeedsUpdateRendererDirty(),this._requestRenderAutoMode()})),Qq(l)&&function(e){if(sR.physicsEnabled(e.scene.objects))return!0;let t=!1;return e.scene.objects.traverse(((e,n)=>{if(n.events)if(Array.isArray(n.events)){for(let i of n.events)if(!0!==i.data.disabled&&"GameControl"===i.data.type&&i.data.collisionEnabled){t=!0;break}}else for(let i of Object.values(n.events))if(!0!==i.disabled&&"GameControl"===i.type&&i.collisionEnabled){t=!0;break}})),t}(l)&&await Promise.all(h),DK(l)){let e=[];this._scene.traverseEntity((t=>{(t instanceof pZ||t instanceof iZ)&&t.uiCanvas&&e.push(t.uiCanvas)})),await Promise.all(e.map((e=>e.promise)))}if(this._scene.rewriteEventsBeforeGoToPlayMode(),B0(this._scene.activePage,this._sharedAssetsManager),!this._renderer&&(this._renderer=new VQ({canvas:this.canvas,antialias:!1,alpha:!0,stencil:!1,depth:!1,powerPreference:"high-performance"}),this._renderer.hdTransmission=!0===l.scene.publish.hdTransmission,this._renderer.setPixelRatio(window.devicePixelRatio),this._renderer.pipeline.enableUIOverlay(),this._renderer.pipeline.addEventListener("smaaloaded",this._requestRenderAutoMode),l.shared.images.SplineWatermark)){let e=this._sharedAssetsManager.getImage("SplineWatermark");await e.loadPromise;let t=e.getTexture(1001);this._renderer.pipeline.setWatermark(t)}sJ(l)&&this._scene.initializeSplatViewer(),void 0!==l.scene.blueNoiseTextureData&&this._renderer.pipeline.updateBlueNoiseTexture(l.scene.blueNoiseTextureData);let d=Object.values(l.frames)[0];if(this._frameView?this._frameView.setCamera(this._camera):("fullscreen"===d.preset?(this._viewportMode=1,this.canvas.style.display="block",this.canvas.parentElement&&(this._viewportWidth=this.canvas.parentElement.clientWidth||300,this.canvas.style.width="100%"),this.canvas.parentElement&&(this._viewportHeight=this.canvas.parentElement.clientHeight||150,this.canvas.style.height="100%")):(this._viewportMode=2,this._viewportWidth=d.size[0],this._viewportHeight=d.size[1],this.canvas.style.width="".concat(this._viewportWidth,"px"),this.canvas.style.height="".concat(this._viewportHeight,"px")),this._renderer.setSize(this._viewportWidth,this._viewportHeight,!1),this._frameView=new U4(this._renderer,this._camera,new lv(this._viewportWidth,this._viewportHeight),new lv(window.innerWidth,window.innerHeight)),this._frameView.enableResponsive=null!==(s=d.allowResponsive)&&void 0!==s&&s&&"fullscreen"===d.preset),a){let e=new n2(this._renderer,this.data.scene.publish,this._scene,(()=>this._scene.activeCamera),this._sharedAssetsManager,this._requestRenderAutoMode,!0,d);this._scene.updateMatrixWorld(!0),this._controls=new d4(e),this._animationControls=new g4(this._scene,this._requestRenderAutoMode),this._eventManager=new j4(l.scene.publish,this._controls,this._animationControls,e,l.shared.variables),this._eventManager.activate(),this._controls.activate(this._eventManager)}this._resize(),this._scene.activePage.data.postprocessing.depthOfField.enabled&&Promise.all(this._sharedAssetsManager.getImageLoadPromises()).then((()=>{this._resize(!0)})),void 0!==o&&this.setVariables(o),0===this.dt&&(this.render(performance.now()),setTimeout((()=>{var e;null===(e=this._renderer)||void 0===e||e.setAnimationLoop(this.render)}),0)),this._resizeObserverTimeout=setTimeout((()=>{!this._resizeObserver&&this.canvas.parentElement&&(this._resizeObserver=new ResizeObserver((()=>{this._viewportWidth=this.canvas.clientWidth,this._viewportHeight=this.canvas.clientHeight,this._debouncedResize()})),this._resizeObserver.observe(this.canvas.parentElement))}),300),document.addEventListener("scroll",this._onScroll)}setVariables(e){if(void 0!==this._data){let t=Object.entries(e);for(let[e,n]of t)this.setVariable(e,n)}}setVariable(e,t){let n=this._getVariableByName(e);if(n&&!("dynamicVariableType"in n.data)){var i;let e=t;"number"==typeof n.data.value?e="number"==typeof t?t:"boolean"==typeof t?!0===t?1:0:parseFloat(t):"boolean"==typeof n.data.value?e="number"==typeof t?!!t:"boolean"==typeof t?t:"false"!==t.toLocaleLowerCase()&&!!t:"string"!=typeof n.data.value&&void 0!==n.data.value.textValue&&(e=t.toString());let r="string"==typeof e?{textValue:e}:e;null!==(i=this._sharedAssetsManager)&&void 0!==i&&i.updateVariable(n.id,r),this.requestRender(),this._requestRenderAutoMode()}else void 0===n?console.warn("No variable named ".concat(e," was found in your Spline file. Make sure to create it from Spline editor.")):"dynamicVariableType"in n.data&&console.warn("Dynamic variables like ".concat(e," cannot be updated from code."))}getVariables(){let e={};return this._data&&this._data.shared.variables.forEach((t=>{void 0===e[t.data.name]&&(e[t.data.name]=this._getVariableValue(this._sharedAssetsManager.getVariable(t.id)))})),e}getVariable(e){let t=this._getVariableByName(e);if(t){let e=this._sharedAssetsManager.getVariable(t.id);return this._getVariableValue(e)}}_getVariableValue(e){return"string"!=typeof e&&cR.isTextValue(e)?cR.getDisplayedValue(e):e}_getVariableByName(e){if(this._data){if(this._variablesCache.has(e))return this._variablesCache.get(e);let t=this._data.shared.variables.find((t=>t.data.name===e));return t&&this._variablesCache.set(e,t),t}}findObjectById(e){var t;let n=null===(t=this._scene)||void 0===t?void 0:t.getObjectByProperty("uuid",e);return this._createProxyObject(n)}findObjectByName(e){var t;let n=null===(t=this._scene)||void 0===t?void 0:t.getObjectByName(e);return this._createProxyObject(n)}getAllObjects(){var e;let t=[];return null!==(e=this._scene)&&void 0!==e&&e.traverseEntity((e=>{if(e.uuid!==Kk&&!this._scene.isInvisibleObjects(e)&&!(e instanceof iZ)){let n=this._createProxyObject(e);n&&t.push(n)}})),t}getSplineEvents(){var e;return(null===(e=this._eventManager)||void 0===e||null===(e=e.handlers)||void 0===e?void 0:e.Spline).splineEvents}emitEvent(e,t){var n;null===(n=this.findObjectById(t)||this.findObjectByName(t))||void 0===n||n.emitEvent(e)}emitEventReverse(e,t){var n;null===(n=this.findObjectById(t)||this.findObjectByName(t))||void 0===n||n.emitEventReverse(e)}addEventListener(e,t){this.canvas.addEventListener(e,t)}removeEventListener(e,t){this.canvas.removeEventListener(e,t)}setZoom(e){var t,n;(null===(t=this._controls)||void 0===t?void 0:t.orbitControls)instanceof W3&&(null===(n=this._controls)||void 0===n||n.orbitControls.setZoom(e))}get eventManager(){return this._eventManager}get controls(){return this._controls}setSize(e,t){this._viewportWidth=e,this._viewportHeight=t,this._viewportMode=2,this._resize()}setBackgroundColor(e){var t;let{r:n,g:i,b:r,a:s}={r:0,g:0,b:0,a:1},a=new jV(n,i,r,s);try{a.setStyle(e)}catch(o){console.error("This is not a valid css color",e)}null!==(t=this._scene)&&void 0!==t&&t.activePage.setBackgroundColor(a),this._requestRenderAutoMode()}dispose(){var e,t,n,i,r,s,a;this.disposed=!0,null!==(e=this._eventManager)&&void 0!==e&&e.deactivate(),null!==(t=this._scene)&&void 0!==t&&t.dispose(),null!==(n=this._sharedAssetsManager)&&void 0!==n&&n.dispose(),this._proxyObjectCache.forEach((e=>{bC.unsubscribe(e)})),this._variablesCache.clear(),null!==(i=this._renderer)&&void 0!==i&&i.setAnimationLoop(null),null!==(r=this._renderer)&&void 0!==r&&r.dispose(),this._renderer=void 0,null!==(s=this._sharedAssetsManager)&&void 0!==s&&s.dispose(),this._resizeObserver&&(this._resizeObserver.disconnect(),this._resizeObserver=void 0),void 0!==this._resizeObserverTimeout&&clearTimeout(this._resizeObserverTimeout),this.canvas.style.width="",this.canvas.style.height="",this.canvas.removeAttribute("width"),this.canvas.removeAttribute("height"),this._frameView&&(this._frameView=void 0),null!==(a=this._controls)&&void 0!==a&&a.deactivate(),this.dt=0,function(e){e.removeEventListener("pointerdown",BF,!0),e.removeEventListener("pointerdown",LF,!0),e.removeEventListener("pointermove",LF,!0),e.removeEventListener("pointerup",RF,!0),e.removeEventListener("pointercancel",RF,!0),e.removeEventListener("pointerleave",RF,!0),window.removeEventListener("keydown",NF,!0),window.removeEventListener("keyup",jF,!0)}(this.canvas),document.removeEventListener("scroll",this._onScroll)}get isStopped(){return this._isPaused}stop(){var e,t,n;this._isPaused||(null!==(e=this._renderer)&&void 0!==e&&e.setAnimationLoop(null),this._isPaused=!0,null!==(t=this._eventManager)&&void 0!==t&&t.pause(),(null===(n=this._controls)||void 0===n?void 0:n.orbitControls)&&(this._controls.orbitControls.enabled=!1))}play(){var e,t,n;!this._isPaused||(this._isPaused=!1,null!==(e=this._eventManager)&&void 0!==e&&e.resume(),null!==(t=this._controls)&&void 0!==t&&t.orbitControls&&(this._controls.orbitControls.enabled=!0),null===(n=this._renderer)||void 0===n||n.setAnimationLoop(this.render))}setGlobalEvents(e){var t;null===(t=this._eventManager)||void 0===t||t.updateUseWindowEvents(e)}get data(){return this._data}_createProxyObject(e){var t;if(null==e)return;if(this._proxyObjectCache.has(e.uuid))return this._proxyObjectCache.get(e.uuid);let n;e.traverseAncestors((e=>{e instanceof iZ&&(n=e.name)}));let i={name:e.name,uuid:e.uuid,visible:e.visible,intensity:e.intensity,position:e.position,rotation:e.rotation,scale:e.scale,type:e.data.type,page:n,parentUuid:e.parent instanceof iZ||e instanceof gJ||null===(t=e.parent)||void 0===t?void 0:t.uuid,emitEvent(t){e.dispatchEvent({type:"userEvent",eventName:t})},emitEventReverse(t){e.dispatchEvent({type:"userEvent",eventName:t,reverse:!0})}},r=bC(i,((t,n)=>{var i;"object"!=typeof e[t]&&null!==(i=Object.getOwnPropertyDescriptor(e,t))&&void 0!==i&&i.writable&&(e[t]=n),this._requestRenderAutoMode(),e.updateMatrix()}));return this._proxyObjectCache.set(e.uuid,r),r}setUIWasmUrl(e){pW.skiaWasmUrl=e}},K4=n(446);function Z4(e){return t=>{e.forEach((e=>{"function"==typeof e?e(t):null!=e&&(e.current=t)}))}}const J4=["className","children","debounceTime","ignoreDimensions","parentSizeStyles","enableDebounceLeadingCall","resizeObserverPolyfill"],$4=[],e5={width:"100%",height:"100%"},t5=(0,r.forwardRef)((function(e,t){let{className:n,children:i,debounceTime:s=300,ignoreDimensions:a=$4,parentSizeStyles:l,enableDebounceLeadingCall:u=!0,resizeObserverPolyfill:c}=e,h=o(e,J4);const p=(0,r.useRef)(null),f=(0,r.useRef)(0),[m,g]=(0,r.useState)({width:0,height:0,top:0,left:0}),v=(0,r.useMemo)((()=>{const e=Array.isArray(a)?a:[a];return K4((t=>{g((n=>Object.keys(n).filter((e=>n[e]!==t[e])).every((t=>e.includes(t)))?n:t))}),s,{leading:u})}),[s,u,a]);return(0,r.useEffect)((()=>{const e=new(c||window.ResizeObserver)((e=>{e.forEach((e=>{var t;const{left:n,top:i,width:r,height:s}=null!==(t=null==e?void 0:e.contentRect)&&void 0!==t?t:{};f.current=window.requestAnimationFrame((()=>{v({width:r,height:s,top:i,left:n})}))}))}));return p.current&&e.observe(p.current),()=>{window.cancelAnimationFrame(f.current),e.disconnect(),v.cancel()}}),[v,c]),(0,lo.jsx)("div",d(d({style:d(d({},e5),l),ref:Z4([t,p]),className:n},h),{},{children:i(d(d({},m),{},{ref:p.current,resize:v}))}))})),n5=["scene","style","onSplineMouseDown","onSplineMouseUp","onSplineMouseHover","onSplineKeyDown","onSplineKeyUp","onSplineStart","onSplineLookAt","onSplineFollow","onSplineScroll","onLoad","renderOnDemand","children"],i5=(0,r.forwardRef)(((e,t)=>{let{scene:n,style:i,onSplineMouseDown:s,onSplineMouseUp:a,onSplineMouseHover:l,onSplineKeyDown:u,onSplineKeyUp:c,onSplineStart:h,onSplineLookAt:p,onSplineFollow:f,onSplineScroll:m,onLoad:g,renderOnDemand:v=!0,children:y}=e,x=o(e,n5);const b=(0,r.useRef)(null),[w,D]=(0,r.useState)(!0),[_,S]=(0,r.useState)();if(_)throw _;return(0,r.useEffect)((()=>{let e;D(!0);const t=[{name:"mouseDown",cb:s},{name:"mouseUp",cb:a},{name:"mouseHover",cb:l},{name:"keyDown",cb:u},{name:"keyUp",cb:c},{name:"start",cb:h},{name:"lookAt",cb:p},{name:"follow",cb:f},{name:"scroll",cb:m}];if(b.current){async function i(){await e.load(n);for(let n of t)n.cb&&e.addEventListener(n.name,n.cb);D(!1),null==g||g(e)}e=new Q4(b.current,{renderOnDemand:v}),i().catch((e=>{S(e)}))}return()=>{for(let n of t)n.cb&&e.removeEventListener(n.name,n.cb);e.dispose()}}),[n]),(0,lo.jsx)(t5,d(d({ref:t,parentSizeStyles:d({overflow:"hidden"},i),debounceTime:50},x),{},{children:()=>(0,lo.jsxs)(lo.Fragment,{children:[w&&y,(0,lo.jsx)("canvas",{ref:b,style:{display:w?"none":"block"}})]})}))}));function r5(){return(0,lo.jsx)("main",{children:(0,lo.jsx)(i5,{scene:"https://prod.spline.design/nZMd7MnQ9PnHoIhu/scene.splinecode"})})}const s5=()=>(0,lo.jsxs)("div",{className:"event-services-container",children:[(0,lo.jsx)("h2",{class:"text-4xl font-semibold text-center text-gray-800 mb-6 decoration-indigo-600",children:"We also offer unique services for your events"}),(0,lo.jsxs)("div",{className:"event-services",children:[(0,lo.jsxs)("div",{className:"service-item",children:[(0,lo.jsx)("img",{src:"https://media.istockphoto.com/id/944478708/photo/couple-eating-lunch-with-fresh-salad-and-appetizers.jpg?s=612x612&w=0&k=20&c=xZdIIHvakQrYCbR59RM8nrhEnw-xu4nE-BOeOhQPnck=",alt:"Caterings"}),(0,lo.jsx)("h3",{children:"Caterings"}),(0,lo.jsx)("p",{children:"In the new era of technology we look in the future with certainty for life."})]}),(0,lo.jsxs)("div",{className:"service-item",children:[(0,lo.jsx)("img",{src:"https://images.pexels.com/photos/2388657/pexels-photo-2388657.jpeg?auto=compress&cs=tinysrgb&w=800",alt:"Birthdays"}),(0,lo.jsx)("h3",{children:"Birthdays"}),(0,lo.jsx)("p",{children:"In the new era of technology we look in the future with certainty for life."})]}),(0,lo.jsxs)("div",{className:"service-item",children:[(0,lo.jsx)("img",{src:"https://images.pexels.com/photos/976866/pexels-photo-976866.jpeg?auto=compress&cs=tinysrgb&w=800",alt:"Events"}),(0,lo.jsx)("h3",{children:"Events"}),(0,lo.jsx)("p",{children:"In the new era of technology we look in the future with certainty for life."})]})]})]}),a5=n.p+"static/media/welcome.03fcfe47a4edda2dc0a1.png",o5=n.p+"static/media/section1.ef26c2c8cfdbe0caddf3.png",l5=(n.p,n.p+"static/media/section3.f2b6573ddcdccb79c10a.png"),u5=(n.p,()=>(0,lo.jsxs)("footer",{className:"bg-gray-800 text-gray-300 py-16 px-20 flex flex-wrap justify-around items-center",children:[(0,lo.jsxs)("div",{className:"max-w-sm mb-16",children:[(0,lo.jsxs)("h2",{className:"text-2xl font-bold text-white mb-4",children:[(0,lo.jsx)("i",{className:"fa-solid fa-bowl-food"})," College Mess"]}),(0,lo.jsx)("p",{className:"text-sm mb-4",children:"In the new era of technology, we look at the future with certainty and pride for our company."}),(0,lo.jsxs)("div",{className:"flex gap-4",children:[(0,lo.jsx)("a",{href:"#",className:"w-9 h-9 bg-red-500 text-white rounded-full flex items-center justify-center text-xl hover:scale-110 transition-transform",children:"T"}),(0,lo.jsx)("a",{href:"#",className:"w-9 h-9 bg-red-500 text-white rounded-full flex items-center justify-center text-xl hover:scale-110 transition-transform",children:"F"}),(0,lo.jsx)("a",{href:"#",className:"w-9 h-9 bg-red-500 text-white rounded-full flex items-center justify-center text-xl hover:scale-110 transition-transform",children:"I"}),(0,lo.jsx)("a",{href:"#",className:"w-9 h-9 bg-red-500 text-white rounded-full flex items-center justify-center text-xl hover:scale-110 transition-transform",children:"G"})]})]}),(0,lo.jsxs)("div",{className:"flex gap-24",children:[(0,lo.jsxs)("ul",{className:"space-y-3 text-sm",children:[(0,lo.jsx)("li",{children:(0,lo.jsx)("a",{href:"#",className:"hover:text-red-500",children:"Home"})}),(0,lo.jsx)("li",{children:(0,lo.jsx)("a",{href:"#",className:"hover:text-red-500",children:"About"})}),(0,lo.jsx)("li",{children:(0,lo.jsx)("a",{href:"#",className:"hover:text-red-500",children:"Menu"})}),(0,lo.jsx)("li",{children:(0,lo.jsx)("a",{href:"#",className:"hover:text-red-500",children:"Pricing"})}),(0,lo.jsx)("li",{children:(0,lo.jsx)("a",{href:"#",className:"hover:text-red-500",children:"Blog"})}),(0,lo.jsx)("li",{children:(0,lo.jsx)("a",{href:"#",className:"hover:text-red-500",children:"Contact"})}),(0,lo.jsx)("li",{children:(0,lo.jsx)("a",{href:"#",className:"hover:text-red-500",children:"Delivery"})})]}),(0,lo.jsxs)("ul",{className:"space-y-3 text-sm",children:[(0,lo.jsx)("li",{children:(0,lo.jsx)("a",{href:"#",className:"hover:text-red-500",children:"Start Here"})}),(0,lo.jsx)("li",{children:(0,lo.jsx)("a",{href:"#",className:"hover:text-red-500",children:"Styleguide"})}),(0,lo.jsx)("li",{children:(0,lo.jsx)("a",{href:"#",className:"hover:text-red-500",children:"Password Protected"})}),(0,lo.jsx)("li",{children:(0,lo.jsx)("a",{href:"#",className:"hover:text-red-500",children:"404 Not Found"})}),(0,lo.jsx)("li",{children:(0,lo.jsx)("a",{href:"#",className:"hover:text-red-500",children:"Licenses"})}),(0,lo.jsx)("li",{children:(0,lo.jsx)("a",{href:"#",className:"hover:text-red-500",children:"Changelog"})}),(0,lo.jsx)("li",{children:(0,lo.jsx)("a",{href:"#",className:"hover:text-red-500",children:"View More"})})]})]}),(0,lo.jsx)("div",{className:"text-center text-sm text-gray-500 py-4 bg-gray-700 w-full mt-16",children:"Copyright \xa9 2023 Hashtag Developer. All Rights Reserved."})]})),c5=()=>{const e=(0,r.useRef)(null);return(0,r.useLayoutEffect)((()=>{Xh.registerPlugin(tm);let t=Xh.context((()=>{Xh.timeline().from("#intro-slider",{xPercent:"-100",duration:1.3,delay:.3}).from(["#title-1","#title-2","#title-3"],{opacity:0,y:"+=30",stagger:.5}).to(["#title-1","#title-2","#title-3"],{opacity:0,y:"-=30",delay:.3,stagger:.5}).to("#intro-slider",{xPercent:"-100",duration:1.3}).from("#welcome",{opacity:0,duration:.5});let e=document.querySelector(".content").scrollWidth;Xh.to(".pinned-section .content",{x:()=>-e+window.innerWidth,ease:"none",scrollTrigger:{trigger:".pinned-section",start:"top top",end:"+=".concat(e),pin:!0,scrub:!0,invalidateOnRefresh:!0}})}),e);return()=>t.revert()}),[]),(0,lo.jsxs)("div",{className:"relative",ref:e,children:[(0,lo.jsxs)("div",{id:"intro-slider",className:"h-screen p-10 bg-gray-50 absolute top-0 left-0 font-spaceGrotesk z-10 w-full flex flex-col gap-10 tracking-tight bg-cover bg-center",style:{backgroundImage:"url('https://raw.githubusercontent.com/prem-choithani23/Team-Ideators/refs/heads/master/images/canteen_demo4.png')"},children:[(0,lo.jsx)("h1",{className:"text-8xl font-extrabold text-transparent bg-clip-text bg-gradient-to-r from-orange-500 to-red-600 drop-shadow-lg",id:"title-1",children:"Best Food"}),(0,lo.jsx)("h1",{className:"text-8xl font-extrabold text-transparent bg-clip-text bg-gradient-to-r from-green-500 to-teal-600 drop-shadow-lg",id:"title-2",children:"For Your"}),(0,lo.jsx)("h1",{className:"text-8xl font-extrabold text-transparent bg-clip-text bg-gradient-to-r from-purple-500 to-pink-600 drop-shadow-lg",id:"title-3",children:"Taste"})]}),(0,lo.jsxs)("div",{className:"h-screen flex justify-center items-center relative bg-gray-950",children:[(0,lo.jsx)("img",{src:a5,alt:"Description",className:"absolute inset-0 h-full w-full object-cover"}),(0,lo.jsx)("h1",{id:"welcome",className:"text-9xl font-bold text-b-100 font-spaceGrotesk z-10 absolute left-[2rem]",children:"Welcome"})]}),(0,lo.jsx)("section",{className:"pinned-section h-screen flex items-center overflow-hidden bg-gray-800",children:(0,lo.jsxs)("div",{className:"content flex gap-10 w-[300vw]",children:[(0,lo.jsx)("div",{className:"w-screen h-screen flex items-center justify-center text-white text-6xl bg-red-500",children:(0,lo.jsx)("img",{src:o5,alt:"Background"})}),(0,lo.jsx)("div",{className:"w-screen h-screen flex items-center justify-center text-white text-6xl bg-blue-500",children:(0,lo.jsx)("img",{src:l5,alt:"Background"})}),(0,lo.jsx)("div",{className:"w-screen h-screen flex items-center justify-center text-white text-6xl bg-green-500",children:(0,lo.jsx)("img",{src:l5,alt:"Background"})})]})}),(0,lo.jsx)("section",{className:"relative h-screen flex justify-center items-center bg-gray-700 text-white text-6xl",children:(0,lo.jsx)(u5,{})})]})},h5="Tom Cook",d5="tom@example.com",p5="https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=facearea&facepad=2&w=256&h=256&q=80",f5=[{name:"Dashboard",href:"dashboard",current:!0},{name:"Menu",href:"ai",current:!1},{name:"Orders",href:"users",current:!1},{name:"Analytics",href:"analytics",current:!1}],m5=[{name:"Your Profile",href:"#"},{name:"Settings",href:"#"},{name:"Sign out",href:"#"}];function g5(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.filter(Boolean).join(" ")}function v5(){return(0,lo.jsx)(lo.Fragment,{children:(0,lo.jsxs)("div",{className:"min-h-full",children:[(0,lo.jsxs)(yi,{as:"nav",className:"bg-gray-800",children:[(0,lo.jsx)("div",{className:"mx-auto max-w-7xl px-4 sm:px-6 lg:px-8",children:(0,lo.jsxs)("div",{className:"flex h-16 items-center justify-between",children:[(0,lo.jsxs)("div",{className:"flex items-center",children:[(0,lo.jsx)("div",{className:"shrink-0",children:(0,lo.jsx)("img",{alt:"Your Company",src:"https://tailwindui.com/plus/img/logos/mark.svg?color=indigo&shade=500",className:"size-8",url:"http://localhost:3000/profile"})}),(0,lo.jsx)("div",{className:"hidden md:block",children:(0,lo.jsx)("div",{className:"ml-10 flex items-baseline space-x-4",children:f5.map((e=>(0,lo.jsx)("a",{href:e.href,"aria-current":e.current?"page":void 0,className:g5(e.current?"bg-gray-900 text-white":"text-gray-300 hover:bg-gray-700 hover:text-white","rounded-md px-3 py-2 text-sm font-medium"),children:e.name},e.name)))})})]}),(0,lo.jsx)("div",{className:"hidden md:block",children:(0,lo.jsxs)("div",{className:"ml-4 flex items-center md:ml-6",children:[(0,lo.jsxs)("button",{type:"button",className:"relative rounded-full bg-gray-800 p-1 text-gray-400 hover:text-white focus:outline-none focus:ring-2 focus:ring-white focus:ring-offset-2 focus:ring-offset-gray-800",children:[(0,lo.jsx)("span",{className:"absolute -inset-1.5"}),(0,lo.jsx)("span",{className:"sr-only",children:"View notifications"}),(0,lo.jsx)(to,{"aria-hidden":"true",className:"size-6"})]}),(0,lo.jsxs)(Ja,{as:"div",className:"relative ml-3",children:[(0,lo.jsx)("div",{children:(0,lo.jsxs)(qa,{className:"relative flex max-w-xs items-center rounded-full bg-gray-800 text-sm focus:outline-none focus:ring-2 focus:ring-white focus:ring-offset-2 focus:ring-offset-gray-800",children:[(0,lo.jsx)("span",{className:"absolute -inset-1.5"}),(0,lo.jsx)("span",{className:"sr-only",children:"Open user menu"}),(0,lo.jsx)("img",{alt:"",src:p5,className:"size-8 rounded-full"})]})}),(0,lo.jsx)(Ya,{transition:!0,className:"absolute right-0 z-10 mt-2 w-48 origin-top-right rounded-md bg-white py-1 shadow-lg ring-1 ring-black/5 transition focus:outline-none data-[closed]:scale-95 data-[closed]:transform data-[closed]:opacity-0 data-[enter]:duration-100 data-[leave]:duration-75 data-[enter]:ease-out data-[leave]:ease-in",children:m5.map((e=>(0,lo.jsx)(Xa,{children:(0,lo.jsx)("a",{href:e.href,className:"block px-4 py-2 text-sm text-gray-700 data-[focus]:bg-gray-100 data-[focus]:outline-none",children:e.name})},e.name)))})]})]})}),(0,lo.jsx)("div",{className:"-mr-2 flex md:hidden",children:(0,lo.jsxs)(gi,{className:"group relative inline-flex items-center justify-center rounded-md bg-gray-800 p-2 text-gray-400 hover:bg-gray-700 hover:text-white focus:outline-none focus:ring-2 focus:ring-white focus:ring-offset-2 focus:ring-offset-gray-800",children:[(0,lo.jsx)("span",{className:"absolute -inset-0.5"}),(0,lo.jsx)("span",{className:"sr-only",children:"Open main menu"}),(0,lo.jsx)(ro,{"aria-hidden":"true",className:"block size-6 group-data-[open]:hidden"}),(0,lo.jsx)(oo,{"aria-hidden":"true",className:"hidden size-6 group-data-[open]:block"})]})})]})}),(0,lo.jsxs)(vi,{className:"md:hidden",children:[(0,lo.jsx)("div",{className:"space-y-1 px-2 pb-3 pt-2 sm:px-3",children:f5.map((e=>(0,lo.jsx)(gi,{as:"a",href:e.href,"aria-current":e.current?"page":void 0,className:g5(e.current?"bg-gray-900 text-white":"text-gray-300 hover:bg-gray-700 hover:text-white","block rounded-md px-3 py-2 text-base font-medium"),children:e.name},e.name)))}),(0,lo.jsxs)("div",{className:"border-t border-gray-700 pb-3 pt-4",children:[(0,lo.jsxs)("div",{className:"flex items-center px-5",children:[(0,lo.jsx)("div",{className:"shrink-0",children:(0,lo.jsx)("img",{alt:"",src:p5,className:"size-10 rounded-full"})}),(0,lo.jsxs)("div",{className:"ml-3",children:[(0,lo.jsx)("div",{className:"text-base/5 font-medium text-white",children:h5}),(0,lo.jsx)("div",{className:"text-sm font-medium text-gray-400",children:d5})]}),(0,lo.jsxs)("button",{type:"button",className:"relative ml-auto shrink-0 rounded-full bg-gray-800 p-1 text-gray-400 hover:text-white focus:outline-none focus:ring-2 focus:ring-white focus:ring-offset-2 focus:ring-offset-gray-800",children:[(0,lo.jsx)("span",{className:"absolute -inset-1.5"}),(0,lo.jsx)("span",{className:"sr-only",children:"View notifications"}),(0,lo.jsx)(to,{"aria-hidden":"true",className:"size-6"})]})]}),(0,lo.jsx)("div",{className:"mt-3 space-y-1 px-2",children:m5.map((e=>(0,lo.jsx)(gi,{as:"a",href:e.href,className:"block rounded-md px-3 py-2 text-base font-medium text-gray-400 hover:bg-gray-700 hover:text-white",children:e.name},e.name)))})]})]})]}),(0,lo.jsx)("header",{className:"bg-white shadow",children:(0,lo.jsx)("div",{className:"mx-auto max-w-7xl px-4 py-6 sm:px-6 lg:px-8",children:(0,lo.jsx)("h1",{className:"text-3xl font-bold tracking-tight text-gray-900",children:"Dashboard"})})}),(0,lo.jsx)("main",{children:(0,lo.jsx)("div",{className:"mx-auto ",children:(0,lo.jsx)(c5,{})})})]})})}var y5={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},x5=r.createContext&&r.createContext(y5),b5=["attr","size","title"];function w5(e,t){if(null==e)return{};var n,i,r=function(e,t){if(null==e)return{};var n={};for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){if(t.indexOf(i)>=0)continue;n[i]=e[i]}return n}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(i=0;i<s.length;i++)n=s[i],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function D5(){return D5=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},D5.apply(this,arguments)}function _5(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function S5(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?_5(Object(n),!0).forEach((function(t){E5(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_5(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function E5(e,t,n){return t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function C5(e){return e&&e.map(((e,t)=>r.createElement(e.tag,S5({key:t},e.attr),C5(e.child))))}function A5(e){return t=>r.createElement(M5,D5({attr:S5({},e.attr)},t),C5(e.child))}function M5(e){var t=t=>{var n,{attr:i,size:s,title:a}=e,o=w5(e,b5),l=s||t.size||"1em";return t.className&&(n=t.className),e.className&&(n=(n?n+" ":"")+e.className),r.createElement("svg",D5({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},t.attr,i,o,{className:n,style:S5(S5({color:e.color||t.color},t.style),e.style),height:l,width:l,xmlns:"http://www.w3.org/2000/svg"}),a&&r.createElement("title",null,a),e.children)};return void 0!==x5?r.createElement(x5.Consumer,null,(e=>t(e))):t(y5)}function T5(e){return A5({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M476 3.2L12.5 270.6c-18.1 10.4-15.8 35.6 2.2 43.2L121 358.4l287.3-253.2c5.5-4.9 13.3 2.6 8.6 8.3L176 407v80.5c0 23.6 28.5 32.9 42.5 15.8L282 426l124.6 52.2c14.2 6 30.4-2.9 33-18.2l72-432C515 7.8 493.3-6.8 476 3.2z"},child:[]}]})(e)}function P5(e,t){return function(){return e.apply(t,arguments)}}const{toString:F5}=Object.prototype,{getPrototypeOf:O5}=Object,I5=(k5=Object.create(null),e=>{const t=F5.call(e);return k5[t]||(k5[t]=t.slice(8,-1).toLowerCase())});var k5;const B5=e=>(e=e.toLowerCase(),t=>I5(t)===e),R5=e=>t=>typeof t===e,{isArray:L5}=Array,z5=R5("undefined");const N5=B5("ArrayBuffer");const j5=R5("string"),U5=R5("function"),V5=R5("number"),H5=e=>null!==e&&"object"===typeof e,W5=e=>{if("object"!==I5(e))return!1;const t=O5(e);return(null===t||t===Object.prototype||null===Object.getPrototypeOf(t))&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},G5=B5("Date"),q5=B5("File"),Y5=B5("Blob"),X5=B5("FileList"),Q5=B5("URLSearchParams"),[K5,Z5,J5,$5]=["ReadableStream","Request","Response","Headers"].map(B5);function e6(e,t){let n,i,{allOwnKeys:r=!1}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(null!==e&&"undefined"!==typeof e)if("object"!==typeof e&&(e=[e]),L5(e))for(n=0,i=e.length;n<i;n++)t.call(null,e[n],n,e);else{const i=r?Object.getOwnPropertyNames(e):Object.keys(e),s=i.length;let a;for(n=0;n<s;n++)a=i[n],t.call(null,e[a],a,e)}}function t6(e,t){t=t.toLowerCase();const n=Object.keys(e);let i,r=n.length;for(;r-- >0;)if(i=n[r],t===i.toLowerCase())return i;return null}const n6="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof self?self:"undefined"!==typeof window?window:global,i6=e=>!z5(e)&&e!==n6;const r6=(s6="undefined"!==typeof Uint8Array&&O5(Uint8Array),e=>s6&&e instanceof s6);var s6;const a6=B5("HTMLFormElement"),o6=(e=>{let{hasOwnProperty:t}=e;return(e,n)=>t.call(e,n)})(Object.prototype),l6=B5("RegExp"),u6=(e,t)=>{const n=Object.getOwnPropertyDescriptors(e),i={};e6(n,((n,r)=>{let s;!1!==(s=t(n,r,e))&&(i[r]=s||n)})),Object.defineProperties(e,i)},c6="abcdefghijklmnopqrstuvwxyz",h6="0123456789",d6={DIGIT:h6,ALPHA:c6,ALPHA_DIGIT:c6+c6.toUpperCase()+h6};const p6=B5("AsyncFunction"),f6=((e,t)=>{return e?setImmediate:t?(n="axios@".concat(Math.random()),i=[],n6.addEventListener("message",(e=>{let{source:t,data:r}=e;t===n6&&r===n&&i.length&&i.shift()()}),!1),e=>{i.push(e),n6.postMessage(n,"*")}):e=>setTimeout(e);var n,i})("function"===typeof setImmediate,U5(n6.postMessage)),m6="undefined"!==typeof queueMicrotask?queueMicrotask.bind(n6):"undefined"!==typeof process&&process.nextTick||f6,g6={isArray:L5,isArrayBuffer:N5,isBuffer:function(e){return null!==e&&!z5(e)&&null!==e.constructor&&!z5(e.constructor)&&U5(e.constructor.isBuffer)&&e.constructor.isBuffer(e)},isFormData:e=>{let t;return e&&("function"===typeof FormData&&e instanceof FormData||U5(e.append)&&("formdata"===(t=I5(e))||"object"===t&&U5(e.toString)&&"[object FormData]"===e.toString()))},isArrayBufferView:function(e){let t;return t="undefined"!==typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&N5(e.buffer),t},isString:j5,isNumber:V5,isBoolean:e=>!0===e||!1===e,isObject:H5,isPlainObject:W5,isReadableStream:K5,isRequest:Z5,isResponse:J5,isHeaders:$5,isUndefined:z5,isDate:G5,isFile:q5,isBlob:Y5,isRegExp:l6,isFunction:U5,isStream:e=>H5(e)&&U5(e.pipe),isURLSearchParams:Q5,isTypedArray:r6,isFileList:X5,forEach:e6,merge:function e(){const{caseless:t}=i6(this)&&this||{},n={},i=(i,r)=>{const s=t&&t6(n,r)||r;W5(n[s])&&W5(i)?n[s]=e(n[s],i):W5(i)?n[s]=e({},i):L5(i)?n[s]=i.slice():n[s]=i};for(let r=0,s=arguments.length;r<s;r++)arguments[r]&&e6(arguments[r],i);return n},extend:function(e,t,n){let{allOwnKeys:i}=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return e6(t,((t,i)=>{n&&U5(t)?e[i]=P5(t,n):e[i]=t}),{allOwnKeys:i}),e},trim:e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,""),stripBOM:e=>(65279===e.charCodeAt(0)&&(e=e.slice(1)),e),inherits:(e,t,n,i)=>{e.prototype=Object.create(t.prototype,i),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),n&&Object.assign(e.prototype,n)},toFlatObject:(e,t,n,i)=>{let r,s,a;const o={};if(t=t||{},null==e)return t;do{for(r=Object.getOwnPropertyNames(e),s=r.length;s-- >0;)a=r[s],i&&!i(a,e,t)||o[a]||(t[a]=e[a],o[a]=!0);e=!1!==n&&O5(e)}while(e&&(!n||n(e,t))&&e!==Object.prototype);return t},kindOf:I5,kindOfTest:B5,endsWith:(e,t,n)=>{e=String(e),(void 0===n||n>e.length)&&(n=e.length),n-=t.length;const i=e.indexOf(t,n);return-1!==i&&i===n},toArray:e=>{if(!e)return null;if(L5(e))return e;let t=e.length;if(!V5(t))return null;const n=new Array(t);for(;t-- >0;)n[t]=e[t];return n},forEachEntry:(e,t)=>{const n=(e&&e[Symbol.iterator]).call(e);let i;for(;(i=n.next())&&!i.done;){const n=i.value;t.call(e,n[0],n[1])}},matchAll:(e,t)=>{let n;const i=[];for(;null!==(n=e.exec(t));)i.push(n);return i},isHTMLForm:a6,hasOwnProperty:o6,hasOwnProp:o6,reduceDescriptors:u6,freezeMethods:e=>{u6(e,((t,n)=>{if(U5(e)&&-1!==["arguments","caller","callee"].indexOf(n))return!1;const i=e[n];U5(i)&&(t.enumerable=!1,"writable"in t?t.writable=!1:t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+n+"'")}))}))},toObjectSet:(e,t)=>{const n={},i=e=>{e.forEach((e=>{n[e]=!0}))};return L5(e)?i(e):i(String(e).split(t)),n},toCamelCase:e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,(function(e,t,n){return t.toUpperCase()+n})),noop:()=>{},toFiniteNumber:(e,t)=>null!=e&&Number.isFinite(e=+e)?e:t,findKey:t6,global:n6,isContextDefined:i6,ALPHABET:d6,generateString:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:16,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:d6.ALPHA_DIGIT,n="";const{length:i}=t;for(;e--;)n+=t[Math.random()*i|0];return n},isSpecCompliantForm:function(e){return!!(e&&U5(e.append)&&"FormData"===e[Symbol.toStringTag]&&e[Symbol.iterator])},toJSONObject:e=>{const t=new Array(10),n=(e,i)=>{if(H5(e)){if(t.indexOf(e)>=0)return;if(!("toJSON"in e)){t[i]=e;const r=L5(e)?[]:{};return e6(e,((e,t)=>{const s=n(e,i+1);!z5(s)&&(r[t]=s)})),t[i]=void 0,r}}return e};return n(e,0)},isAsyncFn:p6,isThenable:e=>e&&(H5(e)||U5(e))&&U5(e.then)&&U5(e.catch),setImmediate:f6,asap:m6};function v6(e,t,n,i,r){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=(new Error).stack,this.message=e,this.name="AxiosError",t&&(this.code=t),n&&(this.config=n),i&&(this.request=i),r&&(this.response=r,this.status=r.status?r.status:null)}g6.inherits(v6,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:g6.toJSONObject(this.config),code:this.code,status:this.status}}});const y6=v6.prototype,x6={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach((e=>{x6[e]={value:e}})),Object.defineProperties(v6,x6),Object.defineProperty(y6,"isAxiosError",{value:!0}),v6.from=(e,t,n,i,r,s)=>{const a=Object.create(y6);return g6.toFlatObject(e,a,(function(e){return e!==Error.prototype}),(e=>"isAxiosError"!==e)),v6.call(a,e.message,t,n,i,r),a.cause=e,a.name=e.name,s&&Object.assign(a,s),a};const b6=v6;function w6(e){return g6.isPlainObject(e)||g6.isArray(e)}function D6(e){return g6.endsWith(e,"[]")?e.slice(0,-2):e}function _6(e,t,n){return e?e.concat(t).map((function(e,t){return e=D6(e),!n&&t?"["+e+"]":e})).join(n?".":""):t}const S6=g6.toFlatObject(g6,{},null,(function(e){return/^is[A-Z]/.test(e)}));const E6=function(e,t,n){if(!g6.isObject(e))throw new TypeError("target must be an object");t=t||new FormData;const i=(n=g6.toFlatObject(n,{metaTokens:!0,dots:!1,indexes:!1},!1,(function(e,t){return!g6.isUndefined(t[e])}))).metaTokens,r=n.visitor||u,s=n.dots,a=n.indexes,o=(n.Blob||"undefined"!==typeof Blob&&Blob)&&g6.isSpecCompliantForm(t);if(!g6.isFunction(r))throw new TypeError("visitor must be a function");function l(e){if(null===e)return"";if(g6.isDate(e))return e.toISOString();if(!o&&g6.isBlob(e))throw new b6("Blob is not supported. Use a Buffer instead.");return g6.isArrayBuffer(e)||g6.isTypedArray(e)?o&&"function"===typeof Blob?new Blob([e]):Buffer.from(e):e}function u(e,n,r){let o=e;if(e&&!r&&"object"===typeof e)if(g6.endsWith(n,"{}"))n=i?n:n.slice(0,-2),e=JSON.stringify(e);else if(g6.isArray(e)&&function(e){return g6.isArray(e)&&!e.some(w6)}(e)||(g6.isFileList(e)||g6.endsWith(n,"[]"))&&(o=g6.toArray(e)))return n=D6(n),o.forEach((function(e,i){!g6.isUndefined(e)&&null!==e&&t.append(!0===a?_6([n],i,s):null===a?n:n+"[]",l(e))})),!1;return!!w6(e)||(t.append(_6(r,n,s),l(e)),!1)}const c=[],h=Object.assign(S6,{defaultVisitor:u,convertValue:l,isVisitable:w6});if(!g6.isObject(e))throw new TypeError("data must be an object");return function e(n,i){if(!g6.isUndefined(n)){if(-1!==c.indexOf(n))throw Error("Circular reference detected in "+i.join("."));c.push(n),g6.forEach(n,(function(n,s){!0===(!(g6.isUndefined(n)||null===n)&&r.call(t,n,g6.isString(s)?s.trim():s,i,h))&&e(n,i?i.concat(s):[s])})),c.pop()}}(e),t};function C6(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,(function(e){return t[e]}))}function A6(e,t){this._pairs=[],e&&E6(e,this,t)}const M6=A6.prototype;M6.append=function(e,t){this._pairs.push([e,t])},M6.toString=function(e){const t=e?function(t){return e.call(this,t,C6)}:C6;return this._pairs.map((function(e){return t(e[0])+"="+t(e[1])}),"").join("&")};const T6=A6;function P6(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function F6(e,t,n){if(!t)return e;const i=n&&n.encode||P6;g6.isFunction(n)&&(n={serialize:n});const r=n&&n.serialize;let s;if(s=r?r(t,n):g6.isURLSearchParams(t)?t.toString():new T6(t,n).toString(i),s){const t=e.indexOf("#");-1!==t&&(e=e.slice(0,t)),e+=(-1===e.indexOf("?")?"?":"&")+s}return e}const O6=class{constructor(){this.handlers=[]}use(e,t,n){return this.handlers.push({fulfilled:e,rejected:t,synchronous:!!n&&n.synchronous,runWhen:n?n.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){g6.forEach(this.handlers,(function(t){null!==t&&e(t)}))}},I6={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},k6={isBrowser:!0,classes:{URLSearchParams:"undefined"!==typeof URLSearchParams?URLSearchParams:T6,FormData:"undefined"!==typeof FormData?FormData:null,Blob:"undefined"!==typeof Blob?Blob:null},protocols:["http","https","file","blob","url","data"]},B6="undefined"!==typeof window&&"undefined"!==typeof document,R6="object"===typeof navigator&&navigator||void 0,L6=B6&&(!R6||["ReactNative","NativeScript","NS"].indexOf(R6.product)<0),z6="undefined"!==typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&"function"===typeof self.importScripts,N6=B6&&window.location.href||"http://localhost",j6=d(d({},e),k6);const U6=function(e){function t(e,n,i,r){let s=e[r++];if("__proto__"===s)return!0;const a=Number.isFinite(+s),o=r>=e.length;if(s=!s&&g6.isArray(i)?i.length:s,o)return g6.hasOwnProp(i,s)?i[s]=[i[s],n]:i[s]=n,!a;i[s]&&g6.isObject(i[s])||(i[s]=[]);return t(e,n,i[s],r)&&g6.isArray(i[s])&&(i[s]=function(e){const t={},n=Object.keys(e);let i;const r=n.length;let s;for(i=0;i<r;i++)s=n[i],t[s]=e[s];return t}(i[s])),!a}if(g6.isFormData(e)&&g6.isFunction(e.entries)){const n={};return g6.forEachEntry(e,((e,i)=>{t(function(e){return g6.matchAll(/\w+|\[(\w*)]/g,e).map((e=>"[]"===e[0]?"":e[1]||e[0]))}(e),i,n,0)})),n}return null};const V6={transitional:I6,adapter:["xhr","http","fetch"],transformRequest:[function(e,t){const n=t.getContentType()||"",i=n.indexOf("application/json")>-1,r=g6.isObject(e);r&&g6.isHTMLForm(e)&&(e=new FormData(e));if(g6.isFormData(e))return i?JSON.stringify(U6(e)):e;if(g6.isArrayBuffer(e)||g6.isBuffer(e)||g6.isStream(e)||g6.isFile(e)||g6.isBlob(e)||g6.isReadableStream(e))return e;if(g6.isArrayBufferView(e))return e.buffer;if(g6.isURLSearchParams(e))return t.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let s;if(r){if(n.indexOf("application/x-www-form-urlencoded")>-1)return function(e,t){return E6(e,new j6.classes.URLSearchParams,Object.assign({visitor:function(e,t,n,i){return j6.isNode&&g6.isBuffer(e)?(this.append(t,e.toString("base64")),!1):i.defaultVisitor.apply(this,arguments)}},t))}(e,this.formSerializer).toString();if((s=g6.isFileList(e))||n.indexOf("multipart/form-data")>-1){const t=this.env&&this.env.FormData;return E6(s?{"files[]":e}:e,t&&new t,this.formSerializer)}}return r||i?(t.setContentType("application/json",!1),function(e,t,n){if(g6.isString(e))try{return(t||JSON.parse)(e),g6.trim(e)}catch(Mn){if("SyntaxError"!==Mn.name)throw Mn}return(n||JSON.stringify)(e)}(e)):e}],transformResponse:[function(e){const t=this.transitional||V6.transitional,n=t&&t.forcedJSONParsing,i="json"===this.responseType;if(g6.isResponse(e)||g6.isReadableStream(e))return e;if(e&&g6.isString(e)&&(n&&!this.responseType||i)){const n=!(t&&t.silentJSONParsing)&&i;try{return JSON.parse(e)}catch(Mn){if(n){if("SyntaxError"===Mn.name)throw b6.from(Mn,b6.ERR_BAD_RESPONSE,this,null,this.response);throw Mn}}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:j6.classes.FormData,Blob:j6.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};g6.forEach(["delete","get","head","post","put","patch"],(e=>{V6.headers[e]={}}));const H6=V6,W6=g6.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),G6=Symbol("internals");function q6(e){return e&&String(e).trim().toLowerCase()}function Y6(e){return!1===e||null==e?e:g6.isArray(e)?e.map(Y6):String(e)}function X6(e,t,n,i,r){return g6.isFunction(i)?i.call(this,t,n):(r&&(t=n),g6.isString(t)?g6.isString(i)?-1!==t.indexOf(i):g6.isRegExp(i)?i.test(t):void 0:void 0)}class Q6{constructor(e){e&&this.set(e)}set(e,t,n){const i=this;function r(e,t,n){const r=q6(t);if(!r)throw new Error("header name must be a non-empty string");const s=g6.findKey(i,r);(!s||void 0===i[s]||!0===n||void 0===n&&!1!==i[s])&&(i[s||t]=Y6(e))}const s=(e,t)=>g6.forEach(e,((e,n)=>r(e,n,t)));if(g6.isPlainObject(e)||e instanceof this.constructor)s(e,t);else if(g6.isString(e)&&(e=e.trim())&&!/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim()))s((e=>{const t={};let n,i,r;return e&&e.split("\n").forEach((function(e){r=e.indexOf(":"),n=e.substring(0,r).trim().toLowerCase(),i=e.substring(r+1).trim(),!n||t[n]&&W6[n]||("set-cookie"===n?t[n]?t[n].push(i):t[n]=[i]:t[n]=t[n]?t[n]+", "+i:i)})),t})(e),t);else if(g6.isHeaders(e))for(const[a,o]of e.entries())r(o,a,n);else null!=e&&r(t,e,n);return this}get(e,t){if(e=q6(e)){const n=g6.findKey(this,e);if(n){const e=this[n];if(!t)return e;if(!0===t)return function(e){const t=Object.create(null),n=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let i;for(;i=n.exec(e);)t[i[1]]=i[2];return t}(e);if(g6.isFunction(t))return t.call(this,e,n);if(g6.isRegExp(t))return t.exec(e);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,t){if(e=q6(e)){const n=g6.findKey(this,e);return!(!n||void 0===this[n]||t&&!X6(0,this[n],n,t))}return!1}delete(e,t){const n=this;let i=!1;function r(e){if(e=q6(e)){const r=g6.findKey(n,e);!r||t&&!X6(0,n[r],r,t)||(delete n[r],i=!0)}}return g6.isArray(e)?e.forEach(r):r(e),i}clear(e){const t=Object.keys(this);let n=t.length,i=!1;for(;n--;){const r=t[n];e&&!X6(0,this[r],r,e,!0)||(delete this[r],i=!0)}return i}normalize(e){const t=this,n={};return g6.forEach(this,((i,r)=>{const s=g6.findKey(n,r);if(s)return t[s]=Y6(i),void delete t[r];const a=e?function(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,((e,t,n)=>t.toUpperCase()+n))}(r):String(r).trim();a!==r&&delete t[r],t[a]=Y6(i),n[a]=!0})),this}concat(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.constructor.concat(this,...t)}toJSON(e){const t=Object.create(null);return g6.forEach(this,((n,i)=>{null!=n&&!1!==n&&(t[i]=e&&g6.isArray(n)?n.join(", "):n)})),t}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map((e=>{let[t,n]=e;return t+": "+n})).join("\n")}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e){const t=new this(e);for(var n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];return i.forEach((e=>t.set(e))),t}static accessor(e){const t=(this[G6]=this[G6]={accessors:{}}).accessors,n=this.prototype;function i(e){const i=q6(e);t[i]||(!function(e,t){const n=g6.toCamelCase(" "+t);["get","set","has"].forEach((i=>{Object.defineProperty(e,i+n,{value:function(e,n,r){return this[i].call(this,t,e,n,r)},configurable:!0})}))}(n,e),t[i]=!0)}return g6.isArray(e)?e.forEach(i):i(e),this}}Q6.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]),g6.reduceDescriptors(Q6.prototype,((e,t)=>{let{value:n}=e,i=t[0].toUpperCase()+t.slice(1);return{get:()=>n,set(e){this[i]=e}}})),g6.freezeMethods(Q6);const K6=Q6;function Z6(e,t){const n=this||H6,i=t||n,r=K6.from(i.headers);let s=i.data;return g6.forEach(e,(function(e){s=e.call(n,s,r.normalize(),t?t.status:void 0)})),r.normalize(),s}function J6(e){return!(!e||!e.__CANCEL__)}function $6(e,t,n){b6.call(this,null==e?"canceled":e,b6.ERR_CANCELED,t,n),this.name="CanceledError"}g6.inherits($6,b6,{__CANCEL__:!0});const e8=$6;function t8(e,t,n){const i=n.config.validateStatus;n.status&&i&&!i(n.status)?t(new b6("Request failed with status code "+n.status,[b6.ERR_BAD_REQUEST,b6.ERR_BAD_RESPONSE][Math.floor(n.status/100)-4],n.config,n.request,n)):e(n)}const n8=function(e,t){e=e||10;const n=new Array(e),i=new Array(e);let r,s=0,a=0;return t=void 0!==t?t:1e3,function(o){const l=Date.now(),u=i[a];r||(r=l),n[s]=o,i[s]=l;let c=a,h=0;for(;c!==s;)h+=n[c++],c%=e;if(s=(s+1)%e,s===a&&(a=(a+1)%e),l-r<t)return;const d=u&&l-u;return d?Math.round(1e3*h/d):void 0}};const i8=function(e,t){let n,i,r=0,s=1e3/t;const a=function(t){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Date.now();r=s,n=null,i&&(clearTimeout(i),i=null),e.apply(null,t)};return[function(){const e=Date.now(),t=e-r;for(var o=arguments.length,l=new Array(o),u=0;u<o;u++)l[u]=arguments[u];t>=s?a(l,e):(n=l,i||(i=setTimeout((()=>{i=null,a(n)}),s-t)))},()=>n&&a(n)]},r8=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3,i=0;const r=n8(50,250);return i8((n=>{const s=n.loaded,a=n.lengthComputable?n.total:void 0,o=s-i,l=r(o);i=s;e({loaded:s,total:a,progress:a?s/a:void 0,bytes:o,rate:l||void 0,estimated:l&&a&&s<=a?(a-s)/l:void 0,event:n,lengthComputable:null!=a,[t?"download":"upload"]:!0})}),n)},s8=(e,t)=>{const n=null!=e;return[i=>t[0]({lengthComputable:n,total:e,loaded:i}),t[1]]},a8=e=>function(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return g6.asap((()=>e(...n)))},o8=j6.hasStandardBrowserEnv?((e,t)=>n=>(n=new URL(n,j6.origin),e.protocol===n.protocol&&e.host===n.host&&(t||e.port===n.port)))(new URL(j6.origin),j6.navigator&&/(msie|trident)/i.test(j6.navigator.userAgent)):()=>!0,l8=j6.hasStandardBrowserEnv?{write(e,t,n,i,r,s){const a=[e+"="+encodeURIComponent(t)];g6.isNumber(n)&&a.push("expires="+new Date(n).toGMTString()),g6.isString(i)&&a.push("path="+i),g6.isString(r)&&a.push("domain="+r),!0===s&&a.push("secure"),document.cookie=a.join("; ")},read(e){const t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove(e){this.write(e,"",Date.now()-864e5)}}:{write(){},read:()=>null,remove(){}};function u8(e,t){return e&&!/^([a-z][a-z\d+\-.]*:)?\/\//i.test(t)?function(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}(e,t):t}const c8=e=>e instanceof K6?d({},e):e;function h8(e,t){t=t||{};const n={};function i(e,t,n,i){return g6.isPlainObject(e)&&g6.isPlainObject(t)?g6.merge.call({caseless:i},e,t):g6.isPlainObject(t)?g6.merge({},t):g6.isArray(t)?t.slice():t}function r(e,t,n,r){return g6.isUndefined(t)?g6.isUndefined(e)?void 0:i(void 0,e,0,r):i(e,t,0,r)}function s(e,t){if(!g6.isUndefined(t))return i(void 0,t)}function a(e,t){return g6.isUndefined(t)?g6.isUndefined(e)?void 0:i(void 0,e):i(void 0,t)}function o(n,r,s){return s in t?i(n,r):s in e?i(void 0,n):void 0}const l={url:s,method:s,data:s,baseURL:a,transformRequest:a,transformResponse:a,paramsSerializer:a,timeout:a,timeoutMessage:a,withCredentials:a,withXSRFToken:a,adapter:a,responseType:a,xsrfCookieName:a,xsrfHeaderName:a,onUploadProgress:a,onDownloadProgress:a,decompress:a,maxContentLength:a,maxBodyLength:a,beforeRedirect:a,transport:a,httpAgent:a,httpsAgent:a,cancelToken:a,socketPath:a,responseEncoding:a,validateStatus:o,headers:(e,t,n)=>r(c8(e),c8(t),0,!0)};return g6.forEach(Object.keys(Object.assign({},e,t)),(function(i){const s=l[i]||r,a=s(e[i],t[i],i);g6.isUndefined(a)&&s!==o||(n[i]=a)})),n}const d8=e=>{const t=h8({},e);let n,{data:i,withXSRFToken:r,xsrfHeaderName:s,xsrfCookieName:a,headers:o,auth:l}=t;if(t.headers=o=K6.from(o),t.url=F6(u8(t.baseURL,t.url),e.params,e.paramsSerializer),l&&o.set("Authorization","Basic "+btoa((l.username||"")+":"+(l.password?unescape(encodeURIComponent(l.password)):""))),g6.isFormData(i))if(j6.hasStandardBrowserEnv||j6.hasStandardBrowserWebWorkerEnv)o.setContentType(void 0);else if(!1!==(n=o.getContentType())){const[e,...t]=n?n.split(";").map((e=>e.trim())).filter(Boolean):[];o.setContentType([e||"multipart/form-data",...t].join("; "))}if(j6.hasStandardBrowserEnv&&(r&&g6.isFunction(r)&&(r=r(t)),r||!1!==r&&o8(t.url))){const e=s&&a&&l8.read(a);e&&o.set(s,e)}return t},p8="undefined"!==typeof XMLHttpRequest&&function(e){return new Promise((function(t,n){const i=d8(e);let r=i.data;const s=K6.from(i.headers).normalize();let a,o,l,u,c,{responseType:h,onUploadProgress:d,onDownloadProgress:p}=i;function f(){u&&u(),c&&c(),i.cancelToken&&i.cancelToken.unsubscribe(a),i.signal&&i.signal.removeEventListener("abort",a)}let m=new XMLHttpRequest;function g(){if(!m)return;const i=K6.from("getAllResponseHeaders"in m&&m.getAllResponseHeaders());t8((function(e){t(e),f()}),(function(e){n(e),f()}),{data:h&&"text"!==h&&"json"!==h?m.response:m.responseText,status:m.status,statusText:m.statusText,headers:i,config:e,request:m}),m=null}m.open(i.method.toUpperCase(),i.url,!0),m.timeout=i.timeout,"onloadend"in m?m.onloadend=g:m.onreadystatechange=function(){m&&4===m.readyState&&(0!==m.status||m.responseURL&&0===m.responseURL.indexOf("file:"))&&setTimeout(g)},m.onabort=function(){m&&(n(new b6("Request aborted",b6.ECONNABORTED,e,m)),m=null)},m.onerror=function(){n(new b6("Network Error",b6.ERR_NETWORK,e,m)),m=null},m.ontimeout=function(){let t=i.timeout?"timeout of "+i.timeout+"ms exceeded":"timeout exceeded";const r=i.transitional||I6;i.timeoutErrorMessage&&(t=i.timeoutErrorMessage),n(new b6(t,r.clarifyTimeoutError?b6.ETIMEDOUT:b6.ECONNABORTED,e,m)),m=null},void 0===r&&s.setContentType(null),"setRequestHeader"in m&&g6.forEach(s.toJSON(),(function(e,t){m.setRequestHeader(t,e)})),g6.isUndefined(i.withCredentials)||(m.withCredentials=!!i.withCredentials),h&&"json"!==h&&(m.responseType=i.responseType),p&&([l,c]=r8(p,!0),m.addEventListener("progress",l)),d&&m.upload&&([o,u]=r8(d),m.upload.addEventListener("progress",o),m.upload.addEventListener("loadend",u)),(i.cancelToken||i.signal)&&(a=t=>{m&&(n(!t||t.type?new e8(null,e,m):t),m.abort(),m=null)},i.cancelToken&&i.cancelToken.subscribe(a),i.signal&&(i.signal.aborted?a():i.signal.addEventListener("abort",a)));const v=function(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}(i.url);v&&-1===j6.protocols.indexOf(v)?n(new b6("Unsupported protocol "+v+":",b6.ERR_BAD_REQUEST,e)):m.send(r||null)}))},f8=(e,t)=>{const{length:n}=e=e?e.filter(Boolean):[];if(t||n){let n,i=new AbortController;const r=function(e){if(!n){n=!0,a();const t=e instanceof Error?e:this.reason;i.abort(t instanceof b6?t:new e8(t instanceof Error?t.message:t))}};let s=t&&setTimeout((()=>{s=null,r(new b6("timeout ".concat(t," of ms exceeded"),b6.ETIMEDOUT))}),t);const a=()=>{e&&(s&&clearTimeout(s),s=null,e.forEach((e=>{e.unsubscribe?e.unsubscribe(r):e.removeEventListener("abort",r)})),e=null)};e.forEach((e=>e.addEventListener("abort",r)));const{signal:o}=i;return o.unsubscribe=()=>g6.asap(a),o}};function m8(e,t){this.v=e,this.k=t}function g8(e){return function(){return new v8(e.apply(this,arguments))}}function v8(e){var t,n;function i(t,n){try{var s=e[t](n),a=s.value,o=a instanceof m8;Promise.resolve(o?a.v:a).then((function(n){if(o){var l="return"===t?"return":"next";if(!a.k||n.done)return i(l,n);n=e[l](n).value}r(s.done?"return":"normal",n)}),(function(e){i("throw",e)}))}catch(e){r("throw",e)}}function r(e,r){switch(e){case"return":t.resolve({value:r,done:!0});break;case"throw":t.reject(r);break;default:t.resolve({value:r,done:!1})}(t=t.next)?i(t.key,t.arg):n=null}this._invoke=function(e,r){return new Promise((function(s,a){var o={key:e,arg:r,resolve:s,reject:a,next:null};n?n=n.next=o:(t=n=o,i(e,r))}))},"function"!=typeof e.return&&(this.return=void 0)}function y8(e){return new m8(e,0)}function x8(e){var t={},n=!1;function i(t,i){return n=!0,i=new Promise((function(n){n(e[t](i))})),{done:!1,value:new m8(i,1)}}return t["undefined"!=typeof Symbol&&Symbol.iterator||"@@iterator"]=function(){return this},t.next=function(e){return n?(n=!1,e):i("next",e)},"function"==typeof e.throw&&(t.throw=function(e){if(n)throw n=!1,e;return i("throw",e)}),"function"==typeof e.return&&(t.return=function(e){return n?(n=!1,e):i("return",e)}),t}function b8(e){var t,n,i,r=2;for("undefined"!=typeof Symbol&&(n=Symbol.asyncIterator,i=Symbol.iterator);r--;){if(n&&null!=(t=e[n]))return t.call(e);if(i&&null!=(t=e[i]))return new w8(t.call(e));n="@@asyncIterator",i="@@iterator"}throw new TypeError("Object is not async iterable")}function w8(e){function t(e){if(Object(e)!==e)return Promise.reject(new TypeError(e+" is not an object."));var t=e.done;return Promise.resolve(e.value).then((function(e){return{value:e,done:t}}))}return w8=function(e){this.s=e,this.n=e.next},w8.prototype={s:null,n:null,next:function(){return t(this.n.apply(this.s,arguments))},return:function(e){var n=this.s.return;return void 0===n?Promise.resolve({value:e,done:!0}):t(n.apply(this.s,arguments))},throw:function(e){var n=this.s.return;return void 0===n?Promise.reject(e):t(n.apply(this.s,arguments))}},new w8(e)}v8.prototype["function"==typeof Symbol&&Symbol.asyncIterator||"@@asyncIterator"]=function(){return this},v8.prototype.next=function(e){return this._invoke("next",e)},v8.prototype.throw=function(e){return this._invoke("throw",e)},v8.prototype.return=function(e){return this._invoke("return",e)};const D8=function*(e,t){let n=e.byteLength;if(!t||n<t)return void(yield e);let i,r=0;for(;r<n;)i=r+t,yield e.slice(r,i),r=i},_8=function(){var e=g8((function*(e,t){var n,i=!1,r=!1;try{for(var s,a=b8(S8(e));i=!(s=yield y8(a.next())).done;i=!1){const e=s.value;yield*x8(b8(D8(e,t)))}}catch(o){r=!0,n=o}finally{try{i&&null!=a.return&&(yield y8(a.return()))}finally{if(r)throw n}}}));return function(t,n){return e.apply(this,arguments)}}(),S8=function(){var e=g8((function*(e){if(e[Symbol.asyncIterator])return void(yield*x8(b8(e)));const t=e.getReader();try{for(;;){const{done:e,value:n}=yield y8(t.read());if(e)break;yield n}}finally{yield y8(t.cancel())}}));return function(t){return e.apply(this,arguments)}}(),E8=(e,t,n,i)=>{const r=_8(e,t);let s,a=0,o=e=>{s||(s=!0,i&&i(e))};return new ReadableStream({async pull(e){try{const{done:t,value:i}=await r.next();if(t)return o(),void e.close();let s=i.byteLength;if(n){let e=a+=s;n(e)}e.enqueue(new Uint8Array(i))}catch(t){throw o(t),t}},cancel:e=>(o(e),r.return())},{highWaterMark:2})},C8="function"===typeof fetch&&"function"===typeof Request&&"function"===typeof Response,A8=C8&&"function"===typeof ReadableStream,M8=C8&&("function"===typeof TextEncoder?(e=>t=>e.encode(t))(new TextEncoder):async e=>new Uint8Array(await new Response(e).arrayBuffer())),T8=function(e){try{for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return!!e(...n)}catch(Mn){return!1}},P8=A8&&T8((()=>{let e=!1;const t=new Request(j6.origin,{body:new ReadableStream,method:"POST",get duplex(){return e=!0,"half"}}).headers.has("Content-Type");return e&&!t})),F8=A8&&T8((()=>g6.isReadableStream(new Response("").body))),O8={stream:F8&&(e=>e.body)};var I8;C8&&(I8=new Response,["text","arrayBuffer","blob","formData","stream"].forEach((e=>{!O8[e]&&(O8[e]=g6.isFunction(I8[e])?t=>t[e]():(t,n)=>{throw new b6("Response type '".concat(e,"' is not supported"),b6.ERR_NOT_SUPPORT,n)})})));const k8=async(e,t)=>{const n=g6.toFiniteNumber(e.getContentLength());return null==n?(async e=>{if(null==e)return 0;if(g6.isBlob(e))return e.size;if(g6.isSpecCompliantForm(e)){const t=new Request(j6.origin,{method:"POST",body:e});return(await t.arrayBuffer()).byteLength}return g6.isArrayBufferView(e)||g6.isArrayBuffer(e)?e.byteLength:(g6.isURLSearchParams(e)&&(e+=""),g6.isString(e)?(await M8(e)).byteLength:void 0)})(t):n},B8=C8&&(async e=>{let{url:t,method:n,data:i,signal:r,cancelToken:s,timeout:a,onDownloadProgress:o,onUploadProgress:l,responseType:u,headers:c,withCredentials:h="same-origin",fetchOptions:p}=d8(e);u=u?(u+"").toLowerCase():"text";let f,m=f8([r,s&&s.toAbortSignal()],a);const g=m&&m.unsubscribe&&(()=>{m.unsubscribe()});let v;try{if(l&&P8&&"get"!==n&&"head"!==n&&0!==(v=await k8(c,i))){let e,n=new Request(t,{method:"POST",body:i,duplex:"half"});if(g6.isFormData(i)&&(e=n.headers.get("content-type"))&&c.setContentType(e),n.body){const[e,t]=s8(v,r8(a8(l)));i=E8(n.body,65536,e,t)}}g6.isString(h)||(h=h?"include":"omit");const r="credentials"in Request.prototype;f=new Request(t,d(d({},p),{},{signal:m,method:n.toUpperCase(),headers:c.normalize().toJSON(),body:i,duplex:"half",credentials:r?h:void 0}));let s=await fetch(f);const a=F8&&("stream"===u||"response"===u);if(F8&&(o||a&&g)){const e={};["status","statusText","headers"].forEach((t=>{e[t]=s[t]}));const t=g6.toFiniteNumber(s.headers.get("content-length")),[n,i]=o&&s8(t,r8(a8(o),!0))||[];s=new Response(E8(s.body,65536,n,(()=>{i&&i(),g&&g()})),e)}u=u||"text";let y=await O8[g6.findKey(O8,u)||"text"](s,e);return!a&&g&&g(),await new Promise(((t,n)=>{t8(t,n,{data:y,headers:K6.from(s.headers),status:s.status,statusText:s.statusText,config:e,request:f})}))}catch(y){if(g&&g(),y&&"TypeError"===y.name&&/fetch/i.test(y.message))throw Object.assign(new b6("Network Error",b6.ERR_NETWORK,e,f),{cause:y.cause||y});throw b6.from(y,y&&y.code,e,f)}}),R8={http:null,xhr:p8,fetch:B8};g6.forEach(R8,((e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch(Mn){}Object.defineProperty(e,"adapterName",{value:t})}}));const L8=e=>"- ".concat(e),z8=e=>g6.isFunction(e)||null===e||!1===e,N8=e=>{e=g6.isArray(e)?e:[e];const{length:t}=e;let n,i;const r={};for(let s=0;s<t;s++){let t;if(n=e[s],i=n,!z8(n)&&(i=R8[(t=String(n)).toLowerCase()],void 0===i))throw new b6("Unknown adapter '".concat(t,"'"));if(i)break;r[t||"#"+s]=i}if(!i){const e=Object.entries(r).map((e=>{let[t,n]=e;return"adapter ".concat(t," ")+(!1===n?"is not supported by the environment":"is not available in the build")}));let n=t?e.length>1?"since :\n"+e.map(L8).join("\n"):" "+L8(e[0]):"as no adapter specified";throw new b6("There is no suitable adapter to dispatch the request "+n,"ERR_NOT_SUPPORT")}return i};function j8(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new e8(null,e)}function U8(e){j8(e),e.headers=K6.from(e.headers),e.data=Z6.call(e,e.transformRequest),-1!==["post","put","patch"].indexOf(e.method)&&e.headers.setContentType("application/x-www-form-urlencoded",!1);return N8(e.adapter||H6.adapter)(e).then((function(t){return j8(e),t.data=Z6.call(e,e.transformResponse,t),t.headers=K6.from(t.headers),t}),(function(t){return J6(t)||(j8(e),t&&t.response&&(t.response.data=Z6.call(e,e.transformResponse,t.response),t.response.headers=K6.from(t.response.headers))),Promise.reject(t)}))}const V8="1.7.9",H8={};["object","boolean","number","function","string","symbol"].forEach(((e,t)=>{H8[e]=function(n){return typeof n===e||"a"+(t<1?"n ":" ")+e}}));const W8={};H8.transitional=function(e,t,n){function i(e,t){return"[Axios v1.7.9] Transitional option '"+e+"'"+t+(n?". "+n:"")}return(n,r,s)=>{if(!1===e)throw new b6(i(r," has been removed"+(t?" in "+t:"")),b6.ERR_DEPRECATED);return t&&!W8[r]&&(W8[r]=!0,console.warn(i(r," has been deprecated since v"+t+" and will be removed in the near future"))),!e||e(n,r,s)}},H8.spelling=function(e){return(t,n)=>(console.warn("".concat(n," is likely a misspelling of ").concat(e)),!0)};const G8={assertOptions:function(e,t,n){if("object"!==typeof e)throw new b6("options must be an object",b6.ERR_BAD_OPTION_VALUE);const i=Object.keys(e);let r=i.length;for(;r-- >0;){const s=i[r],a=t[s];if(a){const t=e[s],n=void 0===t||a(t,s,e);if(!0!==n)throw new b6("option "+s+" must be "+n,b6.ERR_BAD_OPTION_VALUE)}else if(!0!==n)throw new b6("Unknown option "+s,b6.ERR_BAD_OPTION)}},validators:H8},q8=G8.validators;class Y8{constructor(e){this.defaults=e,this.interceptors={request:new O6,response:new O6}}async request(e,t){try{return await this._request(e,t)}catch(n){if(n instanceof Error){let e={};Error.captureStackTrace?Error.captureStackTrace(e):e=new Error;const t=e.stack?e.stack.replace(/^.+\n/,""):"";try{n.stack?t&&!String(n.stack).endsWith(t.replace(/^.+\n.+\n/,""))&&(n.stack+="\n"+t):n.stack=t}catch(Mn){}}throw n}}_request(e,t){"string"===typeof e?(t=t||{}).url=e:t=e||{},t=h8(this.defaults,t);const{transitional:n,paramsSerializer:i,headers:r}=t;void 0!==n&&G8.assertOptions(n,{silentJSONParsing:q8.transitional(q8.boolean),forcedJSONParsing:q8.transitional(q8.boolean),clarifyTimeoutError:q8.transitional(q8.boolean)},!1),null!=i&&(g6.isFunction(i)?t.paramsSerializer={serialize:i}:G8.assertOptions(i,{encode:q8.function,serialize:q8.function},!0)),G8.assertOptions(t,{baseUrl:q8.spelling("baseURL"),withXsrfToken:q8.spelling("withXSRFToken")},!0),t.method=(t.method||this.defaults.method||"get").toLowerCase();let s=r&&g6.merge(r.common,r[t.method]);r&&g6.forEach(["delete","get","head","post","put","patch","common"],(e=>{delete r[e]})),t.headers=K6.concat(s,r);const a=[];let o=!0;this.interceptors.request.forEach((function(e){"function"===typeof e.runWhen&&!1===e.runWhen(t)||(o=o&&e.synchronous,a.unshift(e.fulfilled,e.rejected))}));const l=[];let u;this.interceptors.response.forEach((function(e){l.push(e.fulfilled,e.rejected)}));let c,h=0;if(!o){const e=[U8.bind(this),void 0];for(e.unshift.apply(e,a),e.push.apply(e,l),c=e.length,u=Promise.resolve(t);h<c;)u=u.then(e[h++],e[h++]);return u}c=a.length;let d=t;for(h=0;h<c;){const e=a[h++],t=a[h++];try{d=e(d)}catch(p){t.call(this,p);break}}try{u=U8.call(this,d)}catch(p){return Promise.reject(p)}for(h=0,c=l.length;h<c;)u=u.then(l[h++],l[h++]);return u}getUri(e){return F6(u8((e=h8(this.defaults,e)).baseURL,e.url),e.params,e.paramsSerializer)}}g6.forEach(["delete","get","head","options"],(function(e){Y8.prototype[e]=function(t,n){return this.request(h8(n||{},{method:e,url:t,data:(n||{}).data}))}})),g6.forEach(["post","put","patch"],(function(e){function t(t){return function(n,i,r){return this.request(h8(r||{},{method:e,headers:t?{"Content-Type":"multipart/form-data"}:{},url:n,data:i}))}}Y8.prototype[e]=t(),Y8.prototype[e+"Form"]=t(!0)}));const X8=Y8;class Q8{constructor(e){if("function"!==typeof e)throw new TypeError("executor must be a function.");let t;this.promise=new Promise((function(e){t=e}));const n=this;this.promise.then((e=>{if(!n._listeners)return;let t=n._listeners.length;for(;t-- >0;)n._listeners[t](e);n._listeners=null})),this.promise.then=e=>{let t;const i=new Promise((e=>{n.subscribe(e),t=e})).then(e);return i.cancel=function(){n.unsubscribe(t)},i},e((function(e,i,r){n.reason||(n.reason=new e8(e,i,r),t(n.reason))}))}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){this.reason?e(this.reason):this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const t=this._listeners.indexOf(e);-1!==t&&this._listeners.splice(t,1)}toAbortSignal(){const e=new AbortController,t=t=>{e.abort(t)};return this.subscribe(t),e.signal.unsubscribe=()=>this.unsubscribe(t),e.signal}static source(){let e;return{token:new Q8((function(t){e=t})),cancel:e}}}const K8=Q8;const Z8={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(Z8).forEach((e=>{let[t,n]=e;Z8[n]=t}));const J8=Z8;const $8=function e(t){const n=new X8(t),i=P5(X8.prototype.request,n);return g6.extend(i,X8.prototype,n,{allOwnKeys:!0}),g6.extend(i,n,null,{allOwnKeys:!0}),i.create=function(n){return e(h8(t,n))},i}(H6);$8.Axios=X8,$8.CanceledError=e8,$8.CancelToken=K8,$8.isCancel=J6,$8.VERSION=V8,$8.toFormData=E6,$8.AxiosError=b6,$8.Cancel=$8.CanceledError,$8.all=function(e){return Promise.all(e)},$8.spread=function(e){return function(t){return e.apply(null,t)}},$8.isAxiosError=function(e){return g6.isObject(e)&&!0===e.isAxiosError},$8.mergeConfig=h8,$8.AxiosHeaders=K6,$8.formToJSON=e=>U6(g6.isHTMLForm(e)?new FormData(e):e),$8.getAdapter=N8,$8.HttpStatusCode=J8,$8.default=$8;const e9=$8;const t9=/^(?:[\$A-Z_a-z\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0560-\u0588\u05D0-\u05EA\u05EF-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u0860-\u086A\u0870-\u0887\u0889-\u088E\u08A0-\u08C9\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u09FC\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C5D\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D04-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E86-\u0E8A\u0E8C-\u0EA3\u0EA5\u0EA7-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u1711\u171F-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1878\u1880-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4C\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C8A\u1C90-\u1CBA\u1CBD-\u1CBF\u1CE9-\u1CEC\u1CEE-\u1CF3\u1CF5\u1CF6\u1CFA\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2118-\u211D\u2124\u2126\u2128\u212A-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2188\u2C00-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303C\u3041-\u3096\u309B-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312F\u3131-\u318E\u31A0-\u31BF\u31F0-\u31FF\u3400-\u4DBF\u4E00-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6EF\uA717-\uA71F\uA722-\uA788\uA78B-\uA7CD\uA7D0\uA7D1\uA7D3\uA7D5-\uA7DC\uA7F2-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA8FE\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB69\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDD40-\uDD74\uDE80-\uDE9C\uDEA0-\uDED0\uDF00-\uDF1F\uDF2D-\uDF4A\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF\uDFD1-\uDFD5]|\uD801[\uDC00-\uDC9D\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDD70-\uDD7A\uDD7C-\uDD8A\uDD8C-\uDD92\uDD94\uDD95\uDD97-\uDDA1\uDDA3-\uDDB1\uDDB3-\uDDB9\uDDBB\uDDBC\uDDC0-\uDDF3\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67\uDF80-\uDF85\uDF87-\uDFB0\uDFB2-\uDFBA]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE35\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE4\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2\uDD00-\uDD23\uDD4A-\uDD65\uDD6F-\uDD85\uDE80-\uDEA9\uDEB0\uDEB1\uDEC2-\uDEC4\uDF00-\uDF1C\uDF27\uDF30-\uDF45\uDF70-\uDF81\uDFB0-\uDFC4\uDFE0-\uDFF6]|\uD804[\uDC03-\uDC37\uDC71\uDC72\uDC75\uDC83-\uDCAF\uDCD0-\uDCE8\uDD03-\uDD26\uDD44\uDD47\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE2B\uDE3F\uDE40\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61\uDF80-\uDF89\uDF8B\uDF8E\uDF90-\uDFB5\uDFB7\uDFD1\uDFD3]|\uD805[\uDC00-\uDC34\uDC47-\uDC4A\uDC5F-\uDC61\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE80-\uDEAA\uDEB8\uDF00-\uDF1A\uDF40-\uDF46]|\uD806[\uDC00-\uDC2B\uDCA0-\uDCDF\uDCFF-\uDD06\uDD09\uDD0C-\uDD13\uDD15\uDD16\uDD18-\uDD2F\uDD3F\uDD41\uDDA0-\uDDA7\uDDAA-\uDDD0\uDDE1\uDDE3\uDE00\uDE0B-\uDE32\uDE3A\uDE50\uDE5C-\uDE89\uDE9D\uDEB0-\uDEF8\uDFC0-\uDFE0]|\uD807[\uDC00-\uDC08\uDC0A-\uDC2E\uDC40\uDC72-\uDC8F\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD30\uDD46\uDD60-\uDD65\uDD67\uDD68\uDD6A-\uDD89\uDD98\uDEE0-\uDEF2\uDF02\uDF04-\uDF10\uDF12-\uDF33\uDFB0]|\uD808[\uDC00-\uDF99]|\uD809[\uDC00-\uDC6E\uDC80-\uDD43]|\uD80B[\uDF90-\uDFF0]|[\uD80C\uD80E\uD80F\uD81C-\uD820\uD822\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879\uD880-\uD883\uD885-\uD887][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2F\uDC41-\uDC46\uDC60-\uDFFF]|\uD810[\uDC00-\uDFFA]|\uD811[\uDC00-\uDE46]|\uD818[\uDD00-\uDD1D]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE70-\uDEBE\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDD40-\uDD6C\uDE40-\uDE7F\uDF00-\uDF4A\uDF50\uDF93-\uDF9F\uDFE0\uDFE1\uDFE3]|\uD821[\uDC00-\uDFF7]|\uD823[\uDC00-\uDCD5\uDCFF-\uDD08]|\uD82B[\uDFF0-\uDFF3\uDFF5-\uDFFB\uDFFD\uDFFE]|\uD82C[\uDC00-\uDD22\uDD32\uDD50-\uDD52\uDD55\uDD64-\uDD67\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB]|\uD837[\uDF00-\uDF1E\uDF25-\uDF2A]|\uD838[\uDC30-\uDC6D\uDD00-\uDD2C\uDD37-\uDD3D\uDD4E\uDE90-\uDEAD\uDEC0-\uDEEB]|\uD839[\uDCD0-\uDCEB\uDDD0-\uDDED\uDDF0\uDFE0-\uDFE6\uDFE8-\uDFEB\uDFED\uDFEE\uDFF0-\uDFFE]|\uD83A[\uDC00-\uDCC4\uDD00-\uDD43\uDD4B]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDEDF\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF39\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0\uDFF0-\uDFFF]|\uD87B[\uDC00-\uDE5D]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A\uDF50-\uDFFF]|\uD888[\uDC00-\uDFAF])(?:[\$0-9A-Z_a-z\xAA\xB5\xB7\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0300-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u0483-\u0487\u048A-\u052F\u0531-\u0556\u0559\u0560-\u0588\u0591-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7\u05D0-\u05EA\u05EF-\u05F2\u0610-\u061A\u0620-\u0669\u066E-\u06D3\u06D5-\u06DC\u06DF-\u06E8\u06EA-\u06FC\u06FF\u0710-\u074A\u074D-\u07B1\u07C0-\u07F5\u07FA\u07FD\u0800-\u082D\u0840-\u085B\u0860-\u086A\u0870-\u0887\u0889-\u088E\u0897-\u08E1\u08E3-\u0963\u0966-\u096F\u0971-\u0983\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BC-\u09C4\u09C7\u09C8\u09CB-\u09CE\u09D7\u09DC\u09DD\u09DF-\u09E3\u09E6-\u09F1\u09FC\u09FE\u0A01-\u0A03\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A3C\u0A3E-\u0A42\u0A47\u0A48\u0A4B-\u0A4D\u0A51\u0A59-\u0A5C\u0A5E\u0A66-\u0A75\u0A81-\u0A83\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABC-\u0AC5\u0AC7-\u0AC9\u0ACB-\u0ACD\u0AD0\u0AE0-\u0AE3\u0AE6-\u0AEF\u0AF9-\u0AFF\u0B01-\u0B03\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3C-\u0B44\u0B47\u0B48\u0B4B-\u0B4D\u0B55-\u0B57\u0B5C\u0B5D\u0B5F-\u0B63\u0B66-\u0B6F\u0B71\u0B82\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BBE-\u0BC2\u0BC6-\u0BC8\u0BCA-\u0BCD\u0BD0\u0BD7\u0BE6-\u0BEF\u0C00-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3C-\u0C44\u0C46-\u0C48\u0C4A-\u0C4D\u0C55\u0C56\u0C58-\u0C5A\u0C5D\u0C60-\u0C63\u0C66-\u0C6F\u0C80-\u0C83\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBC-\u0CC4\u0CC6-\u0CC8\u0CCA-\u0CCD\u0CD5\u0CD6\u0CDD\u0CDE\u0CE0-\u0CE3\u0CE6-\u0CEF\u0CF1-\u0CF3\u0D00-\u0D0C\u0D0E-\u0D10\u0D12-\u0D44\u0D46-\u0D48\u0D4A-\u0D4E\u0D54-\u0D57\u0D5F-\u0D63\u0D66-\u0D6F\u0D7A-\u0D7F\u0D81-\u0D83\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0DCA\u0DCF-\u0DD4\u0DD6\u0DD8-\u0DDF\u0DE6-\u0DEF\u0DF2\u0DF3\u0E01-\u0E3A\u0E40-\u0E4E\u0E50-\u0E59\u0E81\u0E82\u0E84\u0E86-\u0E8A\u0E8C-\u0EA3\u0EA5\u0EA7-\u0EBD\u0EC0-\u0EC4\u0EC6\u0EC8-\u0ECE\u0ED0-\u0ED9\u0EDC-\u0EDF\u0F00\u0F18\u0F19\u0F20-\u0F29\u0F35\u0F37\u0F39\u0F3E-\u0F47\u0F49-\u0F6C\u0F71-\u0F84\u0F86-\u0F97\u0F99-\u0FBC\u0FC6\u1000-\u1049\u1050-\u109D\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u135D-\u135F\u1369-\u1371\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u1715\u171F-\u1734\u1740-\u1753\u1760-\u176C\u176E-\u1770\u1772\u1773\u1780-\u17D3\u17D7\u17DC\u17DD\u17E0-\u17E9\u180B-\u180D\u180F-\u1819\u1820-\u1878\u1880-\u18AA\u18B0-\u18F5\u1900-\u191E\u1920-\u192B\u1930-\u193B\u1946-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u19D0-\u19DA\u1A00-\u1A1B\u1A20-\u1A5E\u1A60-\u1A7C\u1A7F-\u1A89\u1A90-\u1A99\u1AA7\u1AB0-\u1ABD\u1ABF-\u1ACE\u1B00-\u1B4C\u1B50-\u1B59\u1B6B-\u1B73\u1B80-\u1BF3\u1C00-\u1C37\u1C40-\u1C49\u1C4D-\u1C7D\u1C80-\u1C8A\u1C90-\u1CBA\u1CBD-\u1CBF\u1CD0-\u1CD2\u1CD4-\u1CFA\u1D00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u200C\u200D\u203F\u2040\u2054\u2071\u207F\u2090-\u209C\u20D0-\u20DC\u20E1\u20E5-\u20F0\u2102\u2107\u210A-\u2113\u2115\u2118-\u211D\u2124\u2126\u2128\u212A-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2188\u2C00-\u2CE4\u2CEB-\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D7F-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2DE0-\u2DFF\u3005-\u3007\u3021-\u302F\u3031-\u3035\u3038-\u303C\u3041-\u3096\u3099-\u309F\u30A1-\u30FF\u3105-\u312F\u3131-\u318E\u31A0-\u31BF\u31F0-\u31FF\u3400-\u4DBF\u4E00-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA62B\uA640-\uA66F\uA674-\uA67D\uA67F-\uA6F1\uA717-\uA71F\uA722-\uA788\uA78B-\uA7CD\uA7D0\uA7D1\uA7D3\uA7D5-\uA7DC\uA7F2-\uA827\uA82C\uA840-\uA873\uA880-\uA8C5\uA8D0-\uA8D9\uA8E0-\uA8F7\uA8FB\uA8FD-\uA92D\uA930-\uA953\uA960-\uA97C\uA980-\uA9C0\uA9CF-\uA9D9\uA9E0-\uA9FE\uAA00-\uAA36\uAA40-\uAA4D\uAA50-\uAA59\uAA60-\uAA76\uAA7A-\uAAC2\uAADB-\uAADD\uAAE0-\uAAEF\uAAF2-\uAAF6\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB69\uAB70-\uABEA\uABEC\uABED\uABF0-\uABF9\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE00-\uFE0F\uFE20-\uFE2F\uFE33\uFE34\uFE4D-\uFE4F\uFE70-\uFE74\uFE76-\uFEFC\uFF10-\uFF19\uFF21-\uFF3A\uFF3F\uFF41-\uFF5A\uFF65-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDD40-\uDD74\uDDFD\uDE80-\uDE9C\uDEA0-\uDED0\uDEE0\uDF00-\uDF1F\uDF2D-\uDF4A\uDF50-\uDF7A\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF\uDFD1-\uDFD5]|\uD801[\uDC00-\uDC9D\uDCA0-\uDCA9\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDD70-\uDD7A\uDD7C-\uDD8A\uDD8C-\uDD92\uDD94\uDD95\uDD97-\uDDA1\uDDA3-\uDDB1\uDDB3-\uDDB9\uDDBB\uDDBC\uDDC0-\uDDF3\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67\uDF80-\uDF85\uDF87-\uDFB0\uDFB2-\uDFBA]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00-\uDE03\uDE05\uDE06\uDE0C-\uDE13\uDE15-\uDE17\uDE19-\uDE35\uDE38-\uDE3A\uDE3F\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE6\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2\uDD00-\uDD27\uDD30-\uDD39\uDD40-\uDD65\uDD69-\uDD6D\uDD6F-\uDD85\uDE80-\uDEA9\uDEAB\uDEAC\uDEB0\uDEB1\uDEC2-\uDEC4\uDEFC-\uDF1C\uDF27\uDF30-\uDF50\uDF70-\uDF85\uDFB0-\uDFC4\uDFE0-\uDFF6]|\uD804[\uDC00-\uDC46\uDC66-\uDC75\uDC7F-\uDCBA\uDCC2\uDCD0-\uDCE8\uDCF0-\uDCF9\uDD00-\uDD34\uDD36-\uDD3F\uDD44-\uDD47\uDD50-\uDD73\uDD76\uDD80-\uDDC4\uDDC9-\uDDCC\uDDCE-\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE37\uDE3E-\uDE41\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEEA\uDEF0-\uDEF9\uDF00-\uDF03\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3B-\uDF44\uDF47\uDF48\uDF4B-\uDF4D\uDF50\uDF57\uDF5D-\uDF63\uDF66-\uDF6C\uDF70-\uDF74\uDF80-\uDF89\uDF8B\uDF8E\uDF90-\uDFB5\uDFB7-\uDFC0\uDFC2\uDFC5\uDFC7-\uDFCA\uDFCC-\uDFD3\uDFE1\uDFE2]|\uD805[\uDC00-\uDC4A\uDC50-\uDC59\uDC5E-\uDC61\uDC80-\uDCC5\uDCC7\uDCD0-\uDCD9\uDD80-\uDDB5\uDDB8-\uDDC0\uDDD8-\uDDDD\uDE00-\uDE40\uDE44\uDE50-\uDE59\uDE80-\uDEB8\uDEC0-\uDEC9\uDED0-\uDEE3\uDF00-\uDF1A\uDF1D-\uDF2B\uDF30-\uDF39\uDF40-\uDF46]|\uD806[\uDC00-\uDC3A\uDCA0-\uDCE9\uDCFF-\uDD06\uDD09\uDD0C-\uDD13\uDD15\uDD16\uDD18-\uDD35\uDD37\uDD38\uDD3B-\uDD43\uDD50-\uDD59\uDDA0-\uDDA7\uDDAA-\uDDD7\uDDDA-\uDDE1\uDDE3\uDDE4\uDE00-\uDE3E\uDE47\uDE50-\uDE99\uDE9D\uDEB0-\uDEF8\uDFC0-\uDFE0\uDFF0-\uDFF9]|\uD807[\uDC00-\uDC08\uDC0A-\uDC36\uDC38-\uDC40\uDC50-\uDC59\uDC72-\uDC8F\uDC92-\uDCA7\uDCA9-\uDCB6\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD36\uDD3A\uDD3C\uDD3D\uDD3F-\uDD47\uDD50-\uDD59\uDD60-\uDD65\uDD67\uDD68\uDD6A-\uDD8E\uDD90\uDD91\uDD93-\uDD98\uDDA0-\uDDA9\uDEE0-\uDEF6\uDF00-\uDF10\uDF12-\uDF3A\uDF3E-\uDF42\uDF50-\uDF5A\uDFB0]|\uD808[\uDC00-\uDF99]|\uD809[\uDC00-\uDC6E\uDC80-\uDD43]|\uD80B[\uDF90-\uDFF0]|[\uD80C\uD80E\uD80F\uD81C-\uD820\uD822\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879\uD880-\uD883\uD885-\uD887][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2F\uDC40-\uDC55\uDC60-\uDFFF]|\uD810[\uDC00-\uDFFA]|\uD811[\uDC00-\uDE46]|\uD818[\uDD00-\uDD39]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE60-\uDE69\uDE70-\uDEBE\uDEC0-\uDEC9\uDED0-\uDEED\uDEF0-\uDEF4\uDF00-\uDF36\uDF40-\uDF43\uDF50-\uDF59\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDD40-\uDD6C\uDD70-\uDD79\uDE40-\uDE7F\uDF00-\uDF4A\uDF4F-\uDF87\uDF8F-\uDF9F\uDFE0\uDFE1\uDFE3\uDFE4\uDFF0\uDFF1]|\uD821[\uDC00-\uDFF7]|\uD823[\uDC00-\uDCD5\uDCFF-\uDD08]|\uD82B[\uDFF0-\uDFF3\uDFF5-\uDFFB\uDFFD\uDFFE]|\uD82C[\uDC00-\uDD22\uDD32\uDD50-\uDD52\uDD55\uDD64-\uDD67\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99\uDC9D\uDC9E]|\uD833[\uDCF0-\uDCF9\uDF00-\uDF2D\uDF30-\uDF46]|\uD834[\uDD65-\uDD69\uDD6D-\uDD72\uDD7B-\uDD82\uDD85-\uDD8B\uDDAA-\uDDAD\uDE42-\uDE44]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB\uDFCE-\uDFFF]|\uD836[\uDE00-\uDE36\uDE3B-\uDE6C\uDE75\uDE84\uDE9B-\uDE9F\uDEA1-\uDEAF]|\uD837[\uDF00-\uDF1E\uDF25-\uDF2A]|\uD838[\uDC00-\uDC06\uDC08-\uDC18\uDC1B-\uDC21\uDC23\uDC24\uDC26-\uDC2A\uDC30-\uDC6D\uDC8F\uDD00-\uDD2C\uDD30-\uDD3D\uDD40-\uDD49\uDD4E\uDE90-\uDEAE\uDEC0-\uDEF9]|\uD839[\uDCD0-\uDCF9\uDDD0-\uDDFA\uDFE0-\uDFE6\uDFE8-\uDFEB\uDFED\uDFEE\uDFF0-\uDFFE]|\uD83A[\uDC00-\uDCC4\uDCD0-\uDCD6\uDD00-\uDD4B\uDD50-\uDD59]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD83E[\uDFF0-\uDFF9]|\uD869[\uDC00-\uDEDF\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF39\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0\uDFF0-\uDFFF]|\uD87B[\uDC00-\uDE5D]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A\uDF50-\uDFFF]|\uD888[\uDC00-\uDFAF]|\uDB40[\uDD00-\uDDEF])*$/,n9=/^(?:[\$A-Z_a-z\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0560-\u0588\u05D0-\u05EA\u05EF-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u0860-\u086A\u0870-\u0887\u0889-\u088E\u08A0-\u08C9\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u09FC\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C5D\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D04-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E86-\u0E8A\u0E8C-\u0EA3\u0EA5\u0EA7-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u1711\u171F-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1878\u1880-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4C\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C8A\u1C90-\u1CBA\u1CBD-\u1CBF\u1CE9-\u1CEC\u1CEE-\u1CF3\u1CF5\u1CF6\u1CFA\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2118-\u211D\u2124\u2126\u2128\u212A-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2188\u2C00-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303C\u3041-\u3096\u309B-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312F\u3131-\u318E\u31A0-\u31BF\u31F0-\u31FF\u3400-\u4DBF\u4E00-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6EF\uA717-\uA71F\uA722-\uA788\uA78B-\uA7CD\uA7D0\uA7D1\uA7D3\uA7D5-\uA7DC\uA7F2-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA8FE\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB69\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDD40-\uDD74\uDE80-\uDE9C\uDEA0-\uDED0\uDF00-\uDF1F\uDF2D-\uDF4A\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF\uDFD1-\uDFD5]|\uD801[\uDC00-\uDC9D\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDD70-\uDD7A\uDD7C-\uDD8A\uDD8C-\uDD92\uDD94\uDD95\uDD97-\uDDA1\uDDA3-\uDDB1\uDDB3-\uDDB9\uDDBB\uDDBC\uDDC0-\uDDF3\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67\uDF80-\uDF85\uDF87-\uDFB0\uDFB2-\uDFBA]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE35\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE4\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2\uDD00-\uDD23\uDD4A-\uDD65\uDD6F-\uDD85\uDE80-\uDEA9\uDEB0\uDEB1\uDEC2-\uDEC4\uDF00-\uDF1C\uDF27\uDF30-\uDF45\uDF70-\uDF81\uDFB0-\uDFC4\uDFE0-\uDFF6]|\uD804[\uDC03-\uDC37\uDC71\uDC72\uDC75\uDC83-\uDCAF\uDCD0-\uDCE8\uDD03-\uDD26\uDD44\uDD47\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE2B\uDE3F\uDE40\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61\uDF80-\uDF89\uDF8B\uDF8E\uDF90-\uDFB5\uDFB7\uDFD1\uDFD3]|\uD805[\uDC00-\uDC34\uDC47-\uDC4A\uDC5F-\uDC61\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE80-\uDEAA\uDEB8\uDF00-\uDF1A\uDF40-\uDF46]|\uD806[\uDC00-\uDC2B\uDCA0-\uDCDF\uDCFF-\uDD06\uDD09\uDD0C-\uDD13\uDD15\uDD16\uDD18-\uDD2F\uDD3F\uDD41\uDDA0-\uDDA7\uDDAA-\uDDD0\uDDE1\uDDE3\uDE00\uDE0B-\uDE32\uDE3A\uDE50\uDE5C-\uDE89\uDE9D\uDEB0-\uDEF8\uDFC0-\uDFE0]|\uD807[\uDC00-\uDC08\uDC0A-\uDC2E\uDC40\uDC72-\uDC8F\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD30\uDD46\uDD60-\uDD65\uDD67\uDD68\uDD6A-\uDD89\uDD98\uDEE0-\uDEF2\uDF02\uDF04-\uDF10\uDF12-\uDF33\uDFB0]|\uD808[\uDC00-\uDF99]|\uD809[\uDC00-\uDC6E\uDC80-\uDD43]|\uD80B[\uDF90-\uDFF0]|[\uD80C\uD80E\uD80F\uD81C-\uD820\uD822\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879\uD880-\uD883\uD885-\uD887][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2F\uDC41-\uDC46\uDC60-\uDFFF]|\uD810[\uDC00-\uDFFA]|\uD811[\uDC00-\uDE46]|\uD818[\uDD00-\uDD1D]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE70-\uDEBE\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDD40-\uDD6C\uDE40-\uDE7F\uDF00-\uDF4A\uDF50\uDF93-\uDF9F\uDFE0\uDFE1\uDFE3]|\uD821[\uDC00-\uDFF7]|\uD823[\uDC00-\uDCD5\uDCFF-\uDD08]|\uD82B[\uDFF0-\uDFF3\uDFF5-\uDFFB\uDFFD\uDFFE]|\uD82C[\uDC00-\uDD22\uDD32\uDD50-\uDD52\uDD55\uDD64-\uDD67\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB]|\uD837[\uDF00-\uDF1E\uDF25-\uDF2A]|\uD838[\uDC30-\uDC6D\uDD00-\uDD2C\uDD37-\uDD3D\uDD4E\uDE90-\uDEAD\uDEC0-\uDEEB]|\uD839[\uDCD0-\uDCEB\uDDD0-\uDDED\uDDF0\uDFE0-\uDFE6\uDFE8-\uDFEB\uDFED\uDFEE\uDFF0-\uDFFE]|\uD83A[\uDC00-\uDCC4\uDD00-\uDD43\uDD4B]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDEDF\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF39\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0\uDFF0-\uDFFF]|\uD87B[\uDC00-\uDE5D]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A\uDF50-\uDFFF]|\uD888[\uDC00-\uDFAF])(?:[\$\x2D0-9A-Z_a-z\xAA\xB5\xB7\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0300-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u0483-\u0487\u048A-\u052F\u0531-\u0556\u0559\u0560-\u0588\u0591-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7\u05D0-\u05EA\u05EF-\u05F2\u0610-\u061A\u0620-\u0669\u066E-\u06D3\u06D5-\u06DC\u06DF-\u06E8\u06EA-\u06FC\u06FF\u0710-\u074A\u074D-\u07B1\u07C0-\u07F5\u07FA\u07FD\u0800-\u082D\u0840-\u085B\u0860-\u086A\u0870-\u0887\u0889-\u088E\u0897-\u08E1\u08E3-\u0963\u0966-\u096F\u0971-\u0983\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BC-\u09C4\u09C7\u09C8\u09CB-\u09CE\u09D7\u09DC\u09DD\u09DF-\u09E3\u09E6-\u09F1\u09FC\u09FE\u0A01-\u0A03\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A3C\u0A3E-\u0A42\u0A47\u0A48\u0A4B-\u0A4D\u0A51\u0A59-\u0A5C\u0A5E\u0A66-\u0A75\u0A81-\u0A83\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABC-\u0AC5\u0AC7-\u0AC9\u0ACB-\u0ACD\u0AD0\u0AE0-\u0AE3\u0AE6-\u0AEF\u0AF9-\u0AFF\u0B01-\u0B03\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3C-\u0B44\u0B47\u0B48\u0B4B-\u0B4D\u0B55-\u0B57\u0B5C\u0B5D\u0B5F-\u0B63\u0B66-\u0B6F\u0B71\u0B82\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BBE-\u0BC2\u0BC6-\u0BC8\u0BCA-\u0BCD\u0BD0\u0BD7\u0BE6-\u0BEF\u0C00-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3C-\u0C44\u0C46-\u0C48\u0C4A-\u0C4D\u0C55\u0C56\u0C58-\u0C5A\u0C5D\u0C60-\u0C63\u0C66-\u0C6F\u0C80-\u0C83\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBC-\u0CC4\u0CC6-\u0CC8\u0CCA-\u0CCD\u0CD5\u0CD6\u0CDD\u0CDE\u0CE0-\u0CE3\u0CE6-\u0CEF\u0CF1-\u0CF3\u0D00-\u0D0C\u0D0E-\u0D10\u0D12-\u0D44\u0D46-\u0D48\u0D4A-\u0D4E\u0D54-\u0D57\u0D5F-\u0D63\u0D66-\u0D6F\u0D7A-\u0D7F\u0D81-\u0D83\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0DCA\u0DCF-\u0DD4\u0DD6\u0DD8-\u0DDF\u0DE6-\u0DEF\u0DF2\u0DF3\u0E01-\u0E3A\u0E40-\u0E4E\u0E50-\u0E59\u0E81\u0E82\u0E84\u0E86-\u0E8A\u0E8C-\u0EA3\u0EA5\u0EA7-\u0EBD\u0EC0-\u0EC4\u0EC6\u0EC8-\u0ECE\u0ED0-\u0ED9\u0EDC-\u0EDF\u0F00\u0F18\u0F19\u0F20-\u0F29\u0F35\u0F37\u0F39\u0F3E-\u0F47\u0F49-\u0F6C\u0F71-\u0F84\u0F86-\u0F97\u0F99-\u0FBC\u0FC6\u1000-\u1049\u1050-\u109D\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u135D-\u135F\u1369-\u1371\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u1715\u171F-\u1734\u1740-\u1753\u1760-\u176C\u176E-\u1770\u1772\u1773\u1780-\u17D3\u17D7\u17DC\u17DD\u17E0-\u17E9\u180B-\u180D\u180F-\u1819\u1820-\u1878\u1880-\u18AA\u18B0-\u18F5\u1900-\u191E\u1920-\u192B\u1930-\u193B\u1946-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u19D0-\u19DA\u1A00-\u1A1B\u1A20-\u1A5E\u1A60-\u1A7C\u1A7F-\u1A89\u1A90-\u1A99\u1AA7\u1AB0-\u1ABD\u1ABF-\u1ACE\u1B00-\u1B4C\u1B50-\u1B59\u1B6B-\u1B73\u1B80-\u1BF3\u1C00-\u1C37\u1C40-\u1C49\u1C4D-\u1C7D\u1C80-\u1C8A\u1C90-\u1CBA\u1CBD-\u1CBF\u1CD0-\u1CD2\u1CD4-\u1CFA\u1D00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u200C\u200D\u203F\u2040\u2054\u2071\u207F\u2090-\u209C\u20D0-\u20DC\u20E1\u20E5-\u20F0\u2102\u2107\u210A-\u2113\u2115\u2118-\u211D\u2124\u2126\u2128\u212A-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2188\u2C00-\u2CE4\u2CEB-\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D7F-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2DE0-\u2DFF\u3005-\u3007\u3021-\u302F\u3031-\u3035\u3038-\u303C\u3041-\u3096\u3099-\u309F\u30A1-\u30FF\u3105-\u312F\u3131-\u318E\u31A0-\u31BF\u31F0-\u31FF\u3400-\u4DBF\u4E00-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA62B\uA640-\uA66F\uA674-\uA67D\uA67F-\uA6F1\uA717-\uA71F\uA722-\uA788\uA78B-\uA7CD\uA7D0\uA7D1\uA7D3\uA7D5-\uA7DC\uA7F2-\uA827\uA82C\uA840-\uA873\uA880-\uA8C5\uA8D0-\uA8D9\uA8E0-\uA8F7\uA8FB\uA8FD-\uA92D\uA930-\uA953\uA960-\uA97C\uA980-\uA9C0\uA9CF-\uA9D9\uA9E0-\uA9FE\uAA00-\uAA36\uAA40-\uAA4D\uAA50-\uAA59\uAA60-\uAA76\uAA7A-\uAAC2\uAADB-\uAADD\uAAE0-\uAAEF\uAAF2-\uAAF6\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB69\uAB70-\uABEA\uABEC\uABED\uABF0-\uABF9\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE00-\uFE0F\uFE20-\uFE2F\uFE33\uFE34\uFE4D-\uFE4F\uFE70-\uFE74\uFE76-\uFEFC\uFF10-\uFF19\uFF21-\uFF3A\uFF3F\uFF41-\uFF5A\uFF65-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDD40-\uDD74\uDDFD\uDE80-\uDE9C\uDEA0-\uDED0\uDEE0\uDF00-\uDF1F\uDF2D-\uDF4A\uDF50-\uDF7A\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF\uDFD1-\uDFD5]|\uD801[\uDC00-\uDC9D\uDCA0-\uDCA9\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDD70-\uDD7A\uDD7C-\uDD8A\uDD8C-\uDD92\uDD94\uDD95\uDD97-\uDDA1\uDDA3-\uDDB1\uDDB3-\uDDB9\uDDBB\uDDBC\uDDC0-\uDDF3\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67\uDF80-\uDF85\uDF87-\uDFB0\uDFB2-\uDFBA]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00-\uDE03\uDE05\uDE06\uDE0C-\uDE13\uDE15-\uDE17\uDE19-\uDE35\uDE38-\uDE3A\uDE3F\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE6\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2\uDD00-\uDD27\uDD30-\uDD39\uDD40-\uDD65\uDD69-\uDD6D\uDD6F-\uDD85\uDE80-\uDEA9\uDEAB\uDEAC\uDEB0\uDEB1\uDEC2-\uDEC4\uDEFC-\uDF1C\uDF27\uDF30-\uDF50\uDF70-\uDF85\uDFB0-\uDFC4\uDFE0-\uDFF6]|\uD804[\uDC00-\uDC46\uDC66-\uDC75\uDC7F-\uDCBA\uDCC2\uDCD0-\uDCE8\uDCF0-\uDCF9\uDD00-\uDD34\uDD36-\uDD3F\uDD44-\uDD47\uDD50-\uDD73\uDD76\uDD80-\uDDC4\uDDC9-\uDDCC\uDDCE-\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE37\uDE3E-\uDE41\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEEA\uDEF0-\uDEF9\uDF00-\uDF03\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3B-\uDF44\uDF47\uDF48\uDF4B-\uDF4D\uDF50\uDF57\uDF5D-\uDF63\uDF66-\uDF6C\uDF70-\uDF74\uDF80-\uDF89\uDF8B\uDF8E\uDF90-\uDFB5\uDFB7-\uDFC0\uDFC2\uDFC5\uDFC7-\uDFCA\uDFCC-\uDFD3\uDFE1\uDFE2]|\uD805[\uDC00-\uDC4A\uDC50-\uDC59\uDC5E-\uDC61\uDC80-\uDCC5\uDCC7\uDCD0-\uDCD9\uDD80-\uDDB5\uDDB8-\uDDC0\uDDD8-\uDDDD\uDE00-\uDE40\uDE44\uDE50-\uDE59\uDE80-\uDEB8\uDEC0-\uDEC9\uDED0-\uDEE3\uDF00-\uDF1A\uDF1D-\uDF2B\uDF30-\uDF39\uDF40-\uDF46]|\uD806[\uDC00-\uDC3A\uDCA0-\uDCE9\uDCFF-\uDD06\uDD09\uDD0C-\uDD13\uDD15\uDD16\uDD18-\uDD35\uDD37\uDD38\uDD3B-\uDD43\uDD50-\uDD59\uDDA0-\uDDA7\uDDAA-\uDDD7\uDDDA-\uDDE1\uDDE3\uDDE4\uDE00-\uDE3E\uDE47\uDE50-\uDE99\uDE9D\uDEB0-\uDEF8\uDFC0-\uDFE0\uDFF0-\uDFF9]|\uD807[\uDC00-\uDC08\uDC0A-\uDC36\uDC38-\uDC40\uDC50-\uDC59\uDC72-\uDC8F\uDC92-\uDCA7\uDCA9-\uDCB6\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD36\uDD3A\uDD3C\uDD3D\uDD3F-\uDD47\uDD50-\uDD59\uDD60-\uDD65\uDD67\uDD68\uDD6A-\uDD8E\uDD90\uDD91\uDD93-\uDD98\uDDA0-\uDDA9\uDEE0-\uDEF6\uDF00-\uDF10\uDF12-\uDF3A\uDF3E-\uDF42\uDF50-\uDF5A\uDFB0]|\uD808[\uDC00-\uDF99]|\uD809[\uDC00-\uDC6E\uDC80-\uDD43]|\uD80B[\uDF90-\uDFF0]|[\uD80C\uD80E\uD80F\uD81C-\uD820\uD822\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879\uD880-\uD883\uD885-\uD887][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2F\uDC40-\uDC55\uDC60-\uDFFF]|\uD810[\uDC00-\uDFFA]|\uD811[\uDC00-\uDE46]|\uD818[\uDD00-\uDD39]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE60-\uDE69\uDE70-\uDEBE\uDEC0-\uDEC9\uDED0-\uDEED\uDEF0-\uDEF4\uDF00-\uDF36\uDF40-\uDF43\uDF50-\uDF59\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDD40-\uDD6C\uDD70-\uDD79\uDE40-\uDE7F\uDF00-\uDF4A\uDF4F-\uDF87\uDF8F-\uDF9F\uDFE0\uDFE1\uDFE3\uDFE4\uDFF0\uDFF1]|\uD821[\uDC00-\uDFF7]|\uD823[\uDC00-\uDCD5\uDCFF-\uDD08]|\uD82B[\uDFF0-\uDFF3\uDFF5-\uDFFB\uDFFD\uDFFE]|\uD82C[\uDC00-\uDD22\uDD32\uDD50-\uDD52\uDD55\uDD64-\uDD67\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99\uDC9D\uDC9E]|\uD833[\uDCF0-\uDCF9\uDF00-\uDF2D\uDF30-\uDF46]|\uD834[\uDD65-\uDD69\uDD6D-\uDD72\uDD7B-\uDD82\uDD85-\uDD8B\uDDAA-\uDDAD\uDE42-\uDE44]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB\uDFCE-\uDFFF]|\uD836[\uDE00-\uDE36\uDE3B-\uDE6C\uDE75\uDE84\uDE9B-\uDE9F\uDEA1-\uDEAF]|\uD837[\uDF00-\uDF1E\uDF25-\uDF2A]|\uD838[\uDC00-\uDC06\uDC08-\uDC18\uDC1B-\uDC21\uDC23\uDC24\uDC26-\uDC2A\uDC30-\uDC6D\uDC8F\uDD00-\uDD2C\uDD30-\uDD3D\uDD40-\uDD49\uDD4E\uDE90-\uDEAE\uDEC0-\uDEF9]|\uD839[\uDCD0-\uDCF9\uDDD0-\uDDFA\uDFE0-\uDFE6\uDFE8-\uDFEB\uDFED\uDFEE\uDFF0-\uDFFE]|\uD83A[\uDC00-\uDCC4\uDCD0-\uDCD6\uDD00-\uDD4B\uDD50-\uDD59]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD83E[\uDFF0-\uDFF9]|\uD869[\uDC00-\uDEDF\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF39\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0\uDFF0-\uDFFF]|\uD87B[\uDC00-\uDE5D]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A\uDF50-\uDFFF]|\uD888[\uDC00-\uDFAF]|\uDB40[\uDD00-\uDDEF])*$/,i9={};function r9(e,t){return((t||i9).jsx?n9:t9).test(e)}const s9=/[ \t\n\f\r]/g;function a9(e){return""===e.replace(s9,"")}class o9{constructor(e,t,n){this.property=e,this.normal=t,n&&(this.space=n)}}function l9(e,t){const n={},i={};let r=-1;for(;++r<e.length;)Object.assign(n,e[r].property),Object.assign(i,e[r].normal);return new o9(n,i,t)}function u9(e){return e.toLowerCase()}o9.prototype.property={},o9.prototype.normal={},o9.prototype.space=null;class c9{constructor(e,t){this.property=e,this.attribute=t}}c9.prototype.space=null,c9.prototype.boolean=!1,c9.prototype.booleanish=!1,c9.prototype.overloadedBoolean=!1,c9.prototype.number=!1,c9.prototype.commaSeparated=!1,c9.prototype.spaceSeparated=!1,c9.prototype.commaOrSpaceSeparated=!1,c9.prototype.mustUseProperty=!1,c9.prototype.defined=!1;let h9=0;const d9=x9(),p9=x9(),f9=x9(),m9=x9(),g9=x9(),v9=x9(),y9=x9();function x9(){return 2**++h9}const b9=Object.keys(t);class w9 extends c9{constructor(e,n,i,r){let s=-1;if(super(e,n),D9(this,"space",r),"number"===typeof i)for(;++s<b9.length;){const e=b9[s];D9(this,b9[s],(i&t[e])===t[e])}}}function D9(e,t,n){n&&(e[t]=n)}w9.prototype.defined=!0;const _9={}.hasOwnProperty;function S9(e){const t={},n={};let i;for(i in e.properties)if(_9.call(e.properties,i)){const r=e.properties[i],s=new w9(i,e.transform(e.attributes||{},i),r,e.space);e.mustUseProperty&&e.mustUseProperty.includes(i)&&(s.mustUseProperty=!0),t[i]=s,n[u9(i)]=i,n[u9(s.attribute)]=i}return new o9(t,n,e.space)}const E9=S9({space:"xlink",transform:(e,t)=>"xlink:"+t.slice(5).toLowerCase(),properties:{xLinkActuate:null,xLinkArcRole:null,xLinkHref:null,xLinkRole:null,xLinkShow:null,xLinkTitle:null,xLinkType:null}}),C9=S9({space:"xml",transform:(e,t)=>"xml:"+t.slice(3).toLowerCase(),properties:{xmlLang:null,xmlBase:null,xmlSpace:null}});function A9(e,t){return t in e?e[t]:t}function M9(e,t){return A9(e,t.toLowerCase())}const T9=S9({space:"xmlns",attributes:{xmlnsxlink:"xmlns:xlink"},transform:M9,properties:{xmlns:null,xmlnsXLink:null}}),P9=S9({transform:(e,t)=>"role"===t?t:"aria-"+t.slice(4).toLowerCase(),properties:{ariaActiveDescendant:null,ariaAtomic:p9,ariaAutoComplete:null,ariaBusy:p9,ariaChecked:p9,ariaColCount:m9,ariaColIndex:m9,ariaColSpan:m9,ariaControls:g9,ariaCurrent:null,ariaDescribedBy:g9,ariaDetails:null,ariaDisabled:p9,ariaDropEffect:g9,ariaErrorMessage:null,ariaExpanded:p9,ariaFlowTo:g9,ariaGrabbed:p9,ariaHasPopup:null,ariaHidden:p9,ariaInvalid:null,ariaKeyShortcuts:null,ariaLabel:null,ariaLabelledBy:g9,ariaLevel:m9,ariaLive:null,ariaModal:p9,ariaMultiLine:p9,ariaMultiSelectable:p9,ariaOrientation:null,ariaOwns:g9,ariaPlaceholder:null,ariaPosInSet:m9,ariaPressed:p9,ariaReadOnly:p9,ariaRelevant:null,ariaRequired:p9,ariaRoleDescription:g9,ariaRowCount:m9,ariaRowIndex:m9,ariaRowSpan:m9,ariaSelected:p9,ariaSetSize:m9,ariaSort:null,ariaValueMax:m9,ariaValueMin:m9,ariaValueNow:m9,ariaValueText:null,role:null}}),F9=S9({space:"html",attributes:{acceptcharset:"accept-charset",classname:"class",htmlfor:"for",httpequiv:"http-equiv"},transform:M9,mustUseProperty:["checked","multiple","muted","selected"],properties:{abbr:null,accept:v9,acceptCharset:g9,accessKey:g9,action:null,allow:null,allowFullScreen:d9,allowPaymentRequest:d9,allowUserMedia:d9,alt:null,as:null,async:d9,autoCapitalize:null,autoComplete:g9,autoFocus:d9,autoPlay:d9,blocking:g9,capture:null,charSet:null,checked:d9,cite:null,className:g9,cols:m9,colSpan:null,content:null,contentEditable:p9,controls:d9,controlsList:g9,coords:m9|v9,crossOrigin:null,data:null,dateTime:null,decoding:null,default:d9,defer:d9,dir:null,dirName:null,disabled:d9,download:f9,draggable:p9,encType:null,enterKeyHint:null,fetchPriority:null,form:null,formAction:null,formEncType:null,formMethod:null,formNoValidate:d9,formTarget:null,headers:g9,height:m9,hidden:d9,high:m9,href:null,hrefLang:null,htmlFor:g9,httpEquiv:g9,id:null,imageSizes:null,imageSrcSet:null,inert:d9,inputMode:null,integrity:null,is:null,isMap:d9,itemId:null,itemProp:g9,itemRef:g9,itemScope:d9,itemType:g9,kind:null,label:null,lang:null,language:null,list:null,loading:null,loop:d9,low:m9,manifest:null,max:null,maxLength:m9,media:null,method:null,min:null,minLength:m9,multiple:d9,muted:d9,name:null,nonce:null,noModule:d9,noValidate:d9,onAbort:null,onAfterPrint:null,onAuxClick:null,onBeforeMatch:null,onBeforePrint:null,onBeforeToggle:null,onBeforeUnload:null,onBlur:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onContextLost:null,onContextMenu:null,onContextRestored:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnded:null,onError:null,onFocus:null,onFormData:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLanguageChange:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadEnd:null,onLoadStart:null,onMessage:null,onMessageError:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRejectionHandled:null,onReset:null,onResize:null,onScroll:null,onScrollEnd:null,onSecurityPolicyViolation:null,onSeeked:null,onSeeking:null,onSelect:null,onSlotChange:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnhandledRejection:null,onUnload:null,onVolumeChange:null,onWaiting:null,onWheel:null,open:d9,optimum:m9,pattern:null,ping:g9,placeholder:null,playsInline:d9,popover:null,popoverTarget:null,popoverTargetAction:null,poster:null,preload:null,readOnly:d9,referrerPolicy:null,rel:g9,required:d9,reversed:d9,rows:m9,rowSpan:m9,sandbox:g9,scope:null,scoped:d9,seamless:d9,selected:d9,shadowRootClonable:d9,shadowRootDelegatesFocus:d9,shadowRootMode:null,shape:null,size:m9,sizes:null,slot:null,span:m9,spellCheck:p9,src:null,srcDoc:null,srcLang:null,srcSet:null,start:m9,step:null,style:null,tabIndex:m9,target:null,title:null,translate:null,type:null,typeMustMatch:d9,useMap:null,value:p9,width:m9,wrap:null,writingSuggestions:null,align:null,aLink:null,archive:g9,axis:null,background:null,bgColor:null,border:m9,borderColor:null,bottomMargin:m9,cellPadding:null,cellSpacing:null,char:null,charOff:null,classId:null,clear:null,code:null,codeBase:null,codeType:null,color:null,compact:d9,declare:d9,event:null,face:null,frame:null,frameBorder:null,hSpace:m9,leftMargin:m9,link:null,longDesc:null,lowSrc:null,marginHeight:m9,marginWidth:m9,noResize:d9,noHref:d9,noShade:d9,noWrap:d9,object:null,profile:null,prompt:null,rev:null,rightMargin:m9,rules:null,scheme:null,scrolling:p9,standby:null,summary:null,text:null,topMargin:m9,valueType:null,version:null,vAlign:null,vLink:null,vSpace:m9,allowTransparency:null,autoCorrect:null,autoSave:null,disablePictureInPicture:d9,disableRemotePlayback:d9,prefix:null,property:null,results:m9,security:null,unselectable:null}}),O9=S9({space:"svg",attributes:{accentHeight:"accent-height",alignmentBaseline:"alignment-baseline",arabicForm:"arabic-form",baselineShift:"baseline-shift",capHeight:"cap-height",className:"class",clipPath:"clip-path",clipRule:"clip-rule",colorInterpolation:"color-interpolation",colorInterpolationFilters:"color-interpolation-filters",colorProfile:"color-profile",colorRendering:"color-rendering",crossOrigin:"crossorigin",dataType:"datatype",dominantBaseline:"dominant-baseline",enableBackground:"enable-background",fillOpacity:"fill-opacity",fillRule:"fill-rule",floodColor:"flood-color",floodOpacity:"flood-opacity",fontFamily:"font-family",fontSize:"font-size",fontSizeAdjust:"font-size-adjust",fontStretch:"font-stretch",fontStyle:"font-style",fontVariant:"font-variant",fontWeight:"font-weight",glyphName:"glyph-name",glyphOrientationHorizontal:"glyph-orientation-horizontal",glyphOrientationVertical:"glyph-orientation-vertical",hrefLang:"hreflang",horizAdvX:"horiz-adv-x",horizOriginX:"horiz-origin-x",horizOriginY:"horiz-origin-y",imageRendering:"image-rendering",letterSpacing:"letter-spacing",lightingColor:"lighting-color",markerEnd:"marker-end",markerMid:"marker-mid",markerStart:"marker-start",navDown:"nav-down",navDownLeft:"nav-down-left",navDownRight:"nav-down-right",navLeft:"nav-left",navNext:"nav-next",navPrev:"nav-prev",navRight:"nav-right",navUp:"nav-up",navUpLeft:"nav-up-left",navUpRight:"nav-up-right",onAbort:"onabort",onActivate:"onactivate",onAfterPrint:"onafterprint",onBeforePrint:"onbeforeprint",onBegin:"onbegin",onCancel:"oncancel",onCanPlay:"oncanplay",onCanPlayThrough:"oncanplaythrough",onChange:"onchange",onClick:"onclick",onClose:"onclose",onCopy:"oncopy",onCueChange:"oncuechange",onCut:"oncut",onDblClick:"ondblclick",onDrag:"ondrag",onDragEnd:"ondragend",onDragEnter:"ondragenter",onDragExit:"ondragexit",onDragLeave:"ondragleave",onDragOver:"ondragover",onDragStart:"ondragstart",onDrop:"ondrop",onDurationChange:"ondurationchange",onEmptied:"onemptied",onEnd:"onend",onEnded:"onended",onError:"onerror",onFocus:"onfocus",onFocusIn:"onfocusin",onFocusOut:"onfocusout",onHashChange:"onhashchange",onInput:"oninput",onInvalid:"oninvalid",onKeyDown:"onkeydown",onKeyPress:"onkeypress",onKeyUp:"onkeyup",onLoad:"onload",onLoadedData:"onloadeddata",onLoadedMetadata:"onloadedmetadata",onLoadStart:"onloadstart",onMessage:"onmessage",onMouseDown:"onmousedown",onMouseEnter:"onmouseenter",onMouseLeave:"onmouseleave",onMouseMove:"onmousemove",onMouseOut:"onmouseout",onMouseOver:"onmouseover",onMouseUp:"onmouseup",onMouseWheel:"onmousewheel",onOffline:"onoffline",onOnline:"ononline",onPageHide:"onpagehide",onPageShow:"onpageshow",onPaste:"onpaste",onPause:"onpause",onPlay:"onplay",onPlaying:"onplaying",onPopState:"onpopstate",onProgress:"onprogress",onRateChange:"onratechange",onRepeat:"onrepeat",onReset:"onreset",onResize:"onresize",onScroll:"onscroll",onSeeked:"onseeked",onSeeking:"onseeking",onSelect:"onselect",onShow:"onshow",onStalled:"onstalled",onStorage:"onstorage",onSubmit:"onsubmit",onSuspend:"onsuspend",onTimeUpdate:"ontimeupdate",onToggle:"ontoggle",onUnload:"onunload",onVolumeChange:"onvolumechange",onWaiting:"onwaiting",onZoom:"onzoom",overlinePosition:"overline-position",overlineThickness:"overline-thickness",paintOrder:"paint-order",panose1:"panose-1",pointerEvents:"pointer-events",referrerPolicy:"referrerpolicy",renderingIntent:"rendering-intent",shapeRendering:"shape-rendering",stopColor:"stop-color",stopOpacity:"stop-opacity",strikethroughPosition:"strikethrough-position",strikethroughThickness:"strikethrough-thickness",strokeDashArray:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeLineCap:"stroke-linecap",strokeLineJoin:"stroke-linejoin",strokeMiterLimit:"stroke-miterlimit",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",tabIndex:"tabindex",textAnchor:"text-anchor",textDecoration:"text-decoration",textRendering:"text-rendering",transformOrigin:"transform-origin",typeOf:"typeof",underlinePosition:"underline-position",underlineThickness:"underline-thickness",unicodeBidi:"unicode-bidi",unicodeRange:"unicode-range",unitsPerEm:"units-per-em",vAlphabetic:"v-alphabetic",vHanging:"v-hanging",vIdeographic:"v-ideographic",vMathematical:"v-mathematical",vectorEffect:"vector-effect",vertAdvY:"vert-adv-y",vertOriginX:"vert-origin-x",vertOriginY:"vert-origin-y",wordSpacing:"word-spacing",writingMode:"writing-mode",xHeight:"x-height",playbackOrder:"playbackorder",timelineBegin:"timelinebegin"},transform:A9,properties:{about:y9,accentHeight:m9,accumulate:null,additive:null,alignmentBaseline:null,alphabetic:m9,amplitude:m9,arabicForm:null,ascent:m9,attributeName:null,attributeType:null,azimuth:m9,bandwidth:null,baselineShift:null,baseFrequency:null,baseProfile:null,bbox:null,begin:null,bias:m9,by:null,calcMode:null,capHeight:m9,className:g9,clip:null,clipPath:null,clipPathUnits:null,clipRule:null,color:null,colorInterpolation:null,colorInterpolationFilters:null,colorProfile:null,colorRendering:null,content:null,contentScriptType:null,contentStyleType:null,crossOrigin:null,cursor:null,cx:null,cy:null,d:null,dataType:null,defaultAction:null,descent:m9,diffuseConstant:m9,direction:null,display:null,dur:null,divisor:m9,dominantBaseline:null,download:d9,dx:null,dy:null,edgeMode:null,editable:null,elevation:m9,enableBackground:null,end:null,event:null,exponent:m9,externalResourcesRequired:null,fill:null,fillOpacity:m9,fillRule:null,filter:null,filterRes:null,filterUnits:null,floodColor:null,floodOpacity:null,focusable:null,focusHighlight:null,fontFamily:null,fontSize:null,fontSizeAdjust:null,fontStretch:null,fontStyle:null,fontVariant:null,fontWeight:null,format:null,fr:null,from:null,fx:null,fy:null,g1:v9,g2:v9,glyphName:v9,glyphOrientationHorizontal:null,glyphOrientationVertical:null,glyphRef:null,gradientTransform:null,gradientUnits:null,handler:null,hanging:m9,hatchContentUnits:null,hatchUnits:null,height:null,href:null,hrefLang:null,horizAdvX:m9,horizOriginX:m9,horizOriginY:m9,id:null,ideographic:m9,imageRendering:null,initialVisibility:null,in:null,in2:null,intercept:m9,k:m9,k1:m9,k2:m9,k3:m9,k4:m9,kernelMatrix:y9,kernelUnitLength:null,keyPoints:null,keySplines:null,keyTimes:null,kerning:null,lang:null,lengthAdjust:null,letterSpacing:null,lightingColor:null,limitingConeAngle:m9,local:null,markerEnd:null,markerMid:null,markerStart:null,markerHeight:null,markerUnits:null,markerWidth:null,mask:null,maskContentUnits:null,maskUnits:null,mathematical:null,max:null,media:null,mediaCharacterEncoding:null,mediaContentEncodings:null,mediaSize:m9,mediaTime:null,method:null,min:null,mode:null,name:null,navDown:null,navDownLeft:null,navDownRight:null,navLeft:null,navNext:null,navPrev:null,navRight:null,navUp:null,navUpLeft:null,navUpRight:null,numOctaves:null,observer:null,offset:null,onAbort:null,onActivate:null,onAfterPrint:null,onBeforePrint:null,onBegin:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnd:null,onEnded:null,onError:null,onFocus:null,onFocusIn:null,onFocusOut:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadStart:null,onMessage:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onMouseWheel:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRepeat:null,onReset:null,onResize:null,onScroll:null,onSeeked:null,onSeeking:null,onSelect:null,onShow:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnload:null,onVolumeChange:null,onWaiting:null,onZoom:null,opacity:null,operator:null,order:null,orient:null,orientation:null,origin:null,overflow:null,overlay:null,overlinePosition:m9,overlineThickness:m9,paintOrder:null,panose1:null,path:null,pathLength:m9,patternContentUnits:null,patternTransform:null,patternUnits:null,phase:null,ping:g9,pitch:null,playbackOrder:null,pointerEvents:null,points:null,pointsAtX:m9,pointsAtY:m9,pointsAtZ:m9,preserveAlpha:null,preserveAspectRatio:null,primitiveUnits:null,propagate:null,property:y9,r:null,radius:null,referrerPolicy:null,refX:null,refY:null,rel:y9,rev:y9,renderingIntent:null,repeatCount:null,repeatDur:null,requiredExtensions:y9,requiredFeatures:y9,requiredFonts:y9,requiredFormats:y9,resource:null,restart:null,result:null,rotate:null,rx:null,ry:null,scale:null,seed:null,shapeRendering:null,side:null,slope:null,snapshotTime:null,specularConstant:m9,specularExponent:m9,spreadMethod:null,spacing:null,startOffset:null,stdDeviation:null,stemh:null,stemv:null,stitchTiles:null,stopColor:null,stopOpacity:null,strikethroughPosition:m9,strikethroughThickness:m9,string:null,stroke:null,strokeDashArray:y9,strokeDashOffset:null,strokeLineCap:null,strokeLineJoin:null,strokeMiterLimit:m9,strokeOpacity:m9,strokeWidth:null,style:null,surfaceScale:m9,syncBehavior:null,syncBehaviorDefault:null,syncMaster:null,syncTolerance:null,syncToleranceDefault:null,systemLanguage:y9,tabIndex:m9,tableValues:null,target:null,targetX:m9,targetY:m9,textAnchor:null,textDecoration:null,textRendering:null,textLength:null,timelineBegin:null,title:null,transformBehavior:null,type:null,typeOf:y9,to:null,transform:null,transformOrigin:null,u1:null,u2:null,underlinePosition:m9,underlineThickness:m9,unicode:null,unicodeBidi:null,unicodeRange:null,unitsPerEm:m9,values:null,vAlphabetic:m9,vMathematical:m9,vectorEffect:null,vHanging:m9,vIdeographic:m9,version:null,vertAdvY:m9,vertOriginX:m9,vertOriginY:m9,viewBox:null,viewTarget:null,visibility:null,width:null,widths:null,wordSpacing:null,writingMode:null,x:null,x1:null,x2:null,xChannelSelector:null,xHeight:m9,y:null,y1:null,y2:null,yChannelSelector:null,z:null,zoomAndPan:null}}),I9=l9([C9,E9,T9,P9,F9],"html"),k9=l9([C9,E9,T9,P9,O9],"svg"),B9=/^data[-\w.:]+$/i,R9=/-[a-z]/g,L9=/[A-Z]/g;function z9(e){return"-"+e.toLowerCase()}function N9(e){return e.charAt(1).toUpperCase()}const j9={classId:"classID",dataType:"datatype",itemId:"itemID",strokeDashArray:"strokeDasharray",strokeDashOffset:"strokeDashoffset",strokeLineCap:"strokeLinecap",strokeLineJoin:"strokeLinejoin",strokeMiterLimit:"strokeMiterlimit",typeOf:"typeof",xLinkActuate:"xlinkActuate",xLinkArcRole:"xlinkArcrole",xLinkHref:"xlinkHref",xLinkRole:"xlinkRole",xLinkShow:"xlinkShow",xLinkTitle:"xlinkTitle",xLinkType:"xlinkType",xmlnsXLink:"xmlnsXlink"};var U9=n(222);const V9=U9.default||U9,H9=G9("end"),W9=G9("start");function G9(e){return function(t){const n=t&&t.position&&t.position[e]||{};if("number"===typeof n.line&&n.line>0&&"number"===typeof n.column&&n.column>0)return{line:n.line,column:n.column,offset:"number"===typeof n.offset&&n.offset>-1?n.offset:void 0}}}function q9(e){return e&&"object"===typeof e?"position"in e||"type"in e?X9(e.position):"start"in e||"end"in e?X9(e):"line"in e||"column"in e?Y9(e):"":""}function Y9(e){return Q9(e&&e.line)+":"+Q9(e&&e.column)}function X9(e){return Y9(e&&e.start)+"-"+Y9(e&&e.end)}function Q9(e){return e&&"number"===typeof e?e:1}class K9 extends Error{constructor(e,t,n){super(),"string"===typeof t&&(n=t,t=void 0);let i="",r={},s=!1;if(t&&(r="line"in t&&"column"in t||"start"in t&&"end"in t?{place:t}:"type"in t?{ancestors:[t],place:t.position}:d({},t)),"string"===typeof e?i=e:!r.cause&&e&&(s=!0,i=e.message,r.cause=e),!r.ruleId&&!r.source&&"string"===typeof n){const e=n.indexOf(":");-1===e?r.ruleId=n:(r.source=n.slice(0,e),r.ruleId=n.slice(e+1))}if(!r.place&&r.ancestors&&r.ancestors){const e=r.ancestors[r.ancestors.length-1];e&&(r.place=e.position)}const a=r.place&&"start"in r.place?r.place.start:r.place;this.ancestors=r.ancestors||void 0,this.cause=r.cause||void 0,this.column=a?a.column:void 0,this.fatal=void 0,this.file,this.message=i,this.line=a?a.line:void 0,this.name=q9(r.place)||"1:1",this.place=r.place||void 0,this.reason=this.message,this.ruleId=r.ruleId||void 0,this.source=r.source||void 0,this.stack=s&&r.cause&&"string"===typeof r.cause.stack?r.cause.stack:"",this.actual,this.expected,this.note,this.url}}K9.prototype.file="",K9.prototype.name="",K9.prototype.reason="",K9.prototype.message="",K9.prototype.stack="",K9.prototype.column=void 0,K9.prototype.line=void 0,K9.prototype.ancestors=void 0,K9.prototype.cause=void 0,K9.prototype.fatal=void 0,K9.prototype.place=void 0,K9.prototype.ruleId=void 0,K9.prototype.source=void 0;const Z9={}.hasOwnProperty,J9=new Map,$9=/[A-Z]/g,e7=/-([a-z])/g,t7=new Set(["table","tbody","thead","tfoot","tr"]),n7=new Set(["td","th"]),i7="https://github.com/syntax-tree/hast-util-to-jsx-runtime";function r7(e,t){if(!t||void 0===t.Fragment)throw new TypeError("Expected `Fragment` in options");const n=t.filePath||void 0;let i;if(t.development){if("function"!==typeof t.jsxDEV)throw new TypeError("Expected `jsxDEV` in options when `development: true`");i=function(e,t){return n;function n(n,i,r,s){const a=Array.isArray(r.children),o=W9(n);return t(i,r,s,a,{columnNumber:o?o.column-1:void 0,fileName:e,lineNumber:o?o.line:void 0},void 0)}}(n,t.jsxDEV)}else{if("function"!==typeof t.jsx)throw new TypeError("Expected `jsx` in production options");if("function"!==typeof t.jsxs)throw new TypeError("Expected `jsxs` in production options");i=function(e,t,n){return i;function i(e,i,r,s){const a=Array.isArray(r.children)?n:t;return s?a(i,r,s):a(i,r)}}(0,t.jsx,t.jsxs)}const r={Fragment:t.Fragment,ancestors:[],components:t.components||{},create:i,elementAttributeNameCase:t.elementAttributeNameCase||"react",evaluater:t.createEvaluater?t.createEvaluater():void 0,filePath:n,ignoreInvalidStyle:t.ignoreInvalidStyle||!1,passKeys:!1!==t.passKeys,passNode:t.passNode||!1,schema:"svg"===t.space?k9:I9,stylePropertyNameCase:t.stylePropertyNameCase||"dom",tableCellAlignToStyle:!1!==t.tableCellAlignToStyle},s=s7(r,e,void 0);return s&&"string"!==typeof s?s:r.create(e,r.Fragment,{children:s||void 0},void 0)}function s7(e,t,n){return"element"===t.type?function(e,t,n){const i=e.schema;let r=i;"svg"===t.tagName.toLowerCase()&&"html"===i.space&&(r=k9,e.schema=r);e.ancestors.push(t);const s=c7(e,t.tagName,!1),a=function(e,t){const n={};let i,r;for(r in t.properties)if("children"!==r&&Z9.call(t.properties,r)){const s=u7(e,r,t.properties[r]);if(s){const[r,a]=s;e.tableCellAlignToStyle&&"align"===r&&"string"===typeof a&&n7.has(t.tagName)?i=a:n[r]=a}}if(i){(n.style||(n.style={}))["css"===e.stylePropertyNameCase?"text-align":"textAlign"]=i}return n}(e,t);let o=l7(e,t);t7.has(t.tagName)&&(o=o.filter((function(e){return"string"!==typeof e||!("object"===typeof(t=e)?"text"===t.type&&a9(t.value):a9(t));var t})));return a7(e,a,s,t),o7(a,o),e.ancestors.pop(),e.schema=i,e.create(t,s,a,n)}(e,t,n):"mdxFlowExpression"===t.type||"mdxTextExpression"===t.type?function(e,t){if(t.data&&t.data.estree&&e.evaluater){const n=t.data.estree.body[0];return n.type,e.evaluater.evaluateExpression(n.expression)}h7(e,t.position)}(e,t):"mdxJsxFlowElement"===t.type||"mdxJsxTextElement"===t.type?function(e,t,n){const i=e.schema;let r=i;"svg"===t.name&&"html"===i.space&&(r=k9,e.schema=r);e.ancestors.push(t);const s=null===t.name?e.Fragment:c7(e,t.name,!0),a=function(e,t){const n={};for(const i of t.attributes)if("mdxJsxExpressionAttribute"===i.type)if(i.data&&i.data.estree&&e.evaluater){const t=i.data.estree.body[0];t.type;const r=t.expression;r.type;const s=r.properties[0];s.type,Object.assign(n,e.evaluater.evaluateExpression(s.argument))}else h7(e,t.position);else{const r=i.name;let s;if(i.value&&"object"===typeof i.value)if(i.value.data&&i.value.data.estree&&e.evaluater){const t=i.value.data.estree.body[0];t.type,s=e.evaluater.evaluateExpression(t.expression)}else h7(e,t.position);else s=null===i.value||i.value;n[r]=s}return n}(e,t),o=l7(e,t);return a7(e,a,s,t),o7(a,o),e.ancestors.pop(),e.schema=i,e.create(t,s,a,n)}(e,t,n):"mdxjsEsm"===t.type?function(e,t){if(t.data&&t.data.estree&&e.evaluater)return e.evaluater.evaluateProgram(t.data.estree);h7(e,t.position)}(e,t):"root"===t.type?function(e,t,n){const i={};return o7(i,l7(e,t)),e.create(t,e.Fragment,i,n)}(e,t,n):"text"===t.type?function(e,t){return t.value}(0,t):void 0}function a7(e,t,n,i){"string"!==typeof n&&n!==e.Fragment&&e.passNode&&(t.node=i)}function o7(e,t){if(t.length>0){const n=t.length>1?t:t[0];n&&(e.children=n)}}function l7(e,t){const n=[];let i=-1;const r=e.passKeys?new Map:J9;for(;++i<t.children.length;){const s=t.children[i];let a;if(e.passKeys){const e="element"===s.type?s.tagName:"mdxJsxFlowElement"===s.type||"mdxJsxTextElement"===s.type?s.name:void 0;if(e){const t=r.get(e)||0;a=e+"-"+t,r.set(e,t+1)}}const o=s7(e,s,a);void 0!==o&&n.push(o)}return n}function u7(e,t,n){const i=function(e,t){const n=u9(t);let i=t,r=c9;if(n in e.normal)return e.property[e.normal[n]];if(n.length>4&&"data"===n.slice(0,4)&&B9.test(t)){if("-"===t.charAt(4)){const e=t.slice(5).replace(R9,N9);i="data"+e.charAt(0).toUpperCase()+e.slice(1)}else{const e=t.slice(4);if(!R9.test(e)){let n=e.replace(L9,z9);"-"!==n.charAt(0)&&(n="-"+n),t="data"+n}}r=w9}return new r(i,t)}(e.schema,t);if(!(null===n||void 0===n||"number"===typeof n&&Number.isNaN(n))){if(Array.isArray(n)&&(n=i.commaSeparated?function(e,t){const n=t||{};return(""===e[e.length-1]?[...e,""]:e).join((n.padRight?" ":"")+","+(!1===n.padLeft?"":" ")).trim()}(n):n.join(" ").trim()),"style"===i.property){let t="object"===typeof n?n:function(e,t){const n={};try{V9(t,i)}catch(r){if(!e.ignoreInvalidStyle){const t=r,n=new K9("Cannot parse `style` attribute",{ancestors:e.ancestors,cause:t,ruleId:"style",source:"hast-util-to-jsx-runtime"});throw n.file=e.filePath||void 0,n.url=i7+"#cannot-parse-style-attribute",n}}return n;function i(e,t){let i=e;"--"!==i.slice(0,2)&&("-ms-"===i.slice(0,4)&&(i="ms-"+i.slice(4)),i=i.replace(e7,p7)),n[i]=t}}(e,String(n));return"css"===e.stylePropertyNameCase&&(t=function(e){const t={};let n;for(n in e)Z9.call(e,n)&&(t[d7(n)]=e[n]);return t}(t)),["style",t]}return["react"===e.elementAttributeNameCase&&i.space?j9[i.property]||i.property:i.attribute,n]}}function c7(e,t,n){let i;if(n)if(t.includes(".")){const e=t.split(".");let n,r=-1;for(;++r<e.length;){const t=r9(e[r])?{type:"Identifier",name:e[r]}:{type:"Literal",value:e[r]};n=n?{type:"MemberExpression",object:n,property:t,computed:Boolean(r&&"Literal"===t.type),optional:!1}:t}i=n}else i=r9(t)&&!/^[a-z]/.test(t)?{type:"Identifier",name:t}:{type:"Literal",value:t};else i={type:"Literal",value:t};if("Literal"===i.type){const t=i.value;return Z9.call(e.components,t)?e.components[t]:t}if(e.evaluater)return e.evaluater.evaluateExpression(i);h7(e)}function h7(e,t){const n=new K9("Cannot handle MDX estrees without `createEvaluater`",{ancestors:e.ancestors,place:t,ruleId:"mdx-estree",source:"hast-util-to-jsx-runtime"});throw n.file=e.filePath||void 0,n.url=i7+"#cannot-handle-mdx-estrees-without-createevaluater",n}function d7(e){let t=e.replace($9,f7);return"ms-"===t.slice(0,3)&&(t="-"+t),t}function p7(e,t){return t.toUpperCase()}function f7(e){return"-"+e.toLowerCase()}const m7={action:["form"],cite:["blockquote","del","ins","q"],data:["object"],formAction:["button","input"],href:["a","area","base","link"],icon:["menuitem"],itemId:null,manifest:["html"],ping:["a","area"],poster:["video"],src:["audio","embed","iframe","img","input","script","source","track","video"]},g7={};function v7(e,t,n){if(function(e){return Boolean(e&&"object"===typeof e)}(e)){if("value"in e)return"html"!==e.type||n?e.value:"";if(t&&"alt"in e&&e.alt)return e.alt;if("children"in e)return y7(e.children,t,n)}return Array.isArray(e)?y7(e,t,n):""}function y7(e,t,n){const i=[];let r=-1;for(;++r<e.length;)i[r]=v7(e[r],t,n);return i.join("")}function x7(e,t,n,i){const r=e.length;let s,a=0;if(t=t<0?-t>r?0:r+t:t>r?r:t,n=n>0?n:0,i.length<1e4)s=Array.from(i),s.unshift(t,n),e.splice(...s);else for(n&&e.splice(t,n);a<i.length;)s=i.slice(a,a+1e4),s.unshift(t,0),e.splice(...s),a+=1e4,t+=1e4}function b7(e,t){return e.length>0?(x7(e,e.length,0,t),e):t}class w7{constructor(e){this.left=e?[...e]:[],this.right=[]}get(e){if(e<0||e>=this.left.length+this.right.length)throw new RangeError("Cannot access index `"+e+"` in a splice buffer of size `"+(this.left.length+this.right.length)+"`");return e<this.left.length?this.left[e]:this.right[this.right.length-e+this.left.length-1]}get length(){return this.left.length+this.right.length}shift(){return this.setCursor(0),this.right.pop()}slice(e,t){const n=null===t||void 0===t?Number.POSITIVE_INFINITY:t;return n<this.left.length?this.left.slice(e,n):e>this.left.length?this.right.slice(this.right.length-n+this.left.length,this.right.length-e+this.left.length).reverse():this.left.slice(e).concat(this.right.slice(this.right.length-n+this.left.length).reverse())}splice(e,t,n){const i=t||0;this.setCursor(Math.trunc(e));const r=this.right.splice(this.right.length-i,Number.POSITIVE_INFINITY);return n&&D7(this.left,n),r.reverse()}pop(){return this.setCursor(Number.POSITIVE_INFINITY),this.left.pop()}push(e){this.setCursor(Number.POSITIVE_INFINITY),this.left.push(e)}pushMany(e){this.setCursor(Number.POSITIVE_INFINITY),D7(this.left,e)}unshift(e){this.setCursor(0),this.right.push(e)}unshiftMany(e){this.setCursor(0),D7(this.right,e.reverse())}setCursor(e){if(!(e===this.left.length||e>this.left.length&&0===this.right.length||e<0&&0===this.left.length))if(e<this.left.length){const t=this.left.splice(e,Number.POSITIVE_INFINITY);D7(this.right,t.reverse())}else{const t=this.right.splice(this.left.length+this.right.length-e,Number.POSITIVE_INFINITY);D7(this.left,t.reverse())}}}function D7(e,t){let n=0;if(t.length<1e4)e.push(...t);else for(;n<t.length;)e.push(...t.slice(n,n+1e4)),n+=1e4}function _7(e){const t={};let n,i,r,s,a,o,l,u=-1;const c=new w7(e);for(;++u<c.length;){for(;u in t;)u=t[u];if(n=c.get(u),u&&"chunkFlow"===n[1].type&&"listItemPrefix"===c.get(u-1)[1].type&&(o=n[1]._tokenizer.events,r=0,r<o.length&&"lineEndingBlank"===o[r][1].type&&(r+=2),r<o.length&&"content"===o[r][1].type))for(;++r<o.length&&"content"!==o[r][1].type;)"chunkText"===o[r][1].type&&(o[r][1]._isInFirstContentOfListItem=!0,r++);if("enter"===n[0])n[1].contentType&&(Object.assign(t,S7(c,u)),u=t[u],l=!0);else if(n[1]._container){for(r=u,i=void 0;r--;)if(s=c.get(r),"lineEnding"===s[1].type||"lineEndingBlank"===s[1].type)"enter"===s[0]&&(i&&(c.get(i)[1].type="lineEndingBlank"),s[1].type="lineEnding",i=r);else if("linePrefix"!==s[1].type)break;i&&(n[1].end=d({},c.get(i)[1].start),a=c.slice(i,u),a.unshift(n),c.splice(i,u-i+1,a))}}return x7(e,0,Number.POSITIVE_INFINITY,c.slice(0)),!l}function S7(e,t){const n=e.get(t)[1],i=e.get(t)[2];let r=t-1;const s=[],a=n._tokenizer||i.parser[n.contentType](n.start),o=a.events,l=[],u={};let c,h,d=-1,p=n,f=0,m=0;const g=[m];for(;p;){for(;e.get(++r)[1]!==p;);s.push(r),p._tokenizer||(c=i.sliceStream(p),p.next||c.push(null),h&&a.defineSkip(p.start),p._isInFirstContentOfListItem&&(a._gfmTasklistFirstContentOfListItem=!0),a.write(c),p._isInFirstContentOfListItem&&(a._gfmTasklistFirstContentOfListItem=void 0)),h=p,p=p.next}for(p=n;++d<o.length;)"exit"===o[d][0]&&"enter"===o[d-1][0]&&o[d][1].type===o[d-1][1].type&&o[d][1].start.line!==o[d][1].end.line&&(m=d+1,g.push(m),p._tokenizer=void 0,p.previous=void 0,p=p.next);for(a.events=[],p?(p._tokenizer=void 0,p.previous=void 0):g.pop(),d=g.length;d--;){const t=o.slice(g[d],g[d+1]),n=s.pop();l.push([n,n+t.length-1]),e.splice(n,2,t)}for(l.reverse(),d=-1;++d<l.length;)u[f+l[d][0]]=f+l[d][1],f+=l[d][1]-l[d][0]-1;return u}const E7={}.hasOwnProperty;function C7(e,t){let n;for(n in t){const i=(E7.call(e,n)?e[n]:void 0)||(e[n]={}),r=t[n];let s;if(r)for(s in r){E7.call(i,s)||(i[s]=[]);const e=r[s];A7(i[s],Array.isArray(e)?e:e?[e]:[])}}}function A7(e,t){let n=-1;const i=[];for(;++n<t.length;)("after"===t[n].add?e:i).push(t[n]);x7(e,0,0,i)}const M7=j7(/[A-Za-z]/),T7=j7(/[\dA-Za-z]/),P7=j7(/[#-'*+\--9=?A-Z^-~]/);function F7(e){return null!==e&&(e<32||127===e)}const O7=j7(/\d/),I7=j7(/[\dA-Fa-f]/),k7=j7(/[!-/:-@[-`{-~]/);function B7(e){return null!==e&&e<-2}function R7(e){return null!==e&&(e<0||32===e)}function L7(e){return-2===e||-1===e||32===e}const z7=j7(/(?:[!-#%-\*,-\/:;\?@\[-\]_\{\}\xA1\xA7\xAB\xB6\xB7\xBB\xBF\u037E\u0387\u055A-\u055F\u0589\u058A\u05BE\u05C0\u05C3\u05C6\u05F3\u05F4\u0609\u060A\u060C\u060D\u061B\u061D-\u061F\u066A-\u066D\u06D4\u0700-\u070D\u07F7-\u07F9\u0830-\u083E\u085E\u0964\u0965\u0970\u09FD\u0A76\u0AF0\u0C77\u0C84\u0DF4\u0E4F\u0E5A\u0E5B\u0F04-\u0F12\u0F14\u0F3A-\u0F3D\u0F85\u0FD0-\u0FD4\u0FD9\u0FDA\u104A-\u104F\u10FB\u1360-\u1368\u1400\u166E\u169B\u169C\u16EB-\u16ED\u1735\u1736\u17D4-\u17D6\u17D8-\u17DA\u1800-\u180A\u1944\u1945\u1A1E\u1A1F\u1AA0-\u1AA6\u1AA8-\u1AAD\u1B4E\u1B4F\u1B5A-\u1B60\u1B7D-\u1B7F\u1BFC-\u1BFF\u1C3B-\u1C3F\u1C7E\u1C7F\u1CC0-\u1CC7\u1CD3\u2010-\u2027\u2030-\u2043\u2045-\u2051\u2053-\u205E\u207D\u207E\u208D\u208E\u2308-\u230B\u2329\u232A\u2768-\u2775\u27C5\u27C6\u27E6-\u27EF\u2983-\u2998\u29D8-\u29DB\u29FC\u29FD\u2CF9-\u2CFC\u2CFE\u2CFF\u2D70\u2E00-\u2E2E\u2E30-\u2E4F\u2E52-\u2E5D\u3001-\u3003\u3008-\u3011\u3014-\u301F\u3030\u303D\u30A0\u30FB\uA4FE\uA4FF\uA60D-\uA60F\uA673\uA67E\uA6F2-\uA6F7\uA874-\uA877\uA8CE\uA8CF\uA8F8-\uA8FA\uA8FC\uA92E\uA92F\uA95F\uA9C1-\uA9CD\uA9DE\uA9DF\uAA5C-\uAA5F\uAADE\uAADF\uAAF0\uAAF1\uABEB\uFD3E\uFD3F\uFE10-\uFE19\uFE30-\uFE52\uFE54-\uFE61\uFE63\uFE68\uFE6A\uFE6B\uFF01-\uFF03\uFF05-\uFF0A\uFF0C-\uFF0F\uFF1A\uFF1B\uFF1F\uFF20\uFF3B-\uFF3D\uFF3F\uFF5B\uFF5D\uFF5F-\uFF65]|\uD800[\uDD00-\uDD02\uDF9F\uDFD0]|\uD801\uDD6F|\uD802[\uDC57\uDD1F\uDD3F\uDE50-\uDE58\uDE7F\uDEF0-\uDEF6\uDF39-\uDF3F\uDF99-\uDF9C]|\uD803[\uDD6E\uDEAD\uDF55-\uDF59\uDF86-\uDF89]|\uD804[\uDC47-\uDC4D\uDCBB\uDCBC\uDCBE-\uDCC1\uDD40-\uDD43\uDD74\uDD75\uDDC5-\uDDC8\uDDCD\uDDDB\uDDDD-\uDDDF\uDE38-\uDE3D\uDEA9\uDFD4\uDFD5\uDFD7\uDFD8]|\uD805[\uDC4B-\uDC4F\uDC5A\uDC5B\uDC5D\uDCC6\uDDC1-\uDDD7\uDE41-\uDE43\uDE60-\uDE6C\uDEB9\uDF3C-\uDF3E]|\uD806[\uDC3B\uDD44-\uDD46\uDDE2\uDE3F-\uDE46\uDE9A-\uDE9C\uDE9E-\uDEA2\uDF00-\uDF09\uDFE1]|\uD807[\uDC41-\uDC45\uDC70\uDC71\uDEF7\uDEF8\uDF43-\uDF4F\uDFFF]|\uD809[\uDC70-\uDC74]|\uD80B[\uDFF1\uDFF2]|\uD81A[\uDE6E\uDE6F\uDEF5\uDF37-\uDF3B\uDF44]|\uD81B[\uDD6D-\uDD6F\uDE97-\uDE9A\uDFE2]|\uD82F\uDC9F|\uD836[\uDE87-\uDE8B]|\uD839\uDDFF|\uD83A[\uDD5E\uDD5F])|(?:[\$\+<->\^`\|~\xA2-\xA6\xA8\xA9\xAC\xAE-\xB1\xB4\xB8\xD7\xF7\u02C2-\u02C5\u02D2-\u02DF\u02E5-\u02EB\u02ED\u02EF-\u02FF\u0375\u0384\u0385\u03F6\u0482\u058D-\u058F\u0606-\u0608\u060B\u060E\u060F\u06DE\u06E9\u06FD\u06FE\u07F6\u07FE\u07FF\u0888\u09F2\u09F3\u09FA\u09FB\u0AF1\u0B70\u0BF3-\u0BFA\u0C7F\u0D4F\u0D79\u0E3F\u0F01-\u0F03\u0F13\u0F15-\u0F17\u0F1A-\u0F1F\u0F34\u0F36\u0F38\u0FBE-\u0FC5\u0FC7-\u0FCC\u0FCE\u0FCF\u0FD5-\u0FD8\u109E\u109F\u1390-\u1399\u166D\u17DB\u1940\u19DE-\u19FF\u1B61-\u1B6A\u1B74-\u1B7C\u1FBD\u1FBF-\u1FC1\u1FCD-\u1FCF\u1FDD-\u1FDF\u1FED-\u1FEF\u1FFD\u1FFE\u2044\u2052\u207A-\u207C\u208A-\u208C\u20A0-\u20C0\u2100\u2101\u2103-\u2106\u2108\u2109\u2114\u2116-\u2118\u211E-\u2123\u2125\u2127\u2129\u212E\u213A\u213B\u2140-\u2144\u214A-\u214D\u214F\u218A\u218B\u2190-\u2307\u230C-\u2328\u232B-\u2429\u2440-\u244A\u249C-\u24E9\u2500-\u2767\u2794-\u27C4\u27C7-\u27E5\u27F0-\u2982\u2999-\u29D7\u29DC-\u29FB\u29FE-\u2B73\u2B76-\u2B95\u2B97-\u2BFF\u2CE5-\u2CEA\u2E50\u2E51\u2E80-\u2E99\u2E9B-\u2EF3\u2F00-\u2FD5\u2FF0-\u2FFF\u3004\u3012\u3013\u3020\u3036\u3037\u303E\u303F\u309B\u309C\u3190\u3191\u3196-\u319F\u31C0-\u31E5\u31EF\u3200-\u321E\u322A-\u3247\u3250\u3260-\u327F\u328A-\u32B0\u32C0-\u33FF\u4DC0-\u4DFF\uA490-\uA4C6\uA700-\uA716\uA720\uA721\uA789\uA78A\uA828-\uA82B\uA836-\uA839\uAA77-\uAA79\uAB5B\uAB6A\uAB6B\uFB29\uFBB2-\uFBC2\uFD40-\uFD4F\uFDCF\uFDFC-\uFDFF\uFE62\uFE64-\uFE66\uFE69\uFF04\uFF0B\uFF1C-\uFF1E\uFF3E\uFF40\uFF5C\uFF5E\uFFE0-\uFFE6\uFFE8-\uFFEE\uFFFC\uFFFD]|\uD800[\uDD37-\uDD3F\uDD79-\uDD89\uDD8C-\uDD8E\uDD90-\uDD9C\uDDA0\uDDD0-\uDDFC]|\uD802[\uDC77\uDC78\uDEC8]|\uD803[\uDD8E\uDD8F]|\uD805\uDF3F|\uD807[\uDFD5-\uDFF1]|\uD81A[\uDF3C-\uDF3F\uDF45]|\uD82F\uDC9C|\uD833[\uDC00-\uDCEF\uDD00-\uDEB3\uDF50-\uDFC3]|\uD834[\uDC00-\uDCF5\uDD00-\uDD26\uDD29-\uDD64\uDD6A-\uDD6C\uDD83\uDD84\uDD8C-\uDDA9\uDDAE-\uDDEA\uDE00-\uDE41\uDE45\uDF00-\uDF56]|\uD835[\uDEC1\uDEDB\uDEFB\uDF15\uDF35\uDF4F\uDF6F\uDF89\uDFA9\uDFC3]|\uD836[\uDC00-\uDDFF\uDE37-\uDE3A\uDE6D-\uDE74\uDE76-\uDE83\uDE85\uDE86]|\uD838[\uDD4F\uDEFF]|\uD83B[\uDCAC\uDCB0\uDD2E\uDEF0\uDEF1]|\uD83C[\uDC00-\uDC2B\uDC30-\uDC93\uDCA0-\uDCAE\uDCB1-\uDCBF\uDCC1-\uDCCF\uDCD1-\uDCF5\uDD0D-\uDDAD\uDDE6-\uDE02\uDE10-\uDE3B\uDE40-\uDE48\uDE50\uDE51\uDE60-\uDE65\uDF00-\uDFFF]|\uD83D[\uDC00-\uDED7\uDEDC-\uDEEC\uDEF0-\uDEFC\uDF00-\uDF76\uDF7B-\uDFD9\uDFE0-\uDFEB\uDFF0]|\uD83E[\uDC00-\uDC0B\uDC10-\uDC47\uDC50-\uDC59\uDC60-\uDC87\uDC90-\uDCAD\uDCB0-\uDCBB\uDCC0\uDCC1\uDD00-\uDE53\uDE60-\uDE6D\uDE70-\uDE7C\uDE80-\uDE89\uDE8F-\uDEC6\uDECE-\uDEDC\uDEDF-\uDEE9\uDEF0-\uDEF8\uDF00-\uDF92\uDF94-\uDFEF])/),N7=j7(/\s/);function j7(e){return function(t){return null!==t&&t>-1&&e.test(String.fromCharCode(t))}}function U7(e,t,n,i){const r=i?i-1:Number.POSITIVE_INFINITY;let s=0;return function(i){if(L7(i))return e.enter(n),a(i);return t(i)};function a(i){return L7(i)&&s++<r?(e.consume(i),a):(e.exit(n),t(i))}}const V7={tokenize:function(e){const t=e.attempt(this.parser.constructs.contentInitial,(function(n){if(null===n)return void e.consume(n);return e.enter("lineEnding"),e.consume(n),e.exit("lineEnding"),U7(e,t,"linePrefix")}),(function(t){return e.enter("paragraph"),i(t)}));let n;return t;function i(t){const i=e.enter("chunkText",{contentType:"text",previous:n});return n&&(n.next=i),n=i,r(t)}function r(t){return null===t?(e.exit("chunkText"),e.exit("paragraph"),void e.consume(t)):B7(t)?(e.consume(t),e.exit("chunkText"),i):(e.consume(t),r)}}};const H7={tokenize:function(e){const t=this,n=[];let i,r,s,a=0;return o;function o(i){if(a<n.length){const r=n[a];return t.containerState=r[1],e.attempt(r[0].continuation,l,u)(i)}return u(i)}function l(e){if(a++,t.containerState._closeFlow){t.containerState._closeFlow=void 0,i&&x();const n=t.events.length;let r,s=n;for(;s--;)if("exit"===t.events[s][0]&&"chunkFlow"===t.events[s][1].type){r=t.events[s][1].end;break}y(a);let o=n;for(;o<t.events.length;)t.events[o][1].end=d({},r),o++;return x7(t.events,s+1,0,t.events.slice(n)),t.events.length=o,u(e)}return o(e)}function u(r){if(a===n.length){if(!i)return p(r);if(i.currentConstruct&&i.currentConstruct.concrete)return m(r);t.interrupt=Boolean(i.currentConstruct&&!i._gfmTableDynamicInterruptHack)}return t.containerState={},e.check(W7,c,h)(r)}function c(e){return i&&x(),y(a),p(e)}function h(e){return t.parser.lazy[t.now().line]=a!==n.length,s=t.now().offset,m(e)}function p(n){return t.containerState={},e.attempt(W7,f,m)(n)}function f(e){return a++,n.push([t.currentConstruct,t.containerState]),p(e)}function m(n){return null===n?(i&&x(),y(0),void e.consume(n)):(i=i||t.parser.flow(t.now()),e.enter("chunkFlow",{_tokenizer:i,contentType:"flow",previous:r}),g(n))}function g(n){return null===n?(v(e.exit("chunkFlow"),!0),y(0),void e.consume(n)):B7(n)?(e.consume(n),v(e.exit("chunkFlow")),a=0,t.interrupt=void 0,o):(e.consume(n),g)}function v(e,n){const o=t.sliceStream(e);if(n&&o.push(null),e.previous=r,r&&(r.next=e),r=e,i.defineSkip(e.start),i.write(o),t.parser.lazy[e.start.line]){let e=i.events.length;for(;e--;)if(i.events[e][1].start.offset<s&&(!i.events[e][1].end||i.events[e][1].end.offset>s))return;const n=t.events.length;let r,o,l=n;for(;l--;)if("exit"===t.events[l][0]&&"chunkFlow"===t.events[l][1].type){if(r){o=t.events[l][1].end;break}r=!0}for(y(a),e=n;e<t.events.length;)t.events[e][1].end=d({},o),e++;x7(t.events,l+1,0,t.events.slice(n)),t.events.length=e}}function y(i){let r=n.length;for(;r-- >i;){const i=n[r];t.containerState=i[1],i[0].exit.call(t,e)}n.length=i}function x(){i.write([null]),r=void 0,i=void 0,t.containerState._closeFlow=void 0}}},W7={tokenize:function(e,t,n){return U7(e,e.attempt(this.parser.constructs.document,t,n),"linePrefix",this.parser.constructs.disable.null.includes("codeIndented")?void 0:4)}};const G7={partial:!0,tokenize:function(e,t,n){return function(t){return L7(t)?U7(e,i,"linePrefix")(t):i(t)};function i(e){return null===e||B7(e)?t(e):n(e)}}};const q7={resolve:function(e){return _7(e),e},tokenize:function(e,t){let n;return function(t){return e.enter("content"),n=e.enter("chunkContent",{contentType:"content"}),i(t)};function i(t){return null===t?r(t):B7(t)?e.check(Y7,s,r)(t):(e.consume(t),i)}function r(n){return e.exit("chunkContent"),e.exit("content"),t(n)}function s(t){return e.consume(t),e.exit("chunkContent"),n.next=e.enter("chunkContent",{contentType:"content",previous:n}),n=n.next,i}}},Y7={partial:!0,tokenize:function(e,t,n){const i=this;return function(t){return e.exit("chunkContent"),e.enter("lineEnding"),e.consume(t),e.exit("lineEnding"),U7(e,r,"linePrefix")};function r(r){if(null===r||B7(r))return n(r);const s=i.events[i.events.length-1];return!i.parser.constructs.disable.null.includes("codeIndented")&&s&&"linePrefix"===s[1].type&&s[2].sliceSerialize(s[1],!0).length>=4?t(r):e.interrupt(i.parser.constructs.flow,n,t)(r)}}};const X7={tokenize:function(e){const t=this,n=e.attempt(G7,(function(i){if(null===i)return void e.consume(i);return e.enter("lineEndingBlank"),e.consume(i),e.exit("lineEndingBlank"),t.currentConstruct=void 0,n}),e.attempt(this.parser.constructs.flowInitial,i,U7(e,e.attempt(this.parser.constructs.flow,i,e.attempt(q7,i)),"linePrefix")));return n;function i(i){if(null!==i)return e.enter("lineEnding"),e.consume(i),e.exit("lineEnding"),t.currentConstruct=void 0,n;e.consume(i)}}};const Q7={resolveAll:$7()},K7=J7("string"),Z7=J7("text");function J7(e){return{resolveAll:$7("text"===e?eee:void 0),tokenize:function(t){const n=this,i=this.parser.constructs[e],r=t.attempt(i,s,a);return s;function s(e){return l(e)?r(e):a(e)}function a(e){if(null!==e)return t.enter("data"),t.consume(e),o;t.consume(e)}function o(e){return l(e)?(t.exit("data"),r(e)):(t.consume(e),o)}function l(e){if(null===e)return!0;const t=i[e];let r=-1;if(t)for(;++r<t.length;){const e=t[r];if(!e.previous||e.previous.call(n,n.previous))return!0}return!1}}}}function $7(e){return function(t,n){let i,r=-1;for(;++r<=t.length;)void 0===i?t[r]&&"data"===t[r][1].type&&(i=r,r++):t[r]&&"data"===t[r][1].type||(r!==i+2&&(t[i][1].end=t[r-1][1].end,t.splice(i+2,r-i-2),r=i+2),i=void 0);return e?e(t,n):t}}function eee(e,t){let n=0;for(;++n<=e.length;)if((n===e.length||"lineEnding"===e[n][1].type)&&"data"===e[n-1][1].type){const i=e[n-1][1],r=t.sliceStream(i);let s,a=r.length,o=-1,l=0;for(;a--;){const e=r[a];if("string"===typeof e){for(o=e.length;32===e.charCodeAt(o-1);)l++,o--;if(o)break;o=-1}else if(-2===e)s=!0,l++;else if(-1!==e){a++;break}}if(l){const r={type:n===e.length||s||l<2?"lineSuffix":"hardBreakTrailing",start:{_bufferIndex:a?o:i.start._bufferIndex+o,_index:i.start._index+a,line:i.end.line,column:i.end.column-l,offset:i.end.offset-l},end:d({},i.end)};i.end=d({},r.start),i.start.offset===i.end.offset?Object.assign(i,r):(e.splice(n,0,["enter",r,t],["exit",r,t]),n+=2)}n++}return e}const tee={name:"thematicBreak",tokenize:function(e,t,n){let i,r=0;return function(t){return e.enter("thematicBreak"),function(e){return i=e,s(e)}(t)};function s(s){return s===i?(e.enter("thematicBreakSequence"),a(s)):r>=3&&(null===s||B7(s))?(e.exit("thematicBreak"),t(s)):n(s)}function a(t){return t===i?(e.consume(t),r++,a):(e.exit("thematicBreakSequence"),L7(t)?U7(e,s,"whitespace")(t):s(t))}}};const nee={continuation:{tokenize:function(e,t,n){const i=this;return i.containerState._closeFlow=void 0,e.check(G7,r,s);function r(n){return i.containerState.furtherBlankLines=i.containerState.furtherBlankLines||i.containerState.initialBlankLine,U7(e,t,"listItemIndent",i.containerState.size+1)(n)}function s(n){return i.containerState.furtherBlankLines||!L7(n)?(i.containerState.furtherBlankLines=void 0,i.containerState.initialBlankLine=void 0,a(n)):(i.containerState.furtherBlankLines=void 0,i.containerState.initialBlankLine=void 0,e.attempt(ree,t,a)(n))}function a(r){return i.containerState._closeFlow=!0,i.interrupt=void 0,U7(e,e.attempt(nee,t,n),"linePrefix",i.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(r)}}},exit:function(e){e.exit(this.containerState.type)},name:"list",tokenize:function(e,t,n){const i=this,r=i.events[i.events.length-1];let s=r&&"linePrefix"===r[1].type?r[2].sliceSerialize(r[1],!0).length:0,a=0;return function(t){const r=i.containerState.type||(42===t||43===t||45===t?"listUnordered":"listOrdered");if("listUnordered"===r?!i.containerState.marker||t===i.containerState.marker:O7(t)){if(i.containerState.type||(i.containerState.type=r,e.enter(r,{_container:!0})),"listUnordered"===r)return e.enter("listItemPrefix"),42===t||45===t?e.check(tee,n,l)(t):l(t);if(!i.interrupt||49===t)return e.enter("listItemPrefix"),e.enter("listItemValue"),o(t)}return n(t)};function o(t){return O7(t)&&++a<10?(e.consume(t),o):(!i.interrupt||a<2)&&(i.containerState.marker?t===i.containerState.marker:41===t||46===t)?(e.exit("listItemValue"),l(t)):n(t)}function l(t){return e.enter("listItemMarker"),e.consume(t),e.exit("listItemMarker"),i.containerState.marker=i.containerState.marker||t,e.check(G7,i.interrupt?n:u,e.attempt(iee,h,c))}function u(e){return i.containerState.initialBlankLine=!0,s++,h(e)}function c(t){return L7(t)?(e.enter("listItemPrefixWhitespace"),e.consume(t),e.exit("listItemPrefixWhitespace"),h):n(t)}function h(n){return i.containerState.size=s+i.sliceSerialize(e.exit("listItemPrefix"),!0).length,t(n)}}},iee={partial:!0,tokenize:function(e,t,n){const i=this;return U7(e,(function(e){const r=i.events[i.events.length-1];return!L7(e)&&r&&"listItemPrefixWhitespace"===r[1].type?t(e):n(e)}),"listItemPrefixWhitespace",i.parser.constructs.disable.null.includes("codeIndented")?void 0:5)}},ree={partial:!0,tokenize:function(e,t,n){const i=this;return U7(e,(function(e){const r=i.events[i.events.length-1];return r&&"listItemIndent"===r[1].type&&r[2].sliceSerialize(r[1],!0).length===i.containerState.size?t(e):n(e)}),"listItemIndent",i.containerState.size+1)}};const see={continuation:{tokenize:function(e,t,n){const i=this;return function(t){if(L7(t))return U7(e,r,"linePrefix",i.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(t);return r(t)};function r(i){return e.attempt(see,t,n)(i)}}},exit:function(e){e.exit("blockQuote")},name:"blockQuote",tokenize:function(e,t,n){const i=this;return function(t){if(62===t){const n=i.containerState;return n.open||(e.enter("blockQuote",{_container:!0}),n.open=!0),e.enter("blockQuotePrefix"),e.enter("blockQuoteMarker"),e.consume(t),e.exit("blockQuoteMarker"),r}return n(t)};function r(n){return L7(n)?(e.enter("blockQuotePrefixWhitespace"),e.consume(n),e.exit("blockQuotePrefixWhitespace"),e.exit("blockQuotePrefix"),t):(e.exit("blockQuotePrefix"),t(n))}}};function aee(e,t,n,i,r,s,a,o,l){const u=l||Number.POSITIVE_INFINITY;let c=0;return function(t){if(60===t)return e.enter(i),e.enter(r),e.enter(s),e.consume(t),e.exit(s),h;if(null===t||32===t||41===t||F7(t))return n(t);return e.enter(i),e.enter(a),e.enter(o),e.enter("chunkString",{contentType:"string"}),f(t)};function h(n){return 62===n?(e.enter(s),e.consume(n),e.exit(s),e.exit(r),e.exit(i),t):(e.enter(o),e.enter("chunkString",{contentType:"string"}),d(n))}function d(t){return 62===t?(e.exit("chunkString"),e.exit(o),h(t)):null===t||60===t||B7(t)?n(t):(e.consume(t),92===t?p:d)}function p(t){return 60===t||62===t||92===t?(e.consume(t),d):d(t)}function f(r){return c||null!==r&&41!==r&&!R7(r)?c<u&&40===r?(e.consume(r),c++,f):41===r?(e.consume(r),c--,f):null===r||32===r||40===r||F7(r)?n(r):(e.consume(r),92===r?m:f):(e.exit("chunkString"),e.exit(o),e.exit(a),e.exit(i),t(r))}function m(t){return 40===t||41===t||92===t?(e.consume(t),f):f(t)}}function oee(e,t,n,i,r,s){const a=this;let o,l=0;return function(t){return e.enter(i),e.enter(r),e.consume(t),e.exit(r),e.enter(s),u};function u(h){return l>999||null===h||91===h||93===h&&!o||94===h&&!l&&"_hiddenFootnoteSupport"in a.parser.constructs?n(h):93===h?(e.exit(s),e.enter(r),e.consume(h),e.exit(r),e.exit(i),t):B7(h)?(e.enter("lineEnding"),e.consume(h),e.exit("lineEnding"),u):(e.enter("chunkString",{contentType:"string"}),c(h))}function c(t){return null===t||91===t||93===t||B7(t)||l++>999?(e.exit("chunkString"),u(t)):(e.consume(t),o||(o=!L7(t)),92===t?h:c)}function h(t){return 91===t||92===t||93===t?(e.consume(t),l++,c):c(t)}}function lee(e,t,n,i,r,s){let a;return function(t){if(34===t||39===t||40===t)return e.enter(i),e.enter(r),e.consume(t),e.exit(r),a=40===t?41:t,o;return n(t)};function o(n){return n===a?(e.enter(r),e.consume(n),e.exit(r),e.exit(i),t):(e.enter(s),l(n))}function l(t){return t===a?(e.exit(s),o(a)):null===t?n(t):B7(t)?(e.enter("lineEnding"),e.consume(t),e.exit("lineEnding"),U7(e,l,"linePrefix")):(e.enter("chunkString",{contentType:"string"}),u(t))}function u(t){return t===a||null===t||B7(t)?(e.exit("chunkString"),l(t)):(e.consume(t),92===t?c:u)}function c(t){return t===a||92===t?(e.consume(t),u):u(t)}}function uee(e,t){let n;return function i(r){if(B7(r))return e.enter("lineEnding"),e.consume(r),e.exit("lineEnding"),n=!0,i;if(L7(r))return U7(e,i,n?"linePrefix":"lineSuffix")(r);return t(r)}}function cee(e){return e.replace(/[\t\n\r ]+/g," ").replace(/^ | $/g,"").toLowerCase().toUpperCase()}const hee={name:"definition",tokenize:function(e,t,n){const i=this;let r;return function(t){return e.enter("definition"),function(t){return oee.call(i,e,s,n,"definitionLabel","definitionLabelMarker","definitionLabelString")(t)}(t)};function s(t){return r=cee(i.sliceSerialize(i.events[i.events.length-1][1]).slice(1,-1)),58===t?(e.enter("definitionMarker"),e.consume(t),e.exit("definitionMarker"),a):n(t)}function a(t){return R7(t)?uee(e,o)(t):o(t)}function o(t){return aee(e,l,n,"definitionDestination","definitionDestinationLiteral","definitionDestinationLiteralMarker","definitionDestinationRaw","definitionDestinationString")(t)}function l(t){return e.attempt(dee,u,u)(t)}function u(t){return L7(t)?U7(e,c,"whitespace")(t):c(t)}function c(s){return null===s||B7(s)?(e.exit("definition"),i.parser.defined.push(r),t(s)):n(s)}}},dee={partial:!0,tokenize:function(e,t,n){return function(t){return R7(t)?uee(e,i)(t):n(t)};function i(t){return lee(e,r,n,"definitionTitle","definitionTitleMarker","definitionTitleString")(t)}function r(t){return L7(t)?U7(e,s,"whitespace")(t):s(t)}function s(e){return null===e||B7(e)?t(e):n(e)}}};const pee={name:"codeIndented",tokenize:function(e,t,n){const i=this;return function(t){return e.enter("codeIndented"),U7(e,r,"linePrefix",5)(t)};function r(e){const t=i.events[i.events.length-1];return t&&"linePrefix"===t[1].type&&t[2].sliceSerialize(t[1],!0).length>=4?s(e):n(e)}function s(t){return null===t?o(t):B7(t)?e.attempt(fee,s,o)(t):(e.enter("codeFlowValue"),a(t))}function a(t){return null===t||B7(t)?(e.exit("codeFlowValue"),s(t)):(e.consume(t),a)}function o(n){return e.exit("codeIndented"),t(n)}}},fee={partial:!0,tokenize:function(e,t,n){const i=this;return r;function r(t){return i.parser.lazy[i.now().line]?n(t):B7(t)?(e.enter("lineEnding"),e.consume(t),e.exit("lineEnding"),r):U7(e,s,"linePrefix",5)(t)}function s(e){const s=i.events[i.events.length-1];return s&&"linePrefix"===s[1].type&&s[2].sliceSerialize(s[1],!0).length>=4?t(e):B7(e)?r(e):n(e)}}};const mee={name:"headingAtx",resolve:function(e,t){let n,i,r=e.length-2,s=3;"whitespace"===e[s][1].type&&(s+=2);r-2>s&&"whitespace"===e[r][1].type&&(r-=2);"atxHeadingSequence"===e[r][1].type&&(s===r-1||r-4>s&&"whitespace"===e[r-2][1].type)&&(r-=s+1===r?2:4);r>s&&(n={type:"atxHeadingText",start:e[s][1].start,end:e[r][1].end},i={type:"chunkText",start:e[s][1].start,end:e[r][1].end,contentType:"text"},x7(e,s,r-s+1,[["enter",n,t],["enter",i,t],["exit",i,t],["exit",n,t]]));return e},tokenize:function(e,t,n){let i=0;return function(t){return e.enter("atxHeading"),function(t){return e.enter("atxHeadingSequence"),r(t)}(t)};function r(t){return 35===t&&i++<6?(e.consume(t),r):null===t||R7(t)?(e.exit("atxHeadingSequence"),s(t)):n(t)}function s(n){return 35===n?(e.enter("atxHeadingSequence"),a(n)):null===n||B7(n)?(e.exit("atxHeading"),t(n)):L7(n)?U7(e,s,"whitespace")(n):(e.enter("atxHeadingText"),o(n))}function a(t){return 35===t?(e.consume(t),a):(e.exit("atxHeadingSequence"),s(t))}function o(t){return null===t||35===t||R7(t)?(e.exit("atxHeadingText"),s(t)):(e.consume(t),o)}}};const gee={name:"setextUnderline",resolveTo:function(e,t){let n,i,r,s=e.length;for(;s--;)if("enter"===e[s][0]){if("content"===e[s][1].type){n=s;break}"paragraph"===e[s][1].type&&(i=s)}else"content"===e[s][1].type&&e.splice(s,1),r||"definition"!==e[s][1].type||(r=s);const a={type:"setextHeading",start:d({},e[i][1].start),end:d({},e[e.length-1][1].end)};e[i][1].type="setextHeadingText",r?(e.splice(i,0,["enter",a,t]),e.splice(r+1,0,["exit",e[n][1],t]),e[n][1].end=d({},e[r][1].end)):e[n][1]=a;return e.push(["exit",a,t]),e},tokenize:function(e,t,n){const i=this;let r;return function(t){let a,o=i.events.length;for(;o--;)if("lineEnding"!==i.events[o][1].type&&"linePrefix"!==i.events[o][1].type&&"content"!==i.events[o][1].type){a="paragraph"===i.events[o][1].type;break}if(!i.parser.lazy[i.now().line]&&(i.interrupt||a))return e.enter("setextHeadingLine"),r=t,function(t){return e.enter("setextHeadingLineSequence"),s(t)}(t);return n(t)};function s(t){return t===r?(e.consume(t),s):(e.exit("setextHeadingLineSequence"),L7(t)?U7(e,a,"lineSuffix")(t):a(t))}function a(i){return null===i||B7(i)?(e.exit("setextHeadingLine"),t(i)):n(i)}}};const vee=["address","article","aside","base","basefont","blockquote","body","caption","center","col","colgroup","dd","details","dialog","dir","div","dl","dt","fieldset","figcaption","figure","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hr","html","iframe","legend","li","link","main","menu","menuitem","nav","noframes","ol","optgroup","option","p","param","search","section","summary","table","tbody","td","tfoot","th","thead","title","tr","track","ul"],yee=["pre","script","style","textarea"],xee={concrete:!0,name:"htmlFlow",resolveTo:function(e){let t=e.length;for(;t--&&("enter"!==e[t][0]||"htmlFlow"!==e[t][1].type););t>1&&"linePrefix"===e[t-2][1].type&&(e[t][1].start=e[t-2][1].start,e[t+1][1].start=e[t-2][1].start,e.splice(t-2,2));return e},tokenize:function(e,t,n){const i=this;let r,s,a,o,l;return function(t){return function(t){return e.enter("htmlFlow"),e.enter("htmlFlowData"),e.consume(t),u}(t)};function u(o){return 33===o?(e.consume(o),c):47===o?(e.consume(o),s=!0,p):63===o?(e.consume(o),r=3,i.interrupt?t:k):M7(o)?(e.consume(o),a=String.fromCharCode(o),f):n(o)}function c(s){return 45===s?(e.consume(s),r=2,h):91===s?(e.consume(s),r=5,o=0,d):M7(s)?(e.consume(s),r=4,i.interrupt?t:k):n(s)}function h(r){return 45===r?(e.consume(r),i.interrupt?t:k):n(r)}function d(r){const s="CDATA[";return r===s.charCodeAt(o++)?(e.consume(r),6===o?i.interrupt?t:C:d):n(r)}function p(t){return M7(t)?(e.consume(t),a=String.fromCharCode(t),f):n(t)}function f(o){if(null===o||47===o||62===o||R7(o)){const l=47===o,u=a.toLowerCase();return l||s||!yee.includes(u)?vee.includes(a.toLowerCase())?(r=6,l?(e.consume(o),m):i.interrupt?t(o):C(o)):(r=7,i.interrupt&&!i.parser.lazy[i.now().line]?n(o):s?g(o):v(o)):(r=1,i.interrupt?t(o):C(o))}return 45===o||T7(o)?(e.consume(o),a+=String.fromCharCode(o),f):n(o)}function m(r){return 62===r?(e.consume(r),i.interrupt?t:C):n(r)}function g(t){return L7(t)?(e.consume(t),g):S(t)}function v(t){return 47===t?(e.consume(t),S):58===t||95===t||M7(t)?(e.consume(t),y):L7(t)?(e.consume(t),v):S(t)}function y(t){return 45===t||46===t||58===t||95===t||T7(t)?(e.consume(t),y):x(t)}function x(t){return 61===t?(e.consume(t),b):L7(t)?(e.consume(t),x):v(t)}function b(t){return null===t||60===t||61===t||62===t||96===t?n(t):34===t||39===t?(e.consume(t),l=t,w):L7(t)?(e.consume(t),b):D(t)}function w(t){return t===l?(e.consume(t),l=null,_):null===t||B7(t)?n(t):(e.consume(t),w)}function D(t){return null===t||34===t||39===t||47===t||60===t||61===t||62===t||96===t||R7(t)?x(t):(e.consume(t),D)}function _(e){return 47===e||62===e||L7(e)?v(e):n(e)}function S(t){return 62===t?(e.consume(t),E):n(t)}function E(t){return null===t||B7(t)?C(t):L7(t)?(e.consume(t),E):n(t)}function C(t){return 45===t&&2===r?(e.consume(t),P):60===t&&1===r?(e.consume(t),F):62===t&&4===r?(e.consume(t),B):63===t&&3===r?(e.consume(t),k):93===t&&5===r?(e.consume(t),I):!B7(t)||6!==r&&7!==r?null===t||B7(t)?(e.exit("htmlFlowData"),A(t)):(e.consume(t),C):(e.exit("htmlFlowData"),e.check(bee,R,A)(t))}function A(t){return e.check(wee,M,R)(t)}function M(t){return e.enter("lineEnding"),e.consume(t),e.exit("lineEnding"),T}function T(t){return null===t||B7(t)?A(t):(e.enter("htmlFlowData"),C(t))}function P(t){return 45===t?(e.consume(t),k):C(t)}function F(t){return 47===t?(e.consume(t),a="",O):C(t)}function O(t){if(62===t){const n=a.toLowerCase();return yee.includes(n)?(e.consume(t),B):C(t)}return M7(t)&&a.length<8?(e.consume(t),a+=String.fromCharCode(t),O):C(t)}function I(t){return 93===t?(e.consume(t),k):C(t)}function k(t){return 62===t?(e.consume(t),B):45===t&&2===r?(e.consume(t),k):C(t)}function B(t){return null===t||B7(t)?(e.exit("htmlFlowData"),R(t)):(e.consume(t),B)}function R(n){return e.exit("htmlFlow"),t(n)}}},bee={partial:!0,tokenize:function(e,t,n){return function(i){return e.enter("lineEnding"),e.consume(i),e.exit("lineEnding"),e.attempt(G7,t,n)}}},wee={partial:!0,tokenize:function(e,t,n){const i=this;return function(t){if(B7(t))return e.enter("lineEnding"),e.consume(t),e.exit("lineEnding"),r;return n(t)};function r(e){return i.parser.lazy[i.now().line]?n(e):t(e)}}};const Dee={partial:!0,tokenize:function(e,t,n){const i=this;return function(t){if(null===t)return n(t);return e.enter("lineEnding"),e.consume(t),e.exit("lineEnding"),r};function r(e){return i.parser.lazy[i.now().line]?n(e):t(e)}}},_ee={concrete:!0,name:"codeFenced",tokenize:function(e,t,n){const i=this,r={partial:!0,tokenize:function(e,t,n){let r=0;return a;function a(t){return e.enter("lineEnding"),e.consume(t),e.exit("lineEnding"),l}function l(t){return e.enter("codeFencedFence"),L7(t)?U7(e,u,"linePrefix",i.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(t):u(t)}function u(t){return t===s?(e.enter("codeFencedFenceSequence"),c(t)):n(t)}function c(t){return t===s?(r++,e.consume(t),c):r>=o?(e.exit("codeFencedFenceSequence"),L7(t)?U7(e,h,"whitespace")(t):h(t)):n(t)}function h(i){return null===i||B7(i)?(e.exit("codeFencedFence"),t(i)):n(i)}}};let s,a=0,o=0;return function(t){return function(t){const n=i.events[i.events.length-1];return a=n&&"linePrefix"===n[1].type?n[2].sliceSerialize(n[1],!0).length:0,s=t,e.enter("codeFenced"),e.enter("codeFencedFence"),e.enter("codeFencedFenceSequence"),l(t)}(t)};function l(t){return t===s?(o++,e.consume(t),l):o<3?n(t):(e.exit("codeFencedFenceSequence"),L7(t)?U7(e,u,"whitespace")(t):u(t))}function u(n){return null===n||B7(n)?(e.exit("codeFencedFence"),i.interrupt?t(n):e.check(Dee,p,y)(n)):(e.enter("codeFencedFenceInfo"),e.enter("chunkString",{contentType:"string"}),c(n))}function c(t){return null===t||B7(t)?(e.exit("chunkString"),e.exit("codeFencedFenceInfo"),u(t)):L7(t)?(e.exit("chunkString"),e.exit("codeFencedFenceInfo"),U7(e,h,"whitespace")(t)):96===t&&t===s?n(t):(e.consume(t),c)}function h(t){return null===t||B7(t)?u(t):(e.enter("codeFencedFenceMeta"),e.enter("chunkString",{contentType:"string"}),d(t))}function d(t){return null===t||B7(t)?(e.exit("chunkString"),e.exit("codeFencedFenceMeta"),u(t)):96===t&&t===s?n(t):(e.consume(t),d)}function p(t){return e.attempt(r,y,f)(t)}function f(t){return e.enter("lineEnding"),e.consume(t),e.exit("lineEnding"),m}function m(t){return a>0&&L7(t)?U7(e,g,"linePrefix",a+1)(t):g(t)}function g(t){return null===t||B7(t)?e.check(Dee,p,y)(t):(e.enter("codeFlowValue"),v(t))}function v(t){return null===t||B7(t)?(e.exit("codeFlowValue"),g(t)):(e.consume(t),v)}function y(n){return e.exit("codeFenced"),t(n)}}};const See=document.createElement("i");function Eee(e){const t="&"+e+";";See.innerHTML=t;const n=See.textContent;return(59!==n.charCodeAt(n.length-1)||"semi"===e)&&(n!==t&&n)}const Cee={name:"characterReference",tokenize:function(e,t,n){const i=this;let r,s,a=0;return function(t){return e.enter("characterReference"),e.enter("characterReferenceMarker"),e.consume(t),e.exit("characterReferenceMarker"),o};function o(t){return 35===t?(e.enter("characterReferenceMarkerNumeric"),e.consume(t),e.exit("characterReferenceMarkerNumeric"),l):(e.enter("characterReferenceValue"),r=31,s=T7,u(t))}function l(t){return 88===t||120===t?(e.enter("characterReferenceMarkerHexadecimal"),e.consume(t),e.exit("characterReferenceMarkerHexadecimal"),e.enter("characterReferenceValue"),r=6,s=I7,u):(e.enter("characterReferenceValue"),r=7,s=O7,u(t))}function u(o){if(59===o&&a){const r=e.exit("characterReferenceValue");return s!==T7||Eee(i.sliceSerialize(r))?(e.enter("characterReferenceMarker"),e.consume(o),e.exit("characterReferenceMarker"),e.exit("characterReference"),t):n(o)}return s(o)&&a++<r?(e.consume(o),u):n(o)}}};const Aee={name:"characterEscape",tokenize:function(e,t,n){return function(t){return e.enter("characterEscape"),e.enter("escapeMarker"),e.consume(t),e.exit("escapeMarker"),i};function i(i){return k7(i)?(e.enter("characterEscapeValue"),e.consume(i),e.exit("characterEscapeValue"),e.exit("characterEscape"),t):n(i)}}};const Mee={name:"lineEnding",tokenize:function(e,t){return function(n){return e.enter("lineEnding"),e.consume(n),e.exit("lineEnding"),U7(e,t,"linePrefix")}}};function Tee(e,t,n){const i=[];let r=-1;for(;++r<e.length;){const s=e[r].resolveAll;s&&!i.includes(s)&&(t=s(t,n),i.push(s))}return t}const Pee={name:"labelEnd",resolveAll:function(e){let t=-1;const n=[];for(;++t<e.length;){const i=e[t][1];if(n.push(e[t]),"labelImage"===i.type||"labelLink"===i.type||"labelEnd"===i.type){const e="labelImage"===i.type?4:2;i.type="data",t+=e}}e.length!==n.length&&x7(e,0,e.length,n);return e},resolveTo:function(e,t){let n,i,r,s,a=e.length,o=0;for(;a--;)if(n=e[a][1],i){if("link"===n.type||"labelLink"===n.type&&n._inactive)break;"enter"===e[a][0]&&"labelLink"===n.type&&(n._inactive=!0)}else if(r){if("enter"===e[a][0]&&("labelImage"===n.type||"labelLink"===n.type)&&!n._balanced&&(i=a,"labelLink"!==n.type)){o=2;break}}else"labelEnd"===n.type&&(r=a);const l={type:"labelLink"===e[i][1].type?"link":"image",start:d({},e[i][1].start),end:d({},e[e.length-1][1].end)},u={type:"label",start:d({},e[i][1].start),end:d({},e[r][1].end)},c={type:"labelText",start:d({},e[i+o+2][1].end),end:d({},e[r-2][1].start)};return s=[["enter",l,t],["enter",u,t]],s=b7(s,e.slice(i+1,i+o+3)),s=b7(s,[["enter",c,t]]),s=b7(s,Tee(t.parser.constructs.insideSpan.null,e.slice(i+o+4,r-3),t)),s=b7(s,[["exit",c,t],e[r-2],e[r-1],["exit",u,t]]),s=b7(s,e.slice(r+1)),s=b7(s,[["exit",l,t]]),x7(e,i,e.length,s),e},tokenize:function(e,t,n){const i=this;let r,s,a=i.events.length;for(;a--;)if(("labelImage"===i.events[a][1].type||"labelLink"===i.events[a][1].type)&&!i.events[a][1]._balanced){r=i.events[a][1];break}return function(t){if(!r)return n(t);if(r._inactive)return c(t);return s=i.parser.defined.includes(cee(i.sliceSerialize({start:r.end,end:i.now()}))),e.enter("labelEnd"),e.enter("labelMarker"),e.consume(t),e.exit("labelMarker"),e.exit("labelEnd"),o};function o(t){return 40===t?e.attempt(Fee,u,s?u:c)(t):91===t?e.attempt(Oee,u,s?l:c)(t):s?u(t):c(t)}function l(t){return e.attempt(Iee,u,c)(t)}function u(e){return t(e)}function c(e){return r._balanced=!0,n(e)}}},Fee={tokenize:function(e,t,n){return function(t){return e.enter("resource"),e.enter("resourceMarker"),e.consume(t),e.exit("resourceMarker"),i};function i(t){return R7(t)?uee(e,r)(t):r(t)}function r(t){return 41===t?u(t):aee(e,s,a,"resourceDestination","resourceDestinationLiteral","resourceDestinationLiteralMarker","resourceDestinationRaw","resourceDestinationString",32)(t)}function s(t){return R7(t)?uee(e,o)(t):u(t)}function a(e){return n(e)}function o(t){return 34===t||39===t||40===t?lee(e,l,n,"resourceTitle","resourceTitleMarker","resourceTitleString")(t):u(t)}function l(t){return R7(t)?uee(e,u)(t):u(t)}function u(i){return 41===i?(e.enter("resourceMarker"),e.consume(i),e.exit("resourceMarker"),e.exit("resource"),t):n(i)}}},Oee={tokenize:function(e,t,n){const i=this;return function(t){return oee.call(i,e,r,s,"reference","referenceMarker","referenceString")(t)};function r(e){return i.parser.defined.includes(cee(i.sliceSerialize(i.events[i.events.length-1][1]).slice(1,-1)))?t(e):n(e)}function s(e){return n(e)}}},Iee={tokenize:function(e,t,n){return function(t){return e.enter("reference"),e.enter("referenceMarker"),e.consume(t),e.exit("referenceMarker"),i};function i(i){return 93===i?(e.enter("referenceMarker"),e.consume(i),e.exit("referenceMarker"),e.exit("reference"),t):n(i)}}};const kee={name:"labelStartImage",resolveAll:Pee.resolveAll,tokenize:function(e,t,n){const i=this;return function(t){return e.enter("labelImage"),e.enter("labelImageMarker"),e.consume(t),e.exit("labelImageMarker"),r};function r(t){return 91===t?(e.enter("labelMarker"),e.consume(t),e.exit("labelMarker"),e.exit("labelImage"),s):n(t)}function s(e){return 94===e&&"_hiddenFootnoteSupport"in i.parser.constructs?n(e):t(e)}}};function Bee(e){return null===e||R7(e)||N7(e)?1:z7(e)?2:void 0}const Ree={name:"attention",resolveAll:function(e,t){let n,i,r,s,a,o,l,u,c=-1;for(;++c<e.length;)if("enter"===e[c][0]&&"attentionSequence"===e[c][1].type&&e[c][1]._close)for(n=c;n--;)if("exit"===e[n][0]&&"attentionSequence"===e[n][1].type&&e[n][1]._open&&t.sliceSerialize(e[n][1]).charCodeAt(0)===t.sliceSerialize(e[c][1]).charCodeAt(0)){if((e[n][1]._close||e[c][1]._open)&&(e[c][1].end.offset-e[c][1].start.offset)%3&&!((e[n][1].end.offset-e[n][1].start.offset+e[c][1].end.offset-e[c][1].start.offset)%3))continue;o=e[n][1].end.offset-e[n][1].start.offset>1&&e[c][1].end.offset-e[c][1].start.offset>1?2:1;const h=d({},e[n][1].end),p=d({},e[c][1].start);Lee(h,-o),Lee(p,o),s={type:o>1?"strongSequence":"emphasisSequence",start:h,end:d({},e[n][1].end)},a={type:o>1?"strongSequence":"emphasisSequence",start:d({},e[c][1].start),end:p},r={type:o>1?"strongText":"emphasisText",start:d({},e[n][1].end),end:d({},e[c][1].start)},i={type:o>1?"strong":"emphasis",start:d({},s.start),end:d({},a.end)},e[n][1].end=d({},s.start),e[c][1].start=d({},a.end),l=[],e[n][1].end.offset-e[n][1].start.offset&&(l=b7(l,[["enter",e[n][1],t],["exit",e[n][1],t]])),l=b7(l,[["enter",i,t],["enter",s,t],["exit",s,t],["enter",r,t]]),l=b7(l,Tee(t.parser.constructs.insideSpan.null,e.slice(n+1,c),t)),l=b7(l,[["exit",r,t],["enter",a,t],["exit",a,t],["exit",i,t]]),e[c][1].end.offset-e[c][1].start.offset?(u=2,l=b7(l,[["enter",e[c][1],t],["exit",e[c][1],t]])):u=0,x7(e,n-1,c-n+3,l),c=n+l.length-u-2;break}c=-1;for(;++c<e.length;)"attentionSequence"===e[c][1].type&&(e[c][1].type="data");return e},tokenize:function(e,t){const n=this.parser.constructs.attentionMarkers.null,i=this.previous,r=Bee(i);let s;return function(t){return s=t,e.enter("attentionSequence"),a(t)};function a(o){if(o===s)return e.consume(o),a;const l=e.exit("attentionSequence"),u=Bee(o),c=!u||2===u&&r||n.includes(o),h=!r||2===r&&u||n.includes(i);return l._open=Boolean(42===s?c:c&&(r||!h)),l._close=Boolean(42===s?h:h&&(u||!c)),t(o)}}};function Lee(e,t){e.column+=t,e.offset+=t,e._bufferIndex+=t}const zee={name:"autolink",tokenize:function(e,t,n){let i=0;return function(t){return e.enter("autolink"),e.enter("autolinkMarker"),e.consume(t),e.exit("autolinkMarker"),e.enter("autolinkProtocol"),r};function r(t){return M7(t)?(e.consume(t),s):64===t?n(t):l(t)}function s(e){return 43===e||45===e||46===e||T7(e)?(i=1,a(e)):l(e)}function a(t){return 58===t?(e.consume(t),i=0,o):(43===t||45===t||46===t||T7(t))&&i++<32?(e.consume(t),a):(i=0,l(t))}function o(i){return 62===i?(e.exit("autolinkProtocol"),e.enter("autolinkMarker"),e.consume(i),e.exit("autolinkMarker"),e.exit("autolink"),t):null===i||32===i||60===i||F7(i)?n(i):(e.consume(i),o)}function l(t){return 64===t?(e.consume(t),u):P7(t)?(e.consume(t),l):n(t)}function u(e){return T7(e)?c(e):n(e)}function c(n){return 46===n?(e.consume(n),i=0,u):62===n?(e.exit("autolinkProtocol").type="autolinkEmail",e.enter("autolinkMarker"),e.consume(n),e.exit("autolinkMarker"),e.exit("autolink"),t):h(n)}function h(t){if((45===t||T7(t))&&i++<63){const n=45===t?h:c;return e.consume(t),n}return n(t)}}};const Nee={name:"htmlText",tokenize:function(e,t,n){const i=this;let r,s,a;return function(t){return e.enter("htmlText"),e.enter("htmlTextData"),e.consume(t),o};function o(t){return 33===t?(e.consume(t),l):47===t?(e.consume(t),b):63===t?(e.consume(t),y):M7(t)?(e.consume(t),_):n(t)}function l(t){return 45===t?(e.consume(t),u):91===t?(e.consume(t),s=0,p):M7(t)?(e.consume(t),v):n(t)}function u(t){return 45===t?(e.consume(t),d):n(t)}function c(t){return null===t?n(t):45===t?(e.consume(t),h):B7(t)?(a=c,O(t)):(e.consume(t),c)}function h(t){return 45===t?(e.consume(t),d):c(t)}function d(e){return 62===e?F(e):45===e?h(e):c(e)}function p(t){const i="CDATA[";return t===i.charCodeAt(s++)?(e.consume(t),6===s?f:p):n(t)}function f(t){return null===t?n(t):93===t?(e.consume(t),m):B7(t)?(a=f,O(t)):(e.consume(t),f)}function m(t){return 93===t?(e.consume(t),g):f(t)}function g(t){return 62===t?F(t):93===t?(e.consume(t),g):f(t)}function v(t){return null===t||62===t?F(t):B7(t)?(a=v,O(t)):(e.consume(t),v)}function y(t){return null===t?n(t):63===t?(e.consume(t),x):B7(t)?(a=y,O(t)):(e.consume(t),y)}function x(e){return 62===e?F(e):y(e)}function b(t){return M7(t)?(e.consume(t),w):n(t)}function w(t){return 45===t||T7(t)?(e.consume(t),w):D(t)}function D(t){return B7(t)?(a=D,O(t)):L7(t)?(e.consume(t),D):F(t)}function _(t){return 45===t||T7(t)?(e.consume(t),_):47===t||62===t||R7(t)?S(t):n(t)}function S(t){return 47===t?(e.consume(t),F):58===t||95===t||M7(t)?(e.consume(t),E):B7(t)?(a=S,O(t)):L7(t)?(e.consume(t),S):F(t)}function E(t){return 45===t||46===t||58===t||95===t||T7(t)?(e.consume(t),E):C(t)}function C(t){return 61===t?(e.consume(t),A):B7(t)?(a=C,O(t)):L7(t)?(e.consume(t),C):S(t)}function A(t){return null===t||60===t||61===t||62===t||96===t?n(t):34===t||39===t?(e.consume(t),r=t,M):B7(t)?(a=A,O(t)):L7(t)?(e.consume(t),A):(e.consume(t),T)}function M(t){return t===r?(e.consume(t),r=void 0,P):null===t?n(t):B7(t)?(a=M,O(t)):(e.consume(t),M)}function T(t){return null===t||34===t||39===t||60===t||61===t||96===t?n(t):47===t||62===t||R7(t)?S(t):(e.consume(t),T)}function P(e){return 47===e||62===e||R7(e)?S(e):n(e)}function F(i){return 62===i?(e.consume(i),e.exit("htmlTextData"),e.exit("htmlText"),t):n(i)}function O(t){return e.exit("htmlTextData"),e.enter("lineEnding"),e.consume(t),e.exit("lineEnding"),I}function I(t){return L7(t)?U7(e,k,"linePrefix",i.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(t):k(t)}function k(t){return e.enter("htmlTextData"),a(t)}}};const jee={name:"labelStartLink",resolveAll:Pee.resolveAll,tokenize:function(e,t,n){const i=this;return function(t){return e.enter("labelLink"),e.enter("labelMarker"),e.consume(t),e.exit("labelMarker"),e.exit("labelLink"),r};function r(e){return 94===e&&"_hiddenFootnoteSupport"in i.parser.constructs?n(e):t(e)}}};const Uee={name:"hardBreakEscape",tokenize:function(e,t,n){return function(t){return e.enter("hardBreakEscape"),e.consume(t),i};function i(i){return B7(i)?(e.exit("hardBreakEscape"),t(i)):n(i)}}};const Vee={name:"codeText",previous:function(e){return 96!==e||"characterEscape"===this.events[this.events.length-1][1].type},resolve:function(e){let t,n,i=e.length-4,r=3;if(("lineEnding"===e[r][1].type||"space"===e[r][1].type)&&("lineEnding"===e[i][1].type||"space"===e[i][1].type))for(t=r;++t<i;)if("codeTextData"===e[t][1].type){e[r][1].type="codeTextPadding",e[i][1].type="codeTextPadding",r+=2,i-=2;break}t=r-1,i++;for(;++t<=i;)void 0===n?t!==i&&"lineEnding"!==e[t][1].type&&(n=t):t!==i&&"lineEnding"!==e[t][1].type||(e[n][1].type="codeTextData",t!==n+2&&(e[n][1].end=e[t-1][1].end,e.splice(n+2,t-n-2),i-=t-n-2,t=n+2),n=void 0);return e},tokenize:function(e,t,n){let i,r,s=0;return function(t){return e.enter("codeText"),e.enter("codeTextSequence"),a(t)};function a(t){return 96===t?(e.consume(t),s++,a):(e.exit("codeTextSequence"),o(t))}function o(t){return null===t?n(t):32===t?(e.enter("space"),e.consume(t),e.exit("space"),o):96===t?(r=e.enter("codeTextSequence"),i=0,u(t)):B7(t)?(e.enter("lineEnding"),e.consume(t),e.exit("lineEnding"),o):(e.enter("codeTextData"),l(t))}function l(t){return null===t||32===t||96===t||B7(t)?(e.exit("codeTextData"),o(t)):(e.consume(t),l)}function u(n){return 96===n?(e.consume(n),i++,u):i===s?(e.exit("codeTextSequence"),e.exit("codeText"),t(n)):(r.type="codeTextData",l(n))}}};const Hee={42:nee,43:nee,45:nee,48:nee,49:nee,50:nee,51:nee,52:nee,53:nee,54:nee,55:nee,56:nee,57:nee,62:see},Wee={91:hee},Gee={[-2]:pee,[-1]:pee,32:pee},qee={35:mee,42:tee,45:[gee,tee],60:xee,61:gee,95:tee,96:_ee,126:_ee},Yee={38:Cee,92:Aee},Xee={[-5]:Mee,[-4]:Mee,[-3]:Mee,33:kee,38:Cee,42:Ree,60:[zee,Nee],91:jee,92:[Uee,Aee],93:Pee,95:Ree,96:Vee},Qee={null:[Ree,Q7]},Kee={null:[42,95]},Zee={null:[]};function Jee(e,t,n){let i={_bufferIndex:-1,_index:0,line:n&&n.line||1,column:n&&n.column||1,offset:n&&n.offset||0};const r={},s=[];let a=[],o=[],l=!0;const u={attempt:y((function(e,t){x(e,t.from)})),check:y(v),consume:function(e){B7(e)?(i.line++,i.column=1,i.offset+=-3===e?2:1,b()):-1!==e&&(i.column++,i.offset++);i._bufferIndex<0?i._index++:(i._bufferIndex++,i._bufferIndex===a[i._index].length&&(i._bufferIndex=-1,i._index++));c.previous=e,l=!0},enter:function(e,t){const n=t||{};return n.type=e,n.start=f(),c.events.push(["enter",n,c]),o.push(n),n},exit:function(e){const t=o.pop();return t.end=f(),c.events.push(["exit",t,c]),t},interrupt:y(v,{interrupt:!0})},c={code:null,containerState:{},defineSkip:function(e){r[e.line]=e.column,b()},events:[],now:f,parser:e,previous:null,sliceSerialize:function(e,t){return function(e,t){let n=-1;const i=[];let r;for(;++n<e.length;){const s=e[n];let a;if("string"===typeof s)a=s;else switch(s){case-5:a="\r";break;case-4:a="\n";break;case-3:a="\r\n";break;case-2:a=t?" ":"\t";break;case-1:if(!t&&r)continue;a=" ";break;default:a=String.fromCharCode(s)}r=-2===s,i.push(a)}return i.join("")}(p(e),t)},sliceStream:p,write:function(e){if(a=b7(a,e),m(),null!==a[a.length-1])return[];return x(t,0),c.events=Tee(s,c.events,c),c.events}};let h,d=t.tokenize.call(c,u);return t.resolveAll&&s.push(t),c;function p(e){return function(e,t){const n=t.start._index,i=t.start._bufferIndex,r=t.end._index,s=t.end._bufferIndex;let a;if(n===r)a=[e[n].slice(i,s)];else{if(a=e.slice(n,r),i>-1){const e=a[0];"string"===typeof e?a[0]=e.slice(i):a.shift()}s>0&&a.push(e[r].slice(0,s))}return a}(a,e)}function f(){const{_bufferIndex:e,_index:t,line:n,column:r,offset:s}=i;return{_bufferIndex:e,_index:t,line:n,column:r,offset:s}}function m(){let e;for(;i._index<a.length;){const t=a[i._index];if("string"===typeof t)for(e=i._index,i._bufferIndex<0&&(i._bufferIndex=0);i._index===e&&i._bufferIndex<t.length;)g(t.charCodeAt(i._bufferIndex));else g(t)}}function g(e){l=void 0,h=e,d=d(e)}function v(e,t){t.restore()}function y(e,t){return function(n,r,s){let a,h,d,p;return Array.isArray(n)?m(n):"tokenize"in n?m([n]):function(e){return t;function t(t){const n=null!==t&&e[t],i=null!==t&&e.null;return m([...Array.isArray(n)?n:n?[n]:[],...Array.isArray(i)?i:i?[i]:[]])(t)}}(n);function m(e){return a=e,h=0,0===e.length?s:g(e[h])}function g(e){return function(n){p=function(){const e=f(),t=c.previous,n=c.currentConstruct,r=c.events.length,s=Array.from(o);return{from:r,restore:a};function a(){i=e,c.previous=t,c.currentConstruct=n,c.events.length=r,o=s,b()}}(),d=e,e.partial||(c.currentConstruct=e);if(e.name&&c.parser.constructs.disable.null.includes(e.name))return y(n);return e.tokenize.call(t?Object.assign(Object.create(c),t):c,u,v,y)(n)}}function v(t){return l=!0,e(d,p),r}function y(e){return l=!0,p.restore(),++h<a.length?g(a[h]):s}}}function x(e,t){e.resolveAll&&!s.includes(e)&&s.push(e),e.resolve&&x7(c.events,t,c.events.length-t,e.resolve(c.events.slice(t),c)),e.resolveTo&&(c.events=e.resolveTo(c.events,c))}function b(){i.line in r&&i.column<2&&(i.column=r[i.line],i.offset+=r[i.line]-1)}}function $ee(e){const t=function(e){const t={};let n=-1;for(;++n<e.length;)C7(t,e[n]);return t}([i,...(e||{}).extensions||[]]),n={constructs:t,content:r(V7),defined:[],document:r(H7),flow:r(X7),lazy:{},string:r(K7),text:r(Z7)};return n;function r(e){return function(t){return Jee(n,e,t)}}}const ete=/[\0\t\n\r]/g;function tte(e,t){const n=Number.parseInt(e,t);return n<9||11===n||n>13&&n<32||n>126&&n<160||n>55295&&n<57344||n>64975&&n<65008||65535===(65535&n)||65534===(65535&n)||n>1114111?"\ufffd":String.fromCodePoint(n)}const nte=/\\([!-/:-@[-`{-~])|&(#(?:\d{1,7}|x[\da-f]{1,6})|[\da-z]{1,31});/gi;function ite(e,t,n){if(t)return t;if(35===n.charCodeAt(0)){const e=n.charCodeAt(1),t=120===e||88===e;return tte(n.slice(t?2:1),t?16:10)}return Eee(n)||e}const rte={}.hasOwnProperty;function ste(e,t,n){return"string"!==typeof t&&(n=t,t=void 0),function(e){const t={transforms:[],canContainEols:["emphasis","fragment","heading","paragraph","strong"],enter:{autolink:s(te),autolinkProtocol:E,autolinkEmail:E,atxHeading:s(Z),blockQuote:s(q),characterEscape:E,characterReference:E,codeFenced:s(Y),codeFencedFenceInfo:a,codeFencedFenceMeta:a,codeIndented:s(Y,a),codeText:s(X,a),codeTextData:E,data:E,codeFlowValue:E,definition:s(Q),definitionDestinationString:a,definitionLabelString:a,definitionTitleString:a,emphasis:s(K),hardBreakEscape:s(J),hardBreakTrailing:s(J),htmlFlow:s($,a),htmlFlowData:E,htmlText:s($,a),htmlTextData:E,image:s(ee),label:a,link:s(te),listItem:s(ie),listItemValue:d,listOrdered:s(ne,h),listUnordered:s(ne),paragraph:s(re),reference:N,referenceString:a,resourceDestinationString:a,resourceTitleString:a,setextHeading:s(Z),strong:s(se),thematicBreak:s(oe)},exit:{atxHeading:l(),atxHeadingSequence:w,autolink:l(),autolinkEmail:G,autolinkProtocol:W,blockQuote:l(),characterEscapeValue:C,characterReferenceMarkerHexadecimal:U,characterReferenceMarkerNumeric:U,characterReferenceValue:V,characterReference:H,codeFenced:l(g),codeFencedFence:m,codeFencedFenceInfo:p,codeFencedFenceMeta:f,codeFlowValue:C,codeIndented:l(v),codeText:l(F),codeTextData:C,data:C,definition:l(),definitionDestinationString:b,definitionLabelString:y,definitionTitleString:x,emphasis:l(),hardBreakEscape:l(M),hardBreakTrailing:l(M),htmlFlow:l(T),htmlFlowData:C,htmlText:l(P),htmlTextData:C,image:l(I),label:B,labelText:k,lineEnding:A,link:l(O),listItem:l(),listOrdered:l(),listUnordered:l(),paragraph:l(),referenceString:j,resourceDestinationString:R,resourceTitleString:L,resource:z,setextHeading:l(S),setextHeadingLineSequence:_,setextHeadingText:D,strong:l(),thematicBreak:l()}};ote(t,(e||{}).mdastExtensions||[]);const n={};return i;function i(e){let i={type:"root",children:[]};const s={stack:[i],tokenStack:[],config:t,enter:o,exit:u,buffer:a,resume:c,data:n},l=[];let h=-1;for(;++h<e.length;)if("listOrdered"===e[h][1].type||"listUnordered"===e[h][1].type)if("enter"===e[h][0])l.push(h);else{h=r(e,l.pop(),h)}for(h=-1;++h<e.length;){const n=t[e[h][0]];rte.call(n,e[h][1].type)&&n[e[h][1].type].call(Object.assign({sliceSerialize:e[h][2].sliceSerialize},s),e[h][1])}if(s.tokenStack.length>0){const e=s.tokenStack[s.tokenStack.length-1];(e[1]||ute).call(s,void 0,e[0])}for(i.position={start:ate(e.length>0?e[0][1].start:{line:1,column:1,offset:0}),end:ate(e.length>0?e[e.length-2][1].end:{line:1,column:1,offset:0})},h=-1;++h<t.transforms.length;)i=t.transforms[h](i)||i;return i}function r(e,t,n){let i,r,s,a,o=t-1,l=-1,u=!1;for(;++o<=n;){const t=e[o];switch(t[1].type){case"listUnordered":case"listOrdered":case"blockQuote":"enter"===t[0]?l++:l--,a=void 0;break;case"lineEndingBlank":"enter"===t[0]&&(!i||a||l||s||(s=o),a=void 0);break;case"linePrefix":case"listItemValue":case"listItemMarker":case"listItemPrefix":case"listItemPrefixWhitespace":break;default:a=void 0}if(!l&&"enter"===t[0]&&"listItemPrefix"===t[1].type||-1===l&&"exit"===t[0]&&("listUnordered"===t[1].type||"listOrdered"===t[1].type)){if(i){let a=o;for(r=void 0;a--;){const t=e[a];if("lineEnding"===t[1].type||"lineEndingBlank"===t[1].type){if("exit"===t[0])continue;r&&(e[r][1].type="lineEndingBlank",u=!0),t[1].type="lineEnding",r=a}else if("linePrefix"!==t[1].type&&"blockQuotePrefix"!==t[1].type&&"blockQuotePrefixWhitespace"!==t[1].type&&"blockQuoteMarker"!==t[1].type&&"listItemIndent"!==t[1].type)break}s&&(!r||s<r)&&(i._spread=!0),i.end=Object.assign({},r?e[r][1].start:t[1].end),e.splice(r||o,0,["exit",i,t[2]]),o++,n++}if("listItemPrefix"===t[1].type){const r={type:"listItem",_spread:!1,start:Object.assign({},t[1].start),end:void 0};i=r,e.splice(o,0,["enter",r,t[2]]),o++,n++,s=void 0,a=!0}}}return e[t][1]._spread=u,n}function s(e,t){return n;function n(n){o.call(this,e(n),n),t&&t.call(this,n)}}function a(){this.stack.push({type:"fragment",children:[]})}function o(e,t,n){this.stack[this.stack.length-1].children.push(e),this.stack.push(e),this.tokenStack.push([t,n||void 0]),e.position={start:ate(t.start),end:void 0}}function l(e){return t;function t(t){e&&e.call(this,t),u.call(this,t)}}function u(e,t){const n=this.stack.pop(),i=this.tokenStack.pop();if(!i)throw new Error("Cannot close `"+e.type+"` ("+q9({start:e.start,end:e.end})+"): it\u2019s not open");if(i[0].type!==e.type)if(t)t.call(this,e,i[0]);else{(i[1]||ute).call(this,e,i[0])}n.position.end=ate(e.end)}function c(){return function(e,t){const n=t||g7;return v7(e,"boolean"!==typeof n.includeImageAlt||n.includeImageAlt,"boolean"!==typeof n.includeHtml||n.includeHtml)}(this.stack.pop())}function h(){this.data.expectingFirstListItemValue=!0}function d(e){if(this.data.expectingFirstListItemValue){this.stack[this.stack.length-2].start=Number.parseInt(this.sliceSerialize(e),10),this.data.expectingFirstListItemValue=void 0}}function p(){const e=this.resume();this.stack[this.stack.length-1].lang=e}function f(){const e=this.resume();this.stack[this.stack.length-1].meta=e}function m(){this.data.flowCodeInside||(this.buffer(),this.data.flowCodeInside=!0)}function g(){const e=this.resume();this.stack[this.stack.length-1].value=e.replace(/^(\r?\n|\r)|(\r?\n|\r)$/g,""),this.data.flowCodeInside=void 0}function v(){const e=this.resume();this.stack[this.stack.length-1].value=e.replace(/(\r?\n|\r)$/g,"")}function y(e){const t=this.resume(),n=this.stack[this.stack.length-1];n.label=t,n.identifier=cee(this.sliceSerialize(e)).toLowerCase()}function x(){const e=this.resume();this.stack[this.stack.length-1].title=e}function b(){const e=this.resume();this.stack[this.stack.length-1].url=e}function w(e){const t=this.stack[this.stack.length-1];if(!t.depth){const n=this.sliceSerialize(e).length;t.depth=n}}function D(){this.data.setextHeadingSlurpLineEnding=!0}function _(e){this.stack[this.stack.length-1].depth=61===this.sliceSerialize(e).codePointAt(0)?1:2}function S(){this.data.setextHeadingSlurpLineEnding=void 0}function E(e){const t=this.stack[this.stack.length-1].children;let n=t[t.length-1];n&&"text"===n.type||(n=ae(),n.position={start:ate(e.start),end:void 0},t.push(n)),this.stack.push(n)}function C(e){const t=this.stack.pop();t.value+=this.sliceSerialize(e),t.position.end=ate(e.end)}function A(e){const n=this.stack[this.stack.length-1];if(this.data.atHardBreak){return n.children[n.children.length-1].position.end=ate(e.end),void(this.data.atHardBreak=void 0)}!this.data.setextHeadingSlurpLineEnding&&t.canContainEols.includes(n.type)&&(E.call(this,e),C.call(this,e))}function M(){this.data.atHardBreak=!0}function T(){const e=this.resume();this.stack[this.stack.length-1].value=e}function P(){const e=this.resume();this.stack[this.stack.length-1].value=e}function F(){const e=this.resume();this.stack[this.stack.length-1].value=e}function O(){const e=this.stack[this.stack.length-1];if(this.data.inReference){const t=this.data.referenceType||"shortcut";e.type+="Reference",e.referenceType=t,delete e.url,delete e.title}else delete e.identifier,delete e.label;this.data.referenceType=void 0}function I(){const e=this.stack[this.stack.length-1];if(this.data.inReference){const t=this.data.referenceType||"shortcut";e.type+="Reference",e.referenceType=t,delete e.url,delete e.title}else delete e.identifier,delete e.label;this.data.referenceType=void 0}function k(e){const t=this.sliceSerialize(e),n=this.stack[this.stack.length-2];n.label=function(e){return e.replace(nte,ite)}(t),n.identifier=cee(t).toLowerCase()}function B(){const e=this.stack[this.stack.length-1],t=this.resume(),n=this.stack[this.stack.length-1];if(this.data.inReference=!0,"link"===n.type){const t=e.children;n.children=t}else n.alt=t}function R(){const e=this.resume();this.stack[this.stack.length-1].url=e}function L(){const e=this.resume();this.stack[this.stack.length-1].title=e}function z(){this.data.inReference=void 0}function N(){this.data.referenceType="collapsed"}function j(e){const t=this.resume(),n=this.stack[this.stack.length-1];n.label=t,n.identifier=cee(this.sliceSerialize(e)).toLowerCase(),this.data.referenceType="full"}function U(e){this.data.characterReferenceType=e.type}function V(e){const t=this.sliceSerialize(e),n=this.data.characterReferenceType;let i;if(n)i=tte(t,"characterReferenceMarkerNumeric"===n?10:16),this.data.characterReferenceType=void 0;else{i=Eee(t)}this.stack[this.stack.length-1].value+=i}function H(e){this.stack.pop().position.end=ate(e.end)}function W(e){C.call(this,e);this.stack[this.stack.length-1].url=this.sliceSerialize(e)}function G(e){C.call(this,e);this.stack[this.stack.length-1].url="mailto:"+this.sliceSerialize(e)}function q(){return{type:"blockquote",children:[]}}function Y(){return{type:"code",lang:null,meta:null,value:""}}function X(){return{type:"inlineCode",value:""}}function Q(){return{type:"definition",identifier:"",label:null,title:null,url:""}}function K(){return{type:"emphasis",children:[]}}function Z(){return{type:"heading",depth:0,children:[]}}function J(){return{type:"break"}}function $(){return{type:"html",value:""}}function ee(){return{type:"image",title:null,url:"",alt:null}}function te(){return{type:"link",title:null,url:"",children:[]}}function ne(e){return{type:"list",ordered:"listOrdered"===e.type,start:null,spread:e._spread,children:[]}}function ie(e){return{type:"listItem",spread:e._spread,checked:null,children:[]}}function re(){return{type:"paragraph",children:[]}}function se(){return{type:"strong",children:[]}}function ae(){return{type:"text",value:""}}function oe(){return{type:"thematicBreak"}}}(n)(function(e){for(;!_7(e););return e}($ee(n).document().write(function(){let e,t=1,n="",i=!0;return function(r,s,a){const o=[];let l,u,c,h,d;for(r=n+("string"===typeof r?r.toString():new TextDecoder(s||void 0).decode(r)),c=0,n="",i&&(65279===r.charCodeAt(0)&&c++,i=void 0);c<r.length;){if(ete.lastIndex=c,l=ete.exec(r),h=l&&void 0!==l.index?l.index:r.length,d=r.charCodeAt(h),!l){n=r.slice(c);break}if(10===d&&c===h&&e)o.push(-3),e=void 0;else switch(e&&(o.push(-5),e=void 0),c<h&&(o.push(r.slice(c,h)),t+=h-c),d){case 0:o.push(65533),t++;break;case 9:for(u=4*Math.ceil(t/4),o.push(-2);t++<u;)o.push(-1);break;case 10:o.push(-4),t=1;break;default:e=!0,t=1}c=h+1}return a&&(e&&o.push(-5),n&&o.push(n),o.push(null)),o}}()(e,t,!0))))}function ate(e){return{line:e.line,column:e.column,offset:e.offset}}function ote(e,t){let n=-1;for(;++n<t.length;){const i=t[n];Array.isArray(i)?ote(e,i):lte(e,i)}}function lte(e,t){let n;for(n in t)if(rte.call(t,n))switch(n){case"canContainEols":{const i=t[n];i&&e[n].push(...i);break}case"transforms":{const i=t[n];i&&e[n].push(...i);break}case"enter":case"exit":{const i=t[n];i&&Object.assign(e[n],i);break}}}function ute(e,t){throw e?new Error("Cannot close `"+e.type+"` ("+q9({start:e.start,end:e.end})+"): a different token (`"+t.type+"`, "+q9({start:t.start,end:t.end})+") is open"):new Error("Cannot close document, a token (`"+t.type+"`, "+q9({start:t.start,end:t.end})+") is still open")}function cte(e){const t=this;t.parser=function(n){return ste(n,d(d(d({},t.data("settings")),e),{},{extensions:t.data("micromarkExtensions")||[],mdastExtensions:t.data("fromMarkdownExtensions")||[]}))}}const hte="object"===typeof self?self:globalThis,dte=e=>((e,t)=>{const n=(t,n)=>(e.set(n,t),t),i=r=>{if(e.has(r))return e.get(r);const[s,a]=t[r];switch(s){case 0:case-1:return n(a,r);case 1:{const e=n([],r);for(const t of a)e.push(i(t));return e}case 2:{const e=n({},r);for(const[t,n]of a)e[i(t)]=i(n);return e}case 3:return n(new Date(a),r);case 4:{const{source:e,flags:t}=a;return n(new RegExp(e,t),r)}case 5:{const e=n(new Map,r);for(const[t,n]of a)e.set(i(t),i(n));return e}case 6:{const e=n(new Set,r);for(const t of a)e.add(i(t));return e}case 7:{const{name:e,message:t}=a;return n(new hte[e](t),r)}case 8:return n(BigInt(a),r);case"BigInt":return n(Object(BigInt(a)),r);case"ArrayBuffer":return n(new Uint8Array(a).buffer,a);case"DataView":{const{buffer:e}=new Uint8Array(a);return n(new DataView(e),a)}}return n(new hte[s](a),r)};return i})(new Map,e)(0),pte="",{toString:fte}={},{keys:mte}=Object,gte=e=>{const t=typeof e;if("object"!==t||!e)return[0,t];const n=fte.call(e).slice(8,-1);switch(n){case"Array":return[1,pte];case"Object":return[2,pte];case"Date":return[3,pte];case"RegExp":return[4,pte];case"Map":return[5,pte];case"Set":return[6,pte];case"DataView":return[1,n]}return n.includes("Array")?[1,n]:n.includes("Error")?[7,n]:[2,n]},vte=e=>{let[t,n]=e;return 0===t&&("function"===n||"symbol"===n)},yte=function(e){let{json:t,lossy:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const i=[];return((e,t,n,i)=>{const r=(e,t)=>{const r=i.push(e)-1;return n.set(t,r),r},s=i=>{if(n.has(i))return n.get(i);let[a,o]=gte(i);switch(a){case 0:{let t=i;switch(o){case"bigint":a=8,t=i.toString();break;case"function":case"symbol":if(e)throw new TypeError("unable to serialize "+o);t=null;break;case"undefined":return r([-1],i)}return r([a,t],i)}case 1:{if(o){let e=i;return"DataView"===o?e=new Uint8Array(i.buffer):"ArrayBuffer"===o&&(e=new Uint8Array(i)),r([o,[...e]],i)}const e=[],t=r([a,e],i);for(const n of i)e.push(s(n));return t}case 2:{if(o)switch(o){case"BigInt":return r([o,i.toString()],i);case"Boolean":case"Number":case"String":return r([o,i.valueOf()],i)}if(t&&"toJSON"in i)return s(i.toJSON());const n=[],l=r([a,n],i);for(const t of mte(i))!e&&vte(gte(i[t]))||n.push([s(t),s(i[t])]);return l}case 3:return r([a,i.toISOString()],i);case 4:{const{source:e,flags:t}=i;return r([a,{source:e,flags:t}],i)}case 5:{const t=[],n=r([a,t],i);for(const[r,a]of i)(e||!vte(gte(r))&&!vte(gte(a)))&&t.push([s(r),s(a)]);return n}case 6:{const t=[],n=r([a,t],i);for(const r of i)!e&&vte(gte(r))||t.push(s(r));return n}}const{message:l}=i;return r([a,{name:o,message:l}],i)};return s})(!(t||n),!!t,new Map,i)(e),i},xte="function"===typeof structuredClone?(e,t)=>t&&("json"in t||"lossy"in t)?dte(yte(e,t)):structuredClone(e):(e,t)=>dte(yte(e,t));function bte(e){const t=[];let n=-1,i=0,r=0;for(;++n<e.length;){const s=e.charCodeAt(n);let a="";if(37===s&&T7(e.charCodeAt(n+1))&&T7(e.charCodeAt(n+2)))r=2;else if(s<128)/[!#$&-;=?-Z_a-z~]/.test(String.fromCharCode(s))||(a=String.fromCharCode(s));else if(s>55295&&s<57344){const t=e.charCodeAt(n+1);s<56320&&t>56319&&t<57344?(a=String.fromCharCode(s,t),r=1):a="\ufffd"}else a=String.fromCharCode(s);a&&(t.push(e.slice(i,n),encodeURIComponent(a)),i=n+r+1,a=""),r&&(n+=r,r=0)}return t.join("")+e.slice(i)}function wte(e,t){const n=[{type:"text",value:"\u21a9"}];return t>1&&n.push({type:"element",tagName:"sup",properties:{},children:[{type:"text",value:String(t)}]}),n}function Dte(e,t){return"Back to reference "+(e+1)+(t>1?"-"+t:"")}const _te=function(e){if(null===e||void 0===e)return Ete;if("function"===typeof e)return Ste(e);if("object"===typeof e)return Array.isArray(e)?function(e){const t=[];let n=-1;for(;++n<e.length;)t[n]=_te(e[n]);return Ste(i);function i(){let e=-1;for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];for(;++e<t.length;)if(t[e].apply(this,i))return!0;return!1}}(e):function(e){const t=e;return Ste(n);function n(n){const i=n;let r;for(r in e)if(i[r]!==t[r])return!1;return!0}}(e);if("string"===typeof e)return function(e){return Ste(t);function t(t){return t&&t.type===e}}(e);throw new Error("Expected function, string, or object as test")};function Ste(e){return function(t,n,i){return Boolean(Cte(t)&&e.call(this,t,"number"===typeof n?n:void 0,i||void 0))}}function Ete(){return!0}function Cte(e){return null!==e&&"object"===typeof e&&"type"in e}const Ate=[],Mte=!0,Tte=!1;function Pte(e,t,n,i){let r;"function"===typeof t&&"function"!==typeof n?(i=n,n=t):r=t;const s=_te(r),a=i?-1:1;!function e(r,o,l){const u=r&&"object"===typeof r?r:{};if("string"===typeof u.type){const e="string"===typeof u.tagName?u.tagName:"string"===typeof u.name?u.name:void 0;Object.defineProperty(c,"name",{value:"node ("+r.type+(e?"<"+e+">":"")+")"})}return c;function c(){let u,c,h,d=Ate;if((!t||s(r,o,l[l.length-1]||void 0))&&(d=function(e){if(Array.isArray(e))return e;if("number"===typeof e)return[Mte,e];return null===e||void 0===e?Ate:[e]}(n(r,l)),d[0]===Tte))return d;if("children"in r&&r.children){const t=r;if(t.children&&"skip"!==d[0])for(c=(i?t.children.length:-1)+a,h=l.concat(t);c>-1&&c<t.children.length;){const n=t.children[c];if(u=e(n,c,h)(),u[0]===Tte)return u;c="number"===typeof u[1]?u[1]:c+a}}return d}}(e,void 0,[])()}function Fte(e,t,n,i){let r,s,a;"function"===typeof t&&"function"!==typeof n?(s=void 0,a=t,r=n):(s=t,a=n,r=i),Pte(e,s,(function(e,t){const n=t[t.length-1],i=n?n.children.indexOf(e):void 0;return a(e,i,n)}),r)}function Ote(e,t){const n=t.referenceType;let i="]";if("collapsed"===n?i+="[]":"full"===n&&(i+="["+(t.label||t.identifier)+"]"),"imageReference"===t.type)return[{type:"text",value:"!["+t.alt+i}];const r=e.all(t),s=r[0];s&&"text"===s.type?s.value="["+s.value:r.unshift({type:"text",value:"["});const a=r[r.length-1];return a&&"text"===a.type?a.value+=i:r.push({type:"text",value:i}),r}function Ite(e){const t=e.spread;return null===t||void 0===t?e.children.length>1:t}function kte(e){const t=String(e),n=/\r?\n|\r/g;let i=n.exec(t),r=0;const s=[];for(;i;)s.push(Bte(t.slice(r,i.index),r>0,!0),i[0]),r=i.index+i[0].length,i=n.exec(t);return s.push(Bte(t.slice(r),r>0,!1)),s.join("")}function Bte(e,t,n){let i=0,r=e.length;if(t){let t=e.codePointAt(i);for(;9===t||32===t;)i++,t=e.codePointAt(i)}if(n){let t=e.codePointAt(r-1);for(;9===t||32===t;)r--,t=e.codePointAt(r-1)}return r>i?e.slice(i,r):""}const Rte={blockquote:function(e,t){const n={type:"element",tagName:"blockquote",properties:{},children:e.wrap(e.all(t),!0)};return e.patch(t,n),e.applyData(t,n)},break:function(e,t){const n={type:"element",tagName:"br",properties:{},children:[]};return e.patch(t,n),[e.applyData(t,n),{type:"text",value:"\n"}]},code:function(e,t){const n=t.value?t.value+"\n":"",i={};t.lang&&(i.className=["language-"+t.lang]);let r={type:"element",tagName:"code",properties:i,children:[{type:"text",value:n}]};return t.meta&&(r.data={meta:t.meta}),e.patch(t,r),r=e.applyData(t,r),r={type:"element",tagName:"pre",properties:{},children:[r]},e.patch(t,r),r},delete:function(e,t){const n={type:"element",tagName:"del",properties:{},children:e.all(t)};return e.patch(t,n),e.applyData(t,n)},emphasis:function(e,t){const n={type:"element",tagName:"em",properties:{},children:e.all(t)};return e.patch(t,n),e.applyData(t,n)},footnoteReference:function(e,t){const n="string"===typeof e.options.clobberPrefix?e.options.clobberPrefix:"user-content-",i=String(t.identifier).toUpperCase(),r=bte(i.toLowerCase()),s=e.footnoteOrder.indexOf(i);let a,o=e.footnoteCounts.get(i);void 0===o?(o=0,e.footnoteOrder.push(i),a=e.footnoteOrder.length):a=s+1,o+=1,e.footnoteCounts.set(i,o);const l={type:"element",tagName:"a",properties:{href:"#"+n+"fn-"+r,id:n+"fnref-"+r+(o>1?"-"+o:""),dataFootnoteRef:!0,ariaDescribedBy:["footnote-label"]},children:[{type:"text",value:String(a)}]};e.patch(t,l);const u={type:"element",tagName:"sup",properties:{},children:[l]};return e.patch(t,u),e.applyData(t,u)},heading:function(e,t){const n={type:"element",tagName:"h"+t.depth,properties:{},children:e.all(t)};return e.patch(t,n),e.applyData(t,n)},html:function(e,t){if(e.options.allowDangerousHtml){const n={type:"raw",value:t.value};return e.patch(t,n),e.applyData(t,n)}},imageReference:function(e,t){const n=String(t.identifier).toUpperCase(),i=e.definitionById.get(n);if(!i)return Ote(e,t);const r={src:bte(i.url||""),alt:t.alt};null!==i.title&&void 0!==i.title&&(r.title=i.title);const s={type:"element",tagName:"img",properties:r,children:[]};return e.patch(t,s),e.applyData(t,s)},image:function(e,t){const n={src:bte(t.url)};null!==t.alt&&void 0!==t.alt&&(n.alt=t.alt),null!==t.title&&void 0!==t.title&&(n.title=t.title);const i={type:"element",tagName:"img",properties:n,children:[]};return e.patch(t,i),e.applyData(t,i)},inlineCode:function(e,t){const n={type:"text",value:t.value.replace(/\r?\n|\r/g," ")};e.patch(t,n);const i={type:"element",tagName:"code",properties:{},children:[n]};return e.patch(t,i),e.applyData(t,i)},linkReference:function(e,t){const n=String(t.identifier).toUpperCase(),i=e.definitionById.get(n);if(!i)return Ote(e,t);const r={href:bte(i.url||"")};null!==i.title&&void 0!==i.title&&(r.title=i.title);const s={type:"element",tagName:"a",properties:r,children:e.all(t)};return e.patch(t,s),e.applyData(t,s)},link:function(e,t){const n={href:bte(t.url)};null!==t.title&&void 0!==t.title&&(n.title=t.title);const i={type:"element",tagName:"a",properties:n,children:e.all(t)};return e.patch(t,i),e.applyData(t,i)},listItem:function(e,t,n){const i=e.all(t),r=n?function(e){let t=!1;if("list"===e.type){t=e.spread||!1;const n=e.children;let i=-1;for(;!t&&++i<n.length;)t=Ite(n[i])}return t}(n):Ite(t),s={},a=[];if("boolean"===typeof t.checked){const e=i[0];let n;e&&"element"===e.type&&"p"===e.tagName?n=e:(n={type:"element",tagName:"p",properties:{},children:[]},i.unshift(n)),n.children.length>0&&n.children.unshift({type:"text",value:" "}),n.children.unshift({type:"element",tagName:"input",properties:{type:"checkbox",checked:t.checked,disabled:!0},children:[]}),s.className=["task-list-item"]}let o=-1;for(;++o<i.length;){const e=i[o];(r||0!==o||"element"!==e.type||"p"!==e.tagName)&&a.push({type:"text",value:"\n"}),"element"!==e.type||"p"!==e.tagName||r?a.push(e):a.push(...e.children)}const l=i[i.length-1];l&&(r||"element"!==l.type||"p"!==l.tagName)&&a.push({type:"text",value:"\n"});const u={type:"element",tagName:"li",properties:s,children:a};return e.patch(t,u),e.applyData(t,u)},list:function(e,t){const n={},i=e.all(t);let r=-1;for("number"===typeof t.start&&1!==t.start&&(n.start=t.start);++r<i.length;){const e=i[r];if("element"===e.type&&"li"===e.tagName&&e.properties&&Array.isArray(e.properties.className)&&e.properties.className.includes("task-list-item")){n.className=["contains-task-list"];break}}const s={type:"element",tagName:t.ordered?"ol":"ul",properties:n,children:e.wrap(i,!0)};return e.patch(t,s),e.applyData(t,s)},paragraph:function(e,t){const n={type:"element",tagName:"p",properties:{},children:e.all(t)};return e.patch(t,n),e.applyData(t,n)},root:function(e,t){const n={type:"root",children:e.wrap(e.all(t))};return e.patch(t,n),e.applyData(t,n)},strong:function(e,t){const n={type:"element",tagName:"strong",properties:{},children:e.all(t)};return e.patch(t,n),e.applyData(t,n)},table:function(e,t){const n=e.all(t),i=n.shift(),r=[];if(i){const n={type:"element",tagName:"thead",properties:{},children:e.wrap([i],!0)};e.patch(t.children[0],n),r.push(n)}if(n.length>0){const i={type:"element",tagName:"tbody",properties:{},children:e.wrap(n,!0)},s=W9(t.children[1]),a=H9(t.children[t.children.length-1]);s&&a&&(i.position={start:s,end:a}),r.push(i)}const s={type:"element",tagName:"table",properties:{},children:e.wrap(r,!0)};return e.patch(t,s),e.applyData(t,s)},tableCell:function(e,t){const n={type:"element",tagName:"td",properties:{},children:e.all(t)};return e.patch(t,n),e.applyData(t,n)},tableRow:function(e,t,n){const i=n?n.children:void 0,r=0===(i?i.indexOf(t):1)?"th":"td",s=n&&"table"===n.type?n.align:void 0,a=s?s.length:t.children.length;let o=-1;const l=[];for(;++o<a;){const n=t.children[o],i={},a=s?s[o]:void 0;a&&(i.align=a);let u={type:"element",tagName:r,properties:i,children:[]};n&&(u.children=e.all(n),e.patch(n,u),u=e.applyData(n,u)),l.push(u)}const u={type:"element",tagName:"tr",properties:{},children:e.wrap(l,!0)};return e.patch(t,u),e.applyData(t,u)},text:function(e,t){const n={type:"text",value:kte(String(t.value))};return e.patch(t,n),e.applyData(t,n)},thematicBreak:function(e,t){const n={type:"element",tagName:"hr",properties:{},children:[]};return e.patch(t,n),e.applyData(t,n)},toml:Lte,yaml:Lte,definition:Lte,footnoteDefinition:Lte};function Lte(){}const zte=["children"],Nte={}.hasOwnProperty,jte={};function Ute(e,t){e.position&&(t.position=function(e){const t=W9(e),n=H9(e);if(t&&n)return{start:t,end:n}}(e))}function Vte(e,t){let n=t;if(e&&e.data){const t=e.data.hName,i=e.data.hChildren,r=e.data.hProperties;if("string"===typeof t)if("element"===n.type)n.tagName=t;else{n={type:"element",tagName:t,properties:{},children:"children"in n?n.children:[n]}}"element"===n.type&&r&&Object.assign(n.properties,xte(r)),"children"in n&&n.children&&null!==i&&void 0!==i&&(n.children=i)}return n}function Hte(e,t){const n=t.data||{},i=!("value"in t)||Nte.call(n,"hProperties")||Nte.call(n,"hChildren")?{type:"element",tagName:"div",properties:{},children:e.all(t)}:{type:"text",value:t.value};return e.patch(t,i),e.applyData(t,i)}function Wte(e,t){const n=[];let i=-1;for(t&&n.push({type:"text",value:"\n"});++i<e.length;)i&&n.push({type:"text",value:"\n"}),n.push(e[i]);return t&&e.length>0&&n.push({type:"text",value:"\n"}),n}function Gte(e){let t=0,n=e.charCodeAt(t);for(;9===n||32===n;)t++,n=e.charCodeAt(t);return e.slice(t)}function qte(e,t){const n=function(e,t){const n=t||jte,i=new Map,r=new Map,s=new Map,a=d(d({},Rte),n.handlers),l={all:function(e){const t=[];if("children"in e){const n=e.children;let i=-1;for(;++i<n.length;){const r=l.one(n[i],e);if(r){if(i&&"break"===n[i-1].type&&(Array.isArray(r)||"text"!==r.type||(r.value=Gte(r.value)),!Array.isArray(r)&&"element"===r.type)){const e=r.children[0];e&&"text"===e.type&&(e.value=Gte(e.value))}Array.isArray(r)?t.push(...r):t.push(r)}}}return t},applyData:Vte,definitionById:i,footnoteById:r,footnoteCounts:s,footnoteOrder:[],handlers:a,one:function(e,t){const n=e.type,i=l.handlers[n];if(Nte.call(l.handlers,n)&&i)return i(l,e,t);if(l.options.passThrough&&l.options.passThrough.includes(n)){if("children"in e){const{children:t}=e,n=o(e,zte),i=xte(n);return i.children=l.all(e),i}return xte(e)}return(l.options.unknownHandler||Hte)(l,e,t)},options:n,patch:Ute,wrap:Wte};return Fte(e,(function(e){if("definition"===e.type||"footnoteDefinition"===e.type){const t="definition"===e.type?i:r,n=String(e.identifier).toUpperCase();t.has(n)||t.set(n,e)}})),l}(e,t),i=n.one(e,void 0),r=function(e){const t="string"===typeof e.options.clobberPrefix?e.options.clobberPrefix:"user-content-",n=e.options.footnoteBackContent||wte,i=e.options.footnoteBackLabel||Dte,r=e.options.footnoteLabel||"Footnotes",s=e.options.footnoteLabelTagName||"h2",a=e.options.footnoteLabelProperties||{className:["sr-only"]},o=[];let l=-1;for(;++l<e.footnoteOrder.length;){const r=e.footnoteById.get(e.footnoteOrder[l]);if(!r)continue;const s=e.all(r),a=String(r.identifier).toUpperCase(),u=bte(a.toLowerCase());let c=0;const h=[],d=e.footnoteCounts.get(a);for(;void 0!==d&&++c<=d;){h.length>0&&h.push({type:"text",value:" "});let e="string"===typeof n?n:n(l,c);"string"===typeof e&&(e={type:"text",value:e}),h.push({type:"element",tagName:"a",properties:{href:"#"+t+"fnref-"+u+(c>1?"-"+c:""),dataFootnoteBackref:"",ariaLabel:"string"===typeof i?i:i(l,c),className:["data-footnote-backref"]},children:Array.isArray(e)?e:[e]})}const p=s[s.length-1];if(p&&"element"===p.type&&"p"===p.tagName){const e=p.children[p.children.length-1];e&&"text"===e.type?e.value+=" ":p.children.push({type:"text",value:" "}),p.children.push(...h)}else s.push(...h);const f={type:"element",tagName:"li",properties:{id:t+"fn-"+u},children:e.wrap(s,!0)};e.patch(r,f),o.push(f)}if(0!==o.length)return{type:"element",tagName:"section",properties:{dataFootnotes:!0,className:["footnotes"]},children:[{type:"element",tagName:s,properties:d(d({},xte(a)),{},{id:"footnote-label"}),children:[{type:"text",value:r}]},{type:"text",value:"\n"},{type:"element",tagName:"ol",properties:{},children:e.wrap(o,!0)},{type:"text",value:"\n"}]}}(n),s=Array.isArray(i)?{type:"root",children:i}:i||{type:"root",children:[]};return r&&s.children.push({type:"text",value:"\n"},r),s}function Yte(e,t){return e&&"run"in e?async function(n,i){const r=qte(n,d({file:i},t));await e.run(r,i)}:function(n,i){return qte(n,d({file:i},e||t))}}function Xte(e){if(e)throw e}var Qte=n(240);function Kte(e){if("object"!==typeof e||null===e)return!1;const t=Object.getPrototypeOf(e);return(null===t||t===Object.prototype||null===Object.getPrototypeOf(t))&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)}function Zte(){const e=[],t={run:function(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];let r=-1;const s=n.pop();if("function"!==typeof s)throw new TypeError("Expected function as last argument, not "+s);!function t(i){const a=e[++r];let o=-1;if(i)s(i);else{for(var l=arguments.length,u=new Array(l>1?l-1:0),c=1;c<l;c++)u[c-1]=arguments[c];for(;++o<n.length;)null!==u[o]&&void 0!==u[o]||(u[o]=n[o]);n=u,a?function(e,t){let n;return r;function r(){for(var t=arguments.length,r=new Array(t),o=0;o<t;o++)r[o]=arguments[o];const l=e.length>r.length;let u;l&&r.push(s);try{u=e.apply(this,r)}catch(i){if(l&&n)throw i;return s(i)}l||(u&&u.then&&"function"===typeof u.then?u.then(a,s):u instanceof Error?s(u):a(u))}function s(e){if(!n){n=!0;for(var i=arguments.length,r=new Array(i>1?i-1:0),s=1;s<i;s++)r[s-1]=arguments[s];t(e,...r)}}function a(e){s(null,e)}}(a,t)(...u):s(null,...u)}}(null,...n)},use:function(n){if("function"!==typeof n)throw new TypeError("Expected `middelware` to be a function, not "+n);return e.push(n),t}};return t}const Jte={basename:function(e,t){if(void 0!==t&&"string"!==typeof t)throw new TypeError('"ext" argument must be a string');$te(e);let n,i=0,r=-1,s=e.length;if(void 0===t||0===t.length||t.length>e.length){for(;s--;)if(47===e.codePointAt(s)){if(n){i=s+1;break}}else r<0&&(n=!0,r=s+1);return r<0?"":e.slice(i,r)}if(t===e)return"";let a=-1,o=t.length-1;for(;s--;)if(47===e.codePointAt(s)){if(n){i=s+1;break}}else a<0&&(n=!0,a=s+1),o>-1&&(e.codePointAt(s)===t.codePointAt(o--)?o<0&&(r=s):(o=-1,r=a));i===r?r=a:r<0&&(r=e.length);return e.slice(i,r)},dirname:function(e){if($te(e),0===e.length)return".";let t,n=-1,i=e.length;for(;--i;)if(47===e.codePointAt(i)){if(t){n=i;break}}else t||(t=!0);return n<0?47===e.codePointAt(0)?"/":".":1===n&&47===e.codePointAt(0)?"//":e.slice(0,n)},extname:function(e){$te(e);let t,n=e.length,i=-1,r=0,s=-1,a=0;for(;n--;){const o=e.codePointAt(n);if(47!==o)i<0&&(t=!0,i=n+1),46===o?s<0?s=n:1!==a&&(a=1):s>-1&&(a=-1);else if(t){r=n+1;break}}if(s<0||i<0||0===a||1===a&&s===i-1&&s===r+1)return"";return e.slice(s,i)},join:function(){let e,t=-1;for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];for(;++t<i.length;)$te(i[t]),i[t]&&(e=void 0===e?i[t]:e+"/"+i[t]);return void 0===e?".":function(e){$te(e);const t=47===e.codePointAt(0);let n=function(e,t){let n,i,r="",s=0,a=-1,o=0,l=-1;for(;++l<=e.length;){if(l<e.length)n=e.codePointAt(l);else{if(47===n)break;n=47}if(47===n){if(a===l-1||1===o);else if(a!==l-1&&2===o){if(r.length<2||2!==s||46!==r.codePointAt(r.length-1)||46!==r.codePointAt(r.length-2))if(r.length>2){if(i=r.lastIndexOf("/"),i!==r.length-1){i<0?(r="",s=0):(r=r.slice(0,i),s=r.length-1-r.lastIndexOf("/")),a=l,o=0;continue}}else if(r.length>0){r="",s=0,a=l,o=0;continue}t&&(r=r.length>0?r+"/..":"..",s=2)}else r.length>0?r+="/"+e.slice(a+1,l):r=e.slice(a+1,l),s=l-a-1;a=l,o=0}else 46===n&&o>-1?o++:o=-1}return r}(e,!t);0!==n.length||t||(n=".");n.length>0&&47===e.codePointAt(e.length-1)&&(n+="/");return t?"/"+n:n}(e)},sep:"/"};function $te(e){if("string"!==typeof e)throw new TypeError("Path must be a string. Received "+JSON.stringify(e))}const ene={cwd:function(){return"/"}};function tne(e){return Boolean(null!==e&&"object"===typeof e&&"href"in e&&e.href&&"protocol"in e&&e.protocol&&void 0===e.auth)}function nne(e){if("string"===typeof e)e=new URL(e);else if(!tne(e)){const t=new TypeError('The "path" argument must be of type string or an instance of URL. Received `'+e+"`");throw t.code="ERR_INVALID_ARG_TYPE",t}if("file:"!==e.protocol){const e=new TypeError("The URL must be of scheme file");throw e.code="ERR_INVALID_URL_SCHEME",e}return function(e){if(""!==e.hostname){const e=new TypeError('File URL host must be "localhost" or empty on darwin');throw e.code="ERR_INVALID_FILE_URL_HOST",e}const t=e.pathname;let n=-1;for(;++n<t.length;)if(37===t.codePointAt(n)&&50===t.codePointAt(n+1)){const e=t.codePointAt(n+2);if(70===e||102===e){const e=new TypeError("File URL path must not include encoded / characters");throw e.code="ERR_INVALID_FILE_URL_PATH",e}}return decodeURIComponent(t)}(e)}const ine=["history","path","basename","stem","extname","dirname"];class rne{constructor(e){let t;t=e?tne(e)?{path:e}:"string"===typeof e||function(e){return Boolean(e&&"object"===typeof e&&"byteLength"in e&&"byteOffset"in e)}(e)?{value:e}:e:{},this.cwd="cwd"in t?"":ene.cwd(),this.data={},this.history=[],this.messages=[],this.value,this.map,this.result,this.stored;let n,i=-1;for(;++i<ine.length;){const e=ine[i];e in t&&void 0!==t[e]&&null!==t[e]&&(this[e]="history"===e?[...t[e]]:t[e])}for(n in t)ine.includes(n)||(this[n]=t[n])}get basename(){return"string"===typeof this.path?Jte.basename(this.path):void 0}set basename(e){ane(e,"basename"),sne(e,"basename"),this.path=Jte.join(this.dirname||"",e)}get dirname(){return"string"===typeof this.path?Jte.dirname(this.path):void 0}set dirname(e){one(this.basename,"dirname"),this.path=Jte.join(e||"",this.basename)}get extname(){return"string"===typeof this.path?Jte.extname(this.path):void 0}set extname(e){if(sne(e,"extname"),one(this.dirname,"extname"),e){if(46!==e.codePointAt(0))throw new Error("`extname` must start with `.`");if(e.includes(".",1))throw new Error("`extname` cannot contain multiple dots")}this.path=Jte.join(this.dirname,this.stem+(e||""))}get path(){return this.history[this.history.length-1]}set path(e){tne(e)&&(e=nne(e)),ane(e,"path"),this.path!==e&&this.history.push(e)}get stem(){return"string"===typeof this.path?Jte.basename(this.path,this.extname):void 0}set stem(e){ane(e,"stem"),sne(e,"stem"),this.path=Jte.join(this.dirname||"",e+(this.extname||""))}fail(e,t,n){const i=this.message(e,t,n);throw i.fatal=!0,i}info(e,t,n){const i=this.message(e,t,n);return i.fatal=void 0,i}message(e,t,n){const i=new K9(e,t,n);return this.path&&(i.name=this.path+":"+i.name,i.file=this.path),i.fatal=!1,this.messages.push(i),i}toString(e){if(void 0===this.value)return"";if("string"===typeof this.value)return this.value;return new TextDecoder(e||void 0).decode(this.value)}}function sne(e,t){if(e&&e.includes(Jte.sep))throw new Error("`"+t+"` cannot be a path: did not expect `"+Jte.sep+"`")}function ane(e,t){if(!e)throw new Error("`"+t+"` cannot be empty")}function one(e,t){if(!e)throw new Error("Setting `"+t+"` requires `path` to be set too")}const lne=function(e){const t=this.constructor.prototype,n=t[e],i=function(){return n.apply(i,arguments)};return Object.setPrototypeOf(i,t),i},une={}.hasOwnProperty;class cne extends lne{constructor(){super("copy"),this.Compiler=void 0,this.Parser=void 0,this.attachers=[],this.compiler=void 0,this.freezeIndex=-1,this.frozen=void 0,this.namespace={},this.parser=void 0,this.transformers=Zte()}copy(){const e=new cne;let t=-1;for(;++t<this.attachers.length;){const n=this.attachers[t];e.use(...n)}return e.data(Qte(!0,{},this.namespace)),e}data(e,t){return"string"===typeof e?2===arguments.length?(fne("data",this.frozen),this.namespace[e]=t,this):une.call(this.namespace,e)&&this.namespace[e]||void 0:e?(fne("data",this.frozen),this.namespace=e,this):this.namespace}freeze(){if(this.frozen)return this;const e=this;for(;++this.freezeIndex<this.attachers.length;){const[t,...n]=this.attachers[this.freezeIndex];if(!1===n[0])continue;!0===n[0]&&(n[0]=void 0);const i=t.call(e,...n);"function"===typeof i&&this.transformers.use(i)}return this.frozen=!0,this.freezeIndex=Number.POSITIVE_INFINITY,this}parse(e){this.freeze();const t=vne(e),n=this.parser||this.Parser;return dne("parse",n),n(String(t),t)}process(e,t){const n=this;return this.freeze(),dne("process",this.parser||this.Parser),pne("process",this.compiler||this.Compiler),t?i(void 0,t):new Promise(i);function i(i,r){const s=vne(e),a=n.parse(s);function o(e,n){e||!n?r(e):i?i(n):t(void 0,n)}n.run(a,s,(function(e,t,i){if(e||!t||!i)return o(e);const r=t,s=n.stringify(r,i);var a;"string"===typeof(a=s)||function(e){return Boolean(e&&"object"===typeof e&&"byteLength"in e&&"byteOffset"in e)}(a)?i.value=s:i.result=s,o(e,i)}))}}processSync(e){let t,n=!1;return this.freeze(),dne("processSync",this.parser||this.Parser),pne("processSync",this.compiler||this.Compiler),this.process(e,(function(e,i){n=!0,Xte(e),t=i})),gne("processSync","process",n),t}run(e,t,n){mne(e),this.freeze();const i=this.transformers;return n||"function"!==typeof t||(n=t,t=void 0),n?r(void 0,n):new Promise(r);function r(r,s){const a=vne(t);i.run(e,a,(function(t,i,a){const o=i||e;t?s(t):r?r(o):n(void 0,o,a)}))}}runSync(e,t){let n,i=!1;return this.run(e,t,(function(e,t){Xte(e),n=t,i=!0})),gne("runSync","run",i),n}stringify(e,t){this.freeze();const n=vne(t),i=this.compiler||this.Compiler;return pne("stringify",i),mne(e),i(e,n)}use(e){const t=this.attachers,n=this.namespace;if(fne("use",this.frozen),null===e||void 0===e);else if("function"===typeof e){for(var i=arguments.length,r=new Array(i>1?i-1:0),s=1;s<i;s++)r[s-1]=arguments[s];u(e,r)}else{if("object"!==typeof e)throw new TypeError("Expected usable value, not `"+e+"`");Array.isArray(e)?l(e):o(e)}return this;function a(e){if("function"===typeof e)u(e,[]);else{if("object"!==typeof e)throw new TypeError("Expected usable value, not `"+e+"`");if(Array.isArray(e)){const[t,...n]=e;u(t,n)}else o(e)}}function o(e){if(!("plugins"in e)&&!("settings"in e))throw new Error("Expected usable value but received an empty preset, which is probably a mistake: presets typically come with `plugins` and sometimes with `settings`, but this has neither");l(e.plugins),e.settings&&(n.settings=Qte(!0,n.settings,e.settings))}function l(e){let t=-1;if(null===e||void 0===e);else{if(!Array.isArray(e))throw new TypeError("Expected a list of plugins, not `"+e+"`");for(;++t<e.length;){a(e[t])}}}function u(e,n){let i=-1,r=-1;for(;++i<t.length;)if(t[i][0]===e){r=i;break}if(-1===r)t.push([e,...n]);else if(n.length>0){let[i,...s]=n;const a=t[r][1];Kte(a)&&Kte(i)&&(i=Qte(!0,a,i)),t[r]=[e,i,...s]}}}}const hne=(new cne).freeze();function dne(e,t){if("function"!==typeof t)throw new TypeError("Cannot `"+e+"` without `parser`")}function pne(e,t){if("function"!==typeof t)throw new TypeError("Cannot `"+e+"` without `compiler`")}function fne(e,t){if(t)throw new Error("Cannot call `"+e+"` on a frozen processor.\nCreate a new processor first, by calling it: use `processor()` instead of `processor`.")}function mne(e){if(!Kte(e)||"string"!==typeof e.type)throw new TypeError("Expected node, got `"+e+"`")}function gne(e,t,n){if(!n)throw new Error("`"+e+"` finished async. Use `"+t+"` instead")}function vne(e){return function(e){return Boolean(e&&"object"===typeof e&&"message"in e&&"messages"in e)}(e)?e:new rne(e)}const yne=[],xne={allowDangerousHtml:!0},bne=/^(https?|ircs?|mailto|xmpp)$/i,wne=[{from:"astPlugins",id:"remove-buggy-html-in-markdown-parser"},{from:"allowDangerousHtml",id:"remove-buggy-html-in-markdown-parser"},{from:"allowNode",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"allowElement"},{from:"allowedTypes",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"allowedElements"},{from:"disallowedTypes",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"disallowedElements"},{from:"escapeHtml",id:"remove-buggy-html-in-markdown-parser"},{from:"includeElementIndex",id:"#remove-includeelementindex"},{from:"includeNodeIndex",id:"change-includenodeindex-to-includeelementindex"},{from:"linkTarget",id:"remove-linktarget"},{from:"plugins",id:"change-plugins-to-remarkplugins",to:"remarkPlugins"},{from:"rawSourcePos",id:"#remove-rawsourcepos"},{from:"renderers",id:"change-renderers-to-components",to:"components"},{from:"source",id:"change-source-to-children",to:"children"},{from:"sourcePos",id:"#remove-sourcepos"},{from:"transformImageUri",id:"#add-urltransform",to:"urlTransform"},{from:"transformLinkUri",id:"#add-urltransform",to:"urlTransform"}];function Dne(e){const t=e.allowedElements,n=e.allowElement,i=e.children||"",r=e.className,s=e.components,a=e.disallowedElements,o=e.rehypePlugins||yne,l=e.remarkPlugins||yne,u=e.remarkRehypeOptions?d(d({},e.remarkRehypeOptions),xne):xne,c=e.skipHtml,h=e.unwrapDisallowed,p=e.urlTransform||_ne,f=hne().use(cte).use(l).use(Yte,u).use(o),m=new rne;"string"===typeof i&&(m.value=i);for(const d of wne)Object.hasOwn(e,d.from)&&(d.from,d.to&&d.to,d.id);const g=f.parse(m);let v=f.runSync(g,m);return r&&(v={type:"element",tagName:"div",properties:{className:r},children:"root"===v.type?v.children:[v]}),Fte(v,(function(e,i,r){if("raw"===e.type&&r&&"number"===typeof i)return c?r.children.splice(i,1):r.children[i]={type:"text",value:e.value},i;if("element"===e.type){let t;for(t in m7)if(Object.hasOwn(m7,t)&&Object.hasOwn(e.properties,t)){const n=e.properties[t],i=m7[t];(null===i||i.includes(e.tagName))&&(e.properties[t]=p(String(n||""),t,e))}}if("element"===e.type){let s=t?!t.includes(e.tagName):!!a&&a.includes(e.tagName);if(!s&&n&&"number"===typeof i&&(s=!n(e,i,r)),s&&r&&"number"===typeof i)return h&&e.children?r.children.splice(i,1,...e.children):r.children.splice(i,1),i}})),r7(v,{Fragment:lo.Fragment,components:s,ignoreInvalidStyle:!0,jsx:lo.jsx,jsxs:lo.jsxs,passKeys:!0,passNode:!0})}function _ne(e){const t=e.indexOf(":"),n=e.indexOf("?"),i=e.indexOf("#"),r=e.indexOf("/");return-1===t||-1!==r&&t>r||-1!==n&&t>n||-1!==i&&t>i||bne.test(e.slice(0,t))?e:""}const Sne=function(){const[e,t]=(0,r.useState)([]),[n,i]=(0,r.useState)("Trending Food Items in India"),[s,a]=(0,r.useState)(!1),o=async()=>{if(n.trim()){const s=[...e,{text:n,user:!0}];t(s),i("");try{a(!0);const e=await e9.post("https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash-latest:generateContent?key=AIzaSyBHSqIYcjAu1IfQfbT7W2-shVsu2vkwx1M",{contents:[{parts:[{text:n}]}]});console.log(e);const i=e.data.candidates[0].content.parts[0].text;a(!1),t([...s,{text:i,user:!1}])}catch(r){console.error("Error sending message:",r),a(!1),t([...s,{text:"Error: Could not get response from AI",user:!1}])}}};return(0,lo.jsxs)("div",{className:"flex flex-col justify-center items-center min-h-screen bg-gray-800",children:[(0,lo.jsx)("h1",{className:"mb-8 font-bold text-[3rem] drop-shadow-lg text-blue-50",children:"AI ChatBot"}),(0,lo.jsxs)("div",{className:"bg-gray-100 w-full max-w-lg shadow-xl rounded-lg overflow-hidden",children:[(0,lo.jsx)("div",{className:"p-4 h-96 overflow-y-auto",children:e.map(((e,t)=>(0,lo.jsx)("div",{className:"flex ".concat(e.user?"justify-end":"justify-start"," mb-2"),children:(0,lo.jsx)("div",{className:"rounded-lg p-2 shadow-md overflow-x-hidden flex flex-wrap ".concat(e.user?"bg-blue-500 text-white":"bg-gray-200"),children:(0,lo.jsx)(Dne,{children:e.text})})},t)))}),(0,lo.jsxs)("div",{className:"p-4 border-t border-gray-200 flex",children:[(0,lo.jsx)("input",{type:"text",className:"flex-1 p-2 border border-gray-300 rounded-lg outline-none",placeholder:"Type your message...",value:n,onChange:e=>i(e.target.value),onKeyPress:e=>"Enter"===e.key&&o()}),(0,lo.jsx)("button",{className:"ml-2 bg-blue-500 text-white p-2 rounded-lg hover:bg-blue-600 transition-all",onClick:o,children:(0,lo.jsx)(T5,{})})]})]})]})},Ene=e=>{let{imageUrl:t,name:n,price:i}=e;const[s,a]=(0,r.useState)(!1),[o]=(0,r.useState)(!0);return(0,lo.jsx)("div",{className:"max-w-2xl mx-auto bg-white rounded-lg shadow-md overflow-hidden",children:(0,lo.jsxs)("div",{className:"flex",children:[(0,lo.jsx)("div",{className:"w-1/3",children:(0,lo.jsx)("img",{src:t,alt:n,className:"w-full h-full object-cover"})}),(0,lo.jsxs)("div",{className:"w-2/3 p-6",children:[(0,lo.jsxs)("div",{className:"flex justify-between items-start mb-4",children:[(0,lo.jsxs)("div",{children:[(0,lo.jsx)("h2",{className:"text-xl font-semibold text-gray-800",children:n}),(0,lo.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:"Delicious and freshly prepared"})]}),(0,lo.jsx)("span",{className:"px-3 py-1 rounded-full text-sm ".concat(o?"bg-green-100 text-green-800":"bg-red-100 text-red-800"),children:o?"Available":"Not Available"})]}),(0,lo.jsxs)("div",{className:"text-2xl font-bold text-gray-900 mb-4",children:["$",i]}),(0,lo.jsx)("div",{className:"space-y-3",children:s?(0,lo.jsxs)("div",{className:"space-y-3",children:[(0,lo.jsx)("button",{className:"w-full bg-green-600 text-white py-2 px-4 rounded-lg hover:bg-green-700 transition duration-200",children:"Canteen Card"}),(0,lo.jsx)("button",{className:"w-full bg-purple-600 text-white py-2 px-4 rounded-lg hover:bg-purple-700 transition duration-200",children:"Other Payment"}),(0,lo.jsx)("button",{onClick:()=>a(!1),className:"w-full bg-gray-200 text-gray-800 py-2 px-4 rounded-lg hover:bg-gray-300 transition duration-200",children:"Cancel"})]}):(0,lo.jsx)("button",{onClick:()=>a(!0),className:"w-full bg-blue-600 text-white py-2 px-4 rounded-lg hover:bg-blue-700 transition duration-200",disabled:!o,children:"Order Now"})})]})]})})},Cne=()=>{const[e,t]=(0,r.useState)(""),[n,i]=(0,r.useState)(""),[s,a]=(0,r.useState)(""),o=[{imageUrl:"https://images.pexels.com/photos/918581/pexels-photo-918581.jpeg?auto=compress&cs=tinysrgb&w=400",name:"Burger",price:12.99},{imageUrl:"https://images.pexels.com/photos/845798/pexels-photo-845798.jpeg?auto=compress&cs=tinysrgb&w=400",name:"Pizza",price:15.99},{imageUrl:"https://images.pexels.com/photos/3214160/pexels-photo-3214160.jpeg?auto=compress&cs=tinysrgb&w=400",name:"Pasta",price:10.49},{imageUrl:"https://images.pexels.com/photos/257816/pexels-photo-257816.jpeg?auto=compress&cs=tinysrgb&w=400",name:"Salad",price:8.99},{imageUrl:"https://images.pexels.com/photos/1854665/pexels-photo-1854665.jpeg?auto=compress&cs=tinysrgb&w=400",name:"Sushi",price:18.99},{imageUrl:"https://images.pexels.com/photos/361184/asparagus-steak-veal-steak-veal-361184.jpeg?auto=compress&cs=tinysrgb&w=400",name:"Steak",price:22.99},{imageUrl:"https://images.pexels.com/photos/1647163/pexels-photo-1647163.jpeg?auto=compress&cs=tinysrgb&w=400",name:"Sandwich",price:7.99},{imageUrl:"https://images.pexels.com/photos/7613568/pexels-photo-7613568.jpeg?auto=compress&cs=tinysrgb&w=400",name:"Taco",price:5.99},{imageUrl:"https://images.pexels.com/photos/1625235/pexels-photo-1625235.jpeg?auto=compress&cs=tinysrgb&w=400",name:"Ice Cream",price:4.49},{imageUrl:"https://images.pexels.com/photos/1893555/pexels-photo-1893555.jpeg?auto=compress&cs=tinysrgb&w=400",name:"Fries",price:3.99},{imageUrl:"https://images.pexels.com/photos/4518656/pexels-photo-4518656.jpeg?auto=compress&cs=tinysrgb&w=400",name:"Hot Dog",price:6.49},{imageUrl:"https://images.pexels.com/photos/3728295/pexels-photo-3728295.jpeg?auto=compress&cs=tinysrgb&w=400",name:"Dumplings",price:8.49},{imageUrl:"https://images.pexels.com/photos/2347311/pexels-photo-2347311.jpeg?auto=compress&cs=tinysrgb&w=400",name:"Noodles",price:10.99},{imageUrl:"https://images.pexels.com/photos/775030/pexels-photo-775030.jpeg?auto=compress&cs=tinysrgb&w=400",name:"Smoothie",price:5.49}].filter((t=>{const i=t.name.toLowerCase().includes(e.toLowerCase());let r=!0;if(n&&s){const e=parseFloat(t.price),i=parseFloat(s);"less"===n&&e>=i&&(r=!1),"greater"===n&&e<=i&&(r=!1),"equal"===n&&e!==i&&(r=!1)}return i&&r}));return(0,lo.jsxs)("div",{className:"p-6 max-w-4xl mx-auto",children:[(0,lo.jsxs)("div",{className:"flex flex-col md:flex-row md:items-center md:space-x-4 mb-6",children:[(0,lo.jsx)("input",{type:"text",placeholder:"Search food...",value:e,onChange:e=>t(e.target.value),className:"p-2 border border-gray-300 rounded-lg w-full md:w-1/3 focus:outline-none focus:ring-2 focus:ring-blue-400"}),(0,lo.jsxs)("select",{value:n,onChange:e=>i(e.target.value),className:"p-2 border border-gray-300 rounded-lg w-full md:w-1/4 focus:outline-none focus:ring-2 focus:ring-blue-400",children:[(0,lo.jsx)("option",{value:"",children:"Filter by price"}),(0,lo.jsx)("option",{value:"less",children:"Less than"}),(0,lo.jsx)("option",{value:"greater",children:"Greater than"}),(0,lo.jsx)("option",{value:"equal",children:"Equal to"})]}),(0,lo.jsx)("input",{type:"number",placeholder:"Enter price",value:s,onChange:e=>a(e.target.value),className:"p-2 border border-gray-300 rounded-lg w-full md:w-1/4 focus:outline-none focus:ring-2 focus:ring-blue-400"})]}),(0,lo.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:o.length>0?o.map(((e,t)=>(0,lo.jsx)(Ene,{imageUrl:e.imageUrl,name:e.name,price:e.price},t))):(0,lo.jsx)("p",{className:"text-gray-600",children:"No matching food items found."})})]})},Ane="Tom Cook",Mne="tom@example.com",Tne="https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=facearea&facepad=2&w=256&h=256&q=80",Pne=[{name:"Dashboard",href:"dashboard",current:!1},{name:"Menu",href:"ai",current:!0},{name:"Orders",href:"users",current:!1},{name:"Analytics",href:"analytics",current:!1}],Fne=[{name:"Your Profile",href:"#"},{name:"Settings",href:"#"},{name:"Sign out",href:"#"}];function One(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.filter(Boolean).join(" ")}function Ine(){return(0,lo.jsx)(lo.Fragment,{children:(0,lo.jsxs)("div",{className:"min-h-full",children:[(0,lo.jsxs)(yi,{as:"nav",className:"bg-gray-800",children:[(0,lo.jsx)("div",{className:"mx-auto max-w-7xl",children:(0,lo.jsxs)("div",{className:"flex h-16 items-center justify-between",children:[(0,lo.jsxs)("div",{className:"flex items-center",children:[(0,lo.jsx)("div",{className:"shrink-0",children:(0,lo.jsx)("img",{alt:"Your Company",src:"https://tailwindui.com/plus/img/logos/mark.svg?color=indigo&shade=500",className:"size-8"})}),(0,lo.jsx)("div",{className:"hidden md:block",children:(0,lo.jsx)("div",{className:"ml-10 flex items-baseline space-x-4",children:Pne.map((e=>(0,lo.jsx)("a",{href:e.href,"aria-current":e.current?"page":void 0,className:One(e.current?"bg-gray-900 text-white":"text-gray-300 hover:bg-gray-700 hover:text-white","rounded-md px-3 py-2 text-sm font-medium"),children:e.name},e.name)))})})]}),(0,lo.jsx)("div",{className:"hidden md:block",children:(0,lo.jsxs)("div",{className:"ml-4 flex items-center md:ml-6",children:[(0,lo.jsxs)("button",{type:"button",className:"relative rounded-full bg-gray-800 p-1 text-gray-400 hover:text-white focus:outline-none focus:ring-2 focus:ring-white focus:ring-offset-2 focus:ring-offset-gray-800",children:[(0,lo.jsx)("span",{className:"absolute -inset-1.5"}),(0,lo.jsx)("span",{className:"sr-only",children:"View notifications"}),(0,lo.jsx)(to,{"aria-hidden":"true",className:"size-6"})]}),(0,lo.jsxs)(Ja,{as:"div",className:"relative ml-3",children:[(0,lo.jsx)("div",{children:(0,lo.jsxs)(qa,{className:"relative flex max-w-xs items-center rounded-full bg-gray-800 text-sm focus:outline-none focus:ring-2 focus:ring-white focus:ring-offset-2 focus:ring-offset-gray-800",children:[(0,lo.jsx)("span",{className:"absolute -inset-1.5"}),(0,lo.jsx)("span",{className:"sr-only",children:"Open user menu"}),(0,lo.jsx)("img",{alt:"",src:Tne,className:"size-8 rounded-full"})]})}),(0,lo.jsx)(Ya,{transition:!0,className:"absolute right-0 z-10 mt-2 w-48 origin-top-right rounded-md bg-white py-1 shadow-lg ring-1 ring-black/5 transition focus:outline-none data-[closed]:scale-95 data-[closed]:transform data-[closed]:opacity-0 data-[enter]:duration-100 data-[leave]:duration-75 data-[enter]:ease-out data-[leave]:ease-in",children:Fne.map((e=>(0,lo.jsx)(Xa,{children:(0,lo.jsx)("a",{href:e.href,className:"block px-4 py-2 text-sm text-gray-700 data-[focus]:bg-gray-100 data-[focus]:outline-none",children:e.name})},e.name)))})]})]})}),(0,lo.jsx)("div",{className:"-mr-2 flex md:hidden",children:(0,lo.jsxs)(gi,{className:"group relative inline-flex items-center justify-center rounded-md bg-gray-800 p-2 text-gray-400 hover:bg-gray-700 hover:text-white focus:outline-none focus:ring-2 focus:ring-white focus:ring-offset-2 focus:ring-offset-gray-800",children:[(0,lo.jsx)("span",{className:"absolute -inset-0.5"}),(0,lo.jsx)("span",{className:"sr-only",children:"Open main menu"}),(0,lo.jsx)(ro,{"aria-hidden":"true",className:"block size-6 group-data-[open]:hidden"}),(0,lo.jsx)(oo,{"aria-hidden":"true",className:"hidden size-6 group-data-[open]:block"})]})})]})}),(0,lo.jsxs)(vi,{className:"md:hidden",children:[(0,lo.jsx)("div",{className:"space-y-1 px-2 pb-3 pt-2 sm:px-3",children:Pne.map((e=>(0,lo.jsx)(gi,{as:"a",href:e.href,"aria-current":e.current?"page":void 0,className:One(e.current?"bg-gray-900 text-white":"text-gray-300 hover:bg-gray-700 hover:text-white","block rounded-md px-3 py-2 text-base font-medium"),children:e.name},e.name)))}),(0,lo.jsxs)("div",{className:"border-t border-gray-700 pb-3 pt-4",children:[(0,lo.jsxs)("div",{className:"flex items-center px-5",children:[(0,lo.jsx)("div",{className:"shrink-0",children:(0,lo.jsx)("img",{alt:"",src:Tne,className:"size-10 rounded-full"})}),(0,lo.jsxs)("div",{className:"ml-3",children:[(0,lo.jsx)("div",{className:"text-base/5 font-medium text-white",children:Ane}),(0,lo.jsx)("div",{className:"text-sm font-medium text-gray-400",children:Mne})]}),(0,lo.jsxs)("button",{type:"button",className:"relative ml-auto shrink-0 rounded-full bg-gray-800 p-1 text-gray-400 hover:text-white focus:outline-none focus:ring-2 focus:ring-white focus:ring-offset-2 focus:ring-offset-gray-800",children:[(0,lo.jsx)("span",{className:"absolute -inset-1.5"}),(0,lo.jsx)("span",{className:"sr-only",children:"View notifications"}),(0,lo.jsx)(to,{"aria-hidden":"true",className:"size-6"})]})]}),(0,lo.jsx)("div",{className:"mt-3 space-y-1 px-2",children:Fne.map((e=>(0,lo.jsx)(gi,{as:"a",href:e.href,className:"block rounded-md px-3 py-2 text-base font-medium text-gray-400 hover:bg-gray-700 hover:text-white",children:e.name},e.name)))})]})]})]}),(0,lo.jsx)("header",{className:"bg-white shadow",children:(0,lo.jsx)("div",{className:"mx-auto max-w-7xl px-4 py-6 sm:px-6 lg:px-8",children:(0,lo.jsx)("h1",{className:"text-3xl font-bold tracking-tight text-gray-900",children:"Browse Our Menu"})})}),(0,lo.jsx)("main",{className:"bg-cover bg-center",style:{backgroundImage:"url('https://img.freepik.com/free-vector/evening-fog-tops-trees-pine-forest_1284-27059.jpg')"},children:(0,lo.jsx)("div",{className:"mx-auto py-12 px-4 sm:px-6 lg:px-8",children:(0,lo.jsx)(Cne,{})})})]})})}function kne(e){return e+.5|0}const Bne=(e,t,n)=>Math.max(Math.min(e,n),t);function Rne(e){return Bne(kne(2.55*e),0,255)}function Lne(e){return Bne(kne(255*e),0,255)}function zne(e){return Bne(kne(e/2.55)/100,0,1)}function Nne(e){return Bne(kne(100*e),0,100)}const jne={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15,a:10,b:11,c:12,d:13,e:14,f:15},Une=[..."0123456789ABCDEF"],Vne=e=>Une[15&e],Hne=e=>Une[(240&e)>>4]+Une[15&e],Wne=e=>(240&e)>>4===(15&e);function Gne(e){var t=(e=>Wne(e.r)&&Wne(e.g)&&Wne(e.b)&&Wne(e.a))(e)?Vne:Hne;return e?"#"+t(e.r)+t(e.g)+t(e.b)+((e,t)=>e<255?t(e):"")(e.a,t):void 0}const qne=/^(hsla?|hwb|hsv)\(\s*([-+.e\d]+)(?:deg)?[\s,]+([-+.e\d]+)%[\s,]+([-+.e\d]+)%(?:[\s,]+([-+.e\d]+)(%)?)?\s*\)$/;function Yne(e,t,n){const i=t*Math.min(n,1-n),r=function(t){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(t+e/30)%12;return n-i*Math.max(Math.min(r-3,9-r,1),-1)};return[r(0),r(8),r(4)]}function Xne(e,t,n){const i=function(i){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(i+e/60)%6;return n-n*t*Math.max(Math.min(r,4-r,1),0)};return[i(5),i(3),i(1)]}function Qne(e,t,n){const i=Yne(e,1,.5);let r;for(t+n>1&&(r=1/(t+n),t*=r,n*=r),r=0;r<3;r++)i[r]*=1-t-n,i[r]+=t;return i}function Kne(e){const t=e.r/255,n=e.g/255,i=e.b/255,r=Math.max(t,n,i),s=Math.min(t,n,i),a=(r+s)/2;let o,l,u;return r!==s&&(u=r-s,l=a>.5?u/(2-r-s):u/(r+s),o=function(e,t,n,i,r){return e===r?(t-n)/i+(t<n?6:0):t===r?(n-e)/i+2:(e-t)/i+4}(t,n,i,u,r),o=60*o+.5),[0|o,l||0,a]}function Zne(e,t,n,i){return(Array.isArray(t)?e(t[0],t[1],t[2]):e(t,n,i)).map(Lne)}function Jne(e,t,n){return Zne(Yne,e,t,n)}function $ne(e){return(e%360+360)%360}function eie(e){const t=qne.exec(e);let n,i=255;if(!t)return;t[5]!==n&&(i=t[6]?Rne(+t[5]):Lne(+t[5]));const r=$ne(+t[2]),s=+t[3]/100,a=+t[4]/100;return n="hwb"===t[1]?function(e,t,n){return Zne(Qne,e,t,n)}(r,s,a):"hsv"===t[1]?function(e,t,n){return Zne(Xne,e,t,n)}(r,s,a):Jne(r,s,a),{r:n[0],g:n[1],b:n[2],a:i}}const tie={x:"dark",Z:"light",Y:"re",X:"blu",W:"gr",V:"medium",U:"slate",A:"ee",T:"ol",S:"or",B:"ra",C:"lateg",D:"ights",R:"in",Q:"turquois",E:"hi",P:"ro",O:"al",N:"le",M:"de",L:"yello",F:"en",K:"ch",G:"arks",H:"ea",I:"ightg",J:"wh"},nie={OiceXe:"f0f8ff",antiquewEte:"faebd7",aqua:"ffff",aquamarRe:"7fffd4",azuY:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"0",blanKedOmond:"ffebcd",Xe:"ff",XeviTet:"8a2be2",bPwn:"a52a2a",burlywood:"deb887",caMtXe:"5f9ea0",KartYuse:"7fff00",KocTate:"d2691e",cSO:"ff7f50",cSnflowerXe:"6495ed",cSnsilk:"fff8dc",crimson:"dc143c",cyan:"ffff",xXe:"8b",xcyan:"8b8b",xgTMnPd:"b8860b",xWay:"a9a9a9",xgYF:"6400",xgYy:"a9a9a9",xkhaki:"bdb76b",xmagFta:"8b008b",xTivegYF:"556b2f",xSange:"ff8c00",xScEd:"9932cc",xYd:"8b0000",xsOmon:"e9967a",xsHgYF:"8fbc8f",xUXe:"483d8b",xUWay:"2f4f4f",xUgYy:"2f4f4f",xQe:"ced1",xviTet:"9400d3",dAppRk:"ff1493",dApskyXe:"bfff",dimWay:"696969",dimgYy:"696969",dodgerXe:"1e90ff",fiYbrick:"b22222",flSOwEte:"fffaf0",foYstWAn:"228b22",fuKsia:"ff00ff",gaRsbSo:"dcdcdc",ghostwEte:"f8f8ff",gTd:"ffd700",gTMnPd:"daa520",Way:"808080",gYF:"8000",gYFLw:"adff2f",gYy:"808080",honeyMw:"f0fff0",hotpRk:"ff69b4",RdianYd:"cd5c5c",Rdigo:"4b0082",ivSy:"fffff0",khaki:"f0e68c",lavFMr:"e6e6fa",lavFMrXsh:"fff0f5",lawngYF:"7cfc00",NmoncEffon:"fffacd",ZXe:"add8e6",ZcSO:"f08080",Zcyan:"e0ffff",ZgTMnPdLw:"fafad2",ZWay:"d3d3d3",ZgYF:"90ee90",ZgYy:"d3d3d3",ZpRk:"ffb6c1",ZsOmon:"ffa07a",ZsHgYF:"20b2aa",ZskyXe:"87cefa",ZUWay:"778899",ZUgYy:"778899",ZstAlXe:"b0c4de",ZLw:"ffffe0",lime:"ff00",limegYF:"32cd32",lRF:"faf0e6",magFta:"ff00ff",maPon:"800000",VaquamarRe:"66cdaa",VXe:"cd",VScEd:"ba55d3",VpurpN:"9370db",VsHgYF:"3cb371",VUXe:"7b68ee",VsprRggYF:"fa9a",VQe:"48d1cc",VviTetYd:"c71585",midnightXe:"191970",mRtcYam:"f5fffa",mistyPse:"ffe4e1",moccasR:"ffe4b5",navajowEte:"ffdead",navy:"80",Tdlace:"fdf5e6",Tive:"808000",TivedBb:"6b8e23",Sange:"ffa500",SangeYd:"ff4500",ScEd:"da70d6",pOegTMnPd:"eee8aa",pOegYF:"98fb98",pOeQe:"afeeee",pOeviTetYd:"db7093",papayawEp:"ffefd5",pHKpuff:"ffdab9",peru:"cd853f",pRk:"ffc0cb",plum:"dda0dd",powMrXe:"b0e0e6",purpN:"800080",YbeccapurpN:"663399",Yd:"ff0000",Psybrown:"bc8f8f",PyOXe:"4169e1",saddNbPwn:"8b4513",sOmon:"fa8072",sandybPwn:"f4a460",sHgYF:"2e8b57",sHshell:"fff5ee",siFna:"a0522d",silver:"c0c0c0",skyXe:"87ceeb",UXe:"6a5acd",UWay:"708090",UgYy:"708090",snow:"fffafa",sprRggYF:"ff7f",stAlXe:"4682b4",tan:"d2b48c",teO:"8080",tEstN:"d8bfd8",tomato:"ff6347",Qe:"40e0d0",viTet:"ee82ee",JHt:"f5deb3",wEte:"ffffff",wEtesmoke:"f5f5f5",Lw:"ffff00",LwgYF:"9acd32"};let iie;function rie(e){iie||(iie=function(){const e={},t=Object.keys(nie),n=Object.keys(tie);let i,r,s,a,o;for(i=0;i<t.length;i++){for(a=o=t[i],r=0;r<n.length;r++)s=n[r],o=o.replace(s,tie[s]);s=parseInt(nie[a],16),e[o]=[s>>16&255,s>>8&255,255&s]}return e}(),iie.transparent=[0,0,0,0]);const t=iie[e.toLowerCase()];return t&&{r:t[0],g:t[1],b:t[2],a:4===t.length?t[3]:255}}const sie=/^rgba?\(\s*([-+.\d]+)(%)?[\s,]+([-+.e\d]+)(%)?[\s,]+([-+.e\d]+)(%)?(?:[\s,/]+([-+.e\d]+)(%)?)?\s*\)$/;const aie=e=>e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055,oie=e=>e<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4);function lie(e,t,n){if(e){let i=Kne(e);i[t]=Math.max(0,Math.min(i[t]+i[t]*n,0===t?360:1)),i=Jne(i),e.r=i[0],e.g=i[1],e.b=i[2]}}function uie(e,t){return e?Object.assign(t||{},e):e}function cie(e){var t={r:0,g:0,b:0,a:255};return Array.isArray(e)?e.length>=3&&(t={r:e[0],g:e[1],b:e[2],a:255},e.length>3&&(t.a=Lne(e[3]))):(t=uie(e,{r:0,g:0,b:0,a:1})).a=Lne(t.a),t}function hie(e){return"r"===e.charAt(0)?function(e){const t=sie.exec(e);let n,i,r,s=255;if(t){if(t[7]!==n){const e=+t[7];s=t[8]?Rne(e):Bne(255*e,0,255)}return n=+t[1],i=+t[3],r=+t[5],n=255&(t[2]?Rne(n):Bne(n,0,255)),i=255&(t[4]?Rne(i):Bne(i,0,255)),r=255&(t[6]?Rne(r):Bne(r,0,255)),{r:n,g:i,b:r,a:s}}}(e):eie(e)}class die{constructor(e){if(e instanceof die)return e;const t=typeof e;let n;"object"===t?n=cie(e):"string"===t&&(n=function(e){var t,n=e.length;return"#"===e[0]&&(4===n||5===n?t={r:255&17*jne[e[1]],g:255&17*jne[e[2]],b:255&17*jne[e[3]],a:5===n?17*jne[e[4]]:255}:7!==n&&9!==n||(t={r:jne[e[1]]<<4|jne[e[2]],g:jne[e[3]]<<4|jne[e[4]],b:jne[e[5]]<<4|jne[e[6]],a:9===n?jne[e[7]]<<4|jne[e[8]]:255})),t}(e)||rie(e)||hie(e)),this._rgb=n,this._valid=!!n}get valid(){return this._valid}get rgb(){var e=uie(this._rgb);return e&&(e.a=zne(e.a)),e}set rgb(e){this._rgb=cie(e)}rgbString(){return this._valid?function(e){return e&&(e.a<255?"rgba(".concat(e.r,", ").concat(e.g,", ").concat(e.b,", ").concat(zne(e.a),")"):"rgb(".concat(e.r,", ").concat(e.g,", ").concat(e.b,")"))}(this._rgb):void 0}hexString(){return this._valid?Gne(this._rgb):void 0}hslString(){return this._valid?function(e){if(!e)return;const t=Kne(e),n=t[0],i=Nne(t[1]),r=Nne(t[2]);return e.a<255?"hsla(".concat(n,", ").concat(i,"%, ").concat(r,"%, ").concat(zne(e.a),")"):"hsl(".concat(n,", ").concat(i,"%, ").concat(r,"%)")}(this._rgb):void 0}mix(e,t){if(e){const n=this.rgb,i=e.rgb;let r;const s=t===r?.5:t,a=2*s-1,o=n.a-i.a,l=((a*o===-1?a:(a+o)/(1+a*o))+1)/2;r=1-l,n.r=255&l*n.r+r*i.r+.5,n.g=255&l*n.g+r*i.g+.5,n.b=255&l*n.b+r*i.b+.5,n.a=s*n.a+(1-s)*i.a,this.rgb=n}return this}interpolate(e,t){return e&&(this._rgb=function(e,t,n){const i=oie(zne(e.r)),r=oie(zne(e.g)),s=oie(zne(e.b));return{r:Lne(aie(i+n*(oie(zne(t.r))-i))),g:Lne(aie(r+n*(oie(zne(t.g))-r))),b:Lne(aie(s+n*(oie(zne(t.b))-s))),a:e.a+n*(t.a-e.a)}}(this._rgb,e._rgb,t)),this}clone(){return new die(this.rgb)}alpha(e){return this._rgb.a=Lne(e),this}clearer(e){return this._rgb.a*=1-e,this}greyscale(){const e=this._rgb,t=kne(.3*e.r+.59*e.g+.11*e.b);return e.r=e.g=e.b=t,this}opaquer(e){return this._rgb.a*=1+e,this}negate(){const e=this._rgb;return e.r=255-e.r,e.g=255-e.g,e.b=255-e.b,this}lighten(e){return lie(this._rgb,2,e),this}darken(e){return lie(this._rgb,2,-e),this}saturate(e){return lie(this._rgb,1,e),this}desaturate(e){return lie(this._rgb,1,-e),this}rotate(e){return function(e,t){var n=Kne(e);n[0]=$ne(n[0]+t),n=Jne(n),e.r=n[0],e.g=n[1],e.b=n[2]}(this._rgb,e),this}}function pie(){}const fie=(()=>{let e=0;return()=>e++})();function mie(e){return null===e||void 0===e}function gie(e){if(Array.isArray&&Array.isArray(e))return!0;const t=Object.prototype.toString.call(e);return"[object"===t.slice(0,7)&&"Array]"===t.slice(-6)}function vie(e){return null!==e&&"[object Object]"===Object.prototype.toString.call(e)}function yie(e){return("number"===typeof e||e instanceof Number)&&isFinite(+e)}function xie(e,t){return yie(e)?e:t}function bie(e,t){return"undefined"===typeof e?t:e}const wie=(e,t)=>"string"===typeof e&&e.endsWith("%")?parseFloat(e)/100*t:+e;function Die(e,t,n){if(e&&"function"===typeof e.call)return e.apply(n,t)}function _ie(e,t,n,i){let r,s,a;if(gie(e))if(s=e.length,i)for(r=s-1;r>=0;r--)t.call(n,e[r],r);else for(r=0;r<s;r++)t.call(n,e[r],r);else if(vie(e))for(a=Object.keys(e),s=a.length,r=0;r<s;r++)t.call(n,e[a[r]],a[r])}function Sie(e,t){let n,i,r,s;if(!e||!t||e.length!==t.length)return!1;for(n=0,i=e.length;n<i;++n)if(r=e[n],s=t[n],r.datasetIndex!==s.datasetIndex||r.index!==s.index)return!1;return!0}function Eie(e){if(gie(e))return e.map(Eie);if(vie(e)){const t=Object.create(null),n=Object.keys(e),i=n.length;let r=0;for(;r<i;++r)t[n[r]]=Eie(e[n[r]]);return t}return e}function Cie(e){return-1===["__proto__","prototype","constructor"].indexOf(e)}function Aie(e,t,n,i){if(!Cie(e))return;const r=t[e],s=n[e];vie(r)&&vie(s)?Mie(r,s,i):t[e]=Eie(s)}function Mie(e,t,n){const i=gie(t)?t:[t],r=i.length;if(!vie(e))return e;const s=(n=n||{}).merger||Aie;let a;for(let o=0;o<r;++o){if(a=i[o],!vie(a))continue;const t=Object.keys(a);for(let i=0,r=t.length;i<r;++i)s(t[i],e,a,n)}return e}function Tie(e,t){return Mie(e,t,{merger:Pie})}function Pie(e,t,n){if(!Cie(e))return;const i=t[e],r=n[e];vie(i)&&vie(r)?Tie(i,r):Object.prototype.hasOwnProperty.call(t,e)||(t[e]=Eie(r))}const Fie={"":e=>e,x:e=>e.x,y:e=>e.y};function Oie(e,t){const n=Fie[t]||(Fie[t]=function(e){const t=function(e){const t=e.split("."),n=[];let i="";for(const r of t)i+=r,i.endsWith("\\")?i=i.slice(0,-1)+".":(n.push(i),i="");return n}(e);return e=>{for(const n of t){if(""===n)break;e=e&&e[n]}return e}}(t));return n(e)}function Iie(e){return e.charAt(0).toUpperCase()+e.slice(1)}const kie=e=>"undefined"!==typeof e,Bie=e=>"function"===typeof e,Rie=(e,t)=>{if(e.size!==t.size)return!1;for(const n of e)if(!t.has(n))return!1;return!0};const Lie=Math.PI,zie=2*Lie,Nie=zie+Lie,jie=Number.POSITIVE_INFINITY,Uie=Lie/180,Vie=Lie/2,Hie=Lie/4,Wie=2*Lie/3,Gie=Math.log10,qie=Math.sign;function Yie(e,t,n){return Math.abs(e-t)<n}function Xie(e){const t=Math.round(e);e=Yie(e,t,e/1e3)?t:e;const n=Math.pow(10,Math.floor(Gie(e))),i=e/n;return(i<=1?1:i<=2?2:i<=5?5:10)*n}function Qie(e){return!isNaN(parseFloat(e))&&isFinite(e)}function Kie(e,t,n){let i,r,s;for(i=0,r=e.length;i<r;i++)s=e[i][n],isNaN(s)||(t.min=Math.min(t.min,s),t.max=Math.max(t.max,s))}function Zie(e){return e*(Lie/180)}function Jie(e){return e*(180/Lie)}function $ie(e){if(!yie(e))return;let t=1,n=0;for(;Math.round(e*t)/t!==e;)t*=10,n++;return n}function ere(e,t){const n=t.x-e.x,i=t.y-e.y,r=Math.sqrt(n*n+i*i);let s=Math.atan2(i,n);return s<-.5*Lie&&(s+=zie),{angle:s,distance:r}}function tre(e,t){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}function nre(e,t){return(e-t+Nie)%zie-Lie}function ire(e){return(e%zie+zie)%zie}function rre(e,t,n,i){const r=ire(e),s=ire(t),a=ire(n),o=ire(s-r),l=ire(a-r),u=ire(r-s),c=ire(r-a);return r===s||r===a||i&&s===a||o>l&&u<c}function sre(e,t,n){return Math.max(t,Math.min(n,e))}function are(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1e-6;return e>=Math.min(t,n)-i&&e<=Math.max(t,n)+i}function ore(e,t,n){n=n||(n=>e[n]<t);let i,r=e.length-1,s=0;for(;r-s>1;)i=s+r>>1,n(i)?s=i:r=i;return{lo:s,hi:r}}const lre=(e,t,n,i)=>ore(e,n,i?i=>{const r=e[i][t];return r<n||r===n&&e[i+1][t]===n}:i=>e[i][t]<n),ure=(e,t,n)=>ore(e,n,(i=>e[i][t]>=n));const cre=["push","pop","shift","splice","unshift"];function hre(e,t){const n=e._chartjs;if(!n)return;const i=n.listeners,r=i.indexOf(t);-1!==r&&i.splice(r,1),i.length>0||(cre.forEach((t=>{delete e[t]})),delete e._chartjs)}function dre(e){const t=new Set(e);return t.size===e.length?e:Array.from(t)}const pre="undefined"===typeof window?function(e){return e()}:window.requestAnimationFrame;function fre(e,t){let n=[],i=!1;return function(){for(var r=arguments.length,s=new Array(r),a=0;a<r;a++)s[a]=arguments[a];n=s,i||(i=!0,pre.call(window,(()=>{i=!1,e.apply(t,n)})))}}const mre=e=>"start"===e?"left":"end"===e?"right":"center",gre=(e,t,n)=>"start"===e?t:"end"===e?n:(t+n)/2;function vre(e,t,n){const i=t.length;let r=0,s=i;if(e._sorted){const{iScale:a,_parsed:o}=e,l=a.axis,{min:u,max:c,minDefined:h,maxDefined:d}=a.getUserBounds();h&&(r=sre(Math.min(lre(o,l,u).lo,n?i:lre(t,l,a.getPixelForValue(u)).lo),0,i-1)),s=d?sre(Math.max(lre(o,a.axis,c,!0).hi+1,n?0:lre(t,l,a.getPixelForValue(c),!0).hi+1),r,i)-r:i-r}return{start:r,count:s}}function yre(e){const{xScale:t,yScale:n,_scaleRanges:i}=e,r={xmin:t.min,xmax:t.max,ymin:n.min,ymax:n.max};if(!i)return e._scaleRanges=r,!0;const s=i.xmin!==t.min||i.xmax!==t.max||i.ymin!==n.min||i.ymax!==n.max;return Object.assign(i,r),s}const xre=e=>0===e||1===e,bre=(e,t,n)=>-Math.pow(2,10*(e-=1))*Math.sin((e-t)*zie/n),wre=(e,t,n)=>Math.pow(2,-10*e)*Math.sin((e-t)*zie/n)+1,Dre={linear:e=>e,easeInQuad:e=>e*e,easeOutQuad:e=>-e*(e-2),easeInOutQuad:e=>(e/=.5)<1?.5*e*e:-.5*(--e*(e-2)-1),easeInCubic:e=>e*e*e,easeOutCubic:e=>(e-=1)*e*e+1,easeInOutCubic:e=>(e/=.5)<1?.5*e*e*e:.5*((e-=2)*e*e+2),easeInQuart:e=>e*e*e*e,easeOutQuart:e=>-((e-=1)*e*e*e-1),easeInOutQuart:e=>(e/=.5)<1?.5*e*e*e*e:-.5*((e-=2)*e*e*e-2),easeInQuint:e=>e*e*e*e*e,easeOutQuint:e=>(e-=1)*e*e*e*e+1,easeInOutQuint:e=>(e/=.5)<1?.5*e*e*e*e*e:.5*((e-=2)*e*e*e*e+2),easeInSine:e=>1-Math.cos(e*Vie),easeOutSine:e=>Math.sin(e*Vie),easeInOutSine:e=>-.5*(Math.cos(Lie*e)-1),easeInExpo:e=>0===e?0:Math.pow(2,10*(e-1)),easeOutExpo:e=>1===e?1:1-Math.pow(2,-10*e),easeInOutExpo:e=>xre(e)?e:e<.5?.5*Math.pow(2,10*(2*e-1)):.5*(2-Math.pow(2,-10*(2*e-1))),easeInCirc:e=>e>=1?e:-(Math.sqrt(1-e*e)-1),easeOutCirc:e=>Math.sqrt(1-(e-=1)*e),easeInOutCirc:e=>(e/=.5)<1?-.5*(Math.sqrt(1-e*e)-1):.5*(Math.sqrt(1-(e-=2)*e)+1),easeInElastic:e=>xre(e)?e:bre(e,.075,.3),easeOutElastic:e=>xre(e)?e:wre(e,.075,.3),easeInOutElastic(e){const t=.1125;return xre(e)?e:e<.5?.5*bre(2*e,t,.45):.5+.5*wre(2*e-1,t,.45)},easeInBack(e){const t=1.70158;return e*e*((t+1)*e-t)},easeOutBack(e){const t=1.70158;return(e-=1)*e*((t+1)*e+t)+1},easeInOutBack(e){let t=1.70158;return(e/=.5)<1?e*e*((1+(t*=1.525))*e-t)*.5:.5*((e-=2)*e*((1+(t*=1.525))*e+t)+2)},easeInBounce:e=>1-Dre.easeOutBounce(1-e),easeOutBounce(e){const t=7.5625,n=2.75;return e<1/n?t*e*e:e<2/n?t*(e-=1.5/n)*e+.75:e<2.5/n?t*(e-=2.25/n)*e+.9375:t*(e-=2.625/n)*e+.984375},easeInOutBounce:e=>e<.5?.5*Dre.easeInBounce(2*e):.5*Dre.easeOutBounce(2*e-1)+.5};function _re(e){if(e&&"object"===typeof e){const t=e.toString();return"[object CanvasPattern]"===t||"[object CanvasGradient]"===t}return!1}function Sre(e){return _re(e)?e:new die(e)}function Ere(e){return _re(e)?e:new die(e).saturate(.5).darken(.1).hexString()}const Cre=["x","y","borderWidth","radius","tension"],Are=["color","borderColor","backgroundColor"];const Mre=new Map;function Tre(e,t,n){return function(e,t){t=t||{};const n=e+JSON.stringify(t);let i=Mre.get(n);return i||(i=new Intl.NumberFormat(e,t),Mre.set(n,i)),i}(t,n).format(e)}const Pre={values:e=>gie(e)?e:""+e,numeric(e,t,n){if(0===e)return"0";const i=this.chart.options.locale;let r,s=e;if(n.length>1){const t=Math.max(Math.abs(n[0].value),Math.abs(n[n.length-1].value));(t<1e-4||t>1e15)&&(r="scientific"),s=function(e,t){let n=t.length>3?t[2].value-t[1].value:t[1].value-t[0].value;Math.abs(n)>=1&&e!==Math.floor(e)&&(n=e-Math.floor(e));return n}(e,n)}const a=Gie(Math.abs(s)),o=isNaN(a)?1:Math.max(Math.min(-1*Math.floor(a),20),0),l={notation:r,minimumFractionDigits:o,maximumFractionDigits:o};return Object.assign(l,this.options.ticks.format),Tre(e,i,l)},logarithmic(e,t,n){if(0===e)return"0";const i=n[t].significand||e/Math.pow(10,Math.floor(Gie(e)));return[1,2,3,5,10,15].includes(i)||t>.8*n.length?Pre.numeric.call(this,e,t,n):""}};var Fre={formatters:Pre};const Ore=Object.create(null),Ire=Object.create(null);function kre(e,t){if(!t)return e;const n=t.split(".");for(let i=0,r=n.length;i<r;++i){const t=n[i];e=e[t]||(e[t]=Object.create(null))}return e}function Bre(e,t,n){return"string"===typeof t?Mie(kre(e,t),n):Mie(kre(e,""),t)}class Rre{constructor(e,t){this.animation=void 0,this.backgroundColor="rgba(0,0,0,0.1)",this.borderColor="rgba(0,0,0,0.1)",this.color="#666",this.datasets={},this.devicePixelRatio=e=>e.chart.platform.getDevicePixelRatio(),this.elements={},this.events=["mousemove","mouseout","click","touchstart","touchmove"],this.font={family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",size:12,style:"normal",lineHeight:1.2,weight:null},this.hover={},this.hoverBackgroundColor=(e,t)=>Ere(t.backgroundColor),this.hoverBorderColor=(e,t)=>Ere(t.borderColor),this.hoverColor=(e,t)=>Ere(t.color),this.indexAxis="x",this.interaction={mode:"nearest",intersect:!0,includeInvisible:!1},this.maintainAspectRatio=!0,this.onHover=null,this.onClick=null,this.parsing=!0,this.plugins={},this.responsive=!0,this.scale=void 0,this.scales={},this.showLine=!0,this.drawActiveElementsOnTop=!0,this.describe(e),this.apply(t)}set(e,t){return Bre(this,e,t)}get(e){return kre(this,e)}describe(e,t){return Bre(Ire,e,t)}override(e,t){return Bre(Ore,e,t)}route(e,t,n,i){const r=kre(this,e),s=kre(this,n),a="_"+t;Object.defineProperties(r,{[a]:{value:r[t],writable:!0},[t]:{enumerable:!0,get(){const e=this[a],t=s[i];return vie(e)?Object.assign({},t,e):bie(e,t)},set(e){this[a]=e}}})}apply(e){e.forEach((e=>e(this)))}}var Lre=new Rre({_scriptable:e=>!e.startsWith("on"),_indexable:e=>"events"!==e,hover:{_fallback:"interaction"},interaction:{_scriptable:!1,_indexable:!1}},[function(e){e.set("animation",{delay:void 0,duration:1e3,easing:"easeOutQuart",fn:void 0,from:void 0,loop:void 0,to:void 0,type:void 0}),e.describe("animation",{_fallback:!1,_indexable:!1,_scriptable:e=>"onProgress"!==e&&"onComplete"!==e&&"fn"!==e}),e.set("animations",{colors:{type:"color",properties:Are},numbers:{type:"number",properties:Cre}}),e.describe("animations",{_fallback:"animation"}),e.set("transitions",{active:{animation:{duration:400}},resize:{animation:{duration:0}},show:{animations:{colors:{from:"transparent"},visible:{type:"boolean",duration:0}}},hide:{animations:{colors:{to:"transparent"},visible:{type:"boolean",easing:"linear",fn:e=>0|e}}}})},function(e){e.set("layout",{autoPadding:!0,padding:{top:0,right:0,bottom:0,left:0}})},function(e){e.set("scale",{display:!0,offset:!1,reverse:!1,beginAtZero:!1,bounds:"ticks",clip:!0,grace:0,grid:{display:!0,lineWidth:1,drawOnChartArea:!0,drawTicks:!0,tickLength:8,tickWidth:(e,t)=>t.lineWidth,tickColor:(e,t)=>t.color,offset:!1},border:{display:!0,dash:[],dashOffset:0,width:1},title:{display:!1,text:"",padding:{top:4,bottom:4}},ticks:{minRotation:0,maxRotation:50,mirror:!1,textStrokeWidth:0,textStrokeColor:"",padding:3,display:!0,autoSkip:!0,autoSkipPadding:3,labelOffset:0,callback:Fre.formatters.values,minor:{},major:{},align:"center",crossAlign:"near",showLabelBackdrop:!1,backdropColor:"rgba(255, 255, 255, 0.75)",backdropPadding:2}}),e.route("scale.ticks","color","","color"),e.route("scale.grid","color","","borderColor"),e.route("scale.border","color","","borderColor"),e.route("scale.title","color","","color"),e.describe("scale",{_fallback:!1,_scriptable:e=>!e.startsWith("before")&&!e.startsWith("after")&&"callback"!==e&&"parser"!==e,_indexable:e=>"borderDash"!==e&&"tickBorderDash"!==e&&"dash"!==e}),e.describe("scales",{_fallback:"scale"}),e.describe("scale.ticks",{_scriptable:e=>"backdropPadding"!==e&&"callback"!==e,_indexable:e=>"backdropPadding"!==e})}]);function zre(e,t,n,i,r){let s=t[r];return s||(s=t[r]=e.measureText(r).width,n.push(r)),s>i&&(i=s),i}function Nre(e,t,n,i){let r=(i=i||{}).data=i.data||{},s=i.garbageCollect=i.garbageCollect||[];i.font!==t&&(r=i.data={},s=i.garbageCollect=[],i.font=t),e.save(),e.font=t;let a=0;const o=n.length;let l,u,c,h,d;for(l=0;l<o;l++)if(h=n[l],void 0===h||null===h||gie(h)){if(gie(h))for(u=0,c=h.length;u<c;u++)d=h[u],void 0===d||null===d||gie(d)||(a=zre(e,r,s,a,d))}else a=zre(e,r,s,a,h);e.restore();const p=s.length/2;if(p>n.length){for(l=0;l<p;l++)delete r[s[l]];s.splice(0,p)}return a}function jre(e,t,n){const i=e.currentDevicePixelRatio,r=0!==n?Math.max(n/2,.5):0;return Math.round((t-r)*i)/i+r}function Ure(e,t){(t||e)&&((t=t||e.getContext("2d")).save(),t.resetTransform(),t.clearRect(0,0,e.width,e.height),t.restore())}function Vre(e,t,n,i){Hre(e,t,n,i,null)}function Hre(e,t,n,i,r){let s,a,o,l,u,c,h,d;const p=t.pointStyle,f=t.rotation,m=t.radius;let g=(f||0)*Uie;if(p&&"object"===typeof p&&(s=p.toString(),"[object HTMLImageElement]"===s||"[object HTMLCanvasElement]"===s))return e.save(),e.translate(n,i),e.rotate(g),e.drawImage(p,-p.width/2,-p.height/2,p.width,p.height),void e.restore();if(!(isNaN(m)||m<=0)){switch(e.beginPath(),p){default:r?e.ellipse(n,i,r/2,m,0,0,zie):e.arc(n,i,m,0,zie),e.closePath();break;case"triangle":c=r?r/2:m,e.moveTo(n+Math.sin(g)*c,i-Math.cos(g)*m),g+=Wie,e.lineTo(n+Math.sin(g)*c,i-Math.cos(g)*m),g+=Wie,e.lineTo(n+Math.sin(g)*c,i-Math.cos(g)*m),e.closePath();break;case"rectRounded":u=.516*m,l=m-u,a=Math.cos(g+Hie)*l,h=Math.cos(g+Hie)*(r?r/2-u:l),o=Math.sin(g+Hie)*l,d=Math.sin(g+Hie)*(r?r/2-u:l),e.arc(n-h,i-o,u,g-Lie,g-Vie),e.arc(n+d,i-a,u,g-Vie,g),e.arc(n+h,i+o,u,g,g+Vie),e.arc(n-d,i+a,u,g+Vie,g+Lie),e.closePath();break;case"rect":if(!f){l=Math.SQRT1_2*m,c=r?r/2:l,e.rect(n-c,i-l,2*c,2*l);break}g+=Hie;case"rectRot":h=Math.cos(g)*(r?r/2:m),a=Math.cos(g)*m,o=Math.sin(g)*m,d=Math.sin(g)*(r?r/2:m),e.moveTo(n-h,i-o),e.lineTo(n+d,i-a),e.lineTo(n+h,i+o),e.lineTo(n-d,i+a),e.closePath();break;case"crossRot":g+=Hie;case"cross":h=Math.cos(g)*(r?r/2:m),a=Math.cos(g)*m,o=Math.sin(g)*m,d=Math.sin(g)*(r?r/2:m),e.moveTo(n-h,i-o),e.lineTo(n+h,i+o),e.moveTo(n+d,i-a),e.lineTo(n-d,i+a);break;case"star":h=Math.cos(g)*(r?r/2:m),a=Math.cos(g)*m,o=Math.sin(g)*m,d=Math.sin(g)*(r?r/2:m),e.moveTo(n-h,i-o),e.lineTo(n+h,i+o),e.moveTo(n+d,i-a),e.lineTo(n-d,i+a),g+=Hie,h=Math.cos(g)*(r?r/2:m),a=Math.cos(g)*m,o=Math.sin(g)*m,d=Math.sin(g)*(r?r/2:m),e.moveTo(n-h,i-o),e.lineTo(n+h,i+o),e.moveTo(n+d,i-a),e.lineTo(n-d,i+a);break;case"line":a=r?r/2:Math.cos(g)*m,o=Math.sin(g)*m,e.moveTo(n-a,i-o),e.lineTo(n+a,i+o);break;case"dash":e.moveTo(n,i),e.lineTo(n+Math.cos(g)*(r?r/2:m),i+Math.sin(g)*m);break;case!1:e.closePath()}e.fill(),t.borderWidth>0&&e.stroke()}}function Wre(e,t,n){return n=n||.5,!t||e&&e.x>t.left-n&&e.x<t.right+n&&e.y>t.top-n&&e.y<t.bottom+n}function Gre(e,t){e.save(),e.beginPath(),e.rect(t.left,t.top,t.right-t.left,t.bottom-t.top),e.clip()}function qre(e){e.restore()}function Yre(e,t,n,i,r){if(!t)return e.lineTo(n.x,n.y);if("middle"===r){const i=(t.x+n.x)/2;e.lineTo(i,t.y),e.lineTo(i,n.y)}else"after"===r!==!!i?e.lineTo(t.x,n.y):e.lineTo(n.x,t.y);e.lineTo(n.x,n.y)}function Xre(e,t,n,i){if(!t)return e.lineTo(n.x,n.y);e.bezierCurveTo(i?t.cp1x:t.cp2x,i?t.cp1y:t.cp2y,i?n.cp2x:n.cp1x,i?n.cp2y:n.cp1y,n.x,n.y)}function Qre(e,t,n,i,r){if(r.strikethrough||r.underline){const s=e.measureText(i),a=t-s.actualBoundingBoxLeft,o=t+s.actualBoundingBoxRight,l=n-s.actualBoundingBoxAscent,u=n+s.actualBoundingBoxDescent,c=r.strikethrough?(l+u)/2:u;e.strokeStyle=e.fillStyle,e.beginPath(),e.lineWidth=r.decorationWidth||2,e.moveTo(a,c),e.lineTo(o,c),e.stroke()}}function Kre(e,t){const n=e.fillStyle;e.fillStyle=t.color,e.fillRect(t.left,t.top,t.width,t.height),e.fillStyle=n}function Zre(e,t,n,i,r){let s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{};const a=gie(t)?t:[t],o=s.strokeWidth>0&&""!==s.strokeColor;let l,u;for(e.save(),e.font=r.string,function(e,t){t.translation&&e.translate(t.translation[0],t.translation[1]),mie(t.rotation)||e.rotate(t.rotation),t.color&&(e.fillStyle=t.color),t.textAlign&&(e.textAlign=t.textAlign),t.textBaseline&&(e.textBaseline=t.textBaseline)}(e,s),l=0;l<a.length;++l)u=a[l],s.backdrop&&Kre(e,s.backdrop),o&&(s.strokeColor&&(e.strokeStyle=s.strokeColor),mie(s.strokeWidth)||(e.lineWidth=s.strokeWidth),e.strokeText(u,n,i,s.maxWidth)),e.fillText(u,n,i,s.maxWidth),Qre(e,n,i,u,s),i+=Number(r.lineHeight);e.restore()}function Jre(e,t){const{x:n,y:i,w:r,h:s,radius:a}=t;e.arc(n+a.topLeft,i+a.topLeft,a.topLeft,1.5*Lie,Lie,!0),e.lineTo(n,i+s-a.bottomLeft),e.arc(n+a.bottomLeft,i+s-a.bottomLeft,a.bottomLeft,Lie,Vie,!0),e.lineTo(n+r-a.bottomRight,i+s),e.arc(n+r-a.bottomRight,i+s-a.bottomRight,a.bottomRight,Vie,0,!0),e.lineTo(n+r,i+a.topRight),e.arc(n+r-a.topRight,i+a.topRight,a.topRight,0,-Vie,!0),e.lineTo(n+a.topLeft,i)}const $re=/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/,ese=/^(normal|italic|initial|inherit|unset|(oblique( -?[0-9]?[0-9]deg)?))$/;function tse(e,t){const n=(""+e).match($re);if(!n||"normal"===n[1])return 1.2*t;switch(e=+n[2],n[3]){case"px":return e;case"%":e/=100}return t*e}const nse=e=>+e||0;function ise(e,t){const n={},i=vie(t),r=i?Object.keys(t):t,s=vie(e)?i?n=>bie(e[n],e[t[n]]):t=>e[t]:()=>e;for(const a of r)n[a]=nse(s(a));return n}function rse(e){return ise(e,{top:"y",right:"x",bottom:"y",left:"x"})}function sse(e){return ise(e,["topLeft","topRight","bottomLeft","bottomRight"])}function ase(e){const t=rse(e);return t.width=t.left+t.right,t.height=t.top+t.bottom,t}function ose(e,t){e=e||{},t=t||Lre.font;let n=bie(e.size,t.size);"string"===typeof n&&(n=parseInt(n,10));let i=bie(e.style,t.style);i&&!(""+i).match(ese)&&(console.warn('Invalid font style specified: "'+i+'"'),i=void 0);const r={family:bie(e.family,t.family),lineHeight:tse(bie(e.lineHeight,t.lineHeight),n),size:n,style:i,weight:bie(e.weight,t.weight),string:""};return r.string=function(e){return!e||mie(e.size)||mie(e.family)?null:(e.style?e.style+" ":"")+(e.weight?e.weight+" ":"")+e.size+"px "+e.family}(r),r}function lse(e,t,n,i){let r,s,a,o=!0;for(r=0,s=e.length;r<s;++r)if(a=e[r],void 0!==a&&(void 0!==t&&"function"===typeof a&&(a=a(t),o=!1),void 0!==n&&gie(a)&&(a=a[n%a.length],o=!1),void 0!==a))return i&&!o&&(i.cacheable=!1),a}function use(e,t){return Object.assign(Object.create(e),t)}function cse(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[""],n=arguments.length>3?arguments[3]:void 0,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:()=>e[0];const r=(arguments.length>2?arguments[2]:void 0)||e;"undefined"===typeof n&&(n=wse("_fallback",e));const s={[Symbol.toStringTag]:"Object",_cacheable:!0,_scopes:e,_rootScopes:r,_fallback:n,_getTarget:i,override:i=>cse([i,...e],t,r,n)};return new Proxy(s,{deleteProperty:(t,n)=>(delete t[n],delete t._keys,delete e[0][n],!0),get:(n,i)=>mse(n,i,(()=>function(e,t,n,i){let r;for(const s of t)if(r=wse(pse(s,e),n),"undefined"!==typeof r)return fse(e,r)?xse(n,i,e,r):r}(i,t,e,n))),getOwnPropertyDescriptor:(e,t)=>Reflect.getOwnPropertyDescriptor(e._scopes[0],t),getPrototypeOf:()=>Reflect.getPrototypeOf(e[0]),has:(e,t)=>Dse(e).includes(t),ownKeys:e=>Dse(e),set(e,t,n){const r=e._storage||(e._storage=i());return e[t]=r[t]=n,delete e._keys,!0}})}function hse(e,t,n,i){const r={_cacheable:!1,_proxy:e,_context:t,_subProxy:n,_stack:new Set,_descriptors:dse(e,i),setContext:t=>hse(e,t,n,i),override:r=>hse(e.override(r),t,n,i)};return new Proxy(r,{deleteProperty:(t,n)=>(delete t[n],delete e[n],!0),get:(e,t,n)=>mse(e,t,(()=>function(e,t,n){const{_proxy:i,_context:r,_subProxy:s,_descriptors:a}=e;let o=i[t];Bie(o)&&a.isScriptable(t)&&(o=function(e,t,n,i){const{_proxy:r,_context:s,_subProxy:a,_stack:o}=n;if(o.has(e))throw new Error("Recursion detected: "+Array.from(o).join("->")+"->"+e);o.add(e);let l=t(s,a||i);o.delete(e),fse(e,l)&&(l=xse(r._scopes,r,e,l));return l}(t,o,e,n));gie(o)&&o.length&&(o=function(e,t,n,i){const{_proxy:r,_context:s,_subProxy:a,_descriptors:o}=n;if("undefined"!==typeof s.index&&i(e))return t[s.index%t.length];if(vie(t[0])){const n=t,i=r._scopes.filter((e=>e!==n));t=[];for(const l of n){const n=xse(i,r,e,l);t.push(hse(n,s,a&&a[e],o))}}return t}(t,o,e,a.isIndexable));fse(t,o)&&(o=hse(o,r,s&&s[t],a));return o}(e,t,n))),getOwnPropertyDescriptor:(t,n)=>t._descriptors.allKeys?Reflect.has(e,n)?{enumerable:!0,configurable:!0}:void 0:Reflect.getOwnPropertyDescriptor(e,n),getPrototypeOf:()=>Reflect.getPrototypeOf(e),has:(t,n)=>Reflect.has(e,n),ownKeys:()=>Reflect.ownKeys(e),set:(t,n,i)=>(e[n]=i,delete t[n],!0)})}function dse(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{scriptable:!0,indexable:!0};const{_scriptable:n=t.scriptable,_indexable:i=t.indexable,_allKeys:r=t.allKeys}=e;return{allKeys:r,scriptable:n,indexable:i,isScriptable:Bie(n)?n:()=>n,isIndexable:Bie(i)?i:()=>i}}const pse=(e,t)=>e?e+Iie(t):t,fse=(e,t)=>vie(t)&&"adapters"!==e&&(null===Object.getPrototypeOf(t)||t.constructor===Object);function mse(e,t,n){if(Object.prototype.hasOwnProperty.call(e,t)||"constructor"===t)return e[t];const i=n();return e[t]=i,i}function gse(e,t,n){return Bie(e)?e(t,n):e}const vse=(e,t)=>!0===e?t:"string"===typeof e?Oie(t,e):void 0;function yse(e,t,n,i,r){for(const s of t){const t=vse(n,s);if(t){e.add(t);const s=gse(t._fallback,n,r);if("undefined"!==typeof s&&s!==n&&s!==i)return s}else if(!1===t&&"undefined"!==typeof i&&n!==i)return null}return!1}function xse(e,t,n,i){const r=t._rootScopes,s=gse(t._fallback,n,i),a=[...e,...r],o=new Set;o.add(i);let l=bse(o,a,n,s||n,i);return null!==l&&(("undefined"===typeof s||s===n||(l=bse(o,a,s,l,i),null!==l))&&cse(Array.from(o),[""],r,s,(()=>function(e,t,n){const i=e._getTarget();t in i||(i[t]={});const r=i[t];if(gie(r)&&vie(n))return n;return r||{}}(t,n,i))))}function bse(e,t,n,i,r){for(;n;)n=yse(e,t,n,i,r);return n}function wse(e,t){for(const n of t){if(!n)continue;const t=n[e];if("undefined"!==typeof t)return t}}function Dse(e){let t=e._keys;return t||(t=e._keys=function(e){const t=new Set;for(const n of e)for(const e of Object.keys(n).filter((e=>!e.startsWith("_"))))t.add(e);return Array.from(t)}(e._scopes)),t}function _se(e,t,n,i){const{iScale:r}=e,{key:s="r"}=this._parsing,a=new Array(i);let o,l,u,c;for(o=0,l=i;o<l;++o)u=o+n,c=t[u],a[o]={r:r.parse(Oie(c,s),u)};return a}const Sse=Number.EPSILON||1e-14,Ese=(e,t)=>t<e.length&&!e[t].skip&&e[t],Cse=e=>"x"===e?"y":"x";function Ase(e,t,n,i){const r=e.skip?t:e,s=t,a=n.skip?t:n,o=tre(s,r),l=tre(a,s);let u=o/(o+l),c=l/(o+l);u=isNaN(u)?0:u,c=isNaN(c)?0:c;const h=i*u,d=i*c;return{previous:{x:s.x-h*(a.x-r.x),y:s.y-h*(a.y-r.y)},next:{x:s.x+d*(a.x-r.x),y:s.y+d*(a.y-r.y)}}}function Mse(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"x";const n=Cse(t),i=e.length,r=Array(i).fill(0),s=Array(i);let a,o,l,u=Ese(e,0);for(a=0;a<i;++a)if(o=l,l=u,u=Ese(e,a+1),l){if(u){const e=u[t]-l[t];r[a]=0!==e?(u[n]-l[n])/e:0}s[a]=o?u?qie(r[a-1])!==qie(r[a])?0:(r[a-1]+r[a])/2:r[a-1]:r[a]}!function(e,t,n){const i=e.length;let r,s,a,o,l,u=Ese(e,0);for(let c=0;c<i-1;++c)l=u,u=Ese(e,c+1),l&&u&&(Yie(t[c],0,Sse)?n[c]=n[c+1]=0:(r=n[c]/t[c],s=n[c+1]/t[c],o=Math.pow(r,2)+Math.pow(s,2),o<=9||(a=3/Math.sqrt(o),n[c]=r*a*t[c],n[c+1]=s*a*t[c])))}(e,r,s),function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"x";const i=Cse(n),r=e.length;let s,a,o,l=Ese(e,0);for(let u=0;u<r;++u){if(a=o,o=l,l=Ese(e,u+1),!o)continue;const r=o[n],c=o[i];a&&(s=(r-a[n])/3,o["cp1".concat(n)]=r-s,o["cp1".concat(i)]=c-s*t[u]),l&&(s=(l[n]-r)/3,o["cp2".concat(n)]=r+s,o["cp2".concat(i)]=c+s*t[u])}}(e,s,t)}function Tse(e,t,n){return Math.max(Math.min(e,n),t)}function Pse(e,t,n,i,r){let s,a,o,l;if(t.spanGaps&&(e=e.filter((e=>!e.skip))),"monotone"===t.cubicInterpolationMode)Mse(e,r);else{let n=i?e[e.length-1]:e[0];for(s=0,a=e.length;s<a;++s)o=e[s],l=Ase(n,o,e[Math.min(s+1,a-(i?0:1))%a],t.tension),o.cp1x=l.previous.x,o.cp1y=l.previous.y,o.cp2x=l.next.x,o.cp2y=l.next.y,n=o}t.capBezierPoints&&function(e,t){let n,i,r,s,a,o=Wre(e[0],t);for(n=0,i=e.length;n<i;++n)a=s,s=o,o=n<i-1&&Wre(e[n+1],t),s&&(r=e[n],a&&(r.cp1x=Tse(r.cp1x,t.left,t.right),r.cp1y=Tse(r.cp1y,t.top,t.bottom)),o&&(r.cp2x=Tse(r.cp2x,t.left,t.right),r.cp2y=Tse(r.cp2y,t.top,t.bottom)))}(e,n)}function Fse(){return"undefined"!==typeof window&&"undefined"!==typeof document}function Ose(e){let t=e.parentNode;return t&&"[object ShadowRoot]"===t.toString()&&(t=t.host),t}function Ise(e,t,n){let i;return"string"===typeof e?(i=parseInt(e,10),-1!==e.indexOf("%")&&(i=i/100*t.parentNode[n])):i=e,i}const kse=e=>e.ownerDocument.defaultView.getComputedStyle(e,null);const Bse=["top","right","bottom","left"];function Rse(e,t,n){const i={};n=n?"-"+n:"";for(let r=0;r<4;r++){const s=Bse[r];i[s]=parseFloat(e[t+"-"+s+n])||0}return i.width=i.left+i.right,i.height=i.top+i.bottom,i}function Lse(e,t){if("native"in e)return e;const{canvas:n,currentDevicePixelRatio:i}=t,r=kse(n),s="border-box"===r.boxSizing,a=Rse(r,"padding"),o=Rse(r,"border","width"),{x:l,y:u,box:c}=function(e,t){const n=e.touches,i=n&&n.length?n[0]:e,{offsetX:r,offsetY:s}=i;let a,o,l=!1;if(((e,t,n)=>(e>0||t>0)&&(!n||!n.shadowRoot))(r,s,e.target))a=r,o=s;else{const e=t.getBoundingClientRect();a=i.clientX-e.left,o=i.clientY-e.top,l=!0}return{x:a,y:o,box:l}}(e,n),h=a.left+(c&&o.left),d=a.top+(c&&o.top);let{width:p,height:f}=t;return s&&(p-=a.width+o.width,f-=a.height+o.height),{x:Math.round((l-h)/p*n.width/i),y:Math.round((u-d)/f*n.height/i)}}const zse=e=>Math.round(10*e)/10;function Nse(e,t,n,i){const r=kse(e),s=Rse(r,"margin"),a=Ise(r.maxWidth,e,"clientWidth")||jie,o=Ise(r.maxHeight,e,"clientHeight")||jie,l=function(e,t,n){let i,r;if(void 0===t||void 0===n){const s=e&&Ose(e);if(s){const e=s.getBoundingClientRect(),a=kse(s),o=Rse(a,"border","width"),l=Rse(a,"padding");t=e.width-l.width-o.width,n=e.height-l.height-o.height,i=Ise(a.maxWidth,s,"clientWidth"),r=Ise(a.maxHeight,s,"clientHeight")}else t=e.clientWidth,n=e.clientHeight}return{width:t,height:n,maxWidth:i||jie,maxHeight:r||jie}}(e,t,n);let{width:u,height:c}=l;if("content-box"===r.boxSizing){const e=Rse(r,"border","width"),t=Rse(r,"padding");u-=t.width+e.width,c-=t.height+e.height}u=Math.max(0,u-s.width),c=Math.max(0,i?u/i:c-s.height),u=zse(Math.min(u,a,l.maxWidth)),c=zse(Math.min(c,o,l.maxHeight)),u&&!c&&(c=zse(u/2));return(void 0!==t||void 0!==n)&&i&&l.height&&c>l.height&&(c=l.height,u=zse(Math.floor(c*i))),{width:u,height:c}}function jse(e,t,n){const i=t||1,r=Math.floor(e.height*i),s=Math.floor(e.width*i);e.height=Math.floor(e.height),e.width=Math.floor(e.width);const a=e.canvas;return a.style&&(n||!a.style.height&&!a.style.width)&&(a.style.height="".concat(e.height,"px"),a.style.width="".concat(e.width,"px")),(e.currentDevicePixelRatio!==i||a.height!==r||a.width!==s)&&(e.currentDevicePixelRatio=i,a.height=r,a.width=s,e.ctx.setTransform(i,0,0,i,0,0),!0)}const Use=function(){let e=!1;try{const t={get passive(){return e=!0,!1}};Fse()&&(window.addEventListener("test",null,t),window.removeEventListener("test",null,t))}catch(Mn){}return e}();function Vse(e,t){const n=function(e,t){return kse(e).getPropertyValue(t)}(e,t),i=n&&n.match(/^(\d+)(\.\d+)?px$/);return i?+i[1]:void 0}function Hse(e,t,n,i){return{x:e.x+n*(t.x-e.x),y:e.y+n*(t.y-e.y)}}function Wse(e,t,n,i){return{x:e.x+n*(t.x-e.x),y:"middle"===i?n<.5?e.y:t.y:"after"===i?n<1?e.y:t.y:n>0?t.y:e.y}}function Gse(e,t,n,i){const r={x:e.cp2x,y:e.cp2y},s={x:t.cp1x,y:t.cp1y},a=Hse(e,r,n),o=Hse(r,s,n),l=Hse(s,t,n),u=Hse(a,o,n),c=Hse(o,l,n);return Hse(u,c,n)}function qse(e,t,n){return e?function(e,t){return{x:n=>e+e+t-n,setWidth(e){t=e},textAlign:e=>"center"===e?e:"right"===e?"left":"right",xPlus:(e,t)=>e-t,leftForLtr:(e,t)=>e-t}}(t,n):{x:e=>e,setWidth(e){},textAlign:e=>e,xPlus:(e,t)=>e+t,leftForLtr:(e,t)=>e}}function Yse(e,t){let n,i;"ltr"!==t&&"rtl"!==t||(n=e.canvas.style,i=[n.getPropertyValue("direction"),n.getPropertyPriority("direction")],n.setProperty("direction",t,"important"),e.prevTextDirection=i)}function Xse(e,t){void 0!==t&&(delete e.prevTextDirection,e.canvas.style.setProperty("direction",t[0],t[1]))}function Qse(e){return"angle"===e?{between:rre,compare:nre,normalize:ire}:{between:are,compare:(e,t)=>e-t,normalize:e=>e}}function Kse(e){let{start:t,end:n,count:i,loop:r,style:s}=e;return{start:t%i,end:n%i,loop:r&&(n-t+1)%i===0,style:s}}function Zse(e,t,n){if(!n)return[e];const{property:i,start:r,end:s}=n,a=t.length,{compare:o,between:l,normalize:u}=Qse(i),{start:c,end:h,loop:d,style:p}=function(e,t,n){const{property:i,start:r,end:s}=n,{between:a,normalize:o}=Qse(i),l=t.length;let u,c,{start:h,end:d,loop:p}=e;if(p){for(h+=l,d+=l,u=0,c=l;u<c&&a(o(t[h%l][i]),r,s);++u)h--,d--;h%=l,d%=l}return d<h&&(d+=l),{start:h,end:d,loop:p,style:e.style}}(e,t,n),f=[];let m,g,v,y=!1,x=null;const b=()=>y||l(r,v,m)&&0!==o(r,v),w=()=>!y||0===o(s,m)||l(s,v,m);for(let D=c,_=c;D<=h;++D)g=t[D%a],g.skip||(m=u(g[i]),m!==v&&(y=l(m,r,s),null===x&&b()&&(x=0===o(m,r)?D:_),null!==x&&w()&&(f.push(Kse({start:x,end:D,loop:d,count:a,style:p})),x=null),_=D,v=m));return null!==x&&f.push(Kse({start:x,end:h,loop:d,count:a,style:p})),f}function Jse(e,t){const n=[],i=e.segments;for(let r=0;r<i.length;r++){const s=Zse(i[r],e.points,t);s.length&&n.push(...s)}return n}function $se(e,t,n,i){return i&&i.setContext&&n?function(e,t,n,i){const r=e._chart.getContext(),s=eae(e.options),{_datasetIndex:a,options:{spanGaps:o}}=e,l=n.length,u=[];let c=s,h=t[0].start,d=h;function p(e,t,i,r){const s=o?-1:1;if(e!==t){for(e+=l;n[e%l].skip;)e-=s;for(;n[t%l].skip;)t+=s;e%l!==t%l&&(u.push({start:e%l,end:t%l,loop:i,style:r}),c=r,h=t%l)}}for(const f of t){h=o?h:f.start;let e,t=n[h%l];for(d=h+1;d<=f.end;d++){const s=n[d%l];e=eae(i.setContext(use(r,{type:"segment",p0:t,p1:s,p0DataIndex:(d-1)%l,p1DataIndex:d%l,datasetIndex:a}))),tae(e,c)&&p(h,d-1,f.loop,c),t=s,c=e}h<d-1&&p(h,d-1,f.loop,c)}return u}(e,t,n,i):t}function eae(e){return{backgroundColor:e.backgroundColor,borderCapStyle:e.borderCapStyle,borderDash:e.borderDash,borderDashOffset:e.borderDashOffset,borderJoinStyle:e.borderJoinStyle,borderWidth:e.borderWidth,borderColor:e.borderColor}}function tae(e,t){if(!t)return!1;const n=[],i=function(e,t){return _re(t)?(n.includes(t)||n.push(t),n.indexOf(t)):t};return JSON.stringify(e,i)!==JSON.stringify(t,i)}class nae{constructor(){this._request=null,this._charts=new Map,this._running=!1,this._lastDate=void 0}_notify(e,t,n,i){const r=t.listeners[i],s=t.duration;r.forEach((i=>i({chart:e,initial:t.initial,numSteps:s,currentStep:Math.min(n-t.start,s)})))}_refresh(){this._request||(this._running=!0,this._request=pre.call(window,(()=>{this._update(),this._request=null,this._running&&this._refresh()})))}_update(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Date.now(),t=0;this._charts.forEach(((n,i)=>{if(!n.running||!n.items.length)return;const r=n.items;let s,a=r.length-1,o=!1;for(;a>=0;--a)s=r[a],s._active?(s._total>n.duration&&(n.duration=s._total),s.tick(e),o=!0):(r[a]=r[r.length-1],r.pop());o&&(i.draw(),this._notify(i,n,e,"progress")),r.length||(n.running=!1,this._notify(i,n,e,"complete"),n.initial=!1),t+=r.length})),this._lastDate=e,0===t&&(this._running=!1)}_getAnims(e){const t=this._charts;let n=t.get(e);return n||(n={running:!1,initial:!0,items:[],listeners:{complete:[],progress:[]}},t.set(e,n)),n}listen(e,t,n){this._getAnims(e).listeners[t].push(n)}add(e,t){t&&t.length&&this._getAnims(e).items.push(...t)}has(e){return this._getAnims(e).items.length>0}start(e){const t=this._charts.get(e);t&&(t.running=!0,t.start=Date.now(),t.duration=t.items.reduce(((e,t)=>Math.max(e,t._duration)),0),this._refresh())}running(e){if(!this._running)return!1;const t=this._charts.get(e);return!!(t&&t.running&&t.items.length)}stop(e){const t=this._charts.get(e);if(!t||!t.items.length)return;const n=t.items;let i=n.length-1;for(;i>=0;--i)n[i].cancel();t.items=[],this._notify(e,t,Date.now(),"complete")}remove(e){return this._charts.delete(e)}}var iae=new nae;const rae="transparent",sae={boolean:(e,t,n)=>n>.5?t:e,color(e,t,n){const i=Sre(e||rae),r=i.valid&&Sre(t||rae);return r&&r.valid?r.mix(i,n).hexString():t},number:(e,t,n)=>e+(t-e)*n};class aae{constructor(e,t,n,i){const r=t[n];i=lse([e.to,i,r,e.from]);const s=lse([e.from,r,i]);this._active=!0,this._fn=e.fn||sae[e.type||typeof s],this._easing=Dre[e.easing]||Dre.linear,this._start=Math.floor(Date.now()+(e.delay||0)),this._duration=this._total=Math.floor(e.duration),this._loop=!!e.loop,this._target=t,this._prop=n,this._from=s,this._to=i,this._promises=void 0}active(){return this._active}update(e,t,n){if(this._active){this._notify(!1);const i=this._target[this._prop],r=n-this._start,s=this._duration-r;this._start=n,this._duration=Math.floor(Math.max(s,e.duration)),this._total+=r,this._loop=!!e.loop,this._to=lse([e.to,t,i,e.from]),this._from=lse([e.from,i,t])}}cancel(){this._active&&(this.tick(Date.now()),this._active=!1,this._notify(!1))}tick(e){const t=e-this._start,n=this._duration,i=this._prop,r=this._from,s=this._loop,a=this._to;let o;if(this._active=r!==a&&(s||t<n),!this._active)return this._target[i]=a,void this._notify(!0);t<0?this._target[i]=r:(o=t/n%2,o=s&&o>1?2-o:o,o=this._easing(Math.min(1,Math.max(0,o))),this._target[i]=this._fn(r,a,o))}wait(){const e=this._promises||(this._promises=[]);return new Promise(((t,n)=>{e.push({res:t,rej:n})}))}_notify(e){const t=e?"res":"rej",n=this._promises||[];for(let i=0;i<n.length;i++)n[i][t]()}}class oae{constructor(e,t){this._chart=e,this._properties=new Map,this.configure(t)}configure(e){if(!vie(e))return;const t=Object.keys(Lre.animation),n=this._properties;Object.getOwnPropertyNames(e).forEach((i=>{const r=e[i];if(!vie(r))return;const s={};for(const e of t)s[e]=r[e];(gie(r.properties)&&r.properties||[i]).forEach((e=>{e!==i&&n.has(e)||n.set(e,s)}))}))}_animateOptions(e,t){const n=t.options,i=function(e,t){if(!t)return;let n=e.options;if(!n)return void(e.options=t);n.$shared&&(e.options=n=Object.assign({},n,{$shared:!1,$animations:{}}));return n}(e,n);if(!i)return[];const r=this._createAnimations(i,n);return n.$shared&&function(e,t){const n=[],i=Object.keys(t);for(let r=0;r<i.length;r++){const t=e[i[r]];t&&t.active()&&n.push(t.wait())}return Promise.all(n)}(e.options.$animations,n).then((()=>{e.options=n}),(()=>{})),r}_createAnimations(e,t){const n=this._properties,i=[],r=e.$animations||(e.$animations={}),s=Object.keys(t),a=Date.now();let o;for(o=s.length-1;o>=0;--o){const l=s[o];if("$"===l.charAt(0))continue;if("options"===l){i.push(...this._animateOptions(e,t));continue}const u=t[l];let c=r[l];const h=n.get(l);if(c){if(h&&c.active()){c.update(h,u,a);continue}c.cancel()}h&&h.duration?(r[l]=c=new aae(h,e,l,u),i.push(c)):e[l]=u}return i}update(e,t){if(0===this._properties.size)return void Object.assign(e,t);const n=this._createAnimations(e,t);return n.length?(iae.add(this._chart,n),!0):void 0}}function lae(e,t){const n=e&&e.options||{},i=n.reverse,r=void 0===n.min?t:0,s=void 0===n.max?t:0;return{start:i?s:r,end:i?r:s}}function uae(e,t){const n=[],i=e._getSortedDatasetMetas(t);let r,s;for(r=0,s=i.length;r<s;++r)n.push(i[r].index);return n}function cae(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};const r=e.keys,s="single"===i.mode;let a,o,l,u;if(null===t)return;let c=!1;for(a=0,o=r.length;a<o;++a){if(l=+r[a],l===n){if(c=!0,i.all)continue;break}u=e.values[l],yie(u)&&(s||0===t||qie(t)===qie(u))&&(t+=u)}return c||i.all?t:0}function hae(e,t){const n=e&&e.options.stacked;return n||void 0===n&&void 0!==t.stack}function dae(e,t,n){const i=e[t]||(e[t]={});return i[n]||(i[n]={})}function pae(e,t,n,i){for(const r of t.getMatchingVisibleMetas(i).reverse()){const t=e[r.index];if(n&&t>0||!n&&t<0)return r.index}return null}function fae(e,t){const{chart:n,_cachedMeta:i}=e,r=n._stacks||(n._stacks={}),{iScale:s,vScale:a,index:o}=i,l=s.axis,u=a.axis,c=function(e,t,n){return"".concat(e.id,".").concat(t.id,".").concat(n.stack||n.type)}(s,a,i),h=t.length;let d;for(let p=0;p<h;++p){const e=t[p],{[l]:n,[u]:s}=e;d=(e._stacks||(e._stacks={}))[u]=dae(r,c,n),d[o]=s,d._top=pae(d,a,!0,i.type),d._bottom=pae(d,a,!1,i.type);(d._visualValues||(d._visualValues={}))[o]=s}}function mae(e,t){const n=e.scales;return Object.keys(n).filter((e=>n[e].axis===t)).shift()}function gae(e,t){const n=e.controller.index,i=e.vScale&&e.vScale.axis;if(i){t=t||e._parsed;for(const e of t){const t=e._stacks;if(!t||void 0===t[i]||void 0===t[i][n])return;delete t[i][n],void 0!==t[i]._visualValues&&void 0!==t[i]._visualValues[n]&&delete t[i]._visualValues[n]}}}const vae=e=>"reset"===e||"none"===e,yae=(e,t)=>t?e:Object.assign({},e);class xae{constructor(e,t){this.chart=e,this._ctx=e.ctx,this.index=t,this._cachedDataOpts={},this._cachedMeta=this.getMeta(),this._type=this._cachedMeta.type,this.options=void 0,this._parsing=!1,this._data=void 0,this._objectData=void 0,this._sharedOptions=void 0,this._drawStart=void 0,this._drawCount=void 0,this.enableOptionSharing=!1,this.supportsDecimation=!1,this.$context=void 0,this._syncList=[],this.datasetElementType=new.target.datasetElementType,this.dataElementType=new.target.dataElementType,this.initialize()}initialize(){const e=this._cachedMeta;this.configure(),this.linkScales(),e._stacked=hae(e.vScale,e),this.addElements(),this.options.fill&&!this.chart.isPluginEnabled("filler")&&console.warn("Tried to use the 'fill' option without the 'Filler' plugin enabled. Please import and register the 'Filler' plugin and make sure it is not disabled in the options")}updateIndex(e){this.index!==e&&gae(this._cachedMeta),this.index=e}linkScales(){const e=this.chart,t=this._cachedMeta,n=this.getDataset(),i=(e,t,n,i)=>"x"===e?t:"r"===e?i:n,r=t.xAxisID=bie(n.xAxisID,mae(e,"x")),s=t.yAxisID=bie(n.yAxisID,mae(e,"y")),a=t.rAxisID=bie(n.rAxisID,mae(e,"r")),o=t.indexAxis,l=t.iAxisID=i(o,r,s,a),u=t.vAxisID=i(o,s,r,a);t.xScale=this.getScaleForId(r),t.yScale=this.getScaleForId(s),t.rScale=this.getScaleForId(a),t.iScale=this.getScaleForId(l),t.vScale=this.getScaleForId(u)}getDataset(){return this.chart.data.datasets[this.index]}getMeta(){return this.chart.getDatasetMeta(this.index)}getScaleForId(e){return this.chart.scales[e]}_getOtherScale(e){const t=this._cachedMeta;return e===t.iScale?t.vScale:t.iScale}reset(){this._update("reset")}_destroy(){const e=this._cachedMeta;this._data&&hre(this._data,this),e._stacked&&gae(e)}_dataCheck(){const e=this.getDataset(),t=e.data||(e.data=[]),n=this._data;if(vie(t)){const e=this._cachedMeta;this._data=function(e,t){const{iScale:n,vScale:i}=t,r="x"===n.axis?"x":"y",s="x"===i.axis?"x":"y",a=Object.keys(e),o=new Array(a.length);let l,u,c;for(l=0,u=a.length;l<u;++l)c=a[l],o[l]={[r]:c,[s]:e[c]};return o}(t,e)}else if(n!==t){if(n){hre(n,this);const e=this._cachedMeta;gae(e),e._parsed=[]}t&&Object.isExtensible(t)&&(r=this,(i=t)._chartjs?i._chartjs.listeners.push(r):(Object.defineProperty(i,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[r]}}),cre.forEach((e=>{const t="_onData"+Iie(e),n=i[e];Object.defineProperty(i,e,{configurable:!0,enumerable:!1,value(){for(var e=arguments.length,r=new Array(e),s=0;s<e;s++)r[s]=arguments[s];const a=n.apply(this,r);return i._chartjs.listeners.forEach((e=>{"function"===typeof e[t]&&e[t](...r)})),a}})})))),this._syncList=[],this._data=t}var i,r}addElements(){const e=this._cachedMeta;this._dataCheck(),this.datasetElementType&&(e.dataset=new this.datasetElementType)}buildOrUpdateElements(e){const t=this._cachedMeta,n=this.getDataset();let i=!1;this._dataCheck();const r=t._stacked;t._stacked=hae(t.vScale,t),t.stack!==n.stack&&(i=!0,gae(t),t.stack=n.stack),this._resyncElements(e),(i||r!==t._stacked)&&(fae(this,t._parsed),t._stacked=hae(t.vScale,t))}configure(){const e=this.chart.config,t=e.datasetScopeKeys(this._type),n=e.getOptionScopes(this.getDataset(),t,!0);this.options=e.createResolver(n,this.getContext()),this._parsing=this.options.parsing,this._cachedDataOpts={}}parse(e,t){const{_cachedMeta:n,_data:i}=this,{iScale:r,_stacked:s}=n,a=r.axis;let o,l,u,c=0===e&&t===i.length||n._sorted,h=e>0&&n._parsed[e-1];if(!1===this._parsing)n._parsed=i,n._sorted=!0,u=i;else{u=gie(i[e])?this.parseArrayData(n,i,e,t):vie(i[e])?this.parseObjectData(n,i,e,t):this.parsePrimitiveData(n,i,e,t);const r=()=>null===l[a]||h&&l[a]<h[a];for(o=0;o<t;++o)n._parsed[o+e]=l=u[o],c&&(r()&&(c=!1),h=l);n._sorted=c}s&&fae(this,u)}parsePrimitiveData(e,t,n,i){const{iScale:r,vScale:s}=e,a=r.axis,o=s.axis,l=r.getLabels(),u=r===s,c=new Array(i);let h,d,p;for(h=0,d=i;h<d;++h)p=h+n,c[h]={[a]:u||r.parse(l[p],p),[o]:s.parse(t[p],p)};return c}parseArrayData(e,t,n,i){const{xScale:r,yScale:s}=e,a=new Array(i);let o,l,u,c;for(o=0,l=i;o<l;++o)u=o+n,c=t[u],a[o]={x:r.parse(c[0],u),y:s.parse(c[1],u)};return a}parseObjectData(e,t,n,i){const{xScale:r,yScale:s}=e,{xAxisKey:a="x",yAxisKey:o="y"}=this._parsing,l=new Array(i);let u,c,h,d;for(u=0,c=i;u<c;++u)h=u+n,d=t[h],l[u]={x:r.parse(Oie(d,a),h),y:s.parse(Oie(d,o),h)};return l}getParsed(e){return this._cachedMeta._parsed[e]}getDataElement(e){return this._cachedMeta.data[e]}applyStack(e,t,n){const i=this.chart,r=this._cachedMeta,s=t[e.axis];return cae({keys:uae(i,!0),values:t._stacks[e.axis]._visualValues},s,r.index,{mode:n})}updateRangeFromParsed(e,t,n,i){const r=n[t.axis];let s=null===r?NaN:r;const a=i&&n._stacks[t.axis];i&&a&&(i.values=a,s=cae(i,r,this._cachedMeta.index)),e.min=Math.min(e.min,s),e.max=Math.max(e.max,s)}getMinMax(e,t){const n=this._cachedMeta,i=n._parsed,r=n._sorted&&e===n.iScale,s=i.length,a=this._getOtherScale(e),o=((e,t,n)=>e&&!t.hidden&&t._stacked&&{keys:uae(n,!0),values:null})(t,n,this.chart),l={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY},{min:u,max:c}=function(e){const{min:t,max:n,minDefined:i,maxDefined:r}=e.getUserBounds();return{min:i?t:Number.NEGATIVE_INFINITY,max:r?n:Number.POSITIVE_INFINITY}}(a);let h,d;function p(){d=i[h];const t=d[a.axis];return!yie(d[e.axis])||u>t||c<t}for(h=0;h<s&&(p()||(this.updateRangeFromParsed(l,e,d,o),!r));++h);if(r)for(h=s-1;h>=0;--h)if(!p()){this.updateRangeFromParsed(l,e,d,o);break}return l}getAllParsedValues(e){const t=this._cachedMeta._parsed,n=[];let i,r,s;for(i=0,r=t.length;i<r;++i)s=t[i][e.axis],yie(s)&&n.push(s);return n}getMaxOverflow(){return!1}getLabelAndValue(e){const t=this._cachedMeta,n=t.iScale,i=t.vScale,r=this.getParsed(e);return{label:n?""+n.getLabelForValue(r[n.axis]):"",value:i?""+i.getLabelForValue(r[i.axis]):""}}_update(e){const t=this._cachedMeta;this.update(e||"default"),t._clip=function(e){let t,n,i,r;return vie(e)?(t=e.top,n=e.right,i=e.bottom,r=e.left):t=n=i=r=e,{top:t,right:n,bottom:i,left:r,disabled:!1===e}}(bie(this.options.clip,function(e,t,n){if(!1===n)return!1;const i=lae(e,n),r=lae(t,n);return{top:r.end,right:i.end,bottom:r.start,left:i.start}}(t.xScale,t.yScale,this.getMaxOverflow())))}update(e){}draw(){const e=this._ctx,t=this.chart,n=this._cachedMeta,i=n.data||[],r=t.chartArea,s=[],a=this._drawStart||0,o=this._drawCount||i.length-a,l=this.options.drawActiveElementsOnTop;let u;for(n.dataset&&n.dataset.draw(e,r,a,o),u=a;u<a+o;++u){const t=i[u];t.hidden||(t.active&&l?s.push(t):t.draw(e,r))}for(u=0;u<s.length;++u)s[u].draw(e,r)}getStyle(e,t){const n=t?"active":"default";return void 0===e&&this._cachedMeta.dataset?this.resolveDatasetElementOptions(n):this.resolveDataElementOptions(e||0,n)}getContext(e,t,n){const i=this.getDataset();let r;if(e>=0&&e<this._cachedMeta.data.length){const t=this._cachedMeta.data[e];r=t.$context||(t.$context=function(e,t,n){return use(e,{active:!1,dataIndex:t,parsed:void 0,raw:void 0,element:n,index:t,mode:"default",type:"data"})}(this.getContext(),e,t)),r.parsed=this.getParsed(e),r.raw=i.data[e],r.index=r.dataIndex=e}else r=this.$context||(this.$context=function(e,t){return use(e,{active:!1,dataset:void 0,datasetIndex:t,index:t,mode:"default",type:"dataset"})}(this.chart.getContext(),this.index)),r.dataset=i,r.index=r.datasetIndex=this.index;return r.active=!!t,r.mode=n,r}resolveDatasetElementOptions(e){return this._resolveElementOptions(this.datasetElementType.id,e)}resolveDataElementOptions(e,t){return this._resolveElementOptions(this.dataElementType.id,t,e)}_resolveElementOptions(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"default",n=arguments.length>2?arguments[2]:void 0;const i="active"===t,r=this._cachedDataOpts,s=e+"-"+t,a=r[s],o=this.enableOptionSharing&&kie(n);if(a)return yae(a,o);const l=this.chart.config,u=l.datasetElementScopeKeys(this._type,e),c=i?["".concat(e,"Hover"),"hover",e,""]:[e,""],h=l.getOptionScopes(this.getDataset(),u),d=Object.keys(Lre.elements[e]),p=l.resolveNamedOptions(h,d,(()=>this.getContext(n,i,t)),c);return p.$shared&&(p.$shared=o,r[s]=Object.freeze(yae(p,o))),p}_resolveAnimations(e,t,n){const i=this.chart,r=this._cachedDataOpts,s="animation-".concat(t),a=r[s];if(a)return a;let o;if(!1!==i.options.animation){const i=this.chart.config,r=i.datasetAnimationScopeKeys(this._type,t),s=i.getOptionScopes(this.getDataset(),r);o=i.createResolver(s,this.getContext(e,n,t))}const l=new oae(i,o&&o.animations);return o&&o._cacheable&&(r[s]=Object.freeze(l)),l}getSharedOptions(e){if(e.$shared)return this._sharedOptions||(this._sharedOptions=Object.assign({},e))}includeOptions(e,t){return!t||vae(e)||this.chart._animationsDisabled}_getSharedOptions(e,t){const n=this.resolveDataElementOptions(e,t),i=this._sharedOptions,r=this.getSharedOptions(n),s=this.includeOptions(t,r)||r!==i;return this.updateSharedOptions(r,t,n),{sharedOptions:r,includeOptions:s}}updateElement(e,t,n,i){vae(i)?Object.assign(e,n):this._resolveAnimations(t,i).update(e,n)}updateSharedOptions(e,t,n){e&&!vae(t)&&this._resolveAnimations(void 0,t).update(e,n)}_setStyle(e,t,n,i){e.active=i;const r=this.getStyle(t,i);this._resolveAnimations(t,n,i).update(e,{options:!i&&this.getSharedOptions(r)||r})}removeHoverStyle(e,t,n){this._setStyle(e,n,"active",!1)}setHoverStyle(e,t,n){this._setStyle(e,n,"active",!0)}_removeDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!1)}_setDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!0)}_resyncElements(e){const t=this._data,n=this._cachedMeta.data;for(const[a,o,l]of this._syncList)this[a](o,l);this._syncList=[];const i=n.length,r=t.length,s=Math.min(r,i);s&&this.parse(0,s),r>i?this._insertElements(i,r-i,e):r<i&&this._removeElements(r,i-r)}_insertElements(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const i=this._cachedMeta,r=i.data,s=e+t;let a;const o=e=>{for(e.length+=t,a=e.length-1;a>=s;a--)e[a]=e[a-t]};for(o(r),a=e;a<s;++a)r[a]=new this.dataElementType;this._parsing&&o(i._parsed),this.parse(e,t),n&&this.updateElements(r,e,t,"reset")}updateElements(e,t,n,i){}_removeElements(e,t){const n=this._cachedMeta;if(this._parsing){const i=n._parsed.splice(e,t);n._stacked&&gae(n,i)}n.data.splice(e,t)}_sync(e){if(this._parsing)this._syncList.push(e);else{const[t,n,i]=e;this[t](n,i)}this.chart._dataChanges.push([this.index,...e])}_onDataPush(){const e=arguments.length;this._sync(["_insertElements",this.getDataset().data.length-e,e])}_onDataPop(){this._sync(["_removeElements",this._cachedMeta.data.length-1,1])}_onDataShift(){this._sync(["_removeElements",0,1])}_onDataSplice(e,t){t&&this._sync(["_removeElements",e,t]);const n=arguments.length-2;n&&this._sync(["_insertElements",e,n])}_onDataUnshift(){this._sync(["_insertElements",0,arguments.length])}}function bae(e){const t=e.iScale,n=function(e,t){if(!e._cache.$bar){const n=e.getMatchingVisibleMetas(t);let i=[];for(let t=0,r=n.length;t<r;t++)i=i.concat(n[t].controller.getAllParsedValues(e));e._cache.$bar=dre(i.sort(((e,t)=>e-t)))}return e._cache.$bar}(t,e.type);let i,r,s,a,o=t._length;const l=()=>{32767!==s&&-32768!==s&&(kie(a)&&(o=Math.min(o,Math.abs(s-a)||o)),a=s)};for(i=0,r=n.length;i<r;++i)s=t.getPixelForValue(n[i]),l();for(a=void 0,i=0,r=t.ticks.length;i<r;++i)s=t.getPixelForTick(i),l();return o}function wae(e,t,n,i){return gie(e)?function(e,t,n,i){const r=n.parse(e[0],i),s=n.parse(e[1],i),a=Math.min(r,s),o=Math.max(r,s);let l=a,u=o;Math.abs(a)>Math.abs(o)&&(l=o,u=a),t[n.axis]=u,t._custom={barStart:l,barEnd:u,start:r,end:s,min:a,max:o}}(e,t,n,i):t[n.axis]=n.parse(e,i),t}function Dae(e,t,n,i){const r=e.iScale,s=e.vScale,a=r.getLabels(),o=r===s,l=[];let u,c,h,d;for(u=n,c=n+i;u<c;++u)d=t[u],h={},h[r.axis]=o||r.parse(a[u],u),l.push(wae(d,h,s,u));return l}function _ae(e){return e&&void 0!==e.barStart&&void 0!==e.barEnd}function Sae(e,t,n,i){let r=t.borderSkipped;const s={};if(!r)return void(e.borderSkipped=s);if(!0===r)return void(e.borderSkipped={top:!0,right:!0,bottom:!0,left:!0});const{start:a,end:o,reverse:l,top:u,bottom:c}=function(e){let t,n,i,r,s;return e.horizontal?(t=e.base>e.x,n="left",i="right"):(t=e.base<e.y,n="bottom",i="top"),t?(r="end",s="start"):(r="start",s="end"),{start:n,end:i,reverse:t,top:r,bottom:s}}(e);"middle"===r&&n&&(e.enableBorderRadius=!0,(n._top||0)===i?r=u:(n._bottom||0)===i?r=c:(s[Eae(c,a,o,l)]=!0,r=u)),s[Eae(r,a,o,l)]=!0,e.borderSkipped=s}function Eae(e,t,n,i){return i?(e=function(e,t,n){return e===t?n:e===n?t:e}(e,t,n),e=Cae(e,n,t)):e=Cae(e,t,n),e}function Cae(e,t,n){return"start"===e?t:"end"===e?n:e}function Aae(e,t,n){let{inflateAmount:i}=t;e.inflateAmount="auto"===i?1===n?.33:0:i}c(xae,"defaults",{}),c(xae,"datasetElementType",null),c(xae,"dataElementType",null);class Mae extends xae{parsePrimitiveData(e,t,n,i){return Dae(e,t,n,i)}parseArrayData(e,t,n,i){return Dae(e,t,n,i)}parseObjectData(e,t,n,i){const{iScale:r,vScale:s}=e,{xAxisKey:a="x",yAxisKey:o="y"}=this._parsing,l="x"===r.axis?a:o,u="x"===s.axis?a:o,c=[];let h,d,p,f;for(h=n,d=n+i;h<d;++h)f=t[h],p={},p[r.axis]=r.parse(Oie(f,l),h),c.push(wae(Oie(f,u),p,s,h));return c}updateRangeFromParsed(e,t,n,i){super.updateRangeFromParsed(e,t,n,i);const r=n._custom;r&&t===this._cachedMeta.vScale&&(e.min=Math.min(e.min,r.min),e.max=Math.max(e.max,r.max))}getMaxOverflow(){return 0}getLabelAndValue(e){const t=this._cachedMeta,{iScale:n,vScale:i}=t,r=this.getParsed(e),s=r._custom,a=_ae(s)?"["+s.start+", "+s.end+"]":""+i.getLabelForValue(r[i.axis]);return{label:""+n.getLabelForValue(r[n.axis]),value:a}}initialize(){this.enableOptionSharing=!0,super.initialize();this._cachedMeta.stack=this.getDataset().stack}update(e){const t=this._cachedMeta;this.updateElements(t.data,0,t.data.length,e)}updateElements(e,t,n,i){const r="reset"===i,{index:s,_cachedMeta:{vScale:a}}=this,o=a.getBasePixel(),l=a.isHorizontal(),u=this._getRuler(),{sharedOptions:c,includeOptions:h}=this._getSharedOptions(t,i);for(let d=t;d<t+n;d++){const t=this.getParsed(d),n=r||mie(t[a.axis])?{base:o,head:o}:this._calculateBarValuePixels(d),p=this._calculateBarIndexPixels(d,u),f=(t._stacks||{})[a.axis],m={horizontal:l,base:n.base,enableBorderRadius:!f||_ae(t._custom)||s===f._top||s===f._bottom,x:l?n.head:p.center,y:l?p.center:n.head,height:l?p.size:Math.abs(n.size),width:l?Math.abs(n.size):p.size};h&&(m.options=c||this.resolveDataElementOptions(d,e[d].active?"active":i));const g=m.options||e[d].options;Sae(m,g,f,s),Aae(m,g,u.ratio),this.updateElement(e[d],d,m,i)}}_getStacks(e,t){const{iScale:n}=this._cachedMeta,i=n.getMatchingVisibleMetas(this._type).filter((e=>e.controller.options.grouped)),r=n.options.stacked,s=[],a=this._cachedMeta.controller.getParsed(t),o=a&&a[n.axis],l=e=>{const t=e._parsed.find((e=>e[n.axis]===o)),i=t&&t[e.vScale.axis];if(mie(i)||isNaN(i))return!0};for(const u of i)if((void 0===t||!l(u))&&((!1===r||-1===s.indexOf(u.stack)||void 0===r&&void 0===u.stack)&&s.push(u.stack),u.index===e))break;return s.length||s.push(void 0),s}_getStackCount(e){return this._getStacks(void 0,e).length}_getStackIndex(e,t,n){const i=this._getStacks(e,n),r=void 0!==t?i.indexOf(t):-1;return-1===r?i.length-1:r}_getRuler(){const e=this.options,t=this._cachedMeta,n=t.iScale,i=[];let r,s;for(r=0,s=t.data.length;r<s;++r)i.push(n.getPixelForValue(this.getParsed(r)[n.axis],r));const a=e.barThickness;return{min:a||bae(t),pixels:i,start:n._startPixel,end:n._endPixel,stackCount:this._getStackCount(),scale:n,grouped:e.grouped,ratio:a?1:e.categoryPercentage*e.barPercentage}}_calculateBarValuePixels(e){const{_cachedMeta:{vScale:t,_stacked:n,index:i},options:{base:r,minBarLength:s}}=this,a=r||0,o=this.getParsed(e),l=o._custom,u=_ae(l);let c,h,d=o[t.axis],p=0,f=n?this.applyStack(t,o,n):d;f!==d&&(p=f-d,f=d),u&&(d=l.barStart,f=l.barEnd-l.barStart,0!==d&&qie(d)!==qie(l.barEnd)&&(p=0),p+=d);const m=mie(r)||u?p:r;let g=t.getPixelForValue(m);if(c=this.chart.getDataVisibility(e)?t.getPixelForValue(p+f):g,h=c-g,Math.abs(h)<s){h=function(e,t,n){return 0!==e?qie(e):(t.isHorizontal()?1:-1)*(t.min>=n?1:-1)}(h,t,a)*s,d===a&&(g-=h/2);const e=t.getPixelForDecimal(0),r=t.getPixelForDecimal(1),l=Math.min(e,r),p=Math.max(e,r);g=Math.max(Math.min(g,p),l),c=g+h,n&&!u&&(o._stacks[t.axis]._visualValues[i]=t.getValueForPixel(c)-t.getValueForPixel(g))}if(g===t.getPixelForValue(a)){const e=qie(h)*t.getLineWidthForValue(a)/2;g+=e,h-=e}return{size:h,base:g,head:c,center:c+h/2}}_calculateBarIndexPixels(e,t){const n=t.scale,i=this.options,r=i.skipNull,s=bie(i.maxBarThickness,1/0);let a,o;if(t.grouped){const n=r?this._getStackCount(e):t.stackCount,l="flex"===i.barThickness?function(e,t,n,i){const r=t.pixels,s=r[e];let a=e>0?r[e-1]:null,o=e<r.length-1?r[e+1]:null;const l=n.categoryPercentage;null===a&&(a=s-(null===o?t.end-t.start:o-s)),null===o&&(o=s+s-a);const u=s-(s-Math.min(a,o))/2*l;return{chunk:Math.abs(o-a)/2*l/i,ratio:n.barPercentage,start:u}}(e,t,i,n):function(e,t,n,i){const r=n.barThickness;let s,a;return mie(r)?(s=t.min*n.categoryPercentage,a=n.barPercentage):(s=r*i,a=1),{chunk:s/i,ratio:a,start:t.pixels[e]-s/2}}(e,t,i,n),u=this._getStackIndex(this.index,this._cachedMeta.stack,r?e:void 0);a=l.start+l.chunk*u+l.chunk/2,o=Math.min(s,l.chunk*l.ratio)}else a=n.getPixelForValue(this.getParsed(e)[n.axis],e),o=Math.min(s,t.min*t.ratio);return{base:a-o/2,head:a+o/2,center:a,size:o}}draw(){const e=this._cachedMeta,t=e.vScale,n=e.data,i=n.length;let r=0;for(;r<i;++r)null===this.getParsed(r)[t.axis]||n[r].hidden||n[r].draw(this._ctx)}}c(Mae,"id","bar"),c(Mae,"defaults",{datasetElementType:!1,dataElementType:"bar",categoryPercentage:.8,barPercentage:.9,grouped:!0,animations:{numbers:{type:"number",properties:["x","y","base","width","height"]}}}),c(Mae,"overrides",{scales:{_index_:{type:"category",offset:!0,grid:{offset:!0}},_value_:{type:"linear",beginAtZero:!0}}});class Tae extends xae{initialize(){this.enableOptionSharing=!0,super.initialize()}parsePrimitiveData(e,t,n,i){const r=super.parsePrimitiveData(e,t,n,i);for(let s=0;s<r.length;s++)r[s]._custom=this.resolveDataElementOptions(s+n).radius;return r}parseArrayData(e,t,n,i){const r=super.parseArrayData(e,t,n,i);for(let s=0;s<r.length;s++){const e=t[n+s];r[s]._custom=bie(e[2],this.resolveDataElementOptions(s+n).radius)}return r}parseObjectData(e,t,n,i){const r=super.parseObjectData(e,t,n,i);for(let s=0;s<r.length;s++){const e=t[n+s];r[s]._custom=bie(e&&e.r&&+e.r,this.resolveDataElementOptions(s+n).radius)}return r}getMaxOverflow(){const e=this._cachedMeta.data;let t=0;for(let n=e.length-1;n>=0;--n)t=Math.max(t,e[n].size(this.resolveDataElementOptions(n))/2);return t>0&&t}getLabelAndValue(e){const t=this._cachedMeta,n=this.chart.data.labels||[],{xScale:i,yScale:r}=t,s=this.getParsed(e),a=i.getLabelForValue(s.x),o=r.getLabelForValue(s.y),l=s._custom;return{label:n[e]||"",value:"("+a+", "+o+(l?", "+l:"")+")"}}update(e){const t=this._cachedMeta.data;this.updateElements(t,0,t.length,e)}updateElements(e,t,n,i){const r="reset"===i,{iScale:s,vScale:a}=this._cachedMeta,{sharedOptions:o,includeOptions:l}=this._getSharedOptions(t,i),u=s.axis,c=a.axis;for(let h=t;h<t+n;h++){const t=e[h],n=!r&&this.getParsed(h),d={},p=d[u]=r?s.getPixelForDecimal(.5):s.getPixelForValue(n[u]),f=d[c]=r?a.getBasePixel():a.getPixelForValue(n[c]);d.skip=isNaN(p)||isNaN(f),l&&(d.options=o||this.resolveDataElementOptions(h,t.active?"active":i),r&&(d.options.radius=0)),this.updateElement(t,h,d,i)}}resolveDataElementOptions(e,t){const n=this.getParsed(e);let i=super.resolveDataElementOptions(e,t);i.$shared&&(i=Object.assign({},i,{$shared:!1}));const r=i.radius;return"active"!==t&&(i.radius=0),i.radius+=bie(n&&n._custom,r),i}}c(Tae,"id","bubble"),c(Tae,"defaults",{datasetElementType:!1,dataElementType:"point",animations:{numbers:{type:"number",properties:["x","y","borderWidth","radius"]}}}),c(Tae,"overrides",{scales:{x:{type:"linear"},y:{type:"linear"}}});class Pae extends xae{constructor(e,t){super(e,t),this.enableOptionSharing=!0,this.innerRadius=void 0,this.outerRadius=void 0,this.offsetX=void 0,this.offsetY=void 0}linkScales(){}parse(e,t){const n=this.getDataset().data,i=this._cachedMeta;if(!1===this._parsing)i._parsed=n;else{let r,s,a=e=>+n[e];if(vie(n[e])){const{key:e="value"}=this._parsing;a=t=>+Oie(n[t],e)}for(r=e,s=e+t;r<s;++r)i._parsed[r]=a(r)}}_getRotation(){return Zie(this.options.rotation-90)}_getCircumference(){return Zie(this.options.circumference)}_getRotationExtents(){let e=zie,t=-zie;for(let n=0;n<this.chart.data.datasets.length;++n)if(this.chart.isDatasetVisible(n)&&this.chart.getDatasetMeta(n).type===this._type){const i=this.chart.getDatasetMeta(n).controller,r=i._getRotation(),s=i._getCircumference();e=Math.min(e,r),t=Math.max(t,r+s)}return{rotation:e,circumference:t-e}}update(e){const t=this.chart,{chartArea:n}=t,i=this._cachedMeta,r=i.data,s=this.getMaxBorderWidth()+this.getMaxOffset(r)+this.options.spacing,a=Math.max((Math.min(n.width,n.height)-s)/2,0),o=Math.min((l=this.options.cutout,u=a,"string"===typeof l&&l.endsWith("%")?parseFloat(l)/100:+l/u),1);var l,u;const c=this._getRingWeight(this.index),{circumference:h,rotation:d}=this._getRotationExtents(),{ratioX:p,ratioY:f,offsetX:m,offsetY:g}=function(e,t,n){let i=1,r=1,s=0,a=0;if(t<zie){const o=e,l=o+t,u=Math.cos(o),c=Math.sin(o),h=Math.cos(l),d=Math.sin(l),p=(e,t,i)=>rre(e,o,l,!0)?1:Math.max(t,t*n,i,i*n),f=(e,t,i)=>rre(e,o,l,!0)?-1:Math.min(t,t*n,i,i*n),m=p(0,u,h),g=p(Vie,c,d),v=f(Lie,u,h),y=f(Lie+Vie,c,d);i=(m-v)/2,r=(g-y)/2,s=-(m+v)/2,a=-(g+y)/2}return{ratioX:i,ratioY:r,offsetX:s,offsetY:a}}(d,h,o),v=(n.width-s)/p,y=(n.height-s)/f,x=Math.max(Math.min(v,y)/2,0),b=wie(this.options.radius,x),w=(b-Math.max(b*o,0))/this._getVisibleDatasetWeightTotal();this.offsetX=m*b,this.offsetY=g*b,i.total=this.calculateTotal(),this.outerRadius=b-w*this._getRingWeightOffset(this.index),this.innerRadius=Math.max(this.outerRadius-w*c,0),this.updateElements(r,0,r.length,e)}_circumference(e,t){const n=this.options,i=this._cachedMeta,r=this._getCircumference();return t&&n.animation.animateRotate||!this.chart.getDataVisibility(e)||null===i._parsed[e]||i.data[e].hidden?0:this.calculateCircumference(i._parsed[e]*r/zie)}updateElements(e,t,n,i){const r="reset"===i,s=this.chart,a=s.chartArea,o=s.options.animation,l=(a.left+a.right)/2,u=(a.top+a.bottom)/2,c=r&&o.animateScale,h=c?0:this.innerRadius,d=c?0:this.outerRadius,{sharedOptions:p,includeOptions:f}=this._getSharedOptions(t,i);let m,g=this._getRotation();for(m=0;m<t;++m)g+=this._circumference(m,r);for(m=t;m<t+n;++m){const t=this._circumference(m,r),n=e[m],s={x:l+this.offsetX,y:u+this.offsetY,startAngle:g,endAngle:g+t,circumference:t,outerRadius:d,innerRadius:h};f&&(s.options=p||this.resolveDataElementOptions(m,n.active?"active":i)),g+=t,this.updateElement(n,m,s,i)}}calculateTotal(){const e=this._cachedMeta,t=e.data;let n,i=0;for(n=0;n<t.length;n++){const r=e._parsed[n];null===r||isNaN(r)||!this.chart.getDataVisibility(n)||t[n].hidden||(i+=Math.abs(r))}return i}calculateCircumference(e){const t=this._cachedMeta.total;return t>0&&!isNaN(e)?zie*(Math.abs(e)/t):0}getLabelAndValue(e){const t=this._cachedMeta,n=this.chart,i=n.data.labels||[],r=Tre(t._parsed[e],n.options.locale);return{label:i[e]||"",value:r}}getMaxBorderWidth(e){let t=0;const n=this.chart;let i,r,s,a,o;if(!e)for(i=0,r=n.data.datasets.length;i<r;++i)if(n.isDatasetVisible(i)){s=n.getDatasetMeta(i),e=s.data,a=s.controller;break}if(!e)return 0;for(i=0,r=e.length;i<r;++i)o=a.resolveDataElementOptions(i),"inner"!==o.borderAlign&&(t=Math.max(t,o.borderWidth||0,o.hoverBorderWidth||0));return t}getMaxOffset(e){let t=0;for(let n=0,i=e.length;n<i;++n){const e=this.resolveDataElementOptions(n);t=Math.max(t,e.offset||0,e.hoverOffset||0)}return t}_getRingWeightOffset(e){let t=0;for(let n=0;n<e;++n)this.chart.isDatasetVisible(n)&&(t+=this._getRingWeight(n));return t}_getRingWeight(e){return Math.max(bie(this.chart.data.datasets[e].weight,1),0)}_getVisibleDatasetWeightTotal(){return this._getRingWeightOffset(this.chart.data.datasets.length)||1}}c(Pae,"id","doughnut"),c(Pae,"defaults",{datasetElementType:!1,dataElementType:"arc",animation:{animateRotate:!0,animateScale:!1},animations:{numbers:{type:"number",properties:["circumference","endAngle","innerRadius","outerRadius","startAngle","x","y","offset","borderWidth","spacing"]}},cutout:"50%",rotation:0,circumference:360,radius:"100%",spacing:0,indexAxis:"r"}),c(Pae,"descriptors",{_scriptable:e=>"spacing"!==e,_indexable:e=>"spacing"!==e&&!e.startsWith("borderDash")&&!e.startsWith("hoverBorderDash")}),c(Pae,"overrides",{aspectRatio:1,plugins:{legend:{labels:{generateLabels(e){const t=e.data;if(t.labels.length&&t.datasets.length){const{labels:{pointStyle:n,color:i}}=e.legend.options;return t.labels.map(((t,r)=>{const s=e.getDatasetMeta(0).controller.getStyle(r);return{text:t,fillStyle:s.backgroundColor,strokeStyle:s.borderColor,fontColor:i,lineWidth:s.borderWidth,pointStyle:n,hidden:!e.getDataVisibility(r),index:r}}))}return[]}},onClick(e,t,n){n.chart.toggleDataVisibility(t.index),n.chart.update()}}}});class Fae extends xae{initialize(){this.enableOptionSharing=!0,this.supportsDecimation=!0,super.initialize()}update(e){const t=this._cachedMeta,{dataset:n,data:i=[],_dataset:r}=t,s=this.chart._animationsDisabled;let{start:a,count:o}=vre(t,i,s);this._drawStart=a,this._drawCount=o,yre(t)&&(a=0,o=i.length),n._chart=this.chart,n._datasetIndex=this.index,n._decimated=!!r._decimated,n.points=i;const l=this.resolveDatasetElementOptions(e);this.options.showLine||(l.borderWidth=0),l.segment=this.options.segment,this.updateElement(n,void 0,{animated:!s,options:l},e),this.updateElements(i,a,o,e)}updateElements(e,t,n,i){const r="reset"===i,{iScale:s,vScale:a,_stacked:o,_dataset:l}=this._cachedMeta,{sharedOptions:u,includeOptions:c}=this._getSharedOptions(t,i),h=s.axis,d=a.axis,{spanGaps:p,segment:f}=this.options,m=Qie(p)?p:Number.POSITIVE_INFINITY,g=this.chart._animationsDisabled||r||"none"===i,v=t+n,y=e.length;let x=t>0&&this.getParsed(t-1);for(let b=0;b<y;++b){const n=e[b],p=g?n:{};if(b<t||b>=v){p.skip=!0;continue}const y=this.getParsed(b),w=mie(y[d]),D=p[h]=s.getPixelForValue(y[h],b),_=p[d]=r||w?a.getBasePixel():a.getPixelForValue(o?this.applyStack(a,y,o):y[d],b);p.skip=isNaN(D)||isNaN(_)||w,p.stop=b>0&&Math.abs(y[h]-x[h])>m,f&&(p.parsed=y,p.raw=l.data[b]),c&&(p.options=u||this.resolveDataElementOptions(b,n.active?"active":i)),g||this.updateElement(n,b,p,i),x=y}}getMaxOverflow(){const e=this._cachedMeta,t=e.dataset,n=t.options&&t.options.borderWidth||0,i=e.data||[];if(!i.length)return n;const r=i[0].size(this.resolveDataElementOptions(0)),s=i[i.length-1].size(this.resolveDataElementOptions(i.length-1));return Math.max(n,r,s)/2}draw(){const e=this._cachedMeta;e.dataset.updateControlPoints(this.chart.chartArea,e.iScale.axis),super.draw()}}c(Fae,"id","line"),c(Fae,"defaults",{datasetElementType:"line",dataElementType:"point",showLine:!0,spanGaps:!1}),c(Fae,"overrides",{scales:{_index_:{type:"category"},_value_:{type:"linear"}}});class Oae extends xae{constructor(e,t){super(e,t),this.innerRadius=void 0,this.outerRadius=void 0}getLabelAndValue(e){const t=this._cachedMeta,n=this.chart,i=n.data.labels||[],r=Tre(t._parsed[e].r,n.options.locale);return{label:i[e]||"",value:r}}parseObjectData(e,t,n,i){return _se.bind(this)(e,t,n,i)}update(e){const t=this._cachedMeta.data;this._updateRadius(),this.updateElements(t,0,t.length,e)}getMinMax(){const e=this._cachedMeta,t={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY};return e.data.forEach(((e,n)=>{const i=this.getParsed(n).r;!isNaN(i)&&this.chart.getDataVisibility(n)&&(i<t.min&&(t.min=i),i>t.max&&(t.max=i))})),t}_updateRadius(){const e=this.chart,t=e.chartArea,n=e.options,i=Math.min(t.right-t.left,t.bottom-t.top),r=Math.max(i/2,0),s=(r-Math.max(n.cutoutPercentage?r/100*n.cutoutPercentage:1,0))/e.getVisibleDatasetCount();this.outerRadius=r-s*this.index,this.innerRadius=this.outerRadius-s}updateElements(e,t,n,i){const r="reset"===i,s=this.chart,a=s.options.animation,o=this._cachedMeta.rScale,l=o.xCenter,u=o.yCenter,c=o.getIndexAngle(0)-.5*Lie;let h,d=c;const p=360/this.countVisibleElements();for(h=0;h<t;++h)d+=this._computeAngle(h,i,p);for(h=t;h<t+n;h++){const t=e[h];let n=d,f=d+this._computeAngle(h,i,p),m=s.getDataVisibility(h)?o.getDistanceFromCenterForValue(this.getParsed(h).r):0;d=f,r&&(a.animateScale&&(m=0),a.animateRotate&&(n=f=c));const g={x:l,y:u,innerRadius:0,outerRadius:m,startAngle:n,endAngle:f,options:this.resolveDataElementOptions(h,t.active?"active":i)};this.updateElement(t,h,g,i)}}countVisibleElements(){const e=this._cachedMeta;let t=0;return e.data.forEach(((e,n)=>{!isNaN(this.getParsed(n).r)&&this.chart.getDataVisibility(n)&&t++})),t}_computeAngle(e,t,n){return this.chart.getDataVisibility(e)?Zie(this.resolveDataElementOptions(e,t).angle||n):0}}c(Oae,"id","polarArea"),c(Oae,"defaults",{dataElementType:"arc",animation:{animateRotate:!0,animateScale:!0},animations:{numbers:{type:"number",properties:["x","y","startAngle","endAngle","innerRadius","outerRadius"]}},indexAxis:"r",startAngle:0}),c(Oae,"overrides",{aspectRatio:1,plugins:{legend:{labels:{generateLabels(e){const t=e.data;if(t.labels.length&&t.datasets.length){const{labels:{pointStyle:n,color:i}}=e.legend.options;return t.labels.map(((t,r)=>{const s=e.getDatasetMeta(0).controller.getStyle(r);return{text:t,fillStyle:s.backgroundColor,strokeStyle:s.borderColor,fontColor:i,lineWidth:s.borderWidth,pointStyle:n,hidden:!e.getDataVisibility(r),index:r}}))}return[]}},onClick(e,t,n){n.chart.toggleDataVisibility(t.index),n.chart.update()}}},scales:{r:{type:"radialLinear",angleLines:{display:!1},beginAtZero:!0,grid:{circular:!0},pointLabels:{display:!1},startAngle:0}}});class Iae extends Pae{}c(Iae,"id","pie"),c(Iae,"defaults",{cutout:0,rotation:0,circumference:360,radius:"100%"});class kae extends xae{getLabelAndValue(e){const t=this._cachedMeta.vScale,n=this.getParsed(e);return{label:t.getLabels()[e],value:""+t.getLabelForValue(n[t.axis])}}parseObjectData(e,t,n,i){return _se.bind(this)(e,t,n,i)}update(e){const t=this._cachedMeta,n=t.dataset,i=t.data||[],r=t.iScale.getLabels();if(n.points=i,"resize"!==e){const t=this.resolveDatasetElementOptions(e);this.options.showLine||(t.borderWidth=0);const s={_loop:!0,_fullLoop:r.length===i.length,options:t};this.updateElement(n,void 0,s,e)}this.updateElements(i,0,i.length,e)}updateElements(e,t,n,i){const r=this._cachedMeta.rScale,s="reset"===i;for(let a=t;a<t+n;a++){const t=e[a],n=this.resolveDataElementOptions(a,t.active?"active":i),o=r.getPointPositionForValue(a,this.getParsed(a).r),l=s?r.xCenter:o.x,u=s?r.yCenter:o.y,c={x:l,y:u,angle:o.angle,skip:isNaN(l)||isNaN(u),options:n};this.updateElement(t,a,c,i)}}}c(kae,"id","radar"),c(kae,"defaults",{datasetElementType:"line",dataElementType:"point",indexAxis:"r",showLine:!0,elements:{line:{fill:"start"}}}),c(kae,"overrides",{aspectRatio:1,scales:{r:{type:"radialLinear"}}});class Bae extends xae{getLabelAndValue(e){const t=this._cachedMeta,n=this.chart.data.labels||[],{xScale:i,yScale:r}=t,s=this.getParsed(e),a=i.getLabelForValue(s.x),o=r.getLabelForValue(s.y);return{label:n[e]||"",value:"("+a+", "+o+")"}}update(e){const t=this._cachedMeta,{data:n=[]}=t,i=this.chart._animationsDisabled;let{start:r,count:s}=vre(t,n,i);if(this._drawStart=r,this._drawCount=s,yre(t)&&(r=0,s=n.length),this.options.showLine){this.datasetElementType||this.addElements();const{dataset:r,_dataset:s}=t;r._chart=this.chart,r._datasetIndex=this.index,r._decimated=!!s._decimated,r.points=n;const a=this.resolveDatasetElementOptions(e);a.segment=this.options.segment,this.updateElement(r,void 0,{animated:!i,options:a},e)}else this.datasetElementType&&(delete t.dataset,this.datasetElementType=!1);this.updateElements(n,r,s,e)}addElements(){const{showLine:e}=this.options;!this.datasetElementType&&e&&(this.datasetElementType=this.chart.registry.getElement("line")),super.addElements()}updateElements(e,t,n,i){const r="reset"===i,{iScale:s,vScale:a,_stacked:o,_dataset:l}=this._cachedMeta,u=this.resolveDataElementOptions(t,i),c=this.getSharedOptions(u),h=this.includeOptions(i,c),d=s.axis,p=a.axis,{spanGaps:f,segment:m}=this.options,g=Qie(f)?f:Number.POSITIVE_INFINITY,v=this.chart._animationsDisabled||r||"none"===i;let y=t>0&&this.getParsed(t-1);for(let x=t;x<t+n;++x){const t=e[x],n=this.getParsed(x),u=v?t:{},f=mie(n[p]),b=u[d]=s.getPixelForValue(n[d],x),w=u[p]=r||f?a.getBasePixel():a.getPixelForValue(o?this.applyStack(a,n,o):n[p],x);u.skip=isNaN(b)||isNaN(w)||f,u.stop=x>0&&Math.abs(n[d]-y[d])>g,m&&(u.parsed=n,u.raw=l.data[x]),h&&(u.options=c||this.resolveDataElementOptions(x,t.active?"active":i)),v||this.updateElement(t,x,u,i),y=n}this.updateSharedOptions(c,i,u)}getMaxOverflow(){const e=this._cachedMeta,t=e.data||[];if(!this.options.showLine){let e=0;for(let n=t.length-1;n>=0;--n)e=Math.max(e,t[n].size(this.resolveDataElementOptions(n))/2);return e>0&&e}const n=e.dataset,i=n.options&&n.options.borderWidth||0;if(!t.length)return i;const r=t[0].size(this.resolveDataElementOptions(0)),s=t[t.length-1].size(this.resolveDataElementOptions(t.length-1));return Math.max(i,r,s)/2}}c(Bae,"id","scatter"),c(Bae,"defaults",{datasetElementType:!1,dataElementType:"point",showLine:!1,fill:!1}),c(Bae,"overrides",{interaction:{mode:"point"},scales:{x:{type:"linear"},y:{type:"linear"}}});var Rae=Object.freeze({__proto__:null,BarController:Mae,BubbleController:Tae,DoughnutController:Pae,LineController:Fae,PieController:Iae,PolarAreaController:Oae,RadarController:kae,ScatterController:Bae});function Lae(){throw new Error("This method is not implemented: Check that a complete date adapter is provided.")}class zae{static override(e){Object.assign(zae.prototype,e)}constructor(e){c(this,"options",void 0),this.options=e||{}}init(){}formats(){return Lae()}parse(){return Lae()}format(){return Lae()}add(){return Lae()}diff(){return Lae()}startOf(){return Lae()}endOf(){return Lae()}}var Nae=zae;function jae(e,t,n,i){const{controller:r,data:s,_sorted:a}=e,o=r._cachedMeta.iScale;if(o&&t===o.axis&&"r"!==t&&a&&s.length){const e=o._reversePixels?ure:lre;if(!i)return e(s,t,n);if(r._sharedOptions){const i=s[0],r="function"===typeof i.getRange&&i.getRange(t);if(r){const i=e(s,t,n-r),a=e(s,t,n+r);return{lo:i.lo,hi:a.hi}}}}return{lo:0,hi:s.length-1}}function Uae(e,t,n,i,r){const s=e.getSortedVisibleDatasetMetas(),a=n[t];for(let o=0,l=s.length;o<l;++o){const{index:e,data:n}=s[o],{lo:l,hi:u}=jae(s[o],t,a,r);for(let t=l;t<=u;++t){const r=n[t];r.skip||i(r,e,t)}}}function Vae(e,t,n,i,r){const s=[];if(!r&&!e.isPointInArea(t))return s;return Uae(e,n,t,(function(n,a,o){(r||Wre(n,e.chartArea,0))&&n.inRange(t.x,t.y,i)&&s.push({element:n,datasetIndex:a,index:o})}),!0),s}function Hae(e,t,n,i,r,s){let a=[];const o=function(e){const t=-1!==e.indexOf("x"),n=-1!==e.indexOf("y");return function(e,i){const r=t?Math.abs(e.x-i.x):0,s=n?Math.abs(e.y-i.y):0;return Math.sqrt(Math.pow(r,2)+Math.pow(s,2))}}(n);let l=Number.POSITIVE_INFINITY;return Uae(e,n,t,(function(n,u,c){const h=n.inRange(t.x,t.y,r);if(i&&!h)return;const d=n.getCenterPoint(r);if(!(!!s||e.isPointInArea(d))&&!h)return;const p=o(t,d);p<l?(a=[{element:n,datasetIndex:u,index:c}],l=p):p===l&&a.push({element:n,datasetIndex:u,index:c})})),a}function Wae(e,t,n,i,r,s){return s||e.isPointInArea(t)?"r"!==n||i?Hae(e,t,n,i,r,s):function(e,t,n,i){let r=[];return Uae(e,n,t,(function(e,n,s){const{startAngle:a,endAngle:o}=e.getProps(["startAngle","endAngle"],i),{angle:l}=ere(e,{x:t.x,y:t.y});rre(l,a,o)&&r.push({element:e,datasetIndex:n,index:s})})),r}(e,t,n,r):[]}function Gae(e,t,n,i,r){const s=[],a="x"===n?"inXRange":"inYRange";let o=!1;return Uae(e,n,t,((e,i,l)=>{e[a]&&e[a](t[n],r)&&(s.push({element:e,datasetIndex:i,index:l}),o=o||e.inRange(t.x,t.y,r))})),i&&!o?[]:s}var qae={evaluateInteractionItems:Uae,modes:{index(e,t,n,i){const r=Lse(t,e),s=n.axis||"x",a=n.includeInvisible||!1,o=n.intersect?Vae(e,r,s,i,a):Wae(e,r,s,!1,i,a),l=[];return o.length?(e.getSortedVisibleDatasetMetas().forEach((e=>{const t=o[0].index,n=e.data[t];n&&!n.skip&&l.push({element:n,datasetIndex:e.index,index:t})})),l):[]},dataset(e,t,n,i){const r=Lse(t,e),s=n.axis||"xy",a=n.includeInvisible||!1;let o=n.intersect?Vae(e,r,s,i,a):Wae(e,r,s,!1,i,a);if(o.length>0){const t=o[0].datasetIndex,n=e.getDatasetMeta(t).data;o=[];for(let e=0;e<n.length;++e)o.push({element:n[e],datasetIndex:t,index:e})}return o},point:(e,t,n,i)=>Vae(e,Lse(t,e),n.axis||"xy",i,n.includeInvisible||!1),nearest(e,t,n,i){const r=Lse(t,e),s=n.axis||"xy",a=n.includeInvisible||!1;return Wae(e,r,s,n.intersect,i,a)},x:(e,t,n,i)=>Gae(e,Lse(t,e),"x",n.intersect,i),y:(e,t,n,i)=>Gae(e,Lse(t,e),"y",n.intersect,i)}};const Yae=["left","top","right","bottom"];function Xae(e,t){return e.filter((e=>e.pos===t))}function Qae(e,t){return e.filter((e=>-1===Yae.indexOf(e.pos)&&e.box.axis===t))}function Kae(e,t){return e.sort(((e,n)=>{const i=t?n:e,r=t?e:n;return i.weight===r.weight?i.index-r.index:i.weight-r.weight}))}function Zae(e,t){const n=function(e){const t={};for(const n of e){const{stack:e,pos:i,stackWeight:r}=n;if(!e||!Yae.includes(i))continue;const s=t[e]||(t[e]={count:0,placed:0,weight:0,size:0});s.count++,s.weight+=r}return t}(e),{vBoxMaxWidth:i,hBoxMaxHeight:r}=t;let s,a,o;for(s=0,a=e.length;s<a;++s){o=e[s];const{fullSize:a}=o.box,l=n[o.stack],u=l&&o.stackWeight/l.weight;o.horizontal?(o.width=u?u*i:a&&t.availableWidth,o.height=r):(o.width=i,o.height=u?u*r:a&&t.availableHeight)}return n}function Jae(e,t,n,i){return Math.max(e[n],t[n])+Math.max(e[i],t[i])}function $ae(e,t){e.top=Math.max(e.top,t.top),e.left=Math.max(e.left,t.left),e.bottom=Math.max(e.bottom,t.bottom),e.right=Math.max(e.right,t.right)}function eoe(e,t,n,i){const{pos:r,box:s}=n,a=e.maxPadding;if(!vie(r)){n.size&&(e[r]-=n.size);const t=i[n.stack]||{size:0,count:1};t.size=Math.max(t.size,n.horizontal?s.height:s.width),n.size=t.size/t.count,e[r]+=n.size}s.getPadding&&$ae(a,s.getPadding());const o=Math.max(0,t.outerWidth-Jae(a,e,"left","right")),l=Math.max(0,t.outerHeight-Jae(a,e,"top","bottom")),u=o!==e.w,c=l!==e.h;return e.w=o,e.h=l,n.horizontal?{same:u,other:c}:{same:c,other:u}}function toe(e,t){const n=t.maxPadding;function i(e){const i={left:0,top:0,right:0,bottom:0};return e.forEach((e=>{i[e]=Math.max(t[e],n[e])})),i}return i(e?["left","right"]:["top","bottom"])}function noe(e,t,n,i){const r=[];let s,a,o,l,u,c;for(s=0,a=e.length,u=0;s<a;++s){o=e[s],l=o.box,l.update(o.width||t.w,o.height||t.h,toe(o.horizontal,t));const{same:a,other:h}=eoe(t,n,o,i);u|=a&&r.length,c=c||h,l.fullSize||r.push(o)}return u&&noe(r,t,n,i)||c}function ioe(e,t,n,i,r){e.top=n,e.left=t,e.right=t+i,e.bottom=n+r,e.width=i,e.height=r}function roe(e,t,n,i){const r=n.padding;let{x:s,y:a}=t;for(const o of e){const e=o.box,l=i[o.stack]||{count:1,placed:0,weight:1},u=o.stackWeight/l.weight||1;if(o.horizontal){const i=t.w*u,s=l.size||e.height;kie(l.start)&&(a=l.start),e.fullSize?ioe(e,r.left,a,n.outerWidth-r.right-r.left,s):ioe(e,t.left+l.placed,a,i,s),l.start=a,l.placed+=i,a=e.bottom}else{const i=t.h*u,a=l.size||e.width;kie(l.start)&&(s=l.start),e.fullSize?ioe(e,s,r.top,a,n.outerHeight-r.bottom-r.top):ioe(e,s,t.top+l.placed,a,i),l.start=s,l.placed+=i,s=e.right}}t.x=s,t.y=a}var soe={addBox(e,t){e.boxes||(e.boxes=[]),t.fullSize=t.fullSize||!1,t.position=t.position||"top",t.weight=t.weight||0,t._layers=t._layers||function(){return[{z:0,draw(e){t.draw(e)}}]},e.boxes.push(t)},removeBox(e,t){const n=e.boxes?e.boxes.indexOf(t):-1;-1!==n&&e.boxes.splice(n,1)},configure(e,t,n){t.fullSize=n.fullSize,t.position=n.position,t.weight=n.weight},update(e,t,n,i){if(!e)return;const r=ase(e.options.layout.padding),s=Math.max(t-r.width,0),a=Math.max(n-r.height,0),o=function(e){const t=function(e){const t=[];let n,i,r,s,a,o;for(n=0,i=(e||[]).length;n<i;++n)r=e[n],({position:s,options:{stack:a,stackWeight:o=1}}=r),t.push({index:n,box:r,pos:s,horizontal:r.isHorizontal(),weight:r.weight,stack:a&&s+a,stackWeight:o});return t}(e),n=Kae(t.filter((e=>e.box.fullSize)),!0),i=Kae(Xae(t,"left"),!0),r=Kae(Xae(t,"right")),s=Kae(Xae(t,"top"),!0),a=Kae(Xae(t,"bottom")),o=Qae(t,"x"),l=Qae(t,"y");return{fullSize:n,leftAndTop:i.concat(s),rightAndBottom:r.concat(l).concat(a).concat(o),chartArea:Xae(t,"chartArea"),vertical:i.concat(r).concat(l),horizontal:s.concat(a).concat(o)}}(e.boxes),l=o.vertical,u=o.horizontal;_ie(e.boxes,(e=>{"function"===typeof e.beforeLayout&&e.beforeLayout()}));const c=l.reduce(((e,t)=>t.box.options&&!1===t.box.options.display?e:e+1),0)||1,h=Object.freeze({outerWidth:t,outerHeight:n,padding:r,availableWidth:s,availableHeight:a,vBoxMaxWidth:s/2/c,hBoxMaxHeight:a/2}),d=Object.assign({},r);$ae(d,ase(i));const p=Object.assign({maxPadding:d,w:s,h:a,x:r.left,y:r.top},r),f=Zae(l.concat(u),h);noe(o.fullSize,p,h,f),noe(l,p,h,f),noe(u,p,h,f)&&noe(l,p,h,f),function(e){const t=e.maxPadding;function n(n){const i=Math.max(t[n]-e[n],0);return e[n]+=i,i}e.y+=n("top"),e.x+=n("left"),n("right"),n("bottom")}(p),roe(o.leftAndTop,p,h,f),p.x+=p.w,p.y+=p.h,roe(o.rightAndBottom,p,h,f),e.chartArea={left:p.left,top:p.top,right:p.left+p.w,bottom:p.top+p.h,height:p.h,width:p.w},_ie(o.chartArea,(t=>{const n=t.box;Object.assign(n,e.chartArea),n.update(p.w,p.h,{left:0,top:0,right:0,bottom:0})}))}};class aoe{acquireContext(e,t){}releaseContext(e){return!1}addEventListener(e,t,n){}removeEventListener(e,t,n){}getDevicePixelRatio(){return 1}getMaximumSize(e,t,n,i){return t=Math.max(0,t||e.width),n=n||e.height,{width:t,height:Math.max(0,i?Math.floor(t/i):n)}}isAttached(e){return!0}updateConfig(e){}}class ooe extends aoe{acquireContext(e){return e&&e.getContext&&e.getContext("2d")||null}updateConfig(e){e.options.animation=!1}}const loe="$chartjs",uoe={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"},coe=e=>null===e||""===e;const hoe=!!Use&&{passive:!0};function doe(e,t,n){e&&e.canvas&&e.canvas.removeEventListener(t,n,hoe)}function poe(e,t){for(const n of e)if(n===t||n.contains(t))return!0}function foe(e,t,n){const i=e.canvas,r=new MutationObserver((e=>{let t=!1;for(const n of e)t=t||poe(n.addedNodes,i),t=t&&!poe(n.removedNodes,i);t&&n()}));return r.observe(document,{childList:!0,subtree:!0}),r}function moe(e,t,n){const i=e.canvas,r=new MutationObserver((e=>{let t=!1;for(const n of e)t=t||poe(n.removedNodes,i),t=t&&!poe(n.addedNodes,i);t&&n()}));return r.observe(document,{childList:!0,subtree:!0}),r}const goe=new Map;let voe=0;function yoe(){const e=window.devicePixelRatio;e!==voe&&(voe=e,goe.forEach(((t,n)=>{n.currentDevicePixelRatio!==e&&t()})))}function xoe(e,t,n){const i=e.canvas,r=i&&Ose(i);if(!r)return;const s=fre(((e,t)=>{const i=r.clientWidth;n(e,t),i<r.clientWidth&&n()}),window),a=new ResizeObserver((e=>{const t=e[0],n=t.contentRect.width,i=t.contentRect.height;0===n&&0===i||s(n,i)}));return a.observe(r),function(e,t){goe.size||window.addEventListener("resize",yoe),goe.set(e,t)}(e,s),a}function boe(e,t,n){n&&n.disconnect(),"resize"===t&&function(e){goe.delete(e),goe.size||window.removeEventListener("resize",yoe)}(e)}function woe(e,t,n){const i=e.canvas,r=fre((t=>{null!==e.ctx&&n(function(e,t){const n=uoe[e.type]||e.type,{x:i,y:r}=Lse(e,t);return{type:n,chart:t,native:e,x:void 0!==i?i:null,y:void 0!==r?r:null}}(t,e))}),e);return function(e,t,n){e&&e.addEventListener(t,n,hoe)}(i,t,r),r}class Doe extends aoe{acquireContext(e,t){const n=e&&e.getContext&&e.getContext("2d");return n&&n.canvas===e?(function(e,t){const n=e.style,i=e.getAttribute("height"),r=e.getAttribute("width");if(e[loe]={initial:{height:i,width:r,style:{display:n.display,height:n.height,width:n.width}}},n.display=n.display||"block",n.boxSizing=n.boxSizing||"border-box",coe(r)){const t=Vse(e,"width");void 0!==t&&(e.width=t)}if(coe(i))if(""===e.style.height)e.height=e.width/(t||2);else{const t=Vse(e,"height");void 0!==t&&(e.height=t)}}(e,t),n):null}releaseContext(e){const t=e.canvas;if(!t[loe])return!1;const n=t[loe].initial;["height","width"].forEach((e=>{const i=n[e];mie(i)?t.removeAttribute(e):t.setAttribute(e,i)}));const i=n.style||{};return Object.keys(i).forEach((e=>{t.style[e]=i[e]})),t.width=t.width,delete t[loe],!0}addEventListener(e,t,n){this.removeEventListener(e,t);const i=e.$proxies||(e.$proxies={}),r={attach:foe,detach:moe,resize:xoe}[t]||woe;i[t]=r(e,t,n)}removeEventListener(e,t){const n=e.$proxies||(e.$proxies={}),i=n[t];if(!i)return;({attach:boe,detach:boe,resize:boe}[t]||doe)(e,t,i),n[t]=void 0}getDevicePixelRatio(){return window.devicePixelRatio}getMaximumSize(e,t,n,i){return Nse(e,t,n,i)}isAttached(e){const t=e&&Ose(e);return!(!t||!t.isConnected)}}class _oe{constructor(){c(this,"x",void 0),c(this,"y",void 0),c(this,"active",!1),c(this,"options",void 0),c(this,"$animations",void 0)}tooltipPosition(e){const{x:t,y:n}=this.getProps(["x","y"],e);return{x:t,y:n}}hasValue(){return Qie(this.x)&&Qie(this.y)}getProps(e,t){const n=this.$animations;if(!t||!n)return this;const i={};return e.forEach((e=>{i[e]=n[e]&&n[e].active()?n[e]._to:this[e]})),i}}function Soe(e,t){const n=e.options.ticks,i=function(e){const t=e.options.offset,n=e._tickSize(),i=e._length/n+(t?0:1),r=e._maxLength/n;return Math.floor(Math.min(i,r))}(e),r=Math.min(n.maxTicksLimit||i,i),s=n.major.enabled?function(e){const t=[];let n,i;for(n=0,i=e.length;n<i;n++)e[n].major&&t.push(n);return t}(t):[],a=s.length,o=s[0],l=s[a-1],u=[];if(a>r)return function(e,t,n,i){let r,s=0,a=n[0];for(i=Math.ceil(i),r=0;r<e.length;r++)r===a&&(t.push(e[r]),s++,a=n[s*i])}(t,u,s,a/r),u;const c=function(e,t,n){const i=function(e){const t=e.length;let n,i;if(t<2)return!1;for(i=e[0],n=1;n<t;++n)if(e[n]-e[n-1]!==i)return!1;return i}(e),r=t.length/n;if(!i)return Math.max(r,1);const s=function(e){const t=[],n=Math.sqrt(e);let i;for(i=1;i<n;i++)e%i===0&&(t.push(i),t.push(e/i));return n===(0|n)&&t.push(n),t.sort(((e,t)=>e-t)).pop(),t}(i);for(let a=0,o=s.length-1;a<o;a++){const e=s[a];if(e>r)return e}return Math.max(r,1)}(s,t,r);if(a>0){let e,n;const i=a>1?Math.round((l-o)/(a-1)):null;for(Eoe(t,u,c,mie(i)?0:o-i,o),e=0,n=a-1;e<n;e++)Eoe(t,u,c,s[e],s[e+1]);return Eoe(t,u,c,l,mie(i)?t.length:l+i),u}return Eoe(t,u,c),u}function Eoe(e,t,n,i,r){const s=bie(i,0),a=Math.min(bie(r,e.length),e.length);let o,l,u,c=0;for(n=Math.ceil(n),r&&(o=r-i,n=o/Math.floor(o/n)),u=s;u<0;)c++,u=Math.round(s+c*n);for(l=Math.max(s,0);l<a;l++)l===u&&(t.push(e[l]),c++,u=Math.round(s+c*n))}c(_oe,"defaults",{}),c(_oe,"defaultRoutes",void 0);const Coe=(e,t,n)=>"top"===t||"left"===t?e[t]+n:e[t]-n,Aoe=(e,t)=>Math.min(t||e,e);function Moe(e,t){const n=[],i=e.length/t,r=e.length;let s=0;for(;s<r;s+=i)n.push(e[Math.floor(s)]);return n}function Toe(e,t,n){const i=e.ticks.length,r=Math.min(t,i-1),s=e._startPixel,a=e._endPixel,o=1e-6;let l,u=e.getPixelForTick(r);if(!(n&&(l=1===i?Math.max(u-s,a-u):0===t?(e.getPixelForTick(1)-u)/2:(u-e.getPixelForTick(r-1))/2,u+=r<t?l:-l,u<s-o||u>a+o)))return u}function Poe(e){return e.drawTicks?e.tickLength:0}function Foe(e,t){if(!e.display)return 0;const n=ose(e.font,t),i=ase(e.padding);return(gie(e.text)?e.text.length:1)*n.lineHeight+i.height}function Ooe(e,t,n){let i=mre(e);return(n&&"right"!==t||!n&&"right"===t)&&(i=(e=>"left"===e?"right":"right"===e?"left":e)(i)),i}class Ioe extends _oe{constructor(e){super(),this.id=e.id,this.type=e.type,this.options=void 0,this.ctx=e.ctx,this.chart=e.chart,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this._margins={left:0,right:0,top:0,bottom:0},this.maxWidth=void 0,this.maxHeight=void 0,this.paddingTop=void 0,this.paddingBottom=void 0,this.paddingLeft=void 0,this.paddingRight=void 0,this.axis=void 0,this.labelRotation=void 0,this.min=void 0,this.max=void 0,this._range=void 0,this.ticks=[],this._gridLineItems=null,this._labelItems=null,this._labelSizes=null,this._length=0,this._maxLength=0,this._longestTextCache={},this._startPixel=void 0,this._endPixel=void 0,this._reversePixels=!1,this._userMax=void 0,this._userMin=void 0,this._suggestedMax=void 0,this._suggestedMin=void 0,this._ticksLength=0,this._borderValue=0,this._cache={},this._dataLimitsCached=!1,this.$context=void 0}init(e){this.options=e.setContext(this.getContext()),this.axis=e.axis,this._userMin=this.parse(e.min),this._userMax=this.parse(e.max),this._suggestedMin=this.parse(e.suggestedMin),this._suggestedMax=this.parse(e.suggestedMax)}parse(e,t){return e}getUserBounds(){let{_userMin:e,_userMax:t,_suggestedMin:n,_suggestedMax:i}=this;return e=xie(e,Number.POSITIVE_INFINITY),t=xie(t,Number.NEGATIVE_INFINITY),n=xie(n,Number.POSITIVE_INFINITY),i=xie(i,Number.NEGATIVE_INFINITY),{min:xie(e,n),max:xie(t,i),minDefined:yie(e),maxDefined:yie(t)}}getMinMax(e){let t,{min:n,max:i,minDefined:r,maxDefined:s}=this.getUserBounds();if(r&&s)return{min:n,max:i};const a=this.getMatchingVisibleMetas();for(let o=0,l=a.length;o<l;++o)t=a[o].controller.getMinMax(this,e),r||(n=Math.min(n,t.min)),s||(i=Math.max(i,t.max));return n=s&&n>i?i:n,i=r&&n>i?n:i,{min:xie(n,xie(i,n)),max:xie(i,xie(n,i))}}getPadding(){return{left:this.paddingLeft||0,top:this.paddingTop||0,right:this.paddingRight||0,bottom:this.paddingBottom||0}}getTicks(){return this.ticks}getLabels(){const e=this.chart.data;return this.options.labels||(this.isHorizontal()?e.xLabels:e.yLabels)||e.labels||[]}getLabelItems(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.chart.chartArea;return this._labelItems||(this._labelItems=this._computeLabelItems(e))}beforeLayout(){this._cache={},this._dataLimitsCached=!1}beforeUpdate(){Die(this.options.beforeUpdate,[this])}update(e,t,n){const{beginAtZero:i,grace:r,ticks:s}=this.options,a=s.sampleSize;this.beforeUpdate(),this.maxWidth=e,this.maxHeight=t,this._margins=n=Object.assign({left:0,right:0,top:0,bottom:0},n),this.ticks=null,this._labelSizes=null,this._gridLineItems=null,this._labelItems=null,this.beforeSetDimensions(),this.setDimensions(),this.afterSetDimensions(),this._maxLength=this.isHorizontal()?this.width+n.left+n.right:this.height+n.top+n.bottom,this._dataLimitsCached||(this.beforeDataLimits(),this.determineDataLimits(),this.afterDataLimits(),this._range=function(e,t,n){const{min:i,max:r}=e,s=wie(t,(r-i)/2),a=(e,t)=>n&&0===e?0:e+t;return{min:a(i,-Math.abs(s)),max:a(r,s)}}(this,r,i),this._dataLimitsCached=!0),this.beforeBuildTicks(),this.ticks=this.buildTicks()||[],this.afterBuildTicks();const o=a<this.ticks.length;this._convertTicksToLabels(o?Moe(this.ticks,a):this.ticks),this.configure(),this.beforeCalculateLabelRotation(),this.calculateLabelRotation(),this.afterCalculateLabelRotation(),s.display&&(s.autoSkip||"auto"===s.source)&&(this.ticks=Soe(this,this.ticks),this._labelSizes=null,this.afterAutoSkip()),o&&this._convertTicksToLabels(this.ticks),this.beforeFit(),this.fit(),this.afterFit(),this.afterUpdate()}configure(){let e,t,n=this.options.reverse;this.isHorizontal()?(e=this.left,t=this.right):(e=this.top,t=this.bottom,n=!n),this._startPixel=e,this._endPixel=t,this._reversePixels=n,this._length=t-e,this._alignToPixels=this.options.alignToPixels}afterUpdate(){Die(this.options.afterUpdate,[this])}beforeSetDimensions(){Die(this.options.beforeSetDimensions,[this])}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=0,this.right=this.width):(this.height=this.maxHeight,this.top=0,this.bottom=this.height),this.paddingLeft=0,this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0}afterSetDimensions(){Die(this.options.afterSetDimensions,[this])}_callHooks(e){this.chart.notifyPlugins(e,this.getContext()),Die(this.options[e],[this])}beforeDataLimits(){this._callHooks("beforeDataLimits")}determineDataLimits(){}afterDataLimits(){this._callHooks("afterDataLimits")}beforeBuildTicks(){this._callHooks("beforeBuildTicks")}buildTicks(){return[]}afterBuildTicks(){this._callHooks("afterBuildTicks")}beforeTickToLabelConversion(){Die(this.options.beforeTickToLabelConversion,[this])}generateTickLabels(e){const t=this.options.ticks;let n,i,r;for(n=0,i=e.length;n<i;n++)r=e[n],r.label=Die(t.callback,[r.value,n,e],this)}afterTickToLabelConversion(){Die(this.options.afterTickToLabelConversion,[this])}beforeCalculateLabelRotation(){Die(this.options.beforeCalculateLabelRotation,[this])}calculateLabelRotation(){const e=this.options,t=e.ticks,n=Aoe(this.ticks.length,e.ticks.maxTicksLimit),i=t.minRotation||0,r=t.maxRotation;let s,a,o,l=i;if(!this._isVisible()||!t.display||i>=r||n<=1||!this.isHorizontal())return void(this.labelRotation=i);const u=this._getLabelSizes(),c=u.widest.width,h=u.highest.height,d=sre(this.chart.width-c,0,this.maxWidth);s=e.offset?this.maxWidth/n:d/(n-1),c+6>s&&(s=d/(n-(e.offset?.5:1)),a=this.maxHeight-Poe(e.grid)-t.padding-Foe(e.title,this.chart.options.font),o=Math.sqrt(c*c+h*h),l=Jie(Math.min(Math.asin(sre((u.highest.height+6)/s,-1,1)),Math.asin(sre(a/o,-1,1))-Math.asin(sre(h/o,-1,1)))),l=Math.max(i,Math.min(r,l))),this.labelRotation=l}afterCalculateLabelRotation(){Die(this.options.afterCalculateLabelRotation,[this])}afterAutoSkip(){}beforeFit(){Die(this.options.beforeFit,[this])}fit(){const e={width:0,height:0},{chart:t,options:{ticks:n,title:i,grid:r}}=this,s=this._isVisible(),a=this.isHorizontal();if(s){const s=Foe(i,t.options.font);if(a?(e.width=this.maxWidth,e.height=Poe(r)+s):(e.height=this.maxHeight,e.width=Poe(r)+s),n.display&&this.ticks.length){const{first:t,last:i,widest:r,highest:s}=this._getLabelSizes(),o=2*n.padding,l=Zie(this.labelRotation),u=Math.cos(l),c=Math.sin(l);if(a){const t=n.mirror?0:c*r.width+u*s.height;e.height=Math.min(this.maxHeight,e.height+t+o)}else{const t=n.mirror?0:u*r.width+c*s.height;e.width=Math.min(this.maxWidth,e.width+t+o)}this._calculatePadding(t,i,c,u)}}this._handleMargins(),a?(this.width=this._length=t.width-this._margins.left-this._margins.right,this.height=e.height):(this.width=e.width,this.height=this._length=t.height-this._margins.top-this._margins.bottom)}_calculatePadding(e,t,n,i){const{ticks:{align:r,padding:s},position:a}=this.options,o=0!==this.labelRotation,l="top"!==a&&"x"===this.axis;if(this.isHorizontal()){const a=this.getPixelForTick(0)-this.left,u=this.right-this.getPixelForTick(this.ticks.length-1);let c=0,h=0;o?l?(c=i*e.width,h=n*t.height):(c=n*e.height,h=i*t.width):"start"===r?h=t.width:"end"===r?c=e.width:"inner"!==r&&(c=e.width/2,h=t.width/2),this.paddingLeft=Math.max((c-a+s)*this.width/(this.width-a),0),this.paddingRight=Math.max((h-u+s)*this.width/(this.width-u),0)}else{let n=t.height/2,i=e.height/2;"start"===r?(n=0,i=e.height):"end"===r&&(n=t.height,i=0),this.paddingTop=n+s,this.paddingBottom=i+s}}_handleMargins(){this._margins&&(this._margins.left=Math.max(this.paddingLeft,this._margins.left),this._margins.top=Math.max(this.paddingTop,this._margins.top),this._margins.right=Math.max(this.paddingRight,this._margins.right),this._margins.bottom=Math.max(this.paddingBottom,this._margins.bottom))}afterFit(){Die(this.options.afterFit,[this])}isHorizontal(){const{axis:e,position:t}=this.options;return"top"===t||"bottom"===t||"x"===e}isFullSize(){return this.options.fullSize}_convertTicksToLabels(e){let t,n;for(this.beforeTickToLabelConversion(),this.generateTickLabels(e),t=0,n=e.length;t<n;t++)mie(e[t].label)&&(e.splice(t,1),n--,t--);this.afterTickToLabelConversion()}_getLabelSizes(){let e=this._labelSizes;if(!e){const t=this.options.ticks.sampleSize;let n=this.ticks;t<n.length&&(n=Moe(n,t)),this._labelSizes=e=this._computeLabelSizes(n,n.length,this.options.ticks.maxTicksLimit)}return e}_computeLabelSizes(e,t,n){const{ctx:i,_longestTextCache:r}=this,s=[],a=[],o=Math.floor(t/Aoe(t,n));let l,u,c,h,d,p,f,m,g,v,y,x=0,b=0;for(l=0;l<t;l+=o){if(h=e[l].label,d=this._resolveTickFontOptions(l),i.font=p=d.string,f=r[p]=r[p]||{data:{},gc:[]},m=d.lineHeight,g=v=0,mie(h)||gie(h)){if(gie(h))for(u=0,c=h.length;u<c;++u)y=h[u],mie(y)||gie(y)||(g=zre(i,f.data,f.gc,g,y),v+=m)}else g=zre(i,f.data,f.gc,g,h),v=m;s.push(g),a.push(v),x=Math.max(g,x),b=Math.max(v,b)}!function(e,t){_ie(e,(e=>{const n=e.gc,i=n.length/2;let r;if(i>t){for(r=0;r<i;++r)delete e.data[n[r]];n.splice(0,i)}}))}(r,t);const w=s.indexOf(x),D=a.indexOf(b),_=e=>({width:s[e]||0,height:a[e]||0});return{first:_(0),last:_(t-1),widest:_(w),highest:_(D),widths:s,heights:a}}getLabelForValue(e){return e}getPixelForValue(e,t){return NaN}getValueForPixel(e){}getPixelForTick(e){const t=this.ticks;return e<0||e>t.length-1?null:this.getPixelForValue(t[e].value)}getPixelForDecimal(e){this._reversePixels&&(e=1-e);const t=this._startPixel+e*this._length;return sre(this._alignToPixels?jre(this.chart,t,0):t,-32768,32767)}getDecimalForPixel(e){const t=(e-this._startPixel)/this._length;return this._reversePixels?1-t:t}getBasePixel(){return this.getPixelForValue(this.getBaseValue())}getBaseValue(){const{min:e,max:t}=this;return e<0&&t<0?t:e>0&&t>0?e:0}getContext(e){const t=this.ticks||[];if(e>=0&&e<t.length){const n=t[e];return n.$context||(n.$context=function(e,t,n){return use(e,{tick:n,index:t,type:"tick"})}(this.getContext(),e,n))}return this.$context||(this.$context=use(this.chart.getContext(),{scale:this,type:"scale"}))}_tickSize(){const e=this.options.ticks,t=Zie(this.labelRotation),n=Math.abs(Math.cos(t)),i=Math.abs(Math.sin(t)),r=this._getLabelSizes(),s=e.autoSkipPadding||0,a=r?r.widest.width+s:0,o=r?r.highest.height+s:0;return this.isHorizontal()?o*n>a*i?a/n:o/i:o*i<a*n?o/n:a/i}_isVisible(){const e=this.options.display;return"auto"!==e?!!e:this.getMatchingVisibleMetas().length>0}_computeGridLineItems(e){const t=this.axis,n=this.chart,i=this.options,{grid:r,position:s,border:a}=i,o=r.offset,l=this.isHorizontal(),u=this.ticks.length+(o?1:0),c=Poe(r),h=[],d=a.setContext(this.getContext()),p=d.display?d.width:0,f=p/2,m=function(e){return jre(n,e,p)};let g,v,y,x,b,w,D,_,S,E,C,A;if("top"===s)g=m(this.bottom),w=this.bottom-c,_=g-f,E=m(e.top)+f,A=e.bottom;else if("bottom"===s)g=m(this.top),E=e.top,A=m(e.bottom)-f,w=g+f,_=this.top+c;else if("left"===s)g=m(this.right),b=this.right-c,D=g-f,S=m(e.left)+f,C=e.right;else if("right"===s)g=m(this.left),S=e.left,C=m(e.right)-f,b=g+f,D=this.left+c;else if("x"===t){if("center"===s)g=m((e.top+e.bottom)/2+.5);else if(vie(s)){const e=Object.keys(s)[0],t=s[e];g=m(this.chart.scales[e].getPixelForValue(t))}E=e.top,A=e.bottom,w=g+f,_=w+c}else if("y"===t){if("center"===s)g=m((e.left+e.right)/2);else if(vie(s)){const e=Object.keys(s)[0],t=s[e];g=m(this.chart.scales[e].getPixelForValue(t))}b=g-f,D=b-c,S=e.left,C=e.right}const M=bie(i.ticks.maxTicksLimit,u),T=Math.max(1,Math.ceil(u/M));for(v=0;v<u;v+=T){const e=this.getContext(v),t=r.setContext(e),i=a.setContext(e),s=t.lineWidth,u=t.color,c=i.dash||[],d=i.dashOffset,p=t.tickWidth,f=t.tickColor,m=t.tickBorderDash||[],g=t.tickBorderDashOffset;y=Toe(this,v,o),void 0!==y&&(x=jre(n,y,s),l?b=D=S=C=x:w=_=E=A=x,h.push({tx1:b,ty1:w,tx2:D,ty2:_,x1:S,y1:E,x2:C,y2:A,width:s,color:u,borderDash:c,borderDashOffset:d,tickWidth:p,tickColor:f,tickBorderDash:m,tickBorderDashOffset:g}))}return this._ticksLength=u,this._borderValue=g,h}_computeLabelItems(e){const t=this.axis,n=this.options,{position:i,ticks:r}=n,s=this.isHorizontal(),a=this.ticks,{align:o,crossAlign:l,padding:u,mirror:c}=r,h=Poe(n.grid),d=h+u,p=c?-u:d,f=-Zie(this.labelRotation),m=[];let g,v,y,x,b,w,D,_,S,E,C,A,M="middle";if("top"===i)w=this.bottom-p,D=this._getXAxisLabelAlignment();else if("bottom"===i)w=this.top+p,D=this._getXAxisLabelAlignment();else if("left"===i){const e=this._getYAxisLabelAlignment(h);D=e.textAlign,b=e.x}else if("right"===i){const e=this._getYAxisLabelAlignment(h);D=e.textAlign,b=e.x}else if("x"===t){if("center"===i)w=(e.top+e.bottom)/2+d;else if(vie(i)){const e=Object.keys(i)[0],t=i[e];w=this.chart.scales[e].getPixelForValue(t)+d}D=this._getXAxisLabelAlignment()}else if("y"===t){if("center"===i)b=(e.left+e.right)/2-d;else if(vie(i)){const e=Object.keys(i)[0],t=i[e];b=this.chart.scales[e].getPixelForValue(t)}D=this._getYAxisLabelAlignment(h).textAlign}"y"===t&&("start"===o?M="top":"end"===o&&(M="bottom"));const T=this._getLabelSizes();for(g=0,v=a.length;g<v;++g){y=a[g],x=y.label;const e=r.setContext(this.getContext(g));_=this.getPixelForTick(g)+r.labelOffset,S=this._resolveTickFontOptions(g),E=S.lineHeight,C=gie(x)?x.length:1;const t=C/2,n=e.color,o=e.textStrokeColor,u=e.textStrokeWidth;let h,d=D;if(s?(b=_,"inner"===D&&(d=g===v-1?this.options.reverse?"left":"right":0===g?this.options.reverse?"right":"left":"center"),A="top"===i?"near"===l||0!==f?-C*E+E/2:"center"===l?-T.highest.height/2-t*E+E:-T.highest.height+E/2:"near"===l||0!==f?E/2:"center"===l?T.highest.height/2-t*E:T.highest.height-C*E,c&&(A*=-1),0===f||e.showLabelBackdrop||(b+=E/2*Math.sin(f))):(w=_,A=(1-C)*E/2),e.showLabelBackdrop){const t=ase(e.backdropPadding),n=T.heights[g],i=T.widths[g];let r=A-t.top,s=0-t.left;switch(M){case"middle":r-=n/2;break;case"bottom":r-=n}switch(D){case"center":s-=i/2;break;case"right":s-=i;break;case"inner":g===v-1?s-=i:g>0&&(s-=i/2)}h={left:s,top:r,width:i+t.width,height:n+t.height,color:e.backdropColor}}m.push({label:x,font:S,textOffset:A,options:{rotation:f,color:n,strokeColor:o,strokeWidth:u,textAlign:d,textBaseline:M,translation:[b,w],backdrop:h}})}return m}_getXAxisLabelAlignment(){const{position:e,ticks:t}=this.options;if(-Zie(this.labelRotation))return"top"===e?"left":"right";let n="center";return"start"===t.align?n="left":"end"===t.align?n="right":"inner"===t.align&&(n="inner"),n}_getYAxisLabelAlignment(e){const{position:t,ticks:{crossAlign:n,mirror:i,padding:r}}=this.options,s=e+r,a=this._getLabelSizes().widest.width;let o,l;return"left"===t?i?(l=this.right+r,"near"===n?o="left":"center"===n?(o="center",l+=a/2):(o="right",l+=a)):(l=this.right-s,"near"===n?o="right":"center"===n?(o="center",l-=a/2):(o="left",l=this.left)):"right"===t?i?(l=this.left+r,"near"===n?o="right":"center"===n?(o="center",l-=a/2):(o="left",l-=a)):(l=this.left+s,"near"===n?o="left":"center"===n?(o="center",l+=a/2):(o="right",l=this.right)):o="right",{textAlign:o,x:l}}_computeLabelArea(){if(this.options.ticks.mirror)return;const e=this.chart,t=this.options.position;return"left"===t||"right"===t?{top:0,left:this.left,bottom:e.height,right:this.right}:"top"===t||"bottom"===t?{top:this.top,left:0,bottom:this.bottom,right:e.width}:void 0}drawBackground(){const{ctx:e,options:{backgroundColor:t},left:n,top:i,width:r,height:s}=this;t&&(e.save(),e.fillStyle=t,e.fillRect(n,i,r,s),e.restore())}getLineWidthForValue(e){const t=this.options.grid;if(!this._isVisible()||!t.display)return 0;const n=this.ticks.findIndex((t=>t.value===e));if(n>=0){return t.setContext(this.getContext(n)).lineWidth}return 0}drawGrid(e){const t=this.options.grid,n=this.ctx,i=this._gridLineItems||(this._gridLineItems=this._computeGridLineItems(e));let r,s;const a=(e,t,i)=>{i.width&&i.color&&(n.save(),n.lineWidth=i.width,n.strokeStyle=i.color,n.setLineDash(i.borderDash||[]),n.lineDashOffset=i.borderDashOffset,n.beginPath(),n.moveTo(e.x,e.y),n.lineTo(t.x,t.y),n.stroke(),n.restore())};if(t.display)for(r=0,s=i.length;r<s;++r){const e=i[r];t.drawOnChartArea&&a({x:e.x1,y:e.y1},{x:e.x2,y:e.y2},e),t.drawTicks&&a({x:e.tx1,y:e.ty1},{x:e.tx2,y:e.ty2},{color:e.tickColor,width:e.tickWidth,borderDash:e.tickBorderDash,borderDashOffset:e.tickBorderDashOffset})}}drawBorder(){const{chart:e,ctx:t,options:{border:n,grid:i}}=this,r=n.setContext(this.getContext()),s=n.display?r.width:0;if(!s)return;const a=i.setContext(this.getContext(0)).lineWidth,o=this._borderValue;let l,u,c,h;this.isHorizontal()?(l=jre(e,this.left,s)-s/2,u=jre(e,this.right,a)+a/2,c=h=o):(c=jre(e,this.top,s)-s/2,h=jre(e,this.bottom,a)+a/2,l=u=o),t.save(),t.lineWidth=r.width,t.strokeStyle=r.color,t.beginPath(),t.moveTo(l,c),t.lineTo(u,h),t.stroke(),t.restore()}drawLabels(e){if(!this.options.ticks.display)return;const t=this.ctx,n=this._computeLabelArea();n&&Gre(t,n);const i=this.getLabelItems(e);for(const r of i){const e=r.options,n=r.font;Zre(t,r.label,0,r.textOffset,n,e)}n&&qre(t)}drawTitle(){const{ctx:e,options:{position:t,title:n,reverse:i}}=this;if(!n.display)return;const r=ose(n.font),s=ase(n.padding),a=n.align;let o=r.lineHeight/2;"bottom"===t||"center"===t||vie(t)?(o+=s.bottom,gie(n.text)&&(o+=r.lineHeight*(n.text.length-1))):o+=s.top;const{titleX:l,titleY:u,maxWidth:c,rotation:h}=function(e,t,n,i){const{top:r,left:s,bottom:a,right:o,chart:l}=e,{chartArea:u,scales:c}=l;let h,d,p,f=0;const m=a-r,g=o-s;if(e.isHorizontal()){if(d=gre(i,s,o),vie(n)){const e=Object.keys(n)[0],i=n[e];p=c[e].getPixelForValue(i)+m-t}else p="center"===n?(u.bottom+u.top)/2+m-t:Coe(e,n,t);h=o-s}else{if(vie(n)){const e=Object.keys(n)[0],i=n[e];d=c[e].getPixelForValue(i)-g+t}else d="center"===n?(u.left+u.right)/2-g+t:Coe(e,n,t);p=gre(i,a,r),f="left"===n?-Vie:Vie}return{titleX:d,titleY:p,maxWidth:h,rotation:f}}(this,o,t,a);Zre(e,n.text,0,0,r,{color:n.color,maxWidth:c,rotation:h,textAlign:Ooe(a,t,i),textBaseline:"middle",translation:[l,u]})}draw(e){this._isVisible()&&(this.drawBackground(),this.drawGrid(e),this.drawBorder(),this.drawTitle(),this.drawLabels(e))}_layers(){const e=this.options,t=e.ticks&&e.ticks.z||0,n=bie(e.grid&&e.grid.z,-1),i=bie(e.border&&e.border.z,0);return this._isVisible()&&this.draw===Ioe.prototype.draw?[{z:n,draw:e=>{this.drawBackground(),this.drawGrid(e),this.drawTitle()}},{z:i,draw:()=>{this.drawBorder()}},{z:t,draw:e=>{this.drawLabels(e)}}]:[{z:t,draw:e=>{this.draw(e)}}]}getMatchingVisibleMetas(e){const t=this.chart.getSortedVisibleDatasetMetas(),n=this.axis+"AxisID",i=[];let r,s;for(r=0,s=t.length;r<s;++r){const s=t[r];s[n]!==this.id||e&&s.type!==e||i.push(s)}return i}_resolveTickFontOptions(e){return ose(this.options.ticks.setContext(this.getContext(e)).font)}_maxDigits(){const e=this._resolveTickFontOptions(0).lineHeight;return(this.isHorizontal()?this.width:this.height)/e}}class koe{constructor(e,t,n){this.type=e,this.scope=t,this.override=n,this.items=Object.create(null)}isForType(e){return Object.prototype.isPrototypeOf.call(this.type.prototype,e.prototype)}register(e){const t=Object.getPrototypeOf(e);let n;(function(e){return"id"in e&&"defaults"in e})(t)&&(n=this.register(t));const i=this.items,r=e.id,s=this.scope+"."+r;if(!r)throw new Error("class does not have id: "+e);return r in i||(i[r]=e,function(e,t,n){const i=Mie(Object.create(null),[n?Lre.get(n):{},Lre.get(t),e.defaults]);Lre.set(t,i),e.defaultRoutes&&function(e,t){Object.keys(t).forEach((n=>{const i=n.split("."),r=i.pop(),s=[e].concat(i).join("."),a=t[n].split("."),o=a.pop(),l=a.join(".");Lre.route(s,r,l,o)}))}(t,e.defaultRoutes);e.descriptors&&Lre.describe(t,e.descriptors)}(e,s,n),this.override&&Lre.override(e.id,e.overrides)),s}get(e){return this.items[e]}unregister(e){const t=this.items,n=e.id,i=this.scope;n in t&&delete t[n],i&&n in Lre[i]&&(delete Lre[i][n],this.override&&delete Ore[n])}}class Boe{constructor(){this.controllers=new koe(xae,"datasets",!0),this.elements=new koe(_oe,"elements"),this.plugins=new koe(Object,"plugins"),this.scales=new koe(Ioe,"scales"),this._typedRegistries=[this.controllers,this.scales,this.elements]}add(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._each("register",t)}remove(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._each("unregister",t)}addControllers(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._each("register",t,this.controllers)}addElements(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._each("register",t,this.elements)}addPlugins(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._each("register",t,this.plugins)}addScales(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._each("register",t,this.scales)}getController(e){return this._get(e,this.controllers,"controller")}getElement(e){return this._get(e,this.elements,"element")}getPlugin(e){return this._get(e,this.plugins,"plugin")}getScale(e){return this._get(e,this.scales,"scale")}removeControllers(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._each("unregister",t,this.controllers)}removeElements(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._each("unregister",t,this.elements)}removePlugins(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._each("unregister",t,this.plugins)}removeScales(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._each("unregister",t,this.scales)}_each(e,t,n){[...t].forEach((t=>{const i=n||this._getRegistryForType(t);n||i.isForType(t)||i===this.plugins&&t.id?this._exec(e,i,t):_ie(t,(t=>{const i=n||this._getRegistryForType(t);this._exec(e,i,t)}))}))}_exec(e,t,n){const i=Iie(e);Die(n["before"+i],[],n),t[e](n),Die(n["after"+i],[],n)}_getRegistryForType(e){for(let t=0;t<this._typedRegistries.length;t++){const n=this._typedRegistries[t];if(n.isForType(e))return n}return this.plugins}_get(e,t,n){const i=t.get(e);if(void 0===i)throw new Error('"'+e+'" is not a registered '+n+".");return i}}var Roe=new Boe;class Loe{constructor(){this._init=[]}notify(e,t,n,i){"beforeInit"===t&&(this._init=this._createDescriptors(e,!0),this._notify(this._init,e,"install"));const r=i?this._descriptors(e).filter(i):this._descriptors(e),s=this._notify(r,e,t,n);return"afterDestroy"===t&&(this._notify(r,e,"stop"),this._notify(this._init,e,"uninstall")),s}_notify(e,t,n,i){i=i||{};for(const r of e){const e=r.plugin;if(!1===Die(e[n],[t,i,r.options],e)&&i.cancelable)return!1}return!0}invalidate(){mie(this._cache)||(this._oldCache=this._cache,this._cache=void 0)}_descriptors(e){if(this._cache)return this._cache;const t=this._cache=this._createDescriptors(e);return this._notifyStateChanges(e),t}_createDescriptors(e,t){const n=e&&e.config,i=bie(n.options&&n.options.plugins,{}),r=function(e){const t={},n=[],i=Object.keys(Roe.plugins.items);for(let s=0;s<i.length;s++)n.push(Roe.getPlugin(i[s]));const r=e.plugins||[];for(let s=0;s<r.length;s++){const e=r[s];-1===n.indexOf(e)&&(n.push(e),t[e.id]=!0)}return{plugins:n,localIds:t}}(n);return!1!==i||t?function(e,t,n,i){let{plugins:r,localIds:s}=t;const a=[],o=e.getContext();for(const l of r){const t=l.id,r=zoe(n[t],i);null!==r&&a.push({plugin:l,options:Noe(e.config,{plugin:l,local:s[t]},r,o)})}return a}(e,r,i,t):[]}_notifyStateChanges(e){const t=this._oldCache||[],n=this._cache,i=(e,t)=>e.filter((e=>!t.some((t=>e.plugin.id===t.plugin.id))));this._notify(i(t,n),e,"stop"),this._notify(i(n,t),e,"start")}}function zoe(e,t){return t||!1!==e?!0===e?{}:e:null}function Noe(e,t,n,i){let{plugin:r,local:s}=t;const a=e.pluginScopeKeys(r),o=e.getOptionScopes(n,a);return s&&r.defaults&&o.push(r.defaults),e.createResolver(o,i,[""],{scriptable:!1,indexable:!1,allKeys:!0})}function joe(e,t){const n=Lre.datasets[e]||{};return((t.datasets||{})[e]||{}).indexAxis||t.indexAxis||n.indexAxis||"x"}function Uoe(e){if("x"===e||"y"===e||"r"===e)return e}function Voe(e){return"top"===e||"bottom"===e?"x":"left"===e||"right"===e?"y":void 0}function Hoe(e){if(Uoe(e))return e;for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];for(const r of n){const t=r.axis||Voe(r.position)||e.length>1&&Uoe(e[0].toLowerCase());if(t)return t}throw new Error("Cannot determine type of '".concat(e,"' axis. Please provide 'axis' or 'position' option."))}function Woe(e,t,n){if(n[t+"AxisID"]===e)return{axis:t}}function Goe(e,t){const n=Ore[e.type]||{scales:{}},i=t.scales||{},r=joe(e.type,t),s=Object.create(null);return Object.keys(i).forEach((t=>{const a=i[t];if(!vie(a))return console.error("Invalid scale configuration for scale: ".concat(t));if(a._proxy)return console.warn("Ignoring resolver passed as options for scale: ".concat(t));const o=Hoe(t,a,function(e,t){if(t.data&&t.data.datasets){const n=t.data.datasets.filter((t=>t.xAxisID===e||t.yAxisID===e));if(n.length)return Woe(e,"x",n[0])||Woe(e,"y",n[0])}return{}}(t,e),Lre.scales[a.type]),l=function(e,t){return e===t?"_index_":"_value_"}(o,r),u=n.scales||{};s[t]=Tie(Object.create(null),[{axis:o},a,u[o],u[l]])})),e.data.datasets.forEach((n=>{const r=n.type||e.type,a=n.indexAxis||joe(r,t),o=(Ore[r]||{}).scales||{};Object.keys(o).forEach((e=>{const t=function(e,t){let n=e;return"_index_"===e?n=t:"_value_"===e&&(n="x"===t?"y":"x"),n}(e,a),r=n[t+"AxisID"]||t;s[r]=s[r]||Object.create(null),Tie(s[r],[{axis:t},i[r],o[e]])}))})),Object.keys(s).forEach((e=>{const t=s[e];Tie(t,[Lre.scales[t.type],Lre.scale])})),s}function qoe(e){const t=e.options||(e.options={});t.plugins=bie(t.plugins,{}),t.scales=Goe(e,t)}function Yoe(e){return(e=e||{}).datasets=e.datasets||[],e.labels=e.labels||[],e}const Xoe=new Map,Qoe=new Set;function Koe(e,t){let n=Xoe.get(e);return n||(n=t(),Xoe.set(e,n),Qoe.add(n)),n}const Zoe=(e,t,n)=>{const i=Oie(t,n);void 0!==i&&e.add(i)};class Joe{constructor(e){this._config=function(e){return(e=e||{}).data=Yoe(e.data),qoe(e),e}(e),this._scopeCache=new Map,this._resolverCache=new Map}get platform(){return this._config.platform}get type(){return this._config.type}set type(e){this._config.type=e}get data(){return this._config.data}set data(e){this._config.data=Yoe(e)}get options(){return this._config.options}set options(e){this._config.options=e}get plugins(){return this._config.plugins}update(){const e=this._config;this.clearCache(),qoe(e)}clearCache(){this._scopeCache.clear(),this._resolverCache.clear()}datasetScopeKeys(e){return Koe(e,(()=>[["datasets.".concat(e),""]]))}datasetAnimationScopeKeys(e,t){return Koe("".concat(e,".transition.").concat(t),(()=>[["datasets.".concat(e,".transitions.").concat(t),"transitions.".concat(t)],["datasets.".concat(e),""]]))}datasetElementScopeKeys(e,t){return Koe("".concat(e,"-").concat(t),(()=>[["datasets.".concat(e,".elements.").concat(t),"datasets.".concat(e),"elements.".concat(t),""]]))}pluginScopeKeys(e){const t=e.id,n=this.type;return Koe("".concat(n,"-plugin-").concat(t),(()=>[["plugins.".concat(t),...e.additionalOptionScopes||[]]]))}_cachedScopes(e,t){const n=this._scopeCache;let i=n.get(e);return i&&!t||(i=new Map,n.set(e,i)),i}getOptionScopes(e,t,n){const{options:i,type:r}=this,s=this._cachedScopes(e,n),a=s.get(t);if(a)return a;const o=new Set;t.forEach((t=>{e&&(o.add(e),t.forEach((t=>Zoe(o,e,t)))),t.forEach((e=>Zoe(o,i,e))),t.forEach((e=>Zoe(o,Ore[r]||{},e))),t.forEach((e=>Zoe(o,Lre,e))),t.forEach((e=>Zoe(o,Ire,e)))}));const l=Array.from(o);return 0===l.length&&l.push(Object.create(null)),Qoe.has(t)&&s.set(t,l),l}chartOptionScopes(){const{options:e,type:t}=this;return[e,Ore[t]||{},Lre.datasets[t]||{},{type:t},Lre,Ire]}resolveNamedOptions(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[""];const r={$shared:!0},{resolver:s,subPrefixes:a}=$oe(this._resolverCache,e,i);let o=s;if(function(e,t){const{isScriptable:n,isIndexable:i}=dse(e);for(const r of t){const t=n(r),s=i(r),a=(s||t)&&e[r];if(t&&(Bie(a)||ele(a))||s&&gie(a))return!0}return!1}(s,t)){r.$shared=!1;o=hse(s,n=Bie(n)?n():n,this.createResolver(e,n,a))}for(const l of t)r[l]=o[l];return r}createResolver(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[""],i=arguments.length>3?arguments[3]:void 0;const{resolver:r}=$oe(this._resolverCache,e,n);return vie(t)?hse(r,t,void 0,i):r}}function $oe(e,t,n){let i=e.get(t);i||(i=new Map,e.set(t,i));const r=n.join();let s=i.get(r);if(!s){s={resolver:cse(t,n),subPrefixes:n.filter((e=>!e.toLowerCase().includes("hover")))},i.set(r,s)}return s}const ele=e=>vie(e)&&Object.getOwnPropertyNames(e).some((t=>Bie(e[t])));const tle=["top","bottom","left","right","chartArea"];function nle(e,t){return"top"===e||"bottom"===e||-1===tle.indexOf(e)&&"x"===t}function ile(e,t){return function(n,i){return n[e]===i[e]?n[t]-i[t]:n[e]-i[e]}}function rle(e){const t=e.chart,n=t.options.animation;t.notifyPlugins("afterRender"),Die(n&&n.onComplete,[e],t)}function sle(e){const t=e.chart,n=t.options.animation;Die(n&&n.onProgress,[e],t)}function ale(e){return Fse()&&"string"===typeof e?e=document.getElementById(e):e&&e.length&&(e=e[0]),e&&e.canvas&&(e=e.canvas),e}const ole={},lle=e=>{const t=ale(e);return Object.values(ole).filter((e=>e.canvas===t)).pop()};function ule(e,t,n){const i=Object.keys(e);for(const r of i){const i=+r;if(i>=t){const s=e[r];delete e[r],(n>0||i>t)&&(e[i+n]=s)}}}function cle(e,t,n){return e.options.clip?e[n]:t[n]}class hle{static register(){Roe.add(...arguments),dle()}static unregister(){Roe.remove(...arguments),dle()}constructor(e,t){const n=this.config=new Joe(t),i=ale(e),r=lle(i);if(r)throw new Error("Canvas is already in use. Chart with ID '"+r.id+"' must be destroyed before the canvas with ID '"+r.canvas.id+"' can be reused.");const s=n.createResolver(n.chartOptionScopes(),this.getContext());this.platform=new(n.platform||function(e){return!Fse()||"undefined"!==typeof OffscreenCanvas&&e instanceof OffscreenCanvas?ooe:Doe}(i)),this.platform.updateConfig(n);const a=this.platform.acquireContext(i,s.aspectRatio),o=a&&a.canvas,l=o&&o.height,u=o&&o.width;this.id=fie(),this.ctx=a,this.canvas=o,this.width=u,this.height=l,this._options=s,this._aspectRatio=this.aspectRatio,this._layers=[],this._metasets=[],this._stacks=void 0,this.boxes=[],this.currentDevicePixelRatio=void 0,this.chartArea=void 0,this._active=[],this._lastEvent=void 0,this._listeners={},this._responsiveListeners=void 0,this._sortedMetasets=[],this.scales={},this._plugins=new Loe,this.$proxies={},this._hiddenIndices={},this.attached=!1,this._animationsDisabled=void 0,this.$context=void 0,this._doResize=function(e,t){let n;return function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return t?(clearTimeout(n),n=setTimeout(e,t,r)):e.apply(this,r),t}}((e=>this.update(e)),s.resizeDelay||0),this._dataChanges=[],ole[this.id]=this,a&&o?(iae.listen(this,"complete",rle),iae.listen(this,"progress",sle),this._initialize(),this.attached&&this.update()):console.error("Failed to create chart: can't acquire context from the given item")}get aspectRatio(){const{options:{aspectRatio:e,maintainAspectRatio:t},width:n,height:i,_aspectRatio:r}=this;return mie(e)?t&&r?r:i?n/i:null:e}get data(){return this.config.data}set data(e){this.config.data=e}get options(){return this._options}set options(e){this.config.options=e}get registry(){return Roe}_initialize(){return this.notifyPlugins("beforeInit"),this.options.responsive?this.resize():jse(this,this.options.devicePixelRatio),this.bindEvents(),this.notifyPlugins("afterInit"),this}clear(){return Ure(this.canvas,this.ctx),this}stop(){return iae.stop(this),this}resize(e,t){iae.running(this)?this._resizeBeforeDraw={width:e,height:t}:this._resize(e,t)}_resize(e,t){const n=this.options,i=this.canvas,r=n.maintainAspectRatio&&this.aspectRatio,s=this.platform.getMaximumSize(i,e,t,r),a=n.devicePixelRatio||this.platform.getDevicePixelRatio(),o=this.width?"resize":"attach";this.width=s.width,this.height=s.height,this._aspectRatio=this.aspectRatio,jse(this,a,!0)&&(this.notifyPlugins("resize",{size:s}),Die(n.onResize,[this,s],this),this.attached&&this._doResize(o)&&this.render())}ensureScalesHaveIDs(){_ie(this.options.scales||{},((e,t)=>{e.id=t}))}buildOrUpdateScales(){const e=this.options,t=e.scales,n=this.scales,i=Object.keys(n).reduce(((e,t)=>(e[t]=!1,e)),{});let r=[];t&&(r=r.concat(Object.keys(t).map((e=>{const n=t[e],i=Hoe(e,n),r="r"===i,s="x"===i;return{options:n,dposition:r?"chartArea":s?"bottom":"left",dtype:r?"radialLinear":s?"category":"linear"}})))),_ie(r,(t=>{const r=t.options,s=r.id,a=Hoe(s,r),o=bie(r.type,t.dtype);void 0!==r.position&&nle(r.position,a)===nle(t.dposition)||(r.position=t.dposition),i[s]=!0;let l=null;if(s in n&&n[s].type===o)l=n[s];else{l=new(Roe.getScale(o))({id:s,type:o,ctx:this.ctx,chart:this}),n[l.id]=l}l.init(r,e)})),_ie(i,((e,t)=>{e||delete n[t]})),_ie(n,(e=>{soe.configure(this,e,e.options),soe.addBox(this,e)}))}_updateMetasets(){const e=this._metasets,t=this.data.datasets.length,n=e.length;if(e.sort(((e,t)=>e.index-t.index)),n>t){for(let e=t;e<n;++e)this._destroyDatasetMeta(e);e.splice(t,n-t)}this._sortedMetasets=e.slice(0).sort(ile("order","index"))}_removeUnreferencedMetasets(){const{_metasets:e,data:{datasets:t}}=this;e.length>t.length&&delete this._stacks,e.forEach(((e,n)=>{0===t.filter((t=>t===e._dataset)).length&&this._destroyDatasetMeta(n)}))}buildOrUpdateControllers(){const e=[],t=this.data.datasets;let n,i;for(this._removeUnreferencedMetasets(),n=0,i=t.length;n<i;n++){const i=t[n];let r=this.getDatasetMeta(n);const s=i.type||this.config.type;if(r.type&&r.type!==s&&(this._destroyDatasetMeta(n),r=this.getDatasetMeta(n)),r.type=s,r.indexAxis=i.indexAxis||joe(s,this.options),r.order=i.order||0,r.index=n,r.label=""+i.label,r.visible=this.isDatasetVisible(n),r.controller)r.controller.updateIndex(n),r.controller.linkScales();else{const t=Roe.getController(s),{datasetElementType:i,dataElementType:a}=Lre.datasets[s];Object.assign(t,{dataElementType:Roe.getElement(a),datasetElementType:i&&Roe.getElement(i)}),r.controller=new t(this,n),e.push(r.controller)}}return this._updateMetasets(),e}_resetElements(){_ie(this.data.datasets,((e,t)=>{this.getDatasetMeta(t).controller.reset()}),this)}reset(){this._resetElements(),this.notifyPlugins("reset")}update(e){const t=this.config;t.update();const n=this._options=t.createResolver(t.chartOptionScopes(),this.getContext()),i=this._animationsDisabled=!n.animation;if(this._updateScales(),this._checkEventBindings(),this._updateHiddenIndices(),this._plugins.invalidate(),!1===this.notifyPlugins("beforeUpdate",{mode:e,cancelable:!0}))return;const r=this.buildOrUpdateControllers();this.notifyPlugins("beforeElementsUpdate");let s=0;for(let l=0,u=this.data.datasets.length;l<u;l++){const{controller:e}=this.getDatasetMeta(l),t=!i&&-1===r.indexOf(e);e.buildOrUpdateElements(t),s=Math.max(+e.getMaxOverflow(),s)}s=this._minPadding=n.layout.autoPadding?s:0,this._updateLayout(s),i||_ie(r,(e=>{e.reset()})),this._updateDatasets(e),this.notifyPlugins("afterUpdate",{mode:e}),this._layers.sort(ile("z","_idx"));const{_active:a,_lastEvent:o}=this;o?this._eventHandler(o,!0):a.length&&this._updateHoverStyles(a,a,!0),this.render()}_updateScales(){_ie(this.scales,(e=>{soe.removeBox(this,e)})),this.ensureScalesHaveIDs(),this.buildOrUpdateScales()}_checkEventBindings(){const e=this.options,t=new Set(Object.keys(this._listeners)),n=new Set(e.events);Rie(t,n)&&!!this._responsiveListeners===e.responsive||(this.unbindEvents(),this.bindEvents())}_updateHiddenIndices(){const{_hiddenIndices:e}=this,t=this._getUniformDataChanges()||[];for(const{method:n,start:i,count:r}of t){ule(e,i,"_removeElements"===n?-r:r)}}_getUniformDataChanges(){const e=this._dataChanges;if(!e||!e.length)return;this._dataChanges=[];const t=this.data.datasets.length,n=t=>new Set(e.filter((e=>e[0]===t)).map(((e,t)=>t+","+e.splice(1).join(",")))),i=n(0);for(let r=1;r<t;r++)if(!Rie(i,n(r)))return;return Array.from(i).map((e=>e.split(","))).map((e=>({method:e[1],start:+e[2],count:+e[3]})))}_updateLayout(e){if(!1===this.notifyPlugins("beforeLayout",{cancelable:!0}))return;soe.update(this,this.width,this.height,e);const t=this.chartArea,n=t.width<=0||t.height<=0;this._layers=[],_ie(this.boxes,(e=>{n&&"chartArea"===e.position||(e.configure&&e.configure(),this._layers.push(...e._layers()))}),this),this._layers.forEach(((e,t)=>{e._idx=t})),this.notifyPlugins("afterLayout")}_updateDatasets(e){if(!1!==this.notifyPlugins("beforeDatasetsUpdate",{mode:e,cancelable:!0})){for(let e=0,t=this.data.datasets.length;e<t;++e)this.getDatasetMeta(e).controller.configure();for(let t=0,n=this.data.datasets.length;t<n;++t)this._updateDataset(t,Bie(e)?e({datasetIndex:t}):e);this.notifyPlugins("afterDatasetsUpdate",{mode:e})}}_updateDataset(e,t){const n=this.getDatasetMeta(e),i={meta:n,index:e,mode:t,cancelable:!0};!1!==this.notifyPlugins("beforeDatasetUpdate",i)&&(n.controller._update(t),i.cancelable=!1,this.notifyPlugins("afterDatasetUpdate",i))}render(){!1!==this.notifyPlugins("beforeRender",{cancelable:!0})&&(iae.has(this)?this.attached&&!iae.running(this)&&iae.start(this):(this.draw(),rle({chart:this})))}draw(){let e;if(this._resizeBeforeDraw){const{width:e,height:t}=this._resizeBeforeDraw;this._resizeBeforeDraw=null,this._resize(e,t)}if(this.clear(),this.width<=0||this.height<=0)return;if(!1===this.notifyPlugins("beforeDraw",{cancelable:!0}))return;const t=this._layers;for(e=0;e<t.length&&t[e].z<=0;++e)t[e].draw(this.chartArea);for(this._drawDatasets();e<t.length;++e)t[e].draw(this.chartArea);this.notifyPlugins("afterDraw")}_getSortedDatasetMetas(e){const t=this._sortedMetasets,n=[];let i,r;for(i=0,r=t.length;i<r;++i){const r=t[i];e&&!r.visible||n.push(r)}return n}getSortedVisibleDatasetMetas(){return this._getSortedDatasetMetas(!0)}_drawDatasets(){if(!1===this.notifyPlugins("beforeDatasetsDraw",{cancelable:!0}))return;const e=this.getSortedVisibleDatasetMetas();for(let t=e.length-1;t>=0;--t)this._drawDataset(e[t]);this.notifyPlugins("afterDatasetsDraw")}_drawDataset(e){const t=this.ctx,n=e._clip,i=!n.disabled,r=function(e,t){const{xScale:n,yScale:i}=e;return n&&i?{left:cle(n,t,"left"),right:cle(n,t,"right"),top:cle(i,t,"top"),bottom:cle(i,t,"bottom")}:t}(e,this.chartArea),s={meta:e,index:e.index,cancelable:!0};!1!==this.notifyPlugins("beforeDatasetDraw",s)&&(i&&Gre(t,{left:!1===n.left?0:r.left-n.left,right:!1===n.right?this.width:r.right+n.right,top:!1===n.top?0:r.top-n.top,bottom:!1===n.bottom?this.height:r.bottom+n.bottom}),e.controller.draw(),i&&qre(t),s.cancelable=!1,this.notifyPlugins("afterDatasetDraw",s))}isPointInArea(e){return Wre(e,this.chartArea,this._minPadding)}getElementsAtEventForMode(e,t,n,i){const r=qae.modes[t];return"function"===typeof r?r(this,e,n,i):[]}getDatasetMeta(e){const t=this.data.datasets[e],n=this._metasets;let i=n.filter((e=>e&&e._dataset===t)).pop();return i||(i={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null,order:t&&t.order||0,index:e,_dataset:t,_parsed:[],_sorted:!1},n.push(i)),i}getContext(){return this.$context||(this.$context=use(null,{chart:this,type:"chart"}))}getVisibleDatasetCount(){return this.getSortedVisibleDatasetMetas().length}isDatasetVisible(e){const t=this.data.datasets[e];if(!t)return!1;const n=this.getDatasetMeta(e);return"boolean"===typeof n.hidden?!n.hidden:!t.hidden}setDatasetVisibility(e,t){this.getDatasetMeta(e).hidden=!t}toggleDataVisibility(e){this._hiddenIndices[e]=!this._hiddenIndices[e]}getDataVisibility(e){return!this._hiddenIndices[e]}_updateVisibility(e,t,n){const i=n?"show":"hide",r=this.getDatasetMeta(e),s=r.controller._resolveAnimations(void 0,i);kie(t)?(r.data[t].hidden=!n,this.update()):(this.setDatasetVisibility(e,n),s.update(r,{visible:n}),this.update((t=>t.datasetIndex===e?i:void 0)))}hide(e,t){this._updateVisibility(e,t,!1)}show(e,t){this._updateVisibility(e,t,!0)}_destroyDatasetMeta(e){const t=this._metasets[e];t&&t.controller&&t.controller._destroy(),delete this._metasets[e]}_stop(){let e,t;for(this.stop(),iae.remove(this),e=0,t=this.data.datasets.length;e<t;++e)this._destroyDatasetMeta(e)}destroy(){this.notifyPlugins("beforeDestroy");const{canvas:e,ctx:t}=this;this._stop(),this.config.clearCache(),e&&(this.unbindEvents(),Ure(e,t),this.platform.releaseContext(t),this.canvas=null,this.ctx=null),delete ole[this.id],this.notifyPlugins("afterDestroy")}toBase64Image(){return this.canvas.toDataURL(...arguments)}bindEvents(){this.bindUserEvents(),this.options.responsive?this.bindResponsiveEvents():this.attached=!0}bindUserEvents(){const e=this._listeners,t=this.platform,n=(n,i)=>{t.addEventListener(this,n,i),e[n]=i},i=(e,t,n)=>{e.offsetX=t,e.offsetY=n,this._eventHandler(e)};_ie(this.options.events,(e=>n(e,i)))}bindResponsiveEvents(){this._responsiveListeners||(this._responsiveListeners={});const e=this._responsiveListeners,t=this.platform,n=(n,i)=>{t.addEventListener(this,n,i),e[n]=i},i=(n,i)=>{e[n]&&(t.removeEventListener(this,n,i),delete e[n])},r=(e,t)=>{this.canvas&&this.resize(e,t)};let s;const a=()=>{i("attach",a),this.attached=!0,this.resize(),n("resize",r),n("detach",s)};s=()=>{this.attached=!1,i("resize",r),this._stop(),this._resize(0,0),n("attach",a)},t.isAttached(this.canvas)?a():s()}unbindEvents(){_ie(this._listeners,((e,t)=>{this.platform.removeEventListener(this,t,e)})),this._listeners={},_ie(this._responsiveListeners,((e,t)=>{this.platform.removeEventListener(this,t,e)})),this._responsiveListeners=void 0}updateHoverStyle(e,t,n){const i=n?"set":"remove";let r,s,a,o;for("dataset"===t&&(r=this.getDatasetMeta(e[0].datasetIndex),r.controller["_"+i+"DatasetHoverStyle"]()),a=0,o=e.length;a<o;++a){s=e[a];const t=s&&this.getDatasetMeta(s.datasetIndex).controller;t&&t[i+"HoverStyle"](s.element,s.datasetIndex,s.index)}}getActiveElements(){return this._active||[]}setActiveElements(e){const t=this._active||[],n=e.map((e=>{let{datasetIndex:t,index:n}=e;const i=this.getDatasetMeta(t);if(!i)throw new Error("No dataset found at index "+t);return{datasetIndex:t,element:i.data[n],index:n}}));!Sie(n,t)&&(this._active=n,this._lastEvent=null,this._updateHoverStyles(n,t))}notifyPlugins(e,t,n){return this._plugins.notify(this,e,t,n)}isPluginEnabled(e){return 1===this._plugins._cache.filter((t=>t.plugin.id===e)).length}_updateHoverStyles(e,t,n){const i=this.options.hover,r=(e,t)=>e.filter((e=>!t.some((t=>e.datasetIndex===t.datasetIndex&&e.index===t.index)))),s=r(t,e),a=n?e:r(e,t);s.length&&this.updateHoverStyle(s,i.mode,!1),a.length&&i.mode&&this.updateHoverStyle(a,i.mode,!0)}_eventHandler(e,t){const n={event:e,replay:t,cancelable:!0,inChartArea:this.isPointInArea(e)},i=t=>(t.options.events||this.options.events).includes(e.native.type);if(!1===this.notifyPlugins("beforeEvent",n,i))return;const r=this._handleEvent(e,t,n.inChartArea);return n.cancelable=!1,this.notifyPlugins("afterEvent",n,i),(r||n.changed)&&this.render(),this}_handleEvent(e,t,n){const{_active:i=[],options:r}=this,s=t,a=this._getActiveElements(e,i,n,s),o=function(e){return"mouseup"===e.type||"click"===e.type||"contextmenu"===e.type}(e),l=function(e,t,n,i){return n&&"mouseout"!==e.type?i?t:e:null}(e,this._lastEvent,n,o);n&&(this._lastEvent=null,Die(r.onHover,[e,a,this],this),o&&Die(r.onClick,[e,a,this],this));const u=!Sie(a,i);return(u||t)&&(this._active=a,this._updateHoverStyles(a,i,t)),this._lastEvent=l,u}_getActiveElements(e,t,n,i){if("mouseout"===e.type)return[];if(!n)return t;const r=this.options.hover;return this.getElementsAtEventForMode(e,r.mode,r,i)}}function dle(){return _ie(hle.instances,(e=>e._plugins.invalidate()))}function ple(e,t,n,i){const r=ise(e.options.borderRadius,["outerStart","outerEnd","innerStart","innerEnd"]);const s=(n-t)/2,a=Math.min(s,i*t/2),o=e=>{const t=(n-Math.min(s,e))*i/2;return sre(e,0,Math.min(s,t))};return{outerStart:o(r.outerStart),outerEnd:o(r.outerEnd),innerStart:sre(r.innerStart,0,a),innerEnd:sre(r.innerEnd,0,a)}}function fle(e,t,n,i){return{x:n+e*Math.cos(t),y:i+e*Math.sin(t)}}function mle(e,t,n,i,r,s){const{x:a,y:o,startAngle:l,pixelMargin:u,innerRadius:c}=t,h=Math.max(t.outerRadius+i+n-u,0),d=c>0?c+i+n+u:0;let p=0;const f=r-l;if(i){const e=((c>0?c-i:0)+(h>0?h-i:0))/2;p=(f-(0!==e?f*e/(e+i):f))/2}const m=(f-Math.max(.001,f*h-n/Lie)/h)/2,g=l+m+p,v=r-m-p,{outerStart:y,outerEnd:x,innerStart:b,innerEnd:w}=ple(t,d,h,v-g),D=h-y,_=h-x,S=g+y/D,E=v-x/_,C=d+b,A=d+w,M=g+b/C,T=v-w/A;if(e.beginPath(),s){const t=(S+E)/2;if(e.arc(a,o,h,S,t),e.arc(a,o,h,t,E),x>0){const t=fle(_,E,a,o);e.arc(t.x,t.y,x,E,v+Vie)}const n=fle(A,v,a,o);if(e.lineTo(n.x,n.y),w>0){const t=fle(A,T,a,o);e.arc(t.x,t.y,w,v+Vie,T+Math.PI)}const i=(v-w/d+(g+b/d))/2;if(e.arc(a,o,d,v-w/d,i,!0),e.arc(a,o,d,i,g+b/d,!0),b>0){const t=fle(C,M,a,o);e.arc(t.x,t.y,b,M+Math.PI,g-Vie)}const r=fle(D,g,a,o);if(e.lineTo(r.x,r.y),y>0){const t=fle(D,S,a,o);e.arc(t.x,t.y,y,g-Vie,S)}}else{e.moveTo(a,o);const t=Math.cos(S)*h+a,n=Math.sin(S)*h+o;e.lineTo(t,n);const i=Math.cos(E)*h+a,r=Math.sin(E)*h+o;e.lineTo(i,r)}e.closePath()}function gle(e,t,n,i,r){const{fullCircles:s,startAngle:a,circumference:o,options:l}=t,{borderWidth:u,borderJoinStyle:c,borderDash:h,borderDashOffset:d}=l,p="inner"===l.borderAlign;if(!u)return;e.setLineDash(h||[]),e.lineDashOffset=d,p?(e.lineWidth=2*u,e.lineJoin=c||"round"):(e.lineWidth=u,e.lineJoin=c||"bevel");let f=t.endAngle;if(s){mle(e,t,n,i,f,r);for(let t=0;t<s;++t)e.stroke();isNaN(o)||(f=a+(o%zie||zie))}p&&function(e,t,n){const{startAngle:i,pixelMargin:r,x:s,y:a,outerRadius:o,innerRadius:l}=t;let u=r/o;e.beginPath(),e.arc(s,a,o,i-u,n+u),l>r?(u=r/l,e.arc(s,a,l,n+u,i-u,!0)):e.arc(s,a,r,n+Vie,i-Vie),e.closePath(),e.clip()}(e,t,f),s||(mle(e,t,n,i,f,r),e.stroke())}c(hle,"defaults",Lre),c(hle,"instances",ole),c(hle,"overrides",Ore),c(hle,"registry",Roe),c(hle,"version","4.4.7"),c(hle,"getChart",lle);class vle extends _oe{constructor(e){super(),c(this,"circumference",void 0),c(this,"endAngle",void 0),c(this,"fullCircles",void 0),c(this,"innerRadius",void 0),c(this,"outerRadius",void 0),c(this,"pixelMargin",void 0),c(this,"startAngle",void 0),this.options=void 0,this.circumference=void 0,this.startAngle=void 0,this.endAngle=void 0,this.innerRadius=void 0,this.outerRadius=void 0,this.pixelMargin=0,this.fullCircles=0,e&&Object.assign(this,e)}inRange(e,t,n){const i=this.getProps(["x","y"],n),{angle:r,distance:s}=ere(i,{x:e,y:t}),{startAngle:a,endAngle:o,innerRadius:l,outerRadius:u,circumference:c}=this.getProps(["startAngle","endAngle","innerRadius","outerRadius","circumference"],n),h=(this.options.spacing+this.options.borderWidth)/2,d=bie(c,o-a),p=rre(r,a,o)&&a!==o,f=d>=zie||p,m=are(s,l+h,u+h);return f&&m}getCenterPoint(e){const{x:t,y:n,startAngle:i,endAngle:r,innerRadius:s,outerRadius:a}=this.getProps(["x","y","startAngle","endAngle","innerRadius","outerRadius"],e),{offset:o,spacing:l}=this.options,u=(i+r)/2,c=(s+a+l+o)/2;return{x:t+Math.cos(u)*c,y:n+Math.sin(u)*c}}tooltipPosition(e){return this.getCenterPoint(e)}draw(e){const{options:t,circumference:n}=this,i=(t.offset||0)/4,r=(t.spacing||0)/2,s=t.circular;if(this.pixelMargin="inner"===t.borderAlign?.33:0,this.fullCircles=n>zie?Math.floor(n/zie):0,0===n||this.innerRadius<0||this.outerRadius<0)return;e.save();const a=(this.startAngle+this.endAngle)/2;e.translate(Math.cos(a)*i,Math.sin(a)*i);const o=i*(1-Math.sin(Math.min(Lie,n||0)));e.fillStyle=t.backgroundColor,e.strokeStyle=t.borderColor,function(e,t,n,i,r){const{fullCircles:s,startAngle:a,circumference:o}=t;let l=t.endAngle;if(s){mle(e,t,n,i,l,r);for(let t=0;t<s;++t)e.fill();isNaN(o)||(l=a+(o%zie||zie))}mle(e,t,n,i,l,r),e.fill()}(e,this,o,r,s),gle(e,this,o,r,s),e.restore()}}function yle(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t;e.lineCap=bie(n.borderCapStyle,t.borderCapStyle),e.setLineDash(bie(n.borderDash,t.borderDash)),e.lineDashOffset=bie(n.borderDashOffset,t.borderDashOffset),e.lineJoin=bie(n.borderJoinStyle,t.borderJoinStyle),e.lineWidth=bie(n.borderWidth,t.borderWidth),e.strokeStyle=bie(n.borderColor,t.borderColor)}function xle(e,t,n){e.lineTo(n.x,n.y)}function ble(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const i=e.length,{start:r=0,end:s=i-1}=n,{start:a,end:o}=t,l=Math.max(r,a),u=Math.min(s,o),c=r<a&&s<a||r>o&&s>o;return{count:i,start:l,loop:t.loop,ilen:u<l&&!c?i+u-l:u-l}}function wle(e,t,n,i){const{points:r,options:s}=t,{count:a,start:o,loop:l,ilen:u}=ble(r,n,i),c=function(e){return e.stepped?Yre:e.tension||"monotone"===e.cubicInterpolationMode?Xre:xle}(s);let h,d,p,{move:f=!0,reverse:m}=i||{};for(h=0;h<=u;++h)d=r[(o+(m?u-h:h))%a],d.skip||(f?(e.moveTo(d.x,d.y),f=!1):c(e,p,d,m,s.stepped),p=d);return l&&(d=r[(o+(m?u:0))%a],c(e,p,d,m,s.stepped)),!!l}function Dle(e,t,n,i){const r=t.points,{count:s,start:a,ilen:o}=ble(r,n,i),{move:l=!0,reverse:u}=i||{};let c,h,d,p,f,m,g=0,v=0;const y=e=>(a+(u?o-e:e))%s,x=()=>{p!==f&&(e.lineTo(g,f),e.lineTo(g,p),e.lineTo(g,m))};for(l&&(h=r[y(0)],e.moveTo(h.x,h.y)),c=0;c<=o;++c){if(h=r[y(c)],h.skip)continue;const t=h.x,n=h.y,i=0|t;i===d?(n<p?p=n:n>f&&(f=n),g=(v*g+t)/++v):(x(),e.lineTo(t,n),d=i,v=0,p=f=n),m=n}x()}function _le(e){const t=e.options,n=t.borderDash&&t.borderDash.length;return!e._decimated&&!e._loop&&!t.tension&&"monotone"!==t.cubicInterpolationMode&&!t.stepped&&!n?Dle:wle}c(vle,"id","arc"),c(vle,"defaults",{borderAlign:"center",borderColor:"#fff",borderDash:[],borderDashOffset:0,borderJoinStyle:void 0,borderRadius:0,borderWidth:2,offset:0,spacing:0,angle:void 0,circular:!0}),c(vle,"defaultRoutes",{backgroundColor:"backgroundColor"}),c(vle,"descriptors",{_scriptable:!0,_indexable:e=>"borderDash"!==e});const Sle="function"===typeof Path2D;function Ele(e,t,n,i){Sle&&!t.options.segment?function(e,t,n,i){let r=t._path;r||(r=t._path=new Path2D,t.path(r,n,i)&&r.closePath()),yle(e,t.options),e.stroke(r)}(e,t,n,i):function(e,t,n,i){const{segments:r,options:s}=t,a=_le(t);for(const o of r)yle(e,s,o.style),e.beginPath(),a(e,t,o,{start:n,end:n+i-1})&&e.closePath(),e.stroke()}(e,t,n,i)}class Cle extends _oe{constructor(e){super(),this.animated=!0,this.options=void 0,this._chart=void 0,this._loop=void 0,this._fullLoop=void 0,this._path=void 0,this._points=void 0,this._segments=void 0,this._decimated=!1,this._pointsUpdated=!1,this._datasetIndex=void 0,e&&Object.assign(this,e)}updateControlPoints(e,t){const n=this.options;if((n.tension||"monotone"===n.cubicInterpolationMode)&&!n.stepped&&!this._pointsUpdated){const i=n.spanGaps?this._loop:this._fullLoop;Pse(this._points,n,e,i,t),this._pointsUpdated=!0}}set points(e){this._points=e,delete this._segments,delete this._path,this._pointsUpdated=!1}get points(){return this._points}get segments(){return this._segments||(this._segments=function(e,t){const n=e.points,i=e.options.spanGaps,r=n.length;if(!r)return[];const s=!!e._loop,{start:a,end:o}=function(e,t,n,i){let r=0,s=t-1;if(n&&!i)for(;r<t&&!e[r].skip;)r++;for(;r<t&&e[r].skip;)r++;for(r%=t,n&&(s+=r);s>r&&e[s%t].skip;)s--;return s%=t,{start:r,end:s}}(n,r,s,i);return $se(e,!0===i?[{start:a,end:o,loop:s}]:function(e,t,n,i){const r=e.length,s=[];let a,o=t,l=e[t];for(a=t+1;a<=n;++a){const n=e[a%r];n.skip||n.stop?l.skip||(i=!1,s.push({start:t%r,end:(a-1)%r,loop:i}),t=o=n.stop?a:null):(o=a,l.skip&&(t=a)),l=n}return null!==o&&s.push({start:t%r,end:o%r,loop:i}),s}(n,a,o<a?o+r:o,!!e._fullLoop&&0===a&&o===r-1),n,t)}(this,this.options.segment))}first(){const e=this.segments,t=this.points;return e.length&&t[e[0].start]}last(){const e=this.segments,t=this.points,n=e.length;return n&&t[e[n-1].end]}interpolate(e,t){const n=this.options,i=e[t],r=this.points,s=Jse(this,{property:t,start:i,end:i});if(!s.length)return;const a=[],o=function(e){return e.stepped?Wse:e.tension||"monotone"===e.cubicInterpolationMode?Gse:Hse}(n);let l,u;for(l=0,u=s.length;l<u;++l){const{start:u,end:c}=s[l],h=r[u],d=r[c];if(h===d){a.push(h);continue}const p=o(h,d,Math.abs((i-h[t])/(d[t]-h[t])),n.stepped);p[t]=e[t],a.push(p)}return 1===a.length?a[0]:a}pathSegment(e,t,n){return _le(this)(e,this,t,n)}path(e,t,n){const i=this.segments,r=_le(this);let s=this._loop;t=t||0,n=n||this.points.length-t;for(const a of i)s&=r(e,this,a,{start:t,end:t+n-1});return!!s}draw(e,t,n,i){const r=this.options||{};(this.points||[]).length&&r.borderWidth&&(e.save(),Ele(e,this,n,i),e.restore()),this.animated&&(this._pointsUpdated=!1,this._path=void 0)}}function Ale(e,t,n,i){const r=e.options,{[n]:s}=e.getProps([n],i);return Math.abs(t-s)<r.radius+r.hitRadius}c(Cle,"id","line"),c(Cle,"defaults",{borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",borderWidth:3,capBezierPoints:!0,cubicInterpolationMode:"default",fill:!1,spanGaps:!1,stepped:!1,tension:0}),c(Cle,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"}),c(Cle,"descriptors",{_scriptable:!0,_indexable:e=>"borderDash"!==e&&"fill"!==e});class Mle extends _oe{constructor(e){super(),c(this,"parsed",void 0),c(this,"skip",void 0),c(this,"stop",void 0),this.options=void 0,this.parsed=void 0,this.skip=void 0,this.stop=void 0,e&&Object.assign(this,e)}inRange(e,t,n){const i=this.options,{x:r,y:s}=this.getProps(["x","y"],n);return Math.pow(e-r,2)+Math.pow(t-s,2)<Math.pow(i.hitRadius+i.radius,2)}inXRange(e,t){return Ale(this,e,"x",t)}inYRange(e,t){return Ale(this,e,"y",t)}getCenterPoint(e){const{x:t,y:n}=this.getProps(["x","y"],e);return{x:t,y:n}}size(e){let t=(e=e||this.options||{}).radius||0;t=Math.max(t,t&&e.hoverRadius||0);return 2*(t+(t&&e.borderWidth||0))}draw(e,t){const n=this.options;this.skip||n.radius<.1||!Wre(this,t,this.size(n)/2)||(e.strokeStyle=n.borderColor,e.lineWidth=n.borderWidth,e.fillStyle=n.backgroundColor,Vre(e,n,this.x,this.y))}getRange(){const e=this.options||{};return e.radius+e.hitRadius}}function Tle(e,t){const{x:n,y:i,base:r,width:s,height:a}=e.getProps(["x","y","base","width","height"],t);let o,l,u,c,h;return e.horizontal?(h=a/2,o=Math.min(n,r),l=Math.max(n,r),u=i-h,c=i+h):(h=s/2,o=n-h,l=n+h,u=Math.min(i,r),c=Math.max(i,r)),{left:o,top:u,right:l,bottom:c}}function Ple(e,t,n,i){return e?0:sre(t,n,i)}function Fle(e){const t=Tle(e),n=t.right-t.left,i=t.bottom-t.top,r=function(e,t,n){const i=e.options.borderWidth,r=e.borderSkipped,s=rse(i);return{t:Ple(r.top,s.top,0,n),r:Ple(r.right,s.right,0,t),b:Ple(r.bottom,s.bottom,0,n),l:Ple(r.left,s.left,0,t)}}(e,n/2,i/2),s=function(e,t,n){const{enableBorderRadius:i}=e.getProps(["enableBorderRadius"]),r=e.options.borderRadius,s=sse(r),a=Math.min(t,n),o=e.borderSkipped,l=i||vie(r);return{topLeft:Ple(!l||o.top||o.left,s.topLeft,0,a),topRight:Ple(!l||o.top||o.right,s.topRight,0,a),bottomLeft:Ple(!l||o.bottom||o.left,s.bottomLeft,0,a),bottomRight:Ple(!l||o.bottom||o.right,s.bottomRight,0,a)}}(e,n/2,i/2);return{outer:{x:t.left,y:t.top,w:n,h:i,radius:s},inner:{x:t.left+r.l,y:t.top+r.t,w:n-r.l-r.r,h:i-r.t-r.b,radius:{topLeft:Math.max(0,s.topLeft-Math.max(r.t,r.l)),topRight:Math.max(0,s.topRight-Math.max(r.t,r.r)),bottomLeft:Math.max(0,s.bottomLeft-Math.max(r.b,r.l)),bottomRight:Math.max(0,s.bottomRight-Math.max(r.b,r.r))}}}}function Ole(e,t,n,i){const r=null===t,s=null===n,a=e&&!(r&&s)&&Tle(e,i);return a&&(r||are(t,a.left,a.right))&&(s||are(n,a.top,a.bottom))}function Ile(e,t){e.rect(t.x,t.y,t.w,t.h)}function kle(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const i=e.x!==n.x?-t:0,r=e.y!==n.y?-t:0,s=(e.x+e.w!==n.x+n.w?t:0)-i,a=(e.y+e.h!==n.y+n.h?t:0)-r;return{x:e.x+i,y:e.y+r,w:e.w+s,h:e.h+a,radius:e.radius}}c(Mle,"id","point"),c(Mle,"defaults",{borderWidth:1,hitRadius:1,hoverBorderWidth:1,hoverRadius:4,pointStyle:"circle",radius:3,rotation:0}),c(Mle,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"});class Ble extends _oe{constructor(e){super(),this.options=void 0,this.horizontal=void 0,this.base=void 0,this.width=void 0,this.height=void 0,this.inflateAmount=void 0,e&&Object.assign(this,e)}draw(e){const{inflateAmount:t,options:{borderColor:n,backgroundColor:i}}=this,{inner:r,outer:s}=Fle(this),a=(o=s.radius).topLeft||o.topRight||o.bottomLeft||o.bottomRight?Jre:Ile;var o;e.save(),s.w===r.w&&s.h===r.h||(e.beginPath(),a(e,kle(s,t,r)),e.clip(),a(e,kle(r,-t,s)),e.fillStyle=n,e.fill("evenodd")),e.beginPath(),a(e,kle(r,t)),e.fillStyle=i,e.fill(),e.restore()}inRange(e,t,n){return Ole(this,e,t,n)}inXRange(e,t){return Ole(this,e,null,t)}inYRange(e,t){return Ole(this,null,e,t)}getCenterPoint(e){const{x:t,y:n,base:i,horizontal:r}=this.getProps(["x","y","base","horizontal"],e);return{x:r?(t+i)/2:t,y:r?n:(n+i)/2}}getRange(e){return"x"===e?this.width/2:this.height/2}}c(Ble,"id","bar"),c(Ble,"defaults",{borderSkipped:"start",borderWidth:0,borderRadius:0,inflateAmount:"auto",pointStyle:void 0}),c(Ble,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"});var Rle=Object.freeze({__proto__:null,ArcElement:vle,BarElement:Ble,LineElement:Cle,PointElement:Mle});const Lle=["rgb(54, 162, 235)","rgb(255, 99, 132)","rgb(255, 159, 64)","rgb(255, 205, 86)","rgb(75, 192, 192)","rgb(153, 102, 255)","rgb(201, 203, 207)"],zle=Lle.map((e=>e.replace("rgb(","rgba(").replace(")",", 0.5)")));function Nle(e){return Lle[e%Lle.length]}function jle(e){return zle[e%zle.length]}function Ule(e){let t=0;return(n,i)=>{const r=e.getDatasetMeta(i).controller;r instanceof Pae?t=function(e,t){return e.backgroundColor=e.data.map((()=>Nle(t++))),t}(n,t):r instanceof Oae?t=function(e,t){return e.backgroundColor=e.data.map((()=>jle(t++))),t}(n,t):r&&(t=function(e,t){return e.borderColor=Nle(t),e.backgroundColor=jle(t),++t}(n,t))}}function Vle(e){let t;for(t in e)if(e[t].borderColor||e[t].backgroundColor)return!0;return!1}var Hle={id:"colors",defaults:{enabled:!0,forceOverride:!1},beforeLayout(e,t,n){if(!n.enabled)return;const{data:{datasets:i},options:r}=e.config,{elements:s}=r,a=Vle(i)||(o=r)&&(o.borderColor||o.backgroundColor)||s&&Vle(s)||"rgba(0,0,0,0.1)"!==Lre.borderColor||"rgba(0,0,0,0.1)"!==Lre.backgroundColor;var o;if(!n.forceOverride&&a)return;const l=Ule(e);i.forEach(l)}};function Wle(e){if(e._decimated){const t=e._data;delete e._decimated,delete e._data,Object.defineProperty(e,"data",{configurable:!0,enumerable:!0,writable:!0,value:t})}}function Gle(e){e.data.datasets.forEach((e=>{Wle(e)}))}var qle={id:"decimation",defaults:{algorithm:"min-max",enabled:!1},beforeElementsUpdate:(e,t,n)=>{if(!n.enabled)return void Gle(e);const i=e.width;e.data.datasets.forEach(((t,r)=>{const{_data:s,indexAxis:a}=t,o=e.getDatasetMeta(r),l=s||t.data;if("y"===lse([a,e.options.indexAxis]))return;if(!o.controller.supportsDecimation)return;const u=e.scales[o.xAxisID];if("linear"!==u.type&&"time"!==u.type)return;if(e.options.parsing)return;let{start:c,count:h}=function(e,t){const n=t.length;let i,r=0;const{iScale:s}=e,{min:a,max:o,minDefined:l,maxDefined:u}=s.getUserBounds();return l&&(r=sre(lre(t,s.axis,a).lo,0,n-1)),i=u?sre(lre(t,s.axis,o).hi+1,r,n)-r:n-r,{start:r,count:i}}(o,l);if(h<=(n.threshold||4*i))return void Wle(t);let p;switch(mie(s)&&(t._data=l,delete t.data,Object.defineProperty(t,"data",{configurable:!0,enumerable:!0,get:function(){return this._decimated},set:function(e){this._data=e}})),n.algorithm){case"lttb":p=function(e,t,n,i,r){const s=r.samples||i;if(s>=n)return e.slice(t,t+n);const a=[],o=(n-2)/(s-2);let l=0;const u=t+n-1;let c,h,d,p,f,m=t;for(a[l++]=e[m],c=0;c<s-2;c++){let i,r=0,s=0;const u=Math.floor((c+1)*o)+1+t,g=Math.min(Math.floor((c+2)*o)+1,n)+t,v=g-u;for(i=u;i<g;i++)r+=e[i].x,s+=e[i].y;r/=v,s/=v;const y=Math.floor(c*o)+1+t,x=Math.min(Math.floor((c+1)*o)+1,n)+t,{x:b,y:w}=e[m];for(d=p=-1,i=y;i<x;i++)p=.5*Math.abs((b-r)*(e[i].y-w)-(b-e[i].x)*(s-w)),p>d&&(d=p,h=e[i],f=i);a[l++]=h,m=f}return a[l++]=e[u],a}(l,c,h,i,n);break;case"min-max":p=function(e,t,n,i){let r,s,a,o,l,u,c,h,p,f,m=0,g=0;const v=[],y=t+n-1,x=e[t].x,b=e[y].x-x;for(r=t;r<t+n;++r){s=e[r],a=(s.x-x)/b*i,o=s.y;const t=0|a;if(t===l)o<p?(p=o,u=r):o>f&&(f=o,c=r),m=(g*m+s.x)/++g;else{const n=r-1;if(!mie(u)&&!mie(c)){const t=Math.min(u,c),i=Math.max(u,c);t!==h&&t!==n&&v.push(d(d({},e[t]),{},{x:m})),i!==h&&i!==n&&v.push(d(d({},e[i]),{},{x:m}))}r>0&&n!==h&&v.push(e[n]),v.push(s),l=t,g=0,p=f=o,u=c=h=r}}return v}(l,c,h,i);break;default:throw new Error("Unsupported decimation algorithm '".concat(n.algorithm,"'"))}t._decimated=p}))},destroy(e){Gle(e)}};function Yle(e,t,n,i){if(i)return;let r=t[e],s=n[e];return"angle"===e&&(r=ire(r),s=ire(s)),{property:e,start:r,end:s}}function Xle(e,t,n){for(;t>e;t--){const e=n[t];if(!isNaN(e.x)&&!isNaN(e.y))break}return t}function Qle(e,t,n,i){return e&&t?i(e[n],t[n]):e?e[n]:t?t[n]:0}function Kle(e,t){let n=[],i=!1;return gie(e)?(i=!0,n=e):n=function(e,t){const{x:n=null,y:i=null}=e||{},r=t.points,s=[];return t.segments.forEach((e=>{let{start:t,end:a}=e;a=Xle(t,a,r);const o=r[t],l=r[a];null!==i?(s.push({x:o.x,y:i}),s.push({x:l.x,y:i})):null!==n&&(s.push({x:n,y:o.y}),s.push({x:n,y:l.y}))})),s}(e,t),n.length?new Cle({points:n,options:{tension:0},_loop:i,_fullLoop:i}):null}function Zle(e){return e&&!1!==e.fill}function Jle(e,t,n){let i=e[t].fill;const r=[t];let s;if(!n)return i;for(;!1!==i&&-1===r.indexOf(i);){if(!yie(i))return i;if(s=e[i],!s)return!1;if(s.visible)return i;r.push(i),i=s.fill}return!1}function $le(e,t,n){const i=function(e){const t=e.options,n=t.fill;let i=bie(n&&n.target,n);void 0===i&&(i=!!t.backgroundColor);if(!1===i||null===i)return!1;if(!0===i)return"origin";return i}(e);if(vie(i))return!isNaN(i.value)&&i;let r=parseFloat(i);return yie(r)&&Math.floor(r)===r?function(e,t,n,i){"-"!==e&&"+"!==e||(n=t+n);if(n===t||n<0||n>=i)return!1;return n}(i[0],t,r,n):["origin","start","end","stack","shape"].indexOf(i)>=0&&i}function eue(e,t,n){const i=[];for(let r=0;r<n.length;r++){const s=n[r],{first:a,last:o,point:l}=tue(s,t,"x");if(!(!l||a&&o))if(a)i.unshift(l);else if(e.push(l),!o)break}e.push(...i)}function tue(e,t,n){const i=e.interpolate(t,n);if(!i)return{};const r=i[n],s=e.segments,a=e.points;let o=!1,l=!1;for(let u=0;u<s.length;u++){const e=s[u],t=a[e.start][n],i=a[e.end][n];if(are(r,t,i)){o=r===t,l=r===i;break}}return{first:o,last:l,point:i}}class nue{constructor(e){this.x=e.x,this.y=e.y,this.radius=e.radius}pathSegment(e,t,n){const{x:i,y:r,radius:s}=this;return t=t||{start:0,end:zie},e.arc(i,r,s,t.end,t.start,!0),!n.bounds}interpolate(e){const{x:t,y:n,radius:i}=this,r=e.angle;return{x:t+Math.cos(r)*i,y:n+Math.sin(r)*i,angle:r}}}function iue(e){const{chart:t,fill:n,line:i}=e;if(yie(n))return function(e,t){const n=e.getDatasetMeta(t),i=n&&e.isDatasetVisible(t);return i?n.dataset:null}(t,n);if("stack"===n)return function(e){const{scale:t,index:n,line:i}=e,r=[],s=i.segments,a=i.points,o=function(e,t){const n=[],i=e.getMatchingVisibleMetas("line");for(let r=0;r<i.length;r++){const e=i[r];if(e.index===t)break;e.hidden||n.unshift(e.dataset)}return n}(t,n);o.push(Kle({x:null,y:t.bottom},i));for(let l=0;l<s.length;l++){const e=s[l];for(let t=e.start;t<=e.end;t++)eue(r,a[t],o)}return new Cle({points:r,options:{}})}(e);if("shape"===n)return!0;const r=function(e){const t=e.scale||{};if(t.getPointPositionForValue)return function(e){const{scale:t,fill:n}=e,i=t.options,r=t.getLabels().length,s=i.reverse?t.max:t.min,a=function(e,t,n){let i;return i="start"===e?n:"end"===e?t.options.reverse?t.min:t.max:vie(e)?e.value:t.getBaseValue(),i}(n,t,s),o=[];if(i.grid.circular){const e=t.getPointPositionForValue(0,s);return new nue({x:e.x,y:e.y,radius:t.getDistanceFromCenterForValue(a)})}for(let l=0;l<r;++l)o.push(t.getPointPositionForValue(l,a));return o}(e);return function(e){const{scale:t={},fill:n}=e,i=function(e,t){let n=null;return"start"===e?n=t.bottom:"end"===e?n=t.top:vie(e)?n=t.getPixelForValue(e.value):t.getBasePixel&&(n=t.getBasePixel()),n}(n,t);if(yie(i)){const e=t.isHorizontal();return{x:e?i:null,y:e?null:i}}return null}(e)}(e);return r instanceof nue?r:Kle(r,i)}function rue(e,t,n){const i=iue(t),{line:r,scale:s,axis:a}=t,o=r.options,l=o.fill,u=o.backgroundColor,{above:c=u,below:h=u}=l||{};i&&r.points.length&&(Gre(e,n),function(e,t){const{line:n,target:i,above:r,below:s,area:a,scale:o}=t,l=n._loop?"angle":t.axis;e.save(),"x"===l&&s!==r&&(sue(e,i,a.top),aue(e,{line:n,target:i,color:r,scale:o,property:l}),e.restore(),e.save(),sue(e,i,a.bottom));aue(e,{line:n,target:i,color:s,scale:o,property:l}),e.restore()}(e,{line:r,target:i,above:c,below:h,area:n,scale:s,axis:a}),qre(e))}function sue(e,t,n){const{segments:i,points:r}=t;let s=!0,a=!1;e.beginPath();for(const o of i){const{start:i,end:l}=o,u=r[i],c=r[Xle(i,l,r)];s?(e.moveTo(u.x,u.y),s=!1):(e.lineTo(u.x,n),e.lineTo(u.x,u.y)),a=!!t.pathSegment(e,o,{move:a}),a?e.closePath():e.lineTo(c.x,n)}e.lineTo(t.first().x,n),e.closePath(),e.clip()}function aue(e,t){const{line:n,target:i,property:r,color:s,scale:a}=t,o=function(e,t,n){const i=e.segments,r=e.points,s=t.points,a=[];for(const o of i){let{start:e,end:i}=o;i=Xle(e,i,r);const l=Yle(n,r[e],r[i],o.loop);if(!t.segments){a.push({source:o,target:l,start:r[e],end:r[i]});continue}const u=Jse(t,l);for(const t of u){const e=Yle(n,s[t.start],s[t.end],t.loop),i=Zse(o,r,e);for(const r of i)a.push({source:r,target:t,start:{[n]:Qle(l,e,"start",Math.max)},end:{[n]:Qle(l,e,"end",Math.min)}})}}return a}(n,i,r);for(const{source:l,target:u,start:c,end:h}of o){const{style:{backgroundColor:t=s}={}}=l,o=!0!==i;e.save(),e.fillStyle=t,oue(e,a,o&&Yle(r,c,h)),e.beginPath();const d=!!n.pathSegment(e,l);let p;if(o){d?e.closePath():lue(e,i,h,r);const t=!!i.pathSegment(e,u,{move:d,reverse:!0});p=d&&t,p||lue(e,i,c,r)}e.closePath(),e.fill(p?"evenodd":"nonzero"),e.restore()}}function oue(e,t,n){const{top:i,bottom:r}=t.chart.chartArea,{property:s,start:a,end:o}=n||{};"x"===s&&(e.beginPath(),e.rect(a,i,o-a,r-i),e.clip())}function lue(e,t,n,i){const r=t.interpolate(n,i);r&&e.lineTo(r.x,r.y)}var uue={id:"filler",afterDatasetsUpdate(e,t,n){const i=(e.data.datasets||[]).length,r=[];let s,a,o,l;for(a=0;a<i;++a)s=e.getDatasetMeta(a),o=s.dataset,l=null,o&&o.options&&o instanceof Cle&&(l={visible:e.isDatasetVisible(a),index:a,fill:$le(o,a,i),chart:e,axis:s.controller.options.indexAxis,scale:s.vScale,line:o}),s.$filler=l,r.push(l);for(a=0;a<i;++a)l=r[a],l&&!1!==l.fill&&(l.fill=Jle(r,a,n.propagate))},beforeDraw(e,t,n){const i="beforeDraw"===n.drawTime,r=e.getSortedVisibleDatasetMetas(),s=e.chartArea;for(let a=r.length-1;a>=0;--a){const t=r[a].$filler;t&&(t.line.updateControlPoints(s,t.axis),i&&t.fill&&rue(e.ctx,t,s))}},beforeDatasetsDraw(e,t,n){if("beforeDatasetsDraw"!==n.drawTime)return;const i=e.getSortedVisibleDatasetMetas();for(let r=i.length-1;r>=0;--r){const t=i[r].$filler;Zle(t)&&rue(e.ctx,t,e.chartArea)}},beforeDatasetDraw(e,t,n){const i=t.meta.$filler;Zle(i)&&"beforeDatasetDraw"===n.drawTime&&rue(e.ctx,i,e.chartArea)},defaults:{propagate:!0,drawTime:"beforeDatasetDraw"}};const cue=(e,t)=>{let{boxHeight:n=t,boxWidth:i=t}=e;return e.usePointStyle&&(n=Math.min(n,t),i=e.pointStyleWidth||Math.min(i,t)),{boxWidth:i,boxHeight:n,itemHeight:Math.max(t,n)}};class hue extends _oe{constructor(e){super(),this._added=!1,this.legendHitBoxes=[],this._hoveredItem=null,this.doughnutMode=!1,this.chart=e.chart,this.options=e.options,this.ctx=e.ctx,this.legendItems=void 0,this.columnSizes=void 0,this.lineWidths=void 0,this.maxHeight=void 0,this.maxWidth=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.height=void 0,this.width=void 0,this._margins=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(e,t,n){this.maxWidth=e,this.maxHeight=t,this._margins=n,this.setDimensions(),this.buildLabels(),this.fit()}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=this._margins.left,this.right=this.width):(this.height=this.maxHeight,this.top=this._margins.top,this.bottom=this.height)}buildLabels(){const e=this.options.labels||{};let t=Die(e.generateLabels,[this.chart],this)||[];e.filter&&(t=t.filter((t=>e.filter(t,this.chart.data)))),e.sort&&(t=t.sort(((t,n)=>e.sort(t,n,this.chart.data)))),this.options.reverse&&t.reverse(),this.legendItems=t}fit(){const{options:e,ctx:t}=this;if(!e.display)return void(this.width=this.height=0);const n=e.labels,i=ose(n.font),r=i.size,s=this._computeTitleHeight(),{boxWidth:a,itemHeight:o}=cue(n,r);let l,u;t.font=i.string,this.isHorizontal()?(l=this.maxWidth,u=this._fitRows(s,r,a,o)+10):(u=this.maxHeight,l=this._fitCols(s,i,a,o)+10),this.width=Math.min(l,e.maxWidth||this.maxWidth),this.height=Math.min(u,e.maxHeight||this.maxHeight)}_fitRows(e,t,n,i){const{ctx:r,maxWidth:s,options:{labels:{padding:a}}}=this,o=this.legendHitBoxes=[],l=this.lineWidths=[0],u=i+a;let c=e;r.textAlign="left",r.textBaseline="middle";let h=-1,d=-u;return this.legendItems.forEach(((e,p)=>{const f=n+t/2+r.measureText(e.text).width;(0===p||l[l.length-1]+f+2*a>s)&&(c+=u,l[l.length-(p>0?0:1)]=0,d+=u,h++),o[p]={left:0,top:d,row:h,width:f,height:i},l[l.length-1]+=f+a})),c}_fitCols(e,t,n,i){const{ctx:r,maxHeight:s,options:{labels:{padding:a}}}=this,o=this.legendHitBoxes=[],l=this.columnSizes=[],u=s-e;let c=a,h=0,d=0,p=0,f=0;return this.legendItems.forEach(((e,s)=>{const{itemWidth:m,itemHeight:g}=function(e,t,n,i,r){const s=function(e,t,n,i){let r=e.text;r&&"string"!==typeof r&&(r=r.reduce(((e,t)=>e.length>t.length?e:t)));return t+n.size/2+i.measureText(r).width}(i,e,t,n),a=function(e,t,n){let i=e;"string"!==typeof t.text&&(i=due(t,n));return i}(r,i,t.lineHeight);return{itemWidth:s,itemHeight:a}}(n,t,r,e,i);s>0&&d+g+2*a>u&&(c+=h+a,l.push({width:h,height:d}),p+=h+a,f++,h=d=0),o[s]={left:p,top:d,col:f,width:m,height:g},h=Math.max(h,m),d+=g+a})),c+=h,l.push({width:h,height:d}),c}adjustHitBoxes(){if(!this.options.display)return;const e=this._computeTitleHeight(),{legendHitBoxes:t,options:{align:n,labels:{padding:i},rtl:r}}=this,s=qse(r,this.left,this.width);if(this.isHorizontal()){let r=0,a=gre(n,this.left+i,this.right-this.lineWidths[r]);for(const o of t)r!==o.row&&(r=o.row,a=gre(n,this.left+i,this.right-this.lineWidths[r])),o.top+=this.top+e+i,o.left=s.leftForLtr(s.x(a),o.width),a+=o.width+i}else{let r=0,a=gre(n,this.top+e+i,this.bottom-this.columnSizes[r].height);for(const o of t)o.col!==r&&(r=o.col,a=gre(n,this.top+e+i,this.bottom-this.columnSizes[r].height)),o.top=a,o.left+=this.left+i,o.left=s.leftForLtr(s.x(o.left),o.width),a+=o.height+i}}isHorizontal(){return"top"===this.options.position||"bottom"===this.options.position}draw(){if(this.options.display){const e=this.ctx;Gre(e,this),this._draw(),qre(e)}}_draw(){const{options:e,columnSizes:t,lineWidths:n,ctx:i}=this,{align:r,labels:s}=e,a=Lre.color,o=qse(e.rtl,this.left,this.width),l=ose(s.font),{padding:u}=s,c=l.size,h=c/2;let d;this.drawTitle(),i.textAlign=o.textAlign("left"),i.textBaseline="middle",i.lineWidth=.5,i.font=l.string;const{boxWidth:p,boxHeight:f,itemHeight:m}=cue(s,c),g=this.isHorizontal(),v=this._computeTitleHeight();d=g?{x:gre(r,this.left+u,this.right-n[0]),y:this.top+u+v,line:0}:{x:this.left+u,y:gre(r,this.top+v+u,this.bottom-t[0].height),line:0},Yse(this.ctx,e.textDirection);const y=m+u;this.legendItems.forEach(((x,b)=>{i.strokeStyle=x.fontColor,i.fillStyle=x.fontColor;const w=i.measureText(x.text).width,D=o.textAlign(x.textAlign||(x.textAlign=s.textAlign)),_=p+h+w;let S=d.x,E=d.y;o.setWidth(this.width),g?b>0&&S+_+u>this.right&&(E=d.y+=y,d.line++,S=d.x=gre(r,this.left+u,this.right-n[d.line])):b>0&&E+y>this.bottom&&(S=d.x=S+t[d.line].width+u,d.line++,E=d.y=gre(r,this.top+v+u,this.bottom-t[d.line].height));if(function(e,t,n){if(isNaN(p)||p<=0||isNaN(f)||f<0)return;i.save();const r=bie(n.lineWidth,1);if(i.fillStyle=bie(n.fillStyle,a),i.lineCap=bie(n.lineCap,"butt"),i.lineDashOffset=bie(n.lineDashOffset,0),i.lineJoin=bie(n.lineJoin,"miter"),i.lineWidth=r,i.strokeStyle=bie(n.strokeStyle,a),i.setLineDash(bie(n.lineDash,[])),s.usePointStyle){const a={radius:f*Math.SQRT2/2,pointStyle:n.pointStyle,rotation:n.rotation,borderWidth:r},l=o.xPlus(e,p/2);Hre(i,a,l,t+h,s.pointStyleWidth&&p)}else{const s=t+Math.max((c-f)/2,0),a=o.leftForLtr(e,p),l=sse(n.borderRadius);i.beginPath(),Object.values(l).some((e=>0!==e))?Jre(i,{x:a,y:s,w:p,h:f,radius:l}):i.rect(a,s,p,f),i.fill(),0!==r&&i.stroke()}i.restore()}(o.x(S),E,x),S=((e,t,n,i)=>e===(i?"left":"right")?n:"center"===e?(t+n)/2:t)(D,S+p+h,g?S+_:this.right,e.rtl),function(e,t,n){Zre(i,n.text,e,t+m/2,l,{strikethrough:n.hidden,textAlign:o.textAlign(n.textAlign)})}(o.x(S),E,x),g)d.x+=_+u;else if("string"!==typeof x.text){const e=l.lineHeight;d.y+=due(x,e)+u}else d.y+=y})),Xse(this.ctx,e.textDirection)}drawTitle(){const e=this.options,t=e.title,n=ose(t.font),i=ase(t.padding);if(!t.display)return;const r=qse(e.rtl,this.left,this.width),s=this.ctx,a=t.position,o=n.size/2,l=i.top+o;let u,c=this.left,h=this.width;if(this.isHorizontal())h=Math.max(...this.lineWidths),u=this.top+l,c=gre(e.align,c,this.right-h);else{const t=this.columnSizes.reduce(((e,t)=>Math.max(e,t.height)),0);u=l+gre(e.align,this.top,this.bottom-t-e.labels.padding-this._computeTitleHeight())}const d=gre(a,c,c+h);s.textAlign=r.textAlign(mre(a)),s.textBaseline="middle",s.strokeStyle=t.color,s.fillStyle=t.color,s.font=n.string,Zre(s,t.text,d,u,n)}_computeTitleHeight(){const e=this.options.title,t=ose(e.font),n=ase(e.padding);return e.display?t.lineHeight+n.height:0}_getLegendItemAt(e,t){let n,i,r;if(are(e,this.left,this.right)&&are(t,this.top,this.bottom))for(r=this.legendHitBoxes,n=0;n<r.length;++n)if(i=r[n],are(e,i.left,i.left+i.width)&&are(t,i.top,i.top+i.height))return this.legendItems[n];return null}handleEvent(e){const t=this.options;if(!function(e,t){if(("mousemove"===e||"mouseout"===e)&&(t.onHover||t.onLeave))return!0;if(t.onClick&&("click"===e||"mouseup"===e))return!0;return!1}(e.type,t))return;const n=this._getLegendItemAt(e.x,e.y);if("mousemove"===e.type||"mouseout"===e.type){const i=this._hoveredItem,r=((e,t)=>null!==e&&null!==t&&e.datasetIndex===t.datasetIndex&&e.index===t.index)(i,n);i&&!r&&Die(t.onLeave,[e,i,this],this),this._hoveredItem=n,n&&!r&&Die(t.onHover,[e,n,this],this)}else n&&Die(t.onClick,[e,n,this],this)}}function due(e,t){return t*(e.text?e.text.length:0)}var pue={id:"legend",_element:hue,start(e,t,n){const i=e.legend=new hue({ctx:e.ctx,options:n,chart:e});soe.configure(e,i,n),soe.addBox(e,i)},stop(e){soe.removeBox(e,e.legend),delete e.legend},beforeUpdate(e,t,n){const i=e.legend;soe.configure(e,i,n),i.options=n},afterUpdate(e){const t=e.legend;t.buildLabels(),t.adjustHitBoxes()},afterEvent(e,t){t.replay||e.legend.handleEvent(t.event)},defaults:{display:!0,position:"top",align:"center",fullSize:!0,reverse:!1,weight:1e3,onClick(e,t,n){const i=t.datasetIndex,r=n.chart;r.isDatasetVisible(i)?(r.hide(i),t.hidden=!0):(r.show(i),t.hidden=!1)},onHover:null,onLeave:null,labels:{color:e=>e.chart.options.color,boxWidth:40,padding:10,generateLabels(e){const t=e.data.datasets,{labels:{usePointStyle:n,pointStyle:i,textAlign:r,color:s,useBorderRadius:a,borderRadius:o}}=e.legend.options;return e._getSortedDatasetMetas().map((e=>{const l=e.controller.getStyle(n?0:void 0),u=ase(l.borderWidth);return{text:t[e.index].label,fillStyle:l.backgroundColor,fontColor:s,hidden:!e.visible,lineCap:l.borderCapStyle,lineDash:l.borderDash,lineDashOffset:l.borderDashOffset,lineJoin:l.borderJoinStyle,lineWidth:(u.width+u.height)/4,strokeStyle:l.borderColor,pointStyle:i||l.pointStyle,rotation:l.rotation,textAlign:r||l.textAlign,borderRadius:a&&(o||l.borderRadius),datasetIndex:e.index}}),this)}},title:{color:e=>e.chart.options.color,display:!1,position:"center",text:""}},descriptors:{_scriptable:e=>!e.startsWith("on"),labels:{_scriptable:e=>!["generateLabels","filter","sort"].includes(e)}}};class fue extends _oe{constructor(e){super(),this.chart=e.chart,this.options=e.options,this.ctx=e.ctx,this._padding=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(e,t){const n=this.options;if(this.left=0,this.top=0,!n.display)return void(this.width=this.height=this.right=this.bottom=0);this.width=this.right=e,this.height=this.bottom=t;const i=gie(n.text)?n.text.length:1;this._padding=ase(n.padding);const r=i*ose(n.font).lineHeight+this._padding.height;this.isHorizontal()?this.height=r:this.width=r}isHorizontal(){const e=this.options.position;return"top"===e||"bottom"===e}_drawArgs(e){const{top:t,left:n,bottom:i,right:r,options:s}=this,a=s.align;let o,l,u,c=0;return this.isHorizontal()?(l=gre(a,n,r),u=t+e,o=r-n):("left"===s.position?(l=n+e,u=gre(a,i,t),c=-.5*Lie):(l=r-e,u=gre(a,t,i),c=.5*Lie),o=i-t),{titleX:l,titleY:u,maxWidth:o,rotation:c}}draw(){const e=this.ctx,t=this.options;if(!t.display)return;const n=ose(t.font),i=n.lineHeight/2+this._padding.top,{titleX:r,titleY:s,maxWidth:a,rotation:o}=this._drawArgs(i);Zre(e,t.text,0,0,n,{color:t.color,maxWidth:a,rotation:o,textAlign:mre(t.align),textBaseline:"middle",translation:[r,s]})}}var mue={id:"title",_element:fue,start(e,t,n){!function(e,t){const n=new fue({ctx:e.ctx,options:t,chart:e});soe.configure(e,n,t),soe.addBox(e,n),e.titleBlock=n}(e,n)},stop(e){const t=e.titleBlock;soe.removeBox(e,t),delete e.titleBlock},beforeUpdate(e,t,n){const i=e.titleBlock;soe.configure(e,i,n),i.options=n},defaults:{align:"center",display:!1,font:{weight:"bold"},fullSize:!0,padding:10,position:"top",text:"",weight:2e3},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const gue=new WeakMap;var vue={id:"subtitle",start(e,t,n){const i=new fue({ctx:e.ctx,options:n,chart:e});soe.configure(e,i,n),soe.addBox(e,i),gue.set(e,i)},stop(e){soe.removeBox(e,gue.get(e)),gue.delete(e)},beforeUpdate(e,t,n){const i=gue.get(e);soe.configure(e,i,n),i.options=n},defaults:{align:"center",display:!1,font:{weight:"normal"},fullSize:!0,padding:0,position:"top",text:"",weight:1500},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const yue={average(e){if(!e.length)return!1;let t,n,i=new Set,r=0,s=0;for(t=0,n=e.length;t<n;++t){const n=e[t].element;if(n&&n.hasValue()){const e=n.tooltipPosition();i.add(e.x),r+=e.y,++s}}if(0===s||0===i.size)return!1;const a=[...i].reduce(((e,t)=>e+t))/i.size;return{x:a,y:r/s}},nearest(e,t){if(!e.length)return!1;let n,i,r,s=t.x,a=t.y,o=Number.POSITIVE_INFINITY;for(n=0,i=e.length;n<i;++n){const i=e[n].element;if(i&&i.hasValue()){const e=tre(t,i.getCenterPoint());e<o&&(o=e,r=i)}}if(r){const e=r.tooltipPosition();s=e.x,a=e.y}return{x:s,y:a}}};function xue(e,t){return t&&(gie(t)?Array.prototype.push.apply(e,t):e.push(t)),e}function bue(e){return("string"===typeof e||e instanceof String)&&e.indexOf("\n")>-1?e.split("\n"):e}function wue(e,t){const{element:n,datasetIndex:i,index:r}=t,s=e.getDatasetMeta(i).controller,{label:a,value:o}=s.getLabelAndValue(r);return{chart:e,label:a,parsed:s.getParsed(r),raw:e.data.datasets[i].data[r],formattedValue:o,dataset:s.getDataset(),dataIndex:r,datasetIndex:i,element:n}}function Due(e,t){const n=e.chart.ctx,{body:i,footer:r,title:s}=e,{boxWidth:a,boxHeight:o}=t,l=ose(t.bodyFont),u=ose(t.titleFont),c=ose(t.footerFont),h=s.length,d=r.length,p=i.length,f=ase(t.padding);let m=f.height,g=0,v=i.reduce(((e,t)=>e+t.before.length+t.lines.length+t.after.length),0);if(v+=e.beforeBody.length+e.afterBody.length,h&&(m+=h*u.lineHeight+(h-1)*t.titleSpacing+t.titleMarginBottom),v){m+=p*(t.displayColors?Math.max(o,l.lineHeight):l.lineHeight)+(v-p)*l.lineHeight+(v-1)*t.bodySpacing}d&&(m+=t.footerMarginTop+d*c.lineHeight+(d-1)*t.footerSpacing);let y=0;const x=function(e){g=Math.max(g,n.measureText(e).width+y)};return n.save(),n.font=u.string,_ie(e.title,x),n.font=l.string,_ie(e.beforeBody.concat(e.afterBody),x),y=t.displayColors?a+2+t.boxPadding:0,_ie(i,(e=>{_ie(e.before,x),_ie(e.lines,x),_ie(e.after,x)})),y=0,n.font=c.string,_ie(e.footer,x),n.restore(),g+=f.width,{width:g,height:m}}function _ue(e,t,n,i){const{x:r,width:s}=n,{width:a,chartArea:{left:o,right:l}}=e;let u="center";return"center"===i?u=r<=(o+l)/2?"left":"right":r<=s/2?u="left":r>=a-s/2&&(u="right"),function(e,t,n,i){const{x:r,width:s}=i,a=n.caretSize+n.caretPadding;return"left"===e&&r+s+a>t.width||"right"===e&&r-s-a<0||void 0}(u,e,t,n)&&(u="center"),u}function Sue(e,t,n){const i=n.yAlign||t.yAlign||function(e,t){const{y:n,height:i}=t;return n<i/2?"top":n>e.height-i/2?"bottom":"center"}(e,n);return{xAlign:n.xAlign||t.xAlign||_ue(e,t,n,i),yAlign:i}}function Eue(e,t,n,i){const{caretSize:r,caretPadding:s,cornerRadius:a}=e,{xAlign:o,yAlign:l}=n,u=r+s,{topLeft:c,topRight:h,bottomLeft:d,bottomRight:p}=sse(a);let f=function(e,t){let{x:n,width:i}=e;return"right"===t?n-=i:"center"===t&&(n-=i/2),n}(t,o);const m=function(e,t,n){let{y:i,height:r}=e;return"top"===t?i+=n:i-="bottom"===t?r+n:r/2,i}(t,l,u);return"center"===l?"left"===o?f+=u:"right"===o&&(f-=u):"left"===o?f-=Math.max(c,d)+r:"right"===o&&(f+=Math.max(h,p)+r),{x:sre(f,0,i.width-t.width),y:sre(m,0,i.height-t.height)}}function Cue(e,t,n){const i=ase(n.padding);return"center"===t?e.x+e.width/2:"right"===t?e.x+e.width-i.right:e.x+i.left}function Aue(e){return xue([],bue(e))}function Mue(e,t){const n=t&&t.dataset&&t.dataset.tooltip&&t.dataset.tooltip.callbacks;return n?e.override(n):e}const Tue={beforeTitle:pie,title(e){if(e.length>0){const t=e[0],n=t.chart.data.labels,i=n?n.length:0;if(this&&this.options&&"dataset"===this.options.mode)return t.dataset.label||"";if(t.label)return t.label;if(i>0&&t.dataIndex<i)return n[t.dataIndex]}return""},afterTitle:pie,beforeBody:pie,beforeLabel:pie,label(e){if(this&&this.options&&"dataset"===this.options.mode)return e.label+": "+e.formattedValue||e.formattedValue;let t=e.dataset.label||"";t&&(t+=": ");const n=e.formattedValue;return mie(n)||(t+=n),t},labelColor(e){const t=e.chart.getDatasetMeta(e.datasetIndex).controller.getStyle(e.dataIndex);return{borderColor:t.borderColor,backgroundColor:t.backgroundColor,borderWidth:t.borderWidth,borderDash:t.borderDash,borderDashOffset:t.borderDashOffset,borderRadius:0}},labelTextColor(){return this.options.bodyColor},labelPointStyle(e){const t=e.chart.getDatasetMeta(e.datasetIndex).controller.getStyle(e.dataIndex);return{pointStyle:t.pointStyle,rotation:t.rotation}},afterLabel:pie,afterBody:pie,beforeFooter:pie,footer:pie,afterFooter:pie};function Pue(e,t,n,i){const r=e[t].call(n,i);return"undefined"===typeof r?Tue[t].call(n,i):r}class Fue extends _oe{constructor(e){super(),this.opacity=0,this._active=[],this._eventPosition=void 0,this._size=void 0,this._cachedAnimations=void 0,this._tooltipItems=[],this.$animations=void 0,this.$context=void 0,this.chart=e.chart,this.options=e.options,this.dataPoints=void 0,this.title=void 0,this.beforeBody=void 0,this.body=void 0,this.afterBody=void 0,this.footer=void 0,this.xAlign=void 0,this.yAlign=void 0,this.x=void 0,this.y=void 0,this.height=void 0,this.width=void 0,this.caretX=void 0,this.caretY=void 0,this.labelColors=void 0,this.labelPointStyles=void 0,this.labelTextColors=void 0}initialize(e){this.options=e,this._cachedAnimations=void 0,this.$context=void 0}_resolveAnimations(){const e=this._cachedAnimations;if(e)return e;const t=this.chart,n=this.options.setContext(this.getContext()),i=n.enabled&&t.options.animation&&n.animations,r=new oae(this.chart,i);return i._cacheable&&(this._cachedAnimations=Object.freeze(r)),r}getContext(){return this.$context||(this.$context=(e=this.chart.getContext(),t=this,n=this._tooltipItems,use(e,{tooltip:t,tooltipItems:n,type:"tooltip"})));var e,t,n}getTitle(e,t){const{callbacks:n}=t,i=Pue(n,"beforeTitle",this,e),r=Pue(n,"title",this,e),s=Pue(n,"afterTitle",this,e);let a=[];return a=xue(a,bue(i)),a=xue(a,bue(r)),a=xue(a,bue(s)),a}getBeforeBody(e,t){return Aue(Pue(t.callbacks,"beforeBody",this,e))}getBody(e,t){const{callbacks:n}=t,i=[];return _ie(e,(e=>{const t={before:[],lines:[],after:[]},r=Mue(n,e);xue(t.before,bue(Pue(r,"beforeLabel",this,e))),xue(t.lines,Pue(r,"label",this,e)),xue(t.after,bue(Pue(r,"afterLabel",this,e))),i.push(t)})),i}getAfterBody(e,t){return Aue(Pue(t.callbacks,"afterBody",this,e))}getFooter(e,t){const{callbacks:n}=t,i=Pue(n,"beforeFooter",this,e),r=Pue(n,"footer",this,e),s=Pue(n,"afterFooter",this,e);let a=[];return a=xue(a,bue(i)),a=xue(a,bue(r)),a=xue(a,bue(s)),a}_createItems(e){const t=this._active,n=this.chart.data,i=[],r=[],s=[];let a,o,l=[];for(a=0,o=t.length;a<o;++a)l.push(wue(this.chart,t[a]));return e.filter&&(l=l.filter(((t,i,r)=>e.filter(t,i,r,n)))),e.itemSort&&(l=l.sort(((t,i)=>e.itemSort(t,i,n)))),_ie(l,(t=>{const n=Mue(e.callbacks,t);i.push(Pue(n,"labelColor",this,t)),r.push(Pue(n,"labelPointStyle",this,t)),s.push(Pue(n,"labelTextColor",this,t))})),this.labelColors=i,this.labelPointStyles=r,this.labelTextColors=s,this.dataPoints=l,l}update(e,t){const n=this.options.setContext(this.getContext()),i=this._active;let r,s=[];if(i.length){const e=yue[n.position].call(this,i,this._eventPosition);s=this._createItems(n),this.title=this.getTitle(s,n),this.beforeBody=this.getBeforeBody(s,n),this.body=this.getBody(s,n),this.afterBody=this.getAfterBody(s,n),this.footer=this.getFooter(s,n);const t=this._size=Due(this,n),a=Object.assign({},e,t),o=Sue(this.chart,n,a),l=Eue(n,a,o,this.chart);this.xAlign=o.xAlign,this.yAlign=o.yAlign,r={opacity:1,x:l.x,y:l.y,width:t.width,height:t.height,caretX:e.x,caretY:e.y}}else 0!==this.opacity&&(r={opacity:0});this._tooltipItems=s,this.$context=void 0,r&&this._resolveAnimations().update(this,r),e&&n.external&&n.external.call(this,{chart:this.chart,tooltip:this,replay:t})}drawCaret(e,t,n,i){const r=this.getCaretPosition(e,n,i);t.lineTo(r.x1,r.y1),t.lineTo(r.x2,r.y2),t.lineTo(r.x3,r.y3)}getCaretPosition(e,t,n){const{xAlign:i,yAlign:r}=this,{caretSize:s,cornerRadius:a}=n,{topLeft:o,topRight:l,bottomLeft:u,bottomRight:c}=sse(a),{x:h,y:d}=e,{width:p,height:f}=t;let m,g,v,y,x,b;return"center"===r?(x=d+f/2,"left"===i?(m=h,g=m-s,y=x+s,b=x-s):(m=h+p,g=m+s,y=x-s,b=x+s),v=m):(g="left"===i?h+Math.max(o,u)+s:"right"===i?h+p-Math.max(l,c)-s:this.caretX,"top"===r?(y=d,x=y-s,m=g-s,v=g+s):(y=d+f,x=y+s,m=g+s,v=g-s),b=y),{x1:m,x2:g,x3:v,y1:y,y2:x,y3:b}}drawTitle(e,t,n){const i=this.title,r=i.length;let s,a,o;if(r){const l=qse(n.rtl,this.x,this.width);for(e.x=Cue(this,n.titleAlign,n),t.textAlign=l.textAlign(n.titleAlign),t.textBaseline="middle",s=ose(n.titleFont),a=n.titleSpacing,t.fillStyle=n.titleColor,t.font=s.string,o=0;o<r;++o)t.fillText(i[o],l.x(e.x),e.y+s.lineHeight/2),e.y+=s.lineHeight+a,o+1===r&&(e.y+=n.titleMarginBottom-a)}}_drawColorBox(e,t,n,i,r){const s=this.labelColors[n],a=this.labelPointStyles[n],{boxHeight:o,boxWidth:l}=r,u=ose(r.bodyFont),c=Cue(this,"left",r),h=i.x(c),d=o<u.lineHeight?(u.lineHeight-o)/2:0,p=t.y+d;if(r.usePointStyle){const t={radius:Math.min(l,o)/2,pointStyle:a.pointStyle,rotation:a.rotation,borderWidth:1},n=i.leftForLtr(h,l)+l/2,u=p+o/2;e.strokeStyle=r.multiKeyBackground,e.fillStyle=r.multiKeyBackground,Vre(e,t,n,u),e.strokeStyle=s.borderColor,e.fillStyle=s.backgroundColor,Vre(e,t,n,u)}else{e.lineWidth=vie(s.borderWidth)?Math.max(...Object.values(s.borderWidth)):s.borderWidth||1,e.strokeStyle=s.borderColor,e.setLineDash(s.borderDash||[]),e.lineDashOffset=s.borderDashOffset||0;const t=i.leftForLtr(h,l),n=i.leftForLtr(i.xPlus(h,1),l-2),a=sse(s.borderRadius);Object.values(a).some((e=>0!==e))?(e.beginPath(),e.fillStyle=r.multiKeyBackground,Jre(e,{x:t,y:p,w:l,h:o,radius:a}),e.fill(),e.stroke(),e.fillStyle=s.backgroundColor,e.beginPath(),Jre(e,{x:n,y:p+1,w:l-2,h:o-2,radius:a}),e.fill()):(e.fillStyle=r.multiKeyBackground,e.fillRect(t,p,l,o),e.strokeRect(t,p,l,o),e.fillStyle=s.backgroundColor,e.fillRect(n,p+1,l-2,o-2))}e.fillStyle=this.labelTextColors[n]}drawBody(e,t,n){const{body:i}=this,{bodySpacing:r,bodyAlign:s,displayColors:a,boxHeight:o,boxWidth:l,boxPadding:u}=n,c=ose(n.bodyFont);let h=c.lineHeight,d=0;const p=qse(n.rtl,this.x,this.width),f=function(n){t.fillText(n,p.x(e.x+d),e.y+h/2),e.y+=h+r},m=p.textAlign(s);let g,v,y,x,b,w,D;for(t.textAlign=s,t.textBaseline="middle",t.font=c.string,e.x=Cue(this,m,n),t.fillStyle=n.bodyColor,_ie(this.beforeBody,f),d=a&&"right"!==m?"center"===s?l/2+u:l+2+u:0,x=0,w=i.length;x<w;++x){for(g=i[x],v=this.labelTextColors[x],t.fillStyle=v,_ie(g.before,f),y=g.lines,a&&y.length&&(this._drawColorBox(t,e,x,p,n),h=Math.max(c.lineHeight,o)),b=0,D=y.length;b<D;++b)f(y[b]),h=c.lineHeight;_ie(g.after,f)}d=0,h=c.lineHeight,_ie(this.afterBody,f),e.y-=r}drawFooter(e,t,n){const i=this.footer,r=i.length;let s,a;if(r){const o=qse(n.rtl,this.x,this.width);for(e.x=Cue(this,n.footerAlign,n),e.y+=n.footerMarginTop,t.textAlign=o.textAlign(n.footerAlign),t.textBaseline="middle",s=ose(n.footerFont),t.fillStyle=n.footerColor,t.font=s.string,a=0;a<r;++a)t.fillText(i[a],o.x(e.x),e.y+s.lineHeight/2),e.y+=s.lineHeight+n.footerSpacing}}drawBackground(e,t,n,i){const{xAlign:r,yAlign:s}=this,{x:a,y:o}=e,{width:l,height:u}=n,{topLeft:c,topRight:h,bottomLeft:d,bottomRight:p}=sse(i.cornerRadius);t.fillStyle=i.backgroundColor,t.strokeStyle=i.borderColor,t.lineWidth=i.borderWidth,t.beginPath(),t.moveTo(a+c,o),"top"===s&&this.drawCaret(e,t,n,i),t.lineTo(a+l-h,o),t.quadraticCurveTo(a+l,o,a+l,o+h),"center"===s&&"right"===r&&this.drawCaret(e,t,n,i),t.lineTo(a+l,o+u-p),t.quadraticCurveTo(a+l,o+u,a+l-p,o+u),"bottom"===s&&this.drawCaret(e,t,n,i),t.lineTo(a+d,o+u),t.quadraticCurveTo(a,o+u,a,o+u-d),"center"===s&&"left"===r&&this.drawCaret(e,t,n,i),t.lineTo(a,o+c),t.quadraticCurveTo(a,o,a+c,o),t.closePath(),t.fill(),i.borderWidth>0&&t.stroke()}_updateAnimationTarget(e){const t=this.chart,n=this.$animations,i=n&&n.x,r=n&&n.y;if(i||r){const n=yue[e.position].call(this,this._active,this._eventPosition);if(!n)return;const s=this._size=Due(this,e),a=Object.assign({},n,this._size),o=Sue(t,e,a),l=Eue(e,a,o,t);i._to===l.x&&r._to===l.y||(this.xAlign=o.xAlign,this.yAlign=o.yAlign,this.width=s.width,this.height=s.height,this.caretX=n.x,this.caretY=n.y,this._resolveAnimations().update(this,l))}}_willRender(){return!!this.opacity}draw(e){const t=this.options.setContext(this.getContext());let n=this.opacity;if(!n)return;this._updateAnimationTarget(t);const i={width:this.width,height:this.height},r={x:this.x,y:this.y};n=Math.abs(n)<.001?0:n;const s=ase(t.padding),a=this.title.length||this.beforeBody.length||this.body.length||this.afterBody.length||this.footer.length;t.enabled&&a&&(e.save(),e.globalAlpha=n,this.drawBackground(r,e,i,t),Yse(e,t.textDirection),r.y+=s.top,this.drawTitle(r,e,t),this.drawBody(r,e,t),this.drawFooter(r,e,t),Xse(e,t.textDirection),e.restore())}getActiveElements(){return this._active||[]}setActiveElements(e,t){const n=this._active,i=e.map((e=>{let{datasetIndex:t,index:n}=e;const i=this.chart.getDatasetMeta(t);if(!i)throw new Error("Cannot find a dataset at index "+t);return{datasetIndex:t,element:i.data[n],index:n}})),r=!Sie(n,i),s=this._positionChanged(i,t);(r||s)&&(this._active=i,this._eventPosition=t,this._ignoreReplayEvents=!0,this.update(!0))}handleEvent(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(t&&this._ignoreReplayEvents)return!1;this._ignoreReplayEvents=!1;const i=this.options,r=this._active||[],s=this._getActiveElements(e,r,t,n),a=this._positionChanged(s,e),o=t||!Sie(s,r)||a;return o&&(this._active=s,(i.enabled||i.external)&&(this._eventPosition={x:e.x,y:e.y},this.update(!0,t))),o}_getActiveElements(e,t,n,i){const r=this.options;if("mouseout"===e.type)return[];if(!i)return t.filter((e=>this.chart.data.datasets[e.datasetIndex]&&void 0!==this.chart.getDatasetMeta(e.datasetIndex).controller.getParsed(e.index)));const s=this.chart.getElementsAtEventForMode(e,r.mode,r,n);return r.reverse&&s.reverse(),s}_positionChanged(e,t){const{caretX:n,caretY:i,options:r}=this,s=yue[r.position].call(this,e,t);return!1!==s&&(n!==s.x||i!==s.y)}}c(Fue,"positioners",yue);var Oue={id:"tooltip",_element:Fue,positioners:yue,afterInit(e,t,n){n&&(e.tooltip=new Fue({chart:e,options:n}))},beforeUpdate(e,t,n){e.tooltip&&e.tooltip.initialize(n)},reset(e,t,n){e.tooltip&&e.tooltip.initialize(n)},afterDraw(e){const t=e.tooltip;if(t&&t._willRender()){const n={tooltip:t};if(!1===e.notifyPlugins("beforeTooltipDraw",d(d({},n),{},{cancelable:!0})))return;t.draw(e.ctx),e.notifyPlugins("afterTooltipDraw",n)}},afterEvent(e,t){if(e.tooltip){const n=t.replay;e.tooltip.handleEvent(t.event,n,t.inChartArea)&&(t.changed=!0)}},defaults:{enabled:!0,external:null,position:"average",backgroundColor:"rgba(0,0,0,0.8)",titleColor:"#fff",titleFont:{weight:"bold"},titleSpacing:2,titleMarginBottom:6,titleAlign:"left",bodyColor:"#fff",bodySpacing:2,bodyFont:{},bodyAlign:"left",footerColor:"#fff",footerSpacing:2,footerMarginTop:6,footerFont:{weight:"bold"},footerAlign:"left",padding:6,caretPadding:2,caretSize:5,cornerRadius:6,boxHeight:(e,t)=>t.bodyFont.size,boxWidth:(e,t)=>t.bodyFont.size,multiKeyBackground:"#fff",displayColors:!0,boxPadding:0,borderColor:"rgba(0,0,0,0)",borderWidth:0,animation:{duration:400,easing:"easeOutQuart"},animations:{numbers:{type:"number",properties:["x","y","width","height","caretX","caretY"]},opacity:{easing:"linear",duration:200}},callbacks:Tue},defaultRoutes:{bodyFont:"font",footerFont:"font",titleFont:"font"},descriptors:{_scriptable:e=>"filter"!==e&&"itemSort"!==e&&"external"!==e,_indexable:!1,callbacks:{_scriptable:!1,_indexable:!1},animation:{_fallback:!1},animations:{_fallback:"animation"}},additionalOptionScopes:["interaction"]},Iue=Object.freeze({__proto__:null,Colors:Hle,Decimation:qle,Filler:uue,Legend:pue,SubTitle:vue,Title:mue,Tooltip:Oue});function kue(e,t,n,i){const r=e.indexOf(t);if(-1===r)return((e,t,n,i)=>("string"===typeof t?(n=e.push(t)-1,i.unshift({index:n,label:t})):isNaN(t)&&(n=null),n))(e,t,n,i);return r!==e.lastIndexOf(t)?n:r}function Bue(e){const t=this.getLabels();return e>=0&&e<t.length?t[e]:e}class Rue extends Ioe{constructor(e){super(e),this._startValue=void 0,this._valueRange=0,this._addedLabels=[]}init(e){const t=this._addedLabels;if(t.length){const e=this.getLabels();for(const{index:n,label:i}of t)e[n]===i&&e.splice(n,1);this._addedLabels=[]}super.init(e)}parse(e,t){if(mie(e))return null;const n=this.getLabels();return((e,t)=>null===e?null:sre(Math.round(e),0,t))(t=isFinite(t)&&n[t]===e?t:kue(n,e,bie(t,e),this._addedLabels),n.length-1)}determineDataLimits(){const{minDefined:e,maxDefined:t}=this.getUserBounds();let{min:n,max:i}=this.getMinMax(!0);"ticks"===this.options.bounds&&(e||(n=0),t||(i=this.getLabels().length-1)),this.min=n,this.max=i}buildTicks(){const e=this.min,t=this.max,n=this.options.offset,i=[];let r=this.getLabels();r=0===e&&t===r.length-1?r:r.slice(e,t+1),this._valueRange=Math.max(r.length-(n?0:1),1),this._startValue=this.min-(n?.5:0);for(let s=e;s<=t;s++)i.push({value:s});return i}getLabelForValue(e){return Bue.call(this,e)}configure(){super.configure(),this.isHorizontal()||(this._reversePixels=!this._reversePixels)}getPixelForValue(e){return"number"!==typeof e&&(e=this.parse(e)),null===e?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}getPixelForTick(e){const t=this.ticks;return e<0||e>t.length-1?null:this.getPixelForValue(t[e].value)}getValueForPixel(e){return Math.round(this._startValue+this.getDecimalForPixel(e)*this._valueRange)}getBasePixel(){return this.bottom}}function Lue(e,t){const n=[],{bounds:i,step:r,min:s,max:a,precision:o,count:l,maxTicks:u,maxDigits:c,includeBounds:h}=e,d=r||1,p=u-1,{min:f,max:m}=t,g=!mie(s),v=!mie(a),y=!mie(l),x=(m-f)/(c+1);let b,w,D,_,S=Xie((m-f)/p/d)*d;if(S<1e-14&&!g&&!v)return[{value:f},{value:m}];_=Math.ceil(m/S)-Math.floor(f/S),_>p&&(S=Xie(_*S/p/d)*d),mie(o)||(b=Math.pow(10,o),S=Math.ceil(S*b)/b),"ticks"===i?(w=Math.floor(f/S)*S,D=Math.ceil(m/S)*S):(w=f,D=m),g&&v&&r&&function(e,t){const n=Math.round(e);return n-t<=e&&n+t>=e}((a-s)/r,S/1e3)?(_=Math.round(Math.min((a-s)/S,u)),S=(a-s)/_,w=s,D=a):y?(w=g?s:w,D=v?a:D,_=l-1,S=(D-w)/_):(_=(D-w)/S,_=Yie(_,Math.round(_),S/1e3)?Math.round(_):Math.ceil(_));const E=Math.max($ie(S),$ie(w));b=Math.pow(10,mie(o)?E:o),w=Math.round(w*b)/b,D=Math.round(D*b)/b;let C=0;for(g&&(h&&w!==s?(n.push({value:s}),w<s&&C++,Yie(Math.round((w+C*S)*b)/b,s,zue(s,x,e))&&C++):w<s&&C++);C<_;++C){const e=Math.round((w+C*S)*b)/b;if(v&&e>a)break;n.push({value:e})}return v&&h&&D!==a?n.length&&Yie(n[n.length-1].value,a,zue(a,x,e))?n[n.length-1].value=a:n.push({value:a}):v&&D!==a||n.push({value:D}),n}function zue(e,t,n){let{horizontal:i,minRotation:r}=n;const s=Zie(r),a=(i?Math.sin(s):Math.cos(s))||.001,o=.75*t*(""+e).length;return Math.min(t/a,o)}c(Rue,"id","category"),c(Rue,"defaults",{ticks:{callback:Bue}});class Nue extends Ioe{constructor(e){super(e),this.start=void 0,this.end=void 0,this._startValue=void 0,this._endValue=void 0,this._valueRange=0}parse(e,t){return mie(e)||("number"===typeof e||e instanceof Number)&&!isFinite(+e)?null:+e}handleTickRangeOptions(){const{beginAtZero:e}=this.options,{minDefined:t,maxDefined:n}=this.getUserBounds();let{min:i,max:r}=this;const s=e=>i=t?i:e,a=e=>r=n?r:e;if(e){const e=qie(i),t=qie(r);e<0&&t<0?a(0):e>0&&t>0&&s(0)}if(i===r){let t=0===r?1:Math.abs(.05*r);a(r+t),e||s(i-t)}this.min=i,this.max=r}getTickLimit(){const e=this.options.ticks;let t,{maxTicksLimit:n,stepSize:i}=e;return i?(t=Math.ceil(this.max/i)-Math.floor(this.min/i)+1,t>1e3&&(console.warn("scales.".concat(this.id,".ticks.stepSize: ").concat(i," would result generating up to ").concat(t," ticks. Limiting to 1000.")),t=1e3)):(t=this.computeTickLimit(),n=n||11),n&&(t=Math.min(n,t)),t}computeTickLimit(){return Number.POSITIVE_INFINITY}buildTicks(){const e=this.options,t=e.ticks;let n=this.getTickLimit();n=Math.max(2,n);const i=Lue({maxTicks:n,bounds:e.bounds,min:e.min,max:e.max,precision:t.precision,step:t.stepSize,count:t.count,maxDigits:this._maxDigits(),horizontal:this.isHorizontal(),minRotation:t.minRotation||0,includeBounds:!1!==t.includeBounds},this._range||this);return"ticks"===e.bounds&&Kie(i,this,"value"),e.reverse?(i.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),i}configure(){const e=this.ticks;let t=this.min,n=this.max;if(super.configure(),this.options.offset&&e.length){const i=(n-t)/Math.max(e.length-1,1)/2;t-=i,n+=i}this._startValue=t,this._endValue=n,this._valueRange=n-t}getLabelForValue(e){return Tre(e,this.chart.options.locale,this.options.ticks.format)}}class jue extends Nue{determineDataLimits(){const{min:e,max:t}=this.getMinMax(!0);this.min=yie(e)?e:0,this.max=yie(t)?t:1,this.handleTickRangeOptions()}computeTickLimit(){const e=this.isHorizontal(),t=e?this.width:this.height,n=Zie(this.options.ticks.minRotation),i=(e?Math.sin(n):Math.cos(n))||.001,r=this._resolveTickFontOptions(0);return Math.ceil(t/Math.min(40,r.lineHeight/i))}getPixelForValue(e){return null===e?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}getValueForPixel(e){return this._startValue+this.getDecimalForPixel(e)*this._valueRange}}c(jue,"id","linear"),c(jue,"defaults",{ticks:{callback:Fre.formatters.numeric}});const Uue=e=>Math.floor(Gie(e)),Vue=(e,t)=>Math.pow(10,Uue(e)+t);function Hue(e){return 1===e/Math.pow(10,Uue(e))}function Wue(e,t,n){const i=Math.pow(10,n),r=Math.floor(e/i);return Math.ceil(t/i)-r}function Gue(e,t){let{min:n,max:i}=t;n=xie(e.min,n);const r=[],s=Uue(n);let a=function(e,t){let n=Uue(t-e);for(;Wue(e,t,n)>10;)n++;for(;Wue(e,t,n)<10;)n--;return Math.min(n,Uue(e))}(n,i),o=a<0?Math.pow(10,Math.abs(a)):1;const l=Math.pow(10,a),u=s>a?Math.pow(10,s):0,c=Math.round((n-u)*o)/o,h=Math.floor((n-u)/l/10)*l*10;let d=Math.floor((c-h)/Math.pow(10,a)),p=xie(e.min,Math.round((u+h+d*Math.pow(10,a))*o)/o);for(;p<i;)r.push({value:p,major:Hue(p),significand:d}),d>=10?d=d<15?15:20:d++,d>=20&&(a++,d=2,o=a>=0?1:o),p=Math.round((u+h+d*Math.pow(10,a))*o)/o;const f=xie(e.max,p);return r.push({value:f,major:Hue(f),significand:d}),r}class que extends Ioe{constructor(e){super(e),this.start=void 0,this.end=void 0,this._startValue=void 0,this._valueRange=0}parse(e,t){const n=Nue.prototype.parse.apply(this,[e,t]);if(0!==n)return yie(n)&&n>0?n:null;this._zero=!0}determineDataLimits(){const{min:e,max:t}=this.getMinMax(!0);this.min=yie(e)?Math.max(0,e):null,this.max=yie(t)?Math.max(0,t):null,this.options.beginAtZero&&(this._zero=!0),this._zero&&this.min!==this._suggestedMin&&!yie(this._userMin)&&(this.min=e===Vue(this.min,0)?Vue(this.min,-1):Vue(this.min,0)),this.handleTickRangeOptions()}handleTickRangeOptions(){const{minDefined:e,maxDefined:t}=this.getUserBounds();let n=this.min,i=this.max;const r=t=>n=e?n:t,s=e=>i=t?i:e;n===i&&(n<=0?(r(1),s(10)):(r(Vue(n,-1)),s(Vue(i,1)))),n<=0&&r(Vue(i,-1)),i<=0&&s(Vue(n,1)),this.min=n,this.max=i}buildTicks(){const e=this.options,t=Gue({min:this._userMin,max:this._userMax},this);return"ticks"===e.bounds&&Kie(t,this,"value"),e.reverse?(t.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),t}getLabelForValue(e){return void 0===e?"0":Tre(e,this.chart.options.locale,this.options.ticks.format)}configure(){const e=this.min;super.configure(),this._startValue=Gie(e),this._valueRange=Gie(this.max)-Gie(e)}getPixelForValue(e){return void 0!==e&&0!==e||(e=this.min),null===e||isNaN(e)?NaN:this.getPixelForDecimal(e===this.min?0:(Gie(e)-this._startValue)/this._valueRange)}getValueForPixel(e){const t=this.getDecimalForPixel(e);return Math.pow(10,this._startValue+t*this._valueRange)}}function Yue(e){const t=e.ticks;if(t.display&&e.display){const e=ase(t.backdropPadding);return bie(t.font&&t.font.size,Lre.font.size)+e.height}return 0}function Xue(e,t,n,i,r){return e===i||e===r?{start:t-n/2,end:t+n/2}:e<i||e>r?{start:t-n,end:t}:{start:t,end:t+n}}function Que(e){const t={l:e.left+e._padding.left,r:e.right-e._padding.right,t:e.top+e._padding.top,b:e.bottom-e._padding.bottom},n=Object.assign({},t),i=[],r=[],s=e._pointLabels.length,a=e.options.pointLabels,o=a.centerPointLabels?Lie/s:0;for(let h=0;h<s;h++){const s=a.setContext(e.getPointLabelContext(h));r[h]=s.padding;const d=e.getPointPosition(h,e.drawingArea+r[h],o),p=ose(s.font),f=(l=e.ctx,u=p,c=gie(c=e._pointLabels[h])?c:[c],{w:Nre(l,u.string,c),h:c.length*u.lineHeight});i[h]=f;const m=ire(e.getIndexAngle(h)+o),g=Math.round(Jie(m));Kue(n,t,m,Xue(g,d.x,f.w,0,180),Xue(g,d.y,f.h,90,270))}var l,u,c;e.setCenterPoint(t.l-n.l,n.r-t.r,t.t-n.t,n.b-t.b),e._pointLabelItems=function(e,t,n){const i=[],r=e._pointLabels.length,s=e.options,{centerPointLabels:a,display:o}=s.pointLabels,l={extra:Yue(s)/2,additionalAngle:a?Lie/r:0};let u;for(let c=0;c<r;c++){l.padding=n[c],l.size=t[c];const r=Zue(e,c,l);i.push(r),"auto"===o&&(r.visible=Jue(r,u),r.visible&&(u=r))}return i}(e,i,r)}function Kue(e,t,n,i,r){const s=Math.abs(Math.sin(n)),a=Math.abs(Math.cos(n));let o=0,l=0;i.start<t.l?(o=(t.l-i.start)/s,e.l=Math.min(e.l,t.l-o)):i.end>t.r&&(o=(i.end-t.r)/s,e.r=Math.max(e.r,t.r+o)),r.start<t.t?(l=(t.t-r.start)/a,e.t=Math.min(e.t,t.t-l)):r.end>t.b&&(l=(r.end-t.b)/a,e.b=Math.max(e.b,t.b+l))}function Zue(e,t,n){const i=e.drawingArea,{extra:r,additionalAngle:s,padding:a,size:o}=n,l=e.getPointPosition(t,i+r+a,s),u=Math.round(Jie(ire(l.angle+Vie))),c=function(e,t,n){90===n||270===n?e-=t/2:(n>270||n<90)&&(e-=t);return e}(l.y,o.h,u),h=function(e){if(0===e||180===e)return"center";if(e<180)return"left";return"right"}(u),d=function(e,t,n){"right"===n?e-=t:"center"===n&&(e-=t/2);return e}(l.x,o.w,h);return{visible:!0,x:l.x,y:c,textAlign:h,left:d,top:c,right:d+o.w,bottom:c+o.h}}function Jue(e,t){if(!t)return!0;const{left:n,top:i,right:r,bottom:s}=e;return!(Wre({x:n,y:i},t)||Wre({x:n,y:s},t)||Wre({x:r,y:i},t)||Wre({x:r,y:s},t))}function $ue(e,t,n){const{left:i,top:r,right:s,bottom:a}=n,{backdropColor:o}=t;if(!mie(o)){const n=sse(t.borderRadius),l=ase(t.backdropPadding);e.fillStyle=o;const u=i-l.left,c=r-l.top,h=s-i+l.width,d=a-r+l.height;Object.values(n).some((e=>0!==e))?(e.beginPath(),Jre(e,{x:u,y:c,w:h,h:d,radius:n}),e.fill()):e.fillRect(u,c,h,d)}}function ece(e,t,n,i){const{ctx:r}=e;if(n)r.arc(e.xCenter,e.yCenter,t,0,zie);else{let n=e.getPointPosition(0,t);r.moveTo(n.x,n.y);for(let s=1;s<i;s++)n=e.getPointPosition(s,t),r.lineTo(n.x,n.y)}}c(que,"id","logarithmic"),c(que,"defaults",{ticks:{callback:Fre.formatters.logarithmic,major:{enabled:!0}}});class tce extends Nue{constructor(e){super(e),this.xCenter=void 0,this.yCenter=void 0,this.drawingArea=void 0,this._pointLabels=[],this._pointLabelItems=[]}setDimensions(){const e=this._padding=ase(Yue(this.options)/2),t=this.width=this.maxWidth-e.width,n=this.height=this.maxHeight-e.height;this.xCenter=Math.floor(this.left+t/2+e.left),this.yCenter=Math.floor(this.top+n/2+e.top),this.drawingArea=Math.floor(Math.min(t,n)/2)}determineDataLimits(){const{min:e,max:t}=this.getMinMax(!1);this.min=yie(e)&&!isNaN(e)?e:0,this.max=yie(t)&&!isNaN(t)?t:0,this.handleTickRangeOptions()}computeTickLimit(){return Math.ceil(this.drawingArea/Yue(this.options))}generateTickLabels(e){Nue.prototype.generateTickLabels.call(this,e),this._pointLabels=this.getLabels().map(((e,t)=>{const n=Die(this.options.pointLabels.callback,[e,t],this);return n||0===n?n:""})).filter(((e,t)=>this.chart.getDataVisibility(t)))}fit(){const e=this.options;e.display&&e.pointLabels.display?Que(this):this.setCenterPoint(0,0,0,0)}setCenterPoint(e,t,n,i){this.xCenter+=Math.floor((e-t)/2),this.yCenter+=Math.floor((n-i)/2),this.drawingArea-=Math.min(this.drawingArea/2,Math.max(e,t,n,i))}getIndexAngle(e){return ire(e*(zie/(this._pointLabels.length||1))+Zie(this.options.startAngle||0))}getDistanceFromCenterForValue(e){if(mie(e))return NaN;const t=this.drawingArea/(this.max-this.min);return this.options.reverse?(this.max-e)*t:(e-this.min)*t}getValueForDistanceFromCenter(e){if(mie(e))return NaN;const t=e/(this.drawingArea/(this.max-this.min));return this.options.reverse?this.max-t:this.min+t}getPointLabelContext(e){const t=this._pointLabels||[];if(e>=0&&e<t.length){const n=t[e];return function(e,t,n){return use(e,{label:n,index:t,type:"pointLabel"})}(this.getContext(),e,n)}}getPointPosition(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const i=this.getIndexAngle(e)-Vie+n;return{x:Math.cos(i)*t+this.xCenter,y:Math.sin(i)*t+this.yCenter,angle:i}}getPointPositionForValue(e,t){return this.getPointPosition(e,this.getDistanceFromCenterForValue(t))}getBasePosition(e){return this.getPointPositionForValue(e||0,this.getBaseValue())}getPointLabelPosition(e){const{left:t,top:n,right:i,bottom:r}=this._pointLabelItems[e];return{left:t,top:n,right:i,bottom:r}}drawBackground(){const{backgroundColor:e,grid:{circular:t}}=this.options;if(e){const n=this.ctx;n.save(),n.beginPath(),ece(this,this.getDistanceFromCenterForValue(this._endValue),t,this._pointLabels.length),n.closePath(),n.fillStyle=e,n.fill(),n.restore()}}drawGrid(){const e=this.ctx,t=this.options,{angleLines:n,grid:i,border:r}=t,s=this._pointLabels.length;let a,o,l;if(t.pointLabels.display&&function(e,t){const{ctx:n,options:{pointLabels:i}}=e;for(let r=t-1;r>=0;r--){const t=e._pointLabelItems[r];if(!t.visible)continue;const s=i.setContext(e.getPointLabelContext(r));$ue(n,s,t);const a=ose(s.font),{x:o,y:l,textAlign:u}=t;Zre(n,e._pointLabels[r],o,l+a.lineHeight/2,a,{color:s.color,textAlign:u,textBaseline:"middle"})}}(this,s),i.display&&this.ticks.forEach(((e,t)=>{if(0!==t||0===t&&this.min<0){o=this.getDistanceFromCenterForValue(e.value);const n=this.getContext(t),a=i.setContext(n),l=r.setContext(n);!function(e,t,n,i,r){const s=e.ctx,a=t.circular,{color:o,lineWidth:l}=t;!a&&!i||!o||!l||n<0||(s.save(),s.strokeStyle=o,s.lineWidth=l,s.setLineDash(r.dash||[]),s.lineDashOffset=r.dashOffset,s.beginPath(),ece(e,n,a,i),s.closePath(),s.stroke(),s.restore())}(this,a,o,s,l)}})),n.display){for(e.save(),a=s-1;a>=0;a--){const i=n.setContext(this.getPointLabelContext(a)),{color:r,lineWidth:s}=i;s&&r&&(e.lineWidth=s,e.strokeStyle=r,e.setLineDash(i.borderDash),e.lineDashOffset=i.borderDashOffset,o=this.getDistanceFromCenterForValue(t.reverse?this.min:this.max),l=this.getPointPosition(a,o),e.beginPath(),e.moveTo(this.xCenter,this.yCenter),e.lineTo(l.x,l.y),e.stroke())}e.restore()}}drawBorder(){}drawLabels(){const e=this.ctx,t=this.options,n=t.ticks;if(!n.display)return;const i=this.getIndexAngle(0);let r,s;e.save(),e.translate(this.xCenter,this.yCenter),e.rotate(i),e.textAlign="center",e.textBaseline="middle",this.ticks.forEach(((i,a)=>{if(0===a&&this.min>=0&&!t.reverse)return;const o=n.setContext(this.getContext(a)),l=ose(o.font);if(r=this.getDistanceFromCenterForValue(this.ticks[a].value),o.showLabelBackdrop){e.font=l.string,s=e.measureText(i.label).width,e.fillStyle=o.backdropColor;const t=ase(o.backdropPadding);e.fillRect(-s/2-t.left,-r-l.size/2-t.top,s+t.width,l.size+t.height)}Zre(e,i.label,0,-r,l,{color:o.color,strokeColor:o.textStrokeColor,strokeWidth:o.textStrokeWidth})})),e.restore()}drawTitle(){}}c(tce,"id","radialLinear"),c(tce,"defaults",{display:!0,animate:!0,position:"chartArea",angleLines:{display:!0,lineWidth:1,borderDash:[],borderDashOffset:0},grid:{circular:!1},startAngle:0,ticks:{showLabelBackdrop:!0,callback:Fre.formatters.numeric},pointLabels:{backdropColor:void 0,backdropPadding:2,display:!0,font:{size:10},callback:e=>e,padding:5,centerPointLabels:!1}}),c(tce,"defaultRoutes",{"angleLines.color":"borderColor","pointLabels.color":"color","ticks.color":"color"}),c(tce,"descriptors",{angleLines:{_fallback:"grid"}});const nce={millisecond:{common:!0,size:1,steps:1e3},second:{common:!0,size:1e3,steps:60},minute:{common:!0,size:6e4,steps:60},hour:{common:!0,size:36e5,steps:24},day:{common:!0,size:864e5,steps:30},week:{common:!1,size:6048e5,steps:4},month:{common:!0,size:2628e6,steps:12},quarter:{common:!1,size:7884e6,steps:4},year:{common:!0,size:3154e7}},ice=Object.keys(nce);function rce(e,t){return e-t}function sce(e,t){if(mie(t))return null;const n=e._adapter,{parser:i,round:r,isoWeekday:s}=e._parseOpts;let a=t;return"function"===typeof i&&(a=i(a)),yie(a)||(a="string"===typeof i?n.parse(a,i):n.parse(a)),null===a?null:(r&&(a="week"!==r||!Qie(s)&&!0!==s?n.startOf(a,r):n.startOf(a,"isoWeek",s)),+a)}function ace(e,t,n,i){const r=ice.length;for(let s=ice.indexOf(e);s<r-1;++s){const e=nce[ice[s]],r=e.steps?e.steps:Number.MAX_SAFE_INTEGER;if(e.common&&Math.ceil((n-t)/(r*e.size))<=i)return ice[s]}return ice[r-1]}function oce(e,t,n){if(n){if(n.length){const{lo:i,hi:r}=ore(n,t);e[n[i]>=t?n[i]:n[r]]=!0}}else e[t]=!0}function lce(e,t,n){const i=[],r={},s=t.length;let a,o;for(a=0;a<s;++a)o=t[a],r[o]=a,i.push({value:o,major:!1});return 0!==s&&n?function(e,t,n,i){const r=e._adapter,s=+r.startOf(t[0].value,i),a=t[t.length-1].value;let o,l;for(o=s;o<=a;o=+r.add(o,1,i))l=n[o],l>=0&&(t[l].major=!0);return t}(e,i,r,n):i}class uce extends Ioe{constructor(e){super(e),this._cache={data:[],labels:[],all:[]},this._unit="day",this._majorUnit=void 0,this._offsets={},this._normalized=!1,this._parseOpts=void 0}init(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=e.time||(e.time={}),i=this._adapter=new Nae(e.adapters.date);i.init(t),Tie(n.displayFormats,i.formats()),this._parseOpts={parser:n.parser,round:n.round,isoWeekday:n.isoWeekday},super.init(e),this._normalized=t.normalized}parse(e,t){return void 0===e?null:sce(this,e)}beforeLayout(){super.beforeLayout(),this._cache={data:[],labels:[],all:[]}}determineDataLimits(){const e=this.options,t=this._adapter,n=e.time.unit||"day";let{min:i,max:r,minDefined:s,maxDefined:a}=this.getUserBounds();function o(e){s||isNaN(e.min)||(i=Math.min(i,e.min)),a||isNaN(e.max)||(r=Math.max(r,e.max))}s&&a||(o(this._getLabelBounds()),"ticks"===e.bounds&&"labels"===e.ticks.source||o(this.getMinMax(!1))),i=yie(i)&&!isNaN(i)?i:+t.startOf(Date.now(),n),r=yie(r)&&!isNaN(r)?r:+t.endOf(Date.now(),n)+1,this.min=Math.min(i,r-1),this.max=Math.max(i+1,r)}_getLabelBounds(){const e=this.getLabelTimestamps();let t=Number.POSITIVE_INFINITY,n=Number.NEGATIVE_INFINITY;return e.length&&(t=e[0],n=e[e.length-1]),{min:t,max:n}}buildTicks(){const e=this.options,t=e.time,n=e.ticks,i="labels"===n.source?this.getLabelTimestamps():this._generate();"ticks"===e.bounds&&i.length&&(this.min=this._userMin||i[0],this.max=this._userMax||i[i.length-1]);const r=this.min,s=function(e,t,n){let i=0,r=e.length;for(;i<r&&e[i]<t;)i++;for(;r>i&&e[r-1]>n;)r--;return i>0||r<e.length?e.slice(i,r):e}(i,r,this.max);return this._unit=t.unit||(n.autoSkip?ace(t.minUnit,this.min,this.max,this._getLabelCapacity(r)):function(e,t,n,i,r){for(let s=ice.length-1;s>=ice.indexOf(n);s--){const n=ice[s];if(nce[n].common&&e._adapter.diff(r,i,n)>=t-1)return n}return ice[n?ice.indexOf(n):0]}(this,s.length,t.minUnit,this.min,this.max)),this._majorUnit=n.major.enabled&&"year"!==this._unit?function(e){for(let t=ice.indexOf(e)+1,n=ice.length;t<n;++t)if(nce[ice[t]].common)return ice[t]}(this._unit):void 0,this.initOffsets(i),e.reverse&&s.reverse(),lce(this,s,this._majorUnit)}afterAutoSkip(){this.options.offsetAfterAutoskip&&this.initOffsets(this.ticks.map((e=>+e.value)))}initOffsets(){let e,t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],i=0,r=0;this.options.offset&&n.length&&(e=this.getDecimalForValue(n[0]),i=1===n.length?1-e:(this.getDecimalForValue(n[1])-e)/2,t=this.getDecimalForValue(n[n.length-1]),r=1===n.length?t:(t-this.getDecimalForValue(n[n.length-2]))/2);const s=n.length<3?.5:.25;i=sre(i,0,s),r=sre(r,0,s),this._offsets={start:i,end:r,factor:1/(i+1+r)}}_generate(){const e=this._adapter,t=this.min,n=this.max,i=this.options,r=i.time,s=r.unit||ace(r.minUnit,t,n,this._getLabelCapacity(t)),a=bie(i.ticks.stepSize,1),o="week"===s&&r.isoWeekday,l=Qie(o)||!0===o,u={};let c,h,d=t;if(l&&(d=+e.startOf(d,"isoWeek",o)),d=+e.startOf(d,l?"day":s),e.diff(n,t,s)>1e5*a)throw new Error(t+" and "+n+" are too far apart with stepSize of "+a+" "+s);const p="data"===i.ticks.source&&this.getDataTimestamps();for(c=d,h=0;c<n;c=+e.add(c,a,s),h++)oce(u,c,p);return c!==n&&"ticks"!==i.bounds&&1!==h||oce(u,c,p),Object.keys(u).sort(rce).map((e=>+e))}getLabelForValue(e){const t=this._adapter,n=this.options.time;return n.tooltipFormat?t.format(e,n.tooltipFormat):t.format(e,n.displayFormats.datetime)}format(e,t){const n=this.options.time.displayFormats,i=this._unit,r=t||n[i];return this._adapter.format(e,r)}_tickFormatFunction(e,t,n,i){const r=this.options,s=r.ticks.callback;if(s)return Die(s,[e,t,n],this);const a=r.time.displayFormats,o=this._unit,l=this._majorUnit,u=o&&a[o],c=l&&a[l],h=n[t],d=l&&c&&h&&h.major;return this._adapter.format(e,i||(d?c:u))}generateTickLabels(e){let t,n,i;for(t=0,n=e.length;t<n;++t)i=e[t],i.label=this._tickFormatFunction(i.value,t,e)}getDecimalForValue(e){return null===e?NaN:(e-this.min)/(this.max-this.min)}getPixelForValue(e){const t=this._offsets,n=this.getDecimalForValue(e);return this.getPixelForDecimal((t.start+n)*t.factor)}getValueForPixel(e){const t=this._offsets,n=this.getDecimalForPixel(e)/t.factor-t.end;return this.min+n*(this.max-this.min)}_getLabelSize(e){const t=this.options.ticks,n=this.ctx.measureText(e).width,i=Zie(this.isHorizontal()?t.maxRotation:t.minRotation),r=Math.cos(i),s=Math.sin(i),a=this._resolveTickFontOptions(0).size;return{w:n*r+a*s,h:n*s+a*r}}_getLabelCapacity(e){const t=this.options.time,n=t.displayFormats,i=n[t.unit]||n.millisecond,r=this._tickFormatFunction(e,0,lce(this,[e],this._majorUnit),i),s=this._getLabelSize(r),a=Math.floor(this.isHorizontal()?this.width/s.w:this.height/s.h)-1;return a>0?a:1}getDataTimestamps(){let e,t,n=this._cache.data||[];if(n.length)return n;const i=this.getMatchingVisibleMetas();if(this._normalized&&i.length)return this._cache.data=i[0].controller.getAllParsedValues(this);for(e=0,t=i.length;e<t;++e)n=n.concat(i[e].controller.getAllParsedValues(this));return this._cache.data=this.normalize(n)}getLabelTimestamps(){const e=this._cache.labels||[];let t,n;if(e.length)return e;const i=this.getLabels();for(t=0,n=i.length;t<n;++t)e.push(sce(this,i[t]));return this._cache.labels=this._normalized?e:this.normalize(e)}normalize(e){return dre(e.sort(rce))}}function cce(e,t,n){let i,r,s,a,o=0,l=e.length-1;n?(t>=e[o].pos&&t<=e[l].pos&&({lo:o,hi:l}=lre(e,"pos",t)),({pos:i,time:s}=e[o]),({pos:r,time:a}=e[l])):(t>=e[o].time&&t<=e[l].time&&({lo:o,hi:l}=lre(e,"time",t)),({time:i,pos:s}=e[o]),({time:r,pos:a}=e[l]));const u=r-i;return u?s+(a-s)*(t-i)/u:s}c(uce,"id","time"),c(uce,"defaults",{bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{source:"auto",callback:!1,major:{enabled:!1}}});class hce extends uce{constructor(e){super(e),this._table=[],this._minPos=void 0,this._tableRange=void 0}initOffsets(){const e=this._getTimestampsForTable(),t=this._table=this.buildLookupTable(e);this._minPos=cce(t,this.min),this._tableRange=cce(t,this.max)-this._minPos,super.initOffsets(e)}buildLookupTable(e){const{min:t,max:n}=this,i=[],r=[];let s,a,o,l,u;for(s=0,a=e.length;s<a;++s)l=e[s],l>=t&&l<=n&&i.push(l);if(i.length<2)return[{time:t,pos:0},{time:n,pos:1}];for(s=0,a=i.length;s<a;++s)u=i[s+1],o=i[s-1],l=i[s],Math.round((u+o)/2)!==l&&r.push({time:l,pos:s/(a-1)});return r}_generate(){const e=this.min,t=this.max;let n=super.getDataTimestamps();return n.includes(e)&&n.length||n.splice(0,0,e),n.includes(t)&&1!==n.length||n.push(t),n.sort(((e,t)=>e-t))}_getTimestampsForTable(){let e=this._cache.all||[];if(e.length)return e;const t=this.getDataTimestamps(),n=this.getLabelTimestamps();return e=t.length&&n.length?this.normalize(t.concat(n)):t.length?t:n,e=this._cache.all=e,e}getDecimalForValue(e){return(cce(this._table,e)-this._minPos)/this._tableRange}getValueForPixel(e){const t=this._offsets,n=this.getDecimalForPixel(e)/t.factor-t.end;return cce(this._table,n*this._tableRange+this._minPos,!0)}}c(hce,"id","timeseries"),c(hce,"defaults",uce.defaults);const dce=[Rae,Rle,Iue,Object.freeze({__proto__:null,CategoryScale:Rue,LinearScale:jue,LogarithmicScale:que,RadialLinearScale:tce,TimeScale:uce,TimeSeriesScale:hce})];hle.register(...dce);const pce=["height","width","redraw","datasetIdKey","type","data","options","plugins","fallbackContent","updateMode"],fce="label";function mce(e,t){"function"===typeof e?e(t):e&&(e.current=t)}function gce(e,t){e.labels=t}function vce(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:fce;const i=[];e.datasets=t.map((t=>{const r=e.datasets.find((e=>e[n]===t[n]));return r&&t.data&&!i.includes(r)?(i.push(r),Object.assign(r,t),r):d({},t)}))}function yce(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:fce;const n={labels:[],datasets:[]};return gce(n,e.labels),vce(n,e.datasets,t),n}function xce(e,t){const{height:n=150,width:i=300,redraw:s=!1,datasetIdKey:a,type:l,data:u,options:c,plugins:h=[],fallbackContent:p,updateMode:f}=e,m=o(e,pce),g=(0,r.useRef)(null),v=(0,r.useRef)(null),y=()=>{g.current&&(v.current=new hle(g.current,{type:l,data:yce(u,a),options:c&&d({},c),plugins:h}),mce(t,v.current))},x=()=>{mce(t,null),v.current&&(v.current.destroy(),v.current=null)};return(0,r.useEffect)((()=>{!s&&v.current&&c&&function(e,t){const n=e.options;n&&t&&Object.assign(n,t)}(v.current,c)}),[s,c]),(0,r.useEffect)((()=>{!s&&v.current&&gce(v.current.config.data,u.labels)}),[s,u.labels]),(0,r.useEffect)((()=>{!s&&v.current&&u.datasets&&vce(v.current.config.data,u.datasets,a)}),[s,u.datasets]),(0,r.useEffect)((()=>{v.current&&(s?(x(),setTimeout(y)):v.current.update(f))}),[s,c,u.labels,u.datasets,f]),(0,r.useEffect)((()=>{v.current&&(x(),setTimeout(y))}),[l]),(0,r.useEffect)((()=>(y(),()=>x())),[]),r.createElement("canvas",d({ref:g,role:"img",height:n,width:i},m),p)}const bce=(0,r.forwardRef)(xce);function wce(e,t){return hle.register(t),(0,r.forwardRef)(((t,n)=>r.createElement(bce,d(d({},t),{},{ref:n,type:e}))))}const Dce=wce("line",Fae),_ce=wce("bar",Mae),Sce=wce("doughnut",Pae),Ece=JSON.parse('[{"label":"Jan","revenue":64854,"cost":32652},{"label":"Feb","revenue":54628,"cost":42393},{"label":"Mar","revenue":117238,"cost":50262},{"label":"Apr","revenue":82830,"cost":64731},{"label":"May","revenue":91208,"cost":41893},{"label":"Jun","revenue":103609,"cost":83809},{"label":"Jul","revenue":90974,"cost":44772},{"label":"Aug","revenue":82919,"cost":37590},{"label":"Sep","revenue":62407,"cost":43349},{"label":"Oct","revenue":82528,"cost":45324},{"label":"Nov","revenue":56979,"cost":47978},{"label":"Dec","revenue":87436,"cost":39175}]'),Cce=JSON.parse('[{"label":"Ads","value":32},{"label":"Subscriptions","value":45},{"label":"Sponsorships","value":23}]');Lre.maintainAspectRatio=!1,Lre.responsive=!0,Lre.plugins.title.display=!0,Lre.plugins.title.align="start",Lre.plugins.title.font.size=20,Lre.plugins.title.color="black";const Ace=["Pizza","Burger","Pasta","Sandwich","Fries"],Mce=()=>(0,lo.jsxs)("div",{className:"App",children:[(0,lo.jsx)("div",{className:"dataCard revenueCard",children:(0,lo.jsx)(Dce,{data:{labels:Ace,datasets:[{label:"Food Revenue",data:Ece.map((e=>e.revenue)),backgroundColor:"#064FF0",borderColor:"#064FF0"},{label:"Food Cost",data:Ece.map((e=>e.cost)),backgroundColor:"#FF3030",borderColor:"#FF3030"}]},options:{elements:{line:{tension:.5}},scales:{y:{ticks:{callback:function(e){return"".concat(e/1e3,"K")}}}},plugins:{title:{text:"Monthly Food Revenue & Cost"}}}})}),(0,lo.jsx)("div",{className:"dataCard customerCard",children:(0,lo.jsx)(Dce,{data:{labels:Ace,datasets:[{label:"Count",data:Cce.map((e=>e.value)),borderColor:"rgba(43, 63, 229, 0.8)",backgroundColor:"rgba(43, 63, 229, 0.3)",fill:!0}]},options:{plugins:{title:{text:"Food Revenue Sources"}}}})}),(0,lo.jsx)("div",{className:"dataCard categoryCard",children:(0,lo.jsx)(Sce,{data:{labels:Ace,datasets:[{label:"Count",data:Cce.map((e=>e.value)),backgroundColor:["rgba(43, 63, 229, 0.8)","rgba(250, 192, 19, 0.8)","rgba(253, 135, 135, 0.8)"],borderColor:["rgba(43, 63, 229, 0.8)","rgba(250, 192, 19, 0.8)","rgba(253, 135, 135, 0.8)"]}]},options:{plugins:{title:{text:"Food Revenue Sources"}}}})})]}),Tce="Tom Cook",Pce="tom@example.com",Fce="https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=facearea&facepad=2&w=256&h=256&q=80",Oce=[{name:"Dashboard",href:"dashboard",current:!1},{name:"Menu",href:"ai",current:!1},{name:"Orders",href:"users",current:!1},{name:"Analytics",href:"analytics",current:!0}],Ice=[{name:"Your Profile",href:"#"},{name:"Settings",href:"#"},{name:"Sign out",href:"#"}];function kce(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.filter(Boolean).join(" ")}function Bce(){return(0,lo.jsx)(lo.Fragment,{children:(0,lo.jsxs)("div",{className:"min-h-full",children:[(0,lo.jsxs)(yi,{as:"nav",className:"bg-gray-800",children:[(0,lo.jsx)("div",{className:"mx-auto max-w-7xl px-4 sm:px-6 lg:px-8",children:(0,lo.jsxs)("div",{className:"flex h-16 items-center justify-between",children:[(0,lo.jsxs)("div",{className:"flex items-center",children:[(0,lo.jsx)("div",{className:"shrink-0",children:(0,lo.jsx)("img",{alt:"Your Company",src:"https://tailwindui.com/plus/img/logos/mark.svg?color=indigo&shade=500",className:"size-8"})}),(0,lo.jsx)("div",{className:"hidden md:block",children:(0,lo.jsx)("div",{className:"ml-10 flex items-baseline space-x-4",children:Oce.map((e=>(0,lo.jsx)("a",{href:e.href,"aria-current":e.current?"page":void 0,className:kce(e.current?"bg-gray-900 text-white":"text-gray-300 hover:bg-gray-700 hover:text-white","rounded-md px-3 py-2 text-sm font-medium"),children:e.name},e.name)))})})]}),(0,lo.jsx)("div",{className:"hidden md:block",children:(0,lo.jsxs)("div",{className:"ml-4 flex items-center md:ml-6",children:[(0,lo.jsxs)("button",{type:"button",className:"relative rounded-full bg-gray-800 p-1 text-gray-400 hover:text-white focus:outline-none focus:ring-2 focus:ring-white focus:ring-offset-2 focus:ring-offset-gray-800",children:[(0,lo.jsx)("span",{className:"absolute -inset-1.5"}),(0,lo.jsx)("span",{className:"sr-only",children:"View notifications"}),(0,lo.jsx)(to,{"aria-hidden":"true",className:"size-6"})]}),(0,lo.jsxs)(Ja,{as:"div",className:"relative ml-3",children:[(0,lo.jsx)("div",{children:(0,lo.jsxs)(qa,{className:"relative flex max-w-xs items-center rounded-full bg-gray-800 text-sm focus:outline-none focus:ring-2 focus:ring-white focus:ring-offset-2 focus:ring-offset-gray-800",children:[(0,lo.jsx)("span",{className:"absolute -inset-1.5"}),(0,lo.jsx)("span",{className:"sr-only",children:"Open user menu"}),(0,lo.jsx)("img",{alt:"",src:Fce,className:"size-8 rounded-full"})]})}),(0,lo.jsx)(Ya,{transition:!0,className:"absolute right-0 z-10 mt-2 w-48 origin-top-right rounded-md bg-white py-1 shadow-lg ring-1 ring-black/5 transition focus:outline-none data-[closed]:scale-95 data-[closed]:transform data-[closed]:opacity-0 data-[enter]:duration-100 data-[leave]:duration-75 data-[enter]:ease-out data-[leave]:ease-in",children:Ice.map((e=>(0,lo.jsx)(Xa,{children:(0,lo.jsx)("a",{href:e.href,className:"block px-4 py-2 text-sm text-gray-700 data-[focus]:bg-gray-100 data-[focus]:outline-none",children:e.name})},e.name)))})]})]})}),(0,lo.jsx)("div",{className:"-mr-2 flex md:hidden",children:(0,lo.jsxs)(gi,{className:"group relative inline-flex items-center justify-center rounded-md bg-gray-800 p-2 text-gray-400 hover:bg-gray-700 hover:text-white focus:outline-none focus:ring-2 focus:ring-white focus:ring-offset-2 focus:ring-offset-gray-800",children:[(0,lo.jsx)("span",{className:"absolute -inset-0.5"}),(0,lo.jsx)("span",{className:"sr-only",children:"Open main menu"}),(0,lo.jsx)(ro,{"aria-hidden":"true",className:"block size-6 group-data-[open]:hidden"}),(0,lo.jsx)(oo,{"aria-hidden":"true",className:"hidden size-6 group-data-[open]:block"})]})})]})}),(0,lo.jsxs)(vi,{className:"md:hidden",children:[(0,lo.jsx)("div",{className:"space-y-1 px-2 pb-3 pt-2 sm:px-3",children:Oce.map((e=>(0,lo.jsx)(gi,{as:"a",href:e.href,"aria-current":e.current?"page":void 0,className:kce(e.current?"bg-gray-900 text-white":"text-gray-300 hover:bg-gray-700 hover:text-white","block rounded-md px-3 py-2 text-base font-medium"),children:e.name},e.name)))}),(0,lo.jsxs)("div",{className:"border-t border-gray-700 pb-3 pt-4",children:[(0,lo.jsxs)("div",{className:"flex items-center px-5",children:[(0,lo.jsx)("div",{className:"shrink-0",children:(0,lo.jsx)("img",{alt:"",src:Fce,className:"size-10 rounded-full"})}),(0,lo.jsxs)("div",{className:"ml-3",children:[(0,lo.jsx)("div",{className:"text-base/5 font-medium text-white",children:Tce}),(0,lo.jsx)("div",{className:"text-sm font-medium text-gray-400",children:Pce})]}),(0,lo.jsxs)("button",{type:"button",className:"relative ml-auto shrink-0 rounded-full bg-gray-800 p-1 text-gray-400 hover:text-white focus:outline-none focus:ring-2 focus:ring-white focus:ring-offset-2 focus:ring-offset-gray-800",children:[(0,lo.jsx)("span",{className:"absolute -inset-1.5"}),(0,lo.jsx)("span",{className:"sr-only",children:"View notifications"}),(0,lo.jsx)(to,{"aria-hidden":"true",className:"size-6"})]})]}),(0,lo.jsx)("div",{className:"mt-3 space-y-1 px-2",children:Ice.map((e=>(0,lo.jsx)(gi,{as:"a",href:e.href,className:"block rounded-md px-3 py-2 text-base font-medium text-gray-400 hover:bg-gray-700 hover:text-white",children:e.name},e.name)))})]})]})]}),(0,lo.jsx)("header",{className:"bg-white shadow",children:(0,lo.jsx)("div",{className:"mx-auto max-w-7xl px-4 py-6 sm:px-6 lg:px-8",children:(0,lo.jsx)("h1",{className:"text-3xl font-bold tracking-tight text-gray-900",children:"Analytics"})})}),(0,lo.jsx)("main",{children:(0,lo.jsx)("div",{className:"mx-auto ",children:(0,lo.jsx)(Mce,{})})})]})})}const Rce=()=>(0,lo.jsxs)(lo.Fragment,{children:[(0,lo.jsx)(i5,{scene:"https://prod.spline.design/ww7CsoUoDPuIIB-K/scene.splinecode"}),";"]}),Lce="Tom Cook",zce="tom@example.com",Nce="https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=facearea&facepad=2&w=256&h=256&q=80",jce=[{name:"Dashboard",href:"dashboard",current:!1},{name:"Ai",href:"ai",current:!1},{name:"Users",href:"users",current:!1},{name:"extra",href:"extra",current:!0},{name:"Analytics",href:"analytics",current:!1}],Uce=[{name:"Your Profile",href:"#"},{name:"Settings",href:"#"},{name:"Sign out",href:"#"}];function Vce(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.filter(Boolean).join(" ")}function Hce(){return(0,lo.jsx)(lo.Fragment,{children:(0,lo.jsxs)("div",{className:"min-h-full",children:[(0,lo.jsxs)(yi,{as:"nav",className:"bg-gray-800",children:[(0,lo.jsx)("div",{className:"mx-auto max-w-7xl px-4 sm:px-6 lg:px-8",children:(0,lo.jsxs)("div",{className:"flex h-16 items-center justify-between",children:[(0,lo.jsxs)("div",{className:"flex items-center",children:[(0,lo.jsx)("div",{className:"shrink-0",children:(0,lo.jsx)("img",{alt:"Your Company",src:"https://tailwindui.com/plus/img/logos/mark.svg?color=indigo&shade=500",className:"size-8"})}),(0,lo.jsx)("div",{className:"hidden md:block",children:(0,lo.jsx)("div",{className:"ml-10 flex items-baseline space-x-4",children:jce.map((e=>(0,lo.jsx)("a",{href:e.href,"aria-current":e.current?"page":void 0,className:Vce(e.current?"bg-gray-900 text-white":"text-gray-300 hover:bg-gray-700 hover:text-white","rounded-md px-3 py-2 text-sm font-medium"),children:e.name},e.name)))})})]}),(0,lo.jsx)("div",{className:"hidden md:block",children:(0,lo.jsxs)("div",{className:"ml-4 flex items-center md:ml-6",children:[(0,lo.jsxs)("button",{type:"button",className:"relative rounded-full bg-gray-800 p-1 text-gray-400 hover:text-white focus:outline-none focus:ring-2 focus:ring-white focus:ring-offset-2 focus:ring-offset-gray-800",children:[(0,lo.jsx)("span",{className:"absolute -inset-1.5"}),(0,lo.jsx)("span",{className:"sr-only",children:"View notifications"}),(0,lo.jsx)(to,{"aria-hidden":"true",className:"size-6"})]}),(0,lo.jsxs)(Ja,{as:"div",className:"relative ml-3",children:[(0,lo.jsx)("div",{children:(0,lo.jsxs)(qa,{className:"relative flex max-w-xs items-center rounded-full bg-gray-800 text-sm focus:outline-none focus:ring-2 focus:ring-white focus:ring-offset-2 focus:ring-offset-gray-800",children:[(0,lo.jsx)("span",{className:"absolute -inset-1.5"}),(0,lo.jsx)("span",{className:"sr-only",children:"Open user menu"}),(0,lo.jsx)("img",{alt:"",src:Nce,className:"size-8 rounded-full"})]})}),(0,lo.jsx)(Ya,{transition:!0,className:"absolute right-0 z-10 mt-2 w-48 origin-top-right rounded-md bg-white py-1 shadow-lg ring-1 ring-black/5 transition focus:outline-none data-[closed]:scale-95 data-[closed]:transform data-[closed]:opacity-0 data-[enter]:duration-100 data-[leave]:duration-75 data-[enter]:ease-out data-[leave]:ease-in",children:Uce.map((e=>(0,lo.jsx)(Xa,{children:(0,lo.jsx)("a",{href:e.href,className:"block px-4 py-2 text-sm text-gray-700 data-[focus]:bg-gray-100 data-[focus]:outline-none",children:e.name})},e.name)))})]})]})}),(0,lo.jsx)("div",{className:"-mr-2 flex md:hidden",children:(0,lo.jsxs)(gi,{className:"group relative inline-flex items-center justify-center rounded-md bg-gray-800 p-2 text-gray-400 hover:bg-gray-700 hover:text-white focus:outline-none focus:ring-2 focus:ring-white focus:ring-offset-2 focus:ring-offset-gray-800",children:[(0,lo.jsx)("span",{className:"absolute -inset-0.5"}),(0,lo.jsx)("span",{className:"sr-only",children:"Open main menu"}),(0,lo.jsx)(ro,{"aria-hidden":"true",className:"block size-6 group-data-[open]:hidden"}),(0,lo.jsx)(oo,{"aria-hidden":"true",className:"hidden size-6 group-data-[open]:block"})]})})]})}),(0,lo.jsxs)(vi,{className:"md:hidden",children:[(0,lo.jsx)("div",{className:"space-y-1 px-2 pb-3 pt-2 sm:px-3",children:jce.map((e=>(0,lo.jsx)(gi,{as:"a",href:e.href,"aria-current":e.current?"page":void 0,className:Vce(e.current?"bg-gray-900 text-white":"text-gray-300 hover:bg-gray-700 hover:text-white","block rounded-md px-3 py-2 text-base font-medium"),children:e.name},e.name)))}),(0,lo.jsxs)("div",{className:"border-t border-gray-700 pb-3 pt-4",children:[(0,lo.jsxs)("div",{className:"flex items-center px-5",children:[(0,lo.jsx)("div",{className:"shrink-0",children:(0,lo.jsx)("img",{alt:"",src:Nce,className:"size-10 rounded-full"})}),(0,lo.jsxs)("div",{className:"ml-3",children:[(0,lo.jsx)("div",{className:"text-base/5 font-medium text-white",children:Lce}),(0,lo.jsx)("div",{className:"text-sm font-medium text-gray-400",children:zce})]}),(0,lo.jsxs)("button",{type:"button",className:"relative ml-auto shrink-0 rounded-full bg-gray-800 p-1 text-gray-400 hover:text-white focus:outline-none focus:ring-2 focus:ring-white focus:ring-offset-2 focus:ring-offset-gray-800",children:[(0,lo.jsx)("span",{className:"absolute -inset-1.5"}),(0,lo.jsx)("span",{className:"sr-only",children:"View notifications"}),(0,lo.jsx)(to,{"aria-hidden":"true",className:"size-6"})]})]}),(0,lo.jsx)("div",{className:"mt-3 space-y-1 px-2",children:Uce.map((e=>(0,lo.jsx)(gi,{as:"a",href:e.href,className:"block rounded-md px-3 py-2 text-base font-medium text-gray-400 hover:bg-gray-700 hover:text-white",children:e.name},e.name)))})]})]})]}),(0,lo.jsx)("header",{className:"bg-white shadow",children:(0,lo.jsx)("div",{className:"mx-auto max-w-7xl px-4 py-6 sm:px-6 lg:px-8",children:(0,lo.jsx)("h1",{className:"text-3xl font-bold tracking-tight text-gray-900",children:"Extra"})})}),(0,lo.jsx)("main",{children:(0,lo.jsx)("div",{className:"mx-auto max-w-7xl px-4 py-6 sm:px-6 lg:px-8",children:(0,lo.jsx)(Rce,{})})})]})})}const Wce=e=>{let{imageUrl:t,name:n,price:i,quantityOrdered:s}=e;const[a,o]=(0,r.useState)(!1);return(0,lo.jsx)("div",{className:"max-w-2xl mx-auto bg-white rounded-lg shadow-md overflow-hidden mb-6",children:(0,lo.jsxs)("div",{className:"flex",children:[(0,lo.jsx)("div",{className:"w-1/3",children:(0,lo.jsx)("img",{src:t,alt:n,className:"w-full h-full object-cover"})}),(0,lo.jsxs)("div",{className:"w-2/3 p-6",children:[(0,lo.jsx)("div",{className:"flex justify-between items-start mb-4",children:(0,lo.jsxs)("div",{children:[(0,lo.jsx)("h2",{className:"text-xl font-semibold text-gray-800",children:n}),(0,lo.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:"Delicious and freshly prepared"})]})}),(0,lo.jsxs)("div",{className:"text-2xl font-bold text-gray-900 mb-4",children:["$",i]}),s>0&&(0,lo.jsxs)("div",{className:"text-lg text-gray-600 mb-4",children:[(0,lo.jsx)("span",{className:"font-semibold",children:"Quantity Ordered: "}),s]}),(0,lo.jsx)("div",{className:"flex space-x-3",children:a?(0,lo.jsxs)("div",{className:"space-y-3 w-full",children:[(0,lo.jsx)("button",{className:"w-full bg-green-600 text-white py-2 px-4 rounded-lg hover:bg-green-700 transition duration-200",children:"Canteen Card"}),(0,lo.jsx)("button",{className:"w-full bg-purple-600 text-white py-2 px-4 rounded-lg hover:bg-purple-700 transition duration-200",children:"Other Payment"}),(0,lo.jsx)("button",{onClick:()=>o(!1),className:"w-full bg-gray-200 text-gray-800 py-2 px-4 rounded-lg hover:bg-gray-300 transition duration-200",children:"Cancel"})]}):(0,lo.jsxs)(lo.Fragment,{children:[(0,lo.jsx)("button",{onClick:()=>o(!0),className:"w-1/2 bg-blue-600 text-white py-2 px-4 rounded-lg hover:bg-blue-700 transition duration-200",children:"Order Now"}),(0,lo.jsx)("button",{onClick:()=>o(!1),className:"w-1/2 bg-gray-200 text-gray-800 py-2 px-4 rounded-lg hover:bg-gray-300 transition duration-200",children:"Cancel"})]})})]})]})})},Gce=e=>{let{totalFoodPrice:t}=e;const n=Math.floor(.1*t);return(0,lo.jsx)("div",{className:"max-w-2xl mx-auto bg-blue-100 rounded-lg shadow-md overflow-hidden mb-6",children:(0,lo.jsxs)("div",{className:"p-6",children:[(0,lo.jsx)("h2",{className:"text-2xl font-semibold text-gray-800 mb-4",children:"Canteen Coins"}),(0,lo.jsxs)("p",{className:"text-xl text-gray-700 mb-4",children:["You have earned ",(0,lo.jsx)("span",{className:"font-bold",children:n})," Canteen Coins!"]}),(0,lo.jsxs)("div",{className:"bg-gray-200 p-4 rounded-lg text-center",children:[(0,lo.jsx)("p",{className:"text-lg font-bold",children:"Order any item for 100 Canteen Coins!"}),(0,lo.jsx)("button",{className:"mt-4 w-full bg-green-600 text-white py-2 px-4 rounded-lg hover:bg-green-700 transition duration-200",children:"Order Now"})]})]})})},qce=e=>{let{foodItems:t}=e;const n=t.reduce(((e,t)=>e+t.price),0);return(0,lo.jsx)("div",{className:"max-w-2xl mx-auto bg-yellow-100 rounded-lg shadow-md overflow-hidden mb-6",children:(0,lo.jsxs)("div",{className:"p-6",children:[(0,lo.jsx)("h2",{className:"text-2xl font-semibold text-gray-800 mb-4",children:"Order Summary"}),(0,lo.jsx)("ul",{children:t.map(((e,t)=>(0,lo.jsxs)("li",{className:"flex justify-between text-lg mb-2",children:[(0,lo.jsx)("span",{children:e.name}),(0,lo.jsxs)("span",{children:["$",e.price.toFixed(2)]})]},t)))}),(0,lo.jsx)("div",{className:"mt-4 border-t pt-4",children:(0,lo.jsxs)("div",{className:"flex justify-between text-lg font-semibold",children:[(0,lo.jsx)("span",{children:"Total:"}),(0,lo.jsxs)("span",{children:["$",n.toFixed(2)]})]})})]})})},Yce=()=>{const[e,t]=(0,r.useState)(""),[n,i]=(0,r.useState)(""),[s,a]=(0,r.useState)(""),o=[{imageUrl:"https://images.pexels.com/photos/918581/pexels-photo-918581.jpeg?auto=compress&cs=tinysrgb&w=400",name:"Burger",price:12.99,quantityOrdered:2},{imageUrl:"https://images.pexels.com/photos/845798/pexels-photo-845798.jpeg?auto=compress&cs=tinysrgb&w=400",name:"Pizza",price:15.99,quantityOrdered:1},{imageUrl:"https://images.pexels.com/photos/3214160/pexels-photo-3214160.jpeg?auto=compress&cs=tinysrgb&w=400",name:"Pasta",price:10.49,quantityOrdered:0},{imageUrl:"https://images.pexels.com/photos/257816/pexels-photo-257816.jpeg?auto=compress&cs=tinysrgb&w=400",name:"Salad",price:8.99,quantityOrdered:3},{imageUrl:"https://images.pexels.com/photos/1854665/pexels-photo-1854665.jpeg?auto=compress&cs=tinysrgb&w=400",name:"Sushi",price:18.99,quantityOrdered:0},{imageUrl:"https://images.pexels.com/photos/361184/asparagus-steak-veal-steak-veal-361184.jpeg?auto=compress&cs=tinysrgb&w=400",name:"Steak",price:22.99,quantityOrdered:5},{imageUrl:"https://images.pexels.com/photos/1647163/pexels-photo-1647163.jpeg?auto=compress&cs=tinysrgb&w=400",name:"Sandwich",price:7.99,quantityOrdered:4},{imageUrl:"https://images.pexels.com/photos/7613568/pexels-photo-7613568.jpeg?auto=compress&cs=tinysrgb&w=400",name:"Taco",price:5.99,quantityOrdered:1},{imageUrl:"https://images.pexels.com/photos/1625235/pexels-photo-1625235.jpeg?auto=compress&cs=tinysrgb&w=400",name:"Ice Cream",price:4.49,quantityOrdered:2},{imageUrl:"https://images.pexels.com/photos/1893555/pexels-photo-1893555.jpeg?auto=compress&cs=tinysrgb&w=400",name:"Fries",price:3.99,quantityOrdered:0},{imageUrl:"https://images.pexels.com/photos/4518656/pexels-photo-4518656.jpeg?auto=compress&cs=tinysrgb&w=400",name:"Hot Dog",price:6.49,quantityOrdered:0},{imageUrl:"https://images.pexels.com/photos/3728295/pexels-photo-3728295.jpeg?auto=compress&cs=tinysrgb&w=400",name:"Dumplings",price:8.49,quantityOrdered:1},{imageUrl:"https://images.pexels.com/photos/2347311/pexels-photo-2347311.jpeg?auto=compress&cs=tinysrgb&w=400",name:"Noodles",price:10.99,quantityOrdered:2},{imageUrl:"https://images.pexels.com/photos/775030/pexels-photo-775030.jpeg?auto=compress&cs=tinysrgb&w=400",name:"Smoothie",price:5.49,quantityOrdered:0}],l=o.reduce(((e,t)=>e+t.price),0),u=o.filter((t=>{const i=t.name.toLowerCase().includes(e.toLowerCase());let r=!0;if(n&&s){const e=parseFloat(t.price),i=parseFloat(s);"less"===n&&e>=i&&(r=!1),"greater"===n&&e<=i&&(r=!1),"equal"===n&&e!==i&&(r=!1)}return i&&r}));return(0,lo.jsxs)("div",{className:"p-6 max-w-4xl mx-auto",children:[(0,lo.jsxs)("div",{className:"flex flex-col md:flex-row md:items-center md:space-x-4 mb-6",children:[(0,lo.jsx)("input",{type:"text",placeholder:"Search food...",value:e,onChange:e=>t(e.target.value),className:"p-2 border border-gray-300 rounded-lg w-full md:w-1/3 focus:outline-none focus:ring-2 focus:ring-blue-400"}),(0,lo.jsxs)("select",{value:n,onChange:e=>i(e.target.value),className:"p-2 border border-gray-300 rounded-lg w-full md:w-1/4 focus:outline-none focus:ring-2 focus:ring-blue-400",children:[(0,lo.jsx)("option",{value:"",children:"Filter by price"}),(0,lo.jsx)("option",{value:"less",children:"Less than"}),(0,lo.jsx)("option",{value:"greater",children:"Greater than"}),(0,lo.jsx)("option",{value:"equal",children:"Equal to"})]}),(0,lo.jsx)("input",{type:"number",placeholder:"Enter price",value:s,onChange:e=>a(e.target.value),className:"p-2 border border-gray-300 rounded-lg w-full md:w-1/4 focus:outline-none focus:ring-2 focus:ring-blue-400"})]}),(0,lo.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:u.length>0?u.map(((e,t)=>(0,lo.jsx)(Wce,{imageUrl:e.imageUrl,name:e.name,price:e.price,quantityOrdered:e.quantityOrdered},t))):(0,lo.jsx)("p",{className:"text-gray-600",children:"No matching food items found."})}),(0,lo.jsx)(qce,{foodItems:u}),(0,lo.jsx)(Gce,{totalFoodPrice:l})]})},Xce="Tom Cook",Qce="tom@example.com",Kce="https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=facearea&facepad=2&w=256&h=256&q=80",Zce=[{name:"Dashboard",href:"dashboard",current:!1},{name:"Menu",href:"ai",current:!1},{name:"Orders",href:"users",current:!0},{name:"Analytics",href:"analytics",current:!1}],Jce=[{name:"Your Profile",href:"#"},{name:"Settings",href:"#"},{name:"Sign out",href:"#"}];function $ce(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.filter(Boolean).join(" ")}function ehe(){return(0,lo.jsx)(lo.Fragment,{children:(0,lo.jsxs)("div",{className:"relative min-h-full",children:[(0,lo.jsx)("div",{className:"fixed bottom-0 inset-x-0 z-0",children:(0,lo.jsx)(r5,{})}),(0,lo.jsxs)("div",{className:"relative z-10",children:[(0,lo.jsxs)(yi,{as:"nav",className:"fixed top-0 inset-x-0 z-10 bg-gray-800",children:[(0,lo.jsx)("div",{className:"mx-auto max-w-7xl px-4 sm:px-6 lg:px-8",children:(0,lo.jsxs)("div",{className:"flex h-20 items-center justify-between",children:[(0,lo.jsxs)("div",{className:"flex items-center",children:[(0,lo.jsx)("div",{className:"shrink-0",children:(0,lo.jsx)("img",{alt:"Your Company",src:"https://tailwindui.com/plus/img/logos/mark.svg?color=indigo&shade=500",className:"size-8"})}),(0,lo.jsx)("div",{className:"hidden md:block",children:(0,lo.jsx)("div",{className:"ml-10 flex items-baseline space-x-4",children:Zce.map((e=>(0,lo.jsx)("a",{href:e.href,"aria-current":e.current?"page":void 0,className:$ce(e.current?"bg-gray-900 text-white":"text-gray-300 hover:bg-gray-700 hover:text-white","rounded-md px-3 py-2 text-sm font-medium"),children:e.name},e.name)))})})]}),(0,lo.jsx)("div",{className:"hidden md:block",children:(0,lo.jsxs)("div",{className:"ml-4 flex items-center md:ml-6",children:[(0,lo.jsxs)("button",{type:"button",className:"relative rounded-full bg-gray-800 p-1 text-gray-400 hover:text-white focus:outline-none focus:ring-2 focus:ring-white focus:ring-offset-2 focus:ring-offset-gray-800",children:[(0,lo.jsx)("span",{className:"absolute -inset-1.5"}),(0,lo.jsx)("span",{className:"sr-only",children:"View notifications"}),(0,lo.jsx)(to,{"aria-hidden":"true",className:"size-6"})]}),(0,lo.jsxs)(Ja,{as:"div",className:"relative ml-3",children:[(0,lo.jsx)("div",{children:(0,lo.jsxs)(qa,{className:"relative flex max-w-xs items-center rounded-full bg-gray-800 text-sm focus:outline-none focus:ring-2 focus:ring-white focus:ring-offset-2 focus:ring-offset-gray-800",children:[(0,lo.jsx)("span",{className:"absolute -inset-1.5"}),(0,lo.jsx)("span",{className:"sr-only",children:"Open user menu"}),(0,lo.jsx)("img",{alt:"",src:Kce,className:"size-8 rounded-full"})]})}),(0,lo.jsx)(Ya,{transition:!0,className:"absolute right-0 z-10 mt-2 w-48 origin-top-right rounded-md bg-white py-1 shadow-lg ring-1 ring-black/5 transition focus:outline-none data-[closed]:scale-95 data-[closed]:transform data-[closed]:opacity-0 data-[enter]:duration-100 data-[leave]:duration-75 data-[enter]:ease-out data-[leave]:ease-in",children:Jce.map((e=>(0,lo.jsx)(Xa,{children:(0,lo.jsx)("a",{href:e.href,className:"block px-4 py-2 text-sm text-gray-700 data-[focus]:bg-gray-100 data-[focus]:outline-none",children:e.name})},e.name)))})]})]})}),(0,lo.jsx)("div",{className:"-mr-2 flex md:hidden",children:(0,lo.jsxs)(gi,{className:"group relative inline-flex items-center justify-center rounded-md bg-gray-800 p-2 text-gray-400 hover:bg-gray-700 hover:text-white focus:outline-none focus:ring-2 focus:ring-white focus:ring-offset-2 focus:ring-offset-gray-800",children:[(0,lo.jsx)("span",{className:"absolute -inset-0.5"}),(0,lo.jsx)("span",{className:"sr-only",children:"Open main menu"}),(0,lo.jsx)(ro,{"aria-hidden":"true",className:"block size-6 group-data-[open]:hidden"}),(0,lo.jsx)(oo,{"aria-hidden":"true",className:"hidden size-6 group-data-[open]:block"})]})})]})}),(0,lo.jsxs)(vi,{className:"md:hidden",children:[(0,lo.jsx)("div",{className:"space-y-1 px-2 pb-3 pt-2 sm:px-3",children:Zce.map((e=>(0,lo.jsx)(gi,{as:"a",href:e.href,"aria-current":e.current?"page":void 0,className:$ce(e.current?"bg-gray-900 text-white":"text-gray-300 hover:bg-gray-700 hover:text-white","block rounded-md px-3 py-2 text-base font-medium"),children:e.name},e.name)))}),(0,lo.jsxs)("div",{className:"border-t border-gray-700 pb-3 pt-4",children:[(0,lo.jsxs)("div",{className:"flex items-center px-5",children:[(0,lo.jsx)("div",{className:"shrink-0",children:(0,lo.jsx)("img",{alt:"",src:Kce,className:"size-10 rounded-full"})}),(0,lo.jsxs)("div",{className:"ml-3",children:[(0,lo.jsx)("div",{className:"text-base/5 font-medium text-white",children:Xce}),(0,lo.jsx)("div",{className:"text-sm font-medium text-gray-400",children:Qce})]}),(0,lo.jsxs)("button",{type:"button",className:"relative ml-auto shrink-0 rounded-full bg-gray-800 p-1 text-gray-400 hover:text-white focus:outline-none focus:ring-2 focus:ring-white focus:ring-offset-2 focus:ring-offset-gray-800",children:[(0,lo.jsx)("span",{className:"absolute -inset-1.5"}),(0,lo.jsx)("span",{className:"sr-only",children:"View notifications"}),(0,lo.jsx)(to,{"aria-hidden":"true",className:"size-6"})]})]}),(0,lo.jsx)("div",{className:"mt-3 space-y-1 px-2",children:Jce.map((e=>(0,lo.jsx)(gi,{as:"a",href:e.href,className:"block rounded-md px-3 py-2 text-base font-medium text-gray-400 hover:bg-gray-700 hover:text-white",children:e.name},e.name)))})]})]})]}),(0,lo.jsx)("header",{className:"bg-white shadow mt-16",children:(0,lo.jsx)("div",{className:"mx-auto max-w-7xl px-4 py-6 sm:px-6 lg:px-8",children:(0,lo.jsx)("h1",{className:"text-3xl font-bold tracking-tight text-gray-900",children:"Users"})})}),(0,lo.jsx)("main",{children:(0,lo.jsx)("div",{className:"mx-auto",children:(0,lo.jsx)(Yce,{})})})]})]})})}const the=function(){const[e,t]=(0,r.useState)("student"),[n,i]=(0,r.useState)(!1),s=e=>{t(e),i("admin"===e)};return(0,lo.jsx)("div",{className:"flex flex-col items-center justify-center min-h-screen bg-cover bg-center",style:{backgroundImage:"url('https://media.istockphoto.com/id/1138204965/photo/chef-standing-behind-full-lunch-service-station-with-assortment-of-food-in-trays.jpg?s=612x612&w=0&k=20&c=M-7uLyd2cZQfHMQWXtsolHc-yThA8HVDrryhQfGktrY=')"},children:(0,lo.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-lg w-96 text-center bg-opacity-90",children:[(0,lo.jsx)("h1",{className:"text-2xl font-bold mb-4",children:"Welcome!"}),(0,lo.jsxs)("div",{className:"mb-4",children:[(0,lo.jsx)("h2",{className:"text-lg font-medium",children:"Select User Type:"}),(0,lo.jsxs)("div",{className:"flex justify-center gap-4 mt-2",children:[(0,lo.jsx)("button",{className:"py-2 px-6 border rounded ".concat("student"===e?"bg-blue-500 text-white":"bg-gray-200"),onClick:()=>s("student"),children:"Student"}),(0,lo.jsx)("button",{className:"py-2 px-6 border rounded ".concat("admin"===e?"bg-blue-500 text-white":"bg-gray-200"),onClick:()=>s("admin"),children:"Admin"})]})]}),(0,lo.jsx)("div",{children:n?(0,lo.jsxs)("div",{className:"bg-white p-4 rounded-lg bg-opacity-80",children:[(0,lo.jsx)("h2",{className:"text-lg font-medium mb-2",children:"Signup"}),(0,lo.jsx)("input",{type:"text",placeholder:"Full Name",className:"w-full p-2 mb-2 border rounded"}),(0,lo.jsx)("input",{type:"email",placeholder:"Email",className:"w-full p-2 mb-2 border rounded"}),(0,lo.jsx)("input",{type:"password",placeholder:"Password",className:"w-full p-2 mb-2 border rounded"}),(0,lo.jsx)("button",{className:"w-full bg-blue-600 text-white py-2 rounded",children:"Signup"})]}):(0,lo.jsxs)("div",{children:[(0,lo.jsx)("h2",{className:"text-lg font-medium mb-2",children:"Login"}),(0,lo.jsx)("input",{type:"email",placeholder:"Email",className:"w-full p-2 mb-2 border rounded"}),(0,lo.jsx)("input",{type:"password",placeholder:"Password",className:"w-full p-2 mb-2 border rounded"}),(0,lo.jsx)("button",{onClick:()=>{window.location.href="student"===e?"/student-dashboard":"/admin-dashboard"},className:"w-full bg-blue-600 text-white py-2 rounded",children:"Login"})]})}),(0,lo.jsx)("button",{className:"mt-4 text-blue-500",onClick:()=>i(!n),children:n?"Switch to Login":"Switch to Signup"})]})})};const nhe=function(){return(0,lo.jsxs)("form",{children:[(0,lo.jsxs)("div",{class:"space-y-12",children:[(0,lo.jsxs)("div",{class:"border-b border-gray-900/10 pb-12",children:[(0,lo.jsx)("h2",{class:"text-base/7 font-semibold text-gray-900",children:"Profile"}),(0,lo.jsx)("p",{class:"mt-1 text-sm/6 text-gray-600",children:"This information will be displayed publicly so be careful what you share."}),(0,lo.jsxs)("div",{class:"mt-10 grid grid-cols-1 gap-x-6 gap-y-8 sm:grid-cols-6",children:[(0,lo.jsxs)("div",{class:"sm:col-span-4",children:[(0,lo.jsx)("label",{for:"username",class:"block text-sm/6 font-medium text-gray-900",children:"Username"}),(0,lo.jsx)("div",{class:"mt-2",children:(0,lo.jsxs)("div",{class:"flex items-center rounded-md bg-white pl-3 outline-1 -outline-offset-1 outline-gray-300 focus-within:outline-2 focus-within:-outline-offset-2 focus-within:outline-indigo-600",children:[(0,lo.jsx)("div",{class:"shrink-0 text-base text-gray-500 select-none sm:text-sm/6",children:"workcation.com/"}),(0,lo.jsx)("input",{type:"text",name:"username",id:"username",class:"block min-w-0 grow py-1.5 pr-3 pl-1 text-base text-gray-900 placeholder:text-gray-400 focus:outline-none sm:text-sm/6",placeholder:"janesmith"})]})})]}),(0,lo.jsxs)("div",{class:"col-span-full",children:[(0,lo.jsx)("label",{for:"about",class:"block text-sm/6 font-medium text-gray-900",children:"About"}),(0,lo.jsx)("div",{class:"mt-2",children:(0,lo.jsx)("textarea",{name:"about",id:"about",rows:"3",class:"block w-full rounded-md bg-white px-3 py-1.5 text-base text-gray-900 outline-1 -outline-offset-1 outline-gray-300 placeholder:text-gray-400 focus:outline-2 focus:-outline-offset-2 focus:outline-indigo-600 sm:text-sm/6"})}),(0,lo.jsx)("p",{class:"mt-3 text-sm/6 text-gray-600",children:"Write a few sentences about yourself."})]}),(0,lo.jsxs)("div",{class:"col-span-full",children:[(0,lo.jsx)("label",{for:"photo",class:"block text-sm/6 font-medium text-gray-900",children:"Photo"}),(0,lo.jsxs)("div",{class:"mt-2 flex items-center gap-x-3",children:[(0,lo.jsx)("svg",{class:"size-12 text-gray-300",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",children:(0,lo.jsx)("path",{"fill-rule":"evenodd",d:"M18.685 19.097A9.723 9.723 0 0 0 21.75 12c0-5.385-4.365-9.75-9.75-9.75S2.25 6.615 2.25 12a9.723 9.723 0 0 0 3.065 7.097A9.716 9.716 0 0 0 12 21.75a9.716 9.716 0 0 0 6.685-2.653Zm-12.54-1.285A7.486 7.486 0 0 1 12 15a7.486 7.486 0 0 1 5.855 2.812A8.224 8.224 0 0 1 12 20.25a8.224 8.224 0 0 1-5.855-2.438ZM15.75 9a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0Z","clip-rule":"evenodd"})}),(0,lo.jsx)("button",{type:"button",class:"rounded-md bg-white px-2.5 py-1.5 text-sm font-semibold text-gray-900 ring-1 shadow-xs ring-gray-300 ring-inset hover:bg-gray-50",children:"Change"})]})]}),(0,lo.jsxs)("div",{class:"col-span-full",children:[(0,lo.jsx)("label",{for:"cover-photo",class:"block text-sm/6 font-medium text-gray-900",children:"Cover photo"}),(0,lo.jsx)("div",{class:"mt-2 flex justify-center rounded-lg border border-dashed border-gray-900/25 px-6 py-10",children:(0,lo.jsxs)("div",{class:"text-center",children:[(0,lo.jsx)("svg",{class:"mx-auto size-12 text-gray-300",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",children:(0,lo.jsx)("path",{"fill-rule":"evenodd",d:"M1.5 6a2.25 2.25 0 0 1 2.25-2.25h16.5A2.25 2.25 0 0 1 22.5 6v12a2.25 2.25 0 0 1-2.25 2.25H3.75A2.25 2.25 0 0 1 1.5 18V6ZM3 16.06V18c0 .414.336.75.75.75h16.5A.75.75 0 0 0 21 18v-1.94l-2.69-2.689a1.5 1.5 0 0 0-2.12 0l-.88.879.97.97a.75.75 0 1 1-1.06 1.06l-5.16-5.159a1.5 1.5 0 0 0-2.12 0L3 16.061Zm10.125-7.81a1.125 1.125 0 1 1 2.25 0 1.125 1.125 0 0 1-2.25 0Z","clip-rule":"evenodd"})}),(0,lo.jsxs)("div",{class:"mt-4 flex text-sm/6 text-gray-600",children:[(0,lo.jsxs)("label",{for:"file-upload",class:"relative cursor-pointer rounded-md bg-white font-semibold text-indigo-600 focus-within:ring-2 focus-within:ring-indigo-600 focus-within:ring-offset-2 focus-within:outline-hidden hover:text-indigo-500",children:[(0,lo.jsx)("span",{children:"Upload a file"}),(0,lo.jsx)("input",{id:"file-upload",name:"file-upload",type:"file",class:"sr-only"})]}),(0,lo.jsx)("p",{class:"pl-1",children:"or drag and drop"})]}),(0,lo.jsx)("p",{class:"text-xs/5 text-gray-600",children:"PNG, JPG, GIF up to 10MB"})]})})]})]})]}),(0,lo.jsxs)("div",{class:"border-b border-gray-900/10 pb-12",children:[(0,lo.jsx)("h2",{class:"text-base/7 font-semibold text-gray-900",children:"Personal Information"}),(0,lo.jsx)("p",{class:"mt-1 text-sm/6 text-gray-600",children:"Use a permanent address where you can receive mail."}),(0,lo.jsxs)("div",{class:"mt-10 grid grid-cols-1 gap-x-6 gap-y-8 sm:grid-cols-6",children:[(0,lo.jsxs)("div",{class:"sm:col-span-3",children:[(0,lo.jsx)("label",{for:"first-name",class:"block text-sm/6 font-medium text-gray-900",children:"First name"}),(0,lo.jsx)("div",{class:"mt-2",children:(0,lo.jsx)("input",{type:"text",name:"first-name",id:"first-name",autocomplete:"given-name",class:"block w-full rounded-md bg-white px-3 py-1.5 text-base text-gray-900 outline-1 -outline-offset-1 outline-gray-300 placeholder:text-gray-400 focus:outline-2 focus:-outline-offset-2 focus:outline-indigo-600 sm:text-sm/6"})})]}),(0,lo.jsxs)("div",{class:"sm:col-span-3",children:[(0,lo.jsx)("label",{for:"last-name",class:"block text-sm/6 font-medium text-gray-900",children:"Last name"}),(0,lo.jsx)("div",{class:"mt-2",children:(0,lo.jsx)("input",{type:"text",name:"last-name",id:"last-name",autocomplete:"family-name",class:"block w-full rounded-md bg-white px-3 py-1.5 text-base text-gray-900 outline-1 -outline-offset-1 outline-gray-300 placeholder:text-gray-400 focus:outline-2 focus:-outline-offset-2 focus:outline-indigo-600 sm:text-sm/6"})})]}),(0,lo.jsxs)("div",{class:"sm:col-span-4",children:[(0,lo.jsx)("label",{for:"email",class:"block text-sm/6 font-medium text-gray-900",children:"Email address"}),(0,lo.jsx)("div",{class:"mt-2",children:(0,lo.jsx)("input",{id:"email",name:"email",type:"email",autocomplete:"email",class:"block w-full rounded-md bg-white px-3 py-1.5 text-base text-gray-900 outline-1 -outline-offset-1 outline-gray-300 placeholder:text-gray-400 focus:outline-2 focus:-outline-offset-2 focus:outline-indigo-600 sm:text-sm/6"})})]}),(0,lo.jsxs)("div",{class:"sm:col-span-3",children:[(0,lo.jsx)("label",{for:"country",class:"block text-sm/6 font-medium text-gray-900",children:"Country"}),(0,lo.jsxs)("div",{class:"mt-2 grid grid-cols-1",children:[(0,lo.jsxs)("select",{id:"country",name:"country",autocomplete:"country-name",class:"col-start-1 row-start-1 w-full appearance-none rounded-md bg-white py-1.5 pr-8 pl-3 text-base text-gray-900 outline-1 -outline-offset-1 outline-gray-300 focus:outline-2 focus:-outline-offset-2 focus:outline-indigo-600 sm:text-sm/6",children:[(0,lo.jsx)("option",{children:"United States"}),(0,lo.jsx)("option",{children:"Canada"}),(0,lo.jsx)("option",{children:"Mexico"})]}),(0,lo.jsx)("svg",{class:"pointer-events-none col-start-1 row-start-1 mr-2 size-5 self-center justify-self-end text-gray-500 sm:size-4",viewBox:"0 0 16 16",fill:"currentColor","aria-hidden":"true","data-slot":"icon",children:(0,lo.jsx)("path",{"fill-rule":"evenodd",d:"M4.22 6.22a.75.75 0 0 1 1.06 0L8 8.94l2.72-2.72a.75.75 0 1 1 1.06 1.06l-3.25 3.25a.75.75 0 0 1-1.06 0L4.22 7.28a.75.75 0 0 1 0-1.06Z","clip-rule":"evenodd"})})]})]}),(0,lo.jsxs)("div",{class:"col-span-full",children:[(0,lo.jsx)("label",{for:"street-address",class:"block text-sm/6 font-medium text-gray-900",children:"Street address"}),(0,lo.jsx)("div",{class:"mt-2",children:(0,lo.jsx)("input",{type:"text",name:"street-address",id:"street-address",autocomplete:"street-address",class:"block w-full rounded-md bg-white px-3 py-1.5 text-base text-gray-900 outline-1 -outline-offset-1 outline-gray-300 placeholder:text-gray-400 focus:outline-2 focus:-outline-offset-2 focus:outline-indigo-600 sm:text-sm/6"})})]}),(0,lo.jsxs)("div",{class:"sm:col-span-2 sm:col-start-1",children:[(0,lo.jsx)("label",{for:"city",class:"block text-sm/6 font-medium text-gray-900",children:"City"}),(0,lo.jsx)("div",{class:"mt-2",children:(0,lo.jsx)("input",{type:"text",name:"city",id:"city",autocomplete:"address-level2",class:"block w-full rounded-md bg-white px-3 py-1.5 text-base text-gray-900 outline-1 -outline-offset-1 outline-gray-300 placeholder:text-gray-400 focus:outline-2 focus:-outline-offset-2 focus:outline-indigo-600 sm:text-sm/6"})})]}),(0,lo.jsxs)("div",{class:"sm:col-span-2",children:[(0,lo.jsx)("label",{for:"region",class:"block text-sm/6 font-medium text-gray-900",children:"State / Province"}),(0,lo.jsx)("div",{class:"mt-2",children:(0,lo.jsx)("input",{type:"text",name:"region",id:"region",autocomplete:"address-level1",class:"block w-full rounded-md bg-white px-3 py-1.5 text-base text-gray-900 outline-1 -outline-offset-1 outline-gray-300 placeholder:text-gray-400 focus:outline-2 focus:-outline-offset-2 focus:outline-indigo-600 sm:text-sm/6"})})]}),(0,lo.jsxs)("div",{class:"sm:col-span-2",children:[(0,lo.jsx)("label",{for:"postal-code",class:"block text-sm/6 font-medium text-gray-900",children:"ZIP / Postal code"}),(0,lo.jsx)("div",{class:"mt-2",children:(0,lo.jsx)("input",{type:"text",name:"postal-code",id:"postal-code",autocomplete:"postal-code",class:"block w-full rounded-md bg-white px-3 py-1.5 text-base text-gray-900 outline-1 -outline-offset-1 outline-gray-300 placeholder:text-gray-400 focus:outline-2 focus:-outline-offset-2 focus:outline-indigo-600 sm:text-sm/6"})})]})]})]}),(0,lo.jsxs)("div",{class:"border-b border-gray-900/10 pb-12",children:[(0,lo.jsx)("h2",{class:"text-base/7 font-semibold text-gray-900",children:"Notifications"}),(0,lo.jsx)("p",{class:"mt-1 text-sm/6 text-gray-600",children:"We'll always let you know about important changes, but you pick what else you want to hear about."}),(0,lo.jsxs)("div",{class:"mt-10 space-y-10",children:[(0,lo.jsxs)("fieldset",{children:[(0,lo.jsx)("legend",{class:"text-sm/6 font-semibold text-gray-900",children:"By email"}),(0,lo.jsxs)("div",{class:"mt-6 space-y-6",children:[(0,lo.jsxs)("div",{class:"flex gap-3",children:[(0,lo.jsx)("div",{class:"flex h-6 shrink-0 items-center",children:(0,lo.jsxs)("div",{class:"group grid size-4 grid-cols-1",children:[(0,lo.jsx)("input",{id:"comments","aria-describedby":"comments-description",name:"comments",type:"checkbox",checked:!0,class:"col-start-1 row-start-1 appearance-none rounded-sm border border-gray-300 bg-white checked:border-indigo-600 checked:bg-indigo-600 indeterminate:border-indigo-600 indeterminate:bg-indigo-600 focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600 disabled:border-gray-300 disabled:bg-gray-100 disabled:checked:bg-gray-100 forced-colors:appearance-auto"}),(0,lo.jsxs)("svg",{class:"pointer-events-none col-start-1 row-start-1 size-3.5 self-center justify-self-center stroke-white group-has-disabled:stroke-gray-950/25",viewBox:"0 0 14 14",fill:"none",children:[(0,lo.jsx)("path",{class:"opacity-0 group-has-checked:opacity-100",d:"M3 8L6 11L11 3.5","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"}),(0,lo.jsx)("path",{class:"opacity-0 group-has-indeterminate:opacity-100",d:"M3 7H11","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})]})]})}),(0,lo.jsxs)("div",{class:"text-sm/6",children:[(0,lo.jsx)("label",{for:"comments",class:"font-medium text-gray-900",children:"Comments"}),(0,lo.jsx)("p",{id:"comments-description",class:"text-gray-500",children:"Get notified when someones posts a comment on a posting."})]})]}),(0,lo.jsxs)("div",{class:"flex gap-3",children:[(0,lo.jsx)("div",{class:"flex h-6 shrink-0 items-center",children:(0,lo.jsxs)("div",{class:"group grid size-4 grid-cols-1",children:[(0,lo.jsx)("input",{id:"candidates","aria-describedby":"candidates-description",name:"candidates",type:"checkbox",class:"col-start-1 row-start-1 appearance-none rounded-sm border border-gray-300 bg-white checked:border-indigo-600 checked:bg-indigo-600 indeterminate:border-indigo-600 indeterminate:bg-indigo-600 focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600 disabled:border-gray-300 disabled:bg-gray-100 disabled:checked:bg-gray-100 forced-colors:appearance-auto"}),(0,lo.jsxs)("svg",{class:"pointer-events-none col-start-1 row-start-1 size-3.5 self-center justify-self-center stroke-white group-has-disabled:stroke-gray-950/25",viewBox:"0 0 14 14",fill:"none",children:[(0,lo.jsx)("path",{class:"opacity-0 group-has-checked:opacity-100",d:"M3 8L6 11L11 3.5","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"}),(0,lo.jsx)("path",{class:"opacity-0 group-has-indeterminate:opacity-100",d:"M3 7H11","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})]})]})}),(0,lo.jsxs)("div",{class:"text-sm/6",children:[(0,lo.jsx)("label",{for:"candidates",class:"font-medium text-gray-900",children:"Candidates"}),(0,lo.jsx)("p",{id:"candidates-description",class:"text-gray-500",children:"Get notified when a candidate applies for a job."})]})]}),(0,lo.jsxs)("div",{class:"flex gap-3",children:[(0,lo.jsx)("div",{class:"flex h-6 shrink-0 items-center",children:(0,lo.jsxs)("div",{class:"group grid size-4 grid-cols-1",children:[(0,lo.jsx)("input",{id:"offers","aria-describedby":"offers-description",name:"offers",type:"checkbox",class:"col-start-1 row-start-1 appearance-none rounded-sm border border-gray-300 bg-white checked:border-indigo-600 checked:bg-indigo-600 indeterminate:border-indigo-600 indeterminate:bg-indigo-600 focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600 disabled:border-gray-300 disabled:bg-gray-100 disabled:checked:bg-gray-100 forced-colors:appearance-auto"}),(0,lo.jsxs)("svg",{class:"pointer-events-none col-start-1 row-start-1 size-3.5 self-center justify-self-center stroke-white group-has-disabled:stroke-gray-950/25",viewBox:"0 0 14 14",fill:"none",children:[(0,lo.jsx)("path",{class:"opacity-0 group-has-checked:opacity-100",d:"M3 8L6 11L11 3.5","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"}),(0,lo.jsx)("path",{class:"opacity-0 group-has-indeterminate:opacity-100",d:"M3 7H11","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})]})]})}),(0,lo.jsxs)("div",{class:"text-sm/6",children:[(0,lo.jsx)("label",{for:"offers",class:"font-medium text-gray-900",children:"Offers"}),(0,lo.jsx)("p",{id:"offers-description",class:"text-gray-500",children:"Get notified when a candidate accepts or rejects an offer."})]})]})]})]}),(0,lo.jsxs)("fieldset",{children:[(0,lo.jsx)("legend",{class:"text-sm/6 font-semibold text-gray-900",children:"Push notifications"}),(0,lo.jsx)("p",{class:"mt-1 text-sm/6 text-gray-600",children:"These are delivered via SMS to your mobile phone."}),(0,lo.jsxs)("div",{class:"mt-6 space-y-6",children:[(0,lo.jsxs)("div",{class:"flex items-center gap-x-3",children:[(0,lo.jsx)("input",{id:"push-everything",name:"push-notifications",type:"radio",checked:!0,class:"relative size-4 appearance-none rounded-full border border-gray-300 bg-white before:absolute before:inset-1 before:rounded-full before:bg-white not-checked:before:hidden checked:border-indigo-600 checked:bg-indigo-600 focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600 disabled:border-gray-300 disabled:bg-gray-100 disabled:before:bg-gray-400 forced-colors:appearance-auto forced-colors:before:hidden"}),(0,lo.jsx)("label",{for:"push-everything",class:"block text-sm/6 font-medium text-gray-900",children:"Everything"})]}),(0,lo.jsxs)("div",{class:"flex items-center gap-x-3",children:[(0,lo.jsx)("input",{id:"push-email",name:"push-notifications",type:"radio",class:"relative size-4 appearance-none rounded-full border border-gray-300 bg-white before:absolute before:inset-1 before:rounded-full before:bg-white not-checked:before:hidden checked:border-indigo-600 checked:bg-indigo-600 focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600 disabled:border-gray-300 disabled:bg-gray-100 disabled:before:bg-gray-400 forced-colors:appearance-auto forced-colors:before:hidden"}),(0,lo.jsx)("label",{for:"push-email",class:"block text-sm/6 font-medium text-gray-900",children:"Same as email"})]}),(0,lo.jsxs)("div",{class:"flex items-center gap-x-3",children:[(0,lo.jsx)("input",{id:"push-nothing",name:"push-notifications",type:"radio",class:"relative size-4 appearance-none rounded-full border border-gray-300 bg-white before:absolute before:inset-1 before:rounded-full before:bg-white not-checked:before:hidden checked:border-indigo-600 checked:bg-indigo-600 focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600 disabled:border-gray-300 disabled:bg-gray-100 disabled:before:bg-gray-400 forced-colors:appearance-auto forced-colors:before:hidden"}),(0,lo.jsx)("label",{for:"push-nothing",class:"block text-sm/6 font-medium text-gray-900",children:"No push notifications"})]})]})]})]})]})]}),(0,lo.jsxs)("div",{class:"mt-6 flex items-center justify-end gap-x-6",children:[(0,lo.jsx)("button",{type:"button",class:"text-sm/6 font-semibold text-gray-900",children:"Cancel"}),(0,lo.jsx)("button",{type:"submit",class:"rounded-md bg-indigo-600 px-3 py-2 text-sm font-semibold text-white shadow-xs hover:bg-indigo-500 focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600",children:"Save"})]})]})},ihe=e=>{let{title:t,price:n,quantity:i}=e;const r=n*i;return(0,lo.jsxs)("div",{className:"flex max-w-xl bg-white rounded-lg shadow-md overflow-hidden mb-5 mr-10 w-full",children:[(0,lo.jsx)("img",{src:"https://imgs.search.brave.com/u6wg9xVm_CSGdedqnwX-z6xBJ3vDgdyXU7d4_hzoTgg/rs:fit:860:0:0:0/g:ce/aHR0cHM6Ly9tZWRp/YS5pc3RvY2twaG90/by5jb20vaWQvNDk2/Mzg5MTc0L3Bob3Rv/L2RlbGljaW91cy1o/YW1idXJnZXJzLmpw/Zz9zPTYxMng2MTIm/dz0wJms9MjAmYz12/blJxTEdmVWhUSWRj/dUJIOWtyNjBuUFhw/ZDRsVFplU09lWmtB/c0dfRzV3PQ",alt:"Food Item",className:"w-48 h-48 object-cover"}),(0,lo.jsxs)("div",{className:"flex-1 p-5 flex flex-col justify-center items-center",children:[(0,lo.jsx)("h2",{className:"text-xl text-gray-800 mb-1 text-center",children:t}),(0,lo.jsxs)("div",{className:"text-2xl font-bold text-gray-800 my-2 text-center",children:["$",n.toFixed(2)]}),(0,lo.jsxs)("div",{className:"text-sm text-gray-600 mb-3 text-center",children:["Quantity: ",i]})]}),(0,lo.jsxs)("div",{className:"text-xl font-bold text-gray-800 ml-5 text-center border-l-2 border-gray-200 p-5 w-32",children:[(0,lo.jsx)("div",{className:"font-bold mb-1 text-center",children:"Total"}),"$",r.toFixed(2)]})]})},rhe=()=>{const[e,t]=(0,r.useState)(0),n=[{title:"Blueberry Pancakes",price:12.99,quantity:5},{title:"Blueberry Pancakes",price:12.99,quantity:3}];return(0,r.useEffect)((()=>{let e=0;n.forEach((t=>{e+=t.price*t.quantity})),t(e)}),[]),(0,lo.jsxs)("div",{className:"flex justify-center items-start min-h-screen bg-gray-100 p-5 relative",children:[(0,lo.jsxs)("div",{className:"max-w-3xl w-full flex flex-col items-start relative",children:[(0,lo.jsx)("h1",{className:"text-left text-3xl text-gray-800 mb-5",children:"Today's Sales"}),n.map(((e,t)=>(0,lo.jsx)(ihe,{title:e.title,price:e.price,quantity:e.quantity},t))),(0,lo.jsxs)("div",{className:"text-center mt-10 text-3xl font-bold text-gray-600 p-5 bg-white rounded-lg shadow-md relative z-2",children:["TOTAL SALES: $",(0,lo.jsx)("span",{className:"font-bold",children:e.toFixed(2)})]})]}),(0,lo.jsx)("div",{className:"flex justify-center items-center flex-col ml-10"})]})},she="Tom Cook",ahe="tom@example.com",ohe="https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=facearea&facepad=2&w=256&h=256&q=80",lhe=[{name:"Dashboard",href:"admin-dashboard",current:!0},{name:"Analytics",href:"admin-analytics",current:!1},{name:"Chat with AI",href:"admin-ai",current:!1}],uhe=[{name:"Your Profile",href:"#"},{name:"Settings",href:"#"},{name:"Sign out",href:"#"}];function che(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.filter(Boolean).join(" ")}function hhe(){return(0,lo.jsx)(lo.Fragment,{children:(0,lo.jsxs)("div",{className:"min-h-full",children:[(0,lo.jsxs)(yi,{as:"nav",className:"bg-gray-800",children:[(0,lo.jsx)("div",{className:"mx-auto max-w-7xl px-4 sm:px-6 lg:px-8",children:(0,lo.jsxs)("div",{className:"flex h-16 items-center justify-between",children:[(0,lo.jsxs)("div",{className:"flex items-center",children:[(0,lo.jsx)("div",{className:"shrink-0",children:(0,lo.jsx)("img",{alt:"Your Company",src:"https://tailwindui.com/plus/img/logos/mark.svg?color=indigo&shade=500",className:"size-8",url:"http://localhost:3000/profile"})}),(0,lo.jsx)("div",{className:"hidden md:block",children:(0,lo.jsx)("div",{className:"ml-10 flex items-baseline space-x-4",children:lhe.map((e=>(0,lo.jsx)("a",{href:e.href,"aria-current":e.current?"page":void 0,className:che(e.current?"bg-gray-900 text-white":"text-gray-300 hover:bg-gray-700 hover:text-white","rounded-md px-3 py-2 text-sm font-medium"),children:e.name},e.name)))})})]}),(0,lo.jsx)("div",{className:"hidden md:block",children:(0,lo.jsxs)("div",{className:"ml-4 flex items-center md:ml-6",children:[(0,lo.jsxs)("button",{type:"button",className:"relative rounded-full bg-gray-800 p-1 text-gray-400 hover:text-white focus:outline-none focus:ring-2 focus:ring-white focus:ring-offset-2 focus:ring-offset-gray-800",children:[(0,lo.jsx)("span",{className:"absolute -inset-1.5"}),(0,lo.jsx)("span",{className:"sr-only",children:"View notifications"}),(0,lo.jsx)(to,{"aria-hidden":"true",className:"size-6"})]}),(0,lo.jsxs)(Ja,{as:"div",className:"relative ml-3",children:[(0,lo.jsx)("div",{children:(0,lo.jsxs)(qa,{className:"relative flex max-w-xs items-center rounded-full bg-gray-800 text-sm focus:outline-none focus:ring-2 focus:ring-white focus:ring-offset-2 focus:ring-offset-gray-800",children:[(0,lo.jsx)("span",{className:"absolute -inset-1.5"}),(0,lo.jsx)("span",{className:"sr-only",children:"Open user menu"}),(0,lo.jsx)("img",{alt:"",src:ohe,className:"size-8 rounded-full"})]})}),(0,lo.jsx)(Ya,{transition:!0,className:"absolute right-0 z-10 mt-2 w-48 origin-top-right rounded-md bg-white py-1 shadow-lg ring-1 ring-black/5 transition focus:outline-none data-[closed]:scale-95 data-[closed]:transform data-[closed]:opacity-0 data-[enter]:duration-100 data-[leave]:duration-75 data-[enter]:ease-out data-[leave]:ease-in",children:uhe.map((e=>(0,lo.jsx)(Xa,{children:(0,lo.jsx)("a",{href:e.href,className:"block px-4 py-2 text-sm text-gray-700 data-[focus]:bg-gray-100 data-[focus]:outline-none",children:e.name})},e.name)))})]})]})}),(0,lo.jsx)("div",{className:"-mr-2 flex md:hidden",children:(0,lo.jsxs)(gi,{className:"group relative inline-flex items-center justify-center rounded-md bg-gray-800 p-2 text-gray-400 hover:bg-gray-700 hover:text-white focus:outline-none focus:ring-2 focus:ring-white focus:ring-offset-2 focus:ring-offset-gray-800",children:[(0,lo.jsx)("span",{className:"absolute -inset-0.5"}),(0,lo.jsx)("span",{className:"sr-only",children:"Open main menu"}),(0,lo.jsx)(ro,{"aria-hidden":"true",className:"block size-6 group-data-[open]:hidden"}),(0,lo.jsx)(oo,{"aria-hidden":"true",className:"hidden size-6 group-data-[open]:block"})]})})]})}),(0,lo.jsxs)(vi,{className:"md:hidden",children:[(0,lo.jsx)("div",{className:"space-y-1 px-2 pb-3 pt-2 sm:px-3",children:lhe.map((e=>(0,lo.jsx)(gi,{as:"a",href:e.href,"aria-current":e.current?"page":void 0,className:che(e.current?"bg-gray-900 text-white":"text-gray-300 hover:bg-gray-700 hover:text-white","block rounded-md px-3 py-2 text-base font-medium"),children:e.name},e.name)))}),(0,lo.jsxs)("div",{className:"border-t border-gray-700 pb-3 pt-4",children:[(0,lo.jsxs)("div",{className:"flex items-center px-5",children:[(0,lo.jsx)("div",{className:"shrink-0",children:(0,lo.jsx)("img",{alt:"",src:ohe,className:"size-10 rounded-full"})}),(0,lo.jsxs)("div",{className:"ml-3",children:[(0,lo.jsx)("div",{className:"text-base/5 font-medium text-white",children:she}),(0,lo.jsx)("div",{className:"text-sm font-medium text-gray-400",children:ahe})]}),(0,lo.jsxs)("button",{type:"button",className:"relative ml-auto shrink-0 rounded-full bg-gray-800 p-1 text-gray-400 hover:text-white focus:outline-none focus:ring-2 focus:ring-white focus:ring-offset-2 focus:ring-offset-gray-800",children:[(0,lo.jsx)("span",{className:"absolute -inset-1.5"}),(0,lo.jsx)("span",{className:"sr-only",children:"View notifications"}),(0,lo.jsx)(to,{"aria-hidden":"true",className:"size-6"})]})]}),(0,lo.jsx)("div",{className:"mt-3 space-y-1 px-2",children:uhe.map((e=>(0,lo.jsx)(gi,{as:"a",href:e.href,className:"block rounded-md px-3 py-2 text-base font-medium text-gray-400 hover:bg-gray-700 hover:text-white",children:e.name},e.name)))})]})]})]}),(0,lo.jsx)("header",{className:"bg-white shadow",children:(0,lo.jsx)("div",{className:"mx-auto max-w-7xl px-4 py-6 sm:px-6 lg:px-8",children:(0,lo.jsx)("h1",{className:"text-3xl font-bold tracking-tight text-gray-900",children:"Dashboard"})})}),(0,lo.jsx)("main",{children:(0,lo.jsx)("div",{className:"mx-auto ",children:(0,lo.jsx)(rhe,{})})})]})})}const dhe="Tom Cook",phe="tom@example.com",fhe="https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=facearea&facepad=2&w=256&h=256&q=80",mhe=[{name:"Dashboard",href:"admin-dashboard",current:!1},{name:"Analytics",href:"admin-analytics",current:!0},{name:"Chat with AI",href:"admin-ai",current:!1}],ghe=[{name:"Your Profile",href:"#"},{name:"Settings",href:"#"},{name:"Sign out",href:"#"}];function vhe(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.filter(Boolean).join(" ")}Lre.maintainAspectRatio=!1,Lre.responsive=!0,Lre.plugins.title.display=!0,Lre.plugins.title.align="start",Lre.plugins.title.font.size=20,Lre.plugins.title.color="black";const yhe=()=>(0,lo.jsx)(lo.Fragment,{children:(0,lo.jsxs)("div",{className:"min-h-full",children:[(0,lo.jsxs)(yi,{as:"nav",className:"bg-gray-800",children:[(0,lo.jsx)("div",{className:"mx-auto max-w-7xl px-4 sm:px-6 lg:px-8",children:(0,lo.jsxs)("div",{className:"flex h-16 items-center justify-between",children:[(0,lo.jsxs)("div",{className:"flex items-center",children:[(0,lo.jsx)("div",{className:"shrink-0",children:(0,lo.jsx)("img",{alt:"Your Company",src:"https://tailwindui.com/plus/img/logos/mark.svg?color=indigo&shade=500",className:"size-8",url:"http://localhost:3000/profile"})}),(0,lo.jsx)("div",{className:"hidden md:block",children:(0,lo.jsx)("div",{className:"ml-10 flex items-baseline space-x-4",children:mhe.map((e=>(0,lo.jsx)("a",{href:e.href,"aria-current":e.current?"page":void 0,className:vhe(e.current?"bg-gray-900 text-white":"text-gray-300 hover:bg-gray-700 hover:text-white","rounded-md px-3 py-2 text-sm font-medium"),children:e.name},e.name)))})})]}),(0,lo.jsx)("div",{className:"hidden md:block",children:(0,lo.jsxs)("div",{className:"ml-4 flex items-center md:ml-6",children:[(0,lo.jsxs)("button",{type:"button",className:"relative rounded-full bg-gray-800 p-1 text-gray-400 hover:text-white focus:outline-none focus:ring-2 focus:ring-white focus:ring-offset-2 focus:ring-offset-gray-800",children:[(0,lo.jsx)("span",{className:"absolute -inset-1.5"}),(0,lo.jsx)("span",{className:"sr-only",children:"View notifications"}),(0,lo.jsx)(to,{"aria-hidden":"true",className:"size-6"})]}),(0,lo.jsxs)(Ja,{as:"div",className:"relative ml-3",children:[(0,lo.jsx)("div",{children:(0,lo.jsxs)(qa,{className:"relative flex max-w-xs items-center rounded-full bg-gray-800 text-sm focus:outline-none focus:ring-2 focus:ring-white focus:ring-offset-2 focus:ring-offset-gray-800",children:[(0,lo.jsx)("span",{className:"absolute -inset-1.5"}),(0,lo.jsx)("span",{className:"sr-only",children:"Open user menu"}),(0,lo.jsx)("img",{alt:"",src:fhe,className:"size-8 rounded-full"})]})}),(0,lo.jsx)(Ya,{transition:!0,className:"absolute right-0 z-10 mt-2 w-48 origin-top-right rounded-md bg-white py-1 shadow-lg ring-1 ring-black/5 transition focus:outline-none data-[closed]:scale-95 data-[closed]:transform data-[closed]:opacity-0 data-[enter]:duration-100 data-[leave]:duration-75 data-[enter]:ease-out data-[leave]:ease-in",children:ghe.map((e=>(0,lo.jsx)(Xa,{children:(0,lo.jsx)("a",{href:e.href,className:"block px-4 py-2 text-sm text-gray-700 data-[focus]:bg-gray-100 data-[focus]:outline-none",children:e.name})},e.name)))})]})]})}),(0,lo.jsx)("div",{className:"-mr-2 flex md:hidden",children:(0,lo.jsxs)(gi,{className:"group relative inline-flex items-center justify-center rounded-md bg-gray-800 p-2 text-gray-400 hover:bg-gray-700 hover:text-white focus:outline-none focus:ring-2 focus:ring-white focus:ring-offset-2 focus:ring-offset-gray-800",children:[(0,lo.jsx)("span",{className:"absolute -inset-0.5"}),(0,lo.jsx)("span",{className:"sr-only",children:"Open main menu"}),(0,lo.jsx)(ro,{"aria-hidden":"true",className:"block size-6 group-data-[open]:hidden"}),(0,lo.jsx)(oo,{"aria-hidden":"true",className:"hidden size-6 group-data-[open]:block"})]})})]})}),(0,lo.jsxs)(vi,{className:"md:hidden",children:[(0,lo.jsx)("div",{className:"space-y-1 px-2 pb-3 pt-2 sm:px-3",children:mhe.map((e=>(0,lo.jsx)(gi,{as:"a",href:e.href,"aria-current":e.current?"page":void 0,className:vhe(e.current?"bg-gray-900 text-white":"text-gray-300 hover:bg-gray-700 hover:text-white","block rounded-md px-3 py-2 text-base font-medium"),children:e.name},e.name)))}),(0,lo.jsxs)("div",{className:"border-t border-gray-700 pb-3 pt-4",children:[(0,lo.jsxs)("div",{className:"flex items-center px-5",children:[(0,lo.jsx)("div",{className:"shrink-0",children:(0,lo.jsx)("img",{alt:"",src:fhe,className:"size-10 rounded-full"})}),(0,lo.jsxs)("div",{className:"ml-3",children:[(0,lo.jsx)("div",{className:"text-base/5 font-medium text-white",children:dhe}),(0,lo.jsx)("div",{className:"text-sm font-medium text-gray-400",children:phe})]}),(0,lo.jsxs)("button",{type:"button",className:"relative ml-auto shrink-0 rounded-full bg-gray-800 p-1 text-gray-400 hover:text-white focus:outline-none focus:ring-2 focus:ring-white focus:ring-offset-2 focus:ring-offset-gray-800",children:[(0,lo.jsx)("span",{className:"absolute -inset-1.5"}),(0,lo.jsx)("span",{className:"sr-only",children:"View notifications"}),(0,lo.jsx)(to,{"aria-hidden":"true",className:"size-6"})]})]}),(0,lo.jsx)("div",{className:"mt-3 space-y-1 px-2",children:ghe.map((e=>(0,lo.jsx)(gi,{as:"a",href:e.href,className:"block rounded-md px-3 py-2 text-base font-medium text-gray-400 hover:bg-gray-700 hover:text-white",children:e.name},e.name)))})]})]})]}),(0,lo.jsx)("header",{className:"bg-white shadow",children:(0,lo.jsx)("div",{className:"mx-auto max-w-7xl px-4 py-6 sm:px-6 lg:px-8",children:(0,lo.jsx)("h1",{className:"text-3xl font-bold tracking-tight text-gray-900",children:"Dashboard"})})}),(0,lo.jsx)("main",{children:(0,lo.jsx)("div",{className:"mx-auto ",children:(0,lo.jsxs)("div",{className:"App",children:[(0,lo.jsx)("div",{className:"dataCard revenueCard",children:(0,lo.jsx)(Dce,{data:{labels:Ece.map((e=>e.label)),datasets:[{label:"Revenue",data:Ece.map((e=>e.revenue)),backgroundColor:"#064FF0",borderColor:"#064FF0"},{label:"Cost",data:Ece.map((e=>e.cost)),backgroundColor:"#FF3030",borderColor:"#FF3030"}]},options:{elements:{line:{tension:.5}},plugins:{title:{text:"Monthly Revenue & Cost"}}}})}),(0,lo.jsx)("div",{className:"dataCard customerCard",children:(0,lo.jsx)(_ce,{data:{labels:Cce.map((e=>e.label)),datasets:[{label:"Count",data:Cce.map((e=>e.value)),backgroundColor:["rgba(43, 63, 229, 0.8)","rgba(250, 192, 19, 0.8)","rgba(253, 135, 135, 0.8)"],borderRadius:5}]},options:{plugins:{title:{text:"Revenue Source"}}}})}),(0,lo.jsx)("div",{className:"dataCard categoryCard",children:(0,lo.jsx)(Sce,{data:{labels:Cce.map((e=>e.label)),datasets:[{label:"Count",data:Cce.map((e=>e.value)),backgroundColor:["rgba(43, 63, 229, 0.8)","rgba(250, 192, 19, 0.8)","rgba(253, 135, 135, 0.8)"],borderColor:["rgba(43, 63, 229, 0.8)","rgba(250, 192, 19, 0.8)","rgba(253, 135, 135, 0.8)"]}]},options:{plugins:{title:{text:"Revenue Source Breakdown"}}}})})]})})})]})}),xhe="Tom Cook",bhe="tom@example.com",whe="https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=facearea&facepad=2&w=256&h=256&q=80",Dhe=[{name:"Dashboard",href:"admin-dashboard",current:!1},{name:"Analytics",href:"admin-analytics",current:!1},{name:"Chat with AI",href:"admin-ai",current:!0}],_he=[{name:"Your Profile",href:"#"},{name:"Settings",href:"#"},{name:"Sign out",href:"#"}];function She(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.filter(Boolean).join(" ")}Lre.maintainAspectRatio=!1,Lre.responsive=!0,Lre.plugins.title.display=!0,Lre.plugins.title.align="start",Lre.plugins.title.font.size=20,Lre.plugins.title.color="black";const Ehe=()=>(0,lo.jsx)(lo.Fragment,{children:(0,lo.jsxs)("div",{className:"min-h-full",children:[(0,lo.jsxs)(yi,{as:"nav",className:"bg-gray-800",children:[(0,lo.jsx)("div",{className:"mx-auto max-w-7xl px-4 sm:px-6 lg:px-8",children:(0,lo.jsxs)("div",{className:"flex h-16 items-center justify-between",children:[(0,lo.jsxs)("div",{className:"flex items-center",children:[(0,lo.jsx)("div",{className:"shrink-0",children:(0,lo.jsx)("img",{alt:"Your Company",src:"https://tailwindui.com/plus/img/logos/mark.svg?color=indigo&shade=500",className:"size-8",url:"http://localhost:3000/profile"})}),(0,lo.jsx)("div",{className:"hidden md:block",children:(0,lo.jsx)("div",{className:"ml-10 flex items-baseline space-x-4",children:Dhe.map((e=>(0,lo.jsx)("a",{href:e.href,"aria-current":e.current?"page":void 0,className:She(e.current?"bg-gray-900 text-white":"text-gray-300 hover:bg-gray-700 hover:text-white","rounded-md px-3 py-2 text-sm font-medium"),children:e.name},e.name)))})})]}),(0,lo.jsx)("div",{className:"hidden md:block",children:(0,lo.jsxs)("div",{className:"ml-4 flex items-center md:ml-6",children:[(0,lo.jsxs)("button",{type:"button",className:"relative rounded-full bg-gray-800 p-1 text-gray-400 hover:text-white focus:outline-none focus:ring-2 focus:ring-white focus:ring-offset-2 focus:ring-offset-gray-800",children:[(0,lo.jsx)("span",{className:"absolute -inset-1.5"}),(0,lo.jsx)("span",{className:"sr-only",children:"View notifications"}),(0,lo.jsx)(to,{"aria-hidden":"true",className:"size-6"})]}),(0,lo.jsxs)(Ja,{as:"div",className:"relative ml-3",children:[(0,lo.jsx)("div",{children:(0,lo.jsxs)(qa,{className:"relative flex max-w-xs items-center rounded-full bg-gray-800 text-sm focus:outline-none focus:ring-2 focus:ring-white focus:ring-offset-2 focus:ring-offset-gray-800",children:[(0,lo.jsx)("span",{className:"absolute -inset-1.5"}),(0,lo.jsx)("span",{className:"sr-only",children:"Open user menu"}),(0,lo.jsx)("img",{alt:"",src:whe,className:"size-8 rounded-full"})]})}),(0,lo.jsx)(Ya,{transition:!0,className:"absolute right-0 z-10 mt-2 w-48 origin-top-right rounded-md bg-white py-1 shadow-lg ring-1 ring-black/5 transition focus:outline-none data-[closed]:scale-95 data-[closed]:transform data-[closed]:opacity-0 data-[enter]:duration-100 data-[leave]:duration-75 data-[enter]:ease-out data-[leave]:ease-in",children:_he.map((e=>(0,lo.jsx)(Xa,{children:(0,lo.jsx)("a",{href:e.href,className:"block px-4 py-2 text-sm text-gray-700 data-[focus]:bg-gray-100 data-[focus]:outline-none",children:e.name})},e.name)))})]})]})}),(0,lo.jsx)("div",{className:"-mr-2 flex md:hidden",children:(0,lo.jsxs)(gi,{className:"group relative inline-flex items-center justify-center rounded-md bg-gray-800 p-2 text-gray-400 hover:bg-gray-700 hover:text-white focus:outline-none focus:ring-2 focus:ring-white focus:ring-offset-2 focus:ring-offset-gray-800",children:[(0,lo.jsx)("span",{className:"absolute -inset-0.5"}),(0,lo.jsx)("span",{className:"sr-only",children:"Open main menu"}),(0,lo.jsx)(ro,{"aria-hidden":"true",className:"block size-6 group-data-[open]:hidden"}),(0,lo.jsx)(oo,{"aria-hidden":"true",className:"hidden size-6 group-data-[open]:block"})]})})]})}),(0,lo.jsxs)(vi,{className:"md:hidden",children:[(0,lo.jsx)("div",{className:"space-y-1 px-2 pb-3 pt-2 sm:px-3",children:Dhe.map((e=>(0,lo.jsx)(gi,{as:"a",href:e.href,"aria-current":e.current?"page":void 0,className:She(e.current?"bg-gray-900 text-white":"text-gray-300 hover:bg-gray-700 hover:text-white","block rounded-md px-3 py-2 text-base font-medium"),children:e.name},e.name)))}),(0,lo.jsxs)("div",{className:"border-t border-gray-700 pb-3 pt-4",children:[(0,lo.jsxs)("div",{className:"flex items-center px-5",children:[(0,lo.jsx)("div",{className:"shrink-0",children:(0,lo.jsx)("img",{alt:"",src:whe,className:"size-10 rounded-full"})}),(0,lo.jsxs)("div",{className:"ml-3",children:[(0,lo.jsx)("div",{className:"text-base/5 font-medium text-white",children:xhe}),(0,lo.jsx)("div",{className:"text-sm font-medium text-gray-400",children:bhe})]}),(0,lo.jsxs)("button",{type:"button",className:"relative ml-auto shrink-0 rounded-full bg-gray-800 p-1 text-gray-400 hover:text-white focus:outline-none focus:ring-2 focus:ring-white focus:ring-offset-2 focus:ring-offset-gray-800",children:[(0,lo.jsx)("span",{className:"absolute -inset-1.5"}),(0,lo.jsx)("span",{className:"sr-only",children:"View notifications"}),(0,lo.jsx)(to,{"aria-hidden":"true",className:"size-6"})]})]}),(0,lo.jsx)("div",{className:"mt-3 space-y-1 px-2",children:_he.map((e=>(0,lo.jsx)(gi,{as:"a",href:e.href,className:"block rounded-md px-3 py-2 text-base font-medium text-gray-400 hover:bg-gray-700 hover:text-white",children:e.name},e.name)))})]})]})]}),(0,lo.jsx)("header",{className:"bg-white shadow",children:(0,lo.jsx)("div",{className:"mx-auto max-w-7xl px-4 py-6 sm:px-6 lg:px-8",children:(0,lo.jsx)("h1",{className:"text-3xl font-bold tracking-tight text-gray-900",children:"Dashboard"})})}),(0,lo.jsx)("main",{children:(0,lo.jsx)("div",{className:"mx-auto ",children:(0,lo.jsx)(Sne,{})})})]})});const Che=function(){return(0,lo.jsx)(ct,{children:(0,lo.jsxs)(Pe,{children:[(0,lo.jsx)(Me,{path:"/dashboard",element:(0,lo.jsx)(v5,{})}),(0,lo.jsx)(Me,{path:"/",element:(0,lo.jsx)(v5,{})}),(0,lo.jsx)(Me,{path:"/dashboard",element:(0,lo.jsx)(v5,{})}),(0,lo.jsx)(Me,{path:"/student-dashboard",element:(0,lo.jsx)(v5,{})}),(0,lo.jsx)(Me,{path:"/admin-dashboard",element:(0,lo.jsx)(hhe,{})}),(0,lo.jsx)(Me,{path:"/ai",element:(0,lo.jsx)(Ine,{})}),(0,lo.jsx)(Me,{path:"/analytics",element:(0,lo.jsx)(Bce,{})}),(0,lo.jsx)(Me,{path:"/extra",element:(0,lo.jsx)(Hce,{})}),(0,lo.jsx)(Me,{path:"/users",element:(0,lo.jsx)(ehe,{})}),(0,lo.jsx)(Me,{path:"/login",element:(0,lo.jsx)(the,{})}),(0,lo.jsx)(Me,{path:"/spline",element:(0,lo.jsx)(r5,{})}),(0,lo.jsx)(Me,{path:"/menu",element:(0,lo.jsx)(Cne,{})}),(0,lo.jsx)(Me,{path:"/event",element:(0,lo.jsx)(s5,{})}),(0,lo.jsx)(Me,{path:"/ha",element:(0,lo.jsx)(nhe,{})}),(0,lo.jsx)(Me,{path:"/admin-analytics",element:(0,lo.jsx)(yhe,{})}),(0,lo.jsx)(Me,{path:"/admin-ai",element:(0,lo.jsx)(Ehe,{})})]})})};a.createRoot(document.getElementById("root")).render((0,lo.jsx)(r.StrictMode,{children:(0,lo.jsx)(Che,{})}))})()})();
//# sourceMappingURL=main.92a4203c.js.map